var _U = Object.defineProperty;
var SU = (e, t, n) => t in e ? _U(e, t, { enumerable: !0, configurable: !0, writable: !0, value: n }) : e[t] = n;
var lt = (e, t, n) => SU(e, typeof t != "symbol" ? t + "" : t, n);
var Gu = typeof globalThis < "u" ? globalThis : typeof window < "u" ? window : typeof global < "u" ? global : typeof self < "u" ? self : {};
function jd(e) {
  return e && e.__esModule && Object.prototype.hasOwnProperty.call(e, "default") ? e.default : e;
}
var M2 = { exports: {} }, O0 = {};
/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var tA;
function EU() {
  if (tA) return O0;
  tA = 1;
  var e = Symbol.for("react.transitional.element"), t = Symbol.for("react.fragment");
  function n(r, i, s) {
    var a = null;
    if (s !== void 0 && (a = "" + s), i.key !== void 0 && (a = "" + i.key), "key" in i) {
      s = {};
      for (var u in i)
        u !== "key" && (s[u] = i[u]);
    } else s = i;
    return i = s.ref, {
      $$typeof: e,
      type: r,
      key: a,
      ref: i !== void 0 ? i : null,
      props: s
    };
  }
  return O0.Fragment = t, O0.jsx = n, O0.jsxs = n, O0;
}
var nA;
function CU() {
  return nA || (nA = 1, M2.exports = /* @__PURE__ */ EU()), M2.exports;
}
var c = /* @__PURE__ */ CU(), O2 = { exports: {} }, Wt = {};
/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var rA;
function kU() {
  if (rA) return Wt;
  rA = 1;
  var e = Symbol.for("react.transitional.element"), t = Symbol.for("react.portal"), n = Symbol.for("react.fragment"), r = Symbol.for("react.strict_mode"), i = Symbol.for("react.profiler"), s = Symbol.for("react.consumer"), a = Symbol.for("react.context"), u = Symbol.for("react.forward_ref"), d = Symbol.for("react.suspense"), f = Symbol.for("react.memo"), h = Symbol.for("react.lazy"), m = Symbol.for("react.activity"), x = Symbol.iterator;
  function b(J) {
    return J === null || typeof J != "object" ? null : (J = x && J[x] || J["@@iterator"], typeof J == "function" ? J : null);
  }
  var w = {
    isMounted: function() {
      return !1;
    },
    enqueueForceUpdate: function() {
    },
    enqueueReplaceState: function() {
    },
    enqueueSetState: function() {
    }
  }, S = Object.assign, C = {};
  function T(J, ge, Q) {
    this.props = J, this.context = ge, this.refs = C, this.updater = Q || w;
  }
  T.prototype.isReactComponent = {}, T.prototype.setState = function(J, ge) {
    if (typeof J != "object" && typeof J != "function" && J != null)
      throw Error(
        "takes an object of state variables to update or a function which returns an object of state variables."
      );
    this.updater.enqueueSetState(this, J, ge, "setState");
  }, T.prototype.forceUpdate = function(J) {
    this.updater.enqueueForceUpdate(this, J, "forceUpdate");
  };
  function R() {
  }
  R.prototype = T.prototype;
  function N(J, ge, Q) {
    this.props = J, this.context = ge, this.refs = C, this.updater = Q || w;
  }
  var M = N.prototype = new R();
  M.constructor = N, S(M, T.prototype), M.isPureReactComponent = !0;
  var P = Array.isArray;
  function D() {
  }
  var q = { H: null, A: null, T: null, S: null }, Y = Object.prototype.hasOwnProperty;
  function te(J, ge, Q) {
    var fe = Q.ref;
    return {
      $$typeof: e,
      type: J,
      key: ge,
      ref: fe !== void 0 ? fe : null,
      props: Q
    };
  }
  function V(J, ge) {
    return te(J.type, ge, J.props);
  }
  function $(J) {
    return typeof J == "object" && J !== null && J.$$typeof === e;
  }
  function G(J) {
    var ge = { "=": "=0", ":": "=2" };
    return "$" + J.replace(/[=:]/g, function(Q) {
      return ge[Q];
    });
  }
  var le = /\/+/g;
  function Z(J, ge) {
    return typeof J == "object" && J !== null && J.key != null ? G("" + J.key) : ge.toString(36);
  }
  function oe(J) {
    switch (J.status) {
      case "fulfilled":
        return J.value;
      case "rejected":
        throw J.reason;
      default:
        switch (typeof J.status == "string" ? J.then(D, D) : (J.status = "pending", J.then(
          function(ge) {
            J.status === "pending" && (J.status = "fulfilled", J.value = ge);
          },
          function(ge) {
            J.status === "pending" && (J.status = "rejected", J.reason = ge);
          }
        )), J.status) {
          case "fulfilled":
            return J.value;
          case "rejected":
            throw J.reason;
        }
    }
    throw J;
  }
  function X(J, ge, Q, fe, ve) {
    var Se = typeof J;
    (Se === "undefined" || Se === "boolean") && (J = null);
    var Me = !1;
    if (J === null) Me = !0;
    else
      switch (Se) {
        case "bigint":
        case "string":
        case "number":
          Me = !0;
          break;
        case "object":
          switch (J.$$typeof) {
            case e:
            case t:
              Me = !0;
              break;
            case h:
              return Me = J._init, X(
                Me(J._payload),
                ge,
                Q,
                fe,
                ve
              );
          }
      }
    if (Me)
      return ve = ve(J), Me = fe === "" ? "." + Z(J, 0) : fe, P(ve) ? (Q = "", Me != null && (Q = Me.replace(le, "$&/") + "/"), X(ve, ge, Q, "", function(mt) {
        return mt;
      })) : ve != null && ($(ve) && (ve = V(
        ve,
        Q + (ve.key == null || J && J.key === ve.key ? "" : ("" + ve.key).replace(
          le,
          "$&/"
        ) + "/") + Me
      )), ge.push(ve)), 1;
    Me = 0;
    var Ie = fe === "" ? "." : fe + ":";
    if (P(J))
      for (var Re = 0; Re < J.length; Re++)
        fe = J[Re], Se = Ie + Z(fe, Re), Me += X(
          fe,
          ge,
          Q,
          Se,
          ve
        );
    else if (Re = b(J), typeof Re == "function")
      for (J = Re.call(J), Re = 0; !(fe = J.next()).done; )
        fe = fe.value, Se = Ie + Z(fe, Re++), Me += X(
          fe,
          ge,
          Q,
          Se,
          ve
        );
    else if (Se === "object") {
      if (typeof J.then == "function")
        return X(
          oe(J),
          ge,
          Q,
          fe,
          ve
        );
      throw ge = String(J), Error(
        "Objects are not valid as a React child (found: " + (ge === "[object Object]" ? "object with keys {" + Object.keys(J).join(", ") + "}" : ge) + "). If you meant to render a collection of children, use an array instead."
      );
    }
    return Me;
  }
  function ce(J, ge, Q) {
    if (J == null) return J;
    var fe = [], ve = 0;
    return X(J, fe, "", "", function(Se) {
      return ge.call(Q, Se, ve++);
    }), fe;
  }
  function pe(J) {
    if (J._status === -1) {
      var ge = J._result;
      ge = ge(), ge.then(
        function(Q) {
          (J._status === 0 || J._status === -1) && (J._status = 1, J._result = Q);
        },
        function(Q) {
          (J._status === 0 || J._status === -1) && (J._status = 2, J._result = Q);
        }
      ), J._status === -1 && (J._status = 0, J._result = ge);
    }
    if (J._status === 1) return J._result.default;
    throw J._result;
  }
  var de = typeof reportError == "function" ? reportError : function(J) {
    if (typeof window == "object" && typeof window.ErrorEvent == "function") {
      var ge = new window.ErrorEvent("error", {
        bubbles: !0,
        cancelable: !0,
        message: typeof J == "object" && J !== null && typeof J.message == "string" ? String(J.message) : String(J),
        error: J
      });
      if (!window.dispatchEvent(ge)) return;
    } else if (typeof process == "object" && typeof process.emit == "function") {
      process.emit("uncaughtException", J);
      return;
    }
    console.error(J);
  }, H = {
    map: ce,
    forEach: function(J, ge, Q) {
      ce(
        J,
        function() {
          ge.apply(this, arguments);
        },
        Q
      );
    },
    count: function(J) {
      var ge = 0;
      return ce(J, function() {
        ge++;
      }), ge;
    },
    toArray: function(J) {
      return ce(J, function(ge) {
        return ge;
      }) || [];
    },
    only: function(J) {
      if (!$(J))
        throw Error(
          "React.Children.only expected to receive a single React element child."
        );
      return J;
    }
  };
  return Wt.Activity = m, Wt.Children = H, Wt.Component = T, Wt.Fragment = n, Wt.Profiler = i, Wt.PureComponent = N, Wt.StrictMode = r, Wt.Suspense = d, Wt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE = q, Wt.__COMPILER_RUNTIME = {
    __proto__: null,
    c: function(J) {
      return q.H.useMemoCache(J);
    }
  }, Wt.cache = function(J) {
    return function() {
      return J.apply(null, arguments);
    };
  }, Wt.cacheSignal = function() {
    return null;
  }, Wt.cloneElement = function(J, ge, Q) {
    if (J == null)
      throw Error(
        "The argument must be a React element, but you passed " + J + "."
      );
    var fe = S({}, J.props), ve = J.key;
    if (ge != null)
      for (Se in ge.key !== void 0 && (ve = "" + ge.key), ge)
        !Y.call(ge, Se) || Se === "key" || Se === "__self" || Se === "__source" || Se === "ref" && ge.ref === void 0 || (fe[Se] = ge[Se]);
    var Se = arguments.length - 2;
    if (Se === 1) fe.children = Q;
    else if (1 < Se) {
      for (var Me = Array(Se), Ie = 0; Ie < Se; Ie++)
        Me[Ie] = arguments[Ie + 2];
      fe.children = Me;
    }
    return te(J.type, ve, fe);
  }, Wt.createContext = function(J) {
    return J = {
      $$typeof: a,
      _currentValue: J,
      _currentValue2: J,
      _threadCount: 0,
      Provider: null,
      Consumer: null
    }, J.Provider = J, J.Consumer = {
      $$typeof: s,
      _context: J
    }, J;
  }, Wt.createElement = function(J, ge, Q) {
    var fe, ve = {}, Se = null;
    if (ge != null)
      for (fe in ge.key !== void 0 && (Se = "" + ge.key), ge)
        Y.call(ge, fe) && fe !== "key" && fe !== "__self" && fe !== "__source" && (ve[fe] = ge[fe]);
    var Me = arguments.length - 2;
    if (Me === 1) ve.children = Q;
    else if (1 < Me) {
      for (var Ie = Array(Me), Re = 0; Re < Me; Re++)
        Ie[Re] = arguments[Re + 2];
      ve.children = Ie;
    }
    if (J && J.defaultProps)
      for (fe in Me = J.defaultProps, Me)
        ve[fe] === void 0 && (ve[fe] = Me[fe]);
    return te(J, Se, ve);
  }, Wt.createRef = function() {
    return { current: null };
  }, Wt.forwardRef = function(J) {
    return { $$typeof: u, render: J };
  }, Wt.isValidElement = $, Wt.lazy = function(J) {
    return {
      $$typeof: h,
      _payload: { _status: -1, _result: J },
      _init: pe
    };
  }, Wt.memo = function(J, ge) {
    return {
      $$typeof: f,
      type: J,
      compare: ge === void 0 ? null : ge
    };
  }, Wt.startTransition = function(J) {
    var ge = q.T, Q = {};
    q.T = Q;
    try {
      var fe = J(), ve = q.S;
      ve !== null && ve(Q, fe), typeof fe == "object" && fe !== null && typeof fe.then == "function" && fe.then(D, de);
    } catch (Se) {
      de(Se);
    } finally {
      ge !== null && Q.types !== null && (ge.types = Q.types), q.T = ge;
    }
  }, Wt.unstable_useCacheRefresh = function() {
    return q.H.useCacheRefresh();
  }, Wt.use = function(J) {
    return q.H.use(J);
  }, Wt.useActionState = function(J, ge, Q) {
    return q.H.useActionState(J, ge, Q);
  }, Wt.useCallback = function(J, ge) {
    return q.H.useCallback(J, ge);
  }, Wt.useContext = function(J) {
    return q.H.useContext(J);
  }, Wt.useDebugValue = function() {
  }, Wt.useDeferredValue = function(J, ge) {
    return q.H.useDeferredValue(J, ge);
  }, Wt.useEffect = function(J, ge) {
    return q.H.useEffect(J, ge);
  }, Wt.useEffectEvent = function(J) {
    return q.H.useEffectEvent(J);
  }, Wt.useId = function() {
    return q.H.useId();
  }, Wt.useImperativeHandle = function(J, ge, Q) {
    return q.H.useImperativeHandle(J, ge, Q);
  }, Wt.useInsertionEffect = function(J, ge) {
    return q.H.useInsertionEffect(J, ge);
  }, Wt.useLayoutEffect = function(J, ge) {
    return q.H.useLayoutEffect(J, ge);
  }, Wt.useMemo = function(J, ge) {
    return q.H.useMemo(J, ge);
  }, Wt.useOptimistic = function(J, ge) {
    return q.H.useOptimistic(J, ge);
  }, Wt.useReducer = function(J, ge, Q) {
    return q.H.useReducer(J, ge, Q);
  }, Wt.useRef = function(J) {
    return q.H.useRef(J);
  }, Wt.useState = function(J) {
    return q.H.useState(J);
  }, Wt.useSyncExternalStore = function(J, ge, Q) {
    return q.H.useSyncExternalStore(
      J,
      ge,
      Q
    );
  }, Wt.useTransition = function() {
    return q.H.useTransition();
  }, Wt.version = "19.2.3", Wt;
}
var iA;
function Gy() {
  return iA || (iA = 1, O2.exports = /* @__PURE__ */ kU()), O2.exports;
}
var I = /* @__PURE__ */ Gy();
const wd = /* @__PURE__ */ jd(I);
var D2 = { exports: {} }, D0 = {}, z2 = { exports: {} }, P2 = {};
/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var sA;
function TU() {
  return sA || (sA = 1, (function(e) {
    function t(X, ce) {
      var pe = X.length;
      X.push(ce);
      e: for (; 0 < pe; ) {
        var de = pe - 1 >>> 1, H = X[de];
        if (0 < i(H, ce))
          X[de] = ce, X[pe] = H, pe = de;
        else break e;
      }
    }
    function n(X) {
      return X.length === 0 ? null : X[0];
    }
    function r(X) {
      if (X.length === 0) return null;
      var ce = X[0], pe = X.pop();
      if (pe !== ce) {
        X[0] = pe;
        e: for (var de = 0, H = X.length, J = H >>> 1; de < J; ) {
          var ge = 2 * (de + 1) - 1, Q = X[ge], fe = ge + 1, ve = X[fe];
          if (0 > i(Q, pe))
            fe < H && 0 > i(ve, Q) ? (X[de] = ve, X[fe] = pe, de = fe) : (X[de] = Q, X[ge] = pe, de = ge);
          else if (fe < H && 0 > i(ve, pe))
            X[de] = ve, X[fe] = pe, de = fe;
          else break e;
        }
      }
      return ce;
    }
    function i(X, ce) {
      var pe = X.sortIndex - ce.sortIndex;
      return pe !== 0 ? pe : X.id - ce.id;
    }
    if (e.unstable_now = void 0, typeof performance == "object" && typeof performance.now == "function") {
      var s = performance;
      e.unstable_now = function() {
        return s.now();
      };
    } else {
      var a = Date, u = a.now();
      e.unstable_now = function() {
        return a.now() - u;
      };
    }
    var d = [], f = [], h = 1, m = null, x = 3, b = !1, w = !1, S = !1, C = !1, T = typeof setTimeout == "function" ? setTimeout : null, R = typeof clearTimeout == "function" ? clearTimeout : null, N = typeof setImmediate < "u" ? setImmediate : null;
    function M(X) {
      for (var ce = n(f); ce !== null; ) {
        if (ce.callback === null) r(f);
        else if (ce.startTime <= X)
          r(f), ce.sortIndex = ce.expirationTime, t(d, ce);
        else break;
        ce = n(f);
      }
    }
    function P(X) {
      if (S = !1, M(X), !w)
        if (n(d) !== null)
          w = !0, D || (D = !0, G());
        else {
          var ce = n(f);
          ce !== null && oe(P, ce.startTime - X);
        }
    }
    var D = !1, q = -1, Y = 5, te = -1;
    function V() {
      return C ? !0 : !(e.unstable_now() - te < Y);
    }
    function $() {
      if (C = !1, D) {
        var X = e.unstable_now();
        te = X;
        var ce = !0;
        try {
          e: {
            w = !1, S && (S = !1, R(q), q = -1), b = !0;
            var pe = x;
            try {
              t: {
                for (M(X), m = n(d); m !== null && !(m.expirationTime > X && V()); ) {
                  var de = m.callback;
                  if (typeof de == "function") {
                    m.callback = null, x = m.priorityLevel;
                    var H = de(
                      m.expirationTime <= X
                    );
                    if (X = e.unstable_now(), typeof H == "function") {
                      m.callback = H, M(X), ce = !0;
                      break t;
                    }
                    m === n(d) && r(d), M(X);
                  } else r(d);
                  m = n(d);
                }
                if (m !== null) ce = !0;
                else {
                  var J = n(f);
                  J !== null && oe(
                    P,
                    J.startTime - X
                  ), ce = !1;
                }
              }
              break e;
            } finally {
              m = null, x = pe, b = !1;
            }
            ce = void 0;
          }
        } finally {
          ce ? G() : D = !1;
        }
      }
    }
    var G;
    if (typeof N == "function")
      G = function() {
        N($);
      };
    else if (typeof MessageChannel < "u") {
      var le = new MessageChannel(), Z = le.port2;
      le.port1.onmessage = $, G = function() {
        Z.postMessage(null);
      };
    } else
      G = function() {
        T($, 0);
      };
    function oe(X, ce) {
      q = T(function() {
        X(e.unstable_now());
      }, ce);
    }
    e.unstable_IdlePriority = 5, e.unstable_ImmediatePriority = 1, e.unstable_LowPriority = 4, e.unstable_NormalPriority = 3, e.unstable_Profiling = null, e.unstable_UserBlockingPriority = 2, e.unstable_cancelCallback = function(X) {
      X.callback = null;
    }, e.unstable_forceFrameRate = function(X) {
      0 > X || 125 < X ? console.error(
        "forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"
      ) : Y = 0 < X ? Math.floor(1e3 / X) : 5;
    }, e.unstable_getCurrentPriorityLevel = function() {
      return x;
    }, e.unstable_next = function(X) {
      switch (x) {
        case 1:
        case 2:
        case 3:
          var ce = 3;
          break;
        default:
          ce = x;
      }
      var pe = x;
      x = ce;
      try {
        return X();
      } finally {
        x = pe;
      }
    }, e.unstable_requestPaint = function() {
      C = !0;
    }, e.unstable_runWithPriority = function(X, ce) {
      switch (X) {
        case 1:
        case 2:
        case 3:
        case 4:
        case 5:
          break;
        default:
          X = 3;
      }
      var pe = x;
      x = X;
      try {
        return ce();
      } finally {
        x = pe;
      }
    }, e.unstable_scheduleCallback = function(X, ce, pe) {
      var de = e.unstable_now();
      switch (typeof pe == "object" && pe !== null ? (pe = pe.delay, pe = typeof pe == "number" && 0 < pe ? de + pe : de) : pe = de, X) {
        case 1:
          var H = -1;
          break;
        case 2:
          H = 250;
          break;
        case 5:
          H = 1073741823;
          break;
        case 4:
          H = 1e4;
          break;
        default:
          H = 5e3;
      }
      return H = pe + H, X = {
        id: h++,
        callback: ce,
        priorityLevel: X,
        startTime: pe,
        expirationTime: H,
        sortIndex: -1
      }, pe > de ? (X.sortIndex = pe, t(f, X), n(d) === null && X === n(f) && (S ? (R(q), q = -1) : S = !0, oe(P, pe - de))) : (X.sortIndex = H, t(d, X), w || b || (w = !0, D || (D = !0, G()))), X;
    }, e.unstable_shouldYield = V, e.unstable_wrapCallback = function(X) {
      var ce = x;
      return function() {
        var pe = x;
        x = ce;
        try {
          return X.apply(this, arguments);
        } finally {
          x = pe;
        }
      };
    };
  })(P2)), P2;
}
var aA;
function jU() {
  return aA || (aA = 1, z2.exports = /* @__PURE__ */ TU()), z2.exports;
}
var I2 = { exports: {} }, is = {};
/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var oA;
function AU() {
  if (oA) return is;
  oA = 1;
  var e = /* @__PURE__ */ Gy();
  function t(d) {
    var f = "https://react.dev/errors/" + d;
    if (1 < arguments.length) {
      f += "?args[]=" + encodeURIComponent(arguments[1]);
      for (var h = 2; h < arguments.length; h++)
        f += "&args[]=" + encodeURIComponent(arguments[h]);
    }
    return "Minified React error #" + d + "; visit " + f + " for the full message or use the non-minified dev environment for full errors and additional helpful warnings.";
  }
  function n() {
  }
  var r = {
    d: {
      f: n,
      r: function() {
        throw Error(t(522));
      },
      D: n,
      C: n,
      L: n,
      m: n,
      X: n,
      S: n,
      M: n
    },
    p: 0,
    findDOMNode: null
  }, i = Symbol.for("react.portal");
  function s(d, f, h) {
    var m = 3 < arguments.length && arguments[3] !== void 0 ? arguments[3] : null;
    return {
      $$typeof: i,
      key: m == null ? null : "" + m,
      children: d,
      containerInfo: f,
      implementation: h
    };
  }
  var a = e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;
  function u(d, f) {
    if (d === "font") return "";
    if (typeof f == "string")
      return f === "use-credentials" ? f : "";
  }
  return is.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE = r, is.createPortal = function(d, f) {
    var h = 2 < arguments.length && arguments[2] !== void 0 ? arguments[2] : null;
    if (!f || f.nodeType !== 1 && f.nodeType !== 9 && f.nodeType !== 11)
      throw Error(t(299));
    return s(d, f, null, h);
  }, is.flushSync = function(d) {
    var f = a.T, h = r.p;
    try {
      if (a.T = null, r.p = 2, d) return d();
    } finally {
      a.T = f, r.p = h, r.d.f();
    }
  }, is.preconnect = function(d, f) {
    typeof d == "string" && (f ? (f = f.crossOrigin, f = typeof f == "string" ? f === "use-credentials" ? f : "" : void 0) : f = null, r.d.C(d, f));
  }, is.prefetchDNS = function(d) {
    typeof d == "string" && r.d.D(d);
  }, is.preinit = function(d, f) {
    if (typeof d == "string" && f && typeof f.as == "string") {
      var h = f.as, m = u(h, f.crossOrigin), x = typeof f.integrity == "string" ? f.integrity : void 0, b = typeof f.fetchPriority == "string" ? f.fetchPriority : void 0;
      h === "style" ? r.d.S(
        d,
        typeof f.precedence == "string" ? f.precedence : void 0,
        {
          crossOrigin: m,
          integrity: x,
          fetchPriority: b
        }
      ) : h === "script" && r.d.X(d, {
        crossOrigin: m,
        integrity: x,
        fetchPriority: b,
        nonce: typeof f.nonce == "string" ? f.nonce : void 0
      });
    }
  }, is.preinitModule = function(d, f) {
    if (typeof d == "string")
      if (typeof f == "object" && f !== null) {
        if (f.as == null || f.as === "script") {
          var h = u(
            f.as,
            f.crossOrigin
          );
          r.d.M(d, {
            crossOrigin: h,
            integrity: typeof f.integrity == "string" ? f.integrity : void 0,
            nonce: typeof f.nonce == "string" ? f.nonce : void 0
          });
        }
      } else f == null && r.d.M(d);
  }, is.preload = function(d, f) {
    if (typeof d == "string" && typeof f == "object" && f !== null && typeof f.as == "string") {
      var h = f.as, m = u(h, f.crossOrigin);
      r.d.L(d, h, {
        crossOrigin: m,
        integrity: typeof f.integrity == "string" ? f.integrity : void 0,
        nonce: typeof f.nonce == "string" ? f.nonce : void 0,
        type: typeof f.type == "string" ? f.type : void 0,
        fetchPriority: typeof f.fetchPriority == "string" ? f.fetchPriority : void 0,
        referrerPolicy: typeof f.referrerPolicy == "string" ? f.referrerPolicy : void 0,
        imageSrcSet: typeof f.imageSrcSet == "string" ? f.imageSrcSet : void 0,
        imageSizes: typeof f.imageSizes == "string" ? f.imageSizes : void 0,
        media: typeof f.media == "string" ? f.media : void 0
      });
    }
  }, is.preloadModule = function(d, f) {
    if (typeof d == "string")
      if (f) {
        var h = u(f.as, f.crossOrigin);
        r.d.m(d, {
          as: typeof f.as == "string" && f.as !== "script" ? f.as : void 0,
          crossOrigin: h,
          integrity: typeof f.integrity == "string" ? f.integrity : void 0
        });
      } else r.d.m(d);
  }, is.requestFormReset = function(d) {
    r.d.r(d);
  }, is.unstable_batchedUpdates = function(d, f) {
    return d(f);
  }, is.useFormState = function(d, f, h) {
    return a.H.useFormState(d, f, h);
  }, is.useFormStatus = function() {
    return a.H.useHostTransitionStatus();
  }, is.version = "19.2.3", is;
}
var lA;
function hz() {
  if (lA) return I2.exports;
  lA = 1;
  function e() {
    if (!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ > "u" || typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE != "function"))
      try {
        __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e);
      } catch (t) {
        console.error(t);
      }
  }
  return e(), I2.exports = /* @__PURE__ */ AU(), I2.exports;
}
/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var uA;
function NU() {
  if (uA) return D0;
  uA = 1;
  var e = /* @__PURE__ */ jU(), t = /* @__PURE__ */ Gy(), n = /* @__PURE__ */ hz();
  function r(o) {
    var l = "https://react.dev/errors/" + o;
    if (1 < arguments.length) {
      l += "?args[]=" + encodeURIComponent(arguments[1]);
      for (var p = 2; p < arguments.length; p++)
        l += "&args[]=" + encodeURIComponent(arguments[p]);
    }
    return "Minified React error #" + o + "; visit " + l + " for the full message or use the non-minified dev environment for full errors and additional helpful warnings.";
  }
  function i(o) {
    return !(!o || o.nodeType !== 1 && o.nodeType !== 9 && o.nodeType !== 11);
  }
  function s(o) {
    var l = o, p = o;
    if (o.alternate) for (; l.return; ) l = l.return;
    else {
      o = l;
      do
        l = o, (l.flags & 4098) !== 0 && (p = l.return), o = l.return;
      while (o);
    }
    return l.tag === 3 ? p : null;
  }
  function a(o) {
    if (o.tag === 13) {
      var l = o.memoizedState;
      if (l === null && (o = o.alternate, o !== null && (l = o.memoizedState)), l !== null) return l.dehydrated;
    }
    return null;
  }
  function u(o) {
    if (o.tag === 31) {
      var l = o.memoizedState;
      if (l === null && (o = o.alternate, o !== null && (l = o.memoizedState)), l !== null) return l.dehydrated;
    }
    return null;
  }
  function d(o) {
    if (s(o) !== o)
      throw Error(r(188));
  }
  function f(o) {
    var l = o.alternate;
    if (!l) {
      if (l = s(o), l === null) throw Error(r(188));
      return l !== o ? null : o;
    }
    for (var p = o, y = l; ; ) {
      var E = p.return;
      if (E === null) break;
      var A = E.alternate;
      if (A === null) {
        if (y = E.return, y !== null) {
          p = y;
          continue;
        }
        break;
      }
      if (E.child === A.child) {
        for (A = E.child; A; ) {
          if (A === p) return d(E), o;
          if (A === y) return d(E), l;
          A = A.sibling;
        }
        throw Error(r(188));
      }
      if (p.return !== y.return) p = E, y = A;
      else {
        for (var B = !1, ne = E.child; ne; ) {
          if (ne === p) {
            B = !0, p = E, y = A;
            break;
          }
          if (ne === y) {
            B = !0, y = E, p = A;
            break;
          }
          ne = ne.sibling;
        }
        if (!B) {
          for (ne = A.child; ne; ) {
            if (ne === p) {
              B = !0, p = A, y = E;
              break;
            }
            if (ne === y) {
              B = !0, y = A, p = E;
              break;
            }
            ne = ne.sibling;
          }
          if (!B) throw Error(r(189));
        }
      }
      if (p.alternate !== y) throw Error(r(190));
    }
    if (p.tag !== 3) throw Error(r(188));
    return p.stateNode.current === p ? o : l;
  }
  function h(o) {
    var l = o.tag;
    if (l === 5 || l === 26 || l === 27 || l === 6) return o;
    for (o = o.child; o !== null; ) {
      if (l = h(o), l !== null) return l;
      o = o.sibling;
    }
    return null;
  }
  var m = Object.assign, x = Symbol.for("react.element"), b = Symbol.for("react.transitional.element"), w = Symbol.for("react.portal"), S = Symbol.for("react.fragment"), C = Symbol.for("react.strict_mode"), T = Symbol.for("react.profiler"), R = Symbol.for("react.consumer"), N = Symbol.for("react.context"), M = Symbol.for("react.forward_ref"), P = Symbol.for("react.suspense"), D = Symbol.for("react.suspense_list"), q = Symbol.for("react.memo"), Y = Symbol.for("react.lazy"), te = Symbol.for("react.activity"), V = Symbol.for("react.memo_cache_sentinel"), $ = Symbol.iterator;
  function G(o) {
    return o === null || typeof o != "object" ? null : (o = $ && o[$] || o["@@iterator"], typeof o == "function" ? o : null);
  }
  var le = Symbol.for("react.client.reference");
  function Z(o) {
    if (o == null) return null;
    if (typeof o == "function")
      return o.$$typeof === le ? null : o.displayName || o.name || null;
    if (typeof o == "string") return o;
    switch (o) {
      case S:
        return "Fragment";
      case T:
        return "Profiler";
      case C:
        return "StrictMode";
      case P:
        return "Suspense";
      case D:
        return "SuspenseList";
      case te:
        return "Activity";
    }
    if (typeof o == "object")
      switch (o.$$typeof) {
        case w:
          return "Portal";
        case N:
          return o.displayName || "Context";
        case R:
          return (o._context.displayName || "Context") + ".Consumer";
        case M:
          var l = o.render;
          return o = o.displayName, o || (o = l.displayName || l.name || "", o = o !== "" ? "ForwardRef(" + o + ")" : "ForwardRef"), o;
        case q:
          return l = o.displayName || null, l !== null ? l : Z(o.type) || "Memo";
        case Y:
          l = o._payload, o = o._init;
          try {
            return Z(o(l));
          } catch {
          }
      }
    return null;
  }
  var oe = Array.isArray, X = t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE, ce = n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE, pe = {
    pending: !1,
    data: null,
    method: null,
    action: null
  }, de = [], H = -1;
  function J(o) {
    return { current: o };
  }
  function ge(o) {
    0 > H || (o.current = de[H], de[H] = null, H--);
  }
  function Q(o, l) {
    H++, de[H] = o.current, o.current = l;
  }
  var fe = J(null), ve = J(null), Se = J(null), Me = J(null);
  function Ie(o, l) {
    switch (Q(Se, l), Q(ve, o), Q(fe, null), l.nodeType) {
      case 9:
      case 11:
        o = (o = l.documentElement) && (o = o.namespaceURI) ? Ff(o) : 0;
        break;
      default:
        if (o = l.tagName, l = l.namespaceURI)
          l = Ff(l), o = ns(l, o);
        else
          switch (o) {
            case "svg":
              o = 1;
              break;
            case "math":
              o = 2;
              break;
            default:
              o = 0;
          }
    }
    ge(fe), Q(fe, o);
  }
  function Re() {
    ge(fe), ge(ve), ge(Se);
  }
  function mt(o) {
    o.memoizedState !== null && Q(Me, o);
    var l = fe.current, p = ns(l, o.type);
    l !== p && (Q(ve, o), Q(fe, p));
  }
  function dt(o) {
    ve.current === o && (ge(fe), ge(ve)), Me.current === o && (ge(Me), ad._currentValue = pe);
  }
  var Je, ft;
  function yt(o) {
    if (Je === void 0)
      try {
        throw Error();
      } catch (p) {
        var l = p.stack.trim().match(/\n( *(at )?)/);
        Je = l && l[1] || "", ft = -1 < p.stack.indexOf(`
    at`) ? " (<anonymous>)" : -1 < p.stack.indexOf("@") ? "@unknown:0:0" : "";
      }
    return `
` + Je + o + ft;
  }
  var ht = !1;
  function Le(o, l) {
    if (!o || ht) return "";
    ht = !0;
    var p = Error.prepareStackTrace;
    Error.prepareStackTrace = void 0;
    try {
      var y = {
        DetermineComponentFrameRoot: function() {
          try {
            if (l) {
              var Ke = function() {
                throw Error();
              };
              if (Object.defineProperty(Ke.prototype, "props", {
                set: function() {
                  throw Error();
                }
              }), typeof Reflect == "object" && Reflect.construct) {
                try {
                  Reflect.construct(Ke, []);
                } catch (Be) {
                  var Pe = Be;
                }
                Reflect.construct(o, [], Ke);
              } else {
                try {
                  Ke.call();
                } catch (Be) {
                  Pe = Be;
                }
                o.call(Ke.prototype);
              }
            } else {
              try {
                throw Error();
              } catch (Be) {
                Pe = Be;
              }
              (Ke = o()) && typeof Ke.catch == "function" && Ke.catch(function() {
              });
            }
          } catch (Be) {
            if (Be && Pe && typeof Be.stack == "string")
              return [Be.stack, Pe.stack];
          }
          return [null, null];
        }
      };
      y.DetermineComponentFrameRoot.displayName = "DetermineComponentFrameRoot";
      var E = Object.getOwnPropertyDescriptor(
        y.DetermineComponentFrameRoot,
        "name"
      );
      E && E.configurable && Object.defineProperty(
        y.DetermineComponentFrameRoot,
        "name",
        { value: "DetermineComponentFrameRoot" }
      );
      var A = y.DetermineComponentFrameRoot(), B = A[0], ne = A[1];
      if (B && ne) {
        var xe = B.split(`
`), De = ne.split(`
`);
        for (E = y = 0; y < xe.length && !xe[y].includes("DetermineComponentFrameRoot"); )
          y++;
        for (; E < De.length && !De[E].includes(
          "DetermineComponentFrameRoot"
        ); )
          E++;
        if (y === xe.length || E === De.length)
          for (y = xe.length - 1, E = De.length - 1; 1 <= y && 0 <= E && xe[y] !== De[E]; )
            E--;
        for (; 1 <= y && 0 <= E; y--, E--)
          if (xe[y] !== De[E]) {
            if (y !== 1 || E !== 1)
              do
                if (y--, E--, 0 > E || xe[y] !== De[E]) {
                  var Ue = `
` + xe[y].replace(" at new ", " at ");
                  return o.displayName && Ue.includes("<anonymous>") && (Ue = Ue.replace("<anonymous>", o.displayName)), Ue;
                }
              while (1 <= y && 0 <= E);
            break;
          }
      }
    } finally {
      ht = !1, Error.prepareStackTrace = p;
    }
    return (p = o ? o.displayName || o.name : "") ? yt(p) : "";
  }
  function Ye(o, l) {
    switch (o.tag) {
      case 26:
      case 27:
      case 5:
        return yt(o.type);
      case 16:
        return yt("Lazy");
      case 13:
        return o.child !== l && l !== null ? yt("Suspense Fallback") : yt("Suspense");
      case 19:
        return yt("SuspenseList");
      case 0:
      case 15:
        return Le(o.type, !1);
      case 11:
        return Le(o.type.render, !1);
      case 1:
        return Le(o.type, !0);
      case 31:
        return yt("Activity");
      default:
        return "";
    }
  }
  function gt(o) {
    try {
      var l = "", p = null;
      do
        l += Ye(o, p), p = o, o = o.return;
      while (o);
      return l;
    } catch (y) {
      return `
Error generating stack: ` + y.message + `
` + y.stack;
    }
  }
  var Dt = Object.prototype.hasOwnProperty, pn = e.unstable_scheduleCallback, Ht = e.unstable_cancelCallback, zn = e.unstable_shouldYield, nn = e.unstable_requestPaint, kn = e.unstable_now, Nn = e.unstable_getCurrentPriorityLevel, $e = e.unstable_ImmediatePriority, Qe = e.unstable_UserBlockingPriority, bt = e.unstable_NormalPriority, jt = e.unstable_LowPriority, $t = e.unstable_IdlePriority, Un = e.log, Hn = e.unstable_setDisableYieldValue, on = null, Jt = null;
  function fn(o) {
    if (typeof Un == "function" && Hn(o), Jt && typeof Jt.setStrictMode == "function")
      try {
        Jt.setStrictMode(on, o);
      } catch {
      }
  }
  var nt = Math.clz32 ? Math.clz32 : sr, er = Math.log, Pn = Math.LN2;
  function sr(o) {
    return o >>>= 0, o === 0 ? 32 : 31 - (er(o) / Pn | 0) | 0;
  }
  var st = 256, $r = 262144, Is = 4194304;
  function bi(o) {
    var l = o & 42;
    if (l !== 0) return l;
    switch (o & -o) {
      case 1:
        return 1;
      case 2:
        return 2;
      case 4:
        return 4;
      case 8:
        return 8;
      case 16:
        return 16;
      case 32:
        return 32;
      case 64:
        return 64;
      case 128:
        return 128;
      case 256:
      case 512:
      case 1024:
      case 2048:
      case 4096:
      case 8192:
      case 16384:
      case 32768:
      case 65536:
      case 131072:
        return o & 261888;
      case 262144:
      case 524288:
      case 1048576:
      case 2097152:
        return o & 3932160;
      case 4194304:
      case 8388608:
      case 16777216:
      case 33554432:
        return o & 62914560;
      case 67108864:
        return 67108864;
      case 134217728:
        return 134217728;
      case 268435456:
        return 268435456;
      case 536870912:
        return 536870912;
      case 1073741824:
        return 0;
      default:
        return o;
    }
  }
  function At(o, l, p) {
    var y = o.pendingLanes;
    if (y === 0) return 0;
    var E = 0, A = o.suspendedLanes, B = o.pingedLanes;
    o = o.warmLanes;
    var ne = y & 134217727;
    return ne !== 0 ? (y = ne & ~A, y !== 0 ? E = bi(y) : (B &= ne, B !== 0 ? E = bi(B) : p || (p = ne & ~o, p !== 0 && (E = bi(p))))) : (ne = y & ~A, ne !== 0 ? E = bi(ne) : B !== 0 ? E = bi(B) : p || (p = y & ~o, p !== 0 && (E = bi(p)))), E === 0 ? 0 : l !== 0 && l !== E && (l & A) === 0 && (A = E & -E, p = l & -l, A >= p || A === 32 && (p & 4194048) !== 0) ? l : E;
  }
  function tr(o, l) {
    return (o.pendingLanes & ~(o.suspendedLanes & ~o.pingedLanes) & l) === 0;
  }
  function Dd(o, l) {
    switch (o) {
      case 1:
      case 2:
      case 4:
      case 8:
      case 64:
        return l + 250;
      case 16:
      case 32:
      case 128:
      case 256:
      case 512:
      case 1024:
      case 2048:
      case 4096:
      case 8192:
      case 16384:
      case 32768:
      case 65536:
      case 131072:
      case 262144:
      case 524288:
      case 1048576:
      case 2097152:
        return l + 5e3;
      case 4194304:
      case 8388608:
      case 16777216:
      case 33554432:
        return -1;
      case 67108864:
      case 134217728:
      case 268435456:
      case 536870912:
      case 1073741824:
        return -1;
      default:
        return -1;
    }
  }
  function cu() {
    var o = Is;
    return Is <<= 1, (Is & 62914560) === 0 && (Is = 4194304), o;
  }
  function Ls(o) {
    for (var l = [], p = 0; 31 > p; p++) l.push(o);
    return l;
  }
  function Ui(o, l) {
    o.pendingLanes |= l, l !== 268435456 && (o.suspendedLanes = 0, o.pingedLanes = 0, o.warmLanes = 0);
  }
  function du(o, l, p, y, E, A) {
    var B = o.pendingLanes;
    o.pendingLanes = p, o.suspendedLanes = 0, o.pingedLanes = 0, o.warmLanes = 0, o.expiredLanes &= p, o.entangledLanes &= p, o.errorRecoveryDisabledLanes &= p, o.shellSuspendCounter = 0;
    var ne = o.entanglements, xe = o.expirationTimes, De = o.hiddenUpdates;
    for (p = B & ~p; 0 < p; ) {
      var Ue = 31 - nt(p), Ke = 1 << Ue;
      ne[Ue] = 0, xe[Ue] = -1;
      var Pe = De[Ue];
      if (Pe !== null)
        for (De[Ue] = null, Ue = 0; Ue < Pe.length; Ue++) {
          var Be = Pe[Ue];
          Be !== null && (Be.lane &= -536870913);
        }
      p &= ~Ke;
    }
    y !== 0 && ya(o, y, 0), A !== 0 && E === 0 && o.tag !== 0 && (o.suspendedLanes |= A & ~(B & ~l));
  }
  function ya(o, l, p) {
    o.pendingLanes |= l, o.suspendedLanes &= ~l;
    var y = 31 - nt(l);
    o.entangledLanes |= l, o.entanglements[y] = o.entanglements[y] | 1073741824 | p & 261930;
  }
  function Tn(o, l) {
    var p = o.entangledLanes |= l;
    for (o = o.entanglements; p; ) {
      var y = 31 - nt(p), E = 1 << y;
      E & l | o[y] & l && (o[y] |= l), p &= ~E;
    }
  }
  function Gn(o, l) {
    var p = l & -l;
    return p = (p & 42) !== 0 ? 1 : fu(p), (p & (o.suspendedLanes | l)) !== 0 ? 0 : p;
  }
  function fu(o) {
    switch (o) {
      case 2:
        o = 1;
        break;
      case 8:
        o = 4;
        break;
      case 32:
        o = 16;
        break;
      case 256:
      case 512:
      case 1024:
      case 2048:
      case 4096:
      case 8192:
      case 16384:
      case 32768:
      case 65536:
      case 131072:
      case 262144:
      case 524288:
      case 1048576:
      case 2097152:
      case 4194304:
      case 8388608:
      case 16777216:
      case 33554432:
        o = 128;
        break;
      case 268435456:
        o = 134217728;
        break;
      default:
        o = 0;
    }
    return o;
  }
  function Fa(o) {
    return o &= -o, 2 < o ? 8 < o ? (o & 134217727) !== 0 ? 32 : 268435456 : 8 : 2;
  }
  function ho() {
    var o = ce.p;
    return o !== 0 ? o : (o = window.event, o === void 0 ? 32 : Xv(o.type));
  }
  function po(o, l) {
    var p = ce.p;
    try {
      return ce.p = o, l();
    } finally {
      ce.p = p;
    }
  }
  var Bs = Math.random().toString(36).slice(2), Rn = "__reactFiber$" + Bs, ar = "__reactProps$" + Bs, Yr = "__reactContainer$" + Bs, $s = "__reactEvents$" + Bs, lc = "__reactListeners$" + Bs, qs = "__reactHandles$" + Bs, hu = "__reactResources$" + Bs, Ni = "__reactMarker$" + Bs;
  function ol(o) {
    delete o[Rn], delete o[ar], delete o[$s], delete o[lc], delete o[qs];
  }
  function Fs(o) {
    var l = o[Rn];
    if (l) return l;
    for (var p = o.parentNode; p; ) {
      if (l = p[Yr] || p[Rn]) {
        if (p = l.alternate, l.child !== null || p !== null && p.child !== null)
          for (o = Dv(o); o !== null; ) {
            if (p = o[Rn]) return p;
            o = Dv(o);
          }
        return l;
      }
      o = p, p = o.parentNode;
    }
    return null;
  }
  function mn(o) {
    if (o = o[Rn] || o[Yr]) {
      var l = o.tag;
      if (l === 5 || l === 6 || l === 13 || l === 31 || l === 26 || l === 27 || l === 3)
        return o;
    }
    return null;
  }
  function wi(o) {
    var l = o.tag;
    if (l === 5 || l === 26 || l === 27 || l === 6) return o.stateNode;
    throw Error(r(33));
  }
  function _r(o) {
    var l = o[hu];
    return l || (l = o[hu] = { hoistableStyles: /* @__PURE__ */ new Map(), hoistableScripts: /* @__PURE__ */ new Map() }), l;
  }
  function or(o) {
    o[Ni] = !0;
  }
  var xa = /* @__PURE__ */ new Set(), mo = {};
  function Hi(o, l) {
    fs(o, l), fs(o + "Capture", l);
  }
  function fs(o, l) {
    for (mo[o] = l, o = 0; o < l.length; o++)
      xa.add(l[o]);
  }
  var Us = RegExp(
    "^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"
  ), ll = {}, go = {};
  function uc(o) {
    return Dt.call(go, o) ? !0 : Dt.call(ll, o) ? !1 : Us.test(o) ? go[o] = !0 : (ll[o] = !0, !1);
  }
  function Vt(o, l, p) {
    if (uc(l))
      if (p === null) o.removeAttribute(l);
      else {
        switch (typeof p) {
          case "undefined":
          case "function":
          case "symbol":
            o.removeAttribute(l);
            return;
          case "boolean":
            var y = l.toLowerCase().slice(0, 5);
            if (y !== "data-" && y !== "aria-") {
              o.removeAttribute(l);
              return;
            }
        }
        o.setAttribute(l, "" + p);
      }
  }
  function Ua(o, l, p) {
    if (p === null) o.removeAttribute(l);
    else {
      switch (typeof p) {
        case "undefined":
        case "function":
        case "symbol":
        case "boolean":
          o.removeAttribute(l);
          return;
      }
      o.setAttribute(l, "" + p);
    }
  }
  function Ri(o, l, p, y) {
    if (y === null) o.removeAttribute(p);
    else {
      switch (typeof y) {
        case "undefined":
        case "function":
        case "symbol":
        case "boolean":
          o.removeAttribute(p);
          return;
      }
      o.setAttributeNS(l, p, "" + y);
    }
  }
  function Nr(o) {
    switch (typeof o) {
      case "bigint":
      case "boolean":
      case "number":
      case "string":
      case "undefined":
        return o;
      case "object":
        return o;
      default:
        return "";
    }
  }
  function Hs(o) {
    var l = o.type;
    return (o = o.nodeName) && o.toLowerCase() === "input" && (l === "checkbox" || l === "radio");
  }
  function cc(o, l, p) {
    var y = Object.getOwnPropertyDescriptor(
      o.constructor.prototype,
      l
    );
    if (!o.hasOwnProperty(l) && typeof y < "u" && typeof y.get == "function" && typeof y.set == "function") {
      var E = y.get, A = y.set;
      return Object.defineProperty(o, l, {
        configurable: !0,
        get: function() {
          return E.call(this);
        },
        set: function(B) {
          p = "" + B, A.call(this, B);
        }
      }), Object.defineProperty(o, l, {
        enumerable: y.enumerable
      }), {
        getValue: function() {
          return p;
        },
        setValue: function(B) {
          p = "" + B;
        },
        stopTracking: function() {
          o._valueTracker = null, delete o[l];
        }
      };
    }
  }
  function Vs(o) {
    if (!o._valueTracker) {
      var l = Hs(o) ? "checked" : "value";
      o._valueTracker = cc(
        o,
        l,
        "" + o[l]
      );
    }
  }
  function Ha(o) {
    if (!o) return !1;
    var l = o._valueTracker;
    if (!l) return !0;
    var p = l.getValue(), y = "";
    return o && (y = Hs(o) ? o.checked ? "true" : "false" : o.value), o = y, o !== p ? (l.setValue(o), !0) : !1;
  }
  function ln(o) {
    if (o = o || (typeof document < "u" ? document : void 0), typeof o > "u") return null;
    try {
      return o.activeElement || o.body;
    } catch {
      return o.body;
    }
  }
  var yo = /[\n"\\]/g;
  function Sr(o) {
    return o.replace(
      yo,
      function(l) {
        return "\\" + l.charCodeAt(0).toString(16) + " ";
      }
    );
  }
  function Mi(o, l, p, y, E, A, B, ne) {
    o.name = "", B != null && typeof B != "function" && typeof B != "symbol" && typeof B != "boolean" ? o.type = B : o.removeAttribute("type"), l != null ? B === "number" ? (l === 0 && o.value === "" || o.value != l) && (o.value = "" + Nr(l)) : o.value !== "" + Nr(l) && (o.value = "" + Nr(l)) : B !== "submit" && B !== "reset" || o.removeAttribute("value"), l != null ? xo(o, B, Nr(l)) : p != null ? xo(o, B, Nr(p)) : y != null && o.removeAttribute("value"), E == null && A != null && (o.defaultChecked = !!A), E != null && (o.checked = E && typeof E != "function" && typeof E != "symbol"), ne != null && typeof ne != "function" && typeof ne != "symbol" && typeof ne != "boolean" ? o.name = "" + Nr(ne) : o.removeAttribute("name");
  }
  function Va(o, l, p, y, E, A, B, ne) {
    if (A != null && typeof A != "function" && typeof A != "symbol" && typeof A != "boolean" && (o.type = A), l != null || p != null) {
      if (!(A !== "submit" && A !== "reset" || l != null)) {
        Vs(o);
        return;
      }
      p = p != null ? "" + Nr(p) : "", l = l != null ? "" + Nr(l) : p, ne || l === o.value || (o.value = l), o.defaultValue = l;
    }
    y = y ?? E, y = typeof y != "function" && typeof y != "symbol" && !!y, o.checked = ne ? o.checked : !!y, o.defaultChecked = !!y, B != null && typeof B != "function" && typeof B != "symbol" && typeof B != "boolean" && (o.name = B), Vs(o);
  }
  function xo(o, l, p) {
    l === "number" && ln(o.ownerDocument) === o || o.defaultValue === "" + p || (o.defaultValue = "" + p);
  }
  function Oi(o, l, p, y) {
    if (o = o.options, l) {
      l = {};
      for (var E = 0; E < p.length; E++)
        l["$" + p[E]] = !0;
      for (p = 0; p < o.length; p++)
        E = l.hasOwnProperty("$" + o[p].value), o[p].selected !== E && (o[p].selected = E), E && y && (o[p].defaultSelected = !0);
    } else {
      for (p = "" + Nr(p), l = null, E = 0; E < o.length; E++) {
        if (o[E].value === p) {
          o[E].selected = !0, y && (o[E].defaultSelected = !0);
          return;
        }
        l !== null || o[E].disabled || (l = o[E]);
      }
      l !== null && (l.selected = !0);
    }
  }
  function pu(o, l, p) {
    if (l != null && (l = "" + Nr(l), l !== o.value && (o.value = l), p == null)) {
      o.defaultValue !== l && (o.defaultValue = l);
      return;
    }
    o.defaultValue = p != null ? "" + Nr(p) : "";
  }
  function vo(o, l, p, y) {
    if (l == null) {
      if (y != null) {
        if (p != null) throw Error(r(92));
        if (oe(y)) {
          if (1 < y.length) throw Error(r(93));
          y = y[0];
        }
        p = y;
      }
      p == null && (p = ""), l = p;
    }
    p = Nr(l), o.defaultValue = p, y = o.textContent, y === p && y !== "" && y !== null && (o.value = y), Vs(o);
  }
  function Vi(o, l) {
    if (l) {
      var p = o.firstChild;
      if (p && p === o.lastChild && p.nodeType === 3) {
        p.nodeValue = l;
        return;
      }
    }
    o.textContent = l;
  }
  var Oh = new Set(
    "animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(
      " "
    )
  );
  function rn(o, l, p) {
    var y = l.indexOf("--") === 0;
    p == null || typeof p == "boolean" || p === "" ? y ? o.setProperty(l, "") : l === "float" ? o.cssFloat = "" : o[l] = "" : y ? o.setProperty(l, p) : typeof p != "number" || p === 0 || Oh.has(l) ? l === "float" ? o.cssFloat = p : o[l] = ("" + p).trim() : o[l] = p + "px";
  }
  function zd(o, l, p) {
    if (l != null && typeof l != "object")
      throw Error(r(62));
    if (o = o.style, p != null) {
      for (var y in p)
        !p.hasOwnProperty(y) || l != null && l.hasOwnProperty(y) || (y.indexOf("--") === 0 ? o.setProperty(y, "") : y === "float" ? o.cssFloat = "" : o[y] = "");
      for (var E in l)
        y = l[E], l.hasOwnProperty(E) && p[E] !== y && rn(o, E, y);
    } else
      for (var A in l)
        l.hasOwnProperty(A) && rn(o, A, l[A]);
  }
  function dc(o) {
    if (o.indexOf("-") === -1) return !1;
    switch (o) {
      case "annotation-xml":
      case "color-profile":
      case "font-face":
      case "font-face-src":
      case "font-face-uri":
      case "font-face-format":
      case "font-face-name":
      case "missing-glyph":
        return !1;
      default:
        return !0;
    }
  }
  var Dh = /* @__PURE__ */ new Map([
    ["acceptCharset", "accept-charset"],
    ["htmlFor", "for"],
    ["httpEquiv", "http-equiv"],
    ["crossOrigin", "crossorigin"],
    ["accentHeight", "accent-height"],
    ["alignmentBaseline", "alignment-baseline"],
    ["arabicForm", "arabic-form"],
    ["baselineShift", "baseline-shift"],
    ["capHeight", "cap-height"],
    ["clipPath", "clip-path"],
    ["clipRule", "clip-rule"],
    ["colorInterpolation", "color-interpolation"],
    ["colorInterpolationFilters", "color-interpolation-filters"],
    ["colorProfile", "color-profile"],
    ["colorRendering", "color-rendering"],
    ["dominantBaseline", "dominant-baseline"],
    ["enableBackground", "enable-background"],
    ["fillOpacity", "fill-opacity"],
    ["fillRule", "fill-rule"],
    ["floodColor", "flood-color"],
    ["floodOpacity", "flood-opacity"],
    ["fontFamily", "font-family"],
    ["fontSize", "font-size"],
    ["fontSizeAdjust", "font-size-adjust"],
    ["fontStretch", "font-stretch"],
    ["fontStyle", "font-style"],
    ["fontVariant", "font-variant"],
    ["fontWeight", "font-weight"],
    ["glyphName", "glyph-name"],
    ["glyphOrientationHorizontal", "glyph-orientation-horizontal"],
    ["glyphOrientationVertical", "glyph-orientation-vertical"],
    ["horizAdvX", "horiz-adv-x"],
    ["horizOriginX", "horiz-origin-x"],
    ["imageRendering", "image-rendering"],
    ["letterSpacing", "letter-spacing"],
    ["lightingColor", "lighting-color"],
    ["markerEnd", "marker-end"],
    ["markerMid", "marker-mid"],
    ["markerStart", "marker-start"],
    ["overlinePosition", "overline-position"],
    ["overlineThickness", "overline-thickness"],
    ["paintOrder", "paint-order"],
    ["panose-1", "panose-1"],
    ["pointerEvents", "pointer-events"],
    ["renderingIntent", "rendering-intent"],
    ["shapeRendering", "shape-rendering"],
    ["stopColor", "stop-color"],
    ["stopOpacity", "stop-opacity"],
    ["strikethroughPosition", "strikethrough-position"],
    ["strikethroughThickness", "strikethrough-thickness"],
    ["strokeDasharray", "stroke-dasharray"],
    ["strokeDashoffset", "stroke-dashoffset"],
    ["strokeLinecap", "stroke-linecap"],
    ["strokeLinejoin", "stroke-linejoin"],
    ["strokeMiterlimit", "stroke-miterlimit"],
    ["strokeOpacity", "stroke-opacity"],
    ["strokeWidth", "stroke-width"],
    ["textAnchor", "text-anchor"],
    ["textDecoration", "text-decoration"],
    ["textRendering", "text-rendering"],
    ["transformOrigin", "transform-origin"],
    ["underlinePosition", "underline-position"],
    ["underlineThickness", "underline-thickness"],
    ["unicodeBidi", "unicode-bidi"],
    ["unicodeRange", "unicode-range"],
    ["unitsPerEm", "units-per-em"],
    ["vAlphabetic", "v-alphabetic"],
    ["vHanging", "v-hanging"],
    ["vIdeographic", "v-ideographic"],
    ["vMathematical", "v-mathematical"],
    ["vectorEffect", "vector-effect"],
    ["vertAdvY", "vert-adv-y"],
    ["vertOriginX", "vert-origin-x"],
    ["vertOriginY", "vert-origin-y"],
    ["wordSpacing", "word-spacing"],
    ["writingMode", "writing-mode"],
    ["xmlnsXlink", "xmlns:xlink"],
    ["xHeight", "x-height"]
  ]), _i = /^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;
  function Gs(o) {
    return _i.test("" + o) ? "javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')" : o;
  }
  function Gi() {
  }
  var Ks = null;
  function fc(o) {
    return o = o.target || o.srcElement || window, o.correspondingUseElement && (o = o.correspondingUseElement), o.nodeType === 3 ? o.parentNode : o;
  }
  var Ga = null, Kn = null;
  function hs(o) {
    var l = mn(o);
    if (l && (o = l.stateNode)) {
      var p = o[ar] || null;
      e: switch (o = l.stateNode, l.type) {
        case "input":
          if (Mi(
            o,
            p.value,
            p.defaultValue,
            p.defaultValue,
            p.checked,
            p.defaultChecked,
            p.type,
            p.name
          ), l = p.name, p.type === "radio" && l != null) {
            for (p = o; p.parentNode; ) p = p.parentNode;
            for (p = p.querySelectorAll(
              'input[name="' + Sr(
                "" + l
              ) + '"][type="radio"]'
            ), l = 0; l < p.length; l++) {
              var y = p[l];
              if (y !== o && y.form === o.form) {
                var E = y[ar] || null;
                if (!E) throw Error(r(90));
                Mi(
                  y,
                  E.value,
                  E.defaultValue,
                  E.defaultValue,
                  E.checked,
                  E.defaultChecked,
                  E.type,
                  E.name
                );
              }
            }
            for (l = 0; l < p.length; l++)
              y = p[l], y.form === o.form && Ha(y);
          }
          break e;
        case "textarea":
          pu(o, p.value, p.defaultValue);
          break e;
        case "select":
          l = p.value, l != null && Oi(o, !!p.multiple, l, !1);
      }
    }
  }
  var bo = !1;
  function ul(o, l, p) {
    if (bo) return o(l, p);
    bo = !0;
    try {
      var y = o(l);
      return y;
    } finally {
      if (bo = !1, (Ga !== null || Kn !== null) && (Sp(), Ga && (l = Ga, o = Kn, Kn = Ga = null, hs(l), o)))
        for (l = 0; l < o.length; l++) hs(o[l]);
    }
  }
  function va(o, l) {
    var p = o.stateNode;
    if (p === null) return null;
    var y = p[ar] || null;
    if (y === null) return null;
    p = y[l];
    e: switch (l) {
      case "onClick":
      case "onClickCapture":
      case "onDoubleClick":
      case "onDoubleClickCapture":
      case "onMouseDown":
      case "onMouseDownCapture":
      case "onMouseMove":
      case "onMouseMoveCapture":
      case "onMouseUp":
      case "onMouseUpCapture":
      case "onMouseEnter":
        (y = !y.disabled) || (o = o.type, y = !(o === "button" || o === "input" || o === "select" || o === "textarea")), o = !y;
        break e;
      default:
        o = !1;
    }
    if (o) return null;
    if (p && typeof p != "function")
      throw Error(
        r(231, l, typeof p)
      );
    return p;
  }
  var Wr = !(typeof window > "u" || typeof window.document > "u" || typeof window.document.createElement > "u"), Pd = !1;
  if (Wr)
    try {
      var Si = {};
      Object.defineProperty(Si, "passive", {
        get: function() {
          Pd = !0;
        }
      }), window.addEventListener("test", Si, Si), window.removeEventListener("test", Si, Si);
    } catch {
      Pd = !1;
    }
  var Ys = null, hc = null, vn = null;
  function gn() {
    if (vn) return vn;
    var o, l = hc, p = l.length, y, E = "value" in Ys ? Ys.value : Ys.textContent, A = E.length;
    for (o = 0; o < p && l[o] === E[o]; o++) ;
    var B = p - o;
    for (y = 1; y <= B && l[p - y] === E[A - y]; y++) ;
    return vn = E.slice(o, 1 < y ? 1 - y : void 0);
  }
  function cl(o) {
    var l = o.keyCode;
    return "charCode" in o ? (o = o.charCode, o === 0 && l === 13 && (o = 13)) : o = l, o === 10 && (o = 13), 32 <= o || o === 13 ? o : 0;
  }
  function mu() {
    return !0;
  }
  function zh() {
    return !1;
  }
  function Rr(o) {
    function l(p, y, E, A, B) {
      this._reactName = p, this._targetInst = E, this.type = y, this.nativeEvent = A, this.target = B, this.currentTarget = null;
      for (var ne in o)
        o.hasOwnProperty(ne) && (p = o[ne], this[ne] = p ? p(A) : A[ne]);
      return this.isDefaultPrevented = (A.defaultPrevented != null ? A.defaultPrevented : A.returnValue === !1) ? mu : zh, this.isPropagationStopped = zh, this;
    }
    return m(l.prototype, {
      preventDefault: function() {
        this.defaultPrevented = !0;
        var p = this.nativeEvent;
        p && (p.preventDefault ? p.preventDefault() : typeof p.returnValue != "unknown" && (p.returnValue = !1), this.isDefaultPrevented = mu);
      },
      stopPropagation: function() {
        var p = this.nativeEvent;
        p && (p.stopPropagation ? p.stopPropagation() : typeof p.cancelBubble != "unknown" && (p.cancelBubble = !0), this.isPropagationStopped = mu);
      },
      persist: function() {
      },
      isPersistent: mu
    }), l;
  }
  var wo = {
    eventPhase: 0,
    bubbles: 0,
    cancelable: 0,
    timeStamp: function(o) {
      return o.timeStamp || Date.now();
    },
    defaultPrevented: 0,
    isTrusted: 0
  }, pc = Rr(wo), ba = m({}, wo, { view: 0, detail: 0 }), mc = Rr(ba), lr, gu, ps, yu = m({}, ba, {
    screenX: 0,
    screenY: 0,
    clientX: 0,
    clientY: 0,
    pageX: 0,
    pageY: 0,
    ctrlKey: 0,
    shiftKey: 0,
    altKey: 0,
    metaKey: 0,
    getModifierState: wa,
    button: 0,
    buttons: 0,
    relatedTarget: function(o) {
      return o.relatedTarget === void 0 ? o.fromElement === o.srcElement ? o.toElement : o.fromElement : o.relatedTarget;
    },
    movementX: function(o) {
      return "movementX" in o ? o.movementX : (o !== ps && (ps && o.type === "mousemove" ? (lr = o.screenX - ps.screenX, gu = o.screenY - ps.screenY) : gu = lr = 0, ps = o), lr);
    },
    movementY: function(o) {
      return "movementY" in o ? o.movementY : gu;
    }
  }), dl = Rr(yu), Ei = m({}, yu, { dataTransfer: 0 }), Id = Rr(Ei), xu = m({}, ba, { relatedTarget: 0 }), _o = Rr(xu), vu = m({}, wo, {
    animationName: 0,
    elapsedTime: 0,
    pseudoElement: 0
  }), Ld = Rr(vu), Ph = m({}, wo, {
    clipboardData: function(o) {
      return "clipboardData" in o ? o.clipboardData : window.clipboardData;
    }
  }), Mr = Rr(Ph), Bd = m({}, wo, { data: 0 }), ai = Rr(Bd), $d = {
    Esc: "Escape",
    Spacebar: " ",
    Left: "ArrowLeft",
    Up: "ArrowUp",
    Right: "ArrowRight",
    Down: "ArrowDown",
    Del: "Delete",
    Win: "OS",
    Menu: "ContextMenu",
    Apps: "ContextMenu",
    Scroll: "ScrollLock",
    MozPrintableKey: "Unidentified"
  }, gc = {
    8: "Backspace",
    9: "Tab",
    12: "Clear",
    13: "Enter",
    16: "Shift",
    17: "Control",
    18: "Alt",
    19: "Pause",
    20: "CapsLock",
    27: "Escape",
    32: " ",
    33: "PageUp",
    34: "PageDown",
    35: "End",
    36: "Home",
    37: "ArrowLeft",
    38: "ArrowUp",
    39: "ArrowRight",
    40: "ArrowDown",
    45: "Insert",
    46: "Delete",
    112: "F1",
    113: "F2",
    114: "F3",
    115: "F4",
    116: "F5",
    117: "F6",
    118: "F7",
    119: "F8",
    120: "F9",
    121: "F10",
    122: "F11",
    123: "F12",
    144: "NumLock",
    145: "ScrollLock",
    224: "Meta"
  }, Yn = {
    Alt: "altKey",
    Control: "ctrlKey",
    Meta: "metaKey",
    Shift: "shiftKey"
  };
  function Ka(o) {
    var l = this.nativeEvent;
    return l.getModifierState ? l.getModifierState(o) : (o = Yn[o]) ? !!l[o] : !1;
  }
  function wa() {
    return Ka;
  }
  var In = m({}, ba, {
    key: function(o) {
      if (o.key) {
        var l = $d[o.key] || o.key;
        if (l !== "Unidentified") return l;
      }
      return o.type === "keypress" ? (o = cl(o), o === 13 ? "Enter" : String.fromCharCode(o)) : o.type === "keydown" || o.type === "keyup" ? gc[o.keyCode] || "Unidentified" : "";
    },
    code: 0,
    location: 0,
    ctrlKey: 0,
    shiftKey: 0,
    altKey: 0,
    metaKey: 0,
    repeat: 0,
    locale: 0,
    getModifierState: wa,
    charCode: function(o) {
      return o.type === "keypress" ? cl(o) : 0;
    },
    keyCode: function(o) {
      return o.type === "keydown" || o.type === "keyup" ? o.keyCode : 0;
    },
    which: function(o) {
      return o.type === "keypress" ? cl(o) : o.type === "keydown" || o.type === "keyup" ? o.keyCode : 0;
    }
  }), ms = Rr(In), yc = m({}, yu, {
    pointerId: 0,
    width: 0,
    height: 0,
    pressure: 0,
    tangentialPressure: 0,
    tiltX: 0,
    tiltY: 0,
    twist: 0,
    pointerType: 0,
    isPrimary: 0
  }), qd = Rr(yc), fl = m({}, ba, {
    touches: 0,
    targetTouches: 0,
    changedTouches: 0,
    altKey: 0,
    metaKey: 0,
    ctrlKey: 0,
    shiftKey: 0,
    getModifierState: wa
  }), Fd = Rr(fl), So = m({}, wo, {
    propertyName: 0,
    elapsedTime: 0,
    pseudoElement: 0
  }), Ud = Rr(So), xc = m({}, yu, {
    deltaX: function(o) {
      return "deltaX" in o ? o.deltaX : "wheelDeltaX" in o ? -o.wheelDeltaX : 0;
    },
    deltaY: function(o) {
      return "deltaY" in o ? o.deltaY : "wheelDeltaY" in o ? -o.wheelDeltaY : "wheelDelta" in o ? -o.wheelDelta : 0;
    },
    deltaZ: 0,
    deltaMode: 0
  }), Eo = Rr(xc), Ya = m({}, wo, {
    newState: 0,
    oldState: 0
  }), Ih = Rr(Ya), Lh = [9, 13, 27, 32], hl = Wr && "CompositionEvent" in window, Ws = null;
  Wr && "documentMode" in document && (Ws = document.documentMode);
  var Hd = Wr && "TextEvent" in window && !Ws, bu = Wr && (!hl || Ws && 8 < Ws && 11 >= Ws), vc = " ", bc = !1;
  function wu(o, l) {
    switch (o) {
      case "keyup":
        return Lh.indexOf(l.keyCode) !== -1;
      case "keydown":
        return l.keyCode !== 229;
      case "keypress":
      case "mousedown":
      case "focusout":
        return !0;
      default:
        return !1;
    }
  }
  function Bh(o) {
    return o = o.detail, typeof o == "object" && "data" in o ? o.data : null;
  }
  var Wa = !1;
  function Ci(o, l) {
    switch (o) {
      case "compositionend":
        return Bh(l);
      case "keypress":
        return l.which !== 32 ? null : (bc = !0, vc);
      case "textInput":
        return o = l.data, o === vc && bc ? null : o;
      default:
        return null;
    }
  }
  function Vd(o, l) {
    if (Wa)
      return o === "compositionend" || !hl && wu(o, l) ? (o = gn(), vn = hc = Ys = null, Wa = !1, o) : null;
    switch (o) {
      case "paste":
        return null;
      case "keypress":
        if (!(l.ctrlKey || l.altKey || l.metaKey) || l.ctrlKey && l.altKey) {
          if (l.char && 1 < l.char.length)
            return l.char;
          if (l.which) return String.fromCharCode(l.which);
        }
        return null;
      case "compositionend":
        return bu && l.locale !== "ko" ? null : l.data;
      default:
        return null;
    }
  }
  var pl = {
    color: !0,
    date: !0,
    datetime: !0,
    "datetime-local": !0,
    email: !0,
    month: !0,
    number: !0,
    password: !0,
    range: !0,
    search: !0,
    tel: !0,
    text: !0,
    time: !0,
    url: !0,
    week: !0
  };
  function _u(o) {
    var l = o && o.nodeName && o.nodeName.toLowerCase();
    return l === "input" ? !!pl[o.type] : l === "textarea";
  }
  function wc(o, l, p, y) {
    Ga ? Kn ? Kn.push(y) : Kn = [y] : Ga = y, l = Lf(l, "onChange"), 0 < l.length && (p = new pc(
      "onChange",
      "change",
      null,
      p,
      y
    ), o.push({ event: p, listeners: l }));
  }
  var ml = null, Su = null;
  function ig(o) {
    Cv(o, 0);
  }
  function _c(o) {
    var l = wi(o);
    if (Ha(l)) return o;
  }
  function Eu(o, l) {
    if (o === "change") return l;
  }
  var oi = !1;
  if (Wr) {
    var Wn;
    if (Wr) {
      var gl = "oninput" in document;
      if (!gl) {
        var li = document.createElement("div");
        li.setAttribute("oninput", "return;"), gl = typeof li.oninput == "function";
      }
      Wn = gl;
    } else Wn = !1;
    oi = Wn && (!document.documentMode || 9 < document.documentMode);
  }
  function Gd() {
    ml && (ml.detachEvent("onpropertychange", gs), Su = ml = null);
  }
  function gs(o) {
    if (o.propertyName === "value" && _c(Su)) {
      var l = [];
      wc(
        l,
        Su,
        o,
        fc(o)
      ), ul(ig, l);
    }
  }
  function Cu(o, l, p) {
    o === "focusin" ? (Gd(), ml = l, Su = p, ml.attachEvent("onpropertychange", gs)) : o === "focusout" && Gd();
  }
  function Co(o) {
    if (o === "selectionchange" || o === "keyup" || o === "keydown")
      return _c(Su);
  }
  function Kd(o, l) {
    if (o === "click") return _c(l);
  }
  function yl(o, l) {
    if (o === "input" || o === "change")
      return _c(l);
  }
  function Di(o, l) {
    return o === l && (o !== 0 || 1 / o === 1 / l) || o !== o && l !== l;
  }
  var Vn = typeof Object.is == "function" ? Object.is : Di;
  function _(o, l) {
    if (Vn(o, l)) return !0;
    if (typeof o != "object" || o === null || typeof l != "object" || l === null)
      return !1;
    var p = Object.keys(o), y = Object.keys(l);
    if (p.length !== y.length) return !1;
    for (y = 0; y < p.length; y++) {
      var E = p[y];
      if (!Dt.call(l, E) || !Vn(o[E], l[E]))
        return !1;
    }
    return !0;
  }
  function j(o) {
    for (; o && o.firstChild; ) o = o.firstChild;
    return o;
  }
  function O(o, l) {
    var p = j(o);
    o = 0;
    for (var y; p; ) {
      if (p.nodeType === 3) {
        if (y = o + p.textContent.length, o <= l && y >= l)
          return { node: p, offset: l - o };
        o = y;
      }
      e: {
        for (; p; ) {
          if (p.nextSibling) {
            p = p.nextSibling;
            break e;
          }
          p = p.parentNode;
        }
        p = void 0;
      }
      p = j(p);
    }
  }
  function L(o, l) {
    return o && l ? o === l ? !0 : o && o.nodeType === 3 ? !1 : l && l.nodeType === 3 ? L(o, l.parentNode) : "contains" in o ? o.contains(l) : o.compareDocumentPosition ? !!(o.compareDocumentPosition(l) & 16) : !1 : !1;
  }
  function F(o) {
    o = o != null && o.ownerDocument != null && o.ownerDocument.defaultView != null ? o.ownerDocument.defaultView : window;
    for (var l = ln(o.document); l instanceof o.HTMLIFrameElement; ) {
      try {
        var p = typeof l.contentWindow.location.href == "string";
      } catch {
        p = !1;
      }
      if (p) o = l.contentWindow;
      else break;
      l = ln(o.document);
    }
    return l;
  }
  function W(o) {
    var l = o && o.nodeName && o.nodeName.toLowerCase();
    return l && (l === "input" && (o.type === "text" || o.type === "search" || o.type === "tel" || o.type === "url" || o.type === "password") || l === "textarea" || o.contentEditable === "true");
  }
  var ue = Wr && "documentMode" in document && 11 >= document.documentMode, U = null, se = null, ie = null, me = !1;
  function he(o, l, p) {
    var y = p.window === p ? p.document : p.nodeType === 9 ? p : p.ownerDocument;
    me || U == null || U !== ln(y) || (y = U, "selectionStart" in y && W(y) ? y = { start: y.selectionStart, end: y.selectionEnd } : (y = (y.ownerDocument && y.ownerDocument.defaultView || window).getSelection(), y = {
      anchorNode: y.anchorNode,
      anchorOffset: y.anchorOffset,
      focusNode: y.focusNode,
      focusOffset: y.focusOffset
    }), ie && _(ie, y) || (ie = y, y = Lf(se, "onSelect"), 0 < y.length && (l = new pc(
      "onSelect",
      "select",
      null,
      l,
      p
    ), o.push({ event: l, listeners: y }), l.target = U)));
  }
  function _e(o, l) {
    var p = {};
    return p[o.toLowerCase()] = l.toLowerCase(), p["Webkit" + o] = "webkit" + l, p["Moz" + o] = "moz" + l, p;
  }
  var be = {
    animationend: _e("Animation", "AnimationEnd"),
    animationiteration: _e("Animation", "AnimationIteration"),
    animationstart: _e("Animation", "AnimationStart"),
    transitionrun: _e("Transition", "TransitionRun"),
    transitionstart: _e("Transition", "TransitionStart"),
    transitioncancel: _e("Transition", "TransitionCancel"),
    transitionend: _e("Transition", "TransitionEnd")
  }, we = {}, ke = {};
  Wr && (ke = document.createElement("div").style, "AnimationEvent" in window || (delete be.animationend.animation, delete be.animationiteration.animation, delete be.animationstart.animation), "TransitionEvent" in window || delete be.transitionend.transition);
  function Te(o) {
    if (we[o]) return we[o];
    if (!be[o]) return o;
    var l = be[o], p;
    for (p in l)
      if (l.hasOwnProperty(p) && p in ke)
        return we[o] = l[p];
    return o;
  }
  var Ae = Te("animationend"), ze = Te("animationiteration"), qe = Te("animationstart"), Ve = Te("transitionrun"), rt = Te("transitionstart"), ut = Te("transitioncancel"), He = Te("transitionend"), ot = /* @__PURE__ */ new Map(), ct = "abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(
    " "
  );
  ct.push("scrollEnd");
  function tt(o, l) {
    ot.set(o, l), Hi(l, [o]);
  }
  var vt = typeof reportError == "function" ? reportError : function(o) {
    if (typeof window == "object" && typeof window.ErrorEvent == "function") {
      var l = new window.ErrorEvent("error", {
        bubbles: !0,
        cancelable: !0,
        message: typeof o == "object" && o !== null && typeof o.message == "string" ? String(o.message) : String(o),
        error: o
      });
      if (!window.dispatchEvent(l)) return;
    } else if (typeof process == "object" && typeof process.emit == "function") {
      process.emit("uncaughtException", o);
      return;
    }
    console.error(o);
  }, Ct = [], Lt = 0, qt = 0;
  function Zn() {
    for (var o = Lt, l = qt = Lt = 0; l < o; ) {
      var p = Ct[l];
      Ct[l++] = null;
      var y = Ct[l];
      Ct[l++] = null;
      var E = Ct[l];
      Ct[l++] = null;
      var A = Ct[l];
      if (Ct[l++] = null, y !== null && E !== null) {
        var B = y.pending;
        B === null ? E.next = E : (E.next = B.next, B.next = E), y.pending = E;
      }
      A !== 0 && xl(p, E, A);
    }
  }
  function Rt(o, l, p, y) {
    Ct[Lt++] = o, Ct[Lt++] = l, Ct[Lt++] = p, Ct[Lt++] = y, qt |= y, o.lanes |= y, o = o.alternate, o !== null && (o.lanes |= y);
  }
  function Er(o, l, p, y) {
    return Rt(o, l, p, y), Cr(o);
  }
  function Ln(o, l) {
    return Rt(o, null, null, l), Cr(o);
  }
  function xl(o, l, p) {
    o.lanes |= p;
    var y = o.alternate;
    y !== null && (y.lanes |= p);
    for (var E = !1, A = o.return; A !== null; )
      A.childLanes |= p, y = A.alternate, y !== null && (y.childLanes |= p), A.tag === 22 && (o = A.stateNode, o === null || o._visibility & 1 || (E = !0)), o = A, A = A.return;
    return o.tag === 3 ? (A = o.stateNode, E && l !== null && (E = 31 - nt(p), o = A.hiddenUpdates, y = o[E], y === null ? o[E] = [l] : y.push(l), l.lane = p | 536870912), A) : null;
  }
  function Cr(o) {
    if (50 < Rf)
      throw Rf = 0, r0 = null, Error(r(185));
    for (var l = o.return; l !== null; )
      o = l, l = o.return;
    return o.tag === 3 ? o.stateNode : null;
  }
  var ui = {};
  function Sc(o, l, p, y) {
    this.tag = o, this.key = p, this.sibling = this.child = this.return = this.stateNode = this.type = this.elementType = null, this.index = 0, this.refCleanup = this.ref = null, this.pendingProps = l, this.dependencies = this.memoizedState = this.updateQueue = this.memoizedProps = null, this.mode = y, this.subtreeFlags = this.flags = 0, this.deletions = null, this.childLanes = this.lanes = 0, this.alternate = null;
  }
  function ci(o, l, p, y) {
    return new Sc(o, l, p, y);
  }
  function ko(o) {
    return o = o.prototype, !(!o || !o.isReactComponent);
  }
  function Zs(o, l) {
    var p = o.alternate;
    return p === null ? (p = ci(
      o.tag,
      l,
      o.key,
      o.mode
    ), p.elementType = o.elementType, p.type = o.type, p.stateNode = o.stateNode, p.alternate = o, o.alternate = p) : (p.pendingProps = l, p.type = o.type, p.flags = 0, p.subtreeFlags = 0, p.deletions = null), p.flags = o.flags & 65011712, p.childLanes = o.childLanes, p.lanes = o.lanes, p.child = o.child, p.memoizedProps = o.memoizedProps, p.memoizedState = o.memoizedState, p.updateQueue = o.updateQueue, l = o.dependencies, p.dependencies = l === null ? null : { lanes: l.lanes, firstContext: l.firstContext }, p.sibling = o.sibling, p.index = o.index, p.ref = o.ref, p.refCleanup = o.refCleanup, p;
  }
  function bx(o, l) {
    o.flags &= 65011714;
    var p = o.alternate;
    return p === null ? (o.childLanes = 0, o.lanes = l, o.child = null, o.subtreeFlags = 0, o.memoizedProps = null, o.memoizedState = null, o.updateQueue = null, o.dependencies = null, o.stateNode = null) : (o.childLanes = p.childLanes, o.lanes = p.lanes, o.child = p.child, o.subtreeFlags = 0, o.deletions = null, o.memoizedProps = p.memoizedProps, o.memoizedState = p.memoizedState, o.updateQueue = p.updateQueue, o.type = p.type, l = p.dependencies, o.dependencies = l === null ? null : {
      lanes: l.lanes,
      firstContext: l.firstContext
    }), o;
  }
  function $h(o, l, p, y, E, A) {
    var B = 0;
    if (y = o, typeof o == "function") ko(o) && (B = 1);
    else if (typeof o == "string")
      B = S2(
        o,
        p,
        fe.current
      ) ? 26 : o === "html" || o === "head" || o === "body" ? 27 : 5;
    else
      e: switch (o) {
        case te:
          return o = ci(31, p, l, E), o.elementType = te, o.lanes = A, o;
        case S:
          return ku(p.children, E, A, l);
        case C:
          B = 8, E |= 24;
          break;
        case T:
          return o = ci(12, p, l, E | 2), o.elementType = T, o.lanes = A, o;
        case P:
          return o = ci(13, p, l, E), o.elementType = P, o.lanes = A, o;
        case D:
          return o = ci(19, p, l, E), o.elementType = D, o.lanes = A, o;
        default:
          if (typeof o == "object" && o !== null)
            switch (o.$$typeof) {
              case N:
                B = 10;
                break e;
              case R:
                B = 9;
                break e;
              case M:
                B = 11;
                break e;
              case q:
                B = 14;
                break e;
              case Y:
                B = 16, y = null;
                break e;
            }
          B = 29, p = Error(
            r(130, o === null ? "null" : typeof o, "")
          ), y = null;
      }
    return l = ci(B, p, l, E), l.elementType = o, l.type = y, l.lanes = A, l;
  }
  function ku(o, l, p, y) {
    return o = ci(7, o, y, l), o.lanes = p, o;
  }
  function Ec(o, l, p) {
    return o = ci(6, o, null, l), o.lanes = p, o;
  }
  function Yd(o) {
    var l = ci(18, null, null, 0);
    return l.stateNode = o, l;
  }
  function Wd(o, l, p) {
    return l = ci(
      4,
      o.children !== null ? o.children : [],
      o.key,
      l
    ), l.lanes = p, l.stateNode = {
      containerInfo: o.containerInfo,
      pendingChildren: null,
      implementation: o.implementation
    }, l;
  }
  var wx = /* @__PURE__ */ new WeakMap();
  function ys(o, l) {
    if (typeof o == "object" && o !== null) {
      var p = wx.get(o);
      return p !== void 0 ? p : (l = {
        value: o,
        source: l,
        stack: gt(l)
      }, wx.set(o, l), l);
    }
    return {
      value: o,
      source: l,
      stack: gt(l)
    };
  }
  var Cc = [], kc = 0, hr = null, Or = 0, Xs = [], Qs = 0, To = null, Za = 1, Js = "";
  function xs(o, l) {
    Cc[kc++] = Or, Cc[kc++] = hr, hr = o, Or = l;
  }
  function qh(o, l, p) {
    Xs[Qs++] = Za, Xs[Qs++] = Js, Xs[Qs++] = To, To = o;
    var y = Za;
    o = Js;
    var E = 32 - nt(y) - 1;
    y &= ~(1 << E), p += 1;
    var A = 32 - nt(l) + E;
    if (30 < A) {
      var B = E - E % 5;
      A = (y & (1 << B) - 1).toString(32), y >>= B, E -= B, Za = 1 << 32 - nt(l) + E | p << E | y, Js = A + o;
    } else
      Za = 1 << A | p << E | y, Js = o;
  }
  function vl(o) {
    o.return !== null && (xs(o, 1), qh(o, 1, 0));
  }
  function Tu(o) {
    for (; o === hr; )
      hr = Cc[--kc], Cc[kc] = null, Or = Cc[--kc], Cc[kc] = null;
    for (; o === To; )
      To = Xs[--Qs], Xs[Qs] = null, Js = Xs[--Qs], Xs[Qs] = null, Za = Xs[--Qs], Xs[Qs] = null;
  }
  function Tc(o, l) {
    Xs[Qs++] = Za, Xs[Qs++] = Js, Xs[Qs++] = To, Za = l.id, Js = l.overflow, To = o;
  }
  var Dr = null, En = null, un = !1, bl = null, ea = !1, sg = Error(r(519));
  function wl(o) {
    var l = Error(
      r(
        418,
        1 < arguments.length && arguments[1] !== void 0 && arguments[1] ? "text" : "HTML",
        ""
      )
    );
    throw Sl(ys(l, o)), sg;
  }
  function Zd(o) {
    var l = o.stateNode, p = o.type, y = o.memoizedProps;
    switch (l[Rn] = o, l[ar] = y, p) {
      case "dialog":
        tn("cancel", l), tn("close", l);
        break;
      case "iframe":
      case "object":
      case "embed":
        tn("load", l);
        break;
      case "video":
      case "audio":
        for (p = 0; p < If.length; p++)
          tn(If[p], l);
        break;
      case "source":
        tn("error", l);
        break;
      case "img":
      case "image":
      case "link":
        tn("error", l), tn("load", l);
        break;
      case "details":
        tn("toggle", l);
        break;
      case "input":
        tn("invalid", l), Va(
          l,
          y.value,
          y.defaultValue,
          y.checked,
          y.defaultChecked,
          y.type,
          y.name,
          !0
        );
        break;
      case "select":
        tn("invalid", l);
        break;
      case "textarea":
        tn("invalid", l), vo(l, y.value, y.defaultValue, y.children);
    }
    p = y.children, typeof p != "string" && typeof p != "number" && typeof p != "bigint" || l.textContent === "" + p || y.suppressHydrationWarning === !0 || jv(l.textContent, p) ? (y.popover != null && (tn("beforetoggle", l), tn("toggle", l)), y.onScroll != null && tn("scroll", l), y.onScrollEnd != null && tn("scrollend", l), y.onClick != null && (l.onclick = Gi), l = !0) : l = !1, l || wl(o, !0);
  }
  function jc(o) {
    for (Dr = o.return; Dr; )
      switch (Dr.tag) {
        case 5:
        case 31:
        case 13:
          ea = !1;
          return;
        case 27:
        case 3:
          ea = !0;
          return;
        default:
          Dr = Dr.return;
      }
  }
  function ju(o) {
    if (o !== Dr) return !1;
    if (!un) return jc(o), un = !0, !1;
    var l = o.tag, p;
    if ((p = l !== 3 && l !== 27) && ((p = l === 5) && (p = o.type, p = !(p !== "form" && p !== "button") || Bl(o.type, o.memoizedProps)), p = !p), p && En && wl(o), jc(o), l === 13) {
      if (o = o.memoizedState, o = o !== null ? o.dehydrated : null, !o) throw Error(r(317));
      En = Ov(o);
    } else if (l === 31) {
      if (o = o.memoizedState, o = o !== null ? o.dehydrated : null, !o) throw Error(r(317));
      En = Ov(o);
    } else
      l === 27 ? (l = En, zt(o.type) ? (o = S0, S0 = null, En = o) : En = l) : En = Dr ? oa(o.stateNode.nextSibling) : null;
    return !0;
  }
  function re() {
    En = Dr = null, un = !1;
  }
  function _l() {
    var o = bl;
    return o !== null && (Ji === null ? Ji = o : Ji.push.apply(
      Ji,
      o
    ), bl = null), o;
  }
  function Sl(o) {
    bl === null ? bl = [o] : bl.push(o);
  }
  var Ki = J(null), Gt = null, jo = null;
  function El(o, l, p) {
    Q(Ki, l._currentValue), l._currentValue = p;
  }
  function Ao(o) {
    o._currentValue = Ki.current, ge(Ki);
  }
  function No(o, l, p) {
    for (; o !== null; ) {
      var y = o.alternate;
      if ((o.childLanes & l) !== l ? (o.childLanes |= l, y !== null && (y.childLanes |= l)) : y !== null && (y.childLanes & l) !== l && (y.childLanes |= l), o === p) break;
      o = o.return;
    }
  }
  function ag(o, l, p, y) {
    var E = o.child;
    for (E !== null && (E.return = o); E !== null; ) {
      var A = E.dependencies;
      if (A !== null) {
        var B = E.child;
        A = A.firstContext;
        e: for (; A !== null; ) {
          var ne = A;
          A = E;
          for (var xe = 0; xe < l.length; xe++)
            if (ne.context === l[xe]) {
              A.lanes |= p, ne = A.alternate, ne !== null && (ne.lanes |= p), No(
                A.return,
                p,
                o
              ), y || (B = null);
              break e;
            }
          A = ne.next;
        }
      } else if (E.tag === 18) {
        if (B = E.return, B === null) throw Error(r(341));
        B.lanes |= p, A = B.alternate, A !== null && (A.lanes |= p), No(B, p, o), B = null;
      } else B = E.child;
      if (B !== null) B.return = E;
      else
        for (B = E; B !== null; ) {
          if (B === o) {
            B = null;
            break;
          }
          if (E = B.sibling, E !== null) {
            E.return = B.return, B = E;
            break;
          }
          B = B.return;
        }
      E = B;
    }
  }
  function Ac(o, l, p, y) {
    o = null;
    for (var E = l, A = !1; E !== null; ) {
      if (!A) {
        if ((E.flags & 524288) !== 0) A = !0;
        else if ((E.flags & 262144) !== 0) break;
      }
      if (E.tag === 10) {
        var B = E.alternate;
        if (B === null) throw Error(r(387));
        if (B = B.memoizedProps, B !== null) {
          var ne = E.type;
          Vn(E.pendingProps.value, B.value) || (o !== null ? o.push(ne) : o = [ne]);
        }
      } else if (E === Me.current) {
        if (B = E.alternate, B === null) throw Error(r(387));
        B.memoizedState.memoizedState !== E.memoizedState.memoizedState && (o !== null ? o.push(ad) : o = [ad]);
      }
      E = E.return;
    }
    o !== null && ag(
      l,
      o,
      p,
      y
    ), l.flags |= 262144;
  }
  function Fh(o) {
    for (o = o.firstContext; o !== null; ) {
      if (!Vn(
        o.context._currentValue,
        o.memoizedValue
      ))
        return !0;
      o = o.next;
    }
    return !1;
  }
  function Au(o) {
    Gt = o, jo = null, o = o.dependencies, o !== null && (o.firstContext = null);
  }
  function di(o) {
    return _x(Gt, o);
  }
  function ta(o, l) {
    return Gt === null && Au(o), _x(o, l);
  }
  function _x(o, l) {
    var p = l._currentValue;
    if (l = { context: l, memoizedValue: p, next: null }, jo === null) {
      if (o === null) throw Error(r(308));
      jo = l, o.dependencies = { lanes: 0, firstContext: l }, o.flags |= 524288;
    } else jo = jo.next = l;
    return p;
  }
  var Uw = typeof AbortController < "u" ? AbortController : function() {
    var o = [], l = this.signal = {
      aborted: !1,
      addEventListener: function(p, y) {
        o.push(y);
      }
    };
    this.abort = function() {
      l.aborted = !0, o.forEach(function(p) {
        return p();
      });
    };
  }, Hw = e.unstable_scheduleCallback, Vw = e.unstable_NormalPriority, zr = {
    $$typeof: N,
    Consumer: null,
    Provider: null,
    _currentValue: null,
    _currentValue2: null,
    _threadCount: 0
  };
  function _a() {
    return {
      controller: new Uw(),
      data: /* @__PURE__ */ new Map(),
      refCount: 0
    };
  }
  function Xd(o) {
    o.refCount--, o.refCount === 0 && Hw(Vw, function() {
      o.controller.abort();
    });
  }
  var Qd = null, og = 0, Nc = 0, Rc = null;
  function Nu(o, l) {
    if (Qd === null) {
      var p = Qd = [];
      og = 0, Nc = Ts(), Rc = {
        status: "pending",
        value: void 0,
        then: function(y) {
          p.push(y);
        }
      };
    }
    return og++, l.then(Sx, Sx), l;
  }
  function Sx() {
    if (--og === 0 && Qd !== null) {
      Rc !== null && (Rc.status = "fulfilled");
      var o = Qd;
      Qd = null, Nc = 0, Rc = null;
      for (var l = 0; l < o.length; l++) (0, o[l])();
    }
  }
  function Gw(o, l) {
    var p = [], y = {
      status: "pending",
      value: null,
      reason: null,
      then: function(E) {
        p.push(E);
      }
    };
    return o.then(
      function() {
        y.status = "fulfilled", y.value = l;
        for (var E = 0; E < p.length; E++) (0, p[E])(l);
      },
      function(E) {
        for (y.status = "rejected", y.reason = E, E = 0; E < p.length; E++)
          (0, p[E])(void 0);
      }
    ), y;
  }
  var na = X.S;
  X.S = function(o, l) {
    ov = kn(), typeof l == "object" && l !== null && typeof l.then == "function" && Nu(o, l), na !== null && na(o, l);
  };
  var Ru = J(null);
  function lg() {
    var o = Ru.current;
    return o !== null ? o : $n.pooledCache;
  }
  function Uh(o, l) {
    l === null ? Q(Ru, Ru.current) : Q(Ru, l.pool);
  }
  function Ex() {
    var o = lg();
    return o === null ? null : { parent: zr._currentValue, pool: o };
  }
  var Mc = Error(r(460)), Hh = Error(r(474)), Jd = Error(r(542)), Vh = { then: function() {
  } };
  function Cx(o) {
    return o = o.status, o === "fulfilled" || o === "rejected";
  }
  function Gh(o, l, p) {
    switch (p = o[p], p === void 0 ? o.push(l) : p !== l && (l.then(Gi, Gi), l = p), l.status) {
      case "fulfilled":
        return l.value;
      case "rejected":
        throw o = l.reason, ug(o), o;
      default:
        if (typeof l.status == "string") l.then(Gi, Gi);
        else {
          if (o = $n, o !== null && 100 < o.shellSuspendCounter)
            throw Error(r(482));
          o = l, o.status = "pending", o.then(
            function(y) {
              if (l.status === "pending") {
                var E = l;
                E.status = "fulfilled", E.value = y;
              }
            },
            function(y) {
              if (l.status === "pending") {
                var E = l;
                E.status = "rejected", E.reason = y;
              }
            }
          );
        }
        switch (l.status) {
          case "fulfilled":
            return l.value;
          case "rejected":
            throw o = l.reason, ug(o), o;
        }
        throw Xa = l, Mc;
    }
  }
  function Sa(o) {
    try {
      var l = o._init;
      return l(o._payload);
    } catch (p) {
      throw p !== null && typeof p == "object" && typeof p.then == "function" ? (Xa = p, Mc) : p;
    }
  }
  var Xa = null;
  function kx() {
    if (Xa === null) throw Error(r(459));
    var o = Xa;
    return Xa = null, o;
  }
  function ug(o) {
    if (o === Mc || o === Jd)
      throw Error(r(483));
  }
  var Oc = null, vs = 0;
  function Dc(o) {
    var l = vs;
    return vs += 1, Oc === null && (Oc = []), Gh(Oc, o, l);
  }
  function Ea(o, l) {
    l = l.props.ref, o.ref = l !== void 0 ? l : null;
  }
  function zi(o, l) {
    throw l.$$typeof === x ? Error(r(525)) : (o = Object.prototype.toString.call(l), Error(
      r(
        31,
        o === "[object Object]" ? "object with keys {" + Object.keys(l).join(", ") + "}" : o
      )
    ));
  }
  function Tx(o) {
    function l(je, Ce) {
      if (o) {
        var Oe = je.deletions;
        Oe === null ? (je.deletions = [Ce], je.flags |= 16) : Oe.push(Ce);
      }
    }
    function p(je, Ce) {
      if (!o) return null;
      for (; Ce !== null; )
        l(je, Ce), Ce = Ce.sibling;
      return null;
    }
    function y(je) {
      for (var Ce = /* @__PURE__ */ new Map(); je !== null; )
        je.key !== null ? Ce.set(je.key, je) : Ce.set(je.index, je), je = je.sibling;
      return Ce;
    }
    function E(je, Ce) {
      return je = Zs(je, Ce), je.index = 0, je.sibling = null, je;
    }
    function A(je, Ce, Oe) {
      return je.index = Oe, o ? (Oe = je.alternate, Oe !== null ? (Oe = Oe.index, Oe < Ce ? (je.flags |= 67108866, Ce) : Oe) : (je.flags |= 67108866, Ce)) : (je.flags |= 1048576, Ce);
    }
    function B(je) {
      return o && je.alternate === null && (je.flags |= 67108866), je;
    }
    function ne(je, Ce, Oe, Ge) {
      return Ce === null || Ce.tag !== 6 ? (Ce = Ec(Oe, je.mode, Ge), Ce.return = je, Ce) : (Ce = E(Ce, Oe), Ce.return = je, Ce);
    }
    function xe(je, Ce, Oe, Ge) {
      var kt = Oe.type;
      return kt === S ? Ue(
        je,
        Ce,
        Oe.props.children,
        Ge,
        Oe.key
      ) : Ce !== null && (Ce.elementType === kt || typeof kt == "object" && kt !== null && kt.$$typeof === Y && Sa(kt) === Ce.type) ? (Ce = E(Ce, Oe.props), Ea(Ce, Oe), Ce.return = je, Ce) : (Ce = $h(
        Oe.type,
        Oe.key,
        Oe.props,
        null,
        je.mode,
        Ge
      ), Ea(Ce, Oe), Ce.return = je, Ce);
    }
    function De(je, Ce, Oe, Ge) {
      return Ce === null || Ce.tag !== 4 || Ce.stateNode.containerInfo !== Oe.containerInfo || Ce.stateNode.implementation !== Oe.implementation ? (Ce = Wd(Oe, je.mode, Ge), Ce.return = je, Ce) : (Ce = E(Ce, Oe.children || []), Ce.return = je, Ce);
    }
    function Ue(je, Ce, Oe, Ge, kt) {
      return Ce === null || Ce.tag !== 7 ? (Ce = ku(
        Oe,
        je.mode,
        Ge,
        kt
      ), Ce.return = je, Ce) : (Ce = E(Ce, Oe), Ce.return = je, Ce);
    }
    function Ke(je, Ce, Oe) {
      if (typeof Ce == "string" && Ce !== "" || typeof Ce == "number" || typeof Ce == "bigint")
        return Ce = Ec(
          "" + Ce,
          je.mode,
          Oe
        ), Ce.return = je, Ce;
      if (typeof Ce == "object" && Ce !== null) {
        switch (Ce.$$typeof) {
          case b:
            return Oe = $h(
              Ce.type,
              Ce.key,
              Ce.props,
              null,
              je.mode,
              Oe
            ), Ea(Oe, Ce), Oe.return = je, Oe;
          case w:
            return Ce = Wd(
              Ce,
              je.mode,
              Oe
            ), Ce.return = je, Ce;
          case Y:
            return Ce = Sa(Ce), Ke(je, Ce, Oe);
        }
        if (oe(Ce) || G(Ce))
          return Ce = ku(
            Ce,
            je.mode,
            Oe,
            null
          ), Ce.return = je, Ce;
        if (typeof Ce.then == "function")
          return Ke(je, Dc(Ce), Oe);
        if (Ce.$$typeof === N)
          return Ke(
            je,
            ta(je, Ce),
            Oe
          );
        zi(je, Ce);
      }
      return null;
    }
    function Pe(je, Ce, Oe, Ge) {
      var kt = Ce !== null ? Ce.key : null;
      if (typeof Oe == "string" && Oe !== "" || typeof Oe == "number" || typeof Oe == "bigint")
        return kt !== null ? null : ne(je, Ce, "" + Oe, Ge);
      if (typeof Oe == "object" && Oe !== null) {
        switch (Oe.$$typeof) {
          case b:
            return Oe.key === kt ? xe(je, Ce, Oe, Ge) : null;
          case w:
            return Oe.key === kt ? De(je, Ce, Oe, Ge) : null;
          case Y:
            return Oe = Sa(Oe), Pe(je, Ce, Oe, Ge);
        }
        if (oe(Oe) || G(Oe))
          return kt !== null ? null : Ue(je, Ce, Oe, Ge, null);
        if (typeof Oe.then == "function")
          return Pe(
            je,
            Ce,
            Dc(Oe),
            Ge
          );
        if (Oe.$$typeof === N)
          return Pe(
            je,
            Ce,
            ta(je, Oe),
            Ge
          );
        zi(je, Oe);
      }
      return null;
    }
    function Be(je, Ce, Oe, Ge, kt) {
      if (typeof Ge == "string" && Ge !== "" || typeof Ge == "number" || typeof Ge == "bigint")
        return je = je.get(Oe) || null, ne(Ce, je, "" + Ge, kt);
      if (typeof Ge == "object" && Ge !== null) {
        switch (Ge.$$typeof) {
          case b:
            return je = je.get(
              Ge.key === null ? Oe : Ge.key
            ) || null, xe(Ce, je, Ge, kt);
          case w:
            return je = je.get(
              Ge.key === null ? Oe : Ge.key
            ) || null, De(Ce, je, Ge, kt);
          case Y:
            return Ge = Sa(Ge), Be(
              je,
              Ce,
              Oe,
              Ge,
              kt
            );
        }
        if (oe(Ge) || G(Ge))
          return je = je.get(Oe) || null, Ue(Ce, je, Ge, kt, null);
        if (typeof Ge.then == "function")
          return Be(
            je,
            Ce,
            Oe,
            Dc(Ge),
            kt
          );
        if (Ge.$$typeof === N)
          return Be(
            je,
            Ce,
            Oe,
            ta(Ce, Ge),
            kt
          );
        zi(Ce, Ge);
      }
      return null;
    }
    function _t(je, Ce, Oe, Ge) {
      for (var kt = null, bn = null, St = Ce, Zt = Ce = 0, an = null; St !== null && Zt < Oe.length; Zt++) {
        St.index > Zt ? (an = St, St = null) : an = St.sibling;
        var wn = Pe(
          je,
          St,
          Oe[Zt],
          Ge
        );
        if (wn === null) {
          St === null && (St = an);
          break;
        }
        o && St && wn.alternate === null && l(je, St), Ce = A(wn, Ce, Zt), bn === null ? kt = wn : bn.sibling = wn, bn = wn, St = an;
      }
      if (Zt === Oe.length)
        return p(je, St), un && xs(je, Zt), kt;
      if (St === null) {
        for (; Zt < Oe.length; Zt++)
          St = Ke(je, Oe[Zt], Ge), St !== null && (Ce = A(
            St,
            Ce,
            Zt
          ), bn === null ? kt = St : bn.sibling = St, bn = St);
        return un && xs(je, Zt), kt;
      }
      for (St = y(St); Zt < Oe.length; Zt++)
        an = Be(
          St,
          je,
          Zt,
          Oe[Zt],
          Ge
        ), an !== null && (o && an.alternate !== null && St.delete(
          an.key === null ? Zt : an.key
        ), Ce = A(
          an,
          Ce,
          Zt
        ), bn === null ? kt = an : bn.sibling = an, bn = an);
      return o && St.forEach(function(Vl) {
        return l(je, Vl);
      }), un && xs(je, Zt), kt;
    }
    function Mt(je, Ce, Oe, Ge) {
      if (Oe == null) throw Error(r(151));
      for (var kt = null, bn = null, St = Ce, Zt = Ce = 0, an = null, wn = Oe.next(); St !== null && !wn.done; Zt++, wn = Oe.next()) {
        St.index > Zt ? (an = St, St = null) : an = St.sibling;
        var Vl = Pe(je, St, wn.value, Ge);
        if (Vl === null) {
          St === null && (St = an);
          break;
        }
        o && St && Vl.alternate === null && l(je, St), Ce = A(Vl, Ce, Zt), bn === null ? kt = Vl : bn.sibling = Vl, bn = Vl, St = an;
      }
      if (wn.done)
        return p(je, St), un && xs(je, Zt), kt;
      if (St === null) {
        for (; !wn.done; Zt++, wn = Oe.next())
          wn = Ke(je, wn.value, Ge), wn !== null && (Ce = A(wn, Ce, Zt), bn === null ? kt = wn : bn.sibling = wn, bn = wn);
        return un && xs(je, Zt), kt;
      }
      for (St = y(St); !wn.done; Zt++, wn = Oe.next())
        wn = Be(St, je, Zt, wn.value, Ge), wn !== null && (o && wn.alternate !== null && St.delete(wn.key === null ? Zt : wn.key), Ce = A(wn, Ce, Zt), bn === null ? kt = wn : bn.sibling = wn, bn = wn);
      return o && St.forEach(function(R2) {
        return l(je, R2);
      }), un && xs(je, Zt), kt;
    }
    function Dn(je, Ce, Oe, Ge) {
      if (typeof Oe == "object" && Oe !== null && Oe.type === S && Oe.key === null && (Oe = Oe.props.children), typeof Oe == "object" && Oe !== null) {
        switch (Oe.$$typeof) {
          case b:
            e: {
              for (var kt = Oe.key; Ce !== null; ) {
                if (Ce.key === kt) {
                  if (kt = Oe.type, kt === S) {
                    if (Ce.tag === 7) {
                      p(
                        je,
                        Ce.sibling
                      ), Ge = E(
                        Ce,
                        Oe.props.children
                      ), Ge.return = je, je = Ge;
                      break e;
                    }
                  } else if (Ce.elementType === kt || typeof kt == "object" && kt !== null && kt.$$typeof === Y && Sa(kt) === Ce.type) {
                    p(
                      je,
                      Ce.sibling
                    ), Ge = E(Ce, Oe.props), Ea(Ge, Oe), Ge.return = je, je = Ge;
                    break e;
                  }
                  p(je, Ce);
                  break;
                } else l(je, Ce);
                Ce = Ce.sibling;
              }
              Oe.type === S ? (Ge = ku(
                Oe.props.children,
                je.mode,
                Ge,
                Oe.key
              ), Ge.return = je, je = Ge) : (Ge = $h(
                Oe.type,
                Oe.key,
                Oe.props,
                null,
                je.mode,
                Ge
              ), Ea(Ge, Oe), Ge.return = je, je = Ge);
            }
            return B(je);
          case w:
            e: {
              for (kt = Oe.key; Ce !== null; ) {
                if (Ce.key === kt)
                  if (Ce.tag === 4 && Ce.stateNode.containerInfo === Oe.containerInfo && Ce.stateNode.implementation === Oe.implementation) {
                    p(
                      je,
                      Ce.sibling
                    ), Ge = E(Ce, Oe.children || []), Ge.return = je, je = Ge;
                    break e;
                  } else {
                    p(je, Ce);
                    break;
                  }
                else l(je, Ce);
                Ce = Ce.sibling;
              }
              Ge = Wd(Oe, je.mode, Ge), Ge.return = je, je = Ge;
            }
            return B(je);
          case Y:
            return Oe = Sa(Oe), Dn(
              je,
              Ce,
              Oe,
              Ge
            );
        }
        if (oe(Oe))
          return _t(
            je,
            Ce,
            Oe,
            Ge
          );
        if (G(Oe)) {
          if (kt = G(Oe), typeof kt != "function") throw Error(r(150));
          return Oe = kt.call(Oe), Mt(
            je,
            Ce,
            Oe,
            Ge
          );
        }
        if (typeof Oe.then == "function")
          return Dn(
            je,
            Ce,
            Dc(Oe),
            Ge
          );
        if (Oe.$$typeof === N)
          return Dn(
            je,
            Ce,
            ta(je, Oe),
            Ge
          );
        zi(je, Oe);
      }
      return typeof Oe == "string" && Oe !== "" || typeof Oe == "number" || typeof Oe == "bigint" ? (Oe = "" + Oe, Ce !== null && Ce.tag === 6 ? (p(je, Ce.sibling), Ge = E(Ce, Oe), Ge.return = je, je = Ge) : (p(je, Ce), Ge = Ec(Oe, je.mode, Ge), Ge.return = je, je = Ge), B(je)) : p(je, Ce);
    }
    return function(je, Ce, Oe, Ge) {
      try {
        vs = 0;
        var kt = Dn(
          je,
          Ce,
          Oe,
          Ge
        );
        return Oc = null, kt;
      } catch (St) {
        if (St === Mc || St === Jd) throw St;
        var bn = ci(29, St, null, je.mode);
        return bn.lanes = Ge, bn.return = je, bn;
      } finally {
      }
    };
  }
  var Cl = Tx(!0), cg = Tx(!1), ra = !1;
  function Qa(o) {
    o.updateQueue = {
      baseState: o.memoizedState,
      firstBaseUpdate: null,
      lastBaseUpdate: null,
      shared: { pending: null, lanes: 0, hiddenCallbacks: null },
      callbacks: null
    };
  }
  function Kh(o, l) {
    o = o.updateQueue, l.updateQueue === o && (l.updateQueue = {
      baseState: o.baseState,
      firstBaseUpdate: o.firstBaseUpdate,
      lastBaseUpdate: o.lastBaseUpdate,
      shared: o.shared,
      callbacks: null
    });
  }
  function kl(o) {
    return { lane: o, tag: 0, payload: null, callback: null, next: null };
  }
  function Ca(o, l, p) {
    var y = o.updateQueue;
    if (y === null) return null;
    if (y = y.shared, (Sn & 2) !== 0) {
      var E = y.pending;
      return E === null ? l.next = l : (l.next = E.next, E.next = l), y.pending = l, l = Cr(o), xl(o, null, p), l;
    }
    return Rt(o, y, l, p), Cr(o);
  }
  function ef(o, l, p) {
    if (l = l.updateQueue, l !== null && (l = l.shared, (p & 4194048) !== 0)) {
      var y = l.lanes;
      y &= o.pendingLanes, p |= y, l.lanes = p, Tn(o, p);
    }
  }
  function Yh(o, l) {
    var p = o.updateQueue, y = o.alternate;
    if (y !== null && (y = y.updateQueue, p === y)) {
      var E = null, A = null;
      if (p = p.firstBaseUpdate, p !== null) {
        do {
          var B = {
            lane: p.lane,
            tag: p.tag,
            payload: p.payload,
            callback: null,
            next: null
          };
          A === null ? E = A = B : A = A.next = B, p = p.next;
        } while (p !== null);
        A === null ? E = A = l : A = A.next = l;
      } else E = A = l;
      p = {
        baseState: y.baseState,
        firstBaseUpdate: E,
        lastBaseUpdate: A,
        shared: y.shared,
        callbacks: y.callbacks
      }, o.updateQueue = p;
      return;
    }
    o = p.lastBaseUpdate, o === null ? p.firstBaseUpdate = l : o.next = l, p.lastBaseUpdate = l;
  }
  var qr = !1;
  function Mu() {
    if (qr) {
      var o = Rc;
      if (o !== null) throw o;
    }
  }
  function zc(o, l, p, y) {
    qr = !1;
    var E = o.updateQueue;
    ra = !1;
    var A = E.firstBaseUpdate, B = E.lastBaseUpdate, ne = E.shared.pending;
    if (ne !== null) {
      E.shared.pending = null;
      var xe = ne, De = xe.next;
      xe.next = null, B === null ? A = De : B.next = De, B = xe;
      var Ue = o.alternate;
      Ue !== null && (Ue = Ue.updateQueue, ne = Ue.lastBaseUpdate, ne !== B && (ne === null ? Ue.firstBaseUpdate = De : ne.next = De, Ue.lastBaseUpdate = xe));
    }
    if (A !== null) {
      var Ke = E.baseState;
      B = 0, Ue = De = xe = null, ne = A;
      do {
        var Pe = ne.lane & -536870913, Be = Pe !== ne.lane;
        if (Be ? (sn & Pe) === Pe : (y & Pe) === Pe) {
          Pe !== 0 && Pe === Nc && (qr = !0), Ue !== null && (Ue = Ue.next = {
            lane: 0,
            tag: ne.tag,
            payload: ne.payload,
            callback: null,
            next: null
          });
          e: {
            var _t = o, Mt = ne;
            Pe = l;
            var Dn = p;
            switch (Mt.tag) {
              case 1:
                if (_t = Mt.payload, typeof _t == "function") {
                  Ke = _t.call(Dn, Ke, Pe);
                  break e;
                }
                Ke = _t;
                break e;
              case 3:
                _t.flags = _t.flags & -65537 | 128;
              case 0:
                if (_t = Mt.payload, Pe = typeof _t == "function" ? _t.call(Dn, Ke, Pe) : _t, Pe == null) break e;
                Ke = m({}, Ke, Pe);
                break e;
              case 2:
                ra = !0;
            }
          }
          Pe = ne.callback, Pe !== null && (o.flags |= 64, Be && (o.flags |= 8192), Be = E.callbacks, Be === null ? E.callbacks = [Pe] : Be.push(Pe));
        } else
          Be = {
            lane: Pe,
            tag: ne.tag,
            payload: ne.payload,
            callback: ne.callback,
            next: null
          }, Ue === null ? (De = Ue = Be, xe = Ke) : Ue = Ue.next = Be, B |= Pe;
        if (ne = ne.next, ne === null) {
          if (ne = E.shared.pending, ne === null)
            break;
          Be = ne, ne = Be.next, Be.next = null, E.lastBaseUpdate = Be, E.shared.pending = null;
        }
      } while (!0);
      Ue === null && (xe = Ke), E.baseState = xe, E.firstBaseUpdate = De, E.lastBaseUpdate = Ue, A === null && (E.shared.lanes = 0), Dl |= B, o.lanes = B, o.memoizedState = Ke;
    }
  }
  function ka(o, l) {
    if (typeof o != "function")
      throw Error(r(191, o));
    o.call(l);
  }
  function Wh(o, l) {
    var p = o.callbacks;
    if (p !== null)
      for (o.callbacks = null, o = 0; o < p.length; o++)
        ka(p[o], l);
  }
  var Ro = J(null), Ja = J(0);
  function dg(o, l) {
    o = Ma, Q(Ja, o), Q(Ro, l), Ma = o | l.baseLanes;
  }
  function fi() {
    Q(Ja, Ma), Q(Ro, Ro.current);
  }
  function tf() {
    Ma = Ja.current, ge(Ro), ge(Ja);
  }
  var bs = J(null), ia = null;
  function Tl(o) {
    var l = o.alternate;
    Q(kr, kr.current & 1), Q(bs, o), ia === null && (l === null || Ro.current !== null || l.memoizedState !== null) && (ia = o);
  }
  function nf(o) {
    Q(kr, kr.current), Q(bs, o), ia === null && (ia = o);
  }
  function jx(o) {
    o.tag === 22 ? (Q(kr, kr.current), Q(bs, o), ia === null && (ia = o)) : sa();
  }
  function sa() {
    Q(kr, kr.current), Q(bs, bs.current);
  }
  function Yi(o) {
    ge(bs), ia === o && (ia = null), ge(kr);
  }
  var kr = J(0);
  function Zh(o) {
    for (var l = o; l !== null; ) {
      if (l.tag === 13) {
        var p = l.memoizedState;
        if (p !== null && (p = p.dehydrated, p === null || Op(p) || ed(p)))
          return l;
      } else if (l.tag === 19 && (l.memoizedProps.revealOrder === "forwards" || l.memoizedProps.revealOrder === "backwards" || l.memoizedProps.revealOrder === "unstable_legacy-backwards" || l.memoizedProps.revealOrder === "together")) {
        if ((l.flags & 128) !== 0) return l;
      } else if (l.child !== null) {
        l.child.return = l, l = l.child;
        continue;
      }
      if (l === o) break;
      for (; l.sibling === null; ) {
        if (l.return === null || l.return === o) return null;
        l = l.return;
      }
      l.sibling.return = l.return, l = l.sibling;
    }
    return null;
  }
  var ws = 0, Kt = null, Mn = null, pr = null, rf = !1, Pc = !1, Ou = !1, Xh = 0, Ic = 0, jl = null, Kw = 0;
  function nr() {
    throw Error(r(321));
  }
  function Qh(o, l) {
    if (l === null) return !1;
    for (var p = 0; p < l.length && p < o.length; p++)
      if (!Vn(o[p], l[p])) return !1;
    return !0;
  }
  function Jh(o, l, p, y, E, A) {
    return ws = A, Kt = l, l.memoizedState = null, l.updateQueue = null, l.lanes = 0, X.H = o === null || o.memoizedState === null ? Bx : lp, Ou = !1, A = p(y, E), Ou = !1, Pc && (A = sf(
      l,
      p,
      y,
      E
    )), fg(o), A;
  }
  function fg(o) {
    X.H = Nl;
    var l = Mn !== null && Mn.next !== null;
    if (ws = 0, pr = Mn = Kt = null, rf = !1, Ic = 0, jl = null, l) throw Error(r(300));
    o === null || ur || (o = o.dependencies, o !== null && Fh(o) && (ur = !0));
  }
  function sf(o, l, p, y) {
    Kt = o;
    var E = 0;
    do {
      if (Pc && (jl = null), Ic = 0, Pc = !1, 25 <= E) throw Error(r(301));
      if (E += 1, pr = Mn = null, o.updateQueue != null) {
        var A = o.updateQueue;
        A.lastEffect = null, A.events = null, A.stores = null, A.memoCache != null && (A.memoCache.index = 0);
      }
      X.H = hf, A = l(p, y);
    } while (Pc);
    return A;
  }
  function Yw() {
    var o = X.H, l = o.useState()[0];
    return l = typeof l.then == "function" ? Bc(l) : l, o = o.useState()[0], (Mn !== null ? Mn.memoizedState : null) !== o && (Kt.flags |= 1024), l;
  }
  function ep() {
    var o = Xh !== 0;
    return Xh = 0, o;
  }
  function tp(o, l, p) {
    l.updateQueue = o.updateQueue, l.flags &= -2053, o.lanes &= ~p;
  }
  function hg(o) {
    if (rf) {
      for (o = o.memoizedState; o !== null; ) {
        var l = o.queue;
        l !== null && (l.pending = null), o = o.next;
      }
      rf = !1;
    }
    ws = 0, pr = Mn = Kt = null, Pc = !1, Ic = Xh = 0, jl = null;
  }
  function ki() {
    var o = {
      memoizedState: null,
      baseState: null,
      baseQueue: null,
      queue: null,
      next: null
    };
    return pr === null ? Kt.memoizedState = pr = o : pr = pr.next = o, pr;
  }
  function Tr() {
    if (Mn === null) {
      var o = Kt.alternate;
      o = o !== null ? o.memoizedState : null;
    } else o = Mn.next;
    var l = pr === null ? Kt.memoizedState : pr.next;
    if (l !== null)
      pr = l, Mn = o;
    else {
      if (o === null)
        throw Kt.alternate === null ? Error(r(467)) : Error(r(310));
      Mn = o, o = {
        memoizedState: Mn.memoizedState,
        baseState: Mn.baseState,
        baseQueue: Mn.baseQueue,
        queue: Mn.queue,
        next: null
      }, pr === null ? Kt.memoizedState = pr = o : pr = pr.next = o;
    }
    return pr;
  }
  function Lc() {
    return { lastEffect: null, events: null, stores: null, memoCache: null };
  }
  function Bc(o) {
    var l = Ic;
    return Ic += 1, jl === null && (jl = []), o = Gh(jl, o, l), l = Kt, (pr === null ? l.memoizedState : pr.next) === null && (l = l.alternate, X.H = l === null || l.memoizedState === null ? Bx : lp), o;
  }
  function $c(o) {
    if (o !== null && typeof o == "object") {
      if (typeof o.then == "function") return Bc(o);
      if (o.$$typeof === N) return di(o);
    }
    throw Error(r(438, String(o)));
  }
  function pg(o) {
    var l = null, p = Kt.updateQueue;
    if (p !== null && (l = p.memoCache), l == null) {
      var y = Kt.alternate;
      y !== null && (y = y.updateQueue, y !== null && (y = y.memoCache, y != null && (l = {
        data: y.data.map(function(E) {
          return E.slice();
        }),
        index: 0
      })));
    }
    if (l == null && (l = { data: [], index: 0 }), p === null && (p = Lc(), Kt.updateQueue = p), p.memoCache = l, p = l.data[l.index], p === void 0)
      for (p = l.data[l.index] = Array(o), y = 0; y < o; y++)
        p[y] = V;
    return l.index++, p;
  }
  function Ta(o, l) {
    return typeof l == "function" ? l(o) : l;
  }
  function Yt(o) {
    var l = Tr();
    return mg(l, Mn, o);
  }
  function mg(o, l, p) {
    var y = o.queue;
    if (y === null) throw Error(r(311));
    y.lastRenderedReducer = p;
    var E = o.baseQueue, A = y.pending;
    if (A !== null) {
      if (E !== null) {
        var B = E.next;
        E.next = A.next, A.next = B;
      }
      l.baseQueue = E = A, y.pending = null;
    }
    if (A = o.baseState, E === null) o.memoizedState = A;
    else {
      l = E.next;
      var ne = B = null, xe = null, De = l, Ue = !1;
      do {
        var Ke = De.lane & -536870913;
        if (Ke !== De.lane ? (sn & Ke) === Ke : (ws & Ke) === Ke) {
          var Pe = De.revertLane;
          if (Pe === 0)
            xe !== null && (xe = xe.next = {
              lane: 0,
              revertLane: 0,
              gesture: null,
              action: De.action,
              hasEagerState: De.hasEagerState,
              eagerState: De.eagerState,
              next: null
            }), Ke === Nc && (Ue = !0);
          else if ((ws & Pe) === Pe) {
            De = De.next, Pe === Nc && (Ue = !0);
            continue;
          } else
            Ke = {
              lane: 0,
              revertLane: De.revertLane,
              gesture: null,
              action: De.action,
              hasEagerState: De.hasEagerState,
              eagerState: De.eagerState,
              next: null
            }, xe === null ? (ne = xe = Ke, B = A) : xe = xe.next = Ke, Kt.lanes |= Pe, Dl |= Pe;
          Ke = De.action, Ou && p(A, Ke), A = De.hasEagerState ? De.eagerState : p(A, Ke);
        } else
          Pe = {
            lane: Ke,
            revertLane: De.revertLane,
            gesture: De.gesture,
            action: De.action,
            hasEagerState: De.hasEagerState,
            eagerState: De.eagerState,
            next: null
          }, xe === null ? (ne = xe = Pe, B = A) : xe = xe.next = Pe, Kt.lanes |= Ke, Dl |= Ke;
        De = De.next;
      } while (De !== null && De !== l);
      if (xe === null ? B = A : xe.next = ne, !Vn(A, o.memoizedState) && (ur = !0, Ue && (p = Rc, p !== null)))
        throw p;
      o.memoizedState = A, o.baseState = B, o.baseQueue = xe, y.lastRenderedState = A;
    }
    return E === null && (y.lanes = 0), [o.memoizedState, y.dispatch];
  }
  function gg(o) {
    var l = Tr(), p = l.queue;
    if (p === null) throw Error(r(311));
    p.lastRenderedReducer = o;
    var y = p.dispatch, E = p.pending, A = l.memoizedState;
    if (E !== null) {
      p.pending = null;
      var B = E = E.next;
      do
        A = o(A, B.action), B = B.next;
      while (B !== E);
      Vn(A, l.memoizedState) || (ur = !0), l.memoizedState = A, l.baseQueue === null && (l.baseState = A), p.lastRenderedState = A;
    }
    return [A, y];
  }
  function qc(o, l, p) {
    var y = Kt, E = Tr(), A = un;
    if (A) {
      if (p === void 0) throw Error(r(407));
      p = p();
    } else p = l();
    var B = !Vn(
      (Mn || E).memoizedState,
      p
    );
    if (B && (E.memoizedState = p, ur = !0), E = E.queue, uf(Nx.bind(null, y, E, o), [
      o
    ]), E.getSnapshot !== l || B || pr !== null && pr.memoizedState.tag & 1) {
      if (y.flags |= 2048, Ss(
        9,
        { destroy: void 0 },
        Ax.bind(
          null,
          y,
          E,
          p,
          l
        ),
        null
      ), $n === null) throw Error(r(349));
      A || (ws & 127) !== 0 || yg(y, l, p);
    }
    return p;
  }
  function yg(o, l, p) {
    o.flags |= 16384, o = { getSnapshot: l, value: p }, l = Kt.updateQueue, l === null ? (l = Lc(), Kt.updateQueue = l, l.stores = [o]) : (p = l.stores, p === null ? l.stores = [o] : p.push(o));
  }
  function Ax(o, l, p, y) {
    l.value = p, l.getSnapshot = y, _s(l) && Rx(o);
  }
  function Nx(o, l, p) {
    return p(function() {
      _s(l) && Rx(o);
    });
  }
  function _s(o) {
    var l = o.getSnapshot;
    o = o.value;
    try {
      var p = l();
      return !Vn(o, p);
    } catch {
      return !0;
    }
  }
  function Rx(o) {
    var l = Ln(o, 2);
    l !== null && es(l, o, 2);
  }
  function Fc(o) {
    var l = ki();
    if (typeof o == "function") {
      var p = o;
      if (o = p(), Ou) {
        fn(!0);
        try {
          p();
        } finally {
          fn(!1);
        }
      }
    }
    return l.memoizedState = l.baseState = o, l.queue = {
      pending: null,
      lanes: 0,
      dispatch: null,
      lastRenderedReducer: Ta,
      lastRenderedState: o
    }, l;
  }
  function np(o, l, p, y) {
    return o.baseState = p, mg(
      o,
      Mn,
      typeof y == "function" ? y : Ta
    );
  }
  function Mx(o, l, p, y, E) {
    if (df(o)) throw Error(r(485));
    if (o = l.action, o !== null) {
      var A = {
        payload: E,
        action: o,
        next: null,
        isTransition: !0,
        status: "pending",
        value: null,
        reason: null,
        listeners: [],
        then: function(B) {
          A.listeners.push(B);
        }
      };
      X.T !== null ? p(!0) : A.isTransition = !1, y(A), p = l.pending, p === null ? (A.next = l.pending = A, xg(l, A)) : (A.next = p.next, l.pending = p.next = A);
    }
  }
  function xg(o, l) {
    var p = l.action, y = l.payload, E = o.state;
    if (l.isTransition) {
      var A = X.T, B = {};
      X.T = B;
      try {
        var ne = p(E, y), xe = X.S;
        xe !== null && xe(B, ne), Wi(o, l, ne);
      } catch (De) {
        af(o, l, De);
      } finally {
        A !== null && B.types !== null && (A.types = B.types), X.T = A;
      }
    } else
      try {
        A = p(E, y), Wi(o, l, A);
      } catch (De) {
        af(o, l, De);
      }
  }
  function Wi(o, l, p) {
    p !== null && typeof p == "object" && typeof p.then == "function" ? p.then(
      function(y) {
        Mo(o, l, y);
      },
      function(y) {
        return af(o, l, y);
      }
    ) : Mo(o, l, p);
  }
  function Mo(o, l, p) {
    l.status = "fulfilled", l.value = p, vg(l), o.state = p, l = o.pending, l !== null && (p = l.next, p === l ? o.pending = null : (p = p.next, l.next = p, xg(o, p)));
  }
  function af(o, l, p) {
    var y = o.pending;
    if (o.pending = null, y !== null) {
      y = y.next;
      do
        l.status = "rejected", l.reason = p, vg(l), l = l.next;
      while (l !== y);
    }
    o.action = null;
  }
  function vg(o) {
    o = o.listeners;
    for (var l = 0; l < o.length; l++) (0, o[l])();
  }
  function of(o, l) {
    return l;
  }
  function bg(o, l) {
    if (un) {
      var p = $n.formState;
      if (p !== null) {
        e: {
          var y = Kt;
          if (un) {
            if (En) {
              t: {
                for (var E = En, A = ea; E.nodeType !== 8; ) {
                  if (!A) {
                    E = null;
                    break t;
                  }
                  if (E = oa(
                    E.nextSibling
                  ), E === null) {
                    E = null;
                    break t;
                  }
                }
                A = E.data, E = A === "F!" || A === "F" ? E : null;
              }
              if (E) {
                En = oa(
                  E.nextSibling
                ), y = E.data === "F!";
                break e;
              }
            }
            wl(y);
          }
          y = !1;
        }
        y && (l = p[0]);
      }
    }
    return p = ki(), p.memoizedState = p.baseState = l, y = {
      pending: null,
      lanes: 0,
      dispatch: null,
      lastRenderedReducer: of,
      lastRenderedState: l
    }, p.queue = y, p = Rg.bind(
      null,
      Kt,
      y
    ), y.dispatch = p, y = Fc(!1), A = Hc.bind(
      null,
      Kt,
      !1,
      y.queue
    ), y = ki(), E = {
      state: l,
      dispatch: null,
      action: o,
      pending: null
    }, y.queue = E, p = Mx.bind(
      null,
      Kt,
      E,
      A,
      p
    ), E.dispatch = p, y.memoizedState = o, [l, p, !1];
  }
  function rp(o) {
    var l = Tr();
    return wg(l, Mn, o);
  }
  function wg(o, l, p) {
    if (l = mg(
      o,
      l,
      of
    )[0], o = Yt(Ta)[0], typeof l == "object" && l !== null && typeof l.then == "function")
      try {
        var y = Bc(l);
      } catch (B) {
        throw B === Mc ? Jd : B;
      }
    else y = l;
    l = Tr();
    var E = l.queue, A = E.dispatch;
    return p !== l.memoizedState && (Kt.flags |= 2048, Ss(
      9,
      { destroy: void 0 },
      _g.bind(null, E, p),
      null
    )), [y, A, o];
  }
  function _g(o, l) {
    o.action = l;
  }
  function ip(o) {
    var l = Tr(), p = Mn;
    if (p !== null)
      return wg(l, p, o);
    Tr(), l = l.memoizedState, p = Tr();
    var y = p.queue.dispatch;
    return p.memoizedState = o, [l, y, !1];
  }
  function Ss(o, l, p, y) {
    return o = { tag: o, create: p, deps: y, inst: l, next: null }, l = Kt.updateQueue, l === null && (l = Lc(), Kt.updateQueue = l), p = l.lastEffect, p === null ? l.lastEffect = o.next = o : (y = p.next, p.next = o, o.next = y, l.lastEffect = o), o;
  }
  function Ox() {
    return Tr().memoizedState;
  }
  function ja(o, l, p, y) {
    var E = ki();
    Kt.flags |= o, E.memoizedState = Ss(
      1 | l,
      { destroy: void 0 },
      p,
      y === void 0 ? null : y
    );
  }
  function lf(o, l, p, y) {
    var E = Tr();
    y = y === void 0 ? null : y;
    var A = E.memoizedState.inst;
    Mn !== null && y !== null && Qh(y, Mn.memoizedState.deps) ? E.memoizedState = Ss(l, A, p, y) : (Kt.flags |= o, E.memoizedState = Ss(
      1 | l,
      A,
      p,
      y
    ));
  }
  function Sg(o, l) {
    ja(8390656, 8, o, l);
  }
  function uf(o, l) {
    lf(2048, 8, o, l);
  }
  function Ww(o) {
    Kt.flags |= 4;
    var l = Kt.updateQueue;
    if (l === null)
      l = Lc(), Kt.updateQueue = l, l.events = [o];
    else {
      var p = l.events;
      p === null ? l.events = [o] : p.push(o);
    }
  }
  function Dx(o) {
    var l = Tr().memoizedState;
    return Ww({ ref: l, nextImpl: o }), function() {
      if ((Sn & 2) !== 0) throw Error(r(440));
      return l.impl.apply(void 0, arguments);
    };
  }
  function zx(o, l) {
    return lf(4, 2, o, l);
  }
  function Eg(o, l) {
    return lf(4, 4, o, l);
  }
  function Cg(o, l) {
    if (typeof l == "function") {
      o = o();
      var p = l(o);
      return function() {
        typeof p == "function" ? p() : l(null);
      };
    }
    if (l != null)
      return o = o(), l.current = o, function() {
        l.current = null;
      };
  }
  function Px(o, l, p) {
    p = p != null ? p.concat([o]) : null, lf(4, 4, Cg.bind(null, l, o), p);
  }
  function sp() {
  }
  function kg(o, l) {
    var p = Tr();
    l = l === void 0 ? null : l;
    var y = p.memoizedState;
    return l !== null && Qh(l, y[1]) ? y[0] : (p.memoizedState = [o, l], o);
  }
  function Pi(o, l) {
    var p = Tr();
    l = l === void 0 ? null : l;
    var y = p.memoizedState;
    if (l !== null && Qh(l, y[1]))
      return y[0];
    if (y = o(), Ou) {
      fn(!0);
      try {
        o();
      } finally {
        fn(!1);
      }
    }
    return p.memoizedState = [y, l], y;
  }
  function aa(o, l, p) {
    return p === void 0 || (ws & 1073741824) !== 0 && (sn & 261930) === 0 ? o.memoizedState = l : (o.memoizedState = p, o = uv(), Kt.lanes |= o, Dl |= o, p);
  }
  function Ix(o, l, p, y) {
    return Vn(p, l) ? p : Ro.current !== null ? (o = aa(o, p, y), Vn(o, l) || (ur = !0), o) : (ws & 42) === 0 || (ws & 1073741824) !== 0 && (sn & 261930) === 0 ? (ur = !0, o.memoizedState = p) : (o = uv(), Kt.lanes |= o, Dl |= o, l);
  }
  function Lx(o, l, p, y, E) {
    var A = ce.p;
    ce.p = A !== 0 && 8 > A ? A : 8;
    var B = X.T, ne = {};
    X.T = ne, Hc(o, !1, l, p);
    try {
      var xe = E(), De = X.S;
      if (De !== null && De(ne, xe), xe !== null && typeof xe == "object" && typeof xe.then == "function") {
        var Ue = Gw(
          xe,
          y
        );
        Uc(
          o,
          l,
          Ue,
          ks(o)
        );
      } else
        Uc(
          o,
          l,
          y,
          ks(o)
        );
    } catch (Ke) {
      Uc(
        o,
        l,
        { then: function() {
        }, status: "rejected", reason: Ke },
        ks()
      );
    } finally {
      ce.p = A, B !== null && ne.types !== null && (B.types = ne.types), X.T = B;
    }
  }
  function ap() {
  }
  function Al(o, l, p, y) {
    if (o.tag !== 5) throw Error(r(476));
    var E = Tg(o).queue;
    Lx(
      o,
      E,
      l,
      pe,
      p === null ? ap : function() {
        return jg(o), p(y);
      }
    );
  }
  function Tg(o) {
    var l = o.memoizedState;
    if (l !== null) return l;
    l = {
      memoizedState: pe,
      baseState: pe,
      baseQueue: null,
      queue: {
        pending: null,
        lanes: 0,
        dispatch: null,
        lastRenderedReducer: Ta,
        lastRenderedState: pe
      },
      next: null
    };
    var p = {};
    return l.next = {
      memoizedState: p,
      baseState: p,
      baseQueue: null,
      queue: {
        pending: null,
        lanes: 0,
        dispatch: null,
        lastRenderedReducer: Ta,
        lastRenderedState: p
      },
      next: null
    }, o.memoizedState = l, o = o.alternate, o !== null && (o.memoizedState = l), l;
  }
  function jg(o) {
    var l = Tg(o);
    l.next === null && (l = o.alternate.memoizedState), Uc(
      o,
      l.next.queue,
      {},
      ks()
    );
  }
  function Ag() {
    return di(ad);
  }
  function Ng() {
    return Tr().memoizedState;
  }
  function Du() {
    return Tr().memoizedState;
  }
  function cf(o) {
    for (var l = o.return; l !== null; ) {
      switch (l.tag) {
        case 24:
        case 3:
          var p = ks();
          o = kl(p);
          var y = Ca(l, o, p);
          y !== null && (es(y, l, p), ef(y, l, p)), l = { cache: _a() }, o.payload = l;
          return;
      }
      l = l.return;
    }
  }
  function Zw(o, l, p) {
    var y = ks();
    p = {
      lane: y,
      revertLane: 0,
      gesture: null,
      action: p,
      hasEagerState: !1,
      eagerState: null,
      next: null
    }, df(o) ? ff(l, p) : (p = Er(o, l, p, y), p !== null && (es(p, o, y), op(p, l, y)));
  }
  function Rg(o, l, p) {
    var y = ks();
    Uc(o, l, p, y);
  }
  function Uc(o, l, p, y) {
    var E = {
      lane: y,
      revertLane: 0,
      gesture: null,
      action: p,
      hasEagerState: !1,
      eagerState: null,
      next: null
    };
    if (df(o)) ff(l, E);
    else {
      var A = o.alternate;
      if (o.lanes === 0 && (A === null || A.lanes === 0) && (A = l.lastRenderedReducer, A !== null))
        try {
          var B = l.lastRenderedState, ne = A(B, p);
          if (E.hasEagerState = !0, E.eagerState = ne, Vn(ne, B))
            return Rt(o, l, E, 0), $n === null && Zn(), !1;
        } catch {
        } finally {
        }
      if (p = Er(o, l, E, y), p !== null)
        return es(p, o, y), op(p, l, y), !0;
    }
    return !1;
  }
  function Hc(o, l, p, y) {
    if (y = {
      lane: 2,
      revertLane: Ts(),
      gesture: null,
      action: y,
      hasEagerState: !1,
      eagerState: null,
      next: null
    }, df(o)) {
      if (l) throw Error(r(479));
    } else
      l = Er(
        o,
        p,
        y,
        2
      ), l !== null && es(l, o, 2);
  }
  function df(o) {
    var l = o.alternate;
    return o === Kt || l !== null && l === Kt;
  }
  function ff(o, l) {
    Pc = rf = !0;
    var p = o.pending;
    p === null ? l.next = l : (l.next = p.next, p.next = l), o.pending = l;
  }
  function op(o, l, p) {
    if ((p & 4194048) !== 0) {
      var y = l.lanes;
      y &= o.pendingLanes, p |= y, l.lanes = p, Tn(o, p);
    }
  }
  var Nl = {
    readContext: di,
    use: $c,
    useCallback: nr,
    useContext: nr,
    useEffect: nr,
    useImperativeHandle: nr,
    useLayoutEffect: nr,
    useInsertionEffect: nr,
    useMemo: nr,
    useReducer: nr,
    useRef: nr,
    useState: nr,
    useDebugValue: nr,
    useDeferredValue: nr,
    useTransition: nr,
    useSyncExternalStore: nr,
    useId: nr,
    useHostTransitionStatus: nr,
    useFormState: nr,
    useActionState: nr,
    useOptimistic: nr,
    useMemoCache: nr,
    useCacheRefresh: nr
  };
  Nl.useEffectEvent = nr;
  var Bx = {
    readContext: di,
    use: $c,
    useCallback: function(o, l) {
      return ki().memoizedState = [
        o,
        l === void 0 ? null : l
      ], o;
    },
    useContext: di,
    useEffect: Sg,
    useImperativeHandle: function(o, l, p) {
      p = p != null ? p.concat([o]) : null, ja(
        4194308,
        4,
        Cg.bind(null, l, o),
        p
      );
    },
    useLayoutEffect: function(o, l) {
      return ja(4194308, 4, o, l);
    },
    useInsertionEffect: function(o, l) {
      ja(4, 2, o, l);
    },
    useMemo: function(o, l) {
      var p = ki();
      l = l === void 0 ? null : l;
      var y = o();
      if (Ou) {
        fn(!0);
        try {
          o();
        } finally {
          fn(!1);
        }
      }
      return p.memoizedState = [y, l], y;
    },
    useReducer: function(o, l, p) {
      var y = ki();
      if (p !== void 0) {
        var E = p(l);
        if (Ou) {
          fn(!0);
          try {
            p(l);
          } finally {
            fn(!1);
          }
        }
      } else E = l;
      return y.memoizedState = y.baseState = E, o = {
        pending: null,
        lanes: 0,
        dispatch: null,
        lastRenderedReducer: o,
        lastRenderedState: E
      }, y.queue = o, o = o.dispatch = Zw.bind(
        null,
        Kt,
        o
      ), [y.memoizedState, o];
    },
    useRef: function(o) {
      var l = ki();
      return o = { current: o }, l.memoizedState = o;
    },
    useState: function(o) {
      o = Fc(o);
      var l = o.queue, p = Rg.bind(null, Kt, l);
      return l.dispatch = p, [o.memoizedState, p];
    },
    useDebugValue: sp,
    useDeferredValue: function(o, l) {
      var p = ki();
      return aa(p, o, l);
    },
    useTransition: function() {
      var o = Fc(!1);
      return o = Lx.bind(
        null,
        Kt,
        o.queue,
        !0,
        !1
      ), ki().memoizedState = o, [!1, o];
    },
    useSyncExternalStore: function(o, l, p) {
      var y = Kt, E = ki();
      if (un) {
        if (p === void 0)
          throw Error(r(407));
        p = p();
      } else {
        if (p = l(), $n === null)
          throw Error(r(349));
        (sn & 127) !== 0 || yg(y, l, p);
      }
      E.memoizedState = p;
      var A = { value: p, getSnapshot: l };
      return E.queue = A, Sg(Nx.bind(null, y, A, o), [
        o
      ]), y.flags |= 2048, Ss(
        9,
        { destroy: void 0 },
        Ax.bind(
          null,
          y,
          A,
          p,
          l
        ),
        null
      ), p;
    },
    useId: function() {
      var o = ki(), l = $n.identifierPrefix;
      if (un) {
        var p = Js, y = Za;
        p = (y & ~(1 << 32 - nt(y) - 1)).toString(32) + p, l = "_" + l + "R_" + p, p = Xh++, 0 < p && (l += "H" + p.toString(32)), l += "_";
      } else
        p = Kw++, l = "_" + l + "r_" + p.toString(32) + "_";
      return o.memoizedState = l;
    },
    useHostTransitionStatus: Ag,
    useFormState: bg,
    useActionState: bg,
    useOptimistic: function(o) {
      var l = ki();
      l.memoizedState = l.baseState = o;
      var p = {
        pending: null,
        lanes: 0,
        dispatch: null,
        lastRenderedReducer: null,
        lastRenderedState: null
      };
      return l.queue = p, l = Hc.bind(
        null,
        Kt,
        !0,
        p
      ), p.dispatch = l, [o, l];
    },
    useMemoCache: pg,
    useCacheRefresh: function() {
      return ki().memoizedState = cf.bind(
        null,
        Kt
      );
    },
    useEffectEvent: function(o) {
      var l = ki(), p = { impl: o };
      return l.memoizedState = p, function() {
        if ((Sn & 2) !== 0)
          throw Error(r(440));
        return p.impl.apply(void 0, arguments);
      };
    }
  }, lp = {
    readContext: di,
    use: $c,
    useCallback: kg,
    useContext: di,
    useEffect: uf,
    useImperativeHandle: Px,
    useInsertionEffect: zx,
    useLayoutEffect: Eg,
    useMemo: Pi,
    useReducer: Yt,
    useRef: Ox,
    useState: function() {
      return Yt(Ta);
    },
    useDebugValue: sp,
    useDeferredValue: function(o, l) {
      var p = Tr();
      return Ix(
        p,
        Mn.memoizedState,
        o,
        l
      );
    },
    useTransition: function() {
      var o = Yt(Ta)[0], l = Tr().memoizedState;
      return [
        typeof o == "boolean" ? o : Bc(o),
        l
      ];
    },
    useSyncExternalStore: qc,
    useId: Ng,
    useHostTransitionStatus: Ag,
    useFormState: rp,
    useActionState: rp,
    useOptimistic: function(o, l) {
      var p = Tr();
      return np(p, Mn, o, l);
    },
    useMemoCache: pg,
    useCacheRefresh: Du
  };
  lp.useEffectEvent = Dx;
  var hf = {
    readContext: di,
    use: $c,
    useCallback: kg,
    useContext: di,
    useEffect: uf,
    useImperativeHandle: Px,
    useInsertionEffect: zx,
    useLayoutEffect: Eg,
    useMemo: Pi,
    useReducer: gg,
    useRef: Ox,
    useState: function() {
      return gg(Ta);
    },
    useDebugValue: sp,
    useDeferredValue: function(o, l) {
      var p = Tr();
      return Mn === null ? aa(p, o, l) : Ix(
        p,
        Mn.memoizedState,
        o,
        l
      );
    },
    useTransition: function() {
      var o = gg(Ta)[0], l = Tr().memoizedState;
      return [
        typeof o == "boolean" ? o : Bc(o),
        l
      ];
    },
    useSyncExternalStore: qc,
    useId: Ng,
    useHostTransitionStatus: Ag,
    useFormState: ip,
    useActionState: ip,
    useOptimistic: function(o, l) {
      var p = Tr();
      return Mn !== null ? np(p, Mn, o, l) : (p.baseState = o, [o, p.queue.dispatch]);
    },
    useMemoCache: pg,
    useCacheRefresh: Du
  };
  hf.useEffectEvent = Dx;
  function up(o, l, p, y) {
    l = o.memoizedState, p = p(y, l), p = p == null ? l : m({}, l, p), o.memoizedState = p, o.lanes === 0 && (o.updateQueue.baseState = p);
  }
  var pf = {
    enqueueSetState: function(o, l, p) {
      o = o._reactInternals;
      var y = ks(), E = kl(y);
      E.payload = l, p != null && (E.callback = p), l = Ca(o, E, y), l !== null && (es(l, o, y), ef(l, o, y));
    },
    enqueueReplaceState: function(o, l, p) {
      o = o._reactInternals;
      var y = ks(), E = kl(y);
      E.tag = 1, E.payload = l, p != null && (E.callback = p), l = Ca(o, E, y), l !== null && (es(l, o, y), ef(l, o, y));
    },
    enqueueForceUpdate: function(o, l) {
      o = o._reactInternals;
      var p = ks(), y = kl(p);
      y.tag = 2, l != null && (y.callback = l), l = Ca(o, y, p), l !== null && (es(l, o, p), ef(l, o, p));
    }
  };
  function $x(o, l, p, y, E, A, B) {
    return o = o.stateNode, typeof o.shouldComponentUpdate == "function" ? o.shouldComponentUpdate(y, A, B) : l.prototype && l.prototype.isPureReactComponent ? !_(p, y) || !_(E, A) : !0;
  }
  function Mg(o, l, p, y) {
    o = l.state, typeof l.componentWillReceiveProps == "function" && l.componentWillReceiveProps(p, y), typeof l.UNSAFE_componentWillReceiveProps == "function" && l.UNSAFE_componentWillReceiveProps(p, y), l.state !== o && pf.enqueueReplaceState(l, l.state, null);
  }
  function Ii(o, l) {
    var p = l;
    if ("ref" in l) {
      p = {};
      for (var y in l)
        y !== "ref" && (p[y] = l[y]);
    }
    if (o = o.defaultProps) {
      p === l && (p = m({}, p));
      for (var E in o)
        p[E] === void 0 && (p[E] = o[E]);
    }
    return p;
  }
  function Og(o) {
    vt(o);
  }
  function Dg(o) {
    console.error(o);
  }
  function qx(o) {
    vt(o);
  }
  function mf(o, l) {
    try {
      var p = o.onUncaughtError;
      p(l.value, { componentStack: l.stack });
    } catch (y) {
      setTimeout(function() {
        throw y;
      });
    }
  }
  function Fx(o, l, p) {
    try {
      var y = o.onCaughtError;
      y(p.value, {
        componentStack: p.stack,
        errorBoundary: l.tag === 1 ? l.stateNode : null
      });
    } catch (E) {
      setTimeout(function() {
        throw E;
      });
    }
  }
  function zg(o, l, p) {
    return p = kl(p), p.tag = 3, p.payload = { element: null }, p.callback = function() {
      mf(o, l);
    }, p;
  }
  function eo(o) {
    return o = kl(o), o.tag = 3, o;
  }
  function cp(o, l, p, y) {
    var E = p.type.getDerivedStateFromError;
    if (typeof E == "function") {
      var A = y.value;
      o.payload = function() {
        return E(A);
      }, o.callback = function() {
        Fx(l, p, y);
      };
    }
    var B = p.stateNode;
    B !== null && typeof B.componentDidCatch == "function" && (o.callback = function() {
      Fx(l, p, y), typeof E != "function" && (zl === null ? zl = /* @__PURE__ */ new Set([this]) : zl.add(this));
      var ne = y.stack;
      this.componentDidCatch(y.value, {
        componentStack: ne !== null ? ne : ""
      });
    });
  }
  function Pg(o, l, p, y, E) {
    if (p.flags |= 32768, y !== null && typeof y == "object" && typeof y.then == "function") {
      if (l = p.alternate, l !== null && Ac(
        l,
        p,
        E,
        !0
      ), p = bs.current, p !== null) {
        switch (p.tag) {
          case 31:
          case 13:
            return ia === null ? Ep() : p.alternate === null && cr === 0 && (cr = 3), p.flags &= -257, p.flags |= 65536, p.lanes = E, y === Vh ? p.flags |= 16384 : (l = p.updateQueue, l === null ? p.updateQueue = /* @__PURE__ */ new Set([y]) : l.add(y), d0(o, y, E)), !1;
          case 22:
            return p.flags |= 65536, y === Vh ? p.flags |= 16384 : (l = p.updateQueue, l === null ? (l = {
              transitions: null,
              markerInstances: null,
              retryQueue: /* @__PURE__ */ new Set([y])
            }, p.updateQueue = l) : (p = l.retryQueue, p === null ? l.retryQueue = /* @__PURE__ */ new Set([y]) : p.add(y)), d0(o, y, E)), !1;
        }
        throw Error(r(435, p.tag));
      }
      return d0(o, y, E), Ep(), !1;
    }
    if (un)
      return l = bs.current, l !== null ? ((l.flags & 65536) === 0 && (l.flags |= 256), l.flags |= 65536, l.lanes = E, y !== sg && (o = Error(r(422), { cause: y }), Sl(ys(o, p)))) : (y !== sg && (l = Error(r(423), {
        cause: y
      }), Sl(
        ys(l, p)
      )), o = o.current.alternate, o.flags |= 65536, E &= -E, o.lanes |= E, y = ys(y, p), E = zg(
        o.stateNode,
        y,
        E
      ), Yh(o, E), cr !== 4 && (cr = 2)), !1;
    var A = Error(r(520), { cause: y });
    if (A = ys(A, p), Af === null ? Af = [A] : Af.push(A), cr !== 4 && (cr = 2), l === null) return !0;
    y = ys(y, p), p = l;
    do {
      switch (p.tag) {
        case 3:
          return p.flags |= 65536, o = E & -E, p.lanes |= o, o = zg(p.stateNode, y, o), Yh(p, o), !1;
        case 1:
          if (l = p.type, A = p.stateNode, (p.flags & 128) === 0 && (typeof l.getDerivedStateFromError == "function" || A !== null && typeof A.componentDidCatch == "function" && (zl === null || !zl.has(A))))
            return p.flags |= 65536, E &= -E, p.lanes |= E, E = eo(E), cp(
              E,
              o,
              p,
              y
            ), Yh(p, E), !1;
      }
      p = p.return;
    } while (p !== null);
    return !1;
  }
  var gf = Error(r(461)), ur = !1;
  function mr(o, l, p, y) {
    l.child = o === null ? cg(l, null, p, y) : Cl(
      l,
      o.child,
      p,
      y
    );
  }
  function Nt(o, l, p, y, E) {
    p = p.render;
    var A = l.ref;
    if ("ref" in y) {
      var B = {};
      for (var ne in y)
        ne !== "ref" && (B[ne] = y[ne]);
    } else B = y;
    return Au(l), y = Jh(
      o,
      l,
      p,
      B,
      A,
      E
    ), ne = ep(), o !== null && !ur ? (tp(o, l, E), to(o, l, E)) : (un && ne && vl(l), l.flags |= 1, mr(o, l, y, E), l.child);
  }
  function yf(o, l, p, y, E) {
    if (o === null) {
      var A = p.type;
      return typeof A == "function" && !ko(A) && A.defaultProps === void 0 && p.compare === null ? (l.tag = 15, l.type = A, dp(
        o,
        l,
        A,
        y,
        E
      )) : (o = $h(
        p.type,
        null,
        y,
        l,
        l.mode,
        E
      ), o.ref = l.ref, o.return = l, l.child = o);
    }
    if (A = o.child, !gp(o, E)) {
      var B = A.memoizedProps;
      if (p = p.compare, p = p !== null ? p : _, p(B, y) && o.ref === l.ref)
        return to(o, l, E);
    }
    return l.flags |= 1, o = Zs(A, y), o.ref = l.ref, o.return = l, l.child = o;
  }
  function dp(o, l, p, y, E) {
    if (o !== null) {
      var A = o.memoizedProps;
      if (_(A, y) && o.ref === l.ref)
        if (ur = !1, l.pendingProps = y = A, gp(o, E))
          (o.flags & 131072) !== 0 && (ur = !0);
        else
          return l.lanes = o.lanes, to(o, l, E);
    }
    return pp(
      o,
      l,
      p,
      y,
      E
    );
  }
  function Rl(o, l, p, y) {
    var E = y.children, A = o !== null ? o.memoizedState : null;
    if (o === null && l.stateNode === null && (l.stateNode = {
      _visibility: 1,
      _pendingMarkers: null,
      _retryCache: null,
      _transitions: null
    }), y.mode === "hidden") {
      if ((l.flags & 128) !== 0) {
        if (A = A !== null ? A.baseLanes | p : p, o !== null) {
          for (y = l.child = o.child, E = 0; y !== null; )
            E = E | y.lanes | y.childLanes, y = y.sibling;
          y = E & ~A;
        } else y = 0, l.child = null;
        return fp(
          o,
          l,
          A,
          p,
          y
        );
      }
      if ((p & 536870912) !== 0)
        l.memoizedState = { baseLanes: 0, cachePool: null }, o !== null && Uh(
          l,
          A !== null ? A.cachePool : null
        ), A !== null ? dg(l, A) : fi(), jx(l);
      else
        return y = l.lanes = 536870912, fp(
          o,
          l,
          A !== null ? A.baseLanes | p : p,
          p,
          y
        );
    } else
      A !== null ? (Uh(l, A.cachePool), dg(l, A), sa(), l.memoizedState = null) : (o !== null && Uh(l, null), fi(), sa());
    return mr(o, l, E, p), l.child;
  }
  function xf(o, l) {
    return o !== null && o.tag === 22 || l.stateNode !== null || (l.stateNode = {
      _visibility: 1,
      _pendingMarkers: null,
      _retryCache: null,
      _transitions: null
    }), l.sibling;
  }
  function fp(o, l, p, y, E) {
    var A = lg();
    return A = A === null ? null : { parent: zr._currentValue, pool: A }, l.memoizedState = {
      baseLanes: p,
      cachePool: A
    }, o !== null && Uh(l, null), fi(), jx(l), o !== null && Ac(o, l, y, !0), l.childLanes = E, null;
  }
  function vf(o, l) {
    return l = mp(
      { mode: l.mode, children: l.children },
      o.mode
    ), l.ref = o.ref, o.child = l, l.return = o, l;
  }
  function hi(o, l, p) {
    return Cl(l, o.child, null, p), o = vf(l, l.pendingProps), o.flags |= 2, Yi(l), l.memoizedState = null, o;
  }
  function Xw(o, l, p) {
    var y = l.pendingProps, E = (l.flags & 128) !== 0;
    if (l.flags &= -129, o === null) {
      if (un) {
        if (y.mode === "hidden")
          return o = vf(l, y), l.lanes = 536870912, xf(null, o);
        if (nf(l), (o = En) ? (o = Mv(
          o,
          ea
        ), o = o !== null && o.data === "&" ? o : null, o !== null && (l.memoizedState = {
          dehydrated: o,
          treeContext: To !== null ? { id: Za, overflow: Js } : null,
          retryLane: 536870912,
          hydrationErrors: null
        }, p = Yd(o), p.return = l, l.child = p, Dr = l, En = null)) : o = null, o === null) throw wl(l);
        return l.lanes = 536870912, null;
      }
      return vf(l, y);
    }
    var A = o.memoizedState;
    if (A !== null) {
      var B = A.dehydrated;
      if (nf(l), E)
        if (l.flags & 256)
          l.flags &= -257, l = hi(
            o,
            l,
            p
          );
        else if (l.memoizedState !== null)
          l.child = o.child, l.flags |= 128, l = null;
        else throw Error(r(558));
      else if (ur || Ac(o, l, p, !1), E = (p & o.childLanes) !== 0, ur || E) {
        if (y = $n, y !== null && (B = Gn(y, p), B !== 0 && B !== A.retryLane))
          throw A.retryLane = B, Ln(o, B), es(y, o, B), gf;
        Ep(), l = hi(
          o,
          l,
          p
        );
      } else
        o = A.treeContext, En = oa(B.nextSibling), Dr = l, un = !0, bl = null, ea = !1, o !== null && Tc(l, o), l = vf(l, y), l.flags |= 4096;
      return l;
    }
    return o = Zs(o.child, {
      mode: y.mode,
      children: y.children
    }), o.ref = l.ref, l.child = o, o.return = l, o;
  }
  function hp(o, l) {
    var p = l.ref;
    if (p === null)
      o !== null && o.ref !== null && (l.flags |= 4194816);
    else {
      if (typeof p != "function" && typeof p != "object")
        throw Error(r(284));
      (o === null || o.ref !== p) && (l.flags |= 4194816);
    }
  }
  function pp(o, l, p, y, E) {
    return Au(l), p = Jh(
      o,
      l,
      p,
      y,
      void 0,
      E
    ), y = ep(), o !== null && !ur ? (tp(o, l, E), to(o, l, E)) : (un && y && vl(l), l.flags |= 1, mr(o, l, p, E), l.child);
  }
  function Ux(o, l, p, y, E, A) {
    return Au(l), l.updateQueue = null, p = sf(
      l,
      y,
      p,
      E
    ), fg(o), y = ep(), o !== null && !ur ? (tp(o, l, A), to(o, l, A)) : (un && y && vl(l), l.flags |= 1, mr(o, l, p, A), l.child);
  }
  function Ig(o, l, p, y, E) {
    if (Au(l), l.stateNode === null) {
      var A = ui, B = p.contextType;
      typeof B == "object" && B !== null && (A = di(B)), A = new p(y, A), l.memoizedState = A.state !== null && A.state !== void 0 ? A.state : null, A.updater = pf, l.stateNode = A, A._reactInternals = l, A = l.stateNode, A.props = y, A.state = l.memoizedState, A.refs = {}, Qa(l), B = p.contextType, A.context = typeof B == "object" && B !== null ? di(B) : ui, A.state = l.memoizedState, B = p.getDerivedStateFromProps, typeof B == "function" && (up(
        l,
        p,
        B,
        y
      ), A.state = l.memoizedState), typeof p.getDerivedStateFromProps == "function" || typeof A.getSnapshotBeforeUpdate == "function" || typeof A.UNSAFE_componentWillMount != "function" && typeof A.componentWillMount != "function" || (B = A.state, typeof A.componentWillMount == "function" && A.componentWillMount(), typeof A.UNSAFE_componentWillMount == "function" && A.UNSAFE_componentWillMount(), B !== A.state && pf.enqueueReplaceState(A, A.state, null), zc(l, y, A, E), Mu(), A.state = l.memoizedState), typeof A.componentDidMount == "function" && (l.flags |= 4194308), y = !0;
    } else if (o === null) {
      A = l.stateNode;
      var ne = l.memoizedProps, xe = Ii(p, ne);
      A.props = xe;
      var De = A.context, Ue = p.contextType;
      B = ui, typeof Ue == "object" && Ue !== null && (B = di(Ue));
      var Ke = p.getDerivedStateFromProps;
      Ue = typeof Ke == "function" || typeof A.getSnapshotBeforeUpdate == "function", ne = l.pendingProps !== ne, Ue || typeof A.UNSAFE_componentWillReceiveProps != "function" && typeof A.componentWillReceiveProps != "function" || (ne || De !== B) && Mg(
        l,
        A,
        y,
        B
      ), ra = !1;
      var Pe = l.memoizedState;
      A.state = Pe, zc(l, y, A, E), Mu(), De = l.memoizedState, ne || Pe !== De || ra ? (typeof Ke == "function" && (up(
        l,
        p,
        Ke,
        y
      ), De = l.memoizedState), (xe = ra || $x(
        l,
        p,
        xe,
        y,
        Pe,
        De,
        B
      )) ? (Ue || typeof A.UNSAFE_componentWillMount != "function" && typeof A.componentWillMount != "function" || (typeof A.componentWillMount == "function" && A.componentWillMount(), typeof A.UNSAFE_componentWillMount == "function" && A.UNSAFE_componentWillMount()), typeof A.componentDidMount == "function" && (l.flags |= 4194308)) : (typeof A.componentDidMount == "function" && (l.flags |= 4194308), l.memoizedProps = y, l.memoizedState = De), A.props = y, A.state = De, A.context = B, y = xe) : (typeof A.componentDidMount == "function" && (l.flags |= 4194308), y = !1);
    } else {
      A = l.stateNode, Kh(o, l), B = l.memoizedProps, Ue = Ii(p, B), A.props = Ue, Ke = l.pendingProps, Pe = A.context, De = p.contextType, xe = ui, typeof De == "object" && De !== null && (xe = di(De)), ne = p.getDerivedStateFromProps, (De = typeof ne == "function" || typeof A.getSnapshotBeforeUpdate == "function") || typeof A.UNSAFE_componentWillReceiveProps != "function" && typeof A.componentWillReceiveProps != "function" || (B !== Ke || Pe !== xe) && Mg(
        l,
        A,
        y,
        xe
      ), ra = !1, Pe = l.memoizedState, A.state = Pe, zc(l, y, A, E), Mu();
      var Be = l.memoizedState;
      B !== Ke || Pe !== Be || ra || o !== null && o.dependencies !== null && Fh(o.dependencies) ? (typeof ne == "function" && (up(
        l,
        p,
        ne,
        y
      ), Be = l.memoizedState), (Ue = ra || $x(
        l,
        p,
        Ue,
        y,
        Pe,
        Be,
        xe
      ) || o !== null && o.dependencies !== null && Fh(o.dependencies)) ? (De || typeof A.UNSAFE_componentWillUpdate != "function" && typeof A.componentWillUpdate != "function" || (typeof A.componentWillUpdate == "function" && A.componentWillUpdate(y, Be, xe), typeof A.UNSAFE_componentWillUpdate == "function" && A.UNSAFE_componentWillUpdate(
        y,
        Be,
        xe
      )), typeof A.componentDidUpdate == "function" && (l.flags |= 4), typeof A.getSnapshotBeforeUpdate == "function" && (l.flags |= 1024)) : (typeof A.componentDidUpdate != "function" || B === o.memoizedProps && Pe === o.memoizedState || (l.flags |= 4), typeof A.getSnapshotBeforeUpdate != "function" || B === o.memoizedProps && Pe === o.memoizedState || (l.flags |= 1024), l.memoizedProps = y, l.memoizedState = Be), A.props = y, A.state = Be, A.context = xe, y = Ue) : (typeof A.componentDidUpdate != "function" || B === o.memoizedProps && Pe === o.memoizedState || (l.flags |= 4), typeof A.getSnapshotBeforeUpdate != "function" || B === o.memoizedProps && Pe === o.memoizedState || (l.flags |= 1024), y = !1);
    }
    return A = y, hp(o, l), y = (l.flags & 128) !== 0, A || y ? (A = l.stateNode, p = y && typeof p.getDerivedStateFromError != "function" ? null : A.render(), l.flags |= 1, o !== null && y ? (l.child = Cl(
      l,
      o.child,
      null,
      E
    ), l.child = Cl(
      l,
      null,
      p,
      E
    )) : mr(o, l, p, E), l.memoizedState = A.state, o = l.child) : o = to(
      o,
      l,
      E
    ), o;
  }
  function Hx(o, l, p, y) {
    return re(), l.flags |= 256, mr(o, l, p, y), l.child;
  }
  var Lg = {
    dehydrated: null,
    treeContext: null,
    retryLane: 0,
    hydrationErrors: null
  };
  function Bg(o) {
    return { baseLanes: o, cachePool: Ex() };
  }
  function Aa(o, l, p) {
    return o = o !== null ? o.childLanes & ~p : 0, l && (o |= Cs), o;
  }
  function Ti(o, l, p) {
    var y = l.pendingProps, E = !1, A = (l.flags & 128) !== 0, B;
    if ((B = A) || (B = o !== null && o.memoizedState === null ? !1 : (kr.current & 2) !== 0), B && (E = !0, l.flags &= -129), B = (l.flags & 32) !== 0, l.flags &= -33, o === null) {
      if (un) {
        if (E ? Tl(l) : sa(), (o = En) ? (o = Mv(
          o,
          ea
        ), o = o !== null && o.data !== "&" ? o : null, o !== null && (l.memoizedState = {
          dehydrated: o,
          treeContext: To !== null ? { id: Za, overflow: Js } : null,
          retryLane: 536870912,
          hydrationErrors: null
        }, p = Yd(o), p.return = l, l.child = p, Dr = l, En = null)) : o = null, o === null) throw wl(l);
        return ed(o) ? l.lanes = 32 : l.lanes = 536870912, null;
      }
      var ne = y.children;
      return y = y.fallback, E ? (sa(), E = l.mode, ne = mp(
        { mode: "hidden", children: ne },
        E
      ), y = ku(
        y,
        E,
        p,
        null
      ), ne.return = l, y.return = l, ne.sibling = y, l.child = ne, y = l.child, y.memoizedState = Bg(p), y.childLanes = Aa(
        o,
        B,
        p
      ), l.memoizedState = Lg, xf(null, y)) : (Tl(l), bf(l, ne));
    }
    var xe = o.memoizedState;
    if (xe !== null && (ne = xe.dehydrated, ne !== null)) {
      if (A)
        l.flags & 256 ? (Tl(l), l.flags &= -257, l = wf(
          o,
          l,
          p
        )) : l.memoizedState !== null ? (sa(), l.child = o.child, l.flags |= 128, l = null) : (sa(), ne = y.fallback, E = l.mode, y = mp(
          { mode: "visible", children: y.children },
          E
        ), ne = ku(
          ne,
          E,
          p,
          null
        ), ne.flags |= 2, y.return = l, ne.return = l, y.sibling = ne, l.child = y, Cl(
          l,
          o.child,
          null,
          p
        ), y = l.child, y.memoizedState = Bg(p), y.childLanes = Aa(
          o,
          B,
          p
        ), l.memoizedState = Lg, l = xf(null, y));
      else if (Tl(l), ed(ne)) {
        if (B = ne.nextSibling && ne.nextSibling.dataset, B) var De = B.dgst;
        B = De, y = Error(r(419)), y.stack = "", y.digest = B, Sl({ value: y, source: null, stack: null }), l = wf(
          o,
          l,
          p
        );
      } else if (ur || Ac(o, l, p, !1), B = (p & o.childLanes) !== 0, ur || B) {
        if (B = $n, B !== null && (y = Gn(B, p), y !== 0 && y !== xe.retryLane))
          throw xe.retryLane = y, Ln(o, y), es(B, o, y), gf;
        Op(ne) || Ep(), l = wf(
          o,
          l,
          p
        );
      } else
        Op(ne) ? (l.flags |= 192, l.child = o.child, l = null) : (o = xe.treeContext, En = oa(
          ne.nextSibling
        ), Dr = l, un = !0, bl = null, ea = !1, o !== null && Tc(l, o), l = bf(
          l,
          y.children
        ), l.flags |= 4096);
      return l;
    }
    return E ? (sa(), ne = y.fallback, E = l.mode, xe = o.child, De = xe.sibling, y = Zs(xe, {
      mode: "hidden",
      children: y.children
    }), y.subtreeFlags = xe.subtreeFlags & 65011712, De !== null ? ne = Zs(
      De,
      ne
    ) : (ne = ku(
      ne,
      E,
      p,
      null
    ), ne.flags |= 2), ne.return = l, y.return = l, y.sibling = ne, l.child = y, xf(null, y), y = l.child, ne = o.child.memoizedState, ne === null ? ne = Bg(p) : (E = ne.cachePool, E !== null ? (xe = zr._currentValue, E = E.parent !== xe ? { parent: xe, pool: xe } : E) : E = Ex(), ne = {
      baseLanes: ne.baseLanes | p,
      cachePool: E
    }), y.memoizedState = ne, y.childLanes = Aa(
      o,
      B,
      p
    ), l.memoizedState = Lg, xf(o.child, y)) : (Tl(l), p = o.child, o = p.sibling, p = Zs(p, {
      mode: "visible",
      children: y.children
    }), p.return = l, p.sibling = null, o !== null && (B = l.deletions, B === null ? (l.deletions = [o], l.flags |= 16) : B.push(o)), l.child = p, l.memoizedState = null, p);
  }
  function bf(o, l) {
    return l = mp(
      { mode: "visible", children: l },
      o.mode
    ), l.return = o, o.child = l;
  }
  function mp(o, l) {
    return o = ci(22, o, null, l), o.lanes = 0, o;
  }
  function wf(o, l, p) {
    return Cl(l, o.child, null, p), o = bf(
      l,
      l.pendingProps.children
    ), o.flags |= 2, l.memoizedState = null, o;
  }
  function Vx(o, l, p) {
    o.lanes |= l;
    var y = o.alternate;
    y !== null && (y.lanes |= l), No(o.return, l, p);
  }
  function $g(o, l, p, y, E, A) {
    var B = o.memoizedState;
    B === null ? o.memoizedState = {
      isBackwards: l,
      rendering: null,
      renderingStartTime: 0,
      last: y,
      tail: p,
      tailMode: E,
      treeForkCount: A
    } : (B.isBackwards = l, B.rendering = null, B.renderingStartTime = 0, B.last = y, B.tail = p, B.tailMode = E, B.treeForkCount = A);
  }
  function Vc(o, l, p) {
    var y = l.pendingProps, E = y.revealOrder, A = y.tail;
    y = y.children;
    var B = kr.current, ne = (B & 2) !== 0;
    if (ne ? (B = B & 1 | 2, l.flags |= 128) : B &= 1, Q(kr, B), mr(o, l, y, p), y = un ? Or : 0, !ne && o !== null && (o.flags & 128) !== 0)
      e: for (o = l.child; o !== null; ) {
        if (o.tag === 13)
          o.memoizedState !== null && Vx(o, p, l);
        else if (o.tag === 19)
          Vx(o, p, l);
        else if (o.child !== null) {
          o.child.return = o, o = o.child;
          continue;
        }
        if (o === l) break e;
        for (; o.sibling === null; ) {
          if (o.return === null || o.return === l)
            break e;
          o = o.return;
        }
        o.sibling.return = o.return, o = o.sibling;
      }
    switch (E) {
      case "forwards":
        for (p = l.child, E = null; p !== null; )
          o = p.alternate, o !== null && Zh(o) === null && (E = p), p = p.sibling;
        p = E, p === null ? (E = l.child, l.child = null) : (E = p.sibling, p.sibling = null), $g(
          l,
          !1,
          E,
          p,
          A,
          y
        );
        break;
      case "backwards":
      case "unstable_legacy-backwards":
        for (p = null, E = l.child, l.child = null; E !== null; ) {
          if (o = E.alternate, o !== null && Zh(o) === null) {
            l.child = E;
            break;
          }
          o = E.sibling, E.sibling = p, p = E, E = o;
        }
        $g(
          l,
          !0,
          p,
          null,
          A,
          y
        );
        break;
      case "together":
        $g(
          l,
          !1,
          null,
          null,
          void 0,
          y
        );
        break;
      default:
        l.memoizedState = null;
    }
    return l.child;
  }
  function to(o, l, p) {
    if (o !== null && (l.dependencies = o.dependencies), Dl |= l.lanes, (p & l.childLanes) === 0)
      if (o !== null) {
        if (Ac(
          o,
          l,
          p,
          !1
        ), (p & l.childLanes) === 0)
          return null;
      } else return null;
    if (o !== null && l.child !== o.child)
      throw Error(r(153));
    if (l.child !== null) {
      for (o = l.child, p = Zs(o, o.pendingProps), l.child = p, p.return = l; o.sibling !== null; )
        o = o.sibling, p = p.sibling = Zs(o, o.pendingProps), p.return = l;
      p.sibling = null;
    }
    return l.child;
  }
  function gp(o, l) {
    return (o.lanes & l) !== 0 ? !0 : (o = o.dependencies, !!(o !== null && Fh(o)));
  }
  function Qw(o, l, p) {
    switch (l.tag) {
      case 3:
        Ie(l, l.stateNode.containerInfo), El(l, zr, o.memoizedState.cache), re();
        break;
      case 27:
      case 5:
        mt(l);
        break;
      case 4:
        Ie(l, l.stateNode.containerInfo);
        break;
      case 10:
        El(
          l,
          l.type,
          l.memoizedProps.value
        );
        break;
      case 31:
        if (l.memoizedState !== null)
          return l.flags |= 128, nf(l), null;
        break;
      case 13:
        var y = l.memoizedState;
        if (y !== null)
          return y.dehydrated !== null ? (Tl(l), l.flags |= 128, null) : (p & l.child.childLanes) !== 0 ? Ti(o, l, p) : (Tl(l), o = to(
            o,
            l,
            p
          ), o !== null ? o.sibling : null);
        Tl(l);
        break;
      case 19:
        var E = (o.flags & 128) !== 0;
        if (y = (p & l.childLanes) !== 0, y || (Ac(
          o,
          l,
          p,
          !1
        ), y = (p & l.childLanes) !== 0), E) {
          if (y)
            return Vc(
              o,
              l,
              p
            );
          l.flags |= 128;
        }
        if (E = l.memoizedState, E !== null && (E.rendering = null, E.tail = null, E.lastEffect = null), Q(kr, kr.current), y) break;
        return null;
      case 22:
        return l.lanes = 0, Rl(
          o,
          l,
          p,
          l.pendingProps
        );
      case 24:
        El(l, zr, o.memoizedState.cache);
    }
    return to(o, l, p);
  }
  function Gx(o, l, p) {
    if (o !== null)
      if (o.memoizedProps !== l.pendingProps)
        ur = !0;
      else {
        if (!gp(o, p) && (l.flags & 128) === 0)
          return ur = !1, Qw(
            o,
            l,
            p
          );
        ur = (o.flags & 131072) !== 0;
      }
    else
      ur = !1, un && (l.flags & 1048576) !== 0 && qh(l, Or, l.index);
    switch (l.lanes = 0, l.tag) {
      case 16:
        e: {
          var y = l.pendingProps;
          if (o = Sa(l.elementType), l.type = o, typeof o == "function")
            ko(o) ? (y = Ii(o, y), l.tag = 1, l = Ig(
              null,
              l,
              o,
              y,
              p
            )) : (l.tag = 0, l = pp(
              null,
              l,
              o,
              y,
              p
            ));
          else {
            if (o != null) {
              var E = o.$$typeof;
              if (E === M) {
                l.tag = 11, l = Nt(
                  null,
                  l,
                  o,
                  y,
                  p
                );
                break e;
              } else if (E === q) {
                l.tag = 14, l = yf(
                  null,
                  l,
                  o,
                  y,
                  p
                );
                break e;
              }
            }
            throw l = Z(o) || o, Error(r(306, l, ""));
          }
        }
        return l;
      case 0:
        return pp(
          o,
          l,
          l.type,
          l.pendingProps,
          p
        );
      case 1:
        return y = l.type, E = Ii(
          y,
          l.pendingProps
        ), Ig(
          o,
          l,
          y,
          E,
          p
        );
      case 3:
        e: {
          if (Ie(
            l,
            l.stateNode.containerInfo
          ), o === null) throw Error(r(387));
          y = l.pendingProps;
          var A = l.memoizedState;
          E = A.element, Kh(o, l), zc(l, y, null, p);
          var B = l.memoizedState;
          if (y = B.cache, El(l, zr, y), y !== A.cache && ag(
            l,
            [zr],
            p,
            !0
          ), Mu(), y = B.element, A.isDehydrated)
            if (A = {
              element: y,
              isDehydrated: !1,
              cache: B.cache
            }, l.updateQueue.baseState = A, l.memoizedState = A, l.flags & 256) {
              l = Hx(
                o,
                l,
                y,
                p
              );
              break e;
            } else if (y !== E) {
              E = ys(
                Error(r(424)),
                l
              ), Sl(E), l = Hx(
                o,
                l,
                y,
                p
              );
              break e;
            } else {
              switch (o = l.stateNode.containerInfo, o.nodeType) {
                case 9:
                  o = o.body;
                  break;
                default:
                  o = o.nodeName === "HTML" ? o.ownerDocument.body : o;
              }
              for (En = oa(o.firstChild), Dr = l, un = !0, bl = null, ea = !0, p = cg(
                l,
                null,
                y,
                p
              ), l.child = p; p; )
                p.flags = p.flags & -3 | 4096, p = p.sibling;
            }
          else {
            if (re(), y === E) {
              l = to(
                o,
                l,
                p
              );
              break e;
            }
            mr(o, l, y, p);
          }
          l = l.child;
        }
        return l;
      case 26:
        return hp(o, l), o === null ? (p = Lv(
          l.type,
          null,
          l.pendingProps,
          null
        )) ? l.memoizedState = p : un || (p = l.type, o = l.pendingProps, y = qf(
          Se.current
        ).createElement(p), y[Rn] = l, y[ar] = o, pi(y, p, o), or(y), l.stateNode = y) : l.memoizedState = Lv(
          l.type,
          o.memoizedProps,
          l.pendingProps,
          o.memoizedState
        ), null;
      case 27:
        return mt(l), o === null && un && (y = l.stateNode = zv(
          l.type,
          l.pendingProps,
          Se.current
        ), Dr = l, ea = !0, E = En, zt(l.type) ? (S0 = E, En = oa(y.firstChild)) : En = E), mr(
          o,
          l,
          l.pendingProps.children,
          p
        ), hp(o, l), o === null && (l.flags |= 4194304), l.child;
      case 5:
        return o === null && un && ((E = y = En) && (y = p2(
          y,
          l.type,
          l.pendingProps,
          ea
        ), y !== null ? (l.stateNode = y, Dr = l, En = oa(y.firstChild), ea = !1, E = !0) : E = !1), E || wl(l)), mt(l), E = l.type, A = l.pendingProps, B = o !== null ? o.memoizedProps : null, y = A.children, Bl(E, A) ? y = null : B !== null && Bl(E, B) && (l.flags |= 32), l.memoizedState !== null && (E = Jh(
          o,
          l,
          Yw,
          null,
          null,
          p
        ), ad._currentValue = E), hp(o, l), mr(o, l, y, p), l.child;
      case 6:
        return o === null && un && ((o = p = En) && (p = Cn(
          p,
          l.pendingProps,
          ea
        ), p !== null ? (l.stateNode = p, Dr = l, En = null, o = !0) : o = !1), o || wl(l)), null;
      case 13:
        return Ti(o, l, p);
      case 4:
        return Ie(
          l,
          l.stateNode.containerInfo
        ), y = l.pendingProps, o === null ? l.child = Cl(
          l,
          null,
          y,
          p
        ) : mr(o, l, y, p), l.child;
      case 11:
        return Nt(
          o,
          l,
          l.type,
          l.pendingProps,
          p
        );
      case 7:
        return mr(
          o,
          l,
          l.pendingProps,
          p
        ), l.child;
      case 8:
        return mr(
          o,
          l,
          l.pendingProps.children,
          p
        ), l.child;
      case 12:
        return mr(
          o,
          l,
          l.pendingProps.children,
          p
        ), l.child;
      case 10:
        return y = l.pendingProps, El(l, l.type, y.value), mr(o, l, y.children, p), l.child;
      case 9:
        return E = l.type._context, y = l.pendingProps.children, Au(l), E = di(E), y = y(E), l.flags |= 1, mr(o, l, y, p), l.child;
      case 14:
        return yf(
          o,
          l,
          l.type,
          l.pendingProps,
          p
        );
      case 15:
        return dp(
          o,
          l,
          l.type,
          l.pendingProps,
          p
        );
      case 19:
        return Vc(o, l, p);
      case 31:
        return Xw(o, l, p);
      case 22:
        return Rl(
          o,
          l,
          p,
          l.pendingProps
        );
      case 24:
        return Au(l), y = di(zr), o === null ? (E = lg(), E === null && (E = $n, A = _a(), E.pooledCache = A, A.refCount++, A !== null && (E.pooledCacheLanes |= p), E = A), l.memoizedState = { parent: y, cache: E }, Qa(l), El(l, zr, E)) : ((o.lanes & p) !== 0 && (Kh(o, l), zc(l, null, null, p), Mu()), E = o.memoizedState, A = l.memoizedState, E.parent !== y ? (E = { parent: y, cache: y }, l.memoizedState = E, l.lanes === 0 && (l.memoizedState = l.updateQueue.baseState = E), El(l, zr, y)) : (y = A.cache, El(l, zr, y), y !== E.cache && ag(
          l,
          [zr],
          p,
          !0
        ))), mr(
          o,
          l,
          l.pendingProps.children,
          p
        ), l.child;
      case 29:
        throw l.pendingProps;
    }
    throw Error(r(156, l.tag));
  }
  function Oo(o) {
    o.flags |= 4;
  }
  function qg(o, l, p, y, E) {
    if ((l = (o.mode & 32) !== 0) && (l = !1), l) {
      if (o.flags |= 16777216, (E & 335544128) === E)
        if (o.stateNode.complete) o.flags |= 8192;
        else if (Mf()) o.flags |= 8192;
        else
          throw Xa = Vh, Hh;
    } else o.flags &= -16777217;
  }
  function Fg(o, l) {
    if (l.type !== "stylesheet" || (l.state.loading & 4) !== 0)
      o.flags &= -16777217;
    else if (o.flags |= 16777216, !Uv(l))
      if (Mf()) o.flags |= 8192;
      else
        throw Xa = Vh, Hh;
  }
  function _f(o, l) {
    l !== null && (o.flags |= 4), o.flags & 16384 && (l = o.tag !== 22 ? cu() : 536870912, o.lanes |= l, Wc |= l);
  }
  function Sf(o, l) {
    if (!un)
      switch (o.tailMode) {
        case "hidden":
          l = o.tail;
          for (var p = null; l !== null; )
            l.alternate !== null && (p = l), l = l.sibling;
          p === null ? o.tail = null : p.sibling = null;
          break;
        case "collapsed":
          p = o.tail;
          for (var y = null; p !== null; )
            p.alternate !== null && (y = p), p = p.sibling;
          y === null ? l || o.tail === null ? o.tail = null : o.tail.sibling = null : y.sibling = null;
      }
  }
  function Bn(o) {
    var l = o.alternate !== null && o.alternate.child === o.child, p = 0, y = 0;
    if (l)
      for (var E = o.child; E !== null; )
        p |= E.lanes | E.childLanes, y |= E.subtreeFlags & 65011712, y |= E.flags & 65011712, E.return = o, E = E.sibling;
    else
      for (E = o.child; E !== null; )
        p |= E.lanes | E.childLanes, y |= E.subtreeFlags, y |= E.flags, E.return = o, E = E.sibling;
    return o.subtreeFlags |= y, o.childLanes = p, l;
  }
  function Kx(o, l, p) {
    var y = l.pendingProps;
    switch (Tu(l), l.tag) {
      case 16:
      case 15:
      case 0:
      case 11:
      case 7:
      case 8:
      case 12:
      case 9:
      case 14:
        return Bn(l), null;
      case 1:
        return Bn(l), null;
      case 3:
        return p = l.stateNode, y = null, o !== null && (y = o.memoizedState.cache), l.memoizedState.cache !== y && (l.flags |= 2048), Ao(zr), Re(), p.pendingContext && (p.context = p.pendingContext, p.pendingContext = null), (o === null || o.child === null) && (ju(l) ? Oo(l) : o === null || o.memoizedState.isDehydrated && (l.flags & 256) === 0 || (l.flags |= 1024, _l())), Bn(l), null;
      case 26:
        var E = l.type, A = l.memoizedState;
        return o === null ? (Oo(l), A !== null ? (Bn(l), Fg(l, A)) : (Bn(l), qg(
          l,
          E,
          null,
          y,
          p
        ))) : A ? A !== o.memoizedState ? (Oo(l), Bn(l), Fg(l, A)) : (Bn(l), l.flags &= -16777217) : (o = o.memoizedProps, o !== y && Oo(l), Bn(l), qg(
          l,
          E,
          o,
          y,
          p
        )), null;
      case 27:
        if (dt(l), p = Se.current, E = l.type, o !== null && l.stateNode != null)
          o.memoizedProps !== y && Oo(l);
        else {
          if (!y) {
            if (l.stateNode === null)
              throw Error(r(166));
            return Bn(l), null;
          }
          o = fe.current, ju(l) ? Zd(l) : (o = zv(E, y, p), l.stateNode = o, Oo(l));
        }
        return Bn(l), null;
      case 5:
        if (dt(l), E = l.type, o !== null && l.stateNode != null)
          o.memoizedProps !== y && Oo(l);
        else {
          if (!y) {
            if (l.stateNode === null)
              throw Error(r(166));
            return Bn(l), null;
          }
          if (A = fe.current, ju(l))
            Zd(l);
          else {
            var B = qf(
              Se.current
            );
            switch (A) {
              case 1:
                A = B.createElementNS(
                  "http://www.w3.org/2000/svg",
                  E
                );
                break;
              case 2:
                A = B.createElementNS(
                  "http://www.w3.org/1998/Math/MathML",
                  E
                );
                break;
              default:
                switch (E) {
                  case "svg":
                    A = B.createElementNS(
                      "http://www.w3.org/2000/svg",
                      E
                    );
                    break;
                  case "math":
                    A = B.createElementNS(
                      "http://www.w3.org/1998/Math/MathML",
                      E
                    );
                    break;
                  case "script":
                    A = B.createElement("div"), A.innerHTML = "<script><\/script>", A = A.removeChild(
                      A.firstChild
                    );
                    break;
                  case "select":
                    A = typeof y.is == "string" ? B.createElement("select", {
                      is: y.is
                    }) : B.createElement("select"), y.multiple ? A.multiple = !0 : y.size && (A.size = y.size);
                    break;
                  default:
                    A = typeof y.is == "string" ? B.createElement(E, { is: y.is }) : B.createElement(E);
                }
            }
            A[Rn] = l, A[ar] = y;
            e: for (B = l.child; B !== null; ) {
              if (B.tag === 5 || B.tag === 6)
                A.appendChild(B.stateNode);
              else if (B.tag !== 4 && B.tag !== 27 && B.child !== null) {
                B.child.return = B, B = B.child;
                continue;
              }
              if (B === l) break e;
              for (; B.sibling === null; ) {
                if (B.return === null || B.return === l)
                  break e;
                B = B.return;
              }
              B.sibling.return = B.return, B = B.sibling;
            }
            l.stateNode = A;
            e: switch (pi(A, E, y), E) {
              case "button":
              case "input":
              case "select":
              case "textarea":
                y = !!y.autoFocus;
                break e;
              case "img":
                y = !0;
                break e;
              default:
                y = !1;
            }
            y && Oo(l);
          }
        }
        return Bn(l), qg(
          l,
          l.type,
          o === null ? null : o.memoizedProps,
          l.pendingProps,
          p
        ), null;
      case 6:
        if (o && l.stateNode != null)
          o.memoizedProps !== y && Oo(l);
        else {
          if (typeof y != "string" && l.stateNode === null)
            throw Error(r(166));
          if (o = Se.current, ju(l)) {
            if (o = l.stateNode, p = l.memoizedProps, y = null, E = Dr, E !== null)
              switch (E.tag) {
                case 27:
                case 5:
                  y = E.memoizedProps;
              }
            o[Rn] = l, o = !!(o.nodeValue === p || y !== null && y.suppressHydrationWarning === !0 || jv(o.nodeValue, p)), o || wl(l, !0);
          } else
            o = qf(o).createTextNode(
              y
            ), o[Rn] = l, l.stateNode = o;
        }
        return Bn(l), null;
      case 31:
        if (p = l.memoizedState, o === null || o.memoizedState !== null) {
          if (y = ju(l), p !== null) {
            if (o === null) {
              if (!y) throw Error(r(318));
              if (o = l.memoizedState, o = o !== null ? o.dehydrated : null, !o) throw Error(r(557));
              o[Rn] = l;
            } else
              re(), (l.flags & 128) === 0 && (l.memoizedState = null), l.flags |= 4;
            Bn(l), o = !1;
          } else
            p = _l(), o !== null && o.memoizedState !== null && (o.memoizedState.hydrationErrors = p), o = !0;
          if (!o)
            return l.flags & 256 ? (Yi(l), l) : (Yi(l), null);
          if ((l.flags & 128) !== 0)
            throw Error(r(558));
        }
        return Bn(l), null;
      case 13:
        if (y = l.memoizedState, o === null || o.memoizedState !== null && o.memoizedState.dehydrated !== null) {
          if (E = ju(l), y !== null && y.dehydrated !== null) {
            if (o === null) {
              if (!E) throw Error(r(318));
              if (E = l.memoizedState, E = E !== null ? E.dehydrated : null, !E) throw Error(r(317));
              E[Rn] = l;
            } else
              re(), (l.flags & 128) === 0 && (l.memoizedState = null), l.flags |= 4;
            Bn(l), E = !1;
          } else
            E = _l(), o !== null && o.memoizedState !== null && (o.memoizedState.hydrationErrors = E), E = !0;
          if (!E)
            return l.flags & 256 ? (Yi(l), l) : (Yi(l), null);
        }
        return Yi(l), (l.flags & 128) !== 0 ? (l.lanes = p, l) : (p = y !== null, o = o !== null && o.memoizedState !== null, p && (y = l.child, E = null, y.alternate !== null && y.alternate.memoizedState !== null && y.alternate.memoizedState.cachePool !== null && (E = y.alternate.memoizedState.cachePool.pool), A = null, y.memoizedState !== null && y.memoizedState.cachePool !== null && (A = y.memoizedState.cachePool.pool), A !== E && (y.flags |= 2048)), p !== o && p && (l.child.flags |= 8192), _f(l, l.updateQueue), Bn(l), null);
      case 4:
        return Re(), o === null && g0(l.stateNode.containerInfo), Bn(l), null;
      case 10:
        return Ao(l.type), Bn(l), null;
      case 19:
        if (ge(kr), y = l.memoizedState, y === null) return Bn(l), null;
        if (E = (l.flags & 128) !== 0, A = y.rendering, A === null)
          if (E) Sf(y, !1);
          else {
            if (cr !== 0 || o !== null && (o.flags & 128) !== 0)
              for (o = l.child; o !== null; ) {
                if (A = Zh(o), A !== null) {
                  for (l.flags |= 128, Sf(y, !1), o = A.updateQueue, l.updateQueue = o, _f(l, o), l.subtreeFlags = 0, o = p, p = l.child; p !== null; )
                    bx(p, o), p = p.sibling;
                  return Q(
                    kr,
                    kr.current & 1 | 2
                  ), un && xs(l, y.treeForkCount), l.child;
                }
                o = o.sibling;
              }
            y.tail !== null && kn() > Iu && (l.flags |= 128, E = !0, Sf(y, !1), l.lanes = 4194304);
          }
        else {
          if (!E)
            if (o = Zh(A), o !== null) {
              if (l.flags |= 128, E = !0, o = o.updateQueue, l.updateQueue = o, _f(l, o), Sf(y, !0), y.tail === null && y.tailMode === "hidden" && !A.alternate && !un)
                return Bn(l), null;
            } else
              2 * kn() - y.renderingStartTime > Iu && p !== 536870912 && (l.flags |= 128, E = !0, Sf(y, !1), l.lanes = 4194304);
          y.isBackwards ? (A.sibling = l.child, l.child = A) : (o = y.last, o !== null ? o.sibling = A : l.child = A, y.last = A);
        }
        return y.tail !== null ? (o = y.tail, y.rendering = o, y.tail = o.sibling, y.renderingStartTime = kn(), o.sibling = null, p = kr.current, Q(
          kr,
          E ? p & 1 | 2 : p & 1
        ), un && xs(l, y.treeForkCount), o) : (Bn(l), null);
      case 22:
      case 23:
        return Yi(l), tf(), y = l.memoizedState !== null, o !== null ? o.memoizedState !== null !== y && (l.flags |= 8192) : y && (l.flags |= 8192), y ? (p & 536870912) !== 0 && (l.flags & 128) === 0 && (Bn(l), l.subtreeFlags & 6 && (l.flags |= 8192)) : Bn(l), p = l.updateQueue, p !== null && _f(l, p.retryQueue), p = null, o !== null && o.memoizedState !== null && o.memoizedState.cachePool !== null && (p = o.memoizedState.cachePool.pool), y = null, l.memoizedState !== null && l.memoizedState.cachePool !== null && (y = l.memoizedState.cachePool.pool), y !== p && (l.flags |= 2048), o !== null && ge(Ru), null;
      case 24:
        return p = null, o !== null && (p = o.memoizedState.cache), l.memoizedState.cache !== p && (l.flags |= 2048), Ao(zr), Bn(l), null;
      case 25:
        return null;
      case 30:
        return null;
    }
    throw Error(r(156, l.tag));
  }
  function Ef(o, l) {
    switch (Tu(l), l.tag) {
      case 1:
        return o = l.flags, o & 65536 ? (l.flags = o & -65537 | 128, l) : null;
      case 3:
        return Ao(zr), Re(), o = l.flags, (o & 65536) !== 0 && (o & 128) === 0 ? (l.flags = o & -65537 | 128, l) : null;
      case 26:
      case 27:
      case 5:
        return dt(l), null;
      case 31:
        if (l.memoizedState !== null) {
          if (Yi(l), l.alternate === null)
            throw Error(r(340));
          re();
        }
        return o = l.flags, o & 65536 ? (l.flags = o & -65537 | 128, l) : null;
      case 13:
        if (Yi(l), o = l.memoizedState, o !== null && o.dehydrated !== null) {
          if (l.alternate === null)
            throw Error(r(340));
          re();
        }
        return o = l.flags, o & 65536 ? (l.flags = o & -65537 | 128, l) : null;
      case 19:
        return ge(kr), null;
      case 4:
        return Re(), null;
      case 10:
        return Ao(l.type), null;
      case 22:
      case 23:
        return Yi(l), tf(), o !== null && ge(Ru), o = l.flags, o & 65536 ? (l.flags = o & -65537 | 128, l) : null;
      case 24:
        return Ao(zr), null;
      case 25:
        return null;
      default:
        return null;
    }
  }
  function yp(o, l) {
    switch (Tu(l), l.tag) {
      case 3:
        Ao(zr), Re();
        break;
      case 26:
      case 27:
      case 5:
        dt(l);
        break;
      case 4:
        Re();
        break;
      case 31:
        l.memoizedState !== null && Yi(l);
        break;
      case 13:
        Yi(l);
        break;
      case 19:
        ge(kr);
        break;
      case 10:
        Ao(l.type);
        break;
      case 22:
      case 23:
        Yi(l), tf(), o !== null && ge(Ru);
        break;
      case 24:
        Ao(zr);
    }
  }
  function Gc(o, l) {
    try {
      var p = l.updateQueue, y = p !== null ? p.lastEffect : null;
      if (y !== null) {
        var E = y.next;
        p = E;
        do {
          if ((p.tag & o) === o) {
            y = void 0;
            var A = p.create, B = p.inst;
            y = A(), B.destroy = y;
          }
          p = p.next;
        } while (p !== E);
      }
    } catch (ne) {
      An(l, l.return, ne);
    }
  }
  function Do(o, l, p) {
    try {
      var y = l.updateQueue, E = y !== null ? y.lastEffect : null;
      if (E !== null) {
        var A = E.next;
        y = A;
        do {
          if ((y.tag & o) === o) {
            var B = y.inst, ne = B.destroy;
            if (ne !== void 0) {
              B.destroy = void 0, E = l;
              var xe = p, De = ne;
              try {
                De();
              } catch (Ue) {
                An(
                  E,
                  xe,
                  Ue
                );
              }
            }
          }
          y = y.next;
        } while (y !== A);
      }
    } catch (Ue) {
      An(l, l.return, Ue);
    }
  }
  function Cf(o) {
    var l = o.updateQueue;
    if (l !== null) {
      var p = o.stateNode;
      try {
        Wh(l, p);
      } catch (y) {
        An(o, o.return, y);
      }
    }
  }
  function Ug(o, l, p) {
    p.props = Ii(
      o.type,
      o.memoizedProps
    ), p.state = o.memoizedState;
    try {
      p.componentWillUnmount();
    } catch (y) {
      An(o, l, y);
    }
  }
  function Zi(o, l) {
    try {
      var p = o.ref;
      if (p !== null) {
        switch (o.tag) {
          case 26:
          case 27:
          case 5:
            var y = o.stateNode;
            break;
          case 30:
            y = o.stateNode;
            break;
          default:
            y = o.stateNode;
        }
        typeof p == "function" ? o.refCleanup = p(y) : p.current = y;
      }
    } catch (E) {
      An(o, l, E);
    }
  }
  function ji(o, l) {
    var p = o.ref, y = o.refCleanup;
    if (p !== null)
      if (typeof y == "function")
        try {
          y();
        } catch (E) {
          An(o, l, E);
        } finally {
          o.refCleanup = null, o = o.alternate, o != null && (o.refCleanup = null);
        }
      else if (typeof p == "function")
        try {
          p(null);
        } catch (E) {
          An(o, l, E);
        }
      else p.current = null;
  }
  function Yx(o) {
    var l = o.type, p = o.memoizedProps, y = o.stateNode;
    try {
      e: switch (l) {
        case "button":
        case "input":
        case "select":
        case "textarea":
          p.autoFocus && y.focus();
          break e;
        case "img":
          p.src ? y.src = p.src : p.srcSet && (y.srcset = p.srcSet);
      }
    } catch (E) {
      An(o, o.return, E);
    }
  }
  function xp(o, l, p) {
    try {
      var y = o.stateNode;
      d2(y, o.type, p, l), y[ar] = l;
    } catch (E) {
      An(o, o.return, E);
    }
  }
  function Wx(o) {
    return o.tag === 5 || o.tag === 3 || o.tag === 26 || o.tag === 27 && zt(o.type) || o.tag === 4;
  }
  function Hg(o) {
    e: for (; ; ) {
      for (; o.sibling === null; ) {
        if (o.return === null || Wx(o.return)) return null;
        o = o.return;
      }
      for (o.sibling.return = o.return, o = o.sibling; o.tag !== 5 && o.tag !== 6 && o.tag !== 18; ) {
        if (o.tag === 27 && zt(o.type) || o.flags & 2 || o.child === null || o.tag === 4) continue e;
        o.child.return = o, o = o.child;
      }
      if (!(o.flags & 2)) return o.stateNode;
    }
  }
  function Vg(o, l, p) {
    var y = o.tag;
    if (y === 5 || y === 6)
      o = o.stateNode, l ? (p.nodeType === 9 ? p.body : p.nodeName === "HTML" ? p.ownerDocument.body : p).insertBefore(o, l) : (l = p.nodeType === 9 ? p.body : p.nodeName === "HTML" ? p.ownerDocument.body : p, l.appendChild(o), p = p._reactRootContainer, p != null || l.onclick !== null || (l.onclick = Gi));
    else if (y !== 4 && (y === 27 && zt(o.type) && (p = o.stateNode, l = null), o = o.child, o !== null))
      for (Vg(o, l, p), o = o.sibling; o !== null; )
        Vg(o, l, p), o = o.sibling;
  }
  function vp(o, l, p) {
    var y = o.tag;
    if (y === 5 || y === 6)
      o = o.stateNode, l ? p.insertBefore(o, l) : p.appendChild(o);
    else if (y !== 4 && (y === 27 && zt(o.type) && (p = o.stateNode), o = o.child, o !== null))
      for (vp(o, l, p), o = o.sibling; o !== null; )
        vp(o, l, p), o = o.sibling;
  }
  function Zx(o) {
    var l = o.stateNode, p = o.memoizedProps;
    try {
      for (var y = o.type, E = l.attributes; E.length; )
        l.removeAttributeNode(E[0]);
      pi(l, y, p), l[Rn] = o, l[ar] = p;
    } catch (A) {
      An(o, o.return, A);
    }
  }
  var zo = !1, Pr = !1, Gg = !1, Xx = typeof WeakSet == "function" ? WeakSet : Set, Zr = null;
  function Jw(o, l) {
    if (o = o.containerInfo, $f = $p, o = F(o), W(o)) {
      if ("selectionStart" in o)
        var p = {
          start: o.selectionStart,
          end: o.selectionEnd
        };
      else
        e: {
          p = (p = o.ownerDocument) && p.defaultView || window;
          var y = p.getSelection && p.getSelection();
          if (y && y.rangeCount !== 0) {
            p = y.anchorNode;
            var E = y.anchorOffset, A = y.focusNode;
            y = y.focusOffset;
            try {
              p.nodeType, A.nodeType;
            } catch {
              p = null;
              break e;
            }
            var B = 0, ne = -1, xe = -1, De = 0, Ue = 0, Ke = o, Pe = null;
            t: for (; ; ) {
              for (var Be; Ke !== p || E !== 0 && Ke.nodeType !== 3 || (ne = B + E), Ke !== A || y !== 0 && Ke.nodeType !== 3 || (xe = B + y), Ke.nodeType === 3 && (B += Ke.nodeValue.length), (Be = Ke.firstChild) !== null; )
                Pe = Ke, Ke = Be;
              for (; ; ) {
                if (Ke === o) break t;
                if (Pe === p && ++De === E && (ne = B), Pe === A && ++Ue === y && (xe = B), (Be = Ke.nextSibling) !== null) break;
                Ke = Pe, Pe = Ke.parentNode;
              }
              Ke = Be;
            }
            p = ne === -1 || xe === -1 ? null : { start: ne, end: xe };
          } else p = null;
        }
      p = p || { start: 0, end: 0 };
    } else p = null;
    for (b0 = { focusedElem: o, selectionRange: p }, $p = !1, Zr = l; Zr !== null; )
      if (l = Zr, o = l.child, (l.subtreeFlags & 1028) !== 0 && o !== null)
        o.return = l, Zr = o;
      else
        for (; Zr !== null; ) {
          switch (l = Zr, A = l.alternate, o = l.flags, l.tag) {
            case 0:
              if ((o & 4) !== 0 && (o = l.updateQueue, o = o !== null ? o.events : null, o !== null))
                for (p = 0; p < o.length; p++)
                  E = o[p], E.ref.impl = E.nextImpl;
              break;
            case 11:
            case 15:
              break;
            case 1:
              if ((o & 1024) !== 0 && A !== null) {
                o = void 0, p = l, E = A.memoizedProps, A = A.memoizedState, y = p.stateNode;
                try {
                  var _t = Ii(
                    p.type,
                    E
                  );
                  o = y.getSnapshotBeforeUpdate(
                    _t,
                    A
                  ), y.__reactInternalSnapshotBeforeUpdate = o;
                } catch (Mt) {
                  An(
                    p,
                    p.return,
                    Mt
                  );
                }
              }
              break;
            case 3:
              if ((o & 1024) !== 0) {
                if (o = l.stateNode.containerInfo, p = o.nodeType, p === 9)
                  Mp(o);
                else if (p === 1)
                  switch (o.nodeName) {
                    case "HEAD":
                    case "HTML":
                    case "BODY":
                      Mp(o);
                      break;
                    default:
                      o.textContent = "";
                  }
              }
              break;
            case 5:
            case 26:
            case 27:
            case 6:
            case 4:
            case 17:
              break;
            default:
              if ((o & 1024) !== 0) throw Error(r(163));
          }
          if (o = l.sibling, o !== null) {
            o.return = l.return, Zr = o;
            break;
          }
          Zr = l.return;
        }
  }
  function Kg(o, l, p) {
    var y = p.flags;
    switch (p.tag) {
      case 0:
      case 11:
      case 15:
        Io(o, p), y & 4 && Gc(5, p);
        break;
      case 1:
        if (Io(o, p), y & 4)
          if (o = p.stateNode, l === null)
            try {
              o.componentDidMount();
            } catch (B) {
              An(p, p.return, B);
            }
          else {
            var E = Ii(
              p.type,
              l.memoizedProps
            );
            l = l.memoizedState;
            try {
              o.componentDidUpdate(
                E,
                l,
                o.__reactInternalSnapshotBeforeUpdate
              );
            } catch (B) {
              An(
                p,
                p.return,
                B
              );
            }
          }
        y & 64 && Cf(p), y & 512 && Zi(p, p.return);
        break;
      case 3:
        if (Io(o, p), y & 64 && (o = p.updateQueue, o !== null)) {
          if (l = null, p.child !== null)
            switch (p.child.tag) {
              case 27:
              case 5:
                l = p.child.stateNode;
                break;
              case 1:
                l = p.child.stateNode;
            }
          try {
            Wh(o, l);
          } catch (B) {
            An(p, p.return, B);
          }
        }
        break;
      case 27:
        l === null && y & 4 && Zx(p);
      case 26:
      case 5:
        Io(o, p), l === null && y & 4 && Yx(p), y & 512 && Zi(p, p.return);
        break;
      case 12:
        Io(o, p);
        break;
      case 31:
        Io(o, p), y & 4 && Wg(o, p);
        break;
      case 13:
        Io(o, p), y & 4 && Jx(o, p), y & 64 && (o = p.memoizedState, o !== null && (o = o.dehydrated, o !== null && (p = Tp.bind(
          null,
          p
        ), m2(o, p))));
        break;
      case 22:
        if (y = p.memoizedState !== null || zo, !y) {
          l = l !== null && l.memoizedState !== null || Pr, E = zo;
          var A = Pr;
          zo = y, (Pr = l) && !A ? no(
            o,
            p,
            (p.subtreeFlags & 8772) !== 0
          ) : Io(o, p), zo = E, Pr = A;
        }
        break;
      case 30:
        break;
      default:
        Io(o, p);
    }
  }
  function Yg(o) {
    var l = o.alternate;
    l !== null && (o.alternate = null, Yg(l)), o.child = null, o.deletions = null, o.sibling = null, o.tag === 5 && (l = o.stateNode, l !== null && ol(l)), o.stateNode = null, o.return = null, o.dependencies = null, o.memoizedProps = null, o.memoizedState = null, o.pendingProps = null, o.stateNode = null, o.updateQueue = null;
  }
  var Xn = null, Xi = !1;
  function Po(o, l, p) {
    for (p = p.child; p !== null; )
      Qx(o, l, p), p = p.sibling;
  }
  function Qx(o, l, p) {
    if (Jt && typeof Jt.onCommitFiberUnmount == "function")
      try {
        Jt.onCommitFiberUnmount(on, p);
      } catch {
      }
    switch (p.tag) {
      case 26:
        Pr || ji(p, l), Po(
          o,
          l,
          p
        ), p.memoizedState ? p.memoizedState.count-- : p.stateNode && (p = p.stateNode, p.parentNode.removeChild(p));
        break;
      case 27:
        Pr || ji(p, l);
        var y = Xn, E = Xi;
        zt(p.type) && (Xn = p.stateNode, Xi = !1), Po(
          o,
          l,
          p
        ), Uf(p.stateNode), Xn = y, Xi = E;
        break;
      case 5:
        Pr || ji(p, l);
      case 6:
        if (y = Xn, E = Xi, Xn = null, Po(
          o,
          l,
          p
        ), Xn = y, Xi = E, Xn !== null)
          if (Xi)
            try {
              (Xn.nodeType === 9 ? Xn.body : Xn.nodeName === "HTML" ? Xn.ownerDocument.body : Xn).removeChild(p.stateNode);
            } catch (A) {
              An(
                p,
                l,
                A
              );
            }
          else
            try {
              Xn.removeChild(p.stateNode);
            } catch (A) {
              An(
                p,
                l,
                A
              );
            }
        break;
      case 18:
        Xn !== null && (Xi ? (o = Xn, _0(
          o.nodeType === 9 ? o.body : o.nodeName === "HTML" ? o.ownerDocument.body : o,
          p.stateNode
        ), ld(o)) : _0(Xn, p.stateNode));
        break;
      case 4:
        y = Xn, E = Xi, Xn = p.stateNode.containerInfo, Xi = !0, Po(
          o,
          l,
          p
        ), Xn = y, Xi = E;
        break;
      case 0:
      case 11:
      case 14:
      case 15:
        Do(2, p, l), Pr || Do(4, p, l), Po(
          o,
          l,
          p
        );
        break;
      case 1:
        Pr || (ji(p, l), y = p.stateNode, typeof y.componentWillUnmount == "function" && Ug(
          p,
          l,
          y
        )), Po(
          o,
          l,
          p
        );
        break;
      case 21:
        Po(
          o,
          l,
          p
        );
        break;
      case 22:
        Pr = (y = Pr) || p.memoizedState !== null, Po(
          o,
          l,
          p
        ), Pr = y;
        break;
      default:
        Po(
          o,
          l,
          p
        );
    }
  }
  function Wg(o, l) {
    if (l.memoizedState === null && (o = l.alternate, o !== null && (o = o.memoizedState, o !== null))) {
      o = o.dehydrated;
      try {
        ld(o);
      } catch (p) {
        An(l, l.return, p);
      }
    }
  }
  function Jx(o, l) {
    if (l.memoizedState === null && (o = l.alternate, o !== null && (o = o.memoizedState, o !== null && (o = o.dehydrated, o !== null))))
      try {
        ld(o);
      } catch (p) {
        An(l, l.return, p);
      }
  }
  function e2(o) {
    switch (o.tag) {
      case 31:
      case 13:
      case 19:
        var l = o.stateNode;
        return l === null && (l = o.stateNode = new Xx()), l;
      case 22:
        return o = o.stateNode, l = o._retryCache, l === null && (l = o._retryCache = new Xx()), l;
      default:
        throw Error(r(435, o.tag));
    }
  }
  function bp(o, l) {
    var p = e2(o);
    l.forEach(function(y) {
      if (!p.has(y)) {
        p.add(y);
        var E = o2.bind(null, o, y);
        y.then(E, E);
      }
    });
  }
  function Qi(o, l) {
    var p = l.deletions;
    if (p !== null)
      for (var y = 0; y < p.length; y++) {
        var E = p[y], A = o, B = l, ne = B;
        e: for (; ne !== null; ) {
          switch (ne.tag) {
            case 27:
              if (zt(ne.type)) {
                Xn = ne.stateNode, Xi = !1;
                break e;
              }
              break;
            case 5:
              Xn = ne.stateNode, Xi = !1;
              break e;
            case 3:
            case 4:
              Xn = ne.stateNode.containerInfo, Xi = !0;
              break e;
          }
          ne = ne.return;
        }
        if (Xn === null) throw Error(r(160));
        Qx(A, B, E), Xn = null, Xi = !1, A = E.alternate, A !== null && (A.return = null), E.return = null;
      }
    if (l.subtreeFlags & 13886)
      for (l = l.child; l !== null; )
        ev(l, o), l = l.sibling;
  }
  var Na = null;
  function ev(o, l) {
    var p = o.alternate, y = o.flags;
    switch (o.tag) {
      case 0:
      case 11:
      case 14:
      case 15:
        Qi(l, o), Qn(o), y & 4 && (Do(3, o, o.return), Gc(3, o), Do(5, o, o.return));
        break;
      case 1:
        Qi(l, o), Qn(o), y & 512 && (Pr || p === null || ji(p, p.return)), y & 64 && zo && (o = o.updateQueue, o !== null && (y = o.callbacks, y !== null && (p = o.shared.hiddenCallbacks, o.shared.hiddenCallbacks = p === null ? y : p.concat(y))));
        break;
      case 26:
        var E = Na;
        if (Qi(l, o), Qn(o), y & 512 && (Pr || p === null || ji(p, p.return)), y & 4) {
          var A = p !== null ? p.memoizedState : null;
          if (y = o.memoizedState, p === null)
            if (y === null)
              if (o.stateNode === null) {
                e: {
                  y = o.type, p = o.memoizedProps, E = E.ownerDocument || E;
                  t: switch (y) {
                    case "title":
                      A = E.getElementsByTagName("title")[0], (!A || A[Ni] || A[Rn] || A.namespaceURI === "http://www.w3.org/2000/svg" || A.hasAttribute("itemprop")) && (A = E.createElement(y), E.head.insertBefore(
                        A,
                        E.querySelector("head > title")
                      )), pi(A, y, p), A[Rn] = o, or(A), y = A;
                      break e;
                    case "link":
                      var B = qv(
                        "link",
                        "href",
                        E
                      ).get(y + (p.href || ""));
                      if (B) {
                        for (var ne = 0; ne < B.length; ne++)
                          if (A = B[ne], A.getAttribute("href") === (p.href == null || p.href === "" ? null : p.href) && A.getAttribute("rel") === (p.rel == null ? null : p.rel) && A.getAttribute("title") === (p.title == null ? null : p.title) && A.getAttribute("crossorigin") === (p.crossOrigin == null ? null : p.crossOrigin)) {
                            B.splice(ne, 1);
                            break t;
                          }
                      }
                      A = E.createElement(y), pi(A, y, p), E.head.appendChild(A);
                      break;
                    case "meta":
                      if (B = qv(
                        "meta",
                        "content",
                        E
                      ).get(y + (p.content || ""))) {
                        for (ne = 0; ne < B.length; ne++)
                          if (A = B[ne], A.getAttribute("content") === (p.content == null ? null : "" + p.content) && A.getAttribute("name") === (p.name == null ? null : p.name) && A.getAttribute("property") === (p.property == null ? null : p.property) && A.getAttribute("http-equiv") === (p.httpEquiv == null ? null : p.httpEquiv) && A.getAttribute("charset") === (p.charSet == null ? null : p.charSet)) {
                            B.splice(ne, 1);
                            break t;
                          }
                      }
                      A = E.createElement(y), pi(A, y, p), E.head.appendChild(A);
                      break;
                    default:
                      throw Error(r(468, y));
                  }
                  A[Rn] = o, or(A), y = A;
                }
                o.stateNode = y;
              } else
                Fv(
                  E,
                  o.type,
                  o.stateNode
                );
            else
              o.stateNode = $v(
                E,
                y,
                o.memoizedProps
              );
          else
            A !== y ? (A === null ? p.stateNode !== null && (p = p.stateNode, p.parentNode.removeChild(p)) : A.count--, y === null ? Fv(
              E,
              o.type,
              o.stateNode
            ) : $v(
              E,
              y,
              o.memoizedProps
            )) : y === null && o.stateNode !== null && xp(
              o,
              o.memoizedProps,
              p.memoizedProps
            );
        }
        break;
      case 27:
        Qi(l, o), Qn(o), y & 512 && (Pr || p === null || ji(p, p.return)), p !== null && y & 4 && xp(
          o,
          o.memoizedProps,
          p.memoizedProps
        );
        break;
      case 5:
        if (Qi(l, o), Qn(o), y & 512 && (Pr || p === null || ji(p, p.return)), o.flags & 32) {
          E = o.stateNode;
          try {
            Vi(E, "");
          } catch (_t) {
            An(o, o.return, _t);
          }
        }
        y & 4 && o.stateNode != null && (E = o.memoizedProps, xp(
          o,
          E,
          p !== null ? p.memoizedProps : E
        )), y & 1024 && (Gg = !0);
        break;
      case 6:
        if (Qi(l, o), Qn(o), y & 4) {
          if (o.stateNode === null)
            throw Error(r(162));
          y = o.memoizedProps, p = o.stateNode;
          try {
            p.nodeValue = y;
          } catch (_t) {
            An(o, o.return, _t);
          }
        }
        break;
      case 3:
        if (Hf = null, E = Na, Na = Dp(l.containerInfo), Qi(l, o), Na = E, Qn(o), y & 4 && p !== null && p.memoizedState.isDehydrated)
          try {
            ld(l.containerInfo);
          } catch (_t) {
            An(o, o.return, _t);
          }
        Gg && (Gg = !1, tv(o));
        break;
      case 4:
        y = Na, Na = Dp(
          o.stateNode.containerInfo
        ), Qi(l, o), Qn(o), Na = y;
        break;
      case 12:
        Qi(l, o), Qn(o);
        break;
      case 31:
        Qi(l, o), Qn(o), y & 4 && (y = o.updateQueue, y !== null && (o.updateQueue = null, bp(o, y)));
        break;
      case 13:
        Qi(l, o), Qn(o), o.child.flags & 8192 && o.memoizedState !== null != (p !== null && p.memoizedState !== null) && (Nf = kn()), y & 4 && (y = o.updateQueue, y !== null && (o.updateQueue = null, bp(o, y)));
        break;
      case 22:
        E = o.memoizedState !== null;
        var xe = p !== null && p.memoizedState !== null, De = zo, Ue = Pr;
        if (zo = De || E, Pr = Ue || xe, Qi(l, o), Pr = Ue, zo = De, Qn(o), y & 8192)
          e: for (l = o.stateNode, l._visibility = E ? l._visibility & -2 : l._visibility | 1, E && (p === null || xe || zo || Pr || zu(o)), p = null, l = o; ; ) {
            if (l.tag === 5 || l.tag === 26) {
              if (p === null) {
                xe = p = l;
                try {
                  if (A = xe.stateNode, E)
                    B = A.style, typeof B.setProperty == "function" ? B.setProperty("display", "none", "important") : B.display = "none";
                  else {
                    ne = xe.stateNode;
                    var Ke = xe.memoizedProps.style, Pe = Ke != null && Ke.hasOwnProperty("display") ? Ke.display : null;
                    ne.style.display = Pe == null || typeof Pe == "boolean" ? "" : ("" + Pe).trim();
                  }
                } catch (_t) {
                  An(xe, xe.return, _t);
                }
              }
            } else if (l.tag === 6) {
              if (p === null) {
                xe = l;
                try {
                  xe.stateNode.nodeValue = E ? "" : xe.memoizedProps;
                } catch (_t) {
                  An(xe, xe.return, _t);
                }
              }
            } else if (l.tag === 18) {
              if (p === null) {
                xe = l;
                try {
                  var Be = xe.stateNode;
                  E ? As(Be, !0) : As(xe.stateNode, !1);
                } catch (_t) {
                  An(xe, xe.return, _t);
                }
              }
            } else if ((l.tag !== 22 && l.tag !== 23 || l.memoizedState === null || l === o) && l.child !== null) {
              l.child.return = l, l = l.child;
              continue;
            }
            if (l === o) break e;
            for (; l.sibling === null; ) {
              if (l.return === null || l.return === o) break e;
              p === l && (p = null), l = l.return;
            }
            p === l && (p = null), l.sibling.return = l.return, l = l.sibling;
          }
        y & 4 && (y = o.updateQueue, y !== null && (p = y.retryQueue, p !== null && (y.retryQueue = null, bp(o, p))));
        break;
      case 19:
        Qi(l, o), Qn(o), y & 4 && (y = o.updateQueue, y !== null && (o.updateQueue = null, bp(o, y)));
        break;
      case 30:
        break;
      case 21:
        break;
      default:
        Qi(l, o), Qn(o);
    }
  }
  function Qn(o) {
    var l = o.flags;
    if (l & 2) {
      try {
        for (var p, y = o.return; y !== null; ) {
          if (Wx(y)) {
            p = y;
            break;
          }
          y = y.return;
        }
        if (p == null) throw Error(r(160));
        switch (p.tag) {
          case 27:
            var E = p.stateNode, A = Hg(o);
            vp(o, A, E);
            break;
          case 5:
            var B = p.stateNode;
            p.flags & 32 && (Vi(B, ""), p.flags &= -33);
            var ne = Hg(o);
            vp(o, ne, B);
            break;
          case 3:
          case 4:
            var xe = p.stateNode.containerInfo, De = Hg(o);
            Vg(
              o,
              De,
              xe
            );
            break;
          default:
            throw Error(r(161));
        }
      } catch (Ue) {
        An(o, o.return, Ue);
      }
      o.flags &= -3;
    }
    l & 4096 && (o.flags &= -4097);
  }
  function tv(o) {
    if (o.subtreeFlags & 1024)
      for (o = o.child; o !== null; ) {
        var l = o;
        tv(l), l.tag === 5 && l.flags & 1024 && l.stateNode.reset(), o = o.sibling;
      }
  }
  function Io(o, l) {
    if (l.subtreeFlags & 8772)
      for (l = l.child; l !== null; )
        Kg(o, l.alternate, l), l = l.sibling;
  }
  function zu(o) {
    for (o = o.child; o !== null; ) {
      var l = o;
      switch (l.tag) {
        case 0:
        case 11:
        case 14:
        case 15:
          Do(4, l, l.return), zu(l);
          break;
        case 1:
          ji(l, l.return);
          var p = l.stateNode;
          typeof p.componentWillUnmount == "function" && Ug(
            l,
            l.return,
            p
          ), zu(l);
          break;
        case 27:
          Uf(l.stateNode);
        case 26:
        case 5:
          ji(l, l.return), zu(l);
          break;
        case 22:
          l.memoizedState === null && zu(l);
          break;
        case 30:
          zu(l);
          break;
        default:
          zu(l);
      }
      o = o.sibling;
    }
  }
  function no(o, l, p) {
    for (p = p && (l.subtreeFlags & 8772) !== 0, l = l.child; l !== null; ) {
      var y = l.alternate, E = o, A = l, B = A.flags;
      switch (A.tag) {
        case 0:
        case 11:
        case 15:
          no(
            E,
            A,
            p
          ), Gc(4, A);
          break;
        case 1:
          if (no(
            E,
            A,
            p
          ), y = A, E = y.stateNode, typeof E.componentDidMount == "function")
            try {
              E.componentDidMount();
            } catch (De) {
              An(y, y.return, De);
            }
          if (y = A, E = y.updateQueue, E !== null) {
            var ne = y.stateNode;
            try {
              var xe = E.shared.hiddenCallbacks;
              if (xe !== null)
                for (E.shared.hiddenCallbacks = null, E = 0; E < xe.length; E++)
                  ka(xe[E], ne);
            } catch (De) {
              An(y, y.return, De);
            }
          }
          p && B & 64 && Cf(A), Zi(A, A.return);
          break;
        case 27:
          Zx(A);
        case 26:
        case 5:
          no(
            E,
            A,
            p
          ), p && y === null && B & 4 && Yx(A), Zi(A, A.return);
          break;
        case 12:
          no(
            E,
            A,
            p
          );
          break;
        case 31:
          no(
            E,
            A,
            p
          ), p && B & 4 && Wg(E, A);
          break;
        case 13:
          no(
            E,
            A,
            p
          ), p && B & 4 && Jx(E, A);
          break;
        case 22:
          A.memoizedState === null && no(
            E,
            A,
            p
          ), Zi(A, A.return);
          break;
        case 30:
          break;
        default:
          no(
            E,
            A,
            p
          );
      }
      l = l.sibling;
    }
  }
  function Zg(o, l) {
    var p = null;
    o !== null && o.memoizedState !== null && o.memoizedState.cachePool !== null && (p = o.memoizedState.cachePool.pool), o = null, l.memoizedState !== null && l.memoizedState.cachePool !== null && (o = l.memoizedState.cachePool.pool), o !== p && (o != null && o.refCount++, p != null && Xd(p));
  }
  function Xg(o, l) {
    o = null, l.alternate !== null && (o = l.alternate.memoizedState.cache), l = l.memoizedState.cache, l !== o && (l.refCount++, o != null && Xd(o));
  }
  function Ra(o, l, p, y) {
    if (l.subtreeFlags & 10256)
      for (l = l.child; l !== null; )
        nv(
          o,
          l,
          p,
          y
        ), l = l.sibling;
  }
  function nv(o, l, p, y) {
    var E = l.flags;
    switch (l.tag) {
      case 0:
      case 11:
      case 15:
        Ra(
          o,
          l,
          p,
          y
        ), E & 2048 && Gc(9, l);
        break;
      case 1:
        Ra(
          o,
          l,
          p,
          y
        );
        break;
      case 3:
        Ra(
          o,
          l,
          p,
          y
        ), E & 2048 && (o = null, l.alternate !== null && (o = l.alternate.memoizedState.cache), l = l.memoizedState.cache, l !== o && (l.refCount++, o != null && Xd(o)));
        break;
      case 12:
        if (E & 2048) {
          Ra(
            o,
            l,
            p,
            y
          ), o = l.stateNode;
          try {
            var A = l.memoizedProps, B = A.id, ne = A.onPostCommit;
            typeof ne == "function" && ne(
              B,
              l.alternate === null ? "mount" : "update",
              o.passiveEffectDuration,
              -0
            );
          } catch (xe) {
            An(l, l.return, xe);
          }
        } else
          Ra(
            o,
            l,
            p,
            y
          );
        break;
      case 31:
        Ra(
          o,
          l,
          p,
          y
        );
        break;
      case 13:
        Ra(
          o,
          l,
          p,
          y
        );
        break;
      case 23:
        break;
      case 22:
        A = l.stateNode, B = l.alternate, l.memoizedState !== null ? A._visibility & 2 ? Ra(
          o,
          l,
          p,
          y
        ) : kf(o, l) : A._visibility & 2 ? Ra(
          o,
          l,
          p,
          y
        ) : (A._visibility |= 2, Ml(
          o,
          l,
          p,
          y,
          (l.subtreeFlags & 10256) !== 0 || !1
        )), E & 2048 && Zg(B, l);
        break;
      case 24:
        Ra(
          o,
          l,
          p,
          y
        ), E & 2048 && Xg(l.alternate, l);
        break;
      default:
        Ra(
          o,
          l,
          p,
          y
        );
    }
  }
  function Ml(o, l, p, y, E) {
    for (E = E && ((l.subtreeFlags & 10256) !== 0 || !1), l = l.child; l !== null; ) {
      var A = o, B = l, ne = p, xe = y, De = B.flags;
      switch (B.tag) {
        case 0:
        case 11:
        case 15:
          Ml(
            A,
            B,
            ne,
            xe,
            E
          ), Gc(8, B);
          break;
        case 23:
          break;
        case 22:
          var Ue = B.stateNode;
          B.memoizedState !== null ? Ue._visibility & 2 ? Ml(
            A,
            B,
            ne,
            xe,
            E
          ) : kf(
            A,
            B
          ) : (Ue._visibility |= 2, Ml(
            A,
            B,
            ne,
            xe,
            E
          )), E && De & 2048 && Zg(
            B.alternate,
            B
          );
          break;
        case 24:
          Ml(
            A,
            B,
            ne,
            xe,
            E
          ), E && De & 2048 && Xg(B.alternate, B);
          break;
        default:
          Ml(
            A,
            B,
            ne,
            xe,
            E
          );
      }
      l = l.sibling;
    }
  }
  function kf(o, l) {
    if (l.subtreeFlags & 10256)
      for (l = l.child; l !== null; ) {
        var p = o, y = l, E = y.flags;
        switch (y.tag) {
          case 22:
            kf(p, y), E & 2048 && Zg(
              y.alternate,
              y
            );
            break;
          case 24:
            kf(p, y), E & 2048 && Xg(y.alternate, y);
            break;
          default:
            kf(p, y);
        }
        l = l.sibling;
      }
  }
  var Tf = 8192;
  function Kc(o, l, p) {
    if (o.subtreeFlags & Tf)
      for (o = o.child; o !== null; )
        rv(
          o,
          l,
          p
        ), o = o.sibling;
  }
  function rv(o, l, p) {
    switch (o.tag) {
      case 26:
        Kc(
          o,
          l,
          p
        ), o.flags & Tf && o.memoizedState !== null && sd(
          p,
          Na,
          o.memoizedState,
          o.memoizedProps
        );
        break;
      case 5:
        Kc(
          o,
          l,
          p
        );
        break;
      case 3:
      case 4:
        var y = Na;
        Na = Dp(o.stateNode.containerInfo), Kc(
          o,
          l,
          p
        ), Na = y;
        break;
      case 22:
        o.memoizedState === null && (y = o.alternate, y !== null && y.memoizedState !== null ? (y = Tf, Tf = 16777216, Kc(
          o,
          l,
          p
        ), Tf = y) : Kc(
          o,
          l,
          p
        ));
        break;
      default:
        Kc(
          o,
          l,
          p
        );
    }
  }
  function iv(o) {
    var l = o.alternate;
    if (l !== null && (o = l.child, o !== null)) {
      l.child = null;
      do
        l = o.sibling, o.sibling = null, o = l;
      while (o !== null);
    }
  }
  function jf(o) {
    var l = o.deletions;
    if ((o.flags & 16) !== 0) {
      if (l !== null)
        for (var p = 0; p < l.length; p++) {
          var y = l[p];
          Zr = y, av(
            y,
            o
          );
        }
      iv(o);
    }
    if (o.subtreeFlags & 10256)
      for (o = o.child; o !== null; )
        sv(o), o = o.sibling;
  }
  function sv(o) {
    switch (o.tag) {
      case 0:
      case 11:
      case 15:
        jf(o), o.flags & 2048 && Do(9, o, o.return);
        break;
      case 3:
        jf(o);
        break;
      case 12:
        jf(o);
        break;
      case 22:
        var l = o.stateNode;
        o.memoizedState !== null && l._visibility & 2 && (o.return === null || o.return.tag !== 13) ? (l._visibility &= -3, wp(o)) : jf(o);
        break;
      default:
        jf(o);
    }
  }
  function wp(o) {
    var l = o.deletions;
    if ((o.flags & 16) !== 0) {
      if (l !== null)
        for (var p = 0; p < l.length; p++) {
          var y = l[p];
          Zr = y, av(
            y,
            o
          );
        }
      iv(o);
    }
    for (o = o.child; o !== null; ) {
      switch (l = o, l.tag) {
        case 0:
        case 11:
        case 15:
          Do(8, l, l.return), wp(l);
          break;
        case 22:
          p = l.stateNode, p._visibility & 2 && (p._visibility &= -3, wp(l));
          break;
        default:
          wp(l);
      }
      o = o.sibling;
    }
  }
  function av(o, l) {
    for (; Zr !== null; ) {
      var p = Zr;
      switch (p.tag) {
        case 0:
        case 11:
        case 15:
          Do(8, p, l);
          break;
        case 23:
        case 22:
          if (p.memoizedState !== null && p.memoizedState.cachePool !== null) {
            var y = p.memoizedState.cachePool.pool;
            y != null && y.refCount++;
          }
          break;
        case 24:
          Xd(p.memoizedState.cache);
      }
      if (y = p.child, y !== null) y.return = p, Zr = y;
      else
        e: for (p = o; Zr !== null; ) {
          y = Zr;
          var E = y.sibling, A = y.return;
          if (Yg(y), y === p) {
            Zr = null;
            break e;
          }
          if (E !== null) {
            E.return = A, Zr = E;
            break e;
          }
          Zr = A;
        }
    }
  }
  var t2 = {
    getCacheForType: function(o) {
      var l = di(zr), p = l.data.get(o);
      return p === void 0 && (p = o(), l.data.set(o, p)), p;
    },
    cacheSignal: function() {
      return di(zr).controller.signal;
    }
  }, n2 = typeof WeakMap == "function" ? WeakMap : Map, Sn = 0, $n = null, en = null, sn = 0, jn = 0, Es = null, Ol = !1, Yc = !1, Qg = !1, Ma = 0, cr = 0, Dl = 0, Pu = 0, Jg = 0, Cs = 0, Wc = 0, Af = null, Ji = null, e0 = !1, Nf = 0, ov = 0, Iu = 1 / 0, _p = null, zl = null, Fr = 0, Pl = null, Zc = null, Lo = 0, t0 = 0, n0 = null, lv = null, Rf = 0, r0 = null;
  function ks() {
    return (Sn & 2) !== 0 && sn !== 0 ? sn & -sn : X.T !== null ? Ts() : ho();
  }
  function uv() {
    if (Cs === 0)
      if ((sn & 536870912) === 0 || un) {
        var o = $r;
        $r <<= 1, ($r & 3932160) === 0 && ($r = 262144), Cs = o;
      } else Cs = 536870912;
    return o = bs.current, o !== null && (o.flags |= 32), Cs;
  }
  function es(o, l, p) {
    (o === $n && (jn === 2 || jn === 9) || o.cancelPendingCommit !== null) && (Xc(o, 0), Bo(
      o,
      sn,
      Cs,
      !1
    )), Ui(o, p), ((Sn & 2) === 0 || o !== $n) && (o === $n && ((Sn & 2) === 0 && (Pu |= p), cr === 4 && Bo(
      o,
      sn,
      Cs,
      !1
    )), ro(o));
  }
  function cv(o, l, p) {
    if ((Sn & 6) !== 0) throw Error(r(327));
    var y = !p && (l & 127) === 0 && (l & o.expiredLanes) === 0 || tr(o, l), E = y ? i2(o, l) : s0(o, l, !0), A = y;
    do {
      if (E === 0) {
        Yc && !y && Bo(o, l, 0, !1);
        break;
      } else {
        if (p = o.current.alternate, A && !fv(p)) {
          E = s0(o, l, !1), A = !1;
          continue;
        }
        if (E === 2) {
          if (A = l, o.errorRecoveryDisabledLanes & A)
            var B = 0;
          else
            B = o.pendingLanes & -536870913, B = B !== 0 ? B : B & 536870912 ? 536870912 : 0;
          if (B !== 0) {
            l = B;
            e: {
              var ne = o;
              E = Af;
              var xe = ne.current.memoizedState.isDehydrated;
              if (xe && (Xc(ne, B).flags |= 256), B = s0(
                ne,
                B,
                !1
              ), B !== 2) {
                if (Qg && !xe) {
                  ne.errorRecoveryDisabledLanes |= A, Pu |= A, E = 4;
                  break e;
                }
                A = Ji, Ji = E, A !== null && (Ji === null ? Ji = A : Ji.push.apply(
                  Ji,
                  A
                ));
              }
              E = B;
            }
            if (A = !1, E !== 2) continue;
          }
        }
        if (E === 1) {
          Xc(o, 0), Bo(o, l, 0, !0);
          break;
        }
        e: {
          switch (y = o, A = E, A) {
            case 0:
            case 1:
              throw Error(r(345));
            case 4:
              if ((l & 4194048) !== l) break;
            case 6:
              Bo(
                y,
                l,
                Cs,
                !Ol
              );
              break e;
            case 2:
              Ji = null;
              break;
            case 3:
            case 5:
              break;
            default:
              throw Error(r(329));
          }
          if ((l & 62914560) === l && (E = Nf + 300 - kn(), 10 < E)) {
            if (Bo(
              y,
              l,
              Cs,
              !Ol
            ), At(y, 0, !0) !== 0) break e;
            Lo = l, y.timeoutHandle = Av(
              dv.bind(
                null,
                y,
                p,
                Ji,
                _p,
                e0,
                l,
                Cs,
                Pu,
                Wc,
                Ol,
                A,
                "Throttled",
                -0,
                0
              ),
              E
            );
            break e;
          }
          dv(
            y,
            p,
            Ji,
            _p,
            e0,
            l,
            Cs,
            Pu,
            Wc,
            Ol,
            A,
            null,
            -0,
            0
          );
        }
      }
      break;
    } while (!0);
    ro(o);
  }
  function dv(o, l, p, y, E, A, B, ne, xe, De, Ue, Ke, Pe, Be) {
    if (o.timeoutHandle = -1, Ke = l.subtreeFlags, Ke & 8192 || (Ke & 16785408) === 16785408) {
      Ke = {
        stylesheets: null,
        count: 0,
        imgCount: 0,
        imgBytes: 0,
        suspenseyImages: [],
        waitingForImages: !0,
        waitingForViewTransition: !1,
        unsuspend: Gi
      }, rv(
        l,
        A,
        Ke
      );
      var _t = (A & 62914560) === A ? Nf - kn() : (A & 4194048) === A ? ov - kn() : 0;
      if (_t = E2(
        Ke,
        _t
      ), _t !== null) {
        Lo = A, o.cancelPendingCommit = _t(
          xv.bind(
            null,
            o,
            l,
            A,
            p,
            y,
            E,
            B,
            ne,
            xe,
            Ue,
            Ke,
            null,
            Pe,
            Be
          )
        ), Bo(o, A, B, !De);
        return;
      }
    }
    xv(
      o,
      l,
      A,
      p,
      y,
      E,
      B,
      ne,
      xe
    );
  }
  function fv(o) {
    for (var l = o; ; ) {
      var p = l.tag;
      if ((p === 0 || p === 11 || p === 15) && l.flags & 16384 && (p = l.updateQueue, p !== null && (p = p.stores, p !== null)))
        for (var y = 0; y < p.length; y++) {
          var E = p[y], A = E.getSnapshot;
          E = E.value;
          try {
            if (!Vn(A(), E)) return !1;
          } catch {
            return !1;
          }
        }
      if (p = l.child, l.subtreeFlags & 16384 && p !== null)
        p.return = l, l = p;
      else {
        if (l === o) break;
        for (; l.sibling === null; ) {
          if (l.return === null || l.return === o) return !0;
          l = l.return;
        }
        l.sibling.return = l.return, l = l.sibling;
      }
    }
    return !0;
  }
  function Bo(o, l, p, y) {
    l &= ~Jg, l &= ~Pu, o.suspendedLanes |= l, o.pingedLanes &= ~l, y && (o.warmLanes |= l), y = o.expirationTimes;
    for (var E = l; 0 < E; ) {
      var A = 31 - nt(E), B = 1 << A;
      y[A] = -1, E &= ~B;
    }
    p !== 0 && ya(o, p, l);
  }
  function Sp() {
    return (Sn & 6) === 0 ? (Pf(0), !1) : !0;
  }
  function i0() {
    if (en !== null) {
      if (jn === 0)
        var o = en.return;
      else
        o = en, jo = Gt = null, hg(o), Oc = null, vs = 0, o = en;
      for (; o !== null; )
        yp(o.alternate, o), o = o.return;
      en = null;
    }
  }
  function Xc(o, l) {
    var p = o.timeoutHandle;
    p !== -1 && (o.timeoutHandle = -1, h2(p)), p = o.cancelPendingCommit, p !== null && (o.cancelPendingCommit = null, p()), Lo = 0, i0(), $n = o, en = p = Zs(o.current, null), sn = l, jn = 0, Es = null, Ol = !1, Yc = tr(o, l), Qg = !1, Wc = Cs = Jg = Pu = Dl = cr = 0, Ji = Af = null, e0 = !1, (l & 8) !== 0 && (l |= l & 32);
    var y = o.entangledLanes;
    if (y !== 0)
      for (o = o.entanglements, y &= l; 0 < y; ) {
        var E = 31 - nt(y), A = 1 << E;
        l |= o[E], y &= ~A;
      }
    return Ma = l, Zn(), p;
  }
  function hv(o, l) {
    Kt = null, X.H = Nl, l === Mc || l === Jd ? (l = kx(), jn = 3) : l === Hh ? (l = kx(), jn = 4) : jn = l === gf ? 8 : l !== null && typeof l == "object" && typeof l.then == "function" ? 6 : 1, Es = l, en === null && (cr = 1, mf(
      o,
      ys(l, o.current)
    ));
  }
  function Mf() {
    var o = bs.current;
    return o === null ? !0 : (sn & 4194048) === sn ? ia === null : (sn & 62914560) === sn || (sn & 536870912) !== 0 ? o === ia : !1;
  }
  function pv() {
    var o = X.H;
    return X.H = Nl, o === null ? Nl : o;
  }
  function mv() {
    var o = X.A;
    return X.A = t2, o;
  }
  function Ep() {
    cr = 4, Ol || (sn & 4194048) !== sn && bs.current !== null || (Yc = !0), (Dl & 134217727) === 0 && (Pu & 134217727) === 0 || $n === null || Bo(
      $n,
      sn,
      Cs,
      !1
    );
  }
  function s0(o, l, p) {
    var y = Sn;
    Sn |= 2;
    var E = pv(), A = mv();
    ($n !== o || sn !== l) && (_p = null, Xc(o, l)), l = !1;
    var B = cr;
    e: do
      try {
        if (jn !== 0 && en !== null) {
          var ne = en, xe = Es;
          switch (jn) {
            case 8:
              i0(), B = 6;
              break e;
            case 3:
            case 2:
            case 9:
            case 6:
              bs.current === null && (l = !0);
              var De = jn;
              if (jn = 0, Es = null, Qc(o, ne, xe, De), p && Yc) {
                B = 0;
                break e;
              }
              break;
            default:
              De = jn, jn = 0, Es = null, Qc(o, ne, xe, De);
          }
        }
        r2(), B = cr;
        break;
      } catch (Ue) {
        hv(o, Ue);
      }
    while (!0);
    return l && o.shellSuspendCounter++, jo = Gt = null, Sn = y, X.H = E, X.A = A, en === null && ($n = null, sn = 0, Zn()), B;
  }
  function r2() {
    for (; en !== null; ) gv(en);
  }
  function i2(o, l) {
    var p = Sn;
    Sn |= 2;
    var y = pv(), E = mv();
    $n !== o || sn !== l ? (_p = null, Iu = kn() + 500, Xc(o, l)) : Yc = tr(
      o,
      l
    );
    e: do
      try {
        if (jn !== 0 && en !== null) {
          l = en;
          var A = Es;
          t: switch (jn) {
            case 1:
              jn = 0, Es = null, Qc(o, l, A, 1);
              break;
            case 2:
            case 9:
              if (Cx(A)) {
                jn = 0, Es = null, yv(l);
                break;
              }
              l = function() {
                jn !== 2 && jn !== 9 || $n !== o || (jn = 7), ro(o);
              }, A.then(l, l);
              break e;
            case 3:
              jn = 7;
              break e;
            case 4:
              jn = 5;
              break e;
            case 7:
              Cx(A) ? (jn = 0, Es = null, yv(l)) : (jn = 0, Es = null, Qc(o, l, A, 7));
              break;
            case 5:
              var B = null;
              switch (en.tag) {
                case 26:
                  B = en.memoizedState;
                case 5:
                case 27:
                  var ne = en;
                  if (B ? Uv(B) : ne.stateNode.complete) {
                    jn = 0, Es = null;
                    var xe = ne.sibling;
                    if (xe !== null) en = xe;
                    else {
                      var De = ne.return;
                      De !== null ? (en = De, Cp(De)) : en = null;
                    }
                    break t;
                  }
              }
              jn = 0, Es = null, Qc(o, l, A, 5);
              break;
            case 6:
              jn = 0, Es = null, Qc(o, l, A, 6);
              break;
            case 8:
              i0(), cr = 6;
              break e;
            default:
              throw Error(r(462));
          }
        }
        s2();
        break;
      } catch (Ue) {
        hv(o, Ue);
      }
    while (!0);
    return jo = Gt = null, X.H = y, X.A = E, Sn = p, en !== null ? 0 : ($n = null, sn = 0, Zn(), cr);
  }
  function s2() {
    for (; en !== null && !zn(); )
      gv(en);
  }
  function gv(o) {
    var l = Gx(o.alternate, o, Ma);
    o.memoizedProps = o.pendingProps, l === null ? Cp(o) : en = l;
  }
  function yv(o) {
    var l = o, p = l.alternate;
    switch (l.tag) {
      case 15:
      case 0:
        l = Ux(
          p,
          l,
          l.pendingProps,
          l.type,
          void 0,
          sn
        );
        break;
      case 11:
        l = Ux(
          p,
          l,
          l.pendingProps,
          l.type.render,
          l.ref,
          sn
        );
        break;
      case 5:
        hg(l);
      default:
        yp(p, l), l = en = bx(l, Ma), l = Gx(p, l, Ma);
    }
    o.memoizedProps = o.pendingProps, l === null ? Cp(o) : en = l;
  }
  function Qc(o, l, p, y) {
    jo = Gt = null, hg(l), Oc = null, vs = 0;
    var E = l.return;
    try {
      if (Pg(
        o,
        E,
        l,
        p,
        sn
      )) {
        cr = 1, mf(
          o,
          ys(p, o.current)
        ), en = null;
        return;
      }
    } catch (A) {
      if (E !== null) throw en = E, A;
      cr = 1, mf(
        o,
        ys(p, o.current)
      ), en = null;
      return;
    }
    l.flags & 32768 ? (un || y === 1 ? o = !0 : Yc || (sn & 536870912) !== 0 ? o = !1 : (Ol = o = !0, (y === 2 || y === 9 || y === 3 || y === 6) && (y = bs.current, y !== null && y.tag === 13 && (y.flags |= 16384))), Of(l, o)) : Cp(l);
  }
  function Cp(o) {
    var l = o;
    do {
      if ((l.flags & 32768) !== 0) {
        Of(
          l,
          Ol
        );
        return;
      }
      o = l.return;
      var p = Kx(
        l.alternate,
        l,
        Ma
      );
      if (p !== null) {
        en = p;
        return;
      }
      if (l = l.sibling, l !== null) {
        en = l;
        return;
      }
      en = l = o;
    } while (l !== null);
    cr === 0 && (cr = 5);
  }
  function Of(o, l) {
    do {
      var p = Ef(o.alternate, o);
      if (p !== null) {
        p.flags &= 32767, en = p;
        return;
      }
      if (p = o.return, p !== null && (p.flags |= 32768, p.subtreeFlags = 0, p.deletions = null), !l && (o = o.sibling, o !== null)) {
        en = o;
        return;
      }
      en = o = p;
    } while (o !== null);
    cr = 6, en = null;
  }
  function xv(o, l, p, y, E, A, B, ne, xe) {
    o.cancelPendingCommit = null;
    do
      Df();
    while (Fr !== 0);
    if ((Sn & 6) !== 0) throw Error(r(327));
    if (l !== null) {
      if (l === o.current) throw Error(r(177));
      if (A = l.lanes | l.childLanes, A |= qt, du(
        o,
        p,
        A,
        B,
        ne,
        xe
      ), o === $n && (en = $n = null, sn = 0), Zc = l, Pl = o, Lo = p, t0 = A, n0 = E, lv = y, (l.subtreeFlags & 10256) !== 0 || (l.flags & 10256) !== 0 ? (o.callbackNode = null, o.callbackPriority = 0, l2(bt, function() {
        return u0(), null;
      })) : (o.callbackNode = null, o.callbackPriority = 0), y = (l.flags & 13878) !== 0, (l.subtreeFlags & 13878) !== 0 || y) {
        y = X.T, X.T = null, E = ce.p, ce.p = 2, B = Sn, Sn |= 4;
        try {
          Jw(o, l, p);
        } finally {
          Sn = B, ce.p = E, X.T = y;
        }
      }
      Fr = 1, a0(), o0(), kp();
    }
  }
  function a0() {
    if (Fr === 1) {
      Fr = 0;
      var o = Pl, l = Zc, p = (l.flags & 13878) !== 0;
      if ((l.subtreeFlags & 13878) !== 0 || p) {
        p = X.T, X.T = null;
        var y = ce.p;
        ce.p = 2;
        var E = Sn;
        Sn |= 4;
        try {
          ev(l, o);
          var A = b0, B = F(o.containerInfo), ne = A.focusedElem, xe = A.selectionRange;
          if (B !== ne && ne && ne.ownerDocument && L(
            ne.ownerDocument.documentElement,
            ne
          )) {
            if (xe !== null && W(ne)) {
              var De = xe.start, Ue = xe.end;
              if (Ue === void 0 && (Ue = De), "selectionStart" in ne)
                ne.selectionStart = De, ne.selectionEnd = Math.min(
                  Ue,
                  ne.value.length
                );
              else {
                var Ke = ne.ownerDocument || document, Pe = Ke && Ke.defaultView || window;
                if (Pe.getSelection) {
                  var Be = Pe.getSelection(), _t = ne.textContent.length, Mt = Math.min(xe.start, _t), Dn = xe.end === void 0 ? Mt : Math.min(xe.end, _t);
                  !Be.extend && Mt > Dn && (B = Dn, Dn = Mt, Mt = B);
                  var je = O(
                    ne,
                    Mt
                  ), Ce = O(
                    ne,
                    Dn
                  );
                  if (je && Ce && (Be.rangeCount !== 1 || Be.anchorNode !== je.node || Be.anchorOffset !== je.offset || Be.focusNode !== Ce.node || Be.focusOffset !== Ce.offset)) {
                    var Oe = Ke.createRange();
                    Oe.setStart(je.node, je.offset), Be.removeAllRanges(), Mt > Dn ? (Be.addRange(Oe), Be.extend(Ce.node, Ce.offset)) : (Oe.setEnd(Ce.node, Ce.offset), Be.addRange(Oe));
                  }
                }
              }
            }
            for (Ke = [], Be = ne; Be = Be.parentNode; )
              Be.nodeType === 1 && Ke.push({
                element: Be,
                left: Be.scrollLeft,
                top: Be.scrollTop
              });
            for (typeof ne.focus == "function" && ne.focus(), ne = 0; ne < Ke.length; ne++) {
              var Ge = Ke[ne];
              Ge.element.scrollLeft = Ge.left, Ge.element.scrollTop = Ge.top;
            }
          }
          $p = !!$f, b0 = $f = null;
        } finally {
          Sn = E, ce.p = y, X.T = p;
        }
      }
      o.current = l, Fr = 2;
    }
  }
  function o0() {
    if (Fr === 2) {
      Fr = 0;
      var o = Pl, l = Zc, p = (l.flags & 8772) !== 0;
      if ((l.subtreeFlags & 8772) !== 0 || p) {
        p = X.T, X.T = null;
        var y = ce.p;
        ce.p = 2;
        var E = Sn;
        Sn |= 4;
        try {
          Kg(o, l.alternate, l);
        } finally {
          Sn = E, ce.p = y, X.T = p;
        }
      }
      Fr = 3;
    }
  }
  function kp() {
    if (Fr === 4 || Fr === 3) {
      Fr = 0, nn();
      var o = Pl, l = Zc, p = Lo, y = lv;
      (l.subtreeFlags & 10256) !== 0 || (l.flags & 10256) !== 0 ? Fr = 5 : (Fr = 0, Zc = Pl = null, l0(o, o.pendingLanes));
      var E = o.pendingLanes;
      if (E === 0 && (zl = null), Fa(p), l = l.stateNode, Jt && typeof Jt.onCommitFiberRoot == "function")
        try {
          Jt.onCommitFiberRoot(
            on,
            l,
            void 0,
            (l.current.flags & 128) === 128
          );
        } catch {
        }
      if (y !== null) {
        l = X.T, E = ce.p, ce.p = 2, X.T = null;
        try {
          for (var A = o.onRecoverableError, B = 0; B < y.length; B++) {
            var ne = y[B];
            A(ne.value, {
              componentStack: ne.stack
            });
          }
        } finally {
          X.T = l, ce.p = E;
        }
      }
      (Lo & 3) !== 0 && Df(), ro(o), E = o.pendingLanes, (p & 261930) !== 0 && (E & 42) !== 0 ? o === r0 ? Rf++ : (Rf = 0, r0 = o) : Rf = 0, Pf(0);
    }
  }
  function l0(o, l) {
    (o.pooledCacheLanes &= l) === 0 && (l = o.pooledCache, l != null && (o.pooledCache = null, Xd(l)));
  }
  function Df() {
    return a0(), o0(), kp(), u0();
  }
  function u0() {
    if (Fr !== 5) return !1;
    var o = Pl, l = t0;
    t0 = 0;
    var p = Fa(Lo), y = X.T, E = ce.p;
    try {
      ce.p = 32 > p ? 32 : p, X.T = null, p = n0, n0 = null;
      var A = Pl, B = Lo;
      if (Fr = 0, Zc = Pl = null, Lo = 0, (Sn & 6) !== 0) throw Error(r(331));
      var ne = Sn;
      if (Sn |= 4, sv(A.current), nv(
        A,
        A.current,
        B,
        p
      ), Sn = ne, Pf(0, !1), Jt && typeof Jt.onPostCommitFiberRoot == "function")
        try {
          Jt.onPostCommitFiberRoot(on, A);
        } catch {
        }
      return !0;
    } finally {
      ce.p = E, X.T = y, l0(o, l);
    }
  }
  function c0(o, l, p) {
    l = ys(p, l), l = zg(o.stateNode, l, 2), o = Ca(o, l, 2), o !== null && (Ui(o, 2), ro(o));
  }
  function An(o, l, p) {
    if (o.tag === 3)
      c0(o, o, p);
    else
      for (; l !== null; ) {
        if (l.tag === 3) {
          c0(
            l,
            o,
            p
          );
          break;
        } else if (l.tag === 1) {
          var y = l.stateNode;
          if (typeof l.type.getDerivedStateFromError == "function" || typeof y.componentDidCatch == "function" && (zl === null || !zl.has(y))) {
            o = ys(p, o), p = eo(2), y = Ca(l, p, 2), y !== null && (cp(
              p,
              y,
              l,
              o
            ), Ui(y, 2), ro(y));
            break;
          }
        }
        l = l.return;
      }
  }
  function d0(o, l, p) {
    var y = o.pingCache;
    if (y === null) {
      y = o.pingCache = new n2();
      var E = /* @__PURE__ */ new Set();
      y.set(l, E);
    } else
      E = y.get(l), E === void 0 && (E = /* @__PURE__ */ new Set(), y.set(l, E));
    E.has(p) || (Qg = !0, E.add(p), o = a2.bind(null, o, l, p), l.then(o, o));
  }
  function a2(o, l, p) {
    var y = o.pingCache;
    y !== null && y.delete(l), o.pingedLanes |= o.suspendedLanes & p, o.warmLanes &= ~p, $n === o && (sn & p) === p && (cr === 4 || cr === 3 && (sn & 62914560) === sn && 300 > kn() - Nf ? (Sn & 2) === 0 && Xc(o, 0) : Jg |= p, Wc === sn && (Wc = 0)), ro(o);
  }
  function zf(o, l) {
    l === 0 && (l = cu()), o = Ln(o, l), o !== null && (Ui(o, l), ro(o));
  }
  function Tp(o) {
    var l = o.memoizedState, p = 0;
    l !== null && (p = l.retryLane), zf(o, p);
  }
  function o2(o, l) {
    var p = 0;
    switch (o.tag) {
      case 31:
      case 13:
        var y = o.stateNode, E = o.memoizedState;
        E !== null && (p = E.retryLane);
        break;
      case 19:
        y = o.stateNode;
        break;
      case 22:
        y = o.stateNode._retryCache;
        break;
      default:
        throw Error(r(314));
    }
    y !== null && y.delete(l), zf(o, p);
  }
  function l2(o, l) {
    return pn(o, l);
  }
  var Jc = null, Lu = null, f0 = !1, jp = !1, h0 = !1, Il = 0;
  function ro(o) {
    o !== Lu && o.next === null && (Lu === null ? Jc = Lu = o : Lu = Lu.next = o), jp = !0, f0 || (f0 = !0, c2());
  }
  function Pf(o, l) {
    if (!h0 && jp) {
      h0 = !0;
      do
        for (var p = !1, y = Jc; y !== null; ) {
          if (o !== 0) {
            var E = y.pendingLanes;
            if (E === 0) var A = 0;
            else {
              var B = y.suspendedLanes, ne = y.pingedLanes;
              A = (1 << 31 - nt(42 | o) + 1) - 1, A &= E & ~(B & ~ne), A = A & 201326741 ? A & 201326741 | 1 : A ? A | 2 : 0;
            }
            A !== 0 && (p = !0, _v(y, A));
          } else
            A = sn, A = At(
              y,
              y === $n ? A : 0,
              y.cancelPendingCommit !== null || y.timeoutHandle !== -1
            ), (A & 3) === 0 || tr(y, A) || (p = !0, _v(y, A));
          y = y.next;
        }
      while (p);
      h0 = !1;
    }
  }
  function u2() {
    vv();
  }
  function vv() {
    jp = f0 = !1;
    var o = 0;
    Il !== 0 && f2() && (o = Il);
    for (var l = kn(), p = null, y = Jc; y !== null; ) {
      var E = y.next, A = bv(y, l);
      A === 0 ? (y.next = null, p === null ? Jc = E : p.next = E, E === null && (Lu = p)) : (p = y, (o !== 0 || (A & 3) !== 0) && (jp = !0)), y = E;
    }
    Fr !== 0 && Fr !== 5 || Pf(o), Il !== 0 && (Il = 0);
  }
  function bv(o, l) {
    for (var p = o.suspendedLanes, y = o.pingedLanes, E = o.expirationTimes, A = o.pendingLanes & -62914561; 0 < A; ) {
      var B = 31 - nt(A), ne = 1 << B, xe = E[B];
      xe === -1 ? ((ne & p) === 0 || (ne & y) !== 0) && (E[B] = Dd(ne, l)) : xe <= l && (o.expiredLanes |= ne), A &= ~ne;
    }
    if (l = $n, p = sn, p = At(
      o,
      o === l ? p : 0,
      o.cancelPendingCommit !== null || o.timeoutHandle !== -1
    ), y = o.callbackNode, p === 0 || o === l && (jn === 2 || jn === 9) || o.cancelPendingCommit !== null)
      return y !== null && y !== null && Ht(y), o.callbackNode = null, o.callbackPriority = 0;
    if ((p & 3) === 0 || tr(o, p)) {
      if (l = p & -p, l === o.callbackPriority) return l;
      switch (y !== null && Ht(y), Fa(p)) {
        case 2:
        case 8:
          p = Qe;
          break;
        case 32:
          p = bt;
          break;
        case 268435456:
          p = $t;
          break;
        default:
          p = bt;
      }
      return y = wv.bind(null, o), p = pn(p, y), o.callbackPriority = l, o.callbackNode = p, l;
    }
    return y !== null && y !== null && Ht(y), o.callbackPriority = 2, o.callbackNode = null, 2;
  }
  function wv(o, l) {
    if (Fr !== 0 && Fr !== 5)
      return o.callbackNode = null, o.callbackPriority = 0, null;
    var p = o.callbackNode;
    if (Df() && o.callbackNode !== p)
      return null;
    var y = sn;
    return y = At(
      o,
      o === $n ? y : 0,
      o.cancelPendingCommit !== null || o.timeoutHandle !== -1
    ), y === 0 ? null : (cv(o, y, l), bv(o, kn()), o.callbackNode != null && o.callbackNode === p ? wv.bind(null, o) : null);
  }
  function _v(o, l) {
    if (Df()) return null;
    cv(o, l, !0);
  }
  function c2() {
    Rv(function() {
      (Sn & 6) !== 0 ? pn(
        $e,
        u2
      ) : vv();
    });
  }
  function Ts() {
    if (Il === 0) {
      var o = Nc;
      o === 0 && (o = st, st <<= 1, (st & 261888) === 0 && (st = 256)), Il = o;
    }
    return Il;
  }
  function Sv(o) {
    return o == null || typeof o == "symbol" || typeof o == "boolean" ? null : typeof o == "function" ? o : Gs("" + o);
  }
  function Ev(o, l) {
    var p = l.ownerDocument.createElement("input");
    return p.name = l.name, p.value = l.value, o.id && p.setAttribute("form", o.id), l.parentNode.insertBefore(p, l), o = new FormData(o), p.parentNode.removeChild(p), o;
  }
  function Bu(o, l, p, y, E) {
    if (l === "submit" && p && p.stateNode === E) {
      var A = Sv(
        (E[ar] || null).action
      ), B = y.submitter;
      B && (l = (l = B[ar] || null) ? Sv(l.formAction) : B.getAttribute("formAction"), l !== null && (A = l, B = null));
      var ne = new pc(
        "action",
        "action",
        null,
        y,
        E
      );
      o.push({
        event: ne,
        listeners: [
          {
            instance: null,
            listener: function() {
              if (y.defaultPrevented) {
                if (Il !== 0) {
                  var xe = B ? Ev(E, B) : new FormData(E);
                  Al(
                    p,
                    {
                      pending: !0,
                      data: xe,
                      method: E.method,
                      action: A
                    },
                    null,
                    xe
                  );
                }
              } else
                typeof A == "function" && (ne.preventDefault(), xe = B ? Ev(E, B) : new FormData(E), Al(
                  p,
                  {
                    pending: !0,
                    data: xe,
                    method: E.method,
                    action: A
                  },
                  A,
                  xe
                ));
            },
            currentTarget: E
          }
        ]
      });
    }
  }
  for (var Ft = 0; Ft < ct.length; Ft++) {
    var p0 = ct[Ft], ts = p0.toLowerCase(), jr = p0[0].toUpperCase() + p0.slice(1);
    tt(
      ts,
      "on" + jr
    );
  }
  tt(Ae, "onAnimationEnd"), tt(ze, "onAnimationIteration"), tt(qe, "onAnimationStart"), tt("dblclick", "onDoubleClick"), tt("focusin", "onFocus"), tt("focusout", "onBlur"), tt(Ve, "onTransitionRun"), tt(rt, "onTransitionStart"), tt(ut, "onTransitionCancel"), tt(He, "onTransitionEnd"), fs("onMouseEnter", ["mouseout", "mouseover"]), fs("onMouseLeave", ["mouseout", "mouseover"]), fs("onPointerEnter", ["pointerout", "pointerover"]), fs("onPointerLeave", ["pointerout", "pointerover"]), Hi(
    "onChange",
    "change click focusin focusout input keydown keyup selectionchange".split(" ")
  ), Hi(
    "onSelect",
    "focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(
      " "
    )
  ), Hi("onBeforeInput", [
    "compositionend",
    "keypress",
    "textInput",
    "paste"
  ]), Hi(
    "onCompositionEnd",
    "compositionend focusout keydown keypress keyup mousedown".split(" ")
  ), Hi(
    "onCompositionStart",
    "compositionstart focusout keydown keypress keyup mousedown".split(" ")
  ), Hi(
    "onCompositionUpdate",
    "compositionupdate focusout keydown keypress keyup mousedown".split(" ")
  );
  var If = "abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(
    " "
  ), Ll = new Set(
    "beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(If)
  );
  function Cv(o, l) {
    l = (l & 4) !== 0;
    for (var p = 0; p < o.length; p++) {
      var y = o[p], E = y.event;
      y = y.listeners;
      e: {
        var A = void 0;
        if (l)
          for (var B = y.length - 1; 0 <= B; B--) {
            var ne = y[B], xe = ne.instance, De = ne.currentTarget;
            if (ne = ne.listener, xe !== A && E.isPropagationStopped())
              break e;
            A = ne, E.currentTarget = De;
            try {
              A(E);
            } catch (Ue) {
              vt(Ue);
            }
            E.currentTarget = null, A = xe;
          }
        else
          for (B = 0; B < y.length; B++) {
            if (ne = y[B], xe = ne.instance, De = ne.currentTarget, ne = ne.listener, xe !== A && E.isPropagationStopped())
              break e;
            A = ne, E.currentTarget = De;
            try {
              A(E);
            } catch (Ue) {
              vt(Ue);
            }
            E.currentTarget = null, A = xe;
          }
      }
    }
  }
  function tn(o, l) {
    var p = l[$s];
    p === void 0 && (p = l[$s] = /* @__PURE__ */ new Set());
    var y = o + "__bubble";
    p.has(y) || (Np(l, o, 2, !1), p.add(y));
  }
  function m0(o, l, p) {
    var y = 0;
    l && (y |= 4), Np(
      p,
      o,
      y,
      l
    );
  }
  var Ap = "_reactListening" + Math.random().toString(36).slice(2);
  function g0(o) {
    if (!o[Ap]) {
      o[Ap] = !0, xa.forEach(function(p) {
        p !== "selectionchange" && (Ll.has(p) || m0(p, !1, o), m0(p, !0, o));
      });
      var l = o.nodeType === 9 ? o : o.ownerDocument;
      l === null || l[Ap] || (l[Ap] = !0, m0("selectionchange", !1, l));
    }
  }
  function Np(o, l, p, y) {
    switch (Xv(l)) {
      case 2:
        var E = k2;
        break;
      case 8:
        E = T2;
        break;
      default:
        E = j0;
    }
    p = E.bind(
      null,
      l,
      p,
      o
    ), E = void 0, !Pd || l !== "touchstart" && l !== "touchmove" && l !== "wheel" || (E = !0), y ? E !== void 0 ? o.addEventListener(l, p, {
      capture: !0,
      passive: E
    }) : o.addEventListener(l, p, !0) : E !== void 0 ? o.addEventListener(l, p, {
      passive: E
    }) : o.addEventListener(l, p, !1);
  }
  function y0(o, l, p, y, E) {
    var A = y;
    if ((l & 1) === 0 && (l & 2) === 0 && y !== null)
      e: for (; ; ) {
        if (y === null) return;
        var B = y.tag;
        if (B === 3 || B === 4) {
          var ne = y.stateNode.containerInfo;
          if (ne === E) break;
          if (B === 4)
            for (B = y.return; B !== null; ) {
              var xe = B.tag;
              if ((xe === 3 || xe === 4) && B.stateNode.containerInfo === E)
                return;
              B = B.return;
            }
          for (; ne !== null; ) {
            if (B = Fs(ne), B === null) return;
            if (xe = B.tag, xe === 5 || xe === 6 || xe === 26 || xe === 27) {
              y = A = B;
              continue e;
            }
            ne = ne.parentNode;
          }
        }
        y = y.return;
      }
    ul(function() {
      var De = A, Ue = fc(p), Ke = [];
      e: {
        var Pe = ot.get(o);
        if (Pe !== void 0) {
          var Be = pc, _t = o;
          switch (o) {
            case "keypress":
              if (cl(p) === 0) break e;
            case "keydown":
            case "keyup":
              Be = ms;
              break;
            case "focusin":
              _t = "focus", Be = _o;
              break;
            case "focusout":
              _t = "blur", Be = _o;
              break;
            case "beforeblur":
            case "afterblur":
              Be = _o;
              break;
            case "click":
              if (p.button === 2) break e;
            case "auxclick":
            case "dblclick":
            case "mousedown":
            case "mousemove":
            case "mouseup":
            case "mouseout":
            case "mouseover":
            case "contextmenu":
              Be = dl;
              break;
            case "drag":
            case "dragend":
            case "dragenter":
            case "dragexit":
            case "dragleave":
            case "dragover":
            case "dragstart":
            case "drop":
              Be = Id;
              break;
            case "touchcancel":
            case "touchend":
            case "touchmove":
            case "touchstart":
              Be = Fd;
              break;
            case Ae:
            case ze:
            case qe:
              Be = Ld;
              break;
            case He:
              Be = Ud;
              break;
            case "scroll":
            case "scrollend":
              Be = mc;
              break;
            case "wheel":
              Be = Eo;
              break;
            case "copy":
            case "cut":
            case "paste":
              Be = Mr;
              break;
            case "gotpointercapture":
            case "lostpointercapture":
            case "pointercancel":
            case "pointerdown":
            case "pointermove":
            case "pointerout":
            case "pointerover":
            case "pointerup":
              Be = qd;
              break;
            case "toggle":
            case "beforetoggle":
              Be = Ih;
          }
          var Mt = (l & 4) !== 0, Dn = !Mt && (o === "scroll" || o === "scrollend"), je = Mt ? Pe !== null ? Pe + "Capture" : null : Pe;
          Mt = [];
          for (var Ce = De, Oe; Ce !== null; ) {
            var Ge = Ce;
            if (Oe = Ge.stateNode, Ge = Ge.tag, Ge !== 5 && Ge !== 26 && Ge !== 27 || Oe === null || je === null || (Ge = va(Ce, je), Ge != null && Mt.push(
              js(Ce, Ge, Oe)
            )), Dn) break;
            Ce = Ce.return;
          }
          0 < Mt.length && (Pe = new Be(
            Pe,
            _t,
            null,
            p,
            Ue
          ), Ke.push({ event: Pe, listeners: Mt }));
        }
      }
      if ((l & 7) === 0) {
        e: {
          if (Pe = o === "mouseover" || o === "pointerover", Be = o === "mouseout" || o === "pointerout", Pe && p !== Ks && (_t = p.relatedTarget || p.fromElement) && (Fs(_t) || _t[Yr]))
            break e;
          if ((Be || Pe) && (Pe = Ue.window === Ue ? Ue : (Pe = Ue.ownerDocument) ? Pe.defaultView || Pe.parentWindow : window, Be ? (_t = p.relatedTarget || p.toElement, Be = De, _t = _t ? Fs(_t) : null, _t !== null && (Dn = s(_t), Mt = _t.tag, _t !== Dn || Mt !== 5 && Mt !== 27 && Mt !== 6) && (_t = null)) : (Be = null, _t = De), Be !== _t)) {
            if (Mt = dl, Ge = "onMouseLeave", je = "onMouseEnter", Ce = "mouse", (o === "pointerout" || o === "pointerover") && (Mt = qd, Ge = "onPointerLeave", je = "onPointerEnter", Ce = "pointer"), Dn = Be == null ? Pe : wi(Be), Oe = _t == null ? Pe : wi(_t), Pe = new Mt(
              Ge,
              Ce + "leave",
              Be,
              p,
              Ue
            ), Pe.target = Dn, Pe.relatedTarget = Oe, Ge = null, Fs(Ue) === De && (Mt = new Mt(
              je,
              Ce + "enter",
              _t,
              p,
              Ue
            ), Mt.target = Oe, Mt.relatedTarget = Dn, Ge = Mt), Dn = Ge, Be && _t)
              t: {
                for (Mt = Rp, je = Be, Ce = _t, Oe = 0, Ge = je; Ge; Ge = Mt(Ge))
                  Oe++;
                Ge = 0;
                for (var kt = Ce; kt; kt = Mt(kt))
                  Ge++;
                for (; 0 < Oe - Ge; )
                  je = Mt(je), Oe--;
                for (; 0 < Ge - Oe; )
                  Ce = Mt(Ce), Ge--;
                for (; Oe--; ) {
                  if (je === Ce || Ce !== null && je === Ce.alternate) {
                    Mt = je;
                    break t;
                  }
                  je = Mt(je), Ce = Mt(Ce);
                }
                Mt = null;
              }
            else Mt = null;
            Be !== null && rr(
              Ke,
              Pe,
              Be,
              Mt,
              !1
            ), _t !== null && Dn !== null && rr(
              Ke,
              Dn,
              _t,
              Mt,
              !0
            );
          }
        }
        e: {
          if (Pe = De ? wi(De) : window, Be = Pe.nodeName && Pe.nodeName.toLowerCase(), Be === "select" || Be === "input" && Pe.type === "file")
            var bn = Eu;
          else if (_u(Pe))
            if (oi)
              bn = yl;
            else {
              bn = Co;
              var St = Cu;
            }
          else
            Be = Pe.nodeName, !Be || Be.toLowerCase() !== "input" || Pe.type !== "checkbox" && Pe.type !== "radio" ? De && dc(De.elementType) && (bn = Eu) : bn = Kd;
          if (bn && (bn = bn(o, De))) {
            wc(
              Ke,
              bn,
              p,
              Ue
            );
            break e;
          }
          St && St(o, Pe, De), o === "focusout" && De && Pe.type === "number" && De.memoizedProps.value != null && xo(Pe, "number", Pe.value);
        }
        switch (St = De ? wi(De) : window, o) {
          case "focusin":
            (_u(St) || St.contentEditable === "true") && (U = St, se = De, ie = null);
            break;
          case "focusout":
            ie = se = U = null;
            break;
          case "mousedown":
            me = !0;
            break;
          case "contextmenu":
          case "mouseup":
          case "dragend":
            me = !1, he(Ke, p, Ue);
            break;
          case "selectionchange":
            if (ue) break;
          case "keydown":
          case "keyup":
            he(Ke, p, Ue);
        }
        var Zt;
        if (hl)
          e: {
            switch (o) {
              case "compositionstart":
                var an = "onCompositionStart";
                break e;
              case "compositionend":
                an = "onCompositionEnd";
                break e;
              case "compositionupdate":
                an = "onCompositionUpdate";
                break e;
            }
            an = void 0;
          }
        else
          Wa ? wu(o, p) && (an = "onCompositionEnd") : o === "keydown" && p.keyCode === 229 && (an = "onCompositionStart");
        an && (bu && p.locale !== "ko" && (Wa || an !== "onCompositionStart" ? an === "onCompositionEnd" && Wa && (Zt = gn()) : (Ys = Ue, hc = "value" in Ys ? Ys.value : Ys.textContent, Wa = !0)), St = Lf(De, an), 0 < St.length && (an = new ai(
          an,
          o,
          null,
          p,
          Ue
        ), Ke.push({ event: an, listeners: St }), Zt ? an.data = Zt : (Zt = Bh(p), Zt !== null && (an.data = Zt)))), (Zt = Hd ? Ci(o, p) : Vd(o, p)) && (an = Lf(De, "onBeforeInput"), 0 < an.length && (St = new ai(
          "onBeforeInput",
          "beforeinput",
          null,
          p,
          Ue
        ), Ke.push({
          event: St,
          listeners: an
        }), St.data = Zt)), Bu(
          Ke,
          o,
          De,
          p,
          Ue
        );
      }
      Cv(Ke, l);
    });
  }
  function js(o, l, p) {
    return {
      instance: o,
      listener: l,
      currentTarget: p
    };
  }
  function Lf(o, l) {
    for (var p = l + "Capture", y = []; o !== null; ) {
      var E = o, A = E.stateNode;
      if (E = E.tag, E !== 5 && E !== 26 && E !== 27 || A === null || (E = va(o, p), E != null && y.unshift(
        js(o, E, A)
      ), E = va(o, l), E != null && y.push(
        js(o, E, A)
      )), o.tag === 3) return y;
      o = o.return;
    }
    return [];
  }
  function Rp(o) {
    if (o === null) return null;
    do
      o = o.return;
    while (o && o.tag !== 5 && o.tag !== 27);
    return o || null;
  }
  function rr(o, l, p, y, E) {
    for (var A = l._reactName, B = []; p !== null && p !== y; ) {
      var ne = p, xe = ne.alternate, De = ne.stateNode;
      if (ne = ne.tag, xe !== null && xe === y) break;
      ne !== 5 && ne !== 26 && ne !== 27 || De === null || (xe = De, E ? (De = va(p, A), De != null && B.unshift(
        js(p, De, xe)
      )) : E || (De = va(p, A), De != null && B.push(
        js(p, De, xe)
      ))), p = p.return;
    }
    B.length !== 0 && o.push({ event: l, listeners: B });
  }
  var gr = /\r\n?/g, kv = /\u0000|\uFFFD/g;
  function Tv(o) {
    return (typeof o == "string" ? o : "" + o).replace(gr, `
`).replace(kv, "");
  }
  function jv(o, l) {
    return l = Tv(l), Tv(o) === l;
  }
  function On(o, l, p, y, E, A) {
    switch (p) {
      case "children":
        typeof y == "string" ? l === "body" || l === "textarea" && y === "" || Vi(o, y) : (typeof y == "number" || typeof y == "bigint") && l !== "body" && Vi(o, "" + y);
        break;
      case "className":
        Ua(o, "class", y);
        break;
      case "tabIndex":
        Ua(o, "tabindex", y);
        break;
      case "dir":
      case "role":
      case "viewBox":
      case "width":
      case "height":
        Ua(o, p, y);
        break;
      case "style":
        zd(o, y, A);
        break;
      case "data":
        if (l !== "object") {
          Ua(o, "data", y);
          break;
        }
      case "src":
      case "href":
        if (y === "" && (l !== "a" || p !== "href")) {
          o.removeAttribute(p);
          break;
        }
        if (y == null || typeof y == "function" || typeof y == "symbol" || typeof y == "boolean") {
          o.removeAttribute(p);
          break;
        }
        y = Gs("" + y), o.setAttribute(p, y);
        break;
      case "action":
      case "formAction":
        if (typeof y == "function") {
          o.setAttribute(
            p,
            "javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')"
          );
          break;
        } else
          typeof A == "function" && (p === "formAction" ? (l !== "input" && On(o, l, "name", E.name, E, null), On(
            o,
            l,
            "formEncType",
            E.formEncType,
            E,
            null
          ), On(
            o,
            l,
            "formMethod",
            E.formMethod,
            E,
            null
          ), On(
            o,
            l,
            "formTarget",
            E.formTarget,
            E,
            null
          )) : (On(o, l, "encType", E.encType, E, null), On(o, l, "method", E.method, E, null), On(o, l, "target", E.target, E, null)));
        if (y == null || typeof y == "symbol" || typeof y == "boolean") {
          o.removeAttribute(p);
          break;
        }
        y = Gs("" + y), o.setAttribute(p, y);
        break;
      case "onClick":
        y != null && (o.onclick = Gi);
        break;
      case "onScroll":
        y != null && tn("scroll", o);
        break;
      case "onScrollEnd":
        y != null && tn("scrollend", o);
        break;
      case "dangerouslySetInnerHTML":
        if (y != null) {
          if (typeof y != "object" || !("__html" in y))
            throw Error(r(61));
          if (p = y.__html, p != null) {
            if (E.children != null) throw Error(r(60));
            o.innerHTML = p;
          }
        }
        break;
      case "multiple":
        o.multiple = y && typeof y != "function" && typeof y != "symbol";
        break;
      case "muted":
        o.muted = y && typeof y != "function" && typeof y != "symbol";
        break;
      case "suppressContentEditableWarning":
      case "suppressHydrationWarning":
      case "defaultValue":
      case "defaultChecked":
      case "innerHTML":
      case "ref":
        break;
      case "autoFocus":
        break;
      case "xlinkHref":
        if (y == null || typeof y == "function" || typeof y == "boolean" || typeof y == "symbol") {
          o.removeAttribute("xlink:href");
          break;
        }
        p = Gs("" + y), o.setAttributeNS(
          "http://www.w3.org/1999/xlink",
          "xlink:href",
          p
        );
        break;
      case "contentEditable":
      case "spellCheck":
      case "draggable":
      case "value":
      case "autoReverse":
      case "externalResourcesRequired":
      case "focusable":
      case "preserveAlpha":
        y != null && typeof y != "function" && typeof y != "symbol" ? o.setAttribute(p, "" + y) : o.removeAttribute(p);
        break;
      case "inert":
      case "allowFullScreen":
      case "async":
      case "autoPlay":
      case "controls":
      case "default":
      case "defer":
      case "disabled":
      case "disablePictureInPicture":
      case "disableRemotePlayback":
      case "formNoValidate":
      case "hidden":
      case "loop":
      case "noModule":
      case "noValidate":
      case "open":
      case "playsInline":
      case "readOnly":
      case "required":
      case "reversed":
      case "scoped":
      case "seamless":
      case "itemScope":
        y && typeof y != "function" && typeof y != "symbol" ? o.setAttribute(p, "") : o.removeAttribute(p);
        break;
      case "capture":
      case "download":
        y === !0 ? o.setAttribute(p, "") : y !== !1 && y != null && typeof y != "function" && typeof y != "symbol" ? o.setAttribute(p, y) : o.removeAttribute(p);
        break;
      case "cols":
      case "rows":
      case "size":
      case "span":
        y != null && typeof y != "function" && typeof y != "symbol" && !isNaN(y) && 1 <= y ? o.setAttribute(p, y) : o.removeAttribute(p);
        break;
      case "rowSpan":
      case "start":
        y == null || typeof y == "function" || typeof y == "symbol" || isNaN(y) ? o.removeAttribute(p) : o.setAttribute(p, y);
        break;
      case "popover":
        tn("beforetoggle", o), tn("toggle", o), Vt(o, "popover", y);
        break;
      case "xlinkActuate":
        Ri(
          o,
          "http://www.w3.org/1999/xlink",
          "xlink:actuate",
          y
        );
        break;
      case "xlinkArcrole":
        Ri(
          o,
          "http://www.w3.org/1999/xlink",
          "xlink:arcrole",
          y
        );
        break;
      case "xlinkRole":
        Ri(
          o,
          "http://www.w3.org/1999/xlink",
          "xlink:role",
          y
        );
        break;
      case "xlinkShow":
        Ri(
          o,
          "http://www.w3.org/1999/xlink",
          "xlink:show",
          y
        );
        break;
      case "xlinkTitle":
        Ri(
          o,
          "http://www.w3.org/1999/xlink",
          "xlink:title",
          y
        );
        break;
      case "xlinkType":
        Ri(
          o,
          "http://www.w3.org/1999/xlink",
          "xlink:type",
          y
        );
        break;
      case "xmlBase":
        Ri(
          o,
          "http://www.w3.org/XML/1998/namespace",
          "xml:base",
          y
        );
        break;
      case "xmlLang":
        Ri(
          o,
          "http://www.w3.org/XML/1998/namespace",
          "xml:lang",
          y
        );
        break;
      case "xmlSpace":
        Ri(
          o,
          "http://www.w3.org/XML/1998/namespace",
          "xml:space",
          y
        );
        break;
      case "is":
        Vt(o, "is", y);
        break;
      case "innerText":
      case "textContent":
        break;
      default:
        (!(2 < p.length) || p[0] !== "o" && p[0] !== "O" || p[1] !== "n" && p[1] !== "N") && (p = Dh.get(p) || p, Vt(o, p, y));
    }
  }
  function x0(o, l, p, y, E, A) {
    switch (p) {
      case "style":
        zd(o, y, A);
        break;
      case "dangerouslySetInnerHTML":
        if (y != null) {
          if (typeof y != "object" || !("__html" in y))
            throw Error(r(61));
          if (p = y.__html, p != null) {
            if (E.children != null) throw Error(r(60));
            o.innerHTML = p;
          }
        }
        break;
      case "children":
        typeof y == "string" ? Vi(o, y) : (typeof y == "number" || typeof y == "bigint") && Vi(o, "" + y);
        break;
      case "onScroll":
        y != null && tn("scroll", o);
        break;
      case "onScrollEnd":
        y != null && tn("scrollend", o);
        break;
      case "onClick":
        y != null && (o.onclick = Gi);
        break;
      case "suppressContentEditableWarning":
      case "suppressHydrationWarning":
      case "innerHTML":
      case "ref":
        break;
      case "innerText":
      case "textContent":
        break;
      default:
        if (!mo.hasOwnProperty(p))
          e: {
            if (p[0] === "o" && p[1] === "n" && (E = p.endsWith("Capture"), l = p.slice(2, E ? p.length - 7 : void 0), A = o[ar] || null, A = A != null ? A[p] : null, typeof A == "function" && o.removeEventListener(l, A, E), typeof y == "function")) {
              typeof A != "function" && A !== null && (p in o ? o[p] = null : o.hasAttribute(p) && o.removeAttribute(p)), o.addEventListener(l, y, E);
              break e;
            }
            p in o ? o[p] = y : y === !0 ? o.setAttribute(p, "") : Vt(o, p, y);
          }
    }
  }
  function pi(o, l, p) {
    switch (l) {
      case "div":
      case "span":
      case "svg":
      case "path":
      case "a":
      case "g":
      case "p":
      case "li":
        break;
      case "img":
        tn("error", o), tn("load", o);
        var y = !1, E = !1, A;
        for (A in p)
          if (p.hasOwnProperty(A)) {
            var B = p[A];
            if (B != null)
              switch (A) {
                case "src":
                  y = !0;
                  break;
                case "srcSet":
                  E = !0;
                  break;
                case "children":
                case "dangerouslySetInnerHTML":
                  throw Error(r(137, l));
                default:
                  On(o, l, A, B, p, null);
              }
          }
        E && On(o, l, "srcSet", p.srcSet, p, null), y && On(o, l, "src", p.src, p, null);
        return;
      case "input":
        tn("invalid", o);
        var ne = A = B = E = null, xe = null, De = null;
        for (y in p)
          if (p.hasOwnProperty(y)) {
            var Ue = p[y];
            if (Ue != null)
              switch (y) {
                case "name":
                  E = Ue;
                  break;
                case "type":
                  B = Ue;
                  break;
                case "checked":
                  xe = Ue;
                  break;
                case "defaultChecked":
                  De = Ue;
                  break;
                case "value":
                  A = Ue;
                  break;
                case "defaultValue":
                  ne = Ue;
                  break;
                case "children":
                case "dangerouslySetInnerHTML":
                  if (Ue != null)
                    throw Error(r(137, l));
                  break;
                default:
                  On(o, l, y, Ue, p, null);
              }
          }
        Va(
          o,
          A,
          ne,
          xe,
          De,
          B,
          E,
          !1
        );
        return;
      case "select":
        tn("invalid", o), y = B = A = null;
        for (E in p)
          if (p.hasOwnProperty(E) && (ne = p[E], ne != null))
            switch (E) {
              case "value":
                A = ne;
                break;
              case "defaultValue":
                B = ne;
                break;
              case "multiple":
                y = ne;
              default:
                On(o, l, E, ne, p, null);
            }
        l = A, p = B, o.multiple = !!y, l != null ? Oi(o, !!y, l, !1) : p != null && Oi(o, !!y, p, !0);
        return;
      case "textarea":
        tn("invalid", o), A = E = y = null;
        for (B in p)
          if (p.hasOwnProperty(B) && (ne = p[B], ne != null))
            switch (B) {
              case "value":
                y = ne;
                break;
              case "defaultValue":
                E = ne;
                break;
              case "children":
                A = ne;
                break;
              case "dangerouslySetInnerHTML":
                if (ne != null) throw Error(r(91));
                break;
              default:
                On(o, l, B, ne, p, null);
            }
        vo(o, y, E, A);
        return;
      case "option":
        for (xe in p)
          if (p.hasOwnProperty(xe) && (y = p[xe], y != null))
            switch (xe) {
              case "selected":
                o.selected = y && typeof y != "function" && typeof y != "symbol";
                break;
              default:
                On(o, l, xe, y, p, null);
            }
        return;
      case "dialog":
        tn("beforetoggle", o), tn("toggle", o), tn("cancel", o), tn("close", o);
        break;
      case "iframe":
      case "object":
        tn("load", o);
        break;
      case "video":
      case "audio":
        for (y = 0; y < If.length; y++)
          tn(If[y], o);
        break;
      case "image":
        tn("error", o), tn("load", o);
        break;
      case "details":
        tn("toggle", o);
        break;
      case "embed":
      case "source":
      case "link":
        tn("error", o), tn("load", o);
      case "area":
      case "base":
      case "br":
      case "col":
      case "hr":
      case "keygen":
      case "meta":
      case "param":
      case "track":
      case "wbr":
      case "menuitem":
        for (De in p)
          if (p.hasOwnProperty(De) && (y = p[De], y != null))
            switch (De) {
              case "children":
              case "dangerouslySetInnerHTML":
                throw Error(r(137, l));
              default:
                On(o, l, De, y, p, null);
            }
        return;
      default:
        if (dc(l)) {
          for (Ue in p)
            p.hasOwnProperty(Ue) && (y = p[Ue], y !== void 0 && x0(
              o,
              l,
              Ue,
              y,
              p,
              void 0
            ));
          return;
        }
    }
    for (ne in p)
      p.hasOwnProperty(ne) && (y = p[ne], y != null && On(o, l, ne, y, p, null));
  }
  function d2(o, l, p, y) {
    switch (l) {
      case "div":
      case "span":
      case "svg":
      case "path":
      case "a":
      case "g":
      case "p":
      case "li":
        break;
      case "input":
        var E = null, A = null, B = null, ne = null, xe = null, De = null, Ue = null;
        for (Be in p) {
          var Ke = p[Be];
          if (p.hasOwnProperty(Be) && Ke != null)
            switch (Be) {
              case "checked":
                break;
              case "value":
                break;
              case "defaultValue":
                xe = Ke;
              default:
                y.hasOwnProperty(Be) || On(o, l, Be, null, y, Ke);
            }
        }
        for (var Pe in y) {
          var Be = y[Pe];
          if (Ke = p[Pe], y.hasOwnProperty(Pe) && (Be != null || Ke != null))
            switch (Pe) {
              case "type":
                A = Be;
                break;
              case "name":
                E = Be;
                break;
              case "checked":
                De = Be;
                break;
              case "defaultChecked":
                Ue = Be;
                break;
              case "value":
                B = Be;
                break;
              case "defaultValue":
                ne = Be;
                break;
              case "children":
              case "dangerouslySetInnerHTML":
                if (Be != null)
                  throw Error(r(137, l));
                break;
              default:
                Be !== Ke && On(
                  o,
                  l,
                  Pe,
                  Be,
                  y,
                  Ke
                );
            }
        }
        Mi(
          o,
          B,
          ne,
          xe,
          De,
          Ue,
          A,
          E
        );
        return;
      case "select":
        Be = B = ne = Pe = null;
        for (A in p)
          if (xe = p[A], p.hasOwnProperty(A) && xe != null)
            switch (A) {
              case "value":
                break;
              case "multiple":
                Be = xe;
              default:
                y.hasOwnProperty(A) || On(
                  o,
                  l,
                  A,
                  null,
                  y,
                  xe
                );
            }
        for (E in y)
          if (A = y[E], xe = p[E], y.hasOwnProperty(E) && (A != null || xe != null))
            switch (E) {
              case "value":
                Pe = A;
                break;
              case "defaultValue":
                ne = A;
                break;
              case "multiple":
                B = A;
              default:
                A !== xe && On(
                  o,
                  l,
                  E,
                  A,
                  y,
                  xe
                );
            }
        l = ne, p = B, y = Be, Pe != null ? Oi(o, !!p, Pe, !1) : !!y != !!p && (l != null ? Oi(o, !!p, l, !0) : Oi(o, !!p, p ? [] : "", !1));
        return;
      case "textarea":
        Be = Pe = null;
        for (ne in p)
          if (E = p[ne], p.hasOwnProperty(ne) && E != null && !y.hasOwnProperty(ne))
            switch (ne) {
              case "value":
                break;
              case "children":
                break;
              default:
                On(o, l, ne, null, y, E);
            }
        for (B in y)
          if (E = y[B], A = p[B], y.hasOwnProperty(B) && (E != null || A != null))
            switch (B) {
              case "value":
                Pe = E;
                break;
              case "defaultValue":
                Be = E;
                break;
              case "children":
                break;
              case "dangerouslySetInnerHTML":
                if (E != null) throw Error(r(91));
                break;
              default:
                E !== A && On(o, l, B, E, y, A);
            }
        pu(o, Pe, Be);
        return;
      case "option":
        for (var _t in p)
          if (Pe = p[_t], p.hasOwnProperty(_t) && Pe != null && !y.hasOwnProperty(_t))
            switch (_t) {
              case "selected":
                o.selected = !1;
                break;
              default:
                On(
                  o,
                  l,
                  _t,
                  null,
                  y,
                  Pe
                );
            }
        for (xe in y)
          if (Pe = y[xe], Be = p[xe], y.hasOwnProperty(xe) && Pe !== Be && (Pe != null || Be != null))
            switch (xe) {
              case "selected":
                o.selected = Pe && typeof Pe != "function" && typeof Pe != "symbol";
                break;
              default:
                On(
                  o,
                  l,
                  xe,
                  Pe,
                  y,
                  Be
                );
            }
        return;
      case "img":
      case "link":
      case "area":
      case "base":
      case "br":
      case "col":
      case "embed":
      case "hr":
      case "keygen":
      case "meta":
      case "param":
      case "source":
      case "track":
      case "wbr":
      case "menuitem":
        for (var Mt in p)
          Pe = p[Mt], p.hasOwnProperty(Mt) && Pe != null && !y.hasOwnProperty(Mt) && On(o, l, Mt, null, y, Pe);
        for (De in y)
          if (Pe = y[De], Be = p[De], y.hasOwnProperty(De) && Pe !== Be && (Pe != null || Be != null))
            switch (De) {
              case "children":
              case "dangerouslySetInnerHTML":
                if (Pe != null)
                  throw Error(r(137, l));
                break;
              default:
                On(
                  o,
                  l,
                  De,
                  Pe,
                  y,
                  Be
                );
            }
        return;
      default:
        if (dc(l)) {
          for (var Dn in p)
            Pe = p[Dn], p.hasOwnProperty(Dn) && Pe !== void 0 && !y.hasOwnProperty(Dn) && x0(
              o,
              l,
              Dn,
              void 0,
              y,
              Pe
            );
          for (Ue in y)
            Pe = y[Ue], Be = p[Ue], !y.hasOwnProperty(Ue) || Pe === Be || Pe === void 0 && Be === void 0 || x0(
              o,
              l,
              Ue,
              Pe,
              y,
              Be
            );
          return;
        }
    }
    for (var je in p)
      Pe = p[je], p.hasOwnProperty(je) && Pe != null && !y.hasOwnProperty(je) && On(o, l, je, null, y, Pe);
    for (Ke in y)
      Pe = y[Ke], Be = p[Ke], !y.hasOwnProperty(Ke) || Pe === Be || Pe == null && Be == null || On(o, l, Ke, Pe, y, Be);
  }
  function v0(o) {
    switch (o) {
      case "css":
      case "script":
      case "font":
      case "img":
      case "image":
      case "input":
      case "link":
        return !0;
      default:
        return !1;
    }
  }
  function Bf() {
    if (typeof performance.getEntriesByType == "function") {
      for (var o = 0, l = 0, p = performance.getEntriesByType("resource"), y = 0; y < p.length; y++) {
        var E = p[y], A = E.transferSize, B = E.initiatorType, ne = E.duration;
        if (A && ne && v0(B)) {
          for (B = 0, ne = E.responseEnd, y += 1; y < p.length; y++) {
            var xe = p[y], De = xe.startTime;
            if (De > ne) break;
            var Ue = xe.transferSize, Ke = xe.initiatorType;
            Ue && v0(Ke) && (xe = xe.responseEnd, B += Ue * (xe < ne ? 1 : (ne - De) / (xe - De)));
          }
          if (--y, l += 8 * (A + B) / (E.duration / 1e3), o++, 10 < o) break;
        }
      }
      if (0 < o) return l / o / 1e6;
    }
    return navigator.connection && (o = navigator.connection.downlink, typeof o == "number") ? o : 5;
  }
  var $f = null, b0 = null;
  function qf(o) {
    return o.nodeType === 9 ? o : o.ownerDocument;
  }
  function Ff(o) {
    switch (o) {
      case "http://www.w3.org/2000/svg":
        return 1;
      case "http://www.w3.org/1998/Math/MathML":
        return 2;
      default:
        return 0;
    }
  }
  function ns(o, l) {
    if (o === 0)
      switch (l) {
        case "svg":
          return 1;
        case "math":
          return 2;
        default:
          return 0;
      }
    return o === 1 && l === "foreignObject" ? 0 : o;
  }
  function Bl(o, l) {
    return o === "textarea" || o === "noscript" || typeof l.children == "string" || typeof l.children == "number" || typeof l.children == "bigint" || typeof l.dangerouslySetInnerHTML == "object" && l.dangerouslySetInnerHTML !== null && l.dangerouslySetInnerHTML.__html != null;
  }
  var w0 = null;
  function f2() {
    var o = window.event;
    return o && o.type === "popstate" ? o === w0 ? !1 : (w0 = o, !0) : (w0 = null, !1);
  }
  var Av = typeof setTimeout == "function" ? setTimeout : void 0, h2 = typeof clearTimeout == "function" ? clearTimeout : void 0, Nv = typeof Promise == "function" ? Promise : void 0, Rv = typeof queueMicrotask == "function" ? queueMicrotask : typeof Nv < "u" ? function(o) {
    return Nv.resolve(null).then(o).catch($o);
  } : Av;
  function $o(o) {
    setTimeout(function() {
      throw o;
    });
  }
  function zt(o) {
    return o === "head";
  }
  function _0(o, l) {
    var p = l, y = 0;
    do {
      var E = p.nextSibling;
      if (o.removeChild(p), E && E.nodeType === 8)
        if (p = E.data, p === "/$" || p === "/&") {
          if (y === 0) {
            o.removeChild(E), ld(l);
            return;
          }
          y--;
        } else if (p === "$" || p === "$?" || p === "$~" || p === "$!" || p === "&")
          y++;
        else if (p === "html")
          Uf(o.ownerDocument.documentElement);
        else if (p === "head") {
          p = o.ownerDocument.head, Uf(p);
          for (var A = p.firstChild; A; ) {
            var B = A.nextSibling, ne = A.nodeName;
            A[Ni] || ne === "SCRIPT" || ne === "STYLE" || ne === "LINK" && A.rel.toLowerCase() === "stylesheet" || p.removeChild(A), A = B;
          }
        } else
          p === "body" && Uf(o.ownerDocument.body);
      p = E;
    } while (p);
    ld(l);
  }
  function As(o, l) {
    var p = o;
    o = 0;
    do {
      var y = p.nextSibling;
      if (p.nodeType === 1 ? l ? (p._stashedDisplay = p.style.display, p.style.display = "none") : (p.style.display = p._stashedDisplay || "", p.getAttribute("style") === "" && p.removeAttribute("style")) : p.nodeType === 3 && (l ? (p._stashedText = p.nodeValue, p.nodeValue = "") : p.nodeValue = p._stashedText || ""), y && y.nodeType === 8)
        if (p = y.data, p === "/$") {
          if (o === 0) break;
          o--;
        } else
          p !== "$" && p !== "$?" && p !== "$~" && p !== "$!" || o++;
      p = y;
    } while (p);
  }
  function Mp(o) {
    var l = o.firstChild;
    for (l && l.nodeType === 10 && (l = l.nextSibling); l; ) {
      var p = l;
      switch (l = l.nextSibling, p.nodeName) {
        case "HTML":
        case "HEAD":
        case "BODY":
          Mp(p), ol(p);
          continue;
        case "SCRIPT":
        case "STYLE":
          continue;
        case "LINK":
          if (p.rel.toLowerCase() === "stylesheet") continue;
      }
      o.removeChild(p);
    }
  }
  function p2(o, l, p, y) {
    for (; o.nodeType === 1; ) {
      var E = p;
      if (o.nodeName.toLowerCase() !== l.toLowerCase()) {
        if (!y && (o.nodeName !== "INPUT" || o.type !== "hidden"))
          break;
      } else if (y) {
        if (!o[Ni])
          switch (l) {
            case "meta":
              if (!o.hasAttribute("itemprop")) break;
              return o;
            case "link":
              if (A = o.getAttribute("rel"), A === "stylesheet" && o.hasAttribute("data-precedence"))
                break;
              if (A !== E.rel || o.getAttribute("href") !== (E.href == null || E.href === "" ? null : E.href) || o.getAttribute("crossorigin") !== (E.crossOrigin == null ? null : E.crossOrigin) || o.getAttribute("title") !== (E.title == null ? null : E.title))
                break;
              return o;
            case "style":
              if (o.hasAttribute("data-precedence")) break;
              return o;
            case "script":
              if (A = o.getAttribute("src"), (A !== (E.src == null ? null : E.src) || o.getAttribute("type") !== (E.type == null ? null : E.type) || o.getAttribute("crossorigin") !== (E.crossOrigin == null ? null : E.crossOrigin)) && A && o.hasAttribute("async") && !o.hasAttribute("itemprop"))
                break;
              return o;
            default:
              return o;
          }
      } else if (l === "input" && o.type === "hidden") {
        var A = E.name == null ? null : "" + E.name;
        if (E.type === "hidden" && o.getAttribute("name") === A)
          return o;
      } else return o;
      if (o = oa(o.nextSibling), o === null) break;
    }
    return null;
  }
  function Cn(o, l, p) {
    if (l === "") return null;
    for (; o.nodeType !== 3; )
      if ((o.nodeType !== 1 || o.nodeName !== "INPUT" || o.type !== "hidden") && !p || (o = oa(o.nextSibling), o === null)) return null;
    return o;
  }
  function Mv(o, l) {
    for (; o.nodeType !== 8; )
      if ((o.nodeType !== 1 || o.nodeName !== "INPUT" || o.type !== "hidden") && !l || (o = oa(o.nextSibling), o === null)) return null;
    return o;
  }
  function Op(o) {
    return o.data === "$?" || o.data === "$~";
  }
  function ed(o) {
    return o.data === "$!" || o.data === "$?" && o.ownerDocument.readyState !== "loading";
  }
  function m2(o, l) {
    var p = o.ownerDocument;
    if (o.data === "$~") o._reactRetry = l;
    else if (o.data !== "$?" || p.readyState !== "loading")
      l();
    else {
      var y = function() {
        l(), p.removeEventListener("DOMContentLoaded", y);
      };
      p.addEventListener("DOMContentLoaded", y), o._reactRetry = y;
    }
  }
  function oa(o) {
    for (; o != null; o = o.nextSibling) {
      var l = o.nodeType;
      if (l === 1 || l === 3) break;
      if (l === 8) {
        if (l = o.data, l === "$" || l === "$!" || l === "$?" || l === "$~" || l === "&" || l === "F!" || l === "F")
          break;
        if (l === "/$" || l === "/&") return null;
      }
    }
    return o;
  }
  var S0 = null;
  function Ov(o) {
    o = o.nextSibling;
    for (var l = 0; o; ) {
      if (o.nodeType === 8) {
        var p = o.data;
        if (p === "/$" || p === "/&") {
          if (l === 0)
            return oa(o.nextSibling);
          l--;
        } else
          p !== "$" && p !== "$!" && p !== "$?" && p !== "$~" && p !== "&" || l++;
      }
      o = o.nextSibling;
    }
    return null;
  }
  function Dv(o) {
    o = o.previousSibling;
    for (var l = 0; o; ) {
      if (o.nodeType === 8) {
        var p = o.data;
        if (p === "$" || p === "$!" || p === "$?" || p === "$~" || p === "&") {
          if (l === 0) return o;
          l--;
        } else p !== "/$" && p !== "/&" || l++;
      }
      o = o.previousSibling;
    }
    return null;
  }
  function zv(o, l, p) {
    switch (l = qf(p), o) {
      case "html":
        if (o = l.documentElement, !o) throw Error(r(452));
        return o;
      case "head":
        if (o = l.head, !o) throw Error(r(453));
        return o;
      case "body":
        if (o = l.body, !o) throw Error(r(454));
        return o;
      default:
        throw Error(r(451));
    }
  }
  function Uf(o) {
    for (var l = o.attributes; l.length; )
      o.removeAttributeNode(l[0]);
    ol(o);
  }
  var la = /* @__PURE__ */ new Map(), Pv = /* @__PURE__ */ new Set();
  function Dp(o) {
    return typeof o.getRootNode == "function" ? o.getRootNode() : o.nodeType === 9 ? o : o.ownerDocument;
  }
  var qo = ce.d;
  ce.d = {
    f: g2,
    r: y2,
    D: E0,
    C: x2,
    L: v2,
    m: b2,
    X: rs,
    S: Xr,
    M: w2
  };
  function g2() {
    var o = qo.f(), l = Sp();
    return o || l;
  }
  function y2(o) {
    var l = mn(o);
    l !== null && l.tag === 5 && l.type === "form" ? jg(l) : qo.r(o);
  }
  var $l = typeof document > "u" ? null : document;
  function Iv(o, l, p) {
    var y = $l;
    if (y && typeof l == "string" && l) {
      var E = Sr(l);
      E = 'link[rel="' + o + '"][href="' + E + '"]', typeof p == "string" && (E += '[crossorigin="' + p + '"]'), Pv.has(E) || (Pv.add(E), o = { rel: o, crossOrigin: p, href: l }, y.querySelector(E) === null && (l = y.createElement("link"), pi(l, "link", o), or(l), y.head.appendChild(l)));
    }
  }
  function E0(o) {
    qo.D(o), Iv("dns-prefetch", o, null);
  }
  function x2(o, l) {
    qo.C(o, l), Iv("preconnect", o, l);
  }
  function v2(o, l, p) {
    qo.L(o, l, p);
    var y = $l;
    if (y && o && l) {
      var E = 'link[rel="preload"][as="' + Sr(l) + '"]';
      l === "image" && p && p.imageSrcSet ? (E += '[imagesrcset="' + Sr(
        p.imageSrcSet
      ) + '"]', typeof p.imageSizes == "string" && (E += '[imagesizes="' + Sr(
        p.imageSizes
      ) + '"]')) : E += '[href="' + Sr(o) + '"]';
      var A = E;
      switch (l) {
        case "style":
          A = td(o);
          break;
        case "script":
          A = rd(o);
      }
      la.has(A) || (o = m(
        {
          rel: "preload",
          href: l === "image" && p && p.imageSrcSet ? void 0 : o,
          as: l
        },
        p
      ), la.set(A, o), y.querySelector(E) !== null || l === "style" && y.querySelector(nd(A)) || l === "script" && y.querySelector(id(A)) || (l = y.createElement("link"), pi(l, "link", o), or(l), y.head.appendChild(l)));
    }
  }
  function b2(o, l) {
    qo.m(o, l);
    var p = $l;
    if (p && o) {
      var y = l && typeof l.as == "string" ? l.as : "script", E = 'link[rel="modulepreload"][as="' + Sr(y) + '"][href="' + Sr(o) + '"]', A = E;
      switch (y) {
        case "audioworklet":
        case "paintworklet":
        case "serviceworker":
        case "sharedworker":
        case "worker":
        case "script":
          A = rd(o);
      }
      if (!la.has(A) && (o = m({ rel: "modulepreload", href: o }, l), la.set(A, o), p.querySelector(E) === null)) {
        switch (y) {
          case "audioworklet":
          case "paintworklet":
          case "serviceworker":
          case "sharedworker":
          case "worker":
          case "script":
            if (p.querySelector(id(A)))
              return;
        }
        y = p.createElement("link"), pi(y, "link", o), or(y), p.head.appendChild(y);
      }
    }
  }
  function Xr(o, l, p) {
    qo.S(o, l, p);
    var y = $l;
    if (y && o) {
      var E = _r(y).hoistableStyles, A = td(o);
      l = l || "default";
      var B = E.get(A);
      if (!B) {
        var ne = { loading: 0, preload: null };
        if (B = y.querySelector(
          nd(A)
        ))
          ne.loading = 5;
        else {
          o = m(
            { rel: "stylesheet", href: o, "data-precedence": l },
            p
          ), (p = la.get(A)) && C0(o, p);
          var xe = B = y.createElement("link");
          or(xe), pi(xe, "link", o), xe._p = new Promise(function(De, Ue) {
            xe.onload = De, xe.onerror = Ue;
          }), xe.addEventListener("load", function() {
            ne.loading |= 1;
          }), xe.addEventListener("error", function() {
            ne.loading |= 2;
          }), ne.loading |= 4, zp(B, l, y);
        }
        B = {
          type: "stylesheet",
          instance: B,
          count: 1,
          state: ne
        }, E.set(A, B);
      }
    }
  }
  function rs(o, l) {
    qo.X(o, l);
    var p = $l;
    if (p && o) {
      var y = _r(p).hoistableScripts, E = rd(o), A = y.get(E);
      A || (A = p.querySelector(id(E)), A || (o = m({ src: o, async: !0 }, l), (l = la.get(E)) && Pp(o, l), A = p.createElement("script"), or(A), pi(A, "link", o), p.head.appendChild(A)), A = {
        type: "script",
        instance: A,
        count: 1,
        state: null
      }, y.set(E, A));
    }
  }
  function w2(o, l) {
    qo.M(o, l);
    var p = $l;
    if (p && o) {
      var y = _r(p).hoistableScripts, E = rd(o), A = y.get(E);
      A || (A = p.querySelector(id(E)), A || (o = m({ src: o, async: !0, type: "module" }, l), (l = la.get(E)) && Pp(o, l), A = p.createElement("script"), or(A), pi(A, "link", o), p.head.appendChild(A)), A = {
        type: "script",
        instance: A,
        count: 1,
        state: null
      }, y.set(E, A));
    }
  }
  function Lv(o, l, p, y) {
    var E = (E = Se.current) ? Dp(E) : null;
    if (!E) throw Error(r(446));
    switch (o) {
      case "meta":
      case "title":
        return null;
      case "style":
        return typeof p.precedence == "string" && typeof p.href == "string" ? (l = td(p.href), p = _r(
          E
        ).hoistableStyles, y = p.get(l), y || (y = {
          type: "style",
          instance: null,
          count: 0,
          state: null
        }, p.set(l, y)), y) : { type: "void", instance: null, count: 0, state: null };
      case "link":
        if (p.rel === "stylesheet" && typeof p.href == "string" && typeof p.precedence == "string") {
          o = td(p.href);
          var A = _r(
            E
          ).hoistableStyles, B = A.get(o);
          if (B || (E = E.ownerDocument || E, B = {
            type: "stylesheet",
            instance: null,
            count: 0,
            state: { loading: 0, preload: null }
          }, A.set(o, B), (A = E.querySelector(
            nd(o)
          )) && !A._p && (B.instance = A, B.state.loading = 5), la.has(o) || (p = {
            rel: "preload",
            as: "style",
            href: p.href,
            crossOrigin: p.crossOrigin,
            integrity: p.integrity,
            media: p.media,
            hrefLang: p.hrefLang,
            referrerPolicy: p.referrerPolicy
          }, la.set(o, p), A || _2(
            E,
            o,
            p,
            B.state
          ))), l && y === null)
            throw Error(r(528, ""));
          return B;
        }
        if (l && y !== null)
          throw Error(r(529, ""));
        return null;
      case "script":
        return l = p.async, p = p.src, typeof p == "string" && l && typeof l != "function" && typeof l != "symbol" ? (l = rd(p), p = _r(
          E
        ).hoistableScripts, y = p.get(l), y || (y = {
          type: "script",
          instance: null,
          count: 0,
          state: null
        }, p.set(l, y)), y) : { type: "void", instance: null, count: 0, state: null };
      default:
        throw Error(r(444, o));
    }
  }
  function td(o) {
    return 'href="' + Sr(o) + '"';
  }
  function nd(o) {
    return 'link[rel="stylesheet"][' + o + "]";
  }
  function Bv(o) {
    return m({}, o, {
      "data-precedence": o.precedence,
      precedence: null
    });
  }
  function _2(o, l, p, y) {
    o.querySelector('link[rel="preload"][as="style"][' + l + "]") ? y.loading = 1 : (l = o.createElement("link"), y.preload = l, l.addEventListener("load", function() {
      return y.loading |= 1;
    }), l.addEventListener("error", function() {
      return y.loading |= 2;
    }), pi(l, "link", p), or(l), o.head.appendChild(l));
  }
  function rd(o) {
    return '[src="' + Sr(o) + '"]';
  }
  function id(o) {
    return "script[async]" + o;
  }
  function $v(o, l, p) {
    if (l.count++, l.instance === null)
      switch (l.type) {
        case "style":
          var y = o.querySelector(
            'style[data-href~="' + Sr(p.href) + '"]'
          );
          if (y)
            return l.instance = y, or(y), y;
          var E = m({}, p, {
            "data-href": p.href,
            "data-precedence": p.precedence,
            href: null,
            precedence: null
          });
          return y = (o.ownerDocument || o).createElement(
            "style"
          ), or(y), pi(y, "style", E), zp(y, p.precedence, o), l.instance = y;
        case "stylesheet":
          E = td(p.href);
          var A = o.querySelector(
            nd(E)
          );
          if (A)
            return l.state.loading |= 4, l.instance = A, or(A), A;
          y = Bv(p), (E = la.get(E)) && C0(y, E), A = (o.ownerDocument || o).createElement("link"), or(A);
          var B = A;
          return B._p = new Promise(function(ne, xe) {
            B.onload = ne, B.onerror = xe;
          }), pi(A, "link", y), l.state.loading |= 4, zp(A, p.precedence, o), l.instance = A;
        case "script":
          return A = rd(p.src), (E = o.querySelector(
            id(A)
          )) ? (l.instance = E, or(E), E) : (y = p, (E = la.get(A)) && (y = m({}, p), Pp(y, E)), o = o.ownerDocument || o, E = o.createElement("script"), or(E), pi(E, "link", y), o.head.appendChild(E), l.instance = E);
        case "void":
          return null;
        default:
          throw Error(r(443, l.type));
      }
    else
      l.type === "stylesheet" && (l.state.loading & 4) === 0 && (y = l.instance, l.state.loading |= 4, zp(y, p.precedence, o));
    return l.instance;
  }
  function zp(o, l, p) {
    for (var y = p.querySelectorAll(
      'link[rel="stylesheet"][data-precedence],style[data-precedence]'
    ), E = y.length ? y[y.length - 1] : null, A = E, B = 0; B < y.length; B++) {
      var ne = y[B];
      if (ne.dataset.precedence === l) A = ne;
      else if (A !== E) break;
    }
    A ? A.parentNode.insertBefore(o, A.nextSibling) : (l = p.nodeType === 9 ? p.head : p, l.insertBefore(o, l.firstChild));
  }
  function C0(o, l) {
    o.crossOrigin == null && (o.crossOrigin = l.crossOrigin), o.referrerPolicy == null && (o.referrerPolicy = l.referrerPolicy), o.title == null && (o.title = l.title);
  }
  function Pp(o, l) {
    o.crossOrigin == null && (o.crossOrigin = l.crossOrigin), o.referrerPolicy == null && (o.referrerPolicy = l.referrerPolicy), o.integrity == null && (o.integrity = l.integrity);
  }
  var Hf = null;
  function qv(o, l, p) {
    if (Hf === null) {
      var y = /* @__PURE__ */ new Map(), E = Hf = /* @__PURE__ */ new Map();
      E.set(p, y);
    } else
      E = Hf, y = E.get(p), y || (y = /* @__PURE__ */ new Map(), E.set(p, y));
    if (y.has(o)) return y;
    for (y.set(o, null), p = p.getElementsByTagName(o), E = 0; E < p.length; E++) {
      var A = p[E];
      if (!(A[Ni] || A[Rn] || o === "link" && A.getAttribute("rel") === "stylesheet") && A.namespaceURI !== "http://www.w3.org/2000/svg") {
        var B = A.getAttribute(l) || "";
        B = o + B;
        var ne = y.get(B);
        ne ? ne.push(A) : y.set(B, [A]);
      }
    }
    return y;
  }
  function Fv(o, l, p) {
    o = o.ownerDocument || o, o.head.insertBefore(
      p,
      l === "title" ? o.querySelector("head > title") : null
    );
  }
  function S2(o, l, p) {
    if (p === 1 || l.itemProp != null) return !1;
    switch (o) {
      case "meta":
      case "title":
        return !0;
      case "style":
        if (typeof l.precedence != "string" || typeof l.href != "string" || l.href === "")
          break;
        return !0;
      case "link":
        if (typeof l.rel != "string" || typeof l.href != "string" || l.href === "" || l.onLoad || l.onError)
          break;
        switch (l.rel) {
          case "stylesheet":
            return o = l.disabled, typeof l.precedence == "string" && o == null;
          default:
            return !0;
        }
      case "script":
        if (l.async && typeof l.async != "function" && typeof l.async != "symbol" && !l.onLoad && !l.onError && l.src && typeof l.src == "string")
          return !0;
    }
    return !1;
  }
  function Uv(o) {
    return !(o.type === "stylesheet" && (o.state.loading & 3) === 0);
  }
  function sd(o, l, p, y) {
    if (p.type === "stylesheet" && (typeof y.media != "string" || matchMedia(y.media).matches !== !1) && (p.state.loading & 4) === 0) {
      if (p.instance === null) {
        var E = td(y.href), A = l.querySelector(
          nd(E)
        );
        if (A) {
          l = A._p, l !== null && typeof l == "object" && typeof l.then == "function" && (o.count++, o = Ip.bind(o), l.then(o, o)), p.state.loading |= 4, p.instance = A, or(A);
          return;
        }
        A = l.ownerDocument || l, y = Bv(y), (E = la.get(E)) && C0(y, E), A = A.createElement("link"), or(A);
        var B = A;
        B._p = new Promise(function(ne, xe) {
          B.onload = ne, B.onerror = xe;
        }), pi(A, "link", y), p.instance = A;
      }
      o.stylesheets === null && (o.stylesheets = /* @__PURE__ */ new Map()), o.stylesheets.set(p, l), (l = p.state.preload) && (p.state.loading & 3) === 0 && (o.count++, p = Ip.bind(o), l.addEventListener("load", p), l.addEventListener("error", p));
    }
  }
  var k0 = 0;
  function E2(o, l) {
    return o.stylesheets && o.count === 0 && Bp(o, o.stylesheets), 0 < o.count || 0 < o.imgCount ? function(p) {
      var y = setTimeout(function() {
        if (o.stylesheets && Bp(o, o.stylesheets), o.unsuspend) {
          var A = o.unsuspend;
          o.unsuspend = null, A();
        }
      }, 6e4 + l);
      0 < o.imgBytes && k0 === 0 && (k0 = 62500 * Bf());
      var E = setTimeout(
        function() {
          if (o.waitingForImages = !1, o.count === 0 && (o.stylesheets && Bp(o, o.stylesheets), o.unsuspend)) {
            var A = o.unsuspend;
            o.unsuspend = null, A();
          }
        },
        (o.imgBytes > k0 ? 50 : 800) + l
      );
      return o.unsuspend = p, function() {
        o.unsuspend = null, clearTimeout(y), clearTimeout(E);
      };
    } : null;
  }
  function Ip() {
    if (this.count--, this.count === 0 && (this.imgCount === 0 || !this.waitingForImages)) {
      if (this.stylesheets) Bp(this, this.stylesheets);
      else if (this.unsuspend) {
        var o = this.unsuspend;
        this.unsuspend = null, o();
      }
    }
  }
  var Lp = null;
  function Bp(o, l) {
    o.stylesheets = null, o.unsuspend !== null && (o.count++, Lp = /* @__PURE__ */ new Map(), l.forEach(Hv, o), Lp = null, Ip.call(o));
  }
  function Hv(o, l) {
    if (!(l.state.loading & 4)) {
      var p = Lp.get(o);
      if (p) var y = p.get(null);
      else {
        p = /* @__PURE__ */ new Map(), Lp.set(o, p);
        for (var E = o.querySelectorAll(
          "link[data-precedence],style[data-precedence]"
        ), A = 0; A < E.length; A++) {
          var B = E[A];
          (B.nodeName === "LINK" || B.getAttribute("media") !== "not all") && (p.set(B.dataset.precedence, B), y = B);
        }
        y && p.set(null, y);
      }
      E = l.instance, B = E.getAttribute("data-precedence"), A = p.get(B) || y, A === y && p.set(null, E), p.set(B, E), this.count++, y = Ip.bind(this), E.addEventListener("load", y), E.addEventListener("error", y), A ? A.parentNode.insertBefore(E, A.nextSibling) : (o = o.nodeType === 9 ? o.head : o, o.insertBefore(E, o.firstChild)), l.state.loading |= 4;
    }
  }
  var ad = {
    $$typeof: N,
    Provider: null,
    Consumer: null,
    _currentValue: pe,
    _currentValue2: pe,
    _threadCount: 0
  };
  function C2(o, l, p, y, E, A, B, ne, xe) {
    this.tag = 1, this.containerInfo = o, this.pingCache = this.current = this.pendingChildren = null, this.timeoutHandle = -1, this.callbackNode = this.next = this.pendingContext = this.context = this.cancelPendingCommit = null, this.callbackPriority = 0, this.expirationTimes = Ls(-1), this.entangledLanes = this.shellSuspendCounter = this.errorRecoveryDisabledLanes = this.expiredLanes = this.warmLanes = this.pingedLanes = this.suspendedLanes = this.pendingLanes = 0, this.entanglements = Ls(0), this.hiddenUpdates = Ls(null), this.identifierPrefix = y, this.onUncaughtError = E, this.onCaughtError = A, this.onRecoverableError = B, this.pooledCache = null, this.pooledCacheLanes = 0, this.formState = xe, this.incompleteTransitions = /* @__PURE__ */ new Map();
  }
  function Vv(o, l, p, y, E, A, B, ne, xe, De, Ue, Ke) {
    return o = new C2(
      o,
      l,
      p,
      B,
      xe,
      De,
      Ue,
      Ke,
      ne
    ), l = 1, A === !0 && (l |= 24), A = ci(3, null, null, l), o.current = A, A.stateNode = o, l = _a(), l.refCount++, o.pooledCache = l, l.refCount++, A.memoizedState = {
      element: y,
      isDehydrated: p,
      cache: l
    }, Qa(A), o;
  }
  function Gv(o) {
    return o ? (o = ui, o) : ui;
  }
  function Kv(o, l, p, y, E, A) {
    E = Gv(E), y.context === null ? y.context = E : y.pendingContext = E, y = kl(l), y.payload = { element: p }, A = A === void 0 ? null : A, A !== null && (y.callback = A), p = Ca(o, y, l), p !== null && (es(p, o, l), ef(p, o, l));
  }
  function Yv(o, l) {
    if (o = o.memoizedState, o !== null && o.dehydrated !== null) {
      var p = o.retryLane;
      o.retryLane = p !== 0 && p < l ? p : l;
    }
  }
  function T0(o, l) {
    Yv(o, l), (o = o.alternate) && Yv(o, l);
  }
  function Wv(o) {
    if (o.tag === 13 || o.tag === 31) {
      var l = Ln(o, 67108864);
      l !== null && es(l, o, 67108864), T0(o, 67108864);
    }
  }
  function Zv(o) {
    if (o.tag === 13 || o.tag === 31) {
      var l = ks();
      l = fu(l);
      var p = Ln(o, l);
      p !== null && es(p, o, l), T0(o, l);
    }
  }
  var $p = !0;
  function k2(o, l, p, y) {
    var E = X.T;
    X.T = null;
    var A = ce.p;
    try {
      ce.p = 2, j0(o, l, p, y);
    } finally {
      ce.p = A, X.T = E;
    }
  }
  function T2(o, l, p, y) {
    var E = X.T;
    X.T = null;
    var A = ce.p;
    try {
      ce.p = 8, j0(o, l, p, y);
    } finally {
      ce.p = A, X.T = E;
    }
  }
  function j0(o, l, p, y) {
    if ($p) {
      var E = A0(y);
      if (E === null)
        y0(
          o,
          l,
          y,
          qp,
          p
        ), Qv(o, y);
      else if (Jv(
        E,
        o,
        l,
        p,
        y
      ))
        y.stopPropagation();
      else if (Qv(o, y), l & 4 && -1 < j2.indexOf(o)) {
        for (; E !== null; ) {
          var A = mn(E);
          if (A !== null)
            switch (A.tag) {
              case 3:
                if (A = A.stateNode, A.current.memoizedState.isDehydrated) {
                  var B = bi(A.pendingLanes);
                  if (B !== 0) {
                    var ne = A;
                    for (ne.pendingLanes |= 2, ne.entangledLanes |= 2; B; ) {
                      var xe = 1 << 31 - nt(B);
                      ne.entanglements[1] |= xe, B &= ~xe;
                    }
                    ro(A), (Sn & 6) === 0 && (Iu = kn() + 500, Pf(0));
                  }
                }
                break;
              case 31:
              case 13:
                ne = Ln(A, 2), ne !== null && es(ne, A, 2), Sp(), T0(A, 2);
            }
          if (A = A0(y), A === null && y0(
            o,
            l,
            y,
            qp,
            p
          ), A === E) break;
          E = A;
        }
        E !== null && y.stopPropagation();
      } else
        y0(
          o,
          l,
          y,
          null,
          p
        );
    }
  }
  function A0(o) {
    return o = fc(o), N0(o);
  }
  var qp = null;
  function N0(o) {
    if (qp = null, o = Fs(o), o !== null) {
      var l = s(o);
      if (l === null) o = null;
      else {
        var p = l.tag;
        if (p === 13) {
          if (o = a(l), o !== null) return o;
          o = null;
        } else if (p === 31) {
          if (o = u(l), o !== null) return o;
          o = null;
        } else if (p === 3) {
          if (l.stateNode.current.memoizedState.isDehydrated)
            return l.tag === 3 ? l.stateNode.containerInfo : null;
          o = null;
        } else l !== o && (o = null);
      }
    }
    return qp = o, null;
  }
  function Xv(o) {
    switch (o) {
      case "beforetoggle":
      case "cancel":
      case "click":
      case "close":
      case "contextmenu":
      case "copy":
      case "cut":
      case "auxclick":
      case "dblclick":
      case "dragend":
      case "dragstart":
      case "drop":
      case "focusin":
      case "focusout":
      case "input":
      case "invalid":
      case "keydown":
      case "keypress":
      case "keyup":
      case "mousedown":
      case "mouseup":
      case "paste":
      case "pause":
      case "play":
      case "pointercancel":
      case "pointerdown":
      case "pointerup":
      case "ratechange":
      case "reset":
      case "resize":
      case "seeked":
      case "submit":
      case "toggle":
      case "touchcancel":
      case "touchend":
      case "touchstart":
      case "volumechange":
      case "change":
      case "selectionchange":
      case "textInput":
      case "compositionstart":
      case "compositionend":
      case "compositionupdate":
      case "beforeblur":
      case "afterblur":
      case "beforeinput":
      case "blur":
      case "fullscreenchange":
      case "focus":
      case "hashchange":
      case "popstate":
      case "select":
      case "selectstart":
        return 2;
      case "drag":
      case "dragenter":
      case "dragexit":
      case "dragleave":
      case "dragover":
      case "mousemove":
      case "mouseout":
      case "mouseover":
      case "pointermove":
      case "pointerout":
      case "pointerover":
      case "scroll":
      case "touchmove":
      case "wheel":
      case "mouseenter":
      case "mouseleave":
      case "pointerenter":
      case "pointerleave":
        return 8;
      case "message":
        switch (Nn()) {
          case $e:
            return 2;
          case Qe:
            return 8;
          case bt:
          case jt:
            return 32;
          case $t:
            return 268435456;
          default:
            return 32;
        }
      default:
        return 32;
    }
  }
  var R0 = !1, ql = null, Fl = null, Ul = null, Vf = /* @__PURE__ */ new Map(), Gf = /* @__PURE__ */ new Map(), Hl = [], j2 = "mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(
    " "
  );
  function Qv(o, l) {
    switch (o) {
      case "focusin":
      case "focusout":
        ql = null;
        break;
      case "dragenter":
      case "dragleave":
        Fl = null;
        break;
      case "mouseover":
      case "mouseout":
        Ul = null;
        break;
      case "pointerover":
      case "pointerout":
        Vf.delete(l.pointerId);
        break;
      case "gotpointercapture":
      case "lostpointercapture":
        Gf.delete(l.pointerId);
    }
  }
  function $u(o, l, p, y, E, A) {
    return o === null || o.nativeEvent !== A ? (o = {
      blockedOn: l,
      domEventName: p,
      eventSystemFlags: y,
      nativeEvent: A,
      targetContainers: [E]
    }, l !== null && (l = mn(l), l !== null && Wv(l)), o) : (o.eventSystemFlags |= y, l = o.targetContainers, E !== null && l.indexOf(E) === -1 && l.push(E), o);
  }
  function Jv(o, l, p, y, E) {
    switch (l) {
      case "focusin":
        return ql = $u(
          ql,
          o,
          l,
          p,
          y,
          E
        ), !0;
      case "dragenter":
        return Fl = $u(
          Fl,
          o,
          l,
          p,
          y,
          E
        ), !0;
      case "mouseover":
        return Ul = $u(
          Ul,
          o,
          l,
          p,
          y,
          E
        ), !0;
      case "pointerover":
        var A = E.pointerId;
        return Vf.set(
          A,
          $u(
            Vf.get(A) || null,
            o,
            l,
            p,
            y,
            E
          )
        ), !0;
      case "gotpointercapture":
        return A = E.pointerId, Gf.set(
          A,
          $u(
            Gf.get(A) || null,
            o,
            l,
            p,
            y,
            E
          )
        ), !0;
    }
    return !1;
  }
  function M0(o) {
    var l = Fs(o.target);
    if (l !== null) {
      var p = s(l);
      if (p !== null) {
        if (l = p.tag, l === 13) {
          if (l = a(p), l !== null) {
            o.blockedOn = l, po(o.priority, function() {
              Zv(p);
            });
            return;
          }
        } else if (l === 31) {
          if (l = u(p), l !== null) {
            o.blockedOn = l, po(o.priority, function() {
              Zv(p);
            });
            return;
          }
        } else if (l === 3 && p.stateNode.current.memoizedState.isDehydrated) {
          o.blockedOn = p.tag === 3 ? p.stateNode.containerInfo : null;
          return;
        }
      }
    }
    o.blockedOn = null;
  }
  function Fp(o) {
    if (o.blockedOn !== null) return !1;
    for (var l = o.targetContainers; 0 < l.length; ) {
      var p = A0(o.nativeEvent);
      if (p === null) {
        p = o.nativeEvent;
        var y = new p.constructor(
          p.type,
          p
        );
        Ks = y, p.target.dispatchEvent(y), Ks = null;
      } else
        return l = mn(p), l !== null && Wv(l), o.blockedOn = p, !1;
      l.shift();
    }
    return !0;
  }
  function e1(o, l, p) {
    Fp(o) && p.delete(l);
  }
  function A2() {
    R0 = !1, ql !== null && Fp(ql) && (ql = null), Fl !== null && Fp(Fl) && (Fl = null), Ul !== null && Fp(Ul) && (Ul = null), Vf.forEach(e1), Gf.forEach(e1);
  }
  function od(o, l) {
    o.blockedOn === l && (o.blockedOn = null, R0 || (R0 = !0, e.unstable_scheduleCallback(
      e.unstable_NormalPriority,
      A2
    )));
  }
  var Up = null;
  function t1(o) {
    Up !== o && (Up = o, e.unstable_scheduleCallback(
      e.unstable_NormalPriority,
      function() {
        Up === o && (Up = null);
        for (var l = 0; l < o.length; l += 3) {
          var p = o[l], y = o[l + 1], E = o[l + 2];
          if (typeof y != "function") {
            if (N0(y || p) === null)
              continue;
            break;
          }
          var A = mn(p);
          A !== null && (o.splice(l, 3), l -= 3, Al(
            A,
            {
              pending: !0,
              data: E,
              method: p.method,
              action: y
            },
            y,
            E
          ));
        }
      }
    ));
  }
  function ld(o) {
    function l(xe) {
      return od(xe, o);
    }
    ql !== null && od(ql, o), Fl !== null && od(Fl, o), Ul !== null && od(Ul, o), Vf.forEach(l), Gf.forEach(l);
    for (var p = 0; p < Hl.length; p++) {
      var y = Hl[p];
      y.blockedOn === o && (y.blockedOn = null);
    }
    for (; 0 < Hl.length && (p = Hl[0], p.blockedOn === null); )
      M0(p), p.blockedOn === null && Hl.shift();
    if (p = (o.ownerDocument || o).$$reactFormReplay, p != null)
      for (y = 0; y < p.length; y += 3) {
        var E = p[y], A = p[y + 1], B = E[ar] || null;
        if (typeof A == "function")
          B || t1(p);
        else if (B) {
          var ne = null;
          if (A && A.hasAttribute("formAction")) {
            if (E = A, B = A[ar] || null)
              ne = B.formAction;
            else if (N0(E) !== null) continue;
          } else ne = B.action;
          typeof ne == "function" ? p[y + 1] = ne : (p.splice(y, 3), y -= 3), t1(p);
        }
      }
  }
  function Li() {
    function o(A) {
      A.canIntercept && A.info === "react-transition" && A.intercept({
        handler: function() {
          return new Promise(function(B) {
            return E = B;
          });
        },
        focusReset: "manual",
        scroll: "manual"
      });
    }
    function l() {
      E !== null && (E(), E = null), y || setTimeout(p, 20);
    }
    function p() {
      if (!y && !navigation.transition) {
        var A = navigation.currentEntry;
        A && A.url != null && navigation.navigate(A.url, {
          state: A.getState(),
          info: "react-transition",
          history: "replace"
        });
      }
    }
    if (typeof navigation == "object") {
      var y = !1, E = null;
      return navigation.addEventListener("navigate", o), navigation.addEventListener("navigatesuccess", l), navigation.addEventListener("navigateerror", l), setTimeout(p, 100), function() {
        y = !0, navigation.removeEventListener("navigate", o), navigation.removeEventListener("navigatesuccess", l), navigation.removeEventListener("navigateerror", l), E !== null && (E(), E = null);
      };
    }
  }
  function Kf(o) {
    this._internalRoot = o;
  }
  Hp.prototype.render = Kf.prototype.render = function(o) {
    var l = this._internalRoot;
    if (l === null) throw Error(r(409));
    var p = l.current, y = ks();
    Kv(p, y, o, l, null, null);
  }, Hp.prototype.unmount = Kf.prototype.unmount = function() {
    var o = this._internalRoot;
    if (o !== null) {
      this._internalRoot = null;
      var l = o.containerInfo;
      Kv(o.current, 2, null, o, null, null), Sp(), l[Yr] = null;
    }
  };
  function Hp(o) {
    this._internalRoot = o;
  }
  Hp.prototype.unstable_scheduleHydration = function(o) {
    if (o) {
      var l = ho();
      o = { blockedOn: null, target: o, priority: l };
      for (var p = 0; p < Hl.length && l !== 0 && l < Hl[p].priority; p++) ;
      Hl.splice(p, 0, o), p === 0 && M0(o);
    }
  };
  var n1 = t.version;
  if (n1 !== "19.2.3")
    throw Error(
      r(
        527,
        n1,
        "19.2.3"
      )
    );
  ce.findDOMNode = function(o) {
    var l = o._reactInternals;
    if (l === void 0)
      throw typeof o.render == "function" ? Error(r(188)) : (o = Object.keys(o).join(","), Error(r(268, o)));
    return o = f(l), o = o !== null ? h(o) : null, o = o === null ? null : o.stateNode, o;
  };
  var N2 = {
    bundleType: 0,
    version: "19.2.3",
    rendererPackageName: "react-dom",
    currentDispatcherRef: X,
    reconcilerVersion: "19.2.3"
  };
  if (typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ < "u") {
    var Vp = __REACT_DEVTOOLS_GLOBAL_HOOK__;
    if (!Vp.isDisabled && Vp.supportsFiber)
      try {
        on = Vp.inject(
          N2
        ), Jt = Vp;
      } catch {
      }
  }
  return D0.createRoot = function(o, l) {
    if (!i(o)) throw Error(r(299));
    var p = !1, y = "", E = Og, A = Dg, B = qx;
    return l != null && (l.unstable_strictMode === !0 && (p = !0), l.identifierPrefix !== void 0 && (y = l.identifierPrefix), l.onUncaughtError !== void 0 && (E = l.onUncaughtError), l.onCaughtError !== void 0 && (A = l.onCaughtError), l.onRecoverableError !== void 0 && (B = l.onRecoverableError)), l = Vv(
      o,
      1,
      !1,
      null,
      null,
      p,
      y,
      null,
      E,
      A,
      B,
      Li
    ), o[Yr] = l.current, g0(o), new Kf(l);
  }, D0.hydrateRoot = function(o, l, p) {
    if (!i(o)) throw Error(r(299));
    var y = !1, E = "", A = Og, B = Dg, ne = qx, xe = null;
    return p != null && (p.unstable_strictMode === !0 && (y = !0), p.identifierPrefix !== void 0 && (E = p.identifierPrefix), p.onUncaughtError !== void 0 && (A = p.onUncaughtError), p.onCaughtError !== void 0 && (B = p.onCaughtError), p.onRecoverableError !== void 0 && (ne = p.onRecoverableError), p.formState !== void 0 && (xe = p.formState)), l = Vv(
      o,
      1,
      !0,
      l,
      p ?? null,
      y,
      E,
      xe,
      A,
      B,
      ne,
      Li
    ), l.context = Gv(null), p = l.current, y = ks(), y = fu(y), E = kl(y), E.callback = null, Ca(p, E, y), p = y, l.current.lanes = p, Ui(l, p), ro(l), o[Yr] = l.current, g0(o), new Hp(l);
  }, D0.version = "19.2.3", D0;
}
var cA;
function RU() {
  if (cA) return D2.exports;
  cA = 1;
  function e() {
    if (!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ > "u" || typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE != "function"))
      try {
        __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e);
      } catch (t) {
        console.error(t);
      }
  }
  return e(), D2.exports = /* @__PURE__ */ NU(), D2.exports;
}
var MU = /* @__PURE__ */ RU();
const pz = /* @__PURE__ */ jd(MU), OU = () => {
  if (document.getElementById("engram-font-preload")) return;
  [
    "https://fonts.googleapis.com/css2?family=Inter:wght@200;300;400;500;600&display=swap",
    "https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500&display=swap"
  ].forEach((t, n) => {
    const r = document.createElement("link");
    r.rel = "preload", r.as = "style", r.href = t, n === 0 && (r.id = "engram-font-preload"), document.head.appendChild(r);
    const i = document.createElement("link");
    i.rel = "stylesheet", i.href = t, document.head.appendChild(i);
  });
}, DU = () => (I.useEffect(() => {
  OU();
}, []), /* @__PURE__ */ c.jsx("style", { children: `
    :root {
      --font-sans: 'Inter', system-ui, -apple-system, sans-serif;
      --font-mono: 'JetBrains Mono', monospace;
    }

    body {
      font-family: var(--font-sans);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    
    .font-mono {
      font-family: var(--font-mono);
    }
    
    /* Custom Scrollbar for dark theme - Minimalist */
    ::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }
    ::-webkit-scrollbar-track {
      background: transparent;
    }
    ::-webkit-scrollbar-thumb {
      background: rgba(63, 63, 70, 0.4); /* zinc-700 with opacity */
      border-radius: 3px;
    }
    ::-webkit-scrollbar-thumb:hover {
      background: rgba(82, 82, 91, 0.6); /* zinc-600 with opacity */
    }

    /* Animation Utilities */
    .animate-float {
      animation: float 6s ease-in-out infinite;
    }
    .animate-in {
      animation: fadeIn 0.3s ease-out forwards;
    }
    .fade-in {
      opacity: 0;
      animation: fadeIn 0.3s ease-out forwards;
    }
    
    @keyframes float {
      0% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
      100% { transform: translateY(0px); }
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(5px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Utility to hide scrollbar but keep functionality */
    .no-scrollbar::-webkit-scrollbar {
      display: none;
    }
    .no-scrollbar {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
  ` }));
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const zU = (e) => e.replace(/([a-z0-9])([A-Z])/g, "$1-$2").toLowerCase(), PU = (e) => e.replace(
  /^([A-Z])|[\s-_]+(\w)/g,
  (t, n, r) => r ? r.toUpperCase() : n.toLowerCase()
), dA = (e) => {
  const t = PU(e);
  return t.charAt(0).toUpperCase() + t.slice(1);
}, mz = (...e) => e.filter((t, n, r) => !!t && t.trim() !== "" && r.indexOf(t) === n).join(" ").trim(), IU = (e) => {
  for (const t in e)
    if (t.startsWith("aria-") || t === "role" || t === "title")
      return !0;
};
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
var LU = {
  xmlns: "http://www.w3.org/2000/svg",
  width: 24,
  height: 24,
  viewBox: "0 0 24 24",
  fill: "none",
  stroke: "currentColor",
  strokeWidth: 2,
  strokeLinecap: "round",
  strokeLinejoin: "round"
};
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const BU = I.forwardRef(
  ({
    color: e = "currentColor",
    size: t = 24,
    strokeWidth: n = 2,
    absoluteStrokeWidth: r,
    className: i = "",
    children: s,
    iconNode: a,
    ...u
  }, d) => I.createElement(
    "svg",
    {
      ref: d,
      ...LU,
      width: t,
      height: t,
      stroke: e,
      strokeWidth: r ? Number(n) * 24 / Number(t) : n,
      className: mz("lucide", i),
      ...!s && !IU(u) && { "aria-hidden": "true" },
      ...u
    },
    [
      ...a.map(([f, h]) => I.createElement(f, h)),
      ...Array.isArray(s) ? s : [s]
    ]
  )
);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const pt = (e, t) => {
  const n = I.forwardRef(
    ({ className: r, ...i }, s) => I.createElement(BU, {
      ref: s,
      iconNode: t,
      className: mz(
        `lucide-${zU(dA(e))}`,
        `lucide-${e}`,
        r
      ),
      ...i
    })
  );
  return n.displayName = dA(e), n;
};
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const $U = [
  ["path", { d: "M12 17V3", key: "1cwfxf" }],
  ["path", { d: "m6 11 6 6 6-6", key: "12ii2o" }],
  ["path", { d: "M19 21H5", key: "150jfl" }]
], qU = pt("arrow-down-to-line", $U);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const FU = [
  ["path", { d: "m3 16 4 4 4-4", key: "1co6wj" }],
  ["path", { d: "M7 20V4", key: "1yoxec" }],
  ["path", { d: "m21 8-4-4-4 4", key: "1c9v7m" }],
  ["path", { d: "M17 4v16", key: "7dpous" }]
], UU = pt("arrow-down-up", FU);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const HU = [
  ["path", { d: "m12 19-7-7 7-7", key: "1l729n" }],
  ["path", { d: "M19 12H5", key: "x3x0zl" }]
], $b = pt("arrow-left", HU);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const VU = [
  ["path", { d: "M10.268 21a2 2 0 0 0 3.464 0", key: "vwvbt9" }],
  [
    "path",
    {
      d: "M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",
      key: "11g9vi"
    }
  ]
], GU = pt("bell", VU);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const KU = [
  ["path", { d: "M12 7v14", key: "1akyts" }],
  [
    "path",
    {
      d: "M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",
      key: "ruj8y"
    }
  ]
], F5 = pt("book-open", KU);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const YU = [
  [
    "path",
    {
      d: "M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",
      key: "k3hazp"
    }
  ]
], Ky = pt("book", YU);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const WU = [
  ["path", { d: "M12 8V4H8", key: "hb8ula" }],
  ["rect", { width: "16", height: "12", x: "4", y: "8", rx: "2", key: "enze0r" }],
  ["path", { d: "M2 14h2", key: "vft8re" }],
  ["path", { d: "M20 14h2", key: "4cs60a" }],
  ["path", { d: "M15 13v2", key: "1xurst" }],
  ["path", { d: "M9 13v2", key: "rq6x2g" }]
], gz = pt("bot", WU);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const ZU = [
  [
    "path",
    { d: "M8 3H7a2 2 0 0 0-2 2v5a2 2 0 0 1-2 2 2 2 0 0 1 2 2v5c0 1.1.9 2 2 2h1", key: "ezmyqa" }
  ],
  [
    "path",
    {
      d: "M16 21h1a2 2 0 0 0 2-2v-5c0-1.1.9-2 2-2a2 2 0 0 1-2-2V5a2 2 0 0 0-2-2h-1",
      key: "e1hn23"
    }
  ]
], yz = pt("braces", ZU);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const XU = [
  [
    "path",
    {
      d: "M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",
      key: "l5xja"
    }
  ],
  ["path", { d: "M9 13a4.5 4.5 0 0 0 3-4", key: "10igwf" }],
  ["path", { d: "M6.003 5.125A3 3 0 0 0 6.401 6.5", key: "105sqy" }],
  ["path", { d: "M3.477 10.896a4 4 0 0 1 .585-.396", key: "ql3yin" }],
  ["path", { d: "M6 18a4 4 0 0 1-1.967-.516", key: "2e4loj" }],
  ["path", { d: "M12 13h4", key: "1ku699" }],
  ["path", { d: "M12 18h6a2 2 0 0 1 2 2v1", key: "105ag5" }],
  ["path", { d: "M12 8h8", key: "1lhi5i" }],
  ["path", { d: "M16 8V5a2 2 0 0 1 2-2", key: "u6izg6" }],
  ["circle", { cx: "16", cy: "13", r: ".5", key: "ry7gng" }],
  ["circle", { cx: "18", cy: "3", r: ".5", key: "1aiba7" }],
  ["circle", { cx: "20", cy: "21", r: ".5", key: "yhc1fs" }],
  ["circle", { cx: "20", cy: "8", r: ".5", key: "1e43v0" }]
], fA = pt("brain-circuit", XU);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const QU = [
  ["path", { d: "M12 18V5", key: "adv99a" }],
  ["path", { d: "M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4", key: "1e3is1" }],
  ["path", { d: "M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5", key: "1gqd8o" }],
  ["path", { d: "M17.997 5.125a4 4 0 0 1 2.526 5.77", key: "iwvgf7" }],
  ["path", { d: "M18 18a4 4 0 0 0 2-7.464", key: "efp6ie" }],
  ["path", { d: "M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517", key: "1gq6am" }],
  ["path", { d: "M6 18a4 4 0 0 1-2-7.464", key: "k1g0md" }],
  ["path", { d: "M6.003 5.125a4 4 0 0 0-2.526 5.77", key: "q97ue3" }]
], xh = pt("brain", QU);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const JU = [
  ["path", { d: "M12 20v-9", key: "1qisl0" }],
  ["path", { d: "M14 7a4 4 0 0 1 4 4v3a6 6 0 0 1-12 0v-3a4 4 0 0 1 4-4z", key: "uouzyp" }],
  ["path", { d: "M14.12 3.88 16 2", key: "qol33r" }],
  ["path", { d: "M21 21a4 4 0 0 0-3.81-4", key: "1b0z45" }],
  ["path", { d: "M21 5a4 4 0 0 1-3.55 3.97", key: "5cxbf6" }],
  ["path", { d: "M22 13h-4", key: "1jl80f" }],
  ["path", { d: "M3 21a4 4 0 0 1 3.81-4", key: "1fjd4g" }],
  ["path", { d: "M3 5a4 4 0 0 0 3.55 3.97", key: "1d7oge" }],
  ["path", { d: "M6 13H2", key: "82j7cp" }],
  ["path", { d: "m8 2 1.88 1.88", key: "fmnt4t" }],
  ["path", { d: "M9 7.13V6a3 3 0 1 1 6 0v1.13", key: "1vgav8" }]
], xz = pt("bug", JU);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const eH = [
  ["rect", { width: "16", height: "20", x: "4", y: "2", rx: "2", key: "1nb95v" }],
  ["line", { x1: "8", x2: "16", y1: "6", y2: "6", key: "x4nwl0" }],
  ["line", { x1: "16", x2: "16", y1: "14", y2: "18", key: "wjye3r" }],
  ["path", { d: "M16 10h.01", key: "1m94wz" }],
  ["path", { d: "M12 10h.01", key: "1nrarc" }],
  ["path", { d: "M8 10h.01", key: "19clt8" }],
  ["path", { d: "M12 14h.01", key: "1etili" }],
  ["path", { d: "M8 14h.01", key: "6423bh" }],
  ["path", { d: "M12 18h.01", key: "mhygvu" }],
  ["path", { d: "M8 18h.01", key: "lrp35t" }]
], tH = pt("calculator", eH);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const nH = [["path", { d: "M20 6 9 17l-5-5", key: "1gmf2c" }]], vh = pt("check", nH);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const rH = [["path", { d: "m6 9 6 6 6-6", key: "qrunsl" }]], Yu = pt("chevron-down", rH);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const iH = [["path", { d: "m9 18 6-6-6-6", key: "mthhwq" }]], nc = pt("chevron-right", iH);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const sH = [
  ["circle", { cx: "12", cy: "12", r: "10", key: "1mglay" }],
  ["line", { x1: "12", x2: "12", y1: "8", y2: "12", key: "1pkeuh" }],
  ["line", { x1: "12", x2: "12.01", y1: "16", y2: "16", key: "4dfq90" }]
], _d = pt("circle-alert", sH);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const aH = [
  ["path", { d: "M21.801 10A10 10 0 1 1 17 3.335", key: "yps3ct" }],
  ["path", { d: "m9 11 3 3L22 4", key: "1pflzl" }]
], U5 = pt("circle-check-big", aH);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const oH = [
  ["circle", { cx: "12", cy: "12", r: "10", key: "1mglay" }],
  ["path", { d: "m9 12 2 2 4-4", key: "dzmm74" }]
], qb = pt("circle-check", oH);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const lH = [
  ["circle", { cx: "12", cy: "12", r: "10", key: "1mglay" }],
  ["path", { d: "M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3", key: "1u773s" }],
  ["path", { d: "M12 17h.01", key: "p32p05" }]
], uH = pt("circle-question-mark", lH);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const cH = [
  ["circle", { cx: "12", cy: "12", r: "10", key: "1mglay" }],
  ["path", { d: "m15 9-6 6", key: "1uzhvr" }],
  ["path", { d: "m9 9 6 6", key: "z0biqf" }]
], vz = pt("circle-x", cH);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const dH = [
  ["path", { d: "M12 6v6l4 2", key: "mmk7yg" }],
  ["circle", { cx: "12", cy: "12", r: "10", key: "1mglay" }]
], eb = pt("clock", dH);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const fH = [
  ["path", { d: "m10.852 19.772-.383.924", key: "r7sl7d" }],
  ["path", { d: "m13.148 14.228.383-.923", key: "1d5zpm" }],
  ["path", { d: "M13.148 19.772a3 3 0 1 0-2.296-5.544l-.383-.923", key: "1ydik7" }],
  ["path", { d: "m13.53 20.696-.382-.924a3 3 0 1 1-2.296-5.544", key: "1m1vsf" }],
  ["path", { d: "m14.772 15.852.923-.383", key: "660p6e" }],
  ["path", { d: "m14.772 18.148.923.383", key: "hrcpis" }],
  [
    "path",
    {
      d: "M4.2 15.1a7 7 0 1 1 9.93-9.858A7 7 0 0 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.2",
      key: "j2q98n"
    }
  ],
  ["path", { d: "m9.228 15.852-.923-.383", key: "1p9ong" }],
  ["path", { d: "m9.228 18.148-.923.383", key: "6558rz" }]
], hH = pt("cloud-cog", fH);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const pH = [
  ["path", { d: "M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z", key: "p7xjir" }]
], mH = pt("cloud", pH);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const gH = [
  [
    "path",
    { d: "M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3", key: "11bfej" }
  ]
], hA = pt("command", gH);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const yH = [
  ["rect", { width: "14", height: "14", x: "8", y: "8", rx: "2", ry: "2", key: "17jyea" }],
  ["path", { d: "M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2", key: "zix9uf" }]
], H5 = pt("copy", yH);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const xH = [
  ["path", { d: "M20 4v7a4 4 0 0 1-4 4H4", key: "6o5b7l" }],
  ["path", { d: "m9 10-5 5 5 5", key: "1kshq7" }]
], pA = pt("corner-down-left", xH);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const vH = [
  ["path", { d: "M12 20v2", key: "1lh1kg" }],
  ["path", { d: "M12 2v2", key: "tus03m" }],
  ["path", { d: "M17 20v2", key: "1rnc9c" }],
  ["path", { d: "M17 2v2", key: "11trls" }],
  ["path", { d: "M2 12h2", key: "1t8f8n" }],
  ["path", { d: "M2 17h2", key: "7oei6x" }],
  ["path", { d: "M2 7h2", key: "asdhe0" }],
  ["path", { d: "M20 12h2", key: "1q8mjw" }],
  ["path", { d: "M20 17h2", key: "1fpfkl" }],
  ["path", { d: "M20 7h2", key: "1o8tra" }],
  ["path", { d: "M7 20v2", key: "4gnj0m" }],
  ["path", { d: "M7 2v2", key: "1i4yhu" }],
  ["rect", { x: "4", y: "4", width: "16", height: "16", rx: "2", key: "1vbyd7" }],
  ["rect", { x: "8", y: "8", width: "8", height: "8", rx: "1", key: "z9xiuo" }]
], Yy = pt("cpu", vH);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const bH = [
  ["ellipse", { cx: "12", cy: "5", rx: "9", ry: "3", key: "msslwz" }],
  ["path", { d: "M3 5V19A9 3 0 0 0 21 19V5", key: "1wlel7" }],
  ["path", { d: "M3 12A9 3 0 0 0 21 12", key: "mv7ke4" }]
], kh = pt("database", bH);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const wH = [
  ["path", { d: "M12 15V3", key: "m9g1x1" }],
  ["path", { d: "M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4", key: "ih7n3h" }],
  ["path", { d: "m7 10 5 5 5-5", key: "brsn70" }]
], sy = pt("download", wH);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const _H = [
  ["path", { d: "M15 3h6v6", key: "1q9fwt" }],
  ["path", { d: "M10 14 21 3", key: "gplh6r" }],
  ["path", { d: "M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6", key: "a6xqqp" }]
], SH = pt("external-link", _H);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const EH = [
  [
    "path",
    {
      d: "M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",
      key: "1nclc0"
    }
  ],
  ["circle", { cx: "12", cy: "12", r: "3", key: "1v7zrd" }]
], mA = pt("eye", EH);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const CH = [
  [
    "path",
    {
      d: "M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",
      key: "1oefj6"
    }
  ],
  ["path", { d: "M14 2v5a1 1 0 0 0 1 1h5", key: "wfsgrz" }],
  ["path", { d: "M10 12.5 8 15l2 2.5", key: "1tg20x" }],
  ["path", { d: "m14 12.5 2 2.5-2 2.5", key: "yinavb" }]
], bz = pt("file-code", CH);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const kH = [
  [
    "path",
    {
      d: "M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",
      key: "1oefj6"
    }
  ],
  ["path", { d: "M14 2v5a1 1 0 0 0 1 1h5", key: "wfsgrz" }],
  ["path", { d: "M10 9H8", key: "b1mrlr" }],
  ["path", { d: "M16 13H8", key: "t4e002" }],
  ["path", { d: "M16 17H8", key: "z1uh3a" }]
], ru = pt("file-text", kH);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const TH = [
  [
    "path",
    {
      d: "M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",
      key: "sc7q7i"
    }
  ]
], wz = pt("funnel", TH);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const jH = [
  ["line", { x1: "6", x2: "6", y1: "3", y2: "15", key: "17qcm7" }],
  ["circle", { cx: "18", cy: "6", r: "3", key: "1h7g24" }],
  ["circle", { cx: "6", cy: "18", r: "3", key: "fqmcym" }],
  ["path", { d: "M18 9a9 9 0 0 1-9 9", key: "n2h4wq" }]
], AH = pt("git-branch", jH);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const NH = [
  [
    "path",
    {
      d: "M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",
      key: "tonef"
    }
  ],
  ["path", { d: "M9 18c-4.51 2-5-2-7-2", key: "9comsn" }]
], RH = pt("github", NH);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const MH = [
  ["circle", { cx: "9", cy: "12", r: "1", key: "1vctgf" }],
  ["circle", { cx: "9", cy: "5", r: "1", key: "hp0tcf" }],
  ["circle", { cx: "9", cy: "19", r: "1", key: "fkjjf6" }],
  ["circle", { cx: "15", cy: "12", r: "1", key: "1tmaij" }],
  ["circle", { cx: "15", cy: "5", r: "1", key: "19l28e" }],
  ["circle", { cx: "15", cy: "19", r: "1", key: "f4zoj3" }]
], _z = pt("grip-vertical", MH);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const OH = [
  ["line", { x1: "4", x2: "20", y1: "9", y2: "9", key: "4lhtct" }],
  ["line", { x1: "4", x2: "20", y1: "15", y2: "15", key: "vyu0kd" }],
  ["line", { x1: "10", x2: "8", y1: "3", y2: "21", key: "1ggp8o" }],
  ["line", { x1: "16", x2: "14", y1: "3", y2: "21", key: "weycgp" }]
], DH = pt("hash", OH);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const zH = [
  ["path", { d: "M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8", key: "5wwlr5" }],
  [
    "path",
    {
      d: "M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",
      key: "r6nss1"
    }
  ]
], PH = pt("house", zH);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const IH = [
  ["circle", { cx: "12", cy: "12", r: "10", key: "1mglay" }],
  ["path", { d: "M12 16v-4", key: "1dtifu" }],
  ["path", { d: "M12 8h.01", key: "e9boi3" }]
], Sz = pt("info", IH);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const LH = [
  ["path", { d: "m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4", key: "g0fldk" }],
  ["path", { d: "m21 2-9.6 9.6", key: "1j0ho8" }],
  ["circle", { cx: "7.5", cy: "15.5", r: "5.5", key: "yqb3hr" }]
], Fb = pt("key", LH);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const BH = [
  [
    "path",
    {
      d: "M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",
      key: "zw3jo"
    }
  ],
  [
    "path",
    {
      d: "M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",
      key: "1wduqc"
    }
  ],
  [
    "path",
    {
      d: "M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",
      key: "kqbvx6"
    }
  ]
], Em = pt("layers", BH);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const $H = [
  ["rect", { width: "7", height: "9", x: "3", y: "3", rx: "1", key: "10lvy0" }],
  ["rect", { width: "7", height: "5", x: "14", y: "3", rx: "1", key: "16une8" }],
  ["rect", { width: "7", height: "9", x: "14", y: "12", rx: "1", key: "1hutg5" }],
  ["rect", { width: "7", height: "5", x: "3", y: "16", rx: "1", key: "ldoo1y" }]
], qH = pt("layout-dashboard", $H);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const FH = [
  ["rect", { width: "7", height: "7", x: "3", y: "3", rx: "1", key: "1g98yp" }],
  ["rect", { width: "7", height: "7", x: "14", y: "3", rx: "1", key: "6d4xhi" }],
  ["rect", { width: "7", height: "7", x: "14", y: "14", rx: "1", key: "nxv5o0" }],
  ["rect", { width: "7", height: "7", x: "3", y: "14", rx: "1", key: "1bb6yr" }]
], UH = pt("layout-grid", FH);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const HH = [
  ["path", { d: "M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71", key: "1cjeqo" }],
  ["path", { d: "M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71", key: "19qd67" }]
], VH = pt("link", HH);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const GH = [
  ["path", { d: "M8 5h13", key: "1pao27" }],
  ["path", { d: "M13 12h8", key: "h98zly" }],
  ["path", { d: "M13 19h8", key: "c3s6r1" }],
  ["path", { d: "M3 10a2 2 0 0 0 2 2h3", key: "1npucw" }],
  ["path", { d: "M3 5v12a2 2 0 0 0 2 2h3", key: "x1gjn2" }]
], KH = pt("list-tree", GH);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const YH = [
  ["path", { d: "M3 5h.01", key: "18ugdj" }],
  ["path", { d: "M3 12h.01", key: "nlz23k" }],
  ["path", { d: "M3 19h.01", key: "noohij" }],
  ["path", { d: "M8 5h13", key: "1pao27" }],
  ["path", { d: "M8 12h13", key: "1za7za" }],
  ["path", { d: "M8 19h13", key: "m83p4d" }]
], WH = pt("list", YH);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const ZH = [["path", { d: "M21 12a9 9 0 1 1-6.219-8.56", key: "13zald" }]], rc = pt("loader-circle", ZH);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const XH = [
  ["path", { d: "M15 3h6v6", key: "1q9fwt" }],
  ["path", { d: "m21 3-7 7", key: "1l2asr" }],
  ["path", { d: "m3 21 7-7", key: "tjx5ai" }],
  ["path", { d: "M9 21H3v-6", key: "wtvkvv" }]
], QH = pt("maximize-2", XH);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const JH = [
  ["path", { d: "M4 5h16", key: "1tepv9" }],
  ["path", { d: "M4 12h16", key: "1lakjw" }],
  ["path", { d: "M4 19h16", key: "1djgab" }]
], eV = pt("menu", JH);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const tV = [
  [
    "path",
    {
      d: "M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",
      key: "18887p"
    }
  ]
], nV = pt("message-square", tV);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const rV = [
  ["path", { d: "m14 10 7-7", key: "oa77jy" }],
  ["path", { d: "M20 10h-6V4", key: "mjg0md" }],
  ["path", { d: "m3 21 7-7", key: "tjx5ai" }],
  ["path", { d: "M4 14h6v6", key: "rmj7iw" }]
], iV = pt("minimize-2", rV);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const sV = [
  [
    "path",
    {
      d: "M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",
      key: "kfwtm"
    }
  ]
], gA = pt("moon", sV);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const aV = [
  ["rect", { x: "16", y: "16", width: "6", height: "6", rx: "1", key: "4q2zg0" }],
  ["rect", { x: "2", y: "16", width: "6", height: "6", rx: "1", key: "8cvhb9" }],
  ["rect", { x: "9", y: "2", width: "6", height: "6", rx: "1", key: "1egb70" }],
  ["path", { d: "M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3", key: "1jsf9p" }],
  ["path", { d: "M12 12V8", key: "2874zd" }]
], V5 = pt("network", aV);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const oV = [
  ["path", { d: "M12 22v-9", key: "x3hkom" }],
  [
    "path",
    {
      d: "M15.17 2.21a1.67 1.67 0 0 1 1.63 0L21 4.57a1.93 1.93 0 0 1 0 3.36L8.82 14.79a1.655 1.655 0 0 1-1.64 0L3 12.43a1.93 1.93 0 0 1 0-3.36z",
      key: "2ntwy6"
    }
  ],
  [
    "path",
    {
      d: "M20 13v3.87a2.06 2.06 0 0 1-1.11 1.83l-6 3.08a1.93 1.93 0 0 1-1.78 0l-6-3.08A2.06 2.06 0 0 1 4 16.87V13",
      key: "1pmm1c"
    }
  ],
  [
    "path",
    {
      d: "M21 12.43a1.93 1.93 0 0 0 0-3.36L8.83 2.2a1.64 1.64 0 0 0-1.63 0L3 4.57a1.93 1.93 0 0 0 0 3.36l12.18 6.86a1.636 1.636 0 0 0 1.63 0z",
      key: "12ttoo"
    }
  ]
], lV = pt("package-open", oV);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const uV = [
  [
    "path",
    {
      d: "M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",
      key: "e79jfc"
    }
  ],
  ["circle", { cx: "13.5", cy: "6.5", r: ".5", fill: "currentColor", key: "1okk4w" }],
  ["circle", { cx: "17.5", cy: "10.5", r: ".5", fill: "currentColor", key: "f64h9f" }],
  ["circle", { cx: "6.5", cy: "12.5", r: ".5", fill: "currentColor", key: "qy21gx" }],
  ["circle", { cx: "8.5", cy: "7.5", r: ".5", fill: "currentColor", key: "fotxhn" }]
], a3 = pt("palette", uV);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const cV = [
  ["rect", { x: "14", y: "3", width: "5", height: "18", rx: "1", key: "kaeet6" }],
  ["rect", { x: "5", y: "3", width: "5", height: "18", rx: "1", key: "1wsw3u" }]
], Ez = pt("pause", cV);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const dV = [
  [
    "path",
    {
      d: "M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",
      key: "1a8usu"
    }
  ]
], fV = pt("pen", dV);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const hV = [
  [
    "path",
    {
      d: "M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",
      key: "10ikf1"
    }
  ]
], Sd = pt("play", hV);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const pV = [
  ["path", { d: "M5 12h14", key: "1ays0h" }],
  ["path", { d: "M12 5v14", key: "s699le" }]
], Ub = pt("plus", pV);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const mV = [
  ["path", { d: "M12 2v10", key: "mnfbl" }],
  ["path", { d: "M18.4 6.6a9 9 0 1 1-12.77.04", key: "obofu9" }]
], Hb = pt("power", mV);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const gV = [
  ["path", { d: "M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8", key: "v9h5vc" }],
  ["path", { d: "M21 3v5h-5", key: "1q7to0" }],
  ["path", { d: "M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16", key: "3uifl3" }],
  ["path", { d: "M8 16H3v5", key: "1cv678" }]
], fr = pt("refresh-cw", gV);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const yV = [
  ["path", { d: "M17 3v10", key: "15fgeh" }],
  ["path", { d: "m12.67 5.5 8.66 5", key: "1gpheq" }],
  ["path", { d: "m12.67 10.5 8.66-5", key: "1dkfa6" }],
  [
    "path",
    { d: "M9 17a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h2a2 2 0 0 0 2-2v-2z", key: "swwfx4" }
  ]
], Cz = pt("regex", yV);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const xV = [
  ["path", { d: "M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8", key: "1357e3" }],
  ["path", { d: "M3 3v5h5", key: "1xhq8a" }]
], G5 = pt("rotate-ccw", xV);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const vV = [
  [
    "path",
    {
      d: "M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",
      key: "1c8476"
    }
  ],
  ["path", { d: "M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7", key: "1ydtos" }],
  ["path", { d: "M7 3v4a1 1 0 0 0 1 1h7", key: "t51u73" }]
], eh = pt("save", vV);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const bV = [
  ["circle", { cx: "6", cy: "6", r: "3", key: "1lh9wr" }],
  ["path", { d: "M8.12 8.12 12 12", key: "1alkpv" }],
  ["path", { d: "M20 4 8.12 15.88", key: "xgtan2" }],
  ["circle", { cx: "6", cy: "18", r: "3", key: "fqmcym" }],
  ["path", { d: "M14.8 14.8 20 20", key: "ptml3r" }]
], wV = pt("scissors", bV);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const _V = [
  ["path", { d: "M15 12h-5", key: "r7krc0" }],
  ["path", { d: "M15 8h-5", key: "1khuty" }],
  ["path", { d: "M19 17V5a2 2 0 0 0-2-2H4", key: "zz82l3" }],
  [
    "path",
    {
      d: "M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",
      key: "1ph1d7"
    }
  ]
], SV = pt("scroll-text", _V);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const EV = [
  ["path", { d: "m21 21-4.34-4.34", key: "14j7rj" }],
  ["circle", { cx: "11", cy: "11", r: "8", key: "4ej97u" }]
], Ai = pt("search", EV);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const CV = [
  [
    "path",
    {
      d: "M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",
      key: "1ffxy3"
    }
  ],
  ["path", { d: "m21.854 2.147-10.94 10.939", key: "12cjpa" }]
], kV = pt("send", CV);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const TV = [
  ["rect", { width: "20", height: "8", x: "2", y: "2", rx: "2", ry: "2", key: "ngkwjq" }],
  ["rect", { width: "20", height: "8", x: "2", y: "14", rx: "2", ry: "2", key: "iecqi9" }],
  ["line", { x1: "6", x2: "6.01", y1: "6", y2: "6", key: "16zg32" }],
  ["line", { x1: "6", x2: "6.01", y1: "18", y2: "18", key: "nzw8ys" }]
], o3 = pt("server", TV);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const jV = [
  [
    "path",
    {
      d: "M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",
      key: "1i5ecw"
    }
  ],
  ["circle", { cx: "12", cy: "12", r: "3", key: "1v7zrd" }]
], Cm = pt("settings", jV);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const AV = [
  ["path", { d: "M10 8h4", key: "1sr2af" }],
  ["path", { d: "M12 21v-9", key: "17s77i" }],
  ["path", { d: "M12 8V3", key: "13r4qs" }],
  ["path", { d: "M17 16h4", key: "h1uq16" }],
  ["path", { d: "M19 12V3", key: "o1uvq1" }],
  ["path", { d: "M19 21v-5", key: "qua636" }],
  ["path", { d: "M3 14h4", key: "bcjad9" }],
  ["path", { d: "M5 10V3", key: "cb8scm" }],
  ["path", { d: "M5 21v-7", key: "1w1uti" }]
], yA = pt("sliders-vertical", AV);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const NV = [
  [
    "path",
    {
      d: "M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",
      key: "1s2grr"
    }
  ],
  ["path", { d: "M20 2v4", key: "1rf3ol" }],
  ["path", { d: "M22 4h-4", key: "gwowj6" }],
  ["circle", { cx: "4", cy: "20", r: "2", key: "6kqj1y" }]
], kz = pt("sparkles", NV);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const RV = [
  ["rect", { width: "18", height: "18", x: "3", y: "3", rx: "2", key: "afitv7" }]
], Tz = pt("square", RV);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const MV = [
  ["circle", { cx: "12", cy: "12", r: "4", key: "4exip2" }],
  ["path", { d: "M12 2v2", key: "tus03m" }],
  ["path", { d: "M12 20v2", key: "1lh1kg" }],
  ["path", { d: "m4.93 4.93 1.41 1.41", key: "149t6j" }],
  ["path", { d: "m17.66 17.66 1.41 1.41", key: "ptbguv" }],
  ["path", { d: "M2 12h2", key: "1t8f8n" }],
  ["path", { d: "M20 12h2", key: "1q8mjw" }],
  ["path", { d: "m6.34 17.66-1.41 1.41", key: "1m8zz5" }],
  ["path", { d: "m19.07 4.93-1.41 1.41", key: "1shlcs" }]
], OV = pt("sun", MV);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const DV = [
  ["circle", { cx: "12", cy: "12", r: "10", key: "1mglay" }],
  ["circle", { cx: "12", cy: "12", r: "6", key: "1vlfrh" }],
  ["circle", { cx: "12", cy: "12", r: "2", key: "1c9p78" }]
], K5 = pt("target", DV);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const zV = [
  ["path", { d: "M12 19h8", key: "baeox8" }],
  ["path", { d: "m4 17 6-6-6-6", key: "1yngyt" }]
], Wy = pt("terminal", zV);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const PV = [
  ["path", { d: "M10 11v6", key: "nco0om" }],
  ["path", { d: "M14 11v6", key: "outv1u" }],
  ["path", { d: "M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6", key: "miytrc" }],
  ["path", { d: "M3 6h18", key: "d0wm0j" }],
  ["path", { d: "M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2", key: "e791ji" }]
], pa = pt("trash-2", PV);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const IV = [
  [
    "path",
    {
      d: "m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",
      key: "wmoenq"
    }
  ],
  ["path", { d: "M12 9v4", key: "juzpu7" }],
  ["path", { d: "M12 17h.01", key: "p32p05" }]
], km = pt("triangle-alert", IV);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const LV = [
  ["path", { d: "M12 3v12", key: "1x0j5s" }],
  ["path", { d: "m17 8-5-5-5 5", key: "7q97r8" }],
  ["path", { d: "M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4", key: "ih7n3h" }]
], jz = pt("upload", LV);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const BV = [
  ["path", { d: "M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2", key: "1yyitq" }],
  ["path", { d: "M16 3.128a4 4 0 0 1 0 7.744", key: "16gr8j" }],
  ["path", { d: "M22 21v-2a4 4 0 0 0-3-3.87", key: "kshegd" }],
  ["circle", { cx: "9", cy: "7", r: "4", key: "nufk8" }]
], Az = pt("users", BV);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const $V = [
  [
    "path",
    {
      d: "m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",
      key: "ul74o6"
    }
  ],
  ["path", { d: "m14 7 3 3", key: "1r5n42" }],
  ["path", { d: "M5 6v4", key: "ilb8ba" }],
  ["path", { d: "M19 14v4", key: "blhpug" }],
  ["path", { d: "M10 2v2", key: "7u0qdc" }],
  ["path", { d: "M7 8H3", key: "zfb6yr" }],
  ["path", { d: "M21 16h-4", key: "1cnmox" }],
  ["path", { d: "M11 3H9", key: "1obp7u" }]
], Nz = pt("wand-sparkles", $V);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const qV = [
  ["path", { d: "M18 6 6 18", key: "1bl5f8" }],
  ["path", { d: "m6 6 12 12", key: "d8bk6v" }]
], Wu = pt("x", qV);
/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const FV = [
  [
    "path",
    {
      d: "M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",
      key: "1xq2db"
    }
  ]
], Zu = pt("zap", FV);
var Rz = /* @__PURE__ */ hz();
const Vb = /* @__PURE__ */ jd(Rz);
function xA(e) {
  const t = {
    blockquote: "blockquote",
    h1: "h1",
    h2: "h2",
    hr: "hr",
    li: "li",
    p: "p",
    strong: "strong",
    ul: "ul",
    ...e.components
  };
  return c.jsxs(c.Fragment, {
    children: [c.jsx(t.h1, {
      children: " Engram"
    }), `
`, c.jsxs(t.blockquote, {
      children: [`
`, c.jsxs(t.p, {
        children: [c.jsx(t.strong, {
          children: "Engram"
        }), "  SillyTavern "]
      }), `
`]
    }), `
`, c.jsx(t.hr, {}), `
`, c.jsx(t.h2, {
      children: ""
    }), `
`, c.jsx(t.p, {
      children: "Engram "
    }), `
`, c.jsxs("div", {
      className: "grid grid-cols-1 md:grid-cols-2 gap-4 my-6",
      children: [c.jsxs("div", {
        className: "p-4 border border-border rounded-lg bg-card",
        children: [c.jsxs("div", {
          className: "flex items-center gap-2 mb-2 text-primary font-bold",
          children: [c.jsx(xh, {
            className: "w-5 h-5"
          }), c.jsx("span", {
            children: " (Consolidation)"
          })]
        }), c.jsxs("ul", {
          className: "text-sm text-muted-foreground list-disc pl-4 space-y-1",
          children: [c.jsx("li", {
            children: ""
          }), c.jsx("li", {
            children: " 10  LLM "
          }), c.jsx("li", {
            children: " IndexedDB"
          })]
        })]
      }), c.jsxs("div", {
        className: "p-4 border border-border rounded-lg bg-card",
        children: [c.jsxs("div", {
          className: "flex items-center gap-2 mb-2 text-primary font-bold",
          children: [c.jsx(V5, {
            className: "w-5 h-5"
          }), c.jsx("span", {
            children: " (Retrieval)"
          })]
        }), c.jsxs("ul", {
          className: "text-sm text-muted-foreground list-disc pl-4 space-y-1",
          children: [c.jsx("li", {
            children: ""
          }), c.jsx("li", {
            children: ""
          }), c.jsx("li", {
            children: " Top-K  Prompt "
          })]
        })]
      })]
    }), `
`, c.jsx(t.h2, {
      children: ""
    }), `
`, c.jsxs(t.ul, {
      children: [`
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: ""
        }), " IndexedDB "]
      }), `
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: "API "
        }), " OpenAI  Ollama"]
      }), `
`]
    })]
  });
}
function UV(e = {}) {
  const { wrapper: t } = e.components || {};
  return t ? c.jsx(t, {
    ...e,
    children: c.jsx(xA, {
      ...e
    })
  }) : xA(e);
}
function vA(e) {
  const t = {
    blockquote: "blockquote",
    code: "code",
    h1: "h1",
    h2: "h2",
    h3: "h3",
    hr: "hr",
    li: "li",
    ol: "ol",
    p: "p",
    strong: "strong",
    table: "table",
    tbody: "tbody",
    td: "td",
    th: "th",
    thead: "thead",
    tr: "tr",
    ul: "ul",
    ...e.components
  };
  return c.jsxs(c.Fragment, {
    children: [c.jsx(t.h1, {
      children: ""
    }), `
`, c.jsxs(t.blockquote, {
      children: [`
`, c.jsx(t.p, {
        children: "Engram "
      }), `
`]
    }), `
`, c.jsx(t.hr, {}), `
`, c.jsx(t.h2, {
      children: "1. "
    }), `
`, c.jsxs(t.p, {
      children: [" ", c.jsx(t.strong, {
        children: "API "
      }), " "]
    }), `
`, c.jsx(t.h3, {
      children: ""
    }), `
`, c.jsxs(t.ul, {
      children: [`
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: "LLM "
        }), ":  ", c.jsx(t.code, {
          children: "gemini-3-flash"
        }), "  ", c.jsx(t.code, {
          children: "deepseek-v3.2"
        }), " "]
      }), `
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: ""
        }), ":  RAG  ", c.jsx(t.code, {
          children: "Qwen/Qwen3-Embedding-8B"
        }), ""]
      }), `
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: "Rerank"
        }), ": ()  Rerank  ", c.jsx(t.code, {
          children: "Qwen/Qwen3-Reranker-8B"
        }), ""]
      }), `
`]
    }), `
`, c.jsx(t.h2, {
      children: "2. "
    }), `
`, c.jsxs(t.p, {
      children: [" ", c.jsx(t.strong, {
        children: "API "
      }), " "]
    }), `
`, c.jsxs(t.h3, {
      children: [c.jsx(bz, {
        className: "inline-block w-4 h-4 align-text-bottom"
      }), " "]
    }), `
`, c.jsx(t.p, {
      children: "Engram  Prompt "
    }), `
`, c.jsxs(t.ul, {
      children: [`
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: ""
        }), ":  ", c.jsx(t.code, {
          children: ""
        }), "  System Prompt"]
      }), `
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: ""
        }), ": ", c.jsx(t.code, {
          children: ""
        }), '  JSON  "profile"  JSON ']
      }), `
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: ""
        }), ":  ", c.jsx(t.code, {
          children: ""
        }), ' ""']
      }), `
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: "Engram "
        }), ":  user "]
      }), `
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: ""
        }), ": "]
      }), `
`]
    }), `
`, c.jsxs(t.h3, {
      children: [c.jsx(Ky, {
        className: "inline-block w-4 h-4 align-text-bottom"
      }), " "]
    }), `
`, c.jsxs(t.ul, {
      children: [`
`, c.jsxs(t.li, {
        children: [" ", c.jsx(t.strong, {
          children: "Global Worldbook"
        }), " ()"]
      }), `
`, c.jsx(t.li, {
        children: ""
      }), `
`]
    }), `
`, c.jsx(t.h3, {
      children: ""
    }), `
`, c.jsx(t.p, {
      children: "Engram "
    }), `
`, c.jsxs(t.ul, {
      children: [`
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: ""
        }), ': "" Engram  Prompt']
      }), `
`]
    }), `
`, c.jsx(t.h2, {
      children: "3. "
    }), `
`, c.jsxs(t.p, {
      children: [" ", c.jsx(t.strong, {
        children: ""
      }), " "]
    }), `
`, c.jsxs(t.table, {
      children: [c.jsx(t.thead, {
        children: c.jsxs(t.tr, {
          children: [c.jsx(t.th, {
            style: {
              textAlign: "left"
            },
            children: ""
          }), c.jsx(t.th, {
            style: {
              textAlign: "left"
            },
            children: ""
          })]
        })
      }), c.jsxs(t.tbody, {
        children: [c.jsxs(t.tr, {
          children: [c.jsx(t.td, {
            style: {
              textAlign: "left"
            },
            children: c.jsx(t.strong, {
              children: ""
            })
          }), c.jsx(t.td, {
            style: {
              textAlign: "left"
            },
            children: ""
          })]
        }), c.jsxs(t.tr, {
          children: [c.jsx(t.td, {
            style: {
              textAlign: "left"
            },
            children: c.jsx(t.strong, {
              children: "RAG "
            })
          }), c.jsx(t.td, {
            style: {
              textAlign: "left"
            },
            children: ""
          })]
        }), c.jsxs(t.tr, {
          children: [c.jsx(t.td, {
            style: {
              textAlign: "left"
            },
            children: c.jsx(t.strong, {
              children: ""
            })
          }), c.jsxs(t.td, {
            style: {
              textAlign: "left"
            },
            children: [" Prompt  Token ", c.jsx(t.strong, {
              children: ""
            }), "  ", c.jsx(t.strong, {
              children: ""
            }), " "]
          })]
        })]
      })]
    }), `
`, c.jsx(t.h2, {
      children: "4. "
    }), `
`, c.jsxs(t.p, {
      children: [" ", c.jsx(t.strong, {
        children: ""
      }), ""]
    }), `
`, c.jsxs(t.ol, {
      children: [`
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: ""
        }), ':  "Running"']
      }), `
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: "RAG "
        }), ": ", c.jsx(t.strong, {
          children: ""
        }), "  ", c.jsx(t.strong, {
          children: ""
        }), " "]
      }), `
`]
    })]
  });
}
function HV(e = {}) {
  const { wrapper: t } = e.components || {};
  return t ? c.jsx(t, {
    ...e,
    children: c.jsx(vA, {
      ...e
    })
  }) : vA(e);
}
function bA(e) {
  const t = {
    blockquote: "blockquote",
    code: "code",
    h1: "h1",
    h2: "h2",
    h3: "h3",
    hr: "hr",
    li: "li",
    p: "p",
    strong: "strong",
    ul: "ul",
    ...e.components
  };
  return c.jsxs(c.Fragment, {
    children: [c.jsx(t.h1, {
      children: ""
    }), `
`, c.jsxs(t.blockquote, {
      children: [`
`, c.jsx(t.p, {
        children: "Engram "
      }), `
`]
    }), `
`, c.jsx(t.hr, {}), `
`, c.jsxs(t.h2, {
      children: [c.jsx(Ai, {
        className: "inline-block w-4 h-4 align-text-bottom"
      }), " "]
    }), `
`, c.jsxs(t.p, {
      children: [" ", c.jsx(t.code, {
        children: "/"
      }), " "]
    }), `
`, c.jsxs(t.ul, {
      children: [`
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: ""
        }), ":  ", c.jsx(t.code, {
          children: ""
        }), ", ", c.jsx(t.code, {
          children: ""
        }), ""]
      }), `
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: ""
        }), ": "]
      }), `
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: ""
        }), ":  ", c.jsx(t.code, {
          children: "Theme: Twitter Dark"
        }), ""]
      }), `
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: ""
        }), ": "]
      }), `
`]
    }), `
`, c.jsx(t.hr, {}), `
`, c.jsxs(t.h2, {
      children: [c.jsx(xh, {
        className: "inline-block w-4 h-4 align-text-bottom"
      }), " "]
    }), `
`, c.jsxs(t.p, {
      children: ["Engram  ", c.jsx(t.strong, {
        children: " (BrainRecallCache)"
      }), " "]
    }), `
`, c.jsx(t.h3, {
      children: "1. "
    }), `
`, c.jsx(t.p, {
      children: ""
    }), `
`, c.jsx(t.h3, {
      children: '2. ""'
    }), `
`, c.jsxs(t.p, {
      children: [" 3  ", c.jsx(t.strong, {
        children: ""
      }), " (Penalty) AI "]
    }), `
`, c.jsx(t.hr, {}), `
`, c.jsxs(t.h2, {
      children: [c.jsx(Em, {
        className: "inline-block w-4 h-4 align-text-bottom"
      }), " "]
    }), `
`, c.jsxs(t.p, {
      children: [" ", c.jsx(t.strong, {
        children: ""
      }), "  ", c.jsx(t.strong, {
        children: ""
      }), " "]
    }), `
`, c.jsx(t.h3, {
      children: ""
    }), `
`, c.jsx(t.p, {
      children: " Engram"
    }), `
`, c.jsxs(t.h3, {
      children: [c.jsx(ru, {
        className: "inline-block w-4 h-4 align-text-bottom"
      }), " "]
    }), `
`, c.jsxs(t.p, {
      children: [" ", c.jsx(t.code, {
        children: ".txt"
      }), "  ", c.jsx(t.code, {
        children: ".md"
      }), " "]
    }), `
`, c.jsxs(t.ul, {
      children: [`
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: ""
        }), `:
`]
      }), `
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: ""
        }), `:
 LLM  Token`]
      }), `
`]
    }), `
`, c.jsx(t.hr, {}), `
`, c.jsxs(t.h2, {
      children: [c.jsx(kh, {
        className: "inline-block w-4 h-4 align-text-bottom"
      }), " "]
    }), `
`, c.jsxs(t.p, {
      children: [" ", c.jsx(t.strong, {
        children: ""
      }), " "]
    }), `
`, c.jsxs(t.ul, {
      children: [`
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: ""
        }), ": "]
      }), `
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: ""
        }), ": "]
      }), `
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: ""
        }), ": "]
      }), `
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: ""
        }), ":  ", c.jsx(t.strong, {
          children: "Re-embed"
        }), " "]
      }), `
`]
    })]
  });
}
function VV(e = {}) {
  const { wrapper: t } = e.components || {};
  return t ? c.jsx(t, {
    ...e,
    children: c.jsx(bA, {
      ...e
    })
  }) : bA(e);
}
function wA(e) {
  const t = {
    blockquote: "blockquote",
    code: "code",
    h1: "h1",
    h2: "h2",
    h3: "h3",
    h4: "h4",
    hr: "hr",
    li: "li",
    ol: "ol",
    p: "p",
    strong: "strong",
    ul: "ul",
    ...e.components
  };
  return c.jsxs(c.Fragment, {
    children: [c.jsx(t.h1, {
      children: " (FAQ)"
    }), `
`, c.jsx(t.hr, {}), `
`, c.jsxs(t.p, {
      children: ["Engram ", c.jsx(t.strong, {
        children: ""
      }), ""]
    }), `
`, c.jsx(t.h2, {
      children: " "
    }), `
`, c.jsxs(t.p, {
      children: [" Bug  Engram  ", c.jsx(t.strong, {
        children: ""
      }), " "]
    }), `
`, c.jsx(t.h3, {
      children: "1.  / "
    }), `
`, c.jsxs(t.blockquote, {
      children: [`
`, c.jsxs(t.p, {
        children: [c.jsx(t.strong, {
          children: ""
        }), ": "]
      }), `
`]
    }), `
`, c.jsxs(t.ul, {
      children: [`
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: ""
        }), ": ", c.jsx(xz, {
          className: "inline w-4 h-4 mb-1"
        }), " ", c.jsx(t.strong, {
          children: ""
        })]
      }), `
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: ""
        }), ":", `
`, c.jsxs(t.ul, {
          children: [`
`, c.jsxs(t.li, {
            children: [" ", c.jsx(t.code, {
              children: "ERROR"
            }), " "]
          }), `
`, c.jsx(t.li, {
            children: " IndexedDB SillyTavern "
          }), `
`, c.jsxs(t.li, {
            children: [c.jsx(t.strong, {
              children: ""
            }), ": "]
          }), `
`]
        }), `
`]
      }), `
`]
    }), `
`, c.jsx(t.h3, {
      children: "2.  / "
    }), `
`, c.jsxs(t.blockquote, {
      children: [`
`, c.jsxs(t.p, {
        children: [c.jsx(t.strong, {
          children: ""
        }), ": /"]
      }), `
`]
    }), `
`, c.jsxs(t.ul, {
      children: [`
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: ""
        }), ": ", c.jsx(Yy, {
          className: "inline w-4 h-4 mb-1"
        }), " ", c.jsx(t.strong, {
          children: ""
        })]
      }), `
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: ""
        }), ":", `
`, c.jsxs(t.ul, {
          children: [`
`, c.jsxs(t.li, {
            children: [c.jsx(t.strong, {
              children: ""
            }), ":  ", c.jsx(t.strong, {
              children: ""
            }), "  ", c.jsx(t.strong, {
              children: ""
            }), " "]
          }), `
`, c.jsxs(t.li, {
            children: [c.jsx(t.strong, {
              children: "Prompt "
            }), ":  LLM  Prompt"]
          }), `
`, c.jsxs(t.li, {
            children: [c.jsx(t.strong, {
              children: "Response "
            }), ":  LLM  ", c.jsx(t.code, {
              children: "404"
            }), "  ", c.jsx(t.code, {
              children: "Connection Refused"
            }), " API  JSON  ", c.jsx(t.strong, {
              children: ""
            }), ""]
          }), `
`]
        }), `
`]
      }), `
`]
    }), `
`, c.jsx(t.h3, {
      children: "3.  (RAG )"
    }), `
`, c.jsxs(t.blockquote, {
      children: [`
`, c.jsxs(t.p, {
        children: [c.jsx(t.strong, {
          children: ""
        }), ": AI "]
      }), `
`]
    }), `
`, c.jsxs(t.ul, {
      children: [`
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: ""
        }), ": ", c.jsx(kh, {
          className: "inline w-4 h-4 mb-1"
        }), " ", c.jsx(t.strong, {
          children: ""
        })]
      }), `
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: ""
        }), ":", `
`, c.jsxs(t.ul, {
          children: [`
`, c.jsxs(t.li, {
            children: [c.jsx(t.strong, {
              children: "Query "
            }), ": "]
          }), `
`, c.jsxs(t.li, {
            children: [c.jsx(t.strong, {
              children: "Score "
            }), ": < 0.3"]
          }), `
`, c.jsxs(t.li, {
            children: [c.jsx(t.strong, {
              children: ""
            }), ":  AI  LLM  LLM "]
          }), `
`]
        }), `
`]
      }), `
`]
    }), `
`, c.jsx(t.hr, {}), `
`, c.jsx(t.h2, {
      children: " "
    }), `
`, c.jsxs(t.h3, {
      children: [c.jsx(km, {
        className: "inline w-5 h-5 mb-1 text-yellow-500"
      }), " "]
    }), `
`, c.jsx(t.h4, {
      children: 'Q: "" API  (404/Connection Refused)'
    }), `
`, c.jsxs(t.ul, {
      children: [`
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: ""
        }), ": Engram  LLM "]
      }), `
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: ""
        }), ":", `
`, c.jsxs(t.ol, {
          children: [`
`, c.jsxs(t.li, {
            children: [" ", c.jsx(t.strong, {
              children: "API Base URL"
            }), "  ", c.jsx(t.code, {
              children: "/v1"
            }), " ", c.jsx(t.code, {
              children: "http://127.0.0.1:11434/v1"
            }), ""]
          }), `
`, c.jsxs(t.li, {
            children: [c.jsx(t.strong, {
              children: "CORS "
            }), ":  F12 CORS  API  Ollama, LM Studio ", c.jsx(t.code, {
              children: 'OLLAMA_ORIGINS="*"'
            }), ""]
          }), `
`, c.jsxs(t.li, {
            children: [c.jsx(t.strong, {
              children: "API Key"
            }), ":  Key  ", c.jsx(t.code, {
              children: "sk-test"
            }), ""]
          }), `
`]
        }), `
`]
      }), `
`]
    }), `
`, c.jsx(t.h4, {
      children: "Q: "
    }), `
`, c.jsxs(t.ul, {
      children: [`
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: ""
        }), ": "]
      }), `
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: ""
        }), ":  ", c.jsx(t.strong, {
          children: ""
        }), "  ", c.jsxs(t.strong, {
          children: [c.jsx(Ai, {
            className: "inline w-3 h-3"
          }), " Re-embed"]
        }), " "]
      }), `
`]
    }), `
`, c.jsxs(t.h3, {
      children: [c.jsx(ru, {
        className: "inline w-5 h-5 mb-1 text-blue-500"
      }), " "]
    }), `
`, c.jsx(t.h4, {
      children: "Q: "
    }), `
`, c.jsxs(t.ul, {
      children: [`
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: ""
        }), ":  LLM Engram "]
      }), `
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: ""
        }), ":", `
`, c.jsxs(t.ol, {
          children: [`
`, c.jsxs(t.li, {
            children: [c.jsx(t.strong, {
              children: ""
            }), ":  5-10  ", c.jsx(t.strong, {
              children: ""
            }), " "]
          }), `
`, c.jsxs(t.li, {
            children: [c.jsx(t.strong, {
              children: ""
            }), ": "]
          }), `
`, c.jsxs(t.li, {
            children: [c.jsx(t.strong, {
              children: "Token "
            }), ":  Prompt "]
          }), `
`]
        }), `
`]
      }), `
`]
    }), `
`, c.jsx(t.h4, {
      children: "Q:  RAG "
    }), `
`, c.jsxs(t.ul, {
      children: [`
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: ""
        }), ": Engram  Embedding Rerank"]
      }), `
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: ""
        }), ":", `
`, c.jsxs(t.ul, {
          children: [`
`, c.jsxs(t.li, {
            children: [" ", c.jsx(t.strong, {
              children: "Transformers.js"
            }), "  ", c.jsx(t.strong, {
              children: "API "
            }), "  ", c.jsx(t.strong, {
              children: ""
            }), "  ", c.jsx(t.code, {
              children: "Transformers ()"
            }), " WebGPU "]
          }), `
`, c.jsx(t.li, {
            children: " Rerank "
          }), `
`]
        }), `
`]
      }), `
`]
    }), `
`, c.jsx(t.h4, {
      children: "Q: "
    }), `
`, c.jsxs(t.ul, {
      children: [`
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: ""
        }), ":  Engram  ", c.jsx(t.strong, {
          children: "IndexedDB"
        }), " "]
      }), `
`, c.jsxs(t.li, {
        children: [c.jsx(t.strong, {
          children: ""
        }), ":  IndexedDB "]
      }), `
`]
    }), `
`, c.jsx(t.hr, {})]
  });
}
function GV(e = {}) {
  const { wrapper: t } = e.components || {};
  return t ? c.jsx(t, {
    ...e,
    children: c.jsx(wA, {
      ...e
    })
  }) : wA(e);
}
const Jp = [
  {
    id: "intro",
    label: "",
    icon: xh,
    component: UV,
    keywords: ["", "intro", "", "about", ""],
    description: " Engram "
  },
  {
    id: "getting-started",
    label: "",
    icon: Sd,
    component: HV,
    keywords: ["", "setup", "", "start", "api"],
    description: "Engram "
  },
  {
    id: "features",
    label: "",
    icon: Cm,
    component: VV,
    keywords: ["", "feature", "rag", "", "summary", "vector", "edit"],
    description: "RAG "
  },
  {
    id: "faq",
    label: "",
    icon: uH,
    component: GV,
    keywords: ["faq", "", "help", "", "error", "debug"],
    description: ""
  }
];
class KV {
  async search(t) {
    const n = t.toLowerCase().trim();
    return n ? Jp.filter(
      (r) => {
        var i, s;
        return r.label.toLowerCase().includes(n) || ((i = r.keywords) == null ? void 0 : i.some((a) => a.toLowerCase().includes(n))) || ((s = r.description) == null ? void 0 : s.toLowerCase().includes(n));
      }
    ).map((r) => ({
      id: `doc-${r.id}`,
      type: "doc",
      title: r.label,
      description: r.description || "",
      icon: r.icon || F5,
      //  docs  Tab 
      // DocsView  activeTab  /docs:getting-started
      action: (i) => i(`/docs:${r.id}`),
      score: 8
    })) : [];
  }
}
const YV = [
  // Sub-view Navigation (Deep Links)
  // These are NOT in the main sidebar, so we keep them here.
  {
    id: "nav-prompt",
    icon: Cm,
    label: "",
    description: " Prompt ",
    action: (e) => e("presets:prompt"),
    keywords: ["prompt", "template", "", ""],
    type: "navigation"
  },
  {
    id: "nav-regex",
    icon: Cm,
    label: "",
    description: " Regex ",
    action: (e) => e("presets:regex"),
    keywords: ["regex", "rule", "", ""],
    type: "navigation"
  },
  {
    id: "nav-worldbook",
    icon: PH,
    label: "",
    description: " World Info  Lorebook",
    action: (e) => e("presets:worldbook"),
    keywords: ["world", "book", "lore", ""],
    type: "navigation"
  }
], tb = [
  { id: "dashboard", icon: qH, label: "", path: "/dashboard" },
  { id: "memory", icon: KH, label: "", path: "/memory" },
  { id: "processing", icon: Yy, label: "", path: "/processing" },
  { id: "presets", icon: Fb, label: "API ", path: "/presets" },
  { id: "devlog", icon: Wy, label: "", path: "/devlog" },
  { id: "docs", icon: F5, label: "", path: "/docs" },
  // V0.9.11
  { id: "settings", icon: Cm, label: "", path: "/settings" }
], WV = {}, _A = (e) => {
  let t;
  const n = /* @__PURE__ */ new Set(), r = (h, m) => {
    const x = typeof h == "function" ? h(t) : h;
    if (!Object.is(x, t)) {
      const b = t;
      t = m ?? (typeof x != "object" || x === null) ? x : Object.assign({}, t, x), n.forEach((w) => w(t, b));
    }
  }, i = () => t, d = { setState: r, getState: i, getInitialState: () => f, subscribe: (h) => (n.add(h), () => n.delete(h)), destroy: () => {
    (WV ? "production" : void 0) !== "production" && console.warn(
      "[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."
    ), n.clear();
  } }, f = t = e(r, i, d);
  return d;
}, Mz = (e) => e ? _A(e) : _A;
var L2 = { exports: {} }, B2 = {}, $2 = { exports: {} }, q2 = {};
/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var SA;
function ZV() {
  if (SA) return q2;
  SA = 1;
  var e = /* @__PURE__ */ Gy();
  function t(m, x) {
    return m === x && (m !== 0 || 1 / m === 1 / x) || m !== m && x !== x;
  }
  var n = typeof Object.is == "function" ? Object.is : t, r = e.useState, i = e.useEffect, s = e.useLayoutEffect, a = e.useDebugValue;
  function u(m, x) {
    var b = x(), w = r({ inst: { value: b, getSnapshot: x } }), S = w[0].inst, C = w[1];
    return s(
      function() {
        S.value = b, S.getSnapshot = x, d(S) && C({ inst: S });
      },
      [m, b, x]
    ), i(
      function() {
        return d(S) && C({ inst: S }), m(function() {
          d(S) && C({ inst: S });
        });
      },
      [m]
    ), a(b), b;
  }
  function d(m) {
    var x = m.getSnapshot;
    m = m.value;
    try {
      var b = x();
      return !n(m, b);
    } catch {
      return !0;
    }
  }
  function f(m, x) {
    return x();
  }
  var h = typeof window > "u" || typeof window.document > "u" || typeof window.document.createElement > "u" ? f : u;
  return q2.useSyncExternalStore = e.useSyncExternalStore !== void 0 ? e.useSyncExternalStore : h, q2;
}
var EA;
function XV() {
  return EA || (EA = 1, $2.exports = /* @__PURE__ */ ZV()), $2.exports;
}
/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var CA;
function QV() {
  if (CA) return B2;
  CA = 1;
  var e = /* @__PURE__ */ Gy(), t = /* @__PURE__ */ XV();
  function n(f, h) {
    return f === h && (f !== 0 || 1 / f === 1 / h) || f !== f && h !== h;
  }
  var r = typeof Object.is == "function" ? Object.is : n, i = t.useSyncExternalStore, s = e.useRef, a = e.useEffect, u = e.useMemo, d = e.useDebugValue;
  return B2.useSyncExternalStoreWithSelector = function(f, h, m, x, b) {
    var w = s(null);
    if (w.current === null) {
      var S = { hasValue: !1, value: null };
      w.current = S;
    } else S = w.current;
    w = u(
      function() {
        function T(D) {
          if (!R) {
            if (R = !0, N = D, D = x(D), b !== void 0 && S.hasValue) {
              var q = S.value;
              if (b(q, D))
                return M = q;
            }
            return M = D;
          }
          if (q = M, r(N, D)) return q;
          var Y = x(D);
          return b !== void 0 && b(q, Y) ? (N = D, q) : (N = D, M = Y);
        }
        var R = !1, N, M, P = m === void 0 ? null : m;
        return [
          function() {
            return T(h());
          },
          P === null ? void 0 : function() {
            return T(P());
          }
        ];
      },
      [h, m, x, b]
    );
    var C = i(f, w[0], w[1]);
    return a(
      function() {
        S.hasValue = !0, S.value = C;
      },
      [C]
    ), d(C), C;
  }, B2;
}
var kA;
function JV() {
  return kA || (kA = 1, L2.exports = /* @__PURE__ */ QV()), L2.exports;
}
var eG = /* @__PURE__ */ JV();
const Oz = /* @__PURE__ */ jd(eG), Dz = {}, { useDebugValue: tG } = wd, { useSyncExternalStoreWithSelector: nG } = Oz;
let TA = !1;
const rG = (e) => e;
function iG(e, t = rG, n) {
  (Dz ? "production" : void 0) !== "production" && n && !TA && (console.warn(
    "[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"
  ), TA = !0);
  const r = nG(
    e.subscribe,
    e.getState,
    e.getServerState || e.getInitialState,
    t,
    n
  );
  return tG(r), r;
}
const jA = (e) => {
  (Dz ? "production" : void 0) !== "production" && typeof e != "function" && console.warn(
    "[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`."
  );
  const t = typeof e == "function" ? Mz(e) : e, n = (r, i) => iG(t, r, i);
  return Object.assign(n, t), n;
}, zz = (e) => e ? jA(e) : jA, sG = {
  name: "Paper (Light)",
  colors: {
    background: "oklch(1.0000 0 0)",
    foreground: "oklch(0.1884 0.0128 248.5103)",
    card: "oklch(0.9784 0.0011 197.1387)",
    cardForeground: "oklch(0.1884 0.0128 248.5103)",
    popover: "oklch(1.0000 0 0)",
    popoverForeground: "oklch(0.1884 0.0128 248.5103)",
    primary: "oklch(0.6723 0.1606 244.9955)",
    primaryForeground: "oklch(1.0000 0 0)",
    secondary: "oklch(0.1884 0.0128 248.5103)",
    secondaryForeground: "oklch(1.0000 0 0)",
    muted: "oklch(0.9222 0.0013 286.3737)",
    mutedForeground: "oklch(0.1884 0.0128 248.5103)",
    accent: "oklch(0.9392 0.0166 250.8453)",
    accentForeground: "oklch(0.6723 0.1606 244.9955)",
    destructive: "oklch(0.6188 0.2376 25.7658)",
    destructiveForeground: "oklch(1.0000 0 0)",
    border: "oklch(0.1884 0.0128 248.5103 / 0.15)",
    // Darker (Foreground based) as requested
    input: "oklch(0.9809 0.0025 228.7836)",
    ring: "oklch(0.6818 0.1584 243.3540)",
    chart1: "oklch(0.6723 0.1606 244.9955)",
    chart2: "oklch(0.6907 0.1554 160.3454)",
    chart3: "oklch(0.8214 0.1600 82.5337)",
    chart4: "oklch(0.7064 0.1822 151.7125)",
    chart5: "oklch(0.5919 0.2186 10.5826)",
    sidebar: "oklch(0.9784 0.0011 197.1387)",
    sidebarForeground: "oklch(0.1884 0.0128 248.5103)",
    sidebarPrimary: "oklch(0.6723 0.1606 244.9955)",
    sidebarPrimaryForeground: "oklch(1.0000 0 0)",
    sidebarAccent: "oklch(0.9392 0.0166 250.8453)",
    sidebarAccentForeground: "oklch(0.6723 0.1606 244.9955)",
    sidebarBorder: "oklch(0.1884 0.0128 248.5103 / 0.1)",
    // Darker (Foreground based)
    sidebarRing: "oklch(0.6818 0.1584 243.3540)"
  },
  variables: {
    radius: "1.3rem"
  }
}, aG = {
  name: "Claude (Dark)",
  colors: {
    background: "oklch(0.2679 0.0036 106.6427)",
    foreground: "oklch(0.8074 0.0142 93.0137)",
    card: "oklch(0.2679 0.0036 106.6427)",
    cardForeground: "oklch(0.8074 0.0142 93.0137)",
    popover: "oklch(0.2357 0.0024 67.7077)",
    popoverForeground: "oklch(0.8074 0.0142 93.0137)",
    primary: "oklch(0.6724 0.1308 38.7559)",
    primaryForeground: "oklch(1.0000 0 0)",
    secondary: "oklch(0.2213 0.0038 106.7070)",
    secondaryForeground: "oklch(0.8074 0.0142 93.0137)",
    muted: "oklch(0.2357 0.0024 67.7077)",
    mutedForeground: "oklch(0.7713 0.0169 99.0657)",
    accent: "oklch(0.6724 0.1308 38.7559)",
    accentForeground: "oklch(1.0000 0 0)",
    destructive: "oklch(0.6368 0.2078 25.3313)",
    destructiveForeground: "oklch(1.0000 0 0)",
    border: "oklch(0.8074 0.0142 93.0137 / 0.15)",
    // Foreground / 0.15
    input: "oklch(0.4336 0.0113 100.2195)",
    ring: "oklch(0.6724 0.1308 38.7559)",
    chart1: "oklch(0.6724 0.1308 38.7559)",
    chart2: "oklch(0.6898 0.1581 290.4107)",
    chart3: "oklch(0.8816 0.0276 93.1280)",
    chart4: "oklch(0.3074 0.0516 289.3230)",
    chart5: "oklch(0.6368 0.2078 25.3313)",
    sidebar: "oklch(0.2357 0.0024 67.7077)",
    sidebarForeground: "oklch(0.7713 0.0169 99.0657)",
    sidebarPrimary: "oklch(0.6724 0.1308 38.7559)",
    sidebarPrimaryForeground: "oklch(1.0000 0 0)",
    sidebarAccent: "oklch(0.2213 0.0038 106.7070)",
    sidebarAccentForeground: "oklch(0.8074 0.0142 93.0137)",
    sidebarBorder: "oklch(0.7713 0.0169 99.0657 / 0.15)",
    // SidebarForeground / 0.15
    sidebarRing: "oklch(0.6724 0.1308 38.7559)"
  },
  variables: {
    radius: "0.4rem"
  }
}, oG = {
  name: "Twitter (Dark)",
  colors: {
    background: "oklch(0 0 0)",
    foreground: "oklch(0.9328 0.0025 228.7857)",
    card: "oklch(0 0 0)",
    // Matching background for seamless look, or slightly lighter
    cardForeground: "oklch(0.9328 0.0025 228.7857)",
    popover: "oklch(0 0 0)",
    popoverForeground: "oklch(0.9328 0.0025 228.7857)",
    primary: "oklch(0.6692 0.1607 245.0110)",
    primaryForeground: "oklch(1.0000 0 0)",
    secondary: "oklch(0.2097 0.0080 274.5332)",
    // Using card color from ref as secondary
    secondaryForeground: "oklch(0.8853 0 0)",
    muted: "oklch(0.2090 0 0)",
    mutedForeground: "oklch(0.5637 0.0078 247.9662)",
    accent: "oklch(0.1928 0.0331 242.5459)",
    accentForeground: "oklch(0.6692 0.1607 245.0110)",
    destructive: "oklch(0.6188 0.2376 25.7658)",
    destructiveForeground: "oklch(1.0000 0 0)",
    border: "oklch(0.9328 0.0025 228.7857 / 0.15)",
    // Foreground / 0.15
    input: "oklch(0.3020 0.0288 244.8244)",
    ring: "oklch(0.6818 0.1584 243.3540)",
    chart1: "oklch(0.6723 0.1606 244.9955)",
    chart2: "oklch(0.6907 0.1554 160.3454)",
    chart3: "oklch(0.8214 0.1600 82.5337)",
    chart4: "oklch(0.7064 0.1822 151.7125)",
    chart5: "oklch(0.5919 0.2186 10.5826)",
    sidebar: "oklch(0 0 0)",
    sidebarForeground: "oklch(0.9328 0.0025 228.7857)",
    sidebarPrimary: "oklch(0.6692 0.1607 245.0110)",
    sidebarPrimaryForeground: "oklch(1.0000 0 0)",
    sidebarAccent: "oklch(0.1928 0.0331 242.5459)",
    sidebarAccentForeground: "oklch(0.6692 0.1607 245.0110)",
    sidebarBorder: "oklch(0.9328 0.0025 228.7857 / 0.15)",
    // SidebarForeground / 0.15
    sidebarRing: "oklch(0.6818 0.1584 243.3540)"
  },
  variables: {
    radius: "1.3rem"
  }
}, lG = {
  name: "Discord (Dark)",
  colors: {
    background: "#313338",
    foreground: "#f2f3f5",
    card: "#2b2d31",
    cardForeground: "#f2f3f5",
    popover: "#313338",
    popoverForeground: "#f2f3f5",
    primary: "#5865f2",
    primaryForeground: "#ffffff",
    secondary: "#2b2d31",
    secondaryForeground: "#f2f3f5",
    muted: "#1e1f22",
    mutedForeground: "#949ba4",
    accent: "#3f4147",
    accentForeground: "#f2f3f5",
    destructive: "#fa777c",
    destructiveForeground: "#313338",
    border: "#f2f3f526",
    // Foreground #f2f3f5 with ~15% alpha
    input: "#1e1f22",
    ring: "#5865f2",
    chart1: "#5865f2",
    chart2: "#23a559",
    chart3: "#f0b232",
    chart4: "#00a8fc",
    chart5: "#eb459e",
    sidebar: "#1e1f22",
    sidebarForeground: "#949ba4",
    sidebarPrimary: "#5865f2",
    sidebarPrimaryForeground: "#ffffff",
    sidebarAccent: "#3f4147",
    sidebarAccentForeground: "#f2f3f5",
    sidebarBorder: "#949ba426",
    // SidebarForeground #949ba4 with ~15% alpha
    sidebarRing: "#5865f2"
  },
  variables: {
    radius: "0.25rem"
  }
}, uG = {
  name: "Catppuccin Mocha",
  colors: {
    background: "#1e1e2e",
    // foreground: '#cdd6f4', // Old Text
    foreground: "#cba6f7",
    // Modified: Mauve as requested
    card: "#313244",
    cardForeground: "#cba6f7",
    // Also match text
    popover: "#1e1e2e",
    popoverForeground: "#cba6f7",
    primary: "#89b4fa",
    primaryForeground: "#1e1e2e",
    secondary: "#45475a",
    secondaryForeground: "#cba6f7",
    muted: "#313244",
    mutedForeground: "#a6adc8",
    accent: "#45475a",
    accentForeground: "#cba6f7",
    destructive: "#f38ba8",
    destructiveForeground: "#1e1e2e",
    border: "#cba6f726",
    // Mauve with ~15% alpha
    input: "#313244",
    ring: "#89b4fa",
    chart1: "#89b4fa",
    chart2: "#a6e3a1",
    chart3: "#f9e2af",
    chart4: "#fab387",
    chart5: "#cba6f7",
    sidebar: "#181825",
    sidebarForeground: "#cba6f7",
    // Mauve
    sidebarPrimary: "#89b4fa",
    sidebarPrimaryForeground: "#1e1e2e",
    sidebarAccent: "#313244",
    sidebarAccentForeground: "#cba6f7",
    sidebarBorder: "#cba6f726",
    // Mauve with ~15% alpha
    sidebarRing: "#89b4fa"
  },
  variables: {
    radius: "0.5rem"
  }
}, cG = {
  name: "SillyTavern ()",
  colors: {
    background: "var(--SmartThemeBlurTintColor)",
    foreground: "var(--SmartThemeBodyColor)",
    card: "var(--SmartThemeBlurTintColor)",
    cardForeground: "var(--SmartThemeBodyColor)",
    popover: "var(--SmartThemeBlurTintColor)",
    popoverForeground: "var(--SmartThemeBodyColor)",
    primary: "var(--SmartThemeQuoteColor)",
    primaryForeground: "var(--SmartThemeBodyColor)",
    secondary: "var(--SmartThemeBorderColor)",
    secondaryForeground: "var(--SmartThemeBodyColor)",
    muted: "rgba(0,0,0,0.2)",
    mutedForeground: "rgba(255,255,255,0.5)",
    accent: "var(--SmartThemeQuoteColor)",
    accentForeground: "var(--SmartThemeBodyColor)",
    destructive: "var(--SmartThemeBorderColor)",
    destructiveForeground: "var(--SmartThemeBodyColor)",
    border: "var(--SmartThemeBorderColor)",
    input: "var(--SmartThemeBorderColor)",
    ring: "var(--SmartThemeQuoteColor)",
    chart1: "var(--SmartThemeQuoteColor)",
    chart2: "var(--SmartThemeQuoteColor)",
    chart3: "var(--SmartThemeQuoteColor)",
    chart4: "var(--SmartThemeQuoteColor)",
    chart5: "var(--SmartThemeQuoteColor)",
    sidebar: "var(--SmartThemeBlurTintColor)",
    sidebarForeground: "var(--SmartThemeBodyColor)",
    sidebarPrimary: "var(--SmartThemeQuoteColor)",
    sidebarPrimaryForeground: "var(--SmartThemeBodyColor)",
    sidebarAccent: "var(--SmartThemeBorderColor)",
    sidebarAccentForeground: "var(--SmartThemeBodyColor)",
    sidebarBorder: "var(--SmartThemeBorderColor)",
    sidebarRing: "var(--SmartThemeQuoteColor)"
  },
  variables: {
    radius: "0.4rem"
  }
}, dG = {
  name: "Glass (Frosted)",
  colors: {
    // 
    background: "rgba(255, 255, 255, var(--glass-opacity, 0.1))",
    foreground: "#0f172a",
    //  (Slate-900) 
    //  - 
    card: "rgba(255, 255, 255, var(--glass-opacity, 0.25))",
    cardForeground: "#0f172a",
    popover: "rgba(255, 255, 255, var(--glass-opacity, 0.4))",
    popoverForeground: "#0f172a",
    primary: "rgba(15, 23, 42, 0.8)",
    // 
    primaryForeground: "#ffffff",
    secondary: "rgba(255, 255, 255, 0.3)",
    secondaryForeground: "#0f172a",
    muted: "rgba(255, 255, 255, 0.3)",
    mutedForeground: "rgba(15, 23, 42, 0.6)",
    accent: "rgba(255, 255, 255, 0.4)",
    accentForeground: "#0f172a",
    destructive: "rgba(239, 68, 68, 0.8)",
    destructiveForeground: "#ffffff",
    border: "rgba(15, 23, 42, 0.15)",
    // Lighter base (will be resistant to fade)
    input: "rgba(255, 255, 255, 0.4)",
    ring: "rgba(15, 23, 42, 0.4)",
    chart1: "#0f172a",
    chart2: "rgba(15, 23, 42, 0.8)",
    chart3: "rgba(15, 23, 42, 0.6)",
    chart4: "rgba(15, 23, 42, 0.4)",
    chart5: "rgba(15, 23, 42, 0.2)",
    sidebar: "rgba(255, 255, 255, var(--glass-opacity, 0.15))",
    sidebarForeground: "#0f172a",
    sidebarPrimary: "rgba(15, 23, 42, 0.8)",
    sidebarPrimaryForeground: "#ffffff",
    sidebarAccent: "rgba(255, 255, 255, 0.3)",
    sidebarAccentForeground: "#0f172a",
    sidebarBorder: "rgba(15, 23, 42, 0.1)",
    // Lighter base
    sidebarRing: "rgba(15, 23, 42, 0.4)"
  },
  variables: {
    radius: "1rem"
  }
}, D1 = {
  sillytavern: cG,
  // SillyTavern 
  paperLight: sG,
  twitterDark: oG,
  claudeDark: aG,
  catppuccin: uG,
  discord: lG,
  glass: dG
}, fG = "1.1.0", Y5 = {
  version: fG
};
function Yo() {
  return typeof crypto < "u" && typeof crypto.randomUUID == "function" ? crypto.randomUUID() : "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, (e) => {
    const t = Math.random() * 16 | 0;
    return (e === "x" ? t : t & 3 | 8).toString(16);
  });
}
var l3 = function(e, t) {
  return l3 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(n, r) {
    n.__proto__ = r;
  } || function(n, r) {
    for (var i in r) Object.prototype.hasOwnProperty.call(r, i) && (n[i] = r[i]);
  }, l3(e, t);
};
function Zy(e, t) {
  if (typeof t != "function" && t !== null)
    throw new TypeError("Class extends value " + String(t) + " is not a constructor or null");
  l3(e, t);
  function n() {
    this.constructor = e;
  }
  e.prototype = t === null ? Object.create(t) : (n.prototype = t.prototype, new n());
}
function u3(e) {
  var t = typeof Symbol == "function" && Symbol.iterator, n = t && e[t], r = 0;
  if (n) return n.call(e);
  if (e && typeof e.length == "number") return {
    next: function() {
      return e && r >= e.length && (e = void 0), { value: e && e[r++], done: !e };
    }
  };
  throw new TypeError(t ? "Object is not iterable." : "Symbol.iterator is not defined.");
}
function c3(e, t) {
  var n = typeof Symbol == "function" && e[Symbol.iterator];
  if (!n) return e;
  var r = n.call(e), i, s = [], a;
  try {
    for (; (t === void 0 || t-- > 0) && !(i = r.next()).done; ) s.push(i.value);
  } catch (u) {
    a = { error: u };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return s;
}
function d3(e, t, n) {
  if (n || arguments.length === 2) for (var r = 0, i = t.length, s; r < i; r++)
    (s || !(r in t)) && (s || (s = Array.prototype.slice.call(t, 0, r)), s[r] = t[r]);
  return e.concat(s || Array.prototype.slice.call(t));
}
function Ql(e) {
  return typeof e == "function";
}
function Pz(e) {
  var t = function(r) {
    Error.call(r), r.stack = new Error().stack;
  }, n = e(t);
  return n.prototype = Object.create(Error.prototype), n.prototype.constructor = n, n;
}
var F2 = Pz(function(e) {
  return function(n) {
    e(this), this.message = n ? n.length + ` errors occurred during unsubscription:
` + n.map(function(r, i) {
      return i + 1 + ") " + r.toString();
    }).join(`
  `) : "", this.name = "UnsubscriptionError", this.errors = n;
  };
});
function f3(e, t) {
  if (e) {
    var n = e.indexOf(t);
    0 <= n && e.splice(n, 1);
  }
}
var Gb = (function() {
  function e(t) {
    this.initialTeardown = t, this.closed = !1, this._parentage = null, this._finalizers = null;
  }
  return e.prototype.unsubscribe = function() {
    var t, n, r, i, s;
    if (!this.closed) {
      this.closed = !0;
      var a = this._parentage;
      if (a)
        if (this._parentage = null, Array.isArray(a))
          try {
            for (var u = u3(a), d = u.next(); !d.done; d = u.next()) {
              var f = d.value;
              f.remove(this);
            }
          } catch (S) {
            t = { error: S };
          } finally {
            try {
              d && !d.done && (n = u.return) && n.call(u);
            } finally {
              if (t) throw t.error;
            }
          }
        else
          a.remove(this);
      var h = this.initialTeardown;
      if (Ql(h))
        try {
          h();
        } catch (S) {
          s = S instanceof F2 ? S.errors : [S];
        }
      var m = this._finalizers;
      if (m) {
        this._finalizers = null;
        try {
          for (var x = u3(m), b = x.next(); !b.done; b = x.next()) {
            var w = b.value;
            try {
              AA(w);
            } catch (S) {
              s = s ?? [], S instanceof F2 ? s = d3(d3([], c3(s)), c3(S.errors)) : s.push(S);
            }
          }
        } catch (S) {
          r = { error: S };
        } finally {
          try {
            b && !b.done && (i = x.return) && i.call(x);
          } finally {
            if (r) throw r.error;
          }
        }
      }
      if (s)
        throw new F2(s);
    }
  }, e.prototype.add = function(t) {
    var n;
    if (t && t !== this)
      if (this.closed)
        AA(t);
      else {
        if (t instanceof e) {
          if (t.closed || t._hasParent(this))
            return;
          t._addParent(this);
        }
        (this._finalizers = (n = this._finalizers) !== null && n !== void 0 ? n : []).push(t);
      }
  }, e.prototype._hasParent = function(t) {
    var n = this._parentage;
    return n === t || Array.isArray(n) && n.includes(t);
  }, e.prototype._addParent = function(t) {
    var n = this._parentage;
    this._parentage = Array.isArray(n) ? (n.push(t), n) : n ? [n, t] : t;
  }, e.prototype._removeParent = function(t) {
    var n = this._parentage;
    n === t ? this._parentage = null : Array.isArray(n) && f3(n, t);
  }, e.prototype.remove = function(t) {
    var n = this._finalizers;
    n && f3(n, t), t instanceof e && t._removeParent(this);
  }, e.EMPTY = (function() {
    var t = new e();
    return t.closed = !0, t;
  })(), e;
})(), Iz = Gb.EMPTY;
function Lz(e) {
  return e instanceof Gb || e && "closed" in e && Ql(e.remove) && Ql(e.add) && Ql(e.unsubscribe);
}
function AA(e) {
  Ql(e) ? e() : e.unsubscribe();
}
var hG = {
  Promise: void 0
}, pG = {
  setTimeout: function(e, t) {
    for (var n = [], r = 2; r < arguments.length; r++)
      n[r - 2] = arguments[r];
    return setTimeout.apply(void 0, d3([e, t], c3(n)));
  },
  clearTimeout: function(e) {
    return clearTimeout(e);
  },
  delegate: void 0
};
function mG(e) {
  pG.setTimeout(function() {
    throw e;
  });
}
function NA() {
}
function z1(e) {
  e();
}
var W5 = (function(e) {
  Zy(t, e);
  function t(n) {
    var r = e.call(this) || this;
    return r.isStopped = !1, n ? (r.destination = n, Lz(n) && n.add(r)) : r.destination = xG, r;
  }
  return t.create = function(n, r, i) {
    return new h3(n, r, i);
  }, t.prototype.next = function(n) {
    this.isStopped || this._next(n);
  }, t.prototype.error = function(n) {
    this.isStopped || (this.isStopped = !0, this._error(n));
  }, t.prototype.complete = function() {
    this.isStopped || (this.isStopped = !0, this._complete());
  }, t.prototype.unsubscribe = function() {
    this.closed || (this.isStopped = !0, e.prototype.unsubscribe.call(this), this.destination = null);
  }, t.prototype._next = function(n) {
    this.destination.next(n);
  }, t.prototype._error = function(n) {
    try {
      this.destination.error(n);
    } finally {
      this.unsubscribe();
    }
  }, t.prototype._complete = function() {
    try {
      this.destination.complete();
    } finally {
      this.unsubscribe();
    }
  }, t;
})(Gb), gG = (function() {
  function e(t) {
    this.partialObserver = t;
  }
  return e.prototype.next = function(t) {
    var n = this.partialObserver;
    if (n.next)
      try {
        n.next(t);
      } catch (r) {
        r1(r);
      }
  }, e.prototype.error = function(t) {
    var n = this.partialObserver;
    if (n.error)
      try {
        n.error(t);
      } catch (r) {
        r1(r);
      }
    else
      r1(t);
  }, e.prototype.complete = function() {
    var t = this.partialObserver;
    if (t.complete)
      try {
        t.complete();
      } catch (n) {
        r1(n);
      }
  }, e;
})(), h3 = (function(e) {
  Zy(t, e);
  function t(n, r, i) {
    var s = e.call(this) || this, a;
    return Ql(n) || !n ? a = {
      next: n ?? void 0,
      error: r ?? void 0,
      complete: i ?? void 0
    } : a = n, s.destination = new gG(a), s;
  }
  return t;
})(W5);
function r1(e) {
  mG(e);
}
function yG(e) {
  throw e;
}
var xG = {
  closed: !0,
  next: NA,
  error: yG,
  complete: NA
}, vG = (function() {
  return typeof Symbol == "function" && Symbol.observable || "@@observable";
})();
function bG(e) {
  return e;
}
function wG(e) {
  return e.length === 0 ? bG : e.length === 1 ? e[0] : function(n) {
    return e.reduce(function(r, i) {
      return i(r);
    }, n);
  };
}
var RA = (function() {
  function e(t) {
    t && (this._subscribe = t);
  }
  return e.prototype.lift = function(t) {
    var n = new e();
    return n.source = this, n.operator = t, n;
  }, e.prototype.subscribe = function(t, n, r) {
    var i = this, s = SG(t) ? t : new h3(t, n, r);
    return z1(function() {
      var a = i, u = a.operator, d = a.source;
      s.add(u ? u.call(s, d) : d ? i._subscribe(s) : i._trySubscribe(s));
    }), s;
  }, e.prototype._trySubscribe = function(t) {
    try {
      return this._subscribe(t);
    } catch (n) {
      t.error(n);
    }
  }, e.prototype.forEach = function(t, n) {
    var r = this;
    return n = MA(n), new n(function(i, s) {
      var a = new h3({
        next: function(u) {
          try {
            t(u);
          } catch (d) {
            s(d), a.unsubscribe();
          }
        },
        error: s,
        complete: i
      });
      r.subscribe(a);
    });
  }, e.prototype._subscribe = function(t) {
    var n;
    return (n = this.source) === null || n === void 0 ? void 0 : n.subscribe(t);
  }, e.prototype[vG] = function() {
    return this;
  }, e.prototype.pipe = function() {
    for (var t = [], n = 0; n < arguments.length; n++)
      t[n] = arguments[n];
    return wG(t)(this);
  }, e.prototype.toPromise = function(t) {
    var n = this;
    return t = MA(t), new t(function(r, i) {
      var s;
      n.subscribe(function(a) {
        return s = a;
      }, function(a) {
        return i(a);
      }, function() {
        return r(s);
      });
    });
  }, e.create = function(t) {
    return new e(t);
  }, e;
})();
function MA(e) {
  var t;
  return (t = e ?? hG.Promise) !== null && t !== void 0 ? t : Promise;
}
function _G(e) {
  return e && Ql(e.next) && Ql(e.error) && Ql(e.complete);
}
function SG(e) {
  return e && e instanceof W5 || _G(e) && Lz(e);
}
function EG(e) {
  return Ql(e == null ? void 0 : e.lift);
}
function CG(e) {
  return function(t) {
    if (EG(t))
      return t.lift(function(n) {
        try {
          return e(n, this);
        } catch (r) {
          this.error(r);
        }
      });
    throw new TypeError("Unable to lift unknown Observable type");
  };
}
function kG(e, t, n, r, i) {
  return new TG(e, t, n, r, i);
}
var TG = (function(e) {
  Zy(t, e);
  function t(n, r, i, s, a, u) {
    var d = e.call(this, n) || this;
    return d.onFinalize = a, d.shouldUnsubscribe = u, d._next = r ? function(f) {
      try {
        r(f);
      } catch (h) {
        n.error(h);
      }
    } : e.prototype._next, d._error = s ? function(f) {
      try {
        s(f);
      } catch (h) {
        n.error(h);
      } finally {
        this.unsubscribe();
      }
    } : e.prototype._error, d._complete = i ? function() {
      try {
        i();
      } catch (f) {
        n.error(f);
      } finally {
        this.unsubscribe();
      }
    } : e.prototype._complete, d;
  }
  return t.prototype.unsubscribe = function() {
    var n;
    if (!this.shouldUnsubscribe || this.shouldUnsubscribe()) {
      var r = this.closed;
      e.prototype.unsubscribe.call(this), !r && ((n = this.onFinalize) === null || n === void 0 || n.call(this));
    }
  }, t;
})(W5), jG = Pz(function(e) {
  return function() {
    e(this), this.name = "ObjectUnsubscribedError", this.message = "object unsubscribed";
  };
}), Z5 = (function(e) {
  Zy(t, e);
  function t() {
    var n = e.call(this) || this;
    return n.closed = !1, n.currentObservers = null, n.observers = [], n.isStopped = !1, n.hasError = !1, n.thrownError = null, n;
  }
  return t.prototype.lift = function(n) {
    var r = new OA(this, this);
    return r.operator = n, r;
  }, t.prototype._throwIfClosed = function() {
    if (this.closed)
      throw new jG();
  }, t.prototype.next = function(n) {
    var r = this;
    z1(function() {
      var i, s;
      if (r._throwIfClosed(), !r.isStopped) {
        r.currentObservers || (r.currentObservers = Array.from(r.observers));
        try {
          for (var a = u3(r.currentObservers), u = a.next(); !u.done; u = a.next()) {
            var d = u.value;
            d.next(n);
          }
        } catch (f) {
          i = { error: f };
        } finally {
          try {
            u && !u.done && (s = a.return) && s.call(a);
          } finally {
            if (i) throw i.error;
          }
        }
      }
    });
  }, t.prototype.error = function(n) {
    var r = this;
    z1(function() {
      if (r._throwIfClosed(), !r.isStopped) {
        r.hasError = r.isStopped = !0, r.thrownError = n;
        for (var i = r.observers; i.length; )
          i.shift().error(n);
      }
    });
  }, t.prototype.complete = function() {
    var n = this;
    z1(function() {
      if (n._throwIfClosed(), !n.isStopped) {
        n.isStopped = !0;
        for (var r = n.observers; r.length; )
          r.shift().complete();
      }
    });
  }, t.prototype.unsubscribe = function() {
    this.isStopped = this.closed = !0, this.observers = this.currentObservers = null;
  }, Object.defineProperty(t.prototype, "observed", {
    get: function() {
      var n;
      return ((n = this.observers) === null || n === void 0 ? void 0 : n.length) > 0;
    },
    enumerable: !1,
    configurable: !0
  }), t.prototype._trySubscribe = function(n) {
    return this._throwIfClosed(), e.prototype._trySubscribe.call(this, n);
  }, t.prototype._subscribe = function(n) {
    return this._throwIfClosed(), this._checkFinalizedStatuses(n), this._innerSubscribe(n);
  }, t.prototype._innerSubscribe = function(n) {
    var r = this, i = this, s = i.hasError, a = i.isStopped, u = i.observers;
    return s || a ? Iz : (this.currentObservers = null, u.push(n), new Gb(function() {
      r.currentObservers = null, f3(u, n);
    }));
  }, t.prototype._checkFinalizedStatuses = function(n) {
    var r = this, i = r.hasError, s = r.thrownError, a = r.isStopped;
    i ? n.error(s) : a && n.complete();
  }, t.prototype.asObservable = function() {
    var n = new RA();
    return n.source = this, n;
  }, t.create = function(n, r) {
    return new OA(n, r);
  }, t;
})(RA), OA = (function(e) {
  Zy(t, e);
  function t(n, r) {
    var i = e.call(this) || this;
    return i.destination = n, i.source = r, i;
  }
  return t.prototype.next = function(n) {
    var r, i;
    (i = (r = this.destination) === null || r === void 0 ? void 0 : r.next) === null || i === void 0 || i.call(r, n);
  }, t.prototype.error = function(n) {
    var r, i;
    (i = (r = this.destination) === null || r === void 0 ? void 0 : r.error) === null || i === void 0 || i.call(r, n);
  }, t.prototype.complete = function() {
    var n, r;
    (r = (n = this.destination) === null || n === void 0 ? void 0 : n.complete) === null || r === void 0 || r.call(n);
  }, t.prototype._subscribe = function(n) {
    var r, i;
    return (i = (r = this.source) === null || r === void 0 ? void 0 : r.subscribe(n)) !== null && i !== void 0 ? i : Iz;
  }, t;
})(Z5);
function AG(e, t) {
  return CG(function(n, r) {
    var i = 0;
    n.subscribe(kG(r, function(s) {
      return e.call(t, s, i++) && r.next(s);
    }));
  });
}
const i1 = new Z5(), X5 = {
  /**
   * 
   */
  emit(e) {
    i1.next({
      ...e,
      timestamp: Date.now()
    });
  },
  /**
   * 
   */
  subscribe(e) {
    const t = i1.subscribe(e);
    return {
      unsubscribe: () => t.unsubscribe()
    };
  },
  /**
   * 
   */
  on(e, t) {
    const n = i1.pipe(AG((r) => r.type === e)).subscribe((r) => t(r.payload));
    return {
      unsubscribe: () => n.unsubscribe()
    };
  },
  /**
   *  RxJS 
   */
  asObservable() {
    return i1.asObservable();
  }
}, Qo = {
  // 
  MESSAGE_SENT: "message_sent",
  MESSAGE_RECEIVED: "message_received",
  MESSAGE_EDITED: "message_edited",
  MESSAGE_DELETED: "message_deleted",
  MESSAGE_UPDATED: "message_updated",
  MESSAGE_SWIPED: "message_swiped",
  USER_MESSAGE_RENDERED: "user_message_rendered",
  CHARACTER_MESSAGE_RENDERED: "character_message_rendered",
  // 
  CHAT_CHANGED: "chat_id_changed",
  CHAT_CREATED: "chat_created",
  CHAT_DELETED: "chat_deleted",
  // 
  GENERATION_STARTED: "generation_started",
  GENERATION_STOPPED: "generation_stopped",
  GENERATION_ENDED: "generation_ended",
  GENERATION_AFTER_COMMANDS: "GENERATION_AFTER_COMMANDS",
  STREAM_TOKEN_RECEIVED: "stream_token_received",
  // V0.7: RAG  -  prompt await  handler 
  GENERATE_BEFORE_COMBINE_PROMPTS: "generate_before_combine_prompts",
  GENERATE_AFTER_COMBINE_PROMPTS: "generate_after_combine_prompts",
  GENERATE_AFTER_DATA: "generate_after_data",
  // V0.8: Chat Completion  ()
  CHAT_COMPLETION_PROMPT_READY: "chat_completion_prompt_ready",
  CHAT_COMPLETION_SETTINGS_READY: "chat_completion_settings_ready",
  // 
  WORLDINFO_UPDATED: "worldinfo_updated",
  WORLDINFO_SETTINGS_UPDATED: "worldinfo_settings_updated",
  WORLDINFO_ENTRIES_LOADED: "worldinfo_entries_loaded",
  WORLD_INFO_ACTIVATED: "world_info_activated",
  // 
  APP_READY: "app_ready",
  SETTINGS_LOADED: "settings_loaded",
  SETTINGS_LOADED_AFTER: "settings_loaded_after",
  EXTENSION_SETTINGS_LOADED: "extension_settings_loaded",
  // 
  CHARACTER_EDITED: "character_edited",
  CHARACTER_DELETED: "characterDeleted",
  // 
  ENGRAM_REQUEST_REVISION: "engram:request_revision"
}, NG = "TavernEventBus";
function Gp() {
  try {
    const e = window.SillyTavern;
    if (e != null && e.getContext) {
      const t = e.getContext();
      return (t == null ? void 0 : t.eventSource) || null;
    }
    return null;
  } catch {
    return ee.warn(NG, " SillyTavern eventSource"), null;
  }
}
class ao {
  /**
   * 
   * @param event 
   * @param callback 
   * @returns 
   */
  static on(t, n) {
    const r = Gp();
    return r && r.on(t, n), this.listeners.has(t) || this.listeners.set(t, /* @__PURE__ */ new Set()), this.listeners.get(t).add(n), () => {
      this.off(t, n);
    };
  }
  /**
   * 
   * @param event 
   * @param callback 
   */
  static once(t, n) {
    const r = Gp();
    if (r)
      r.once(t, n);
    else {
      const i = (...s) => {
        this.off(t, i), n(...s);
      };
      this.on(t, i);
    }
  }
  /**
   * 
   * @param event 
   * @param callback 
   */
  static off(t, n) {
    var i;
    const r = Gp();
    r && r.removeListener(t, n), (i = this.listeners.get(t)) == null || i.delete(n);
  }
  /**
   * 
   * @param event 
   * @param args 
   */
  static async emit(t, ...n) {
    const r = Gp();
    if (r)
      return r.emit(t, ...n);
  }
  /**
   * 
   * 
   */
  static clearAll() {
    const t = Gp();
    for (const [n, r] of this.listeners)
      for (const i of r)
        t && t.removeListener(n, i);
    this.listeners.clear();
  }
  /**
   *  EventBus 
   */
  static isAvailable() {
    return Gp() !== null;
  }
}
lt(ao, "listeners", /* @__PURE__ */ new Map());
const Bz = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  EventBus: ao,
  TavernEventType: Qo
}, Symbol.toStringTag, { value: "Module" })), nh = class nh {
  constructor() {
    lt(this, "unsubscribers", []);
    lt(this, "callbacks", /* @__PURE__ */ new Map());
  }
  /**
   * 
   */
  static getInstance() {
    return nh.instance || (nh.instance = new nh()), nh.instance;
  }
  /**
   * 
   * 
   */
  start() {
    if (this.unsubscribers.length > 0) {
      console.log("[EventWatcher] Already started.");
      return;
    }
    this.unsubscribers.push(
      ao.on(Qo.MESSAGE_RECEIVED, () => this.emit("messageReceived")),
      ao.on(Qo.CHAT_CHANGED, () => this.emit("chatChanged")),
      ao.on(Qo.GENERATION_STARTED, () => this.emit("generationStarted")),
      ao.on(Qo.GENERATION_ENDED, () => this.emit("generationEnded"))
    ), console.log("[EventWatcher] Started, listening to core events.");
  }
  /**
   * 
   */
  stop() {
    this.unsubscribers.forEach((t) => t()), this.unsubscribers = [], console.log("[EventWatcher] Stopped.");
  }
  /**
   * 
   * @param event 
   * @param callback 
   * @returns 
   */
  on(t, n) {
    const r = this.mapEventKey(t);
    return this.callbacks.has(r) || this.callbacks.set(r, /* @__PURE__ */ new Set()), this.callbacks.get(r).add(n), () => {
      var i;
      (i = this.callbacks.get(r)) == null || i.delete(n);
    };
  }
  /**
   * 
   */
  emit(t) {
    const n = this.callbacks.get(t);
    n && n.forEach((r) => {
      try {
        r();
      } catch (i) {
        console.error(`[EventWatcher] Callback error for ${t}:`, i);
      }
    });
  }
  /**
   * 
   */
  mapEventKey(t) {
    return {
      onMessageReceived: "messageReceived",
      onChatChanged: "chatChanged",
      onGenerationStarted: "generationStarted",
      onGenerationEnded: "generationEnded"
    }[t];
  }
};
lt(nh, "instance", null);
let p3 = nh;
const U2 = p3.getInstance(), Q5 = "engram", Xf = "__ENGRAM_STATE__", m3 = "engram_macro_slot", g3 = "Engram Memory Context";
function Ps() {
  try {
    return window.TavernHelper || null;
  } catch {
    return null;
  }
}
const ni = "Worldbook";
async function iu(e) {
  const t = Ps();
  if (!(t != null && t.getWorldbook))
    return ee.warn(ni, "TavernHelper "), [];
  try {
    return (await t.getWorldbook(e)).map((r) => {
      const i = r, s = i.strategy, a = i.position, u = i.recursion, d = [];
      if (s != null && s.keys && Array.isArray(s.keys))
        for (const f of s.keys)
          typeof f == "string" ? d.push(f) : f && typeof f == "object" && "source" in f && d.push(f.source);
      return {
        uid: i.uid || 0,
        name: i.name || "",
        content: i.content || "",
        enabled: typeof i.enabled == "boolean" ? i.enabled : i.disable !== !0,
        constant: (s == null ? void 0 : s.type) === "constant",
        keys: d,
        position: (a == null ? void 0 : a.type) || "before_character_definition",
        depth: (a == null ? void 0 : a.depth) || 0,
        order: (a == null ? void 0 : a.order) || 100,
        recursion: u ? {
          prevent_incoming: u.prevent_incoming,
          prevent_outgoing: u.prevent_outgoing
        } : void 0,
        comment: i.comment || "",
        extra: i.extra || void 0
      };
    });
  } catch (n) {
    return ee.error(ni, "", n), [];
  }
}
async function $z() {
  const e = Ps();
  try {
    return e != null && e.getWorldbookNames ? e.getWorldbookNames() : [];
  } catch (t) {
    return ee.error(ni, "", t), [];
  }
}
async function qz(e) {
  const t = Ps();
  if (!(t != null && t.deleteWorldbook))
    return ee.warn(ni, "TavernHelper.deleteWorldbook "), !1;
  try {
    const n = await t.deleteWorldbook(e);
    return n && ee.info(ni, "", e), n;
  } catch (n) {
    return ee.error(ni, "", n), !1;
  }
}
async function Tm(e, t) {
  try {
    const n = Ps();
    if (!(n != null && n.createWorldbookEntries))
      return ee.error(ni, "TavernHelper.createWorldbookEntries "), !1;
    const r = {
      name: t.name,
      content: t.content,
      comment: t.name,
      // 
      disable: !(t.enabled ?? !0),
      // TavernHelper  disable 
      strategy: {
        type: t.constant ? "constant" : "selective",
        keys: t.keys || []
      },
      position: {
        type: t.position || "before_character_definition",
        order: t.order ?? 100,
        depth: t.depth ?? 4
      },
      recursion: t.recursion,
      //  Engram 
      extra: {
        engram: !0
      }
    };
    return ee.debug(ni, "", {
      worldbook: e,
      name: t.name,
      contentLength: t.content.length
    }), await n.createWorldbookEntries(e, [r]), ee.info(ni, "", e), !0;
  } catch (n) {
    return ee.error(ni, "", n), !1;
  }
}
async function J5(e, t, n) {
  const r = Ps();
  if (!(r != null && r.updateWorldbookWith))
    return ee.warn(ni, "TavernHelper.updateWorldbookWith "), !1;
  try {
    return await r.updateWorldbookWith(e, (i) => {
      var a;
      const s = i.findIndex((u) => u.uid === t);
      if (s !== -1) {
        const u = i[s];
        let d = u.disable;
        "enabled" in n && (d = !n.enabled);
        let f = u.strategy || { type: "selective", keys: [] };
        if ("constant" in n || "keys" in n) {
          const x = n.constant !== void 0 ? n.constant : f.type === "constant", b = n.keys !== void 0 ? n.keys : f.keys || [];
          f = {
            ...f,
            type: x ? "constant" : "selective",
            keys: b
          };
        }
        let h = u.position || { type: "before_character_definition", order: 0, depth: 0 };
        (n.position || typeof n.order == "number" || typeof n.depth == "number") && (h = {
          ...h,
          type: (typeof n.position == "string" ? n.position : (a = n.position) == null ? void 0 : a.type) || h.type,
          order: n.order ?? h.order,
          depth: n.depth ?? h.depth
        });
        let m = u.recursion;
        n.recursion && (m = n.recursion), i[s] = {
          ...u,
          name: n.name ?? u.name,
          content: n.content ?? u.content,
          comment: n.name ?? u.comment,
          // 
          disable: d,
          strategy: f,
          position: h,
          recursion: m
        }, ee.debug(ni, " (In-Place)", { uid: t, name: i[s].name });
      } else
        ee.warn(ni, "updateEntry ", t);
      return i;
    }), !0;
  } catch (i) {
    return ee.error(ni, "", i), !1;
  }
}
async function eT(e, t) {
  const n = Ps();
  if (!(n != null && n.deleteWorldbookEntries))
    return ee.warn(ni, "TavernHelper.deleteWorldbookEntries "), !1;
  try {
    return await n.deleteWorldbookEntries(e, (r) => r.uid === t), ee.debug(ni, "", { worldbook: e, uid: t }), !0;
  } catch (r) {
    return ee.error(ni, "", r), !1;
  }
}
async function Fz(e, t) {
  const n = Ps();
  if (!(n != null && n.deleteWorldbookEntries))
    return ee.warn(ni, "TavernHelper.deleteWorldbookEntries "), !1;
  try {
    const r = new Set(t);
    return await n.deleteWorldbookEntries(e, (i) => r.has(i.uid)), ee.debug(ni, "", { worldbook: e, count: t.length }), !0;
  } catch (r) {
    return ee.error(ni, "", r), !1;
  }
}
async function jm(e, t) {
  const n = await iu(e);
  let r = n.find((i) => i.keys.includes(t));
  return r || (r = n.find((i) => i.name === t || t === "__ENGRAM_STATE__" && i.name === "Engram System State")), r || null;
}
const RG = "Worldbook";
async function DA(e) {
  try {
    const t = window.SillyTavern;
    if (t != null && t.getContext) {
      const n = t.getContext();
      if (n != null && n.getTokenCountAsync)
        return await n.getTokenCountAsync(e);
    }
    return Math.ceil(e.length / 4);
  } catch {
    return ee.warn(RG, " Token "), Math.ceil(e.length / 4);
  }
}
class em {
  /**
   *  Token 
   * @param text 
   */
  static async countTokens(t) {
    return DA(t);
  }
  /**
   *  Token 
   * @param texts 
   */
  static async countTokensBatch(t) {
    return Promise.all(t.map((n) => DA(n)));
  }
  /**
   *  Engram  Token 
   * 
   * @param worldbookName 
   */
  static async countSummaryTokens(t) {
    const r = (await iu(t)).filter(
      (a) => a.enabled && a.keys.includes(Q5)
    );
    if (r.length === 0) return 0;
    const i = r.map((a) => a.content);
    return (await Promise.all(i.map((a) => this.countTokens(a)))).reduce((a, u) => a + u, 0);
  }
  /**
   *  Token 
   * @param worldbookName 
   */
  static async getWorldbookTokenStats(t) {
    const n = await iu(t), r = await Promise.all(
      n.map(async (s) => ({
        name: s.name,
        tokens: await this.countTokens(s.content)
      }))
    );
    return {
      totalTokens: r.reduce((s, a) => s + a.tokens, 0),
      entryCount: n.length,
      entries: r
    };
  }
  /**
   *  Token  API
   */
  static async isNativeTokenCountAvailable() {
    try {
      const t = window.SillyTavern;
      if (t != null && t.getContext) {
        const n = t.getContext();
        return typeof (n == null ? void 0 : n.getTokenCountAsync) == "function";
      }
      return !1;
    } catch {
      return !1;
    }
  }
}
const Kl = "Worldbook";
async function s1() {
  try {
    const t = await new Function("path", "return import(path)")("/scripts/world-info.js"), n = t == null ? void 0 : t.getSortedEntries;
    if (typeof n != "function")
      return "";
    const r = await n();
    if (!r || !Array.isArray(r))
      return "";
    const i = r.filter((s) => s.constant === !0 && s.disable !== !0 && s.content);
    return i.length === 0 ? "" : (ee.debug(Kl, ` ${i.length} `), i.map((s) => s.content).join(`

`));
  } catch {
    return "";
  }
}
async function MG() {
  var f, h, m;
  const e = Ps(), t = ((f = e == null ? void 0 : e.getGlobalWorldbookNames) == null ? void 0 : f.call(e)) || [], { SettingsManager: n } = await Promise.resolve().then(() => Xb), i = (h = n.getSettings().apiSettings) == null ? void 0 : h.worldbookConfig, s = (i == null ? void 0 : i.disabledWorldbooks) || [], { WorldBookStateService: a } = await Promise.resolve().then(() => DG), u = (m = e == null ? void 0 : e.getCharWorldbookNames) == null ? void 0 : m.call(e, "current");
  let d = {};
  return u != null && u.primary && (d = (await a.loadState(u.primary)).disabledEntries || {}), {
    globalWorldbooks: t,
    disabledGlobalBooks: s,
    disabledEntries: d,
    config: i
  };
}
function OG(e, t, n, r, i) {
  var s, a, u, d;
  if (((s = e.extra) == null ? void 0 : s.engram) === !0 || (a = e.world) != null && a.startsWith("[Engram]")) return !0;
  if (e.world && n.includes(e.world) || e.world && t.includes(e.world) && (i == null ? void 0 : i.includeGlobal) === !1)
    return !1;
  if (e.world && e.uid) {
    const f = r[e.world];
    if (f && f.includes(e.uid))
      return !1;
  }
  return !((u = e.world) != null && u.startsWith("") || (d = e.world) != null && d.startsWith("---"));
}
class y3 {
  /**
   * V1.1.0: 
   * @param worldbookName 
   * @param contextText 
   */
  static async scanWorldbook(t, n) {
    const r = await iu(t);
    if (r.length === 0) return "";
    const i = [], s = n.toLowerCase();
    for (const a of r)
      if (a.enabled) {
        if (a.constant) {
          i.push(a);
          continue;
        }
        if (a.keys && a.keys.length > 0) {
          let u = !1;
          for (const d of a.keys)
            if (d && s.includes(d.toLowerCase())) {
              u = !0;
              break;
            }
          u && i.push(a);
        }
      }
    return i.length > 0 ? (ee.debug(Kl, ` [${t}]`, {
      total: r.length,
      matched: i.length
    }), i.sort((a, u) => a.order - u.order), i.map((a) => a.content).join(`

`)) : "";
  }
  /**
   * 
   *  getWorldInfoPrompt 
   */
  static async getActivatedWorldInfo(t, n) {
    var r, i;
    try {
      const a = await new Function("path", "return import(path)")("/scripts/world-info.js"), u = a == null ? void 0 : a.getWorldInfoPrompt, d = a == null ? void 0 : a.getSortedEntries;
      if (typeof d == "function") {
        const Y = await d();
        Y && Y.length > 0;
      }
      if (typeof u != "function")
        return ee.warn(Kl, "getWorldInfoPrompt "), s1();
      const f = 4;
      let h = t;
      const m = (i = (r = window.SillyTavern) == null ? void 0 : r.getContext) == null ? void 0 : i.call(r);
      if (n != null && n.floorRange) {
        const [Y, te] = n.floorRange;
        m != null && m.chat && Array.isArray(m.chat) && (h = m.chat.slice(Y - 1, te).map(($) => $.mes || "").reverse(), ee.debug(Kl, "", {
          floorRange: n.floorRange,
          messageCount: h.length
        }));
      } else (!h || h.length === 0) && m != null && m.chat && Array.isArray(m.chat) && (h = m.chat.slice(-f).map((te) => te.mes || "").reverse(), ee.debug(Kl, "", {
        scanLimit: f,
        messageCount: h.length
      }));
      if (!h || h.length === 0)
        return ee.warn(Kl, ""), s1();
      const b = Math.max(1e4, h.length * 500), w = a == null ? void 0 : a.checkWorldInfo;
      if (typeof w != "function")
        return ee.error(Kl, "checkWorldInfo "), s1();
      const S = await w(h, b, !0, {
        trigger: "normal"
      }), C = S == null ? void 0 : S.allActivatedEntries, T = C ? Array.from(C.values()) : [];
      ee.info(Kl, ` ${T.length} `);
      const R = await MG(), { disabledGlobalBooks: N, disabledEntries: M, globalWorldbooks: P, config: D } = R, q = T.filter(
        (Y) => OG(Y, P, N, M, D)
      );
      return ee.info(Kl, "", {
        total: T.length,
        kept: q.length,
        filteredOut: T.length - q.length
      }), q.sort((Y, te) => (Y.order || 0) - (te.order || 0)), q.map((Y) => Y.content).filter(Boolean).join(`

`);
    } catch (s) {
      return ee.error(Kl, "", s), s1();
    }
  }
}
const z0 = "Worldbook";
class Ho {
  /**
   *  Engram 
   */
  static findExistingWorldbook() {
    try {
      const t = Ps();
      if (!(t != null && t.getCharWorldbookNames))
        return null;
      const n = t.getCharWorldbookNames("current");
      return n && [...n.additional || [], n.primary].filter(Boolean).find((s) => s == null ? void 0 : s.startsWith("[Engram]")) || null;
    } catch {
      return null;
    }
  }
  /**
   *  Engram 
   */
  static async getOrCreateWorldbook() {
    var t, n;
    try {
      const r = this.findExistingWorldbook();
      if (r)
        return r;
      const i = Ps();
      if (!i)
        return ee.warn(z0, "TavernHelper "), null;
      const s = (n = (t = window.SillyTavern) == null ? void 0 : t.getContext) == null ? void 0 : n.call(t);
      if (!(s != null && s.name2) || s.name2 === "SillyTavern System")
        return ee.warn(z0, ""), null;
      const a = s.name2, u = `[Engram] ${a}`;
      if (ee.debug(z0, "", u), i.createWorldbook)
        await i.createWorldbook(u);
      else
        return null;
      if (i.getCharWorldbookNames && i.rebindCharWorldbooks) {
        const d = i.getCharWorldbookNames("current");
        d && (d.additional.push(u), await i.rebindCharWorldbooks("current", d), ee.info(z0, "", {
          character: a,
          worldbook: u
        }));
      }
      return u;
    } catch (r) {
      return ee.error(z0, "/", r), null;
    }
  }
  /**
   *  Engram  order 
   */
  static async getSummaryEntries(t) {
    const r = (await iu(t)).filter((i) => i.keys.includes(Q5));
    return r.sort((i, s) => i.order - s.order), r;
  }
  /**
   *  Engram  {{engramSummaries}} 
   */
  static async getEngramSummariesContent() {
    const t = this.findExistingWorldbook();
    if (!t)
      return "";
    const n = await this.getSummaryEntries(t);
    return n.length === 0 ? "" : n.map((i) => {
      const s = i.content.replace(/\{\{\/\/.*?\}\}/gs, "").trim();
      return `${i.name}
${s}`;
    }).join(`

---

`);
  }
  /**
   * 
   */
  static async ensureSeparatorEntries(t) {
    await jm(t, "") || await Tm(t, {
      name: "",
      content: "<summary>",
      keys: [""],
      constant: !0,
      order: 8999,
      enabled: !0,
      position: "before_character_definition"
    }), await jm(t, "") || await Tm(t, {
      name: "",
      content: "</summary>",
      keys: [""],
      constant: !0,
      order: 1e4,
      enabled: !0,
      position: "before_character_definition"
    });
  }
  /**
   * 
   */
  static async getNextSummaryOrder(t) {
    const r = (await iu(t)).map((s) => s.order).filter((s) => s >= 9e3 && s < 1e4);
    return r.length === 0 ? 9e3 : Math.max(...r) + 1;
  }
  /**
   * 
   */
  static parseFloorRangeFromName(t) {
    const n = t.match(/_(\d+)-(\d+)/);
    return n ? [parseInt(n[1], 10), parseInt(n[2], 10)] : null;
  }
  /**
   *  (//)
   */
  static getScopes() {
    var s, a;
    const t = Ps(), n = ((s = t == null ? void 0 : t.getGlobalWorldbookNames) == null ? void 0 : s.call(t)) || [], r = ((a = t == null ? void 0 : t.getWorldbookNames) == null ? void 0 : a.call(t)) || [];
    let i = [];
    if (t != null && t.getCharWorldbookNames) {
      const u = t.getCharWorldbookNames("current");
      u && (i = [...u.additional || [], u.primary].filter(Boolean));
    }
    return { global: n, chat: i, installed: r };
  }
}
const a1 = {
  lastSummarizedFloor: 0,
  totalSummaries: 0,
  totalTokens: 0,
  updatedAt: Date.now()
};
class nb {
  /**
   * 
   */
  static async loadState(t) {
    try {
      const n = await jm(t, Xf);
      if (!n)
        return { ...a1 };
      try {
        const r = JSON.parse(n.content);
        return { ...a1, ...r };
      } catch (r) {
        return ee.warn("WorldBookStateService", "", r), { ...a1 };
      }
    } catch (n) {
      return ee.error("WorldBookStateService", "", n), { ...a1 };
    }
  }
  /**
   * 
   */
  static async saveState(t, n) {
    try {
      const i = {
        ...await this.loadState(t),
        ...n,
        updatedAt: Date.now()
      }, s = JSON.stringify(i, null, 2), u = (await iu(t)).filter(
        (d) => d.name === "Engram System State" || d.keys.includes(Xf)
      );
      if (u.length > 0) {
        u.sort((m, x) => {
          const b = m.keys.includes(Xf) ? 1 : 0;
          return (x.keys.includes(Xf) ? 1 : 0) - b;
        });
        const [d, ...f] = u;
        if (f.length > 0) {
          ee.warn("WorldBookStateService", ` ${f.length} ...`);
          for (const m of f)
            await eT(t, m.uid);
        }
        ee.debug("WorldBookStateService", "", { uid: d.uid, state: i });
        const h = {
          content: s,
          name: "Engram System State",
          enabled: !1,
          constant: !1,
          keys: [Xf],
          recursion: {
            prevent_incoming: !0,
            prevent_outgoing: !0
          },
          position: "before_character_definition",
          order: 0
        };
        return await J5(t, d.uid, h);
      } else
        return ee.debug("WorldBookStateService", "", { state: i }), await Tm(t, {
          name: "Engram System State",
          content: s,
          keys: [Xf],
          enabled: !1,
          constant: !1,
          position: "before_character_definition",
          role: "system",
          order: 0,
          recursion: {
            prevent_incoming: !0,
            prevent_outgoing: !0
          }
        });
    } catch (r) {
      return ee.error("WorldBookStateService", "", r), !1;
    }
  }
}
const DG = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  WorldBookStateService: nb
}, Symbol.toStringTag, { value: "Module" })), P0 = "Worldbook";
class Uz {
  /**
   *  WorldBook 
   * 
   */
  static async init() {
    if (!this.isInitialized)
      try {
        const t = await Ho.getOrCreateWorldbook();
        if (!t) {
          ee.warn(P0, "");
          return;
        }
        const n = await jm(t, m3);
        if (n) {
          ee.debug(P0, "", {
            uid: n.uid,
            name: n.name
          }), this.isInitialized = !0;
          return;
        }
        await Tm(t, {
          name: g3,
          content: `{{engramEntityStates}}
{{engramSummaries}}`,
          keys: [m3],
          constant: !0,
          enabled: !0,
          position: "at_depth",
          role: "system",
          depth: 999,
          order: 9e3
          //  order
        }) ? (ee.success(P0, "", {
          worldbook: t,
          name: g3
        }), this.isInitialized = !0) : ee.error(P0, "");
      } catch (t) {
        ee.error(P0, "", t);
      }
  }
  /**
   * 
   */
  static isReady() {
    return this.isInitialized;
  }
  /**
   * 
   */
  static reset() {
    this.isInitialized = !1;
  }
}
lt(Uz, "isInitialized", !1);
class Ba {
  // =========================================================================
  // Metrics  (metrics.ts)
  // =========================================================================
  static async countTokens(t) {
    return em.countTokens(t);
  }
  static async countTokensBatch(t) {
    return em.countTokensBatch(t);
  }
  static async countSummaryTokens(t) {
    return em.countSummaryTokens(t);
  }
  static async getWorldbookTokenStats(t) {
    return em.getWorldbookTokenStats(t);
  }
  static isAvailable() {
    return Ps() !== null;
  }
  static async isNativeTokenCountAvailable() {
    return em.isNativeTokenCountAvailable();
  }
  // =========================================================================
  // CRUD  (crud.ts)
  // =========================================================================
  static async getEntries(t) {
    return iu(t);
  }
  static async getWorldbookNames() {
    return $z();
  }
  static async deleteWorldbook(t) {
    return qz(t);
  }
  static async createEntry(t, n) {
    return Tm(t, n);
  }
  static async updateEntry(t, n, r) {
    return J5(t, n, r);
  }
  static async deleteEntry(t, n) {
    return eT(t, n);
  }
  static async deleteEntries(t, n) {
    return Fz(t, n);
  }
  static async findEntryByKey(t, n) {
    return jm(t, n);
  }
  // =========================================================================
  // Scanner  (scanner.ts)
  // =========================================================================
  static async getActivatedWorldInfo(t, n) {
    return y3.getActivatedWorldInfo(t, n);
  }
  static async scanWorldbook(t, n) {
    return y3.scanWorldbook(t, n);
  }
  static getScopes() {
    return Ho.getScopes();
  }
  /**
   *  UI 
   */
  static async getWorldbookStructure() {
    var a;
    const t = Ps();
    if (!t) return {};
    const n = ((a = t.getWorldbookNames) == null ? void 0 : a.call(t)) || [];
    let r = [];
    if (t.getCharWorldbookNames) {
      const u = t.getCharWorldbookNames("current");
      u && (r = [...u.additional || [], u.primary].filter(Boolean));
    }
    const i = Array.from(/* @__PURE__ */ new Set([...n, ...r])).sort(), s = {};
    for (const u of i)
      try {
        const d = await iu(u);
        s[u] = d.map((f) => {
          var h;
          return {
            uid: f.uid,
            name: f.name,
            keys: f.keys,
            constant: f.constant,
            comment: f.comment || "",
            content: ((h = f.content) == null ? void 0 : h.substring(0, 50)) + "..."
          };
        });
      } catch {
        s[u] = [];
      }
    return s;
  }
  // =========================================================================
  // Engram  (engram.ts)
  // =========================================================================
  static findExistingWorldbook() {
    return Ho.findExistingWorldbook();
  }
  static async getOrCreateWorldbook() {
    return Ho.getOrCreateWorldbook();
  }
  static async getChatWorldbook() {
    return Ho.getOrCreateWorldbook();
  }
  static async getEngramSummariesContent() {
    return Ho.getEngramSummariesContent();
  }
  static async getSummaryEntries(t) {
    return Ho.getSummaryEntries(t);
  }
  static async ensureSeparatorEntries(t) {
    return Ho.ensureSeparatorEntries(t);
  }
  static async getNextSummaryOrder(t) {
    return Ho.getNextSummaryOrder(t);
  }
  static parseFloorRangeFromName(t) {
    return Ho.parseFloorRangeFromName(t);
  }
}
const Hz = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  SLOT_ENTRY_KEY: m3,
  SLOT_ENTRY_NAME: g3,
  STATE_ENTRY_KEY: Xf,
  SUMMARY_ENTRY_KEY: Q5,
  WorldBookSlotService: Uz,
  WorldBookStateService: nb,
  WorldInfoService: Ba,
  WorldbookEngramService: Ho,
  WorldbookMetricsService: em,
  WorldbookScannerService: y3,
  createEntry: Tm,
  deleteEntries: Fz,
  deleteEntry: eT,
  deleteWorldbook: qz,
  findEntryByKey: jm,
  getEntries: iu,
  getTavernHelper: Ps,
  getWorldbookNames: $z,
  updateEntry: J5
}, Symbol.toStringTag, { value: "Module" }));
async function zG() {
  const { EventBus: e } = await Promise.resolve().then(() => Bz), { MessageService: t } = await Promise.resolve().then(() => are), { WorldInfoService: n } = await Promise.resolve().then(() => Hz);
  return {
    eventBus: e.isAvailable(),
    messageService: t.isAvailable(),
    worldInfoService: n.isAvailable(),
    nativeTokenCount: await n.isNativeTokenCountAvailable(),
    floorCount: t.isAvailable() ? t.getFloorCount() : null,
    characterName: t.isAvailable() ? t.getCurrentCharacterName() : null
  };
}
const Vz = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  EventBus: ao,
  TavernEventType: Qo,
  WorldInfoService: Ba,
  checkTavernIntegration: zG
}, Symbol.toStringTag, { value: "Module" }));
class PG {
  /**
   * 
   * @returns Promise
   */
  async requestRevision(t, n, r, i = ["confirm"]) {
    return new Promise((s) => {
      ao.emit(Qo.ENGRAM_REQUEST_REVISION, {
        title: t,
        description: n,
        content: r,
        actions: i,
        onResult: (a) => s(a)
      });
    });
  }
}
const IG = new PG();
var qn = /* @__PURE__ */ ((e) => (e[e.DEBUG = 0] = "DEBUG", e[e.INFO = 1] = "INFO", e[e.SUCCESS = 2] = "SUCCESS", e[e.WARN = 3] = "WARN", e[e.ERROR = 4] = "ERROR", e))(qn || {});
const rb = {
  0: { label: "DEBUG", icon: "", color: "#6c757d" },
  1: { label: "INFO", icon: "", color: "#17a2b8" },
  2: { label: "OK", icon: "", color: "#28a745" },
  3: { label: "WARN", icon: "", color: "#ffc107" },
  4: { label: "ERROR", icon: "", color: "#dc3545" }
}, LG = {
  maxEntries: 5e3,
  minLevel: 0
  /* DEBUG */
}, Gz = new Z5();
let Vu = [], ay = { ...LG }, zA = !1;
function BG(e) {
  return new Date(e).toTimeString().slice(0, 8);
}
function tm(e, t, n, r) {
  if (e < ay.minLevel) return;
  const i = {
    id: Yo(),
    timestamp: Date.now(),
    level: e,
    module: t,
    message: n,
    data: r
  };
  Vu.push(i), Vu.length > ay.maxEntries && (Vu = Vu.slice(-ay.maxEntries)), Gz.next(i);
}
function $G() {
  X5.subscribe((e) => {
    const n = {
      INGESTION_START: qn.INFO,
      INGESTION_COMPLETE: qn.SUCCESS,
      ENTITY_CREATED: qn.INFO,
      MEMORY_STORED: qn.SUCCESS,
      RETRIEVAL_START: qn.DEBUG,
      RETRIEVAL_COMPLETE: qn.SUCCESS,
      CHAT_CHANGED: qn.INFO,
      MESSAGE_RECEIVED: qn.DEBUG
    }[e.type] ?? qn.DEBUG;
    tm(n, "EventBus", `${e.type}`, e.payload);
  });
}
const ee = {
  /**
   *  Logger
   *  EventBus 
   */
  init(e) {
    Vu = [], e && (ay = { ...ay, ...e }), zA || ($G(), zA = !0), ee.info("System", "Logger ");
  },
  /**
   * DEBUG  ()
   */
  debug(e, t, n) {
    tm(qn.DEBUG, e, t, n);
  },
  /**
   * INFO  ()
   */
  info(e, t, n) {
    tm(qn.INFO, e, t, n);
  },
  /**
   * SUCCESS  ()
   */
  success(e, t, n) {
    tm(qn.SUCCESS, e, t, n);
  },
  /**
   * WARN  ()
   */
  warn(e, t, n) {
    tm(qn.WARN, e, t, n);
  },
  /**
   * ERROR  ()
   */
  error(e, t, n) {
    tm(qn.ERROR, e, t, n);
  },
  /**
   * 
   */
  getLogs() {
    return [...Vu];
  },
  /**
   * 
   * @returns 
   */
  subscribe(e) {
    const t = Gz.subscribe(e);
    return () => t.unsubscribe();
  },
  /**
   * 
   */
  clear() {
    Vu = [], ee.info("Logger", "");
  },
  /**
   *  Markdown 
   * 
   */
  exportToMarkdown() {
    const e = /* @__PURE__ */ new Date(), t = {
      [qn.DEBUG]: "DEBUG",
      [qn.INFO]: "INFO",
      [qn.SUCCESS]: "SUCCESS",
      [qn.WARN]: "WARN",
      [qn.ERROR]: "ERROR"
    };
    let n = `# Engram Debug Log

`;
    n += `- ****: ${e.toLocaleString("zh-CN")}
`, n += `- ****: ${Y5.version}
`, n += `- ****: ${Vu.length}

`, n += `---

`, n += `## 

`, n += "```m\n";
    for (const r of Vu) {
      const i = BG(r.timestamp), s = t[r.level].padEnd(7), a = r.module.padEnd(16);
      if (n += `[${i}] [${a}] ${s} ${r.message}
`, r.data !== void 0)
        try {
          const u = JSON.stringify(r.data, null, 2).split(`
`).map((d) => `    ${d}`).join(`
`);
          n += `${u}
`;
        } catch {
          n += `    [Data serialization failed]
`;
        }
    }
    return n += "```\n", n;
  },
  /**
   * 
   * : engram_log_YYYY-MM-DD_HHMMSS.md
   */
  getExportFilename() {
    const e = /* @__PURE__ */ new Date(), t = e.toISOString().slice(0, 10), n = e.toTimeString().slice(0, 8).replace(/:/g, "");
    return `engram_log_${t}_${n}.md`;
  }
};
var Fe = /* @__PURE__ */ ((e) => (e.SYSTEM = "System", e.EVENTS = "System/Events", e.MEMORY_SUMMARY = "Memory/Summary", e.MEMORY_ENTITY = "Memory/Entity", e.MEMORY_TRIM = "Memory/Trim", e.RAG_EMBED = "RAG/Embed", e.RAG_RETRIEVE = "RAG/Retrieve", e.RAG_RERANK = "RAG/Rerank", e.RAG_INJECT = "RAG/Inject", e.RAG_CACHE = "RAG/Cache", e.PREPROCESS = "Preprocess", e.BATCH = "Batch", e.DATA_SYNC = "Data/Sync", e.DATA_CLEANUP = "Data/Cleanup", e.DATA_DB = "Data/DB", e.TAVERN = "Tavern", e.LLM = "LLM", e))(Fe || {});
const Kz = Object.values(Fe), tT = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  ALL_MODULES: Kz,
  LogLevel: qn,
  LogLevelConfig: rb,
  LogModule: Fe,
  Logger: ee
}, Symbol.toStringTag, { value: "Module" })), qG = `id: builtin_description_enhance
name: 
category: preprocessing
enabled: false
injectionMode: replace
userPromptTemplate: |
  ****:
  {{context}}

  ****:
  {{userPersona}}

  ****:
  {{engramSummaries}}

  ****:
  {{chatHistory}}

  ****:
  {{userInput}}

  ---
  

  ****
systemPrompt: |
  <system_configuration>
    <role_definition>
      : 
      : 
      : ""(Show, Don't Tell)
    </role_definition>

    <enhancement_protocol>
      1.  (Sensory Immersion):
         - (Visual):  ()
         - (Auditory):  ()
         - /(Olfactory/Tactile):  ()

      2.  (Environmental Synergy):
         - 
         -  ("""")

      3.  (Action Refinement):
         - 
         - : "" -> ""

      4.  (Psychological Projection):
         - ""
    </enhancement_protocol>

    <output_constraint>
      :
      1. 
      2. **** <output>  </output> 
      3. <think> 
    </output_constraint>

    <output_template>
      <think>
      :
        - : \${}
        - : \${}

      :
        - : ...
        - /: ...
        - : ...
        - : ...
      </think>

      <output>
      \${}
      </output>
    </output_template>

    <examples>
      <example>
        Input: 
        Output:
        <think>
        : /
        : 
        </think>
        <output>
        
        </output>
      </example>
      <example>
        Input: 
        Output:
        <think>
        : /
        : 
        </think>
        <output>
        
        </output>
      </example>
    </examples>
  </system_configuration>

  ## 

  {{userInput}}
`, FG = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  default: qG
}, Symbol.toStringTag, { value: "Module" })), UG = `id: builtin_entity_extraction
name: 
category: entity_extraction
enabled: true
injectionMode: replace
userPromptTemplate: |
  ****:
  {{worldbookContext}}
  ()

  ****:
  {{engramSummaries}}

  

  

  ****:
  {{chatHistory}}

  ****:
  {{engramEntityStates}}

  (,)
  ---
  JSON patch

  **** JSON 
systemPrompt: |
  <system_configuration>
    <role_definition>
      : 
      : 

      :
        : 
        : 

      :
        - 
        - 
        -  existingEntities
        - 
    </role_definition>

    <entity_types>
      char: / ()
      loc:  ()
      item:  ()
      concept: 
      unknown: 
    </entity_types>

    <logic_protocol>
       (Naming Specificity):
        : 
        :
          : "" ()
          : "" ()
          : "" ()
          : "" ()
          : "" ()
          : "" ()

       (Significance Filter):
        : 
        :
          - ()
          - (3)
          - ()
        :
          : "" ()
          : ""

       (Granularity Control):
        : 
        :
          : 
          : "" (Entity)
          : """" ()

       (State vs Identity):
        : 
        :
          : "" (Entity Name)
          : "" (Entity Name), / ""

       (Deduplication):
        : 
        :
          -  existingEntities
          - """" entity  name  "" ""  aliases
    </logic_protocol>

    <update_strategy>
      : RFC 6902 (JSON Patch)
      :
        -  existingEntities  patches 
        -  (op: replace/add/remove)
        - path  JSON Pointer ( /profile/status)
      :
        : { name: "A", profile: { status: "" } }
        : A 
        :
          patches:
            - name: "A"
            ops:
              - { op: "replace", path: "/profile/status", value: "" }
    </update_strategy>

    <profile_structure>
      profile  JSON 

       ():
        - relations: EntityRelation[]  
          : target (), type ()
          : description ()

       ():
        - identity: string  
        - tags: string[]  

       (char) :
        - personality: string  
        - skills: string[]  /
        - affiliation: string  

       (loc) :
        - atmosphere: string  
        - features: string[]  

       (item) :
        - owner: string  
        - abilities: string[]  
    </profile_structure>

    <output_template>
      <think>
        
          -  existingEntities 
          - /

        
          - : ("" -> "A")
          - : ()
          - : 

        (JSON Patch)
          -  existingEntities 
          -  replace/add/remove 
          - 

        
          - 
          - 
      </think>

      \`\`\`json
      {
        "entities": [
          {
            "name": "",
            "type": "char|loc|item|concept",
            "aliases": ["1", "2"],
            "profile": {
              "identity": "",
              "relations": [
                { "target": "", "type": "", "description": "" }
              ],
              "": ""
            }
          }
        ]
      }
      \`\`\`
    </output_template>

    <example_demonstration>
      :
        chatHistory: "ABAB"
        existingEntities: []

      :
        \`\`\`json
                  { "target": "A", "type": "", "description": "A" }
                ]
              }
            },
            {
              "name": "",
              "type": "loc",
              "aliases": [],
              "profile": {
                "atmosphere": "",
                "features": ["", ""]
              }
            }
          ]
        }
        \`\`\`
    </example_demonstration>
  </system_configuration>
`, HG = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  default: UG
}, Symbol.toStringTag, { value: "Module" })), VG = `id: builtin_plot_director
name: 
category: preprocessing
enabled: false
injectionMode: append
userPromptTemplate: |
  ****:
  {{context}}

  ****:
  {{userPersona}}

  ****:
  {{worldbookContext}}

  ****:
  {{engramSummaries}}

  ****:
  {{chatHistory}}

  ****:
  {{userInput}}

  ---
  



  ****
systemPrompt: |
  <system_configuration>
    <role_definition>
      : 
      : """"

      :
        : 
        : 
        : 
        : 

      :
        :
          : {{roll:1d100}} // 
          : {{roll:1d10}} // 

      :
        : 
        : 
        : 

      :
        - 
        - 
        - 
        - <plot>
        - 
        - User"""xx"
        - ""
        - """"
    </role_definition>

    <behavior_guidelines>
      :
        : 
        :  -> <think> -> <output>
        : """"""
        :
          - : 
          - : 
          - : User
          - : 
    </behavior_guidelines>

    <core_rules>
      A_:
        A1_: NPC
        A2_: 
        A3_: ()()()
        A4_: (++)100
        A5_: 10%

      B_ ():
        B0_: []
        B1_:
          - 1:  ()
          - 2-15:  ()
          - 16-81:  ()
          - 82-84:  ()
          - 85-99:  ()
          - 100:  ()
        B2_: 1-2

      C_:
        C1_: >=100[][](/)
        C2_: (/)
    </core_rules>

    <output_template>
      <think>
        
          : \${}
          : \${}
          : \${ vs }

        
          - \${}
          - \${}
          - \${}

        
          - : \${}
          - : \${} vs \${} -> \${}
          - : \${}

        
          - : \${}
          - : (\${}), (\${}), (\${})
          - : \${}

        
          - : \${} (\${//...})
          - : \${}

        
          - : \${}
          - : \${}
          - : \${}
          - : \${}

        
          - : \${}
          - : \${rerank}
      </think>

      <query>
      rerank_instruction: "\${}"
      retrieval_queries:
        - "\${1}"
        - "\${2}"
        - "\${3}"
      </query>

      <output>
      <plot>
        <directive>
          <goal>\${}</goal>
          <plot_summary>\${}</plot_summary>
          <key_points>
            <point>\${(): }</point>
            <point>\${: }</point>
            <point>\${: }</point>
            <point>\${: +}</point>
            <point>\${: }</point>
            <point>\${: }</point>
          </key_points>
        </directive>

        :
          : \${}
          : \${}/100 \${}
          : \${}/100
          : \${}/100
          : \${} 

          : \${}
          : \${}
          : \${}
          : \${NPC -  ()}
          : \${NPC -  ()}

          :
            // : [] [: X] 
            1: \${1}
            2: \${2}
      </plot>
      </output>
    </output_template>
  </system_configuration>
`, GG = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  default: VG
}, Symbol.toStringTag, { value: "Module" })), KG = `id: builtin_query_enhance
name: Query 
category: preprocessing
enabled: true
injectionMode: append
userPromptTemplate: |
  ****:
  {{context}}

  ****:
  {{userPersona}}

  ****:
  {{worldbookContext}}

  ****:
  {{engramSummaries}}

  ****:
  {{chatHistory}}

  ****:
  {{userInput}}

  ---
  

  ****
systemPrompt: |
  <system_configuration>
    <role_definition>
      : 
      : RAG
      :
        1. : /
        2. : 
        3. : 
    </role_definition>

    <output_template>
      <think>
        
          - \${}

        
          - \${}
          - \${}

        
          - \${rerank_instruction}

         YAML 
          - \${}
      </think>

      <query>
      rerank_instruction: "\${}"
      retrieval_queries:
        - "\${1}"
        - "\${2}"
        - "\${3}"
      </query>
    </output_template>

    <examples>
      <example>
        Input: **
        Output:
        <think>
          :
            : ""
            : , , , 032-E, 
            : 

          : 
        </think>

        <query>
        rerank_instruction: "''''"
        retrieval_queries:
          - "   "
          - "  032-E  "
          - "    "
          - "   "
          - "   "
          - "    "
        </query>
      </example>
      <example>
        Input: 
        Output:
        <think>
          :
            : "" Alice  Bob""
            : Alice, Bob, , , 
            : 

          : 
        </think>

        <query>
        rerank_instruction: "'AliceBob'''"
        retrieval_queries:
          - "Alice Bob   "
          - "Alice  Bob  "
          - "   "
        </query>
      </example>
    </examples>
  </system_configuration>
`, YG = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  default: KG
}, Symbol.toStringTag, { value: "Module" })), WG = `id: builtin_summary
name:  ()
category: summary
enabled: true
injectionMode: replace
userPromptTemplate: |
  ****:
  {{context}}

  ****:
  {{userPersona}}

  ****:
  {{worldbookContext}}

  ****:
  {{engramSummaries}}

  ---
  

  {{chatHistory}}

   JSON 



  **** JSON 
systemPrompt: |
  <system_configuration>
    <role_definition>
      : 
      : """"""

      :
        : 
        : 
        : 
        : 

      :
        - 
        -  YAML 
        - 
        - 
    </role_definition>

    <formatting_protocol>
      :  JSON 
      :
        - summary: //''
        - meta:  (role, location, event, logic, causality)
        - significance_score: 0.0-1.0 
    </formatting_protocol>

    <logic_protocol>
      :
        : ""
        : """"

       (Dialogue Preservation):
        - :  \`significance_score\` >= 0.7 \`summary\` 
          1. : 
          2. : 
          3. : 
          4. /: 
        - :  +''

      :
        : 
        : **** (Calendar Timestamp)
        : """""X"
        : 
          : [][][][] (: 102344)
        : 
          :  HH:MM (14:30)
          :  
          :   

       (Token):
        : 
        : 

       ():
        -: 
        : ""
        : 
        : 

       ():
        _ (Foundation): 0.1 - 0.4
        _ (Propulsion): 0.5 - 0.7
        _ (Keystone): 0.8 - 0.9
        _ (Turning Point): 1.0
    </logic_protocol>

    <output_template>
      <think>
        
          - : \${}
          - : \${}

        
          - : \${/}
          - : \${/}

        
          - : \${}
          - : \${ summary}
          - : \${}

        
      </think>

      \`\`\`json
      {
        "events": [
          {
            "summary": "'...'",
            "meta": {
              "time_anchor": "",
              "role": [""],
              "location": ["1"],
              "event": "",
              "logic": [""],
              "causality": "Start|Chain|End"
            },
            "significance_score": 0.7
          }
        ]
      }
      \`\`\`
    </output_template>

    <example_demonstration>
      :
        "102351'' "

      AI:
        <think>
          
            - : /
            - : 

          :
            - 

          :
            -  +  +  +  +  = 
        </think>

        \`\`\`json
        {
          "events": [
            {
              "summary": "''",
              "meta": {
                "time_anchor": "102351 ",
                "role": ["", ""],
                "location": [""],
                "event": "",
                "logic": ["", "", ""],
                "causality": "End"
              },
              "significance_score": 1.0
            }
          ]
        }
        \`\`\`
    </example_demonstration>
  </system_configuration>
`, ZG = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  default: WG
}, Symbol.toStringTag, { value: "Module" })), XG = `id: builtin_trim
name: 
category: trim
enabled: true
injectionMode: replace
userPromptTemplate: |
  {{worldbookContext}}
  

  

  {{engramSummaries}}

  

  **** JSON 
systemPrompt: |
  <system_configuration>
    <role_definition>
      : 
      : ""**** Token 

      :
        : 
        : 

      :
        - 
        - 
        - 
    </role_definition>

    <compression_protocol>
      _:
        : 
        :
          - P0 (): //
          - P1 (): /
          - P2 (): 

      _:
        : 
        : ****"X"
        : time_anchor  "102344-102744"

      _:
        : 
        :
          : "A " + "A "  "A " ()
          : "A "
    </compression_protocol>

    <merge_strategy>
      : ****

      summary :
        - : 200-300 
        - : 
        - : 

      meta :
        - time_anchor:  "1023-1026""X"
        - role: 
        - location: 
        - event:  ""
        - logic: 
        - causality:  "Chain"

      :  significance_score
    </merge_strategy>

    <output_format>
      <think>
        
          - : \${P0/P1}
          - : \${}
          - : \${}

        
          - : \${}
          - : \${P2200-300}

        
          - JSON : \${ \`{ "events": [...] }\`****}
      </think>

       JSON****

      \`\`\`json
      {
        "events": [
          {
            "summary": "200-300...",
            "meta": {
              "time_anchor": "-",
              "role": ["1", "2"],
              "location": ["1", "2"],
              "event": "",
              "logic": ["1", "2"],
              "causality": "Chain"
            },
            "significance_score": 0.8
          }
        ]
      }
      \`\`\`
    </output_format>

    <example_demonstration>
       (6):
        \`\`\`
        (102344 ) AB
        (102344 ) BA
        (1023-1026 ) AB
        (1026 ) A
        (410 ) A
        (410 14:30) A
        \`\`\`

       (1):
        <think>
          
            - : /(P0)/(P1)(P1)/(P0)(P1)(P1) -> 
            - :  "102344" "410" "102344-410"
            - : A, B, ,  ()
            - :  ->  -> 

          
            - 
            -  "..."  "..." 
        </think>

        \`\`\`json
        {
          "events": [
            {
              "summary": "ABBAABAA",
              "meta": {
                "time_anchor": "102344-410",
                "role": ["A", "B", "", ""],
                "location": ["", "", "B", "", ""],
                "event": "",
                "logic": ["", "", "", "", "", ""],
                "causality": "Chain"
              },
              "significance_score": 0.8
            }
          ]
        }
        \`\`\`
    </example_demonstration>
  </system_configuration>
`, QG = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  default: XG
}, Symbol.toStringTag, { value: "Module" }));
/*! js-yaml 4.1.1 https://github.com/nodeca/js-yaml @license MIT */
function Yz(e) {
  return typeof e > "u" || e === null;
}
function JG(e) {
  return typeof e == "object" && e !== null;
}
function eK(e) {
  return Array.isArray(e) ? e : Yz(e) ? [] : [e];
}
function tK(e, t) {
  var n, r, i, s;
  if (t)
    for (s = Object.keys(t), n = 0, r = s.length; n < r; n += 1)
      i = s[n], e[i] = t[i];
  return e;
}
function nK(e, t) {
  var n = "", r;
  for (r = 0; r < t; r += 1)
    n += e;
  return n;
}
function rK(e) {
  return e === 0 && Number.NEGATIVE_INFINITY === 1 / e;
}
var iK = Yz, sK = JG, aK = eK, oK = nK, lK = rK, uK = tK, yi = {
  isNothing: iK,
  isObject: sK,
  toArray: aK,
  repeat: oK,
  isNegativeZero: lK,
  extend: uK
};
function Wz(e, t) {
  var n = "", r = e.reason || "(unknown reason)";
  return e.mark ? (e.mark.name && (n += 'in "' + e.mark.name + '" '), n += "(" + (e.mark.line + 1) + ":" + (e.mark.column + 1) + ")", !t && e.mark.snippet && (n += `

` + e.mark.snippet), r + " " + n) : r;
}
function by(e, t) {
  Error.call(this), this.name = "YAMLException", this.reason = e, this.mark = t, this.message = Wz(this, !1), Error.captureStackTrace ? Error.captureStackTrace(this, this.constructor) : this.stack = new Error().stack || "";
}
by.prototype = Object.create(Error.prototype);
by.prototype.constructor = by;
by.prototype.toString = function(t) {
  return this.name + ": " + Wz(this, t);
};
var Ms = by;
function H2(e, t, n, r, i) {
  var s = "", a = "", u = Math.floor(i / 2) - 1;
  return r - t > u && (s = " ... ", t = r - u + s.length), n - r > u && (a = " ...", n = r + u - a.length), {
    str: s + e.slice(t, n).replace(/\t/g, "") + a,
    pos: r - t + s.length
    // relative position
  };
}
function V2(e, t) {
  return yi.repeat(" ", t - e.length) + e;
}
function cK(e, t) {
  if (t = Object.create(t || null), !e.buffer) return null;
  t.maxLength || (t.maxLength = 79), typeof t.indent != "number" && (t.indent = 1), typeof t.linesBefore != "number" && (t.linesBefore = 3), typeof t.linesAfter != "number" && (t.linesAfter = 2);
  for (var n = /\r?\n|\r|\0/g, r = [0], i = [], s, a = -1; s = n.exec(e.buffer); )
    i.push(s.index), r.push(s.index + s[0].length), e.position <= s.index && a < 0 && (a = r.length - 2);
  a < 0 && (a = r.length - 1);
  var u = "", d, f, h = Math.min(e.line + t.linesAfter, i.length).toString().length, m = t.maxLength - (t.indent + h + 3);
  for (d = 1; d <= t.linesBefore && !(a - d < 0); d++)
    f = H2(
      e.buffer,
      r[a - d],
      i[a - d],
      e.position - (r[a] - r[a - d]),
      m
    ), u = yi.repeat(" ", t.indent) + V2((e.line - d + 1).toString(), h) + " | " + f.str + `
` + u;
  for (f = H2(e.buffer, r[a], i[a], e.position, m), u += yi.repeat(" ", t.indent) + V2((e.line + 1).toString(), h) + " | " + f.str + `
`, u += yi.repeat("-", t.indent + h + 3 + f.pos) + `^
`, d = 1; d <= t.linesAfter && !(a + d >= i.length); d++)
    f = H2(
      e.buffer,
      r[a + d],
      i[a + d],
      e.position - (r[a] - r[a + d]),
      m
    ), u += yi.repeat(" ", t.indent) + V2((e.line + d + 1).toString(), h) + " | " + f.str + `
`;
  return u.replace(/\n$/, "");
}
var dK = cK, fK = [
  "kind",
  "multi",
  "resolve",
  "construct",
  "instanceOf",
  "predicate",
  "represent",
  "representName",
  "defaultStyle",
  "styleAliases"
], hK = [
  "scalar",
  "sequence",
  "mapping"
];
function pK(e) {
  var t = {};
  return e !== null && Object.keys(e).forEach(function(n) {
    e[n].forEach(function(r) {
      t[String(r)] = n;
    });
  }), t;
}
function mK(e, t) {
  if (t = t || {}, Object.keys(t).forEach(function(n) {
    if (fK.indexOf(n) === -1)
      throw new Ms('Unknown option "' + n + '" is met in definition of "' + e + '" YAML type.');
  }), this.options = t, this.tag = e, this.kind = t.kind || null, this.resolve = t.resolve || function() {
    return !0;
  }, this.construct = t.construct || function(n) {
    return n;
  }, this.instanceOf = t.instanceOf || null, this.predicate = t.predicate || null, this.represent = t.represent || null, this.representName = t.representName || null, this.defaultStyle = t.defaultStyle || null, this.multi = t.multi || !1, this.styleAliases = pK(t.styleAliases || null), hK.indexOf(this.kind) === -1)
    throw new Ms('Unknown kind "' + this.kind + '" is specified for "' + e + '" YAML type.');
}
var Fi = mK;
function PA(e, t) {
  var n = [];
  return e[t].forEach(function(r) {
    var i = n.length;
    n.forEach(function(s, a) {
      s.tag === r.tag && s.kind === r.kind && s.multi === r.multi && (i = a);
    }), n[i] = r;
  }), n;
}
function gK() {
  var e = {
    scalar: {},
    sequence: {},
    mapping: {},
    fallback: {},
    multi: {
      scalar: [],
      sequence: [],
      mapping: [],
      fallback: []
    }
  }, t, n;
  function r(i) {
    i.multi ? (e.multi[i.kind].push(i), e.multi.fallback.push(i)) : e[i.kind][i.tag] = e.fallback[i.tag] = i;
  }
  for (t = 0, n = arguments.length; t < n; t += 1)
    arguments[t].forEach(r);
  return e;
}
function x3(e) {
  return this.extend(e);
}
x3.prototype.extend = function(t) {
  var n = [], r = [];
  if (t instanceof Fi)
    r.push(t);
  else if (Array.isArray(t))
    r = r.concat(t);
  else if (t && (Array.isArray(t.implicit) || Array.isArray(t.explicit)))
    t.implicit && (n = n.concat(t.implicit)), t.explicit && (r = r.concat(t.explicit));
  else
    throw new Ms("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");
  n.forEach(function(s) {
    if (!(s instanceof Fi))
      throw new Ms("Specified list of YAML types (or a single Type object) contains a non-Type object.");
    if (s.loadKind && s.loadKind !== "scalar")
      throw new Ms("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");
    if (s.multi)
      throw new Ms("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.");
  }), r.forEach(function(s) {
    if (!(s instanceof Fi))
      throw new Ms("Specified list of YAML types (or a single Type object) contains a non-Type object.");
  });
  var i = Object.create(x3.prototype);
  return i.implicit = (this.implicit || []).concat(n), i.explicit = (this.explicit || []).concat(r), i.compiledImplicit = PA(i, "implicit"), i.compiledExplicit = PA(i, "explicit"), i.compiledTypeMap = gK(i.compiledImplicit, i.compiledExplicit), i;
};
var Zz = x3, Xz = new Fi("tag:yaml.org,2002:str", {
  kind: "scalar",
  construct: function(e) {
    return e !== null ? e : "";
  }
}), Qz = new Fi("tag:yaml.org,2002:seq", {
  kind: "sequence",
  construct: function(e) {
    return e !== null ? e : [];
  }
}), Jz = new Fi("tag:yaml.org,2002:map", {
  kind: "mapping",
  construct: function(e) {
    return e !== null ? e : {};
  }
}), eP = new Zz({
  explicit: [
    Xz,
    Qz,
    Jz
  ]
});
function yK(e) {
  if (e === null) return !0;
  var t = e.length;
  return t === 1 && e === "~" || t === 4 && (e === "null" || e === "Null" || e === "NULL");
}
function xK() {
  return null;
}
function vK(e) {
  return e === null;
}
var tP = new Fi("tag:yaml.org,2002:null", {
  kind: "scalar",
  resolve: yK,
  construct: xK,
  predicate: vK,
  represent: {
    canonical: function() {
      return "~";
    },
    lowercase: function() {
      return "null";
    },
    uppercase: function() {
      return "NULL";
    },
    camelcase: function() {
      return "Null";
    },
    empty: function() {
      return "";
    }
  },
  defaultStyle: "lowercase"
});
function bK(e) {
  if (e === null) return !1;
  var t = e.length;
  return t === 4 && (e === "true" || e === "True" || e === "TRUE") || t === 5 && (e === "false" || e === "False" || e === "FALSE");
}
function wK(e) {
  return e === "true" || e === "True" || e === "TRUE";
}
function _K(e) {
  return Object.prototype.toString.call(e) === "[object Boolean]";
}
var nP = new Fi("tag:yaml.org,2002:bool", {
  kind: "scalar",
  resolve: bK,
  construct: wK,
  predicate: _K,
  represent: {
    lowercase: function(e) {
      return e ? "true" : "false";
    },
    uppercase: function(e) {
      return e ? "TRUE" : "FALSE";
    },
    camelcase: function(e) {
      return e ? "True" : "False";
    }
  },
  defaultStyle: "lowercase"
});
function SK(e) {
  return 48 <= e && e <= 57 || 65 <= e && e <= 70 || 97 <= e && e <= 102;
}
function EK(e) {
  return 48 <= e && e <= 55;
}
function CK(e) {
  return 48 <= e && e <= 57;
}
function kK(e) {
  if (e === null) return !1;
  var t = e.length, n = 0, r = !1, i;
  if (!t) return !1;
  if (i = e[n], (i === "-" || i === "+") && (i = e[++n]), i === "0") {
    if (n + 1 === t) return !0;
    if (i = e[++n], i === "b") {
      for (n++; n < t; n++)
        if (i = e[n], i !== "_") {
          if (i !== "0" && i !== "1") return !1;
          r = !0;
        }
      return r && i !== "_";
    }
    if (i === "x") {
      for (n++; n < t; n++)
        if (i = e[n], i !== "_") {
          if (!SK(e.charCodeAt(n))) return !1;
          r = !0;
        }
      return r && i !== "_";
    }
    if (i === "o") {
      for (n++; n < t; n++)
        if (i = e[n], i !== "_") {
          if (!EK(e.charCodeAt(n))) return !1;
          r = !0;
        }
      return r && i !== "_";
    }
  }
  if (i === "_") return !1;
  for (; n < t; n++)
    if (i = e[n], i !== "_") {
      if (!CK(e.charCodeAt(n)))
        return !1;
      r = !0;
    }
  return !(!r || i === "_");
}
function TK(e) {
  var t = e, n = 1, r;
  if (t.indexOf("_") !== -1 && (t = t.replace(/_/g, "")), r = t[0], (r === "-" || r === "+") && (r === "-" && (n = -1), t = t.slice(1), r = t[0]), t === "0") return 0;
  if (r === "0") {
    if (t[1] === "b") return n * parseInt(t.slice(2), 2);
    if (t[1] === "x") return n * parseInt(t.slice(2), 16);
    if (t[1] === "o") return n * parseInt(t.slice(2), 8);
  }
  return n * parseInt(t, 10);
}
function jK(e) {
  return Object.prototype.toString.call(e) === "[object Number]" && e % 1 === 0 && !yi.isNegativeZero(e);
}
var rP = new Fi("tag:yaml.org,2002:int", {
  kind: "scalar",
  resolve: kK,
  construct: TK,
  predicate: jK,
  represent: {
    binary: function(e) {
      return e >= 0 ? "0b" + e.toString(2) : "-0b" + e.toString(2).slice(1);
    },
    octal: function(e) {
      return e >= 0 ? "0o" + e.toString(8) : "-0o" + e.toString(8).slice(1);
    },
    decimal: function(e) {
      return e.toString(10);
    },
    /* eslint-disable max-len */
    hexadecimal: function(e) {
      return e >= 0 ? "0x" + e.toString(16).toUpperCase() : "-0x" + e.toString(16).toUpperCase().slice(1);
    }
  },
  defaultStyle: "decimal",
  styleAliases: {
    binary: [2, "bin"],
    octal: [8, "oct"],
    decimal: [10, "dec"],
    hexadecimal: [16, "hex"]
  }
}), AK = new RegExp(
  // 2.5e4, 2.5 and integers
  "^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$"
);
function NK(e) {
  return !(e === null || !AK.test(e) || // Quick hack to not allow integers end with `_`
  // Probably should update regexp & check speed
  e[e.length - 1] === "_");
}
function RK(e) {
  var t, n;
  return t = e.replace(/_/g, "").toLowerCase(), n = t[0] === "-" ? -1 : 1, "+-".indexOf(t[0]) >= 0 && (t = t.slice(1)), t === ".inf" ? n === 1 ? Number.POSITIVE_INFINITY : Number.NEGATIVE_INFINITY : t === ".nan" ? NaN : n * parseFloat(t, 10);
}
var MK = /^[-+]?[0-9]+e/;
function OK(e, t) {
  var n;
  if (isNaN(e))
    switch (t) {
      case "lowercase":
        return ".nan";
      case "uppercase":
        return ".NAN";
      case "camelcase":
        return ".NaN";
    }
  else if (Number.POSITIVE_INFINITY === e)
    switch (t) {
      case "lowercase":
        return ".inf";
      case "uppercase":
        return ".INF";
      case "camelcase":
        return ".Inf";
    }
  else if (Number.NEGATIVE_INFINITY === e)
    switch (t) {
      case "lowercase":
        return "-.inf";
      case "uppercase":
        return "-.INF";
      case "camelcase":
        return "-.Inf";
    }
  else if (yi.isNegativeZero(e))
    return "-0.0";
  return n = e.toString(10), MK.test(n) ? n.replace("e", ".e") : n;
}
function DK(e) {
  return Object.prototype.toString.call(e) === "[object Number]" && (e % 1 !== 0 || yi.isNegativeZero(e));
}
var iP = new Fi("tag:yaml.org,2002:float", {
  kind: "scalar",
  resolve: NK,
  construct: RK,
  predicate: DK,
  represent: OK,
  defaultStyle: "lowercase"
}), sP = eP.extend({
  implicit: [
    tP,
    nP,
    rP,
    iP
  ]
}), aP = sP, oP = new RegExp(
  "^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"
), lP = new RegExp(
  "^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$"
);
function zK(e) {
  return e === null ? !1 : oP.exec(e) !== null || lP.exec(e) !== null;
}
function PK(e) {
  var t, n, r, i, s, a, u, d = 0, f = null, h, m, x;
  if (t = oP.exec(e), t === null && (t = lP.exec(e)), t === null) throw new Error("Date resolve error");
  if (n = +t[1], r = +t[2] - 1, i = +t[3], !t[4])
    return new Date(Date.UTC(n, r, i));
  if (s = +t[4], a = +t[5], u = +t[6], t[7]) {
    for (d = t[7].slice(0, 3); d.length < 3; )
      d += "0";
    d = +d;
  }
  return t[9] && (h = +t[10], m = +(t[11] || 0), f = (h * 60 + m) * 6e4, t[9] === "-" && (f = -f)), x = new Date(Date.UTC(n, r, i, s, a, u, d)), f && x.setTime(x.getTime() - f), x;
}
function IK(e) {
  return e.toISOString();
}
var uP = new Fi("tag:yaml.org,2002:timestamp", {
  kind: "scalar",
  resolve: zK,
  construct: PK,
  instanceOf: Date,
  represent: IK
});
function LK(e) {
  return e === "<<" || e === null;
}
var cP = new Fi("tag:yaml.org,2002:merge", {
  kind: "scalar",
  resolve: LK
}), nT = `ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;
function BK(e) {
  if (e === null) return !1;
  var t, n, r = 0, i = e.length, s = nT;
  for (n = 0; n < i; n++)
    if (t = s.indexOf(e.charAt(n)), !(t > 64)) {
      if (t < 0) return !1;
      r += 6;
    }
  return r % 8 === 0;
}
function $K(e) {
  var t, n, r = e.replace(/[\r\n=]/g, ""), i = r.length, s = nT, a = 0, u = [];
  for (t = 0; t < i; t++)
    t % 4 === 0 && t && (u.push(a >> 16 & 255), u.push(a >> 8 & 255), u.push(a & 255)), a = a << 6 | s.indexOf(r.charAt(t));
  return n = i % 4 * 6, n === 0 ? (u.push(a >> 16 & 255), u.push(a >> 8 & 255), u.push(a & 255)) : n === 18 ? (u.push(a >> 10 & 255), u.push(a >> 2 & 255)) : n === 12 && u.push(a >> 4 & 255), new Uint8Array(u);
}
function qK(e) {
  var t = "", n = 0, r, i, s = e.length, a = nT;
  for (r = 0; r < s; r++)
    r % 3 === 0 && r && (t += a[n >> 18 & 63], t += a[n >> 12 & 63], t += a[n >> 6 & 63], t += a[n & 63]), n = (n << 8) + e[r];
  return i = s % 3, i === 0 ? (t += a[n >> 18 & 63], t += a[n >> 12 & 63], t += a[n >> 6 & 63], t += a[n & 63]) : i === 2 ? (t += a[n >> 10 & 63], t += a[n >> 4 & 63], t += a[n << 2 & 63], t += a[64]) : i === 1 && (t += a[n >> 2 & 63], t += a[n << 4 & 63], t += a[64], t += a[64]), t;
}
function FK(e) {
  return Object.prototype.toString.call(e) === "[object Uint8Array]";
}
var dP = new Fi("tag:yaml.org,2002:binary", {
  kind: "scalar",
  resolve: BK,
  construct: $K,
  predicate: FK,
  represent: qK
}), UK = Object.prototype.hasOwnProperty, HK = Object.prototype.toString;
function VK(e) {
  if (e === null) return !0;
  var t = [], n, r, i, s, a, u = e;
  for (n = 0, r = u.length; n < r; n += 1) {
    if (i = u[n], a = !1, HK.call(i) !== "[object Object]") return !1;
    for (s in i)
      if (UK.call(i, s))
        if (!a) a = !0;
        else return !1;
    if (!a) return !1;
    if (t.indexOf(s) === -1) t.push(s);
    else return !1;
  }
  return !0;
}
function GK(e) {
  return e !== null ? e : [];
}
var fP = new Fi("tag:yaml.org,2002:omap", {
  kind: "sequence",
  resolve: VK,
  construct: GK
}), KK = Object.prototype.toString;
function YK(e) {
  if (e === null) return !0;
  var t, n, r, i, s, a = e;
  for (s = new Array(a.length), t = 0, n = a.length; t < n; t += 1) {
    if (r = a[t], KK.call(r) !== "[object Object]" || (i = Object.keys(r), i.length !== 1)) return !1;
    s[t] = [i[0], r[i[0]]];
  }
  return !0;
}
function WK(e) {
  if (e === null) return [];
  var t, n, r, i, s, a = e;
  for (s = new Array(a.length), t = 0, n = a.length; t < n; t += 1)
    r = a[t], i = Object.keys(r), s[t] = [i[0], r[i[0]]];
  return s;
}
var hP = new Fi("tag:yaml.org,2002:pairs", {
  kind: "sequence",
  resolve: YK,
  construct: WK
}), ZK = Object.prototype.hasOwnProperty;
function XK(e) {
  if (e === null) return !0;
  var t, n = e;
  for (t in n)
    if (ZK.call(n, t) && n[t] !== null)
      return !1;
  return !0;
}
function QK(e) {
  return e !== null ? e : {};
}
var pP = new Fi("tag:yaml.org,2002:set", {
  kind: "mapping",
  resolve: XK,
  construct: QK
}), rT = aP.extend({
  implicit: [
    uP,
    cP
  ],
  explicit: [
    dP,
    fP,
    hP,
    pP
  ]
}), Ed = Object.prototype.hasOwnProperty, ib = 1, mP = 2, gP = 3, sb = 4, G2 = 1, JK = 2, IA = 3, eY = /[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/, tY = /[\x85\u2028\u2029]/, nY = /[,\[\]\{\}]/, yP = /^(?:!|!!|![a-z\-]+!)$/i, xP = /^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;
function LA(e) {
  return Object.prototype.toString.call(e);
}
function Jl(e) {
  return e === 10 || e === 13;
}
function dh(e) {
  return e === 9 || e === 32;
}
function ca(e) {
  return e === 9 || e === 32 || e === 10 || e === 13;
}
function sm(e) {
  return e === 44 || e === 91 || e === 93 || e === 123 || e === 125;
}
function rY(e) {
  var t;
  return 48 <= e && e <= 57 ? e - 48 : (t = e | 32, 97 <= t && t <= 102 ? t - 97 + 10 : -1);
}
function iY(e) {
  return e === 120 ? 2 : e === 117 ? 4 : e === 85 ? 8 : 0;
}
function sY(e) {
  return 48 <= e && e <= 57 ? e - 48 : -1;
}
function BA(e) {
  return e === 48 ? "\0" : e === 97 ? "\x07" : e === 98 ? "\b" : e === 116 || e === 9 ? "	" : e === 110 ? `
` : e === 118 ? "\v" : e === 102 ? "\f" : e === 114 ? "\r" : e === 101 ? "\x1B" : e === 32 ? " " : e === 34 ? '"' : e === 47 ? "/" : e === 92 ? "\\" : e === 78 ? "" : e === 95 ? "" : e === 76 ? "\u2028" : e === 80 ? "\u2029" : "";
}
function aY(e) {
  return e <= 65535 ? String.fromCharCode(e) : String.fromCharCode(
    (e - 65536 >> 10) + 55296,
    (e - 65536 & 1023) + 56320
  );
}
function vP(e, t, n) {
  t === "__proto__" ? Object.defineProperty(e, t, {
    configurable: !0,
    enumerable: !0,
    writable: !0,
    value: n
  }) : e[t] = n;
}
var bP = new Array(256), wP = new Array(256);
for (var Kp = 0; Kp < 256; Kp++)
  bP[Kp] = BA(Kp) ? 1 : 0, wP[Kp] = BA(Kp);
function oY(e, t) {
  this.input = e, this.filename = t.filename || null, this.schema = t.schema || rT, this.onWarning = t.onWarning || null, this.legacy = t.legacy || !1, this.json = t.json || !1, this.listener = t.listener || null, this.implicitTypes = this.schema.compiledImplicit, this.typeMap = this.schema.compiledTypeMap, this.length = e.length, this.position = 0, this.line = 0, this.lineStart = 0, this.lineIndent = 0, this.firstTabInLine = -1, this.documents = [];
}
function _P(e, t) {
  var n = {
    name: e.filename,
    buffer: e.input.slice(0, -1),
    // omit trailing \0
    position: e.position,
    line: e.line,
    column: e.position - e.lineStart
  };
  return n.snippet = dK(n), new Ms(t, n);
}
function Tt(e, t) {
  throw _P(e, t);
}
function ab(e, t) {
  e.onWarning && e.onWarning.call(null, _P(e, t));
}
var $A = {
  YAML: function(t, n, r) {
    var i, s, a;
    t.version !== null && Tt(t, "duplication of %YAML directive"), r.length !== 1 && Tt(t, "YAML directive accepts exactly one argument"), i = /^([0-9]+)\.([0-9]+)$/.exec(r[0]), i === null && Tt(t, "ill-formed argument of the YAML directive"), s = parseInt(i[1], 10), a = parseInt(i[2], 10), s !== 1 && Tt(t, "unacceptable YAML version of the document"), t.version = r[0], t.checkLineBreaks = a < 2, a !== 1 && a !== 2 && ab(t, "unsupported YAML version of the document");
  },
  TAG: function(t, n, r) {
    var i, s;
    r.length !== 2 && Tt(t, "TAG directive accepts exactly two arguments"), i = r[0], s = r[1], yP.test(i) || Tt(t, "ill-formed tag handle (first argument) of the TAG directive"), Ed.call(t.tagMap, i) && Tt(t, 'there is a previously declared suffix for "' + i + '" tag handle'), xP.test(s) || Tt(t, "ill-formed tag prefix (second argument) of the TAG directive");
    try {
      s = decodeURIComponent(s);
    } catch {
      Tt(t, "tag prefix is malformed: " + s);
    }
    t.tagMap[i] = s;
  }
};
function yd(e, t, n, r) {
  var i, s, a, u;
  if (t < n) {
    if (u = e.input.slice(t, n), r)
      for (i = 0, s = u.length; i < s; i += 1)
        a = u.charCodeAt(i), a === 9 || 32 <= a && a <= 1114111 || Tt(e, "expected valid JSON character");
    else eY.test(u) && Tt(e, "the stream contains non-printable characters");
    e.result += u;
  }
}
function qA(e, t, n, r) {
  var i, s, a, u;
  for (yi.isObject(n) || Tt(e, "cannot merge mappings; the provided source object is unacceptable"), i = Object.keys(n), a = 0, u = i.length; a < u; a += 1)
    s = i[a], Ed.call(t, s) || (vP(t, s, n[s]), r[s] = !0);
}
function am(e, t, n, r, i, s, a, u, d) {
  var f, h;
  if (Array.isArray(i))
    for (i = Array.prototype.slice.call(i), f = 0, h = i.length; f < h; f += 1)
      Array.isArray(i[f]) && Tt(e, "nested arrays are not supported inside keys"), typeof i == "object" && LA(i[f]) === "[object Object]" && (i[f] = "[object Object]");
  if (typeof i == "object" && LA(i) === "[object Object]" && (i = "[object Object]"), i = String(i), t === null && (t = {}), r === "tag:yaml.org,2002:merge")
    if (Array.isArray(s))
      for (f = 0, h = s.length; f < h; f += 1)
        qA(e, t, s[f], n);
    else
      qA(e, t, s, n);
  else
    !e.json && !Ed.call(n, i) && Ed.call(t, i) && (e.line = a || e.line, e.lineStart = u || e.lineStart, e.position = d || e.position, Tt(e, "duplicated mapping key")), vP(t, i, s), delete n[i];
  return t;
}
function iT(e) {
  var t;
  t = e.input.charCodeAt(e.position), t === 10 ? e.position++ : t === 13 ? (e.position++, e.input.charCodeAt(e.position) === 10 && e.position++) : Tt(e, "a line break is expected"), e.line += 1, e.lineStart = e.position, e.firstTabInLine = -1;
}
function ti(e, t, n) {
  for (var r = 0, i = e.input.charCodeAt(e.position); i !== 0; ) {
    for (; dh(i); )
      i === 9 && e.firstTabInLine === -1 && (e.firstTabInLine = e.position), i = e.input.charCodeAt(++e.position);
    if (t && i === 35)
      do
        i = e.input.charCodeAt(++e.position);
      while (i !== 10 && i !== 13 && i !== 0);
    if (Jl(i))
      for (iT(e), i = e.input.charCodeAt(e.position), r++, e.lineIndent = 0; i === 32; )
        e.lineIndent++, i = e.input.charCodeAt(++e.position);
    else
      break;
  }
  return n !== -1 && r !== 0 && e.lineIndent < n && ab(e, "deficient indentation"), r;
}
function Kb(e) {
  var t = e.position, n;
  return n = e.input.charCodeAt(t), !!((n === 45 || n === 46) && n === e.input.charCodeAt(t + 1) && n === e.input.charCodeAt(t + 2) && (t += 3, n = e.input.charCodeAt(t), n === 0 || ca(n)));
}
function sT(e, t) {
  t === 1 ? e.result += " " : t > 1 && (e.result += yi.repeat(`
`, t - 1));
}
function lY(e, t, n) {
  var r, i, s, a, u, d, f, h, m = e.kind, x = e.result, b;
  if (b = e.input.charCodeAt(e.position), ca(b) || sm(b) || b === 35 || b === 38 || b === 42 || b === 33 || b === 124 || b === 62 || b === 39 || b === 34 || b === 37 || b === 64 || b === 96 || (b === 63 || b === 45) && (i = e.input.charCodeAt(e.position + 1), ca(i) || n && sm(i)))
    return !1;
  for (e.kind = "scalar", e.result = "", s = a = e.position, u = !1; b !== 0; ) {
    if (b === 58) {
      if (i = e.input.charCodeAt(e.position + 1), ca(i) || n && sm(i))
        break;
    } else if (b === 35) {
      if (r = e.input.charCodeAt(e.position - 1), ca(r))
        break;
    } else {
      if (e.position === e.lineStart && Kb(e) || n && sm(b))
        break;
      if (Jl(b))
        if (d = e.line, f = e.lineStart, h = e.lineIndent, ti(e, !1, -1), e.lineIndent >= t) {
          u = !0, b = e.input.charCodeAt(e.position);
          continue;
        } else {
          e.position = a, e.line = d, e.lineStart = f, e.lineIndent = h;
          break;
        }
    }
    u && (yd(e, s, a, !1), sT(e, e.line - d), s = a = e.position, u = !1), dh(b) || (a = e.position + 1), b = e.input.charCodeAt(++e.position);
  }
  return yd(e, s, a, !1), e.result ? !0 : (e.kind = m, e.result = x, !1);
}
function uY(e, t) {
  var n, r, i;
  if (n = e.input.charCodeAt(e.position), n !== 39)
    return !1;
  for (e.kind = "scalar", e.result = "", e.position++, r = i = e.position; (n = e.input.charCodeAt(e.position)) !== 0; )
    if (n === 39)
      if (yd(e, r, e.position, !0), n = e.input.charCodeAt(++e.position), n === 39)
        r = e.position, e.position++, i = e.position;
      else
        return !0;
    else Jl(n) ? (yd(e, r, i, !0), sT(e, ti(e, !1, t)), r = i = e.position) : e.position === e.lineStart && Kb(e) ? Tt(e, "unexpected end of the document within a single quoted scalar") : (e.position++, i = e.position);
  Tt(e, "unexpected end of the stream within a single quoted scalar");
}
function cY(e, t) {
  var n, r, i, s, a, u;
  if (u = e.input.charCodeAt(e.position), u !== 34)
    return !1;
  for (e.kind = "scalar", e.result = "", e.position++, n = r = e.position; (u = e.input.charCodeAt(e.position)) !== 0; ) {
    if (u === 34)
      return yd(e, n, e.position, !0), e.position++, !0;
    if (u === 92) {
      if (yd(e, n, e.position, !0), u = e.input.charCodeAt(++e.position), Jl(u))
        ti(e, !1, t);
      else if (u < 256 && bP[u])
        e.result += wP[u], e.position++;
      else if ((a = iY(u)) > 0) {
        for (i = a, s = 0; i > 0; i--)
          u = e.input.charCodeAt(++e.position), (a = rY(u)) >= 0 ? s = (s << 4) + a : Tt(e, "expected hexadecimal character");
        e.result += aY(s), e.position++;
      } else
        Tt(e, "unknown escape sequence");
      n = r = e.position;
    } else Jl(u) ? (yd(e, n, r, !0), sT(e, ti(e, !1, t)), n = r = e.position) : e.position === e.lineStart && Kb(e) ? Tt(e, "unexpected end of the document within a double quoted scalar") : (e.position++, r = e.position);
  }
  Tt(e, "unexpected end of the stream within a double quoted scalar");
}
function dY(e, t) {
  var n = !0, r, i, s, a = e.tag, u, d = e.anchor, f, h, m, x, b, w = /* @__PURE__ */ Object.create(null), S, C, T, R;
  if (R = e.input.charCodeAt(e.position), R === 91)
    h = 93, b = !1, u = [];
  else if (R === 123)
    h = 125, b = !0, u = {};
  else
    return !1;
  for (e.anchor !== null && (e.anchorMap[e.anchor] = u), R = e.input.charCodeAt(++e.position); R !== 0; ) {
    if (ti(e, !0, t), R = e.input.charCodeAt(e.position), R === h)
      return e.position++, e.tag = a, e.anchor = d, e.kind = b ? "mapping" : "sequence", e.result = u, !0;
    n ? R === 44 && Tt(e, "expected the node content, but found ','") : Tt(e, "missed comma between flow collection entries"), C = S = T = null, m = x = !1, R === 63 && (f = e.input.charCodeAt(e.position + 1), ca(f) && (m = x = !0, e.position++, ti(e, !0, t))), r = e.line, i = e.lineStart, s = e.position, Am(e, t, ib, !1, !0), C = e.tag, S = e.result, ti(e, !0, t), R = e.input.charCodeAt(e.position), (x || e.line === r) && R === 58 && (m = !0, R = e.input.charCodeAt(++e.position), ti(e, !0, t), Am(e, t, ib, !1, !0), T = e.result), b ? am(e, u, w, C, S, T, r, i, s) : m ? u.push(am(e, null, w, C, S, T, r, i, s)) : u.push(S), ti(e, !0, t), R = e.input.charCodeAt(e.position), R === 44 ? (n = !0, R = e.input.charCodeAt(++e.position)) : n = !1;
  }
  Tt(e, "unexpected end of the stream within a flow collection");
}
function fY(e, t) {
  var n, r, i = G2, s = !1, a = !1, u = t, d = 0, f = !1, h, m;
  if (m = e.input.charCodeAt(e.position), m === 124)
    r = !1;
  else if (m === 62)
    r = !0;
  else
    return !1;
  for (e.kind = "scalar", e.result = ""; m !== 0; )
    if (m = e.input.charCodeAt(++e.position), m === 43 || m === 45)
      G2 === i ? i = m === 43 ? IA : JK : Tt(e, "repeat of a chomping mode identifier");
    else if ((h = sY(m)) >= 0)
      h === 0 ? Tt(e, "bad explicit indentation width of a block scalar; it cannot be less than one") : a ? Tt(e, "repeat of an indentation width identifier") : (u = t + h - 1, a = !0);
    else
      break;
  if (dh(m)) {
    do
      m = e.input.charCodeAt(++e.position);
    while (dh(m));
    if (m === 35)
      do
        m = e.input.charCodeAt(++e.position);
      while (!Jl(m) && m !== 0);
  }
  for (; m !== 0; ) {
    for (iT(e), e.lineIndent = 0, m = e.input.charCodeAt(e.position); (!a || e.lineIndent < u) && m === 32; )
      e.lineIndent++, m = e.input.charCodeAt(++e.position);
    if (!a && e.lineIndent > u && (u = e.lineIndent), Jl(m)) {
      d++;
      continue;
    }
    if (e.lineIndent < u) {
      i === IA ? e.result += yi.repeat(`
`, s ? 1 + d : d) : i === G2 && s && (e.result += `
`);
      break;
    }
    for (r ? dh(m) ? (f = !0, e.result += yi.repeat(`
`, s ? 1 + d : d)) : f ? (f = !1, e.result += yi.repeat(`
`, d + 1)) : d === 0 ? s && (e.result += " ") : e.result += yi.repeat(`
`, d) : e.result += yi.repeat(`
`, s ? 1 + d : d), s = !0, a = !0, d = 0, n = e.position; !Jl(m) && m !== 0; )
      m = e.input.charCodeAt(++e.position);
    yd(e, n, e.position, !1);
  }
  return !0;
}
function FA(e, t) {
  var n, r = e.tag, i = e.anchor, s = [], a, u = !1, d;
  if (e.firstTabInLine !== -1) return !1;
  for (e.anchor !== null && (e.anchorMap[e.anchor] = s), d = e.input.charCodeAt(e.position); d !== 0 && (e.firstTabInLine !== -1 && (e.position = e.firstTabInLine, Tt(e, "tab characters must not be used in indentation")), !(d !== 45 || (a = e.input.charCodeAt(e.position + 1), !ca(a)))); ) {
    if (u = !0, e.position++, ti(e, !0, -1) && e.lineIndent <= t) {
      s.push(null), d = e.input.charCodeAt(e.position);
      continue;
    }
    if (n = e.line, Am(e, t, gP, !1, !0), s.push(e.result), ti(e, !0, -1), d = e.input.charCodeAt(e.position), (e.line === n || e.lineIndent > t) && d !== 0)
      Tt(e, "bad indentation of a sequence entry");
    else if (e.lineIndent < t)
      break;
  }
  return u ? (e.tag = r, e.anchor = i, e.kind = "sequence", e.result = s, !0) : !1;
}
function hY(e, t, n) {
  var r, i, s, a, u, d, f = e.tag, h = e.anchor, m = {}, x = /* @__PURE__ */ Object.create(null), b = null, w = null, S = null, C = !1, T = !1, R;
  if (e.firstTabInLine !== -1) return !1;
  for (e.anchor !== null && (e.anchorMap[e.anchor] = m), R = e.input.charCodeAt(e.position); R !== 0; ) {
    if (!C && e.firstTabInLine !== -1 && (e.position = e.firstTabInLine, Tt(e, "tab characters must not be used in indentation")), r = e.input.charCodeAt(e.position + 1), s = e.line, (R === 63 || R === 58) && ca(r))
      R === 63 ? (C && (am(e, m, x, b, w, null, a, u, d), b = w = S = null), T = !0, C = !0, i = !0) : C ? (C = !1, i = !0) : Tt(e, "incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"), e.position += 1, R = r;
    else {
      if (a = e.line, u = e.lineStart, d = e.position, !Am(e, n, mP, !1, !0))
        break;
      if (e.line === s) {
        for (R = e.input.charCodeAt(e.position); dh(R); )
          R = e.input.charCodeAt(++e.position);
        if (R === 58)
          R = e.input.charCodeAt(++e.position), ca(R) || Tt(e, "a whitespace character is expected after the key-value separator within a block mapping"), C && (am(e, m, x, b, w, null, a, u, d), b = w = S = null), T = !0, C = !1, i = !1, b = e.tag, w = e.result;
        else if (T)
          Tt(e, "can not read an implicit mapping pair; a colon is missed");
        else
          return e.tag = f, e.anchor = h, !0;
      } else if (T)
        Tt(e, "can not read a block mapping entry; a multiline key may not be an implicit key");
      else
        return e.tag = f, e.anchor = h, !0;
    }
    if ((e.line === s || e.lineIndent > t) && (C && (a = e.line, u = e.lineStart, d = e.position), Am(e, t, sb, !0, i) && (C ? w = e.result : S = e.result), C || (am(e, m, x, b, w, S, a, u, d), b = w = S = null), ti(e, !0, -1), R = e.input.charCodeAt(e.position)), (e.line === s || e.lineIndent > t) && R !== 0)
      Tt(e, "bad indentation of a mapping entry");
    else if (e.lineIndent < t)
      break;
  }
  return C && am(e, m, x, b, w, null, a, u, d), T && (e.tag = f, e.anchor = h, e.kind = "mapping", e.result = m), T;
}
function pY(e) {
  var t, n = !1, r = !1, i, s, a;
  if (a = e.input.charCodeAt(e.position), a !== 33) return !1;
  if (e.tag !== null && Tt(e, "duplication of a tag property"), a = e.input.charCodeAt(++e.position), a === 60 ? (n = !0, a = e.input.charCodeAt(++e.position)) : a === 33 ? (r = !0, i = "!!", a = e.input.charCodeAt(++e.position)) : i = "!", t = e.position, n) {
    do
      a = e.input.charCodeAt(++e.position);
    while (a !== 0 && a !== 62);
    e.position < e.length ? (s = e.input.slice(t, e.position), a = e.input.charCodeAt(++e.position)) : Tt(e, "unexpected end of the stream within a verbatim tag");
  } else {
    for (; a !== 0 && !ca(a); )
      a === 33 && (r ? Tt(e, "tag suffix cannot contain exclamation marks") : (i = e.input.slice(t - 1, e.position + 1), yP.test(i) || Tt(e, "named tag handle cannot contain such characters"), r = !0, t = e.position + 1)), a = e.input.charCodeAt(++e.position);
    s = e.input.slice(t, e.position), nY.test(s) && Tt(e, "tag suffix cannot contain flow indicator characters");
  }
  s && !xP.test(s) && Tt(e, "tag name cannot contain such characters: " + s);
  try {
    s = decodeURIComponent(s);
  } catch {
    Tt(e, "tag name is malformed: " + s);
  }
  return n ? e.tag = s : Ed.call(e.tagMap, i) ? e.tag = e.tagMap[i] + s : i === "!" ? e.tag = "!" + s : i === "!!" ? e.tag = "tag:yaml.org,2002:" + s : Tt(e, 'undeclared tag handle "' + i + '"'), !0;
}
function mY(e) {
  var t, n;
  if (n = e.input.charCodeAt(e.position), n !== 38) return !1;
  for (e.anchor !== null && Tt(e, "duplication of an anchor property"), n = e.input.charCodeAt(++e.position), t = e.position; n !== 0 && !ca(n) && !sm(n); )
    n = e.input.charCodeAt(++e.position);
  return e.position === t && Tt(e, "name of an anchor node must contain at least one character"), e.anchor = e.input.slice(t, e.position), !0;
}
function gY(e) {
  var t, n, r;
  if (r = e.input.charCodeAt(e.position), r !== 42) return !1;
  for (r = e.input.charCodeAt(++e.position), t = e.position; r !== 0 && !ca(r) && !sm(r); )
    r = e.input.charCodeAt(++e.position);
  return e.position === t && Tt(e, "name of an alias node must contain at least one character"), n = e.input.slice(t, e.position), Ed.call(e.anchorMap, n) || Tt(e, 'unidentified alias "' + n + '"'), e.result = e.anchorMap[n], ti(e, !0, -1), !0;
}
function Am(e, t, n, r, i) {
  var s, a, u, d = 1, f = !1, h = !1, m, x, b, w, S, C;
  if (e.listener !== null && e.listener("open", e), e.tag = null, e.anchor = null, e.kind = null, e.result = null, s = a = u = sb === n || gP === n, r && ti(e, !0, -1) && (f = !0, e.lineIndent > t ? d = 1 : e.lineIndent === t ? d = 0 : e.lineIndent < t && (d = -1)), d === 1)
    for (; pY(e) || mY(e); )
      ti(e, !0, -1) ? (f = !0, u = s, e.lineIndent > t ? d = 1 : e.lineIndent === t ? d = 0 : e.lineIndent < t && (d = -1)) : u = !1;
  if (u && (u = f || i), (d === 1 || sb === n) && (ib === n || mP === n ? S = t : S = t + 1, C = e.position - e.lineStart, d === 1 ? u && (FA(e, C) || hY(e, C, S)) || dY(e, S) ? h = !0 : (a && fY(e, S) || uY(e, S) || cY(e, S) ? h = !0 : gY(e) ? (h = !0, (e.tag !== null || e.anchor !== null) && Tt(e, "alias node should not have any properties")) : lY(e, S, ib === n) && (h = !0, e.tag === null && (e.tag = "?")), e.anchor !== null && (e.anchorMap[e.anchor] = e.result)) : d === 0 && (h = u && FA(e, C))), e.tag === null)
    e.anchor !== null && (e.anchorMap[e.anchor] = e.result);
  else if (e.tag === "?") {
    for (e.result !== null && e.kind !== "scalar" && Tt(e, 'unacceptable node kind for !<?> tag; it should be "scalar", not "' + e.kind + '"'), m = 0, x = e.implicitTypes.length; m < x; m += 1)
      if (w = e.implicitTypes[m], w.resolve(e.result)) {
        e.result = w.construct(e.result), e.tag = w.tag, e.anchor !== null && (e.anchorMap[e.anchor] = e.result);
        break;
      }
  } else if (e.tag !== "!") {
    if (Ed.call(e.typeMap[e.kind || "fallback"], e.tag))
      w = e.typeMap[e.kind || "fallback"][e.tag];
    else
      for (w = null, b = e.typeMap.multi[e.kind || "fallback"], m = 0, x = b.length; m < x; m += 1)
        if (e.tag.slice(0, b[m].tag.length) === b[m].tag) {
          w = b[m];
          break;
        }
    w || Tt(e, "unknown tag !<" + e.tag + ">"), e.result !== null && w.kind !== e.kind && Tt(e, "unacceptable node kind for !<" + e.tag + '> tag; it should be "' + w.kind + '", not "' + e.kind + '"'), w.resolve(e.result, e.tag) ? (e.result = w.construct(e.result, e.tag), e.anchor !== null && (e.anchorMap[e.anchor] = e.result)) : Tt(e, "cannot resolve a node with !<" + e.tag + "> explicit tag");
  }
  return e.listener !== null && e.listener("close", e), e.tag !== null || e.anchor !== null || h;
}
function yY(e) {
  var t = e.position, n, r, i, s = !1, a;
  for (e.version = null, e.checkLineBreaks = e.legacy, e.tagMap = /* @__PURE__ */ Object.create(null), e.anchorMap = /* @__PURE__ */ Object.create(null); (a = e.input.charCodeAt(e.position)) !== 0 && (ti(e, !0, -1), a = e.input.charCodeAt(e.position), !(e.lineIndent > 0 || a !== 37)); ) {
    for (s = !0, a = e.input.charCodeAt(++e.position), n = e.position; a !== 0 && !ca(a); )
      a = e.input.charCodeAt(++e.position);
    for (r = e.input.slice(n, e.position), i = [], r.length < 1 && Tt(e, "directive name must not be less than one character in length"); a !== 0; ) {
      for (; dh(a); )
        a = e.input.charCodeAt(++e.position);
      if (a === 35) {
        do
          a = e.input.charCodeAt(++e.position);
        while (a !== 0 && !Jl(a));
        break;
      }
      if (Jl(a)) break;
      for (n = e.position; a !== 0 && !ca(a); )
        a = e.input.charCodeAt(++e.position);
      i.push(e.input.slice(n, e.position));
    }
    a !== 0 && iT(e), Ed.call($A, r) ? $A[r](e, r, i) : ab(e, 'unknown document directive "' + r + '"');
  }
  if (ti(e, !0, -1), e.lineIndent === 0 && e.input.charCodeAt(e.position) === 45 && e.input.charCodeAt(e.position + 1) === 45 && e.input.charCodeAt(e.position + 2) === 45 ? (e.position += 3, ti(e, !0, -1)) : s && Tt(e, "directives end mark is expected"), Am(e, e.lineIndent - 1, sb, !1, !0), ti(e, !0, -1), e.checkLineBreaks && tY.test(e.input.slice(t, e.position)) && ab(e, "non-ASCII line breaks are interpreted as content"), e.documents.push(e.result), e.position === e.lineStart && Kb(e)) {
    e.input.charCodeAt(e.position) === 46 && (e.position += 3, ti(e, !0, -1));
    return;
  }
  if (e.position < e.length - 1)
    Tt(e, "end of the stream or a document separator is expected");
  else
    return;
}
function SP(e, t) {
  e = String(e), t = t || {}, e.length !== 0 && (e.charCodeAt(e.length - 1) !== 10 && e.charCodeAt(e.length - 1) !== 13 && (e += `
`), e.charCodeAt(0) === 65279 && (e = e.slice(1)));
  var n = new oY(e, t), r = e.indexOf("\0");
  for (r !== -1 && (n.position = r, Tt(n, "null byte is not allowed in input")), n.input += "\0"; n.input.charCodeAt(n.position) === 32; )
    n.lineIndent += 1, n.position += 1;
  for (; n.position < n.length - 1; )
    yY(n);
  return n.documents;
}
function xY(e, t, n) {
  t !== null && typeof t == "object" && typeof n > "u" && (n = t, t = null);
  var r = SP(e, n);
  if (typeof t != "function")
    return r;
  for (var i = 0, s = r.length; i < s; i += 1)
    t(r[i]);
}
function vY(e, t) {
  var n = SP(e, t);
  if (n.length !== 0) {
    if (n.length === 1)
      return n[0];
    throw new Ms("expected a single document in the stream, but found more");
  }
}
var bY = xY, wY = vY, EP = {
  loadAll: bY,
  load: wY
}, CP = Object.prototype.toString, kP = Object.prototype.hasOwnProperty, aT = 65279, _Y = 9, wy = 10, SY = 13, EY = 32, CY = 33, kY = 34, v3 = 35, TY = 37, jY = 38, AY = 39, NY = 42, TP = 44, RY = 45, ob = 58, MY = 61, OY = 62, DY = 63, zY = 64, jP = 91, AP = 93, PY = 96, NP = 123, IY = 124, RP = 125, cs = {};
cs[0] = "\\0";
cs[7] = "\\a";
cs[8] = "\\b";
cs[9] = "\\t";
cs[10] = "\\n";
cs[11] = "\\v";
cs[12] = "\\f";
cs[13] = "\\r";
cs[27] = "\\e";
cs[34] = '\\"';
cs[92] = "\\\\";
cs[133] = "\\N";
cs[160] = "\\_";
cs[8232] = "\\L";
cs[8233] = "\\P";
var LY = [
  "y",
  "Y",
  "yes",
  "Yes",
  "YES",
  "on",
  "On",
  "ON",
  "n",
  "N",
  "no",
  "No",
  "NO",
  "off",
  "Off",
  "OFF"
], BY = /^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;
function $Y(e, t) {
  var n, r, i, s, a, u, d;
  if (t === null) return {};
  for (n = {}, r = Object.keys(t), i = 0, s = r.length; i < s; i += 1)
    a = r[i], u = String(t[a]), a.slice(0, 2) === "!!" && (a = "tag:yaml.org,2002:" + a.slice(2)), d = e.compiledTypeMap.fallback[a], d && kP.call(d.styleAliases, u) && (u = d.styleAliases[u]), n[a] = u;
  return n;
}
function qY(e) {
  var t, n, r;
  if (t = e.toString(16).toUpperCase(), e <= 255)
    n = "x", r = 2;
  else if (e <= 65535)
    n = "u", r = 4;
  else if (e <= 4294967295)
    n = "U", r = 8;
  else
    throw new Ms("code point within a string may not be greater than 0xFFFFFFFF");
  return "\\" + n + yi.repeat("0", r - t.length) + t;
}
var FY = 1, _y = 2;
function UY(e) {
  this.schema = e.schema || rT, this.indent = Math.max(1, e.indent || 2), this.noArrayIndent = e.noArrayIndent || !1, this.skipInvalid = e.skipInvalid || !1, this.flowLevel = yi.isNothing(e.flowLevel) ? -1 : e.flowLevel, this.styleMap = $Y(this.schema, e.styles || null), this.sortKeys = e.sortKeys || !1, this.lineWidth = e.lineWidth || 80, this.noRefs = e.noRefs || !1, this.noCompatMode = e.noCompatMode || !1, this.condenseFlow = e.condenseFlow || !1, this.quotingType = e.quotingType === '"' ? _y : FY, this.forceQuotes = e.forceQuotes || !1, this.replacer = typeof e.replacer == "function" ? e.replacer : null, this.implicitTypes = this.schema.compiledImplicit, this.explicitTypes = this.schema.compiledExplicit, this.tag = null, this.result = "", this.duplicates = [], this.usedDuplicates = null;
}
function UA(e, t) {
  for (var n = yi.repeat(" ", t), r = 0, i = -1, s = "", a, u = e.length; r < u; )
    i = e.indexOf(`
`, r), i === -1 ? (a = e.slice(r), r = u) : (a = e.slice(r, i + 1), r = i + 1), a.length && a !== `
` && (s += n), s += a;
  return s;
}
function b3(e, t) {
  return `
` + yi.repeat(" ", e.indent * t);
}
function HY(e, t) {
  var n, r, i;
  for (n = 0, r = e.implicitTypes.length; n < r; n += 1)
    if (i = e.implicitTypes[n], i.resolve(t))
      return !0;
  return !1;
}
function lb(e) {
  return e === EY || e === _Y;
}
function Sy(e) {
  return 32 <= e && e <= 126 || 161 <= e && e <= 55295 && e !== 8232 && e !== 8233 || 57344 <= e && e <= 65533 && e !== aT || 65536 <= e && e <= 1114111;
}
function HA(e) {
  return Sy(e) && e !== aT && e !== SY && e !== wy;
}
function VA(e, t, n) {
  var r = HA(e), i = r && !lb(e);
  return (
    // ns-plain-safe
    (n ? (
      // c = flow-in
      r
    ) : r && e !== TP && e !== jP && e !== AP && e !== NP && e !== RP) && e !== v3 && !(t === ob && !i) || HA(t) && !lb(t) && e === v3 || t === ob && i
  );
}
function VY(e) {
  return Sy(e) && e !== aT && !lb(e) && e !== RY && e !== DY && e !== ob && e !== TP && e !== jP && e !== AP && e !== NP && e !== RP && e !== v3 && e !== jY && e !== NY && e !== CY && e !== IY && e !== MY && e !== OY && e !== AY && e !== kY && e !== TY && e !== zY && e !== PY;
}
function GY(e) {
  return !lb(e) && e !== ob;
}
function X0(e, t) {
  var n = e.charCodeAt(t), r;
  return n >= 55296 && n <= 56319 && t + 1 < e.length && (r = e.charCodeAt(t + 1), r >= 56320 && r <= 57343) ? (n - 55296) * 1024 + r - 56320 + 65536 : n;
}
function MP(e) {
  var t = /^\n* /;
  return t.test(e);
}
var OP = 1, w3 = 2, DP = 3, zP = 4, nm = 5;
function KY(e, t, n, r, i, s, a, u) {
  var d, f = 0, h = null, m = !1, x = !1, b = r !== -1, w = -1, S = VY(X0(e, 0)) && GY(X0(e, e.length - 1));
  if (t || a)
    for (d = 0; d < e.length; f >= 65536 ? d += 2 : d++) {
      if (f = X0(e, d), !Sy(f))
        return nm;
      S = S && VA(f, h, u), h = f;
    }
  else {
    for (d = 0; d < e.length; f >= 65536 ? d += 2 : d++) {
      if (f = X0(e, d), f === wy)
        m = !0, b && (x = x || // Foldable line = too long, and not more-indented.
        d - w - 1 > r && e[w + 1] !== " ", w = d);
      else if (!Sy(f))
        return nm;
      S = S && VA(f, h, u), h = f;
    }
    x = x || b && d - w - 1 > r && e[w + 1] !== " ";
  }
  return !m && !x ? S && !a && !i(e) ? OP : s === _y ? nm : w3 : n > 9 && MP(e) ? nm : a ? s === _y ? nm : w3 : x ? zP : DP;
}
function YY(e, t, n, r, i) {
  e.dump = (function() {
    if (t.length === 0)
      return e.quotingType === _y ? '""' : "''";
    if (!e.noCompatMode && (LY.indexOf(t) !== -1 || BY.test(t)))
      return e.quotingType === _y ? '"' + t + '"' : "'" + t + "'";
    var s = e.indent * Math.max(1, n), a = e.lineWidth === -1 ? -1 : Math.max(Math.min(e.lineWidth, 40), e.lineWidth - s), u = r || e.flowLevel > -1 && n >= e.flowLevel;
    function d(f) {
      return HY(e, f);
    }
    switch (KY(
      t,
      u,
      e.indent,
      a,
      d,
      e.quotingType,
      e.forceQuotes && !r,
      i
    )) {
      case OP:
        return t;
      case w3:
        return "'" + t.replace(/'/g, "''") + "'";
      case DP:
        return "|" + GA(t, e.indent) + KA(UA(t, s));
      case zP:
        return ">" + GA(t, e.indent) + KA(UA(WY(t, a), s));
      case nm:
        return '"' + ZY(t) + '"';
      default:
        throw new Ms("impossible error: invalid scalar style");
    }
  })();
}
function GA(e, t) {
  var n = MP(e) ? String(t) : "", r = e[e.length - 1] === `
`, i = r && (e[e.length - 2] === `
` || e === `
`), s = i ? "+" : r ? "" : "-";
  return n + s + `
`;
}
function KA(e) {
  return e[e.length - 1] === `
` ? e.slice(0, -1) : e;
}
function WY(e, t) {
  for (var n = /(\n+)([^\n]*)/g, r = (function() {
    var f = e.indexOf(`
`);
    return f = f !== -1 ? f : e.length, n.lastIndex = f, YA(e.slice(0, f), t);
  })(), i = e[0] === `
` || e[0] === " ", s, a; a = n.exec(e); ) {
    var u = a[1], d = a[2];
    s = d[0] === " ", r += u + (!i && !s && d !== "" ? `
` : "") + YA(d, t), i = s;
  }
  return r;
}
function YA(e, t) {
  if (e === "" || e[0] === " ") return e;
  for (var n = / [^ ]/g, r, i = 0, s, a = 0, u = 0, d = ""; r = n.exec(e); )
    u = r.index, u - i > t && (s = a > i ? a : u, d += `
` + e.slice(i, s), i = s + 1), a = u;
  return d += `
`, e.length - i > t && a > i ? d += e.slice(i, a) + `
` + e.slice(a + 1) : d += e.slice(i), d.slice(1);
}
function ZY(e) {
  for (var t = "", n = 0, r, i = 0; i < e.length; n >= 65536 ? i += 2 : i++)
    n = X0(e, i), r = cs[n], !r && Sy(n) ? (t += e[i], n >= 65536 && (t += e[i + 1])) : t += r || qY(n);
  return t;
}
function XY(e, t, n) {
  var r = "", i = e.tag, s, a, u;
  for (s = 0, a = n.length; s < a; s += 1)
    u = n[s], e.replacer && (u = e.replacer.call(n, String(s), u)), (Xu(e, t, u, !1, !1) || typeof u > "u" && Xu(e, t, null, !1, !1)) && (r !== "" && (r += "," + (e.condenseFlow ? "" : " ")), r += e.dump);
  e.tag = i, e.dump = "[" + r + "]";
}
function WA(e, t, n, r) {
  var i = "", s = e.tag, a, u, d;
  for (a = 0, u = n.length; a < u; a += 1)
    d = n[a], e.replacer && (d = e.replacer.call(n, String(a), d)), (Xu(e, t + 1, d, !0, !0, !1, !0) || typeof d > "u" && Xu(e, t + 1, null, !0, !0, !1, !0)) && ((!r || i !== "") && (i += b3(e, t)), e.dump && wy === e.dump.charCodeAt(0) ? i += "-" : i += "- ", i += e.dump);
  e.tag = s, e.dump = i || "[]";
}
function QY(e, t, n) {
  var r = "", i = e.tag, s = Object.keys(n), a, u, d, f, h;
  for (a = 0, u = s.length; a < u; a += 1)
    h = "", r !== "" && (h += ", "), e.condenseFlow && (h += '"'), d = s[a], f = n[d], e.replacer && (f = e.replacer.call(n, d, f)), Xu(e, t, d, !1, !1) && (e.dump.length > 1024 && (h += "? "), h += e.dump + (e.condenseFlow ? '"' : "") + ":" + (e.condenseFlow ? "" : " "), Xu(e, t, f, !1, !1) && (h += e.dump, r += h));
  e.tag = i, e.dump = "{" + r + "}";
}
function JY(e, t, n, r) {
  var i = "", s = e.tag, a = Object.keys(n), u, d, f, h, m, x;
  if (e.sortKeys === !0)
    a.sort();
  else if (typeof e.sortKeys == "function")
    a.sort(e.sortKeys);
  else if (e.sortKeys)
    throw new Ms("sortKeys must be a boolean or a function");
  for (u = 0, d = a.length; u < d; u += 1)
    x = "", (!r || i !== "") && (x += b3(e, t)), f = a[u], h = n[f], e.replacer && (h = e.replacer.call(n, f, h)), Xu(e, t + 1, f, !0, !0, !0) && (m = e.tag !== null && e.tag !== "?" || e.dump && e.dump.length > 1024, m && (e.dump && wy === e.dump.charCodeAt(0) ? x += "?" : x += "? "), x += e.dump, m && (x += b3(e, t)), Xu(e, t + 1, h, !0, m) && (e.dump && wy === e.dump.charCodeAt(0) ? x += ":" : x += ": ", x += e.dump, i += x));
  e.tag = s, e.dump = i || "{}";
}
function ZA(e, t, n) {
  var r, i, s, a, u, d;
  for (i = n ? e.explicitTypes : e.implicitTypes, s = 0, a = i.length; s < a; s += 1)
    if (u = i[s], (u.instanceOf || u.predicate) && (!u.instanceOf || typeof t == "object" && t instanceof u.instanceOf) && (!u.predicate || u.predicate(t))) {
      if (n ? u.multi && u.representName ? e.tag = u.representName(t) : e.tag = u.tag : e.tag = "?", u.represent) {
        if (d = e.styleMap[u.tag] || u.defaultStyle, CP.call(u.represent) === "[object Function]")
          r = u.represent(t, d);
        else if (kP.call(u.represent, d))
          r = u.represent[d](t, d);
        else
          throw new Ms("!<" + u.tag + '> tag resolver accepts not "' + d + '" style');
        e.dump = r;
      }
      return !0;
    }
  return !1;
}
function Xu(e, t, n, r, i, s, a) {
  e.tag = null, e.dump = n, ZA(e, n, !1) || ZA(e, n, !0);
  var u = CP.call(e.dump), d = r, f;
  r && (r = e.flowLevel < 0 || e.flowLevel > t);
  var h = u === "[object Object]" || u === "[object Array]", m, x;
  if (h && (m = e.duplicates.indexOf(n), x = m !== -1), (e.tag !== null && e.tag !== "?" || x || e.indent !== 2 && t > 0) && (i = !1), x && e.usedDuplicates[m])
    e.dump = "*ref_" + m;
  else {
    if (h && x && !e.usedDuplicates[m] && (e.usedDuplicates[m] = !0), u === "[object Object]")
      r && Object.keys(e.dump).length !== 0 ? (JY(e, t, e.dump, i), x && (e.dump = "&ref_" + m + e.dump)) : (QY(e, t, e.dump), x && (e.dump = "&ref_" + m + " " + e.dump));
    else if (u === "[object Array]")
      r && e.dump.length !== 0 ? (e.noArrayIndent && !a && t > 0 ? WA(e, t - 1, e.dump, i) : WA(e, t, e.dump, i), x && (e.dump = "&ref_" + m + e.dump)) : (XY(e, t, e.dump), x && (e.dump = "&ref_" + m + " " + e.dump));
    else if (u === "[object String]")
      e.tag !== "?" && YY(e, e.dump, t, s, d);
    else {
      if (u === "[object Undefined]")
        return !1;
      if (e.skipInvalid) return !1;
      throw new Ms("unacceptable kind of an object to dump " + u);
    }
    e.tag !== null && e.tag !== "?" && (f = encodeURI(
      e.tag[0] === "!" ? e.tag.slice(1) : e.tag
    ).replace(/!/g, "%21"), e.tag[0] === "!" ? f = "!" + f : f.slice(0, 18) === "tag:yaml.org,2002:" ? f = "!!" + f.slice(18) : f = "!<" + f + ">", e.dump = f + " " + e.dump);
  }
  return !0;
}
function eW(e, t) {
  var n = [], r = [], i, s;
  for (_3(e, n, r), i = 0, s = r.length; i < s; i += 1)
    t.duplicates.push(n[r[i]]);
  t.usedDuplicates = new Array(s);
}
function _3(e, t, n) {
  var r, i, s;
  if (e !== null && typeof e == "object")
    if (i = t.indexOf(e), i !== -1)
      n.indexOf(i) === -1 && n.push(i);
    else if (t.push(e), Array.isArray(e))
      for (i = 0, s = e.length; i < s; i += 1)
        _3(e[i], t, n);
    else
      for (r = Object.keys(e), i = 0, s = r.length; i < s; i += 1)
        _3(e[r[i]], t, n);
}
function tW(e, t) {
  t = t || {};
  var n = new UY(t);
  n.noRefs || eW(e, n);
  var r = e;
  return n.replacer && (r = n.replacer.call({ "": r }, "", r)), Xu(n, 0, r, !0, !0) ? n.dump + `
` : "";
}
var nW = tW, rW = {
  dump: nW
};
function oT(e, t) {
  return function() {
    throw new Error("Function yaml." + e + " is removed in js-yaml 4. Use yaml." + t + " instead, which is now safe by default.");
  };
}
var iW = Fi, sW = Zz, aW = eP, oW = sP, lW = aP, uW = rT, cW = EP.load, dW = EP.loadAll, fW = rW.dump, hW = Ms, pW = {
  binary: dP,
  float: iP,
  map: Jz,
  null: tP,
  pairs: hP,
  set: pP,
  timestamp: uP,
  bool: nP,
  int: rP,
  merge: cP,
  omap: fP,
  seq: Qz,
  str: Xz
}, mW = oT("safeLoad", "load"), gW = oT("safeLoadAll", "loadAll"), yW = oT("safeDump", "dump"), xW = {
  Type: iW,
  Schema: sW,
  FAILSAFE_SCHEMA: aW,
  JSON_SCHEMA: oW,
  CORE_SCHEMA: lW,
  DEFAULT_SCHEMA: uW,
  load: cW,
  loadAll: dW,
  dump: fW,
  YAMLException: hW,
  types: pW,
  safeLoad: mW,
  safeLoadAll: gW,
  safeDump: yW
};
const XA = /* @__PURE__ */ Object.assign({ "./prompts/description_enhance.yaml": FG, "./prompts/entity_extraction.yaml": HG, "./prompts/plot_director.yaml": GG, "./prompts/query_enhance.yaml": YG, "./prompts/summary.yaml": ZG, "./prompts/trim.yaml": QG });
class Nm {
  /**
   * 
   */
  static init() {
    if (this.initialized) return;
    const t = [];
    for (const n in XA)
      try {
        const r = XA[n].default, i = xW.load(r);
        if (!i.id || !i.name) {
          ee.warn(Fe.LLM, `Skipping invalid prompt template in ${n}: missing id or name`);
          continue;
        }
        t.push({
          id: i.id,
          name: i.name,
          category: i.category || "other",
          enabled: i.enabled ?? !1,
          isBuiltIn: !0,
          boundPresetId: null,
          systemPrompt: i.systemPrompt || "",
          userPromptTemplate: i.userPromptTemplate || "",
          injectionMode: i.injectionMode,
          createdAt: Date.now(),
          updatedAt: Date.now()
        });
      } catch (r) {
        ee.error(Fe.LLM, `Failed to load prompt template from ${n}`, r);
      }
    this.templates = t, ee.info(Fe.LLM, `Loaded ${this.templates.length} built-in prompt templates from YAML`), this.initialized = !0;
  }
  /**
   *  (V0.9.1)
   */
  static getBuiltInTemplates() {
    return this.init(), this.templates;
  }
  /**
   *  Alias (V1.0.0 Refactor)
   */
  static getAllTemplates() {
    return this.getBuiltInTemplates();
  }
}
lt(Nm, "templates", []), lt(Nm, "initialized", !1);
const vW = {
  temperature: 0.7,
  topP: 0.95,
  maxTokens: 2048,
  frequencyPenalty: 0,
  presencePenalty: 0
}, bW = {
  maxChatHistory: 10
}, wW = {
  source: "transformers"
}, _W = {
  enabled: !1,
  url: "",
  apiKey: "",
  model: "",
  topN: 5,
  hybridAlpha: 0.5
}, Yb = {
  enabled: !1,
  // 
  workingLimit: 10,
  // 
  shortTermLimit: 35,
  //  (35  3-4 )
  reinforceFactor: 0.2,
  // 
  decayRate: 0.08,
  //  ()
  evictionThreshold: 0.25,
  //  ()
  contextSwitchThreshold: 0.4,
  // V1.2 Defaults
  gateThreshold: 0.6,
  //  Rerank > 0.6 
  maxDamping: 0.1,
  //  +0.1
  sigmoidTemperature: 0.15,
  //  0.15 
  // V1.3 Defaults
  boredomThreshold: 5,
  //  5  Working Memory 
  boredomPenalty: 0.1,
  //  0.1 ()
  mmrThreshold: 0.85,
  //  > 0.85 
  newcomerBoost: 0.2
  //  0.2  ()
}, Wb = {
  enabled: !0,
  useEmbedding: !0,
  useRerank: !1,
  usePreprocessing: !1,
  useBruteForce: !1,
  embedding: {
    topK: 50,
    // Embedding  50 
    minScoreThreshold: 0.35
    //  ()
  },
  brainRecall: Yb
}, PP = {
  enabled: !1,
  trigger: "with_trim",
  concurrency: 5,
  keepRecentCount: 3
}, IP = {
  enabled: !1,
  trigger: "floor",
  floorInterval: 15,
  // V0.9.5: 10-20 
  keepRecentCount: 5
}, SW = {
  enableNativeRegex: !0,
  enableEngramRegex: !0
}, EW = [
  {
    id: "custom_user_profile",
    name: "",
    content: "",
    // 
    enabled: !0,
    createdAt: Date.now()
  }
], CW = {
  enabled: !0,
  includeGlobal: !0,
  disabledWorldbooks: [],
  enableEJS: !0
  // V0.8  EJS
};
function lT(e = "") {
  const t = Date.now();
  return {
    id: `preset_${t}`,
    name: e,
    source: "tavern",
    parameters: { ...vW },
    context: { ...bW },
    isDefault: !0,
    createdAt: t,
    updatedAt: t
  };
}
function ub(e, t, n = {}) {
  const r = Date.now();
  return {
    id: n.id || `template_${r}_${Math.random().toString(36).slice(2, 8)}`,
    name: e,
    category: t,
    enabled: n.enabled ?? !1,
    isBuiltIn: n.isBuiltIn ?? !1,
    boundPresetId: n.boundPresetId ?? null,
    systemPrompt: n.systemPrompt ?? "",
    userPromptTemplate: n.userPromptTemplate ?? "",
    injectionMode: n.injectionMode,
    // Fix: Ensure injectionMode is preserved
    createdAt: r,
    updatedAt: r
  };
}
function Xy() {
  return Nm.init(), Nm.getBuiltInTemplates();
}
function uT(e) {
  return Xy().find((t) => t.id === e);
}
function Zb(e) {
  return Xy().find((t) => t.category === e) || null;
}
function Rm() {
  return {
    llmPresets: [lT()],
    selectedPresetId: null,
    vectorConfig: { ...wW },
    rerankConfig: { ..._W },
    promptTemplates: Xy(),
    worldbookConfig: { ...CW },
    regexConfig: { ...SW },
    // V0.8
    recallConfig: { ...Wb },
    // V0.8.5
    customMacros: [...EW],
    // V0.9.2
    worldbookProfiles: []
    // V1.1.0
  };
}
const kW = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  DEFAULT_BRAIN_RECALL_CONFIG: Yb,
  DEFAULT_EMBEDDING_CONFIG: PP,
  DEFAULT_ENTITY_CONFIG: IP,
  DEFAULT_RECALL_CONFIG: Wb,
  createDefaultLLMPreset: lT,
  createPromptTemplate: ub,
  getBuiltInPromptTemplates: Xy,
  getBuiltInTemplateByCategory: Zb,
  getBuiltInTemplateById: uT,
  getDefaultAPISettings: Rm
}, Symbol.toStringTag, { value: "Module" })), Yf = Object.freeze({
  theme: "odysseia",
  presets: {},
  templates: {},
  promptTemplates: [],
  hasSeenWelcome: !1,
  lastReadVersion: "0.0.0",
  summarizerConfig: {},
  trimmerConfig: {},
  regexRules: [],
  apiSettings: null,
  preprocessingConfig: null,
  // V0.8: 
  linkedDeletion: {
    enabled: !0,
    deleteWorldbook: !0,
    deleteChatWorldbook: !1,
    // 
    deleteIndexedDB: !1,
    showConfirmation: !0
  },
  glassSettings: {
    enabled: !0,
    opacity: 0.3,
    blur: 10
  },
  syncConfig: {
    enabled: !1,
    // Beta
    autoSync: !0
    // 
  }
});
class it {
  /**
   *  SillyTavern context
   */
  static getContext() {
    var t, n;
    return (n = (t = window.SillyTavern) == null ? void 0 : t.getContext) == null ? void 0 : n.call(t);
  }
  /**
   * 
   * 
   */
  static getSettings() {
    const t = this.getContext();
    return t != null && t.extensionSettings ? (t.extensionSettings[this.EXTENSION_NAME] || (t.extensionSettings[this.EXTENSION_NAME] = { ...Yf }, ee.debug("SettingsManager", "Initialized engram settings with defaults"), this.save()), t.extensionSettings[this.EXTENSION_NAME]) : (ee.warn("SettingsManager", "SillyTavern context.extensionSettings not available"), { ...Yf });
  }
  static getExtensionSettings() {
    return this.getSettings();
  }
  /**
   * 
   * 
   */
  static initSettings() {
    const t = this.getContext();
    if (!(t != null && t.extensionSettings)) {
      ee.warn("SettingsManager", "Cannot init settings: context not available");
      return;
    }
    let n = !1;
    t.extensionSettings[this.EXTENSION_NAME] || (t.extensionSettings[this.EXTENSION_NAME] = { ...Yf }, n = !0, ee.info("SettingsManager", "Created engram settings"));
    const r = t.extensionSettings[this.EXTENSION_NAME];
    for (const i of Object.keys(Yf))
      i in r || (r[i] = Yf[i], n = !0, ee.debug("SettingsManager", `Added missing field: ${i}`));
    n && this.save();
  }
  /**
   * Get a specific setting value
   */
  static get(t) {
    const r = this.getExtensionSettings()[t];
    return r !== void 0 ? r : Yf[t];
  }
  /**
   * Save a specific setting value
   *  context.extensionSettings 
   */
  static set(t, n) {
    const r = this.getContext();
    if (!(r != null && r.extensionSettings)) {
      ee.warn("SettingsManager", "Cannot set: context.extensionSettings not available");
      return;
    }
    r.extensionSettings[this.EXTENSION_NAME] || (r.extensionSettings[this.EXTENSION_NAME] = { ...Yf }), r.extensionSettings[this.EXTENSION_NAME][t] = n, ee.debug("SettingsManager", `Set ${String(t)} = ${JSON.stringify(n)}`), this.save();
  }
  /**
   * 
   */
  static save() {
    const t = this.getContext();
    t != null && t.saveSettingsDebounced ? (t.saveSettingsDebounced(), ee.debug("SettingsManager", "Saved via context.saveSettingsDebounced")) : ee.warn("SettingsManager", "saveSettingsDebounced not available");
  }
  /**
   * Load settings from SillyTavern global state
   * 
   */
  static loadSettings() {
    return this.getExtensionSettings();
  }
  /**
   * 
   * @param category 
   * @returns  null
   */
  static getEnabledPromptTemplate(t) {
    const n = this.get("apiSettings");
    return ((n == null ? void 0 : n.promptTemplates) || []).find((i) => i.category === t && i.enabled) || null;
  }
  /**
   *  ID 
   * @param id  ID
   * @returns  null
   */
  static getPromptTemplateById(t) {
    const n = this.get("apiSettings"), r = (n == null ? void 0 : n.promptTemplates) || [], i = r.find((a) => a.id === t);
    if (i) return i;
    const s = uT(t);
    return s || r.find((a) => a.category === t && a.enabled) || null;
  }
  /**
   * 
   * @returns summarizerConfig 
   */
  static getSummarizerSettings() {
    return this.get("summarizerConfig") || {};
  }
  /**
   * 
   * @param config 
   */
  static setSummarizerSettings(t) {
    const n = this.getSummarizerSettings();
    this.set("summarizerConfig", { ...n, ...t });
  }
  /**
   * 
   * @returns RegexRule[] 
   */
  static getRegexRules() {
    return this.get("regexRules") || [];
  }
  /**
   * 
   * @param rules 
   */
  static setRegexRules(t) {
    this.set("regexRules", t);
  }
}
lt(it, "EXTENSION_NAME", "engram");
const Xb = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  SettingsManager: it
}, Symbol.toStringTag, { value: "Module" }));
class xd {
  /**
   * 
   */
  static init() {
    this.injectStyles();
    let n = it.loadSettings().theme;
    n || (n = localStorage.getItem(this.STORAGE_KEY), n && it.set("theme", n));
    const r = D1[n] ? n : "claudeDark";
    this.setTheme(r), ee.info("ThemeManager", `: ${r}`);
  }
  /**
   * 
   */
  static setTheme(t) {
    D1[t] || (ee.warn("ThemeManager", `: ${t},  claudeDark`), t = "claudeDark"), this.currentTheme = t, it.set("theme", t), localStorage.setItem(this.STORAGE_KEY, t), this.applyThemeVariables(t);
  }
  /**
   * 
   */
  static getTheme() {
    return this.currentTheme;
  }
  /**
   *  (dist/style.css)
   */
  static injectStyles() {
    const t = "engram-styles";
    if (document.getElementById(t)) return;
    const n = document.createElement("link");
    n.id = t, n.rel = "stylesheet", n.type = "text/css", n.href = `scripts/extensions/Engram_project/dist/style.css?v=${Date.now()}`, document.head.appendChild(n);
  }
  /**
   *  CSS 
   */
  static applyThemeVariables(t) {
    var w, S;
    const n = D1[t];
    if (!n) return;
    const r = document.documentElement, i = (C, T) => {
      r.style.setProperty(C, T);
    }, s = it.getSettings(), u = ((w = s.glassSettings) == null ? void 0 : w.enabled) ?? !0 ? ((S = s.glassSettings) == null ? void 0 : S.opacity) ?? 1 : 1, f = !(t === "glass") && u < 1, h = Math.round((1 - u) * 100), m = [
      "background",
      "card",
      "popover",
      "sidebar",
      "secondary",
      "muted",
      "input",
      "border",
      "sidebarBorder"
    ];
    Object.entries(n.colors).forEach(([C, T]) => {
      let R = `--${C.replace(/([A-Z])/g, "-$1").toLowerCase()}`;
      R = R.replace(/(\d+)/, "-$1");
      let N = T;
      if (f && m.includes(C)) {
        const P = C.toLowerCase().includes("border") ? Math.round(h * 0.1) : h;
        N = `color-mix(in srgb, ${T}, transparent ${P}%)`;
      }
      i(R, N);
    }), Object.entries(n.variables).forEach(([C, T]) => {
      i(`--${C}`, T);
    }), t !== "paperLight" ? r.classList.add("dark") : r.classList.remove("dark");
    const b = it.getSettings().glassSettings;
    b && b.enabled ? (i("--glass-opacity", b.opacity.toString()), i("--glass-blur", `${b.blur}px`), b.blur > 0 ? i("--glass-backdrop-filter", `blur(${b.blur}px)`) : i("--glass-backdrop-filter", "none")) : (i("--glass-opacity", "1"), i("--glass-blur", "0px"), i("--glass-backdrop-filter", "none"));
  }
}
lt(xd, "STORAGE_KEY", "engram-theme"), lt(xd, "currentTheme", "claudeDark");
const P1 = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  ThemeManager: xd
}, Symbol.toStringTag, { value: "Module" })), TW = zz((e) => ({
  theme: xd.getTheme(),
  isDarkMode: xd.getTheme() !== "paperLight",
  setTheme: (t) => {
    xd.setTheme(t), e({
      theme: t,
      isDarkMode: t !== "paperLight"
    });
  }
}));
class cT {
  async search(t) {
    const n = t.toLowerCase().trim(), r = tb.map((a) => ({
      id: `nav-${a.id}`,
      type: "navigation",
      // Explicitly cast to 'navigation' | 'action' | 'setting' | 'log'
      title: a.label,
      description: `Navigate to ${a.label}`,
      // Auto-generated description
      icon: a.icon,
      action: (u) => u(a.path),
      score: 10
    })).filter(
      (a) => a.title.toLowerCase().includes(n) || a.id.includes(n)
    ), i = YV.filter(
      (a) => {
        var u;
        return a.label.toLowerCase().includes(n) || ((u = a.description) == null ? void 0 : u.toLowerCase().includes(n)) || a.keywords.some((d) => d.toLowerCase().includes(n));
      }
    ).map((a) => ({
      id: a.id,
      type: "command",
      title: a.label,
      description: a.description,
      icon: a.icon,
      action: a.action,
      score: 9
    })), s = this.getThemeCommands().filter(
      (a) => {
        var u;
        return a.title.toLowerCase().includes(n) || ((u = a.keywords) == null ? void 0 : u.some((d) => d.toLowerCase().includes(n)));
      }
    );
    return [...r, ...i, ...s];
  }
  getThemeCommands() {
    const t = TW.getState().setTheme;
    return [
      {
        id: "theme-paper-light",
        type: "command",
        title: ": Paper Light (Twitter)",
        description: "",
        icon: OV,
        action: () => t("paperLight"),
        keywords: ["theme", "light", "white", "twitter", "paper", ""],
        score: 5
      },
      {
        id: "theme-twitter-dark",
        type: "command",
        title: ": Twitter Dark",
        description: "",
        icon: gA,
        action: () => t("twitterDark"),
        keywords: ["theme", "dark", "black", "twitter", "blue", ""],
        score: 5
      },
      {
        id: "theme-claude-dark",
        type: "command",
        title: ": Claude Dark",
        description: "",
        icon: gA,
        action: () => t("claudeDark"),
        keywords: ["theme", "dark", "claude", "paper", ""],
        score: 5
      },
      {
        id: "theme-catppuccin",
        type: "command",
        title: ": Catppuccin Mocha",
        description: "",
        icon: a3,
        action: () => t("catppuccin"),
        keywords: ["theme", "dark", "catppuccin", "mocha", ""],
        score: 5
      },
      {
        id: "theme-discord",
        type: "command",
        title: ": Discord Dark",
        description: " Discord ",
        icon: a3,
        action: () => t("discord"),
        keywords: ["theme", "dark", "discord", "game", ""],
        score: 5
      }
    ];
  }
}
class jW {
  constructor() {
    lt(this, "adapters", []);
  }
  registerAdapter(t) {
    this.adapters.push(t);
  }
  async search(t) {
    return t.trim() ? (await Promise.all(this.adapters.map((r) => r.search(t)))).flat().sort((r, i) => (i.score || 0) - (r.score || 0)) : [];
  }
}
const md = new jW();
md.registerAdapter(new cT());
md.registerAdapter(new KV());
class AW {
  async search(t) {
    const n = t.toLowerCase().trim();
    return this.getAllSettings().filter(
      (r) => {
        var i;
        return r.title.toLowerCase().includes(n) || ((i = r.keywords) == null ? void 0 : i.some((s) => s.toLowerCase().includes(n)));
      }
    );
  }
  getAllSettings() {
    return [
      // API Settings
      {
        id: "setting-api-key",
        type: "setting",
        title: " API Key",
        description: " LLM ",
        icon: Fb,
        action: (t) => t("/api"),
        // Default to API page
        keywords: ["api", "key", "token", "credential"],
        score: 8
      },
      {
        id: "setting-model",
        type: "setting",
        title: " (Model)",
        description: " LLM ",
        icon: Yy,
        action: (t) => t("/api"),
        keywords: ["model", "llm", "change", "switch"],
        score: 8
      },
      // Parameters
      {
        id: "setting-temperature",
        type: "setting",
        title: " (Temperature)",
        description: "",
        icon: yA,
        action: (t) => t("/api"),
        keywords: ["temp", "temperature", "random", "creativity"],
        score: 7
      },
      {
        id: "setting-top-p",
        type: "setting",
        title: " Top P",
        description: "",
        icon: yA,
        action: (t) => t("/api"),
        keywords: ["top", "p", "nucleus", "sampling"],
        score: 7
      },
      // Vector/RAG
      {
        id: "setting-vector",
        type: "setting",
        title: " (Vectorization)",
        description: "",
        icon: kh,
        action: (t) => t("/processing"),
        // processing:vectorization ideally
        keywords: ["vector", "embedding", "db", "store"],
        score: 7
      },
      {
        id: "setting-recall",
        type: "setting",
        title: " (Recall)",
        description: " RAG ",
        icon: nV,
        action: (t) => t("/processing"),
        // processing:recall
        keywords: ["recall", "rag", "retrieval", "search"],
        score: 7
      }
    ];
  }
}
class NW {
  async search(t) {
    const n = t.toLowerCase().trim();
    return ["log", "debug", "error", "warn", "info", "dev"].some((i) => i.includes(n)) || n.includes("log") ? this.getLogActions() : [];
  }
  getLogActions() {
    return [
      {
        id: "log-view-all",
        type: "log",
        title: " (DevLog)",
        description: "",
        icon: Wy,
        action: (t) => t("devlog"),
        score: 9
      },
      {
        id: "log-errors",
        type: "log",
        title: " (Errors)",
        description: "",
        icon: xz,
        action: (t) => t("devlog"),
        // In future: nav('/dev?filter=error')
        score: 8
      }
    ];
  }
}
const RW = "STContext";
function ma() {
  var e, t;
  try {
    return ((t = (e = window.SillyTavern) == null ? void 0 : e.getContext) == null ? void 0 : t.call(e)) || null;
  } catch (n) {
    return ee.warn(RW, " ST ", n), null;
  }
}
function LP() {
  const e = ma();
  return (e == null ? void 0 : e.chat) || [];
}
function xi() {
  const e = ma();
  return (e == null ? void 0 : e.chatId) || null;
}
function Qb() {
  const e = ma();
  return e ? {
    name: e.name2,
    id: e.characterId
  } : null;
}
function BP() {
  try {
    return window.selected_model || void 0;
  } catch {
    return;
  }
}
function $P() {
  return ma() !== null;
}
function S3(e) {
  const t = ma();
  return t != null && t.getRequestHeaders ? t.getRequestHeaders(e) : { "Content-Type": "application/json" };
}
const oy = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  getCurrentCharacter: Qb,
  getCurrentChat: LP,
  getCurrentChatId: xi,
  getCurrentModel: BP,
  getRequestHeaders: S3,
  getSTContext: ma,
  isSTAvailable: $P
}, Symbol.toStringTag, { value: "Module" }));
var I1 = { exports: {} }, MW = I1.exports, QA;
function OW() {
  return QA || (QA = 1, (function(e, t) {
    (function(n, r) {
      e.exports = r();
    })(MW, function() {
      var n = function(_, j) {
        return (n = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(O, L) {
          O.__proto__ = L;
        } || function(O, L) {
          for (var F in L) Object.prototype.hasOwnProperty.call(L, F) && (O[F] = L[F]);
        })(_, j);
      }, r = function() {
        return (r = Object.assign || function(_) {
          for (var j, O = 1, L = arguments.length; O < L; O++) for (var F in j = arguments[O]) Object.prototype.hasOwnProperty.call(j, F) && (_[F] = j[F]);
          return _;
        }).apply(this, arguments);
      };
      function i(_, j, O) {
        for (var L, F = 0, W = j.length; F < W; F++) !L && F in j || ((L = L || Array.prototype.slice.call(j, 0, F))[F] = j[F]);
        return _.concat(L || Array.prototype.slice.call(j));
      }
      var s = typeof globalThis < "u" ? globalThis : typeof self < "u" ? self : typeof window < "u" ? window : Gu, a = Object.keys, u = Array.isArray;
      function d(_, j) {
        return typeof j != "object" || a(j).forEach(function(O) {
          _[O] = j[O];
        }), _;
      }
      typeof Promise > "u" || s.Promise || (s.Promise = Promise);
      var f = Object.getPrototypeOf, h = {}.hasOwnProperty;
      function m(_, j) {
        return h.call(_, j);
      }
      function x(_, j) {
        typeof j == "function" && (j = j(f(_))), (typeof Reflect > "u" ? a : Reflect.ownKeys)(j).forEach(function(O) {
          w(_, O, j[O]);
        });
      }
      var b = Object.defineProperty;
      function w(_, j, O, L) {
        b(_, j, d(O && m(O, "get") && typeof O.get == "function" ? { get: O.get, set: O.set, configurable: !0 } : { value: O, configurable: !0, writable: !0 }, L));
      }
      function S(_) {
        return { from: function(j) {
          return _.prototype = Object.create(j.prototype), w(_.prototype, "constructor", _), { extend: x.bind(null, _.prototype) };
        } };
      }
      var C = Object.getOwnPropertyDescriptor, T = [].slice;
      function R(_, j, O) {
        return T.call(_, j, O);
      }
      function N(_, j) {
        return j(_);
      }
      function M(_) {
        if (!_) throw new Error("Assertion Failed");
      }
      function P(_) {
        s.setImmediate ? setImmediate(_) : setTimeout(_, 0);
      }
      function D(_, j) {
        if (typeof j == "string" && m(_, j)) return _[j];
        if (!j) return _;
        if (typeof j != "string") {
          for (var O = [], L = 0, F = j.length; L < F; ++L) {
            var W = D(_, j[L]);
            O.push(W);
          }
          return O;
        }
        var ue = j.indexOf(".");
        if (ue !== -1) {
          var U = _[j.substr(0, ue)];
          return U == null ? void 0 : D(U, j.substr(ue + 1));
        }
      }
      function q(_, j, O) {
        if (_ && j !== void 0 && !("isFrozen" in Object && Object.isFrozen(_))) if (typeof j != "string" && "length" in j) {
          M(typeof O != "string" && "length" in O);
          for (var L = 0, F = j.length; L < F; ++L) q(_, j[L], O[L]);
        } else {
          var W, ue, U = j.indexOf(".");
          U !== -1 ? (W = j.substr(0, U), (ue = j.substr(U + 1)) === "" ? O === void 0 ? u(_) && !isNaN(parseInt(W)) ? _.splice(W, 1) : delete _[W] : _[W] = O : q(U = !(U = _[W]) || !m(_, W) ? _[W] = {} : U, ue, O)) : O === void 0 ? u(_) && !isNaN(parseInt(j)) ? _.splice(j, 1) : delete _[j] : _[j] = O;
        }
      }
      function Y(_) {
        var j, O = {};
        for (j in _) m(_, j) && (O[j] = _[j]);
        return O;
      }
      var te = [].concat;
      function V(_) {
        return te.apply([], _);
      }
      var $e = "BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(V([8, 16, 32, 64].map(function(_) {
        return ["Int", "Uint", "Float"].map(function(j) {
          return j + _ + "Array";
        });
      }))).filter(function(_) {
        return s[_];
      }), $ = new Set($e.map(function(_) {
        return s[_];
      })), G = null;
      function le(_) {
        return G = /* @__PURE__ */ new WeakMap(), _ = (function j(O) {
          if (!O || typeof O != "object") return O;
          var L = G.get(O);
          if (L) return L;
          if (u(O)) {
            L = [], G.set(O, L);
            for (var F = 0, W = O.length; F < W; ++F) L.push(j(O[F]));
          } else if ($.has(O.constructor)) L = O;
          else {
            var ue, U = f(O);
            for (ue in L = U === Object.prototype ? {} : Object.create(U), G.set(O, L), O) m(O, ue) && (L[ue] = j(O[ue]));
          }
          return L;
        })(_), G = null, _;
      }
      var Z = {}.toString;
      function oe(_) {
        return Z.call(_).slice(8, -1);
      }
      var X = typeof Symbol < "u" ? Symbol.iterator : "@@iterator", ce = typeof X == "symbol" ? function(_) {
        var j;
        return _ != null && (j = _[X]) && j.apply(_);
      } : function() {
        return null;
      };
      function pe(_, j) {
        return j = _.indexOf(j), 0 <= j && _.splice(j, 1), 0 <= j;
      }
      var de = {};
      function H(_) {
        var j, O, L, F;
        if (arguments.length === 1) {
          if (u(_)) return _.slice();
          if (this === de && typeof _ == "string") return [_];
          if (F = ce(_)) {
            for (O = []; !(L = F.next()).done; ) O.push(L.value);
            return O;
          }
          if (_ == null) return [_];
          if (typeof (j = _.length) != "number") return [_];
          for (O = new Array(j); j--; ) O[j] = _[j];
          return O;
        }
        for (j = arguments.length, O = new Array(j); j--; ) O[j] = arguments[j];
        return O;
      }
      var J = typeof Symbol < "u" ? function(_) {
        return _[Symbol.toStringTag] === "AsyncFunction";
      } : function() {
        return !1;
      }, Nn = ["Unknown", "Constraint", "Data", "TransactionInactive", "ReadOnly", "Version", "NotFound", "InvalidState", "InvalidAccess", "Abort", "Timeout", "QuotaExceeded", "Syntax", "DataClone"], li = ["Modify", "Bulk", "OpenFailed", "VersionChange", "Schema", "Upgrade", "InvalidTable", "MissingAPI", "NoSuchDatabase", "InvalidArgument", "SubTransaction", "Unsupported", "Internal", "DatabaseClosed", "PrematureCommit", "ForeignAwait"].concat(Nn), ge = { VersionChanged: "Database version changed by other database connection", DatabaseClosed: "Database has been closed", Abort: "Transaction aborted", TransactionInactive: "Transaction has already completed or failed", MissingAPI: "IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb" };
      function Q(_, j) {
        this.name = _, this.message = j;
      }
      function fe(_, j) {
        return _ + ". Errors: " + Object.keys(j).map(function(O) {
          return j[O].toString();
        }).filter(function(O, L, F) {
          return F.indexOf(O) === L;
        }).join(`
`);
      }
      function ve(_, j, O, L) {
        this.failures = j, this.failedKeys = L, this.successCount = O, this.message = fe(_, j);
      }
      function Se(_, j) {
        this.name = "BulkError", this.failures = Object.keys(j).map(function(O) {
          return j[O];
        }), this.failuresByPos = j, this.message = fe(_, this.failures);
      }
      S(Q).from(Error).extend({ toString: function() {
        return this.name + ": " + this.message;
      } }), S(ve).from(Q), S(Se).from(Q);
      var Me = li.reduce(function(_, j) {
        return _[j] = j + "Error", _;
      }, {}), Ie = Q, Re = li.reduce(function(_, j) {
        var O = j + "Error";
        function L(F, W) {
          this.name = O, F ? typeof F == "string" ? (this.message = "".concat(F).concat(W ? `
 ` + W : ""), this.inner = W || null) : typeof F == "object" && (this.message = "".concat(F.name, " ").concat(F.message), this.inner = F) : (this.message = ge[j] || O, this.inner = null);
        }
        return S(L).from(Ie), _[j] = L, _;
      }, {});
      Re.Syntax = SyntaxError, Re.Type = TypeError, Re.Range = RangeError;
      var mt = Nn.reduce(function(_, j) {
        return _[j + "Error"] = Re[j], _;
      }, {}), dt = li.reduce(function(_, j) {
        return ["Syntax", "Type", "Range"].indexOf(j) === -1 && (_[j + "Error"] = Re[j]), _;
      }, {});
      function Je() {
      }
      function ft(_) {
        return _;
      }
      function yt(_, j) {
        return _ == null || _ === ft ? j : function(O) {
          return j(_(O));
        };
      }
      function ht(_, j) {
        return function() {
          _.apply(this, arguments), j.apply(this, arguments);
        };
      }
      function Le(_, j) {
        return _ === Je ? j : function() {
          var O = _.apply(this, arguments);
          O !== void 0 && (arguments[0] = O);
          var L = this.onsuccess, F = this.onerror;
          this.onsuccess = null, this.onerror = null;
          var W = j.apply(this, arguments);
          return L && (this.onsuccess = this.onsuccess ? ht(L, this.onsuccess) : L), F && (this.onerror = this.onerror ? ht(F, this.onerror) : F), W !== void 0 ? W : O;
        };
      }
      function Ye(_, j) {
        return _ === Je ? j : function() {
          _.apply(this, arguments);
          var O = this.onsuccess, L = this.onerror;
          this.onsuccess = this.onerror = null, j.apply(this, arguments), O && (this.onsuccess = this.onsuccess ? ht(O, this.onsuccess) : O), L && (this.onerror = this.onerror ? ht(L, this.onerror) : L);
        };
      }
      function gt(_, j) {
        return _ === Je ? j : function(O) {
          var L = _.apply(this, arguments);
          d(O, L);
          var F = this.onsuccess, W = this.onerror;
          return this.onsuccess = null, this.onerror = null, O = j.apply(this, arguments), F && (this.onsuccess = this.onsuccess ? ht(F, this.onsuccess) : F), W && (this.onerror = this.onerror ? ht(W, this.onerror) : W), L === void 0 ? O === void 0 ? void 0 : O : d(L, O);
        };
      }
      function Dt(_, j) {
        return _ === Je ? j : function() {
          return j.apply(this, arguments) !== !1 && _.apply(this, arguments);
        };
      }
      function pn(_, j) {
        return _ === Je ? j : function() {
          var O = _.apply(this, arguments);
          if (O && typeof O.then == "function") {
            for (var L = this, F = arguments.length, W = new Array(F); F--; ) W[F] = arguments[F];
            return O.then(function() {
              return j.apply(L, W);
            });
          }
          return j.apply(this, arguments);
        };
      }
      dt.ModifyError = ve, dt.DexieError = Q, dt.BulkError = Se;
      var Ht = typeof location < "u" && /^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);
      function zn(_) {
        Ht = _;
      }
      var nn = {}, kn = 100, $e = typeof Promise > "u" ? [] : (function() {
        var _ = Promise.resolve();
        if (typeof crypto > "u" || !crypto.subtle) return [_, f(_), _];
        var j = crypto.subtle.digest("SHA-512", new Uint8Array([0]));
        return [j, f(j), _];
      })(), Nn = $e[0], li = $e[1], $e = $e[2], li = li && li.then, Qe = Nn && Nn.constructor, bt = !!$e, jt = function(_, j) {
        er.push([_, j]), Un && (queueMicrotask(cu), Un = !1);
      }, $t = !0, Un = !0, Hn = [], on = [], Jt = ft, fn = { id: "global", global: !0, ref: 0, unhandleds: [], onunhandled: Je, pgp: !1, env: {}, finalize: Je }, nt = fn, er = [], Pn = 0, sr = [];
      function st(_) {
        if (typeof this != "object") throw new TypeError("Promises must be constructed via new");
        this._listeners = [], this._lib = !1;
        var j = this._PSD = nt;
        if (typeof _ != "function") {
          if (_ !== nn) throw new TypeError("Not a function");
          return this._state = arguments[1], this._value = arguments[2], void (this._state === !1 && bi(this, this._value));
        }
        this._state = null, this._value = null, ++j.ref, (function O(L, F) {
          try {
            F(function(W) {
              if (L._state === null) {
                if (W === L) throw new TypeError("A promise cannot be resolved with itself.");
                var ue = L._lib && Ls();
                W && typeof W.then == "function" ? O(L, function(U, se) {
                  W instanceof st ? W._then(U, se) : W.then(U, se);
                }) : (L._state = !0, L._value = W, At(L)), ue && Ui();
              }
            }, bi.bind(null, L));
          } catch (W) {
            bi(L, W);
          }
        })(this, _);
      }
      var $r = { get: function() {
        var _ = nt, j = po;
        function O(L, F) {
          var W = this, ue = !_.global && (_ !== nt || j !== po), U = ue && !Yr(), se = new st(function(ie, me) {
            tr(W, new Is(ol(L, _, ue, U), ol(F, _, ue, U), ie, me, _));
          });
          return this._consoleTask && (se._consoleTask = this._consoleTask), se;
        }
        return O.prototype = nn, O;
      }, set: function(_) {
        w(this, "then", _ && _.prototype === nn ? $r : { get: function() {
          return _;
        }, set: $r.set });
      } };
      function Is(_, j, O, L, F) {
        this.onFulfilled = typeof _ == "function" ? _ : null, this.onRejected = typeof j == "function" ? j : null, this.resolve = O, this.reject = L, this.psd = F;
      }
      function bi(_, j) {
        var O, L;
        on.push(j), _._state === null && (O = _._lib && Ls(), j = Jt(j), _._state = !1, _._value = j, L = _, Hn.some(function(F) {
          return F._value === L._value;
        }) || Hn.push(L), At(_), O && Ui());
      }
      function At(_) {
        var j = _._listeners;
        _._listeners = [];
        for (var O = 0, L = j.length; O < L; ++O) tr(_, j[O]);
        var F = _._PSD;
        --F.ref || F.finalize(), Pn === 0 && (++Pn, jt(function() {
          --Pn == 0 && du();
        }, []));
      }
      function tr(_, j) {
        if (_._state !== null) {
          var O = _._state ? j.onFulfilled : j.onRejected;
          if (O === null) return (_._state ? j.resolve : j.reject)(_._value);
          ++j.psd.ref, ++Pn, jt(Dd, [O, _, j]);
        } else _._listeners.push(j);
      }
      function Dd(_, j, O) {
        try {
          var L, F = j._value;
          !j._state && on.length && (on = []), L = Ht && j._consoleTask ? j._consoleTask.run(function() {
            return _(F);
          }) : _(F), j._state || on.indexOf(F) !== -1 || (function(W) {
            for (var ue = Hn.length; ue; ) if (Hn[--ue]._value === W._value) return Hn.splice(ue, 1);
          })(j), O.resolve(L);
        } catch (W) {
          O.reject(W);
        } finally {
          --Pn == 0 && du(), --O.psd.ref || O.psd.finalize();
        }
      }
      function cu() {
        Ni(fn, function() {
          Ls() && Ui();
        });
      }
      function Ls() {
        var _ = $t;
        return Un = $t = !1, _;
      }
      function Ui() {
        var _, j, O;
        do
          for (; 0 < er.length; ) for (_ = er, er = [], O = _.length, j = 0; j < O; ++j) {
            var L = _[j];
            L[0].apply(null, L[1]);
          }
        while (0 < er.length);
        Un = $t = !0;
      }
      function du() {
        var _ = Hn;
        Hn = [], _.forEach(function(L) {
          L._PSD.onunhandled.call(null, L._value, L);
        });
        for (var j = sr.slice(0), O = j.length; O; ) j[--O]();
      }
      function ya(_) {
        return new st(nn, !1, _);
      }
      function Tn(_, j) {
        var O = nt;
        return function() {
          var L = Ls(), F = nt;
          try {
            return qs(O, !0), _.apply(this, arguments);
          } catch (W) {
            j && j(W);
          } finally {
            qs(F, !1), L && Ui();
          }
        };
      }
      x(st.prototype, { then: $r, _then: function(_, j) {
        tr(this, new Is(null, null, _, j, nt));
      }, catch: function(_) {
        if (arguments.length === 1) return this.then(null, _);
        var j = _, O = arguments[1];
        return typeof j == "function" ? this.then(null, function(L) {
          return (L instanceof j ? O : ya)(L);
        }) : this.then(null, function(L) {
          return (L && L.name === j ? O : ya)(L);
        });
      }, finally: function(_) {
        return this.then(function(j) {
          return st.resolve(_()).then(function() {
            return j;
          });
        }, function(j) {
          return st.resolve(_()).then(function() {
            return ya(j);
          });
        });
      }, timeout: function(_, j) {
        var O = this;
        return _ < 1 / 0 ? new st(function(L, F) {
          var W = setTimeout(function() {
            return F(new Re.Timeout(j));
          }, _);
          O.then(L, F).finally(clearTimeout.bind(null, W));
        }) : this;
      } }), typeof Symbol < "u" && Symbol.toStringTag && w(st.prototype, Symbol.toStringTag, "Dexie.Promise"), fn.env = hu(), x(st, { all: function() {
        var _ = H.apply(null, arguments).map($s);
        return new st(function(j, O) {
          _.length === 0 && j([]);
          var L = _.length;
          _.forEach(function(F, W) {
            return st.resolve(F).then(function(ue) {
              _[W] = ue, --L || j(_);
            }, O);
          });
        });
      }, resolve: function(_) {
        return _ instanceof st ? _ : _ && typeof _.then == "function" ? new st(function(j, O) {
          _.then(j, O);
        }) : new st(nn, !0, _);
      }, reject: ya, race: function() {
        var _ = H.apply(null, arguments).map($s);
        return new st(function(j, O) {
          _.map(function(L) {
            return st.resolve(L).then(j, O);
          });
        });
      }, PSD: { get: function() {
        return nt;
      }, set: function(_) {
        return nt = _;
      } }, totalEchoes: { get: function() {
        return po;
      } }, newPSD: Rn, usePSD: Ni, scheduler: { get: function() {
        return jt;
      }, set: function(_) {
        jt = _;
      } }, rejectionMapper: { get: function() {
        return Jt;
      }, set: function(_) {
        Jt = _;
      } }, follow: function(_, j) {
        return new st(function(O, L) {
          return Rn(function(F, W) {
            var ue = nt;
            ue.unhandleds = [], ue.onunhandled = W, ue.finalize = ht(function() {
              var U, se = this;
              U = function() {
                se.unhandleds.length === 0 ? F() : W(se.unhandleds[0]);
              }, sr.push(function ie() {
                U(), sr.splice(sr.indexOf(ie), 1);
              }), ++Pn, jt(function() {
                --Pn == 0 && du();
              }, []);
            }, ue.finalize), _();
          }, j, O, L);
        });
      } }), Qe && (Qe.allSettled && w(st, "allSettled", function() {
        var _ = H.apply(null, arguments).map($s);
        return new st(function(j) {
          _.length === 0 && j([]);
          var O = _.length, L = new Array(O);
          _.forEach(function(F, W) {
            return st.resolve(F).then(function(ue) {
              return L[W] = { status: "fulfilled", value: ue };
            }, function(ue) {
              return L[W] = { status: "rejected", reason: ue };
            }).then(function() {
              return --O || j(L);
            });
          });
        });
      }), Qe.any && typeof AggregateError < "u" && w(st, "any", function() {
        var _ = H.apply(null, arguments).map($s);
        return new st(function(j, O) {
          _.length === 0 && O(new AggregateError([]));
          var L = _.length, F = new Array(L);
          _.forEach(function(W, ue) {
            return st.resolve(W).then(function(U) {
              return j(U);
            }, function(U) {
              F[ue] = U, --L || O(new AggregateError(F));
            });
          });
        });
      }), Qe.withResolvers && (st.withResolvers = Qe.withResolvers));
      var Gn = { awaits: 0, echoes: 0, id: 0 }, fu = 0, Fa = [], ho = 0, po = 0, Bs = 0;
      function Rn(_, j, O, L) {
        var F = nt, W = Object.create(F);
        return W.parent = F, W.ref = 0, W.global = !1, W.id = ++Bs, W.env = bt ? { Promise: st, PromiseProp: { value: st, configurable: !0, writable: !0 }, all: st.all, race: st.race, allSettled: st.allSettled, any: st.any, resolve: st.resolve, reject: st.reject } : {}, j && d(W, j), ++F.ref, W.finalize = function() {
          --this.parent.ref || this.parent.finalize();
        }, L = Ni(W, _, O, L), W.ref === 0 && W.finalize(), L;
      }
      function ar() {
        return Gn.id || (Gn.id = ++fu), ++Gn.awaits, Gn.echoes += kn, Gn.id;
      }
      function Yr() {
        return !!Gn.awaits && (--Gn.awaits == 0 && (Gn.id = 0), Gn.echoes = Gn.awaits * kn, !0);
      }
      function $s(_) {
        return Gn.echoes && _ && _.constructor === Qe ? (ar(), _.then(function(j) {
          return Yr(), j;
        }, function(j) {
          return Yr(), mn(j);
        })) : _;
      }
      function lc() {
        var _ = Fa[Fa.length - 1];
        Fa.pop(), qs(_, !1);
      }
      function qs(_, j) {
        var O, L = nt;
        (j ? !Gn.echoes || ho++ && _ === nt : !ho || --ho && _ === nt) || queueMicrotask(j ? (function(F) {
          ++po, Gn.echoes && --Gn.echoes != 0 || (Gn.echoes = Gn.awaits = Gn.id = 0), Fa.push(nt), qs(F, !0);
        }).bind(null, _) : lc), _ !== nt && (nt = _, L === fn && (fn.env = hu()), bt && (O = fn.env.Promise, j = _.env, (L.global || _.global) && (Object.defineProperty(s, "Promise", j.PromiseProp), O.all = j.all, O.race = j.race, O.resolve = j.resolve, O.reject = j.reject, j.allSettled && (O.allSettled = j.allSettled), j.any && (O.any = j.any))));
      }
      function hu() {
        var _ = s.Promise;
        return bt ? { Promise: _, PromiseProp: Object.getOwnPropertyDescriptor(s, "Promise"), all: _.all, race: _.race, allSettled: _.allSettled, any: _.any, resolve: _.resolve, reject: _.reject } : {};
      }
      function Ni(_, j, O, L, F) {
        var W = nt;
        try {
          return qs(_, !0), j(O, L, F);
        } finally {
          qs(W, !1);
        }
      }
      function ol(_, j, O, L) {
        return typeof _ != "function" ? _ : function() {
          var F = nt;
          O && ar(), qs(j, !0);
          try {
            return _.apply(this, arguments);
          } finally {
            qs(F, !1), L && queueMicrotask(Yr);
          }
        };
      }
      function Fs(_) {
        Promise === Qe && Gn.echoes === 0 ? ho === 0 ? _() : enqueueNativeMicroTask(_) : setTimeout(_, 0);
      }
      ("" + li).indexOf("[native code]") === -1 && (ar = Yr = Je);
      var mn = st.reject, wi = "", _r = "Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.", or = "String expected.", xa = [], mo = "__dbnames", Hi = "readonly", fs = "readwrite";
      function Us(_, j) {
        return _ ? j ? function() {
          return _.apply(this, arguments) && j.apply(this, arguments);
        } : _ : j;
      }
      var ll = { type: 3, lower: -1 / 0, lowerOpen: !1, upper: [[]], upperOpen: !1 };
      function go(_) {
        return typeof _ != "string" || /\./.test(_) ? function(j) {
          return j;
        } : function(j) {
          return j[_] === void 0 && _ in j && delete (j = le(j))[_], j;
        };
      }
      function uc() {
        throw Re.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.");
      }
      function Vt(_, j) {
        try {
          var O = Ua(_), L = Ua(j);
          if (O !== L) return O === "Array" ? 1 : L === "Array" ? -1 : O === "binary" ? 1 : L === "binary" ? -1 : O === "string" ? 1 : L === "string" ? -1 : O === "Date" ? 1 : L !== "Date" ? NaN : -1;
          switch (O) {
            case "number":
            case "Date":
            case "string":
              return j < _ ? 1 : _ < j ? -1 : 0;
            case "binary":
              return (function(F, W) {
                for (var ue = F.length, U = W.length, se = ue < U ? ue : U, ie = 0; ie < se; ++ie) if (F[ie] !== W[ie]) return F[ie] < W[ie] ? -1 : 1;
                return ue === U ? 0 : ue < U ? -1 : 1;
              })(Ri(_), Ri(j));
            case "Array":
              return (function(F, W) {
                for (var ue = F.length, U = W.length, se = ue < U ? ue : U, ie = 0; ie < se; ++ie) {
                  var me = Vt(F[ie], W[ie]);
                  if (me !== 0) return me;
                }
                return ue === U ? 0 : ue < U ? -1 : 1;
              })(_, j);
          }
        } catch {
        }
        return NaN;
      }
      function Ua(_) {
        var j = typeof _;
        return j != "object" ? j : ArrayBuffer.isView(_) ? "binary" : (_ = oe(_), _ === "ArrayBuffer" ? "binary" : _);
      }
      function Ri(_) {
        return _ instanceof Uint8Array ? _ : ArrayBuffer.isView(_) ? new Uint8Array(_.buffer, _.byteOffset, _.byteLength) : new Uint8Array(_);
      }
      function Nr(_, j, O) {
        var L = _.schema.yProps;
        return L ? (j && 0 < O.numFailures && (j = j.filter(function(F, W) {
          return !O.failures[W];
        })), Promise.all(L.map(function(F) {
          return F = F.updatesTable, j ? _.db.table(F).where("k").anyOf(j).delete() : _.db.table(F).clear();
        })).then(function() {
          return O;
        })) : O;
      }
      var Hs = (cc.prototype.execute = function(_) {
        var j = this["@@propmod"];
        if (j.add !== void 0) {
          var O = j.add;
          if (u(O)) return i(i([], u(_) ? _ : [], !0), O).sort();
          if (typeof O == "number") return (Number(_) || 0) + O;
          if (typeof O == "bigint") try {
            return BigInt(_) + O;
          } catch {
            return BigInt(0) + O;
          }
          throw new TypeError("Invalid term ".concat(O));
        }
        if (j.remove !== void 0) {
          var L = j.remove;
          if (u(L)) return u(_) ? _.filter(function(F) {
            return !L.includes(F);
          }).sort() : [];
          if (typeof L == "number") return Number(_) - L;
          if (typeof L == "bigint") try {
            return BigInt(_) - L;
          } catch {
            return BigInt(0) - L;
          }
          throw new TypeError("Invalid subtrahend ".concat(L));
        }
        return O = (O = j.replacePrefix) === null || O === void 0 ? void 0 : O[0], O && typeof _ == "string" && _.startsWith(O) ? j.replacePrefix[1] + _.substring(O.length) : _;
      }, cc);
      function cc(_) {
        this["@@propmod"] = _;
      }
      function Vs(_, j) {
        for (var O = a(j), L = O.length, F = !1, W = 0; W < L; ++W) {
          var ue = O[W], U = j[ue], se = D(_, ue);
          U instanceof Hs ? (q(_, ue, U.execute(se)), F = !0) : se !== U && (q(_, ue, U), F = !0);
        }
        return F;
      }
      var Ha = (ln.prototype._trans = function(_, j, O) {
        var L = this._tx || nt.trans, F = this.name, W = Ht && typeof console < "u" && console.createTask && console.createTask("Dexie: ".concat(_ === "readonly" ? "read" : "write", " ").concat(this.name));
        function ue(ie, me, he) {
          if (!he.schema[F]) throw new Re.NotFound("Table " + F + " not part of transaction");
          return j(he.idbtrans, he);
        }
        var U = Ls();
        try {
          var se = L && L.db._novip === this.db._novip ? L === nt.trans ? L._promise(_, ue, O) : Rn(function() {
            return L._promise(_, ue, O);
          }, { trans: L, transless: nt.transless || nt }) : (function ie(me, he, _e, be) {
            if (me.idbdb && (me._state.openComplete || nt.letThrough || me._vip)) {
              var we = me._createTransaction(he, _e, me._dbSchema);
              try {
                we.create(), me._state.PR1398_maxLoop = 3;
              } catch (ke) {
                return ke.name === Me.InvalidState && me.isOpen() && 0 < --me._state.PR1398_maxLoop ? (console.warn("Dexie: Need to reopen db"), me.close({ disableAutoOpen: !1 }), me.open().then(function() {
                  return ie(me, he, _e, be);
                })) : mn(ke);
              }
              return we._promise(he, function(ke, Te) {
                return Rn(function() {
                  return nt.trans = we, be(ke, Te, we);
                });
              }).then(function(ke) {
                if (he === "readwrite") try {
                  we.idbtrans.commit();
                } catch {
                }
                return he === "readonly" ? ke : we._completion.then(function() {
                  return ke;
                });
              });
            }
            if (me._state.openComplete) return mn(new Re.DatabaseClosed(me._state.dbOpenError));
            if (!me._state.isBeingOpened) {
              if (!me._state.autoOpen) return mn(new Re.DatabaseClosed());
              me.open().catch(Je);
            }
            return me._state.dbReadyPromise.then(function() {
              return ie(me, he, _e, be);
            });
          })(this.db, _, [this.name], ue);
          return W && (se._consoleTask = W, se = se.catch(function(ie) {
            return console.trace(ie), mn(ie);
          })), se;
        } finally {
          U && Ui();
        }
      }, ln.prototype.get = function(_, j) {
        var O = this;
        return _ && _.constructor === Object ? this.where(_).first(j) : _ == null ? mn(new Re.Type("Invalid argument to Table.get()")) : this._trans("readonly", function(L) {
          return O.core.get({ trans: L, key: _ }).then(function(F) {
            return O.hook.reading.fire(F);
          });
        }).then(j);
      }, ln.prototype.where = function(_) {
        if (typeof _ == "string") return new this.db.WhereClause(this, _);
        if (u(_)) return new this.db.WhereClause(this, "[".concat(_.join("+"), "]"));
        var j = a(_);
        if (j.length === 1) return this.where(j[0]).equals(_[j[0]]);
        var O = this.schema.indexes.concat(this.schema.primKey).filter(function(U) {
          if (U.compound && j.every(function(ie) {
            return 0 <= U.keyPath.indexOf(ie);
          })) {
            for (var se = 0; se < j.length; ++se) if (j.indexOf(U.keyPath[se]) === -1) return !1;
            return !0;
          }
          return !1;
        }).sort(function(U, se) {
          return U.keyPath.length - se.keyPath.length;
        })[0];
        if (O && this.db._maxKey !== wi) {
          var W = O.keyPath.slice(0, j.length);
          return this.where(W).equals(W.map(function(se) {
            return _[se];
          }));
        }
        !O && Ht && console.warn("The query ".concat(JSON.stringify(_), " on ").concat(this.name, " would benefit from a ") + "compound index [".concat(j.join("+"), "]"));
        var L = this.schema.idxByName;
        function F(U, se) {
          return Vt(U, se) === 0;
        }
        var ue = j.reduce(function(he, se) {
          var ie = he[0], me = he[1], he = L[se], _e = _[se];
          return [ie || he, ie || !he ? Us(me, he && he.multi ? function(be) {
            return be = D(be, se), u(be) && be.some(function(we) {
              return F(_e, we);
            });
          } : function(be) {
            return F(_e, D(be, se));
          }) : me];
        }, [null, null]), W = ue[0], ue = ue[1];
        return W ? this.where(W.name).equals(_[W.keyPath]).filter(ue) : O ? this.filter(ue) : this.where(j).equals("");
      }, ln.prototype.filter = function(_) {
        return this.toCollection().and(_);
      }, ln.prototype.count = function(_) {
        return this.toCollection().count(_);
      }, ln.prototype.offset = function(_) {
        return this.toCollection().offset(_);
      }, ln.prototype.limit = function(_) {
        return this.toCollection().limit(_);
      }, ln.prototype.each = function(_) {
        return this.toCollection().each(_);
      }, ln.prototype.toArray = function(_) {
        return this.toCollection().toArray(_);
      }, ln.prototype.toCollection = function() {
        return new this.db.Collection(new this.db.WhereClause(this));
      }, ln.prototype.orderBy = function(_) {
        return new this.db.Collection(new this.db.WhereClause(this, u(_) ? "[".concat(_.join("+"), "]") : _));
      }, ln.prototype.reverse = function() {
        return this.toCollection().reverse();
      }, ln.prototype.mapToClass = function(_) {
        var j, O = this.db, L = this.name;
        function F() {
          return j !== null && j.apply(this, arguments) || this;
        }
        (this.schema.mappedClass = _).prototype instanceof uc && ((function(se, ie) {
          if (typeof ie != "function" && ie !== null) throw new TypeError("Class extends value " + String(ie) + " is not a constructor or null");
          function me() {
            this.constructor = se;
          }
          n(se, ie), se.prototype = ie === null ? Object.create(ie) : (me.prototype = ie.prototype, new me());
        })(F, j = _), Object.defineProperty(F.prototype, "db", { get: function() {
          return O;
        }, enumerable: !1, configurable: !0 }), F.prototype.table = function() {
          return L;
        }, _ = F);
        for (var W = /* @__PURE__ */ new Set(), ue = _.prototype; ue; ue = f(ue)) Object.getOwnPropertyNames(ue).forEach(function(se) {
          return W.add(se);
        });
        function U(se) {
          if (!se) return se;
          var ie, me = Object.create(_.prototype);
          for (ie in se) if (!W.has(ie)) try {
            me[ie] = se[ie];
          } catch {
          }
          return me;
        }
        return this.schema.readHook && this.hook.reading.unsubscribe(this.schema.readHook), this.schema.readHook = U, this.hook("reading", U), _;
      }, ln.prototype.defineClass = function() {
        return this.mapToClass(function(_) {
          d(this, _);
        });
      }, ln.prototype.add = function(_, j) {
        var O = this, L = this.schema.primKey, F = L.auto, W = L.keyPath, ue = _;
        return W && F && (ue = go(W)(_)), this._trans("readwrite", function(U) {
          return O.core.mutate({ trans: U, type: "add", keys: j != null ? [j] : null, values: [ue] });
        }).then(function(U) {
          return U.numFailures ? st.reject(U.failures[0]) : U.lastResult;
        }).then(function(U) {
          if (W) try {
            q(_, W, U);
          } catch {
          }
          return U;
        });
      }, ln.prototype.upsert = function(_, j) {
        var O = this, L = this.schema.primKey.keyPath;
        return this._trans("readwrite", function(F) {
          return O.core.get({ trans: F, key: _ }).then(function(W) {
            var ue = W ?? {};
            return Vs(ue, j), L && q(ue, L, _), O.core.mutate({ trans: F, type: "put", values: [ue], keys: [_], upsert: !0, updates: { keys: [_], changeSpecs: [j] } }).then(function(U) {
              return U.numFailures ? st.reject(U.failures[0]) : !!W;
            });
          });
        });
      }, ln.prototype.update = function(_, j) {
        return typeof _ != "object" || u(_) ? this.where(":id").equals(_).modify(j) : (_ = D(_, this.schema.primKey.keyPath), _ === void 0 ? mn(new Re.InvalidArgument("Given object does not contain its primary key")) : this.where(":id").equals(_).modify(j));
      }, ln.prototype.put = function(_, j) {
        var O = this, L = this.schema.primKey, F = L.auto, W = L.keyPath, ue = _;
        return W && F && (ue = go(W)(_)), this._trans("readwrite", function(U) {
          return O.core.mutate({ trans: U, type: "put", values: [ue], keys: j != null ? [j] : null });
        }).then(function(U) {
          return U.numFailures ? st.reject(U.failures[0]) : U.lastResult;
        }).then(function(U) {
          if (W) try {
            q(_, W, U);
          } catch {
          }
          return U;
        });
      }, ln.prototype.delete = function(_) {
        var j = this;
        return this._trans("readwrite", function(O) {
          return j.core.mutate({ trans: O, type: "delete", keys: [_] }).then(function(L) {
            return Nr(j, [_], L);
          }).then(function(L) {
            return L.numFailures ? st.reject(L.failures[0]) : void 0;
          });
        });
      }, ln.prototype.clear = function() {
        var _ = this;
        return this._trans("readwrite", function(j) {
          return _.core.mutate({ trans: j, type: "deleteRange", range: ll }).then(function(O) {
            return Nr(_, null, O);
          });
        }).then(function(j) {
          return j.numFailures ? st.reject(j.failures[0]) : void 0;
        });
      }, ln.prototype.bulkGet = function(_) {
        var j = this;
        return this._trans("readonly", function(O) {
          return j.core.getMany({ keys: _, trans: O }).then(function(L) {
            return L.map(function(F) {
              return j.hook.reading.fire(F);
            });
          });
        });
      }, ln.prototype.bulkAdd = function(_, j, O) {
        var L = this, F = Array.isArray(j) ? j : void 0, W = (O = O || (F ? void 0 : j)) ? O.allKeys : void 0;
        return this._trans("readwrite", function(ue) {
          var ie = L.schema.primKey, U = ie.auto, ie = ie.keyPath;
          if (ie && F) throw new Re.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");
          if (F && F.length !== _.length) throw new Re.InvalidArgument("Arguments objects and keys must have the same length");
          var se = _.length, ie = ie && U ? _.map(go(ie)) : _;
          return L.core.mutate({ trans: ue, type: "add", keys: F, values: ie, wantResults: W }).then(function(we) {
            var he = we.numFailures, _e = we.results, be = we.lastResult, we = we.failures;
            if (he === 0) return W ? _e : be;
            throw new Se("".concat(L.name, ".bulkAdd(): ").concat(he, " of ").concat(se, " operations failed"), we);
          });
        });
      }, ln.prototype.bulkPut = function(_, j, O) {
        var L = this, F = Array.isArray(j) ? j : void 0, W = (O = O || (F ? void 0 : j)) ? O.allKeys : void 0;
        return this._trans("readwrite", function(ue) {
          var ie = L.schema.primKey, U = ie.auto, ie = ie.keyPath;
          if (ie && F) throw new Re.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");
          if (F && F.length !== _.length) throw new Re.InvalidArgument("Arguments objects and keys must have the same length");
          var se = _.length, ie = ie && U ? _.map(go(ie)) : _;
          return L.core.mutate({ trans: ue, type: "put", keys: F, values: ie, wantResults: W }).then(function(we) {
            var he = we.numFailures, _e = we.results, be = we.lastResult, we = we.failures;
            if (he === 0) return W ? _e : be;
            throw new Se("".concat(L.name, ".bulkPut(): ").concat(he, " of ").concat(se, " operations failed"), we);
          });
        });
      }, ln.prototype.bulkUpdate = function(_) {
        var j = this, O = this.core, L = _.map(function(ue) {
          return ue.key;
        }), F = _.map(function(ue) {
          return ue.changes;
        }), W = [];
        return this._trans("readwrite", function(ue) {
          return O.getMany({ trans: ue, keys: L, cache: "clone" }).then(function(U) {
            var se = [], ie = [];
            _.forEach(function(he, _e) {
              var be = he.key, we = he.changes, ke = U[_e];
              if (ke) {
                for (var Te = 0, Ae = Object.keys(we); Te < Ae.length; Te++) {
                  var ze = Ae[Te], qe = we[ze];
                  if (ze === j.schema.primKey.keyPath) {
                    if (Vt(qe, be) !== 0) throw new Re.Constraint("Cannot update primary key in bulkUpdate()");
                  } else q(ke, ze, qe);
                }
                W.push(_e), se.push(be), ie.push(ke);
              }
            });
            var me = se.length;
            return O.mutate({ trans: ue, type: "put", keys: se, values: ie, updates: { keys: L, changeSpecs: F } }).then(function(he) {
              var _e = he.numFailures, be = he.failures;
              if (_e === 0) return me;
              for (var we = 0, ke = Object.keys(be); we < ke.length; we++) {
                var Te, Ae = ke[we], ze = W[Number(Ae)];
                ze != null && (Te = be[Ae], delete be[Ae], be[ze] = Te);
              }
              throw new Se("".concat(j.name, ".bulkUpdate(): ").concat(_e, " of ").concat(me, " operations failed"), be);
            });
          });
        });
      }, ln.prototype.bulkDelete = function(_) {
        var j = this, O = _.length;
        return this._trans("readwrite", function(L) {
          return j.core.mutate({ trans: L, type: "delete", keys: _ }).then(function(F) {
            return Nr(j, _, F);
          });
        }).then(function(ue) {
          var F = ue.numFailures, W = ue.lastResult, ue = ue.failures;
          if (F === 0) return W;
          throw new Se("".concat(j.name, ".bulkDelete(): ").concat(F, " of ").concat(O, " operations failed"), ue);
        });
      }, ln);
      function ln() {
      }
      function yo(_) {
        function j(ue, U) {
          if (U) {
            for (var se = arguments.length, ie = new Array(se - 1); --se; ) ie[se - 1] = arguments[se];
            return O[ue].subscribe.apply(null, ie), _;
          }
          if (typeof ue == "string") return O[ue];
        }
        var O = {};
        j.addEventType = W;
        for (var L = 1, F = arguments.length; L < F; ++L) W(arguments[L]);
        return j;
        function W(ue, U, se) {
          if (typeof ue != "object") {
            var ie;
            U = U || Dt;
            var me = { subscribers: [], fire: se = se || Je, subscribe: function(he) {
              me.subscribers.indexOf(he) === -1 && (me.subscribers.push(he), me.fire = U(me.fire, he));
            }, unsubscribe: function(he) {
              me.subscribers = me.subscribers.filter(function(_e) {
                return _e !== he;
              }), me.fire = me.subscribers.reduce(U, se);
            } };
            return O[ue] = j[ue] = me;
          }
          a(ie = ue).forEach(function(he) {
            var _e = ie[he];
            if (u(_e)) W(he, ie[he][0], ie[he][1]);
            else {
              if (_e !== "asap") throw new Re.InvalidArgument("Invalid event config");
              var be = W(he, ft, function() {
                for (var we = arguments.length, ke = new Array(we); we--; ) ke[we] = arguments[we];
                be.subscribers.forEach(function(Te) {
                  P(function() {
                    Te.apply(null, ke);
                  });
                });
              });
            }
          });
        }
      }
      function Sr(_, j) {
        return S(j).from({ prototype: _ }), j;
      }
      function Mi(_, j) {
        return !(_.filter || _.algorithm || _.or) && (j ? _.justLimit : !_.replayFilter);
      }
      function Va(_, j) {
        _.filter = Us(_.filter, j);
      }
      function xo(_, j, O) {
        var L = _.replayFilter;
        _.replayFilter = L ? function() {
          return Us(L(), j());
        } : j, _.justLimit = O && !L;
      }
      function Oi(_, j) {
        if (_.isPrimKey) return j.primaryKey;
        var O = j.getIndexByKeyPath(_.index);
        if (!O) throw new Re.Schema("KeyPath " + _.index + " on object store " + j.name + " is not indexed");
        return O;
      }
      function pu(_, j, O) {
        var L = Oi(_, j.schema);
        return j.openCursor({ trans: O, values: !_.keysOnly, reverse: _.dir === "prev", unique: !!_.unique, query: { index: L, range: _.range } });
      }
      function vo(_, j, O, L) {
        var F = _.replayFilter ? Us(_.filter, _.replayFilter()) : _.filter;
        if (_.or) {
          var W = {}, ue = function(U, se, ie) {
            var me, he;
            F && !F(se, ie, function(_e) {
              return se.stop(_e);
            }, function(_e) {
              return se.fail(_e);
            }) || ((he = "" + (me = se.primaryKey)) == "[object ArrayBuffer]" && (he = "" + new Uint8Array(me)), m(W, he) || (W[he] = !0, j(U, se, ie)));
          };
          return Promise.all([_.or._iterate(ue, O), Vi(pu(_, L, O), _.algorithm, ue, !_.keysOnly && _.valueMapper)]);
        }
        return Vi(pu(_, L, O), Us(_.algorithm, F), j, !_.keysOnly && _.valueMapper);
      }
      function Vi(_, j, O, L) {
        var F = Tn(L ? function(W, ue, U) {
          return O(L(W), ue, U);
        } : O);
        return _.then(function(W) {
          if (W) return W.start(function() {
            var ue = function() {
              return W.continue();
            };
            j && !j(W, function(U) {
              return ue = U;
            }, function(U) {
              W.stop(U), ue = Je;
            }, function(U) {
              W.fail(U), ue = Je;
            }) || F(W.value, W, function(U) {
              return ue = U;
            }), ue();
          });
        });
      }
      var Oh = (rn.prototype._read = function(_, j) {
        var O = this._ctx;
        return O.error ? O.table._trans(null, mn.bind(null, O.error)) : O.table._trans("readonly", _).then(j);
      }, rn.prototype._write = function(_) {
        var j = this._ctx;
        return j.error ? j.table._trans(null, mn.bind(null, j.error)) : j.table._trans("readwrite", _, "locked");
      }, rn.prototype._addAlgorithm = function(_) {
        var j = this._ctx;
        j.algorithm = Us(j.algorithm, _);
      }, rn.prototype._iterate = function(_, j) {
        return vo(this._ctx, _, j, this._ctx.table.core);
      }, rn.prototype.clone = function(_) {
        var j = Object.create(this.constructor.prototype), O = Object.create(this._ctx);
        return _ && d(O, _), j._ctx = O, j;
      }, rn.prototype.raw = function() {
        return this._ctx.valueMapper = null, this;
      }, rn.prototype.each = function(_) {
        var j = this._ctx;
        return this._read(function(O) {
          return vo(j, _, O, j.table.core);
        });
      }, rn.prototype.count = function(_) {
        var j = this;
        return this._read(function(O) {
          var L = j._ctx, F = L.table.core;
          if (Mi(L, !0)) return F.count({ trans: O, query: { index: Oi(L, F.schema), range: L.range } }).then(function(ue) {
            return Math.min(ue, L.limit);
          });
          var W = 0;
          return vo(L, function() {
            return ++W, !1;
          }, O, F).then(function() {
            return W;
          });
        }).then(_);
      }, rn.prototype.sortBy = function(_, j) {
        var O = _.split(".").reverse(), L = O[0], F = O.length - 1;
        function W(se, ie) {
          return ie ? W(se[O[ie]], ie - 1) : se[L];
        }
        var ue = this._ctx.dir === "next" ? 1 : -1;
        function U(se, ie) {
          return Vt(W(se, F), W(ie, F)) * ue;
        }
        return this.toArray(function(se) {
          return se.sort(U);
        }).then(j);
      }, rn.prototype.toArray = function(_) {
        var j = this;
        return this._read(function(O) {
          var L = j._ctx;
          if (L.dir === "next" && Mi(L, !0) && 0 < L.limit) {
            var F = L.valueMapper, W = Oi(L, L.table.core.schema);
            return L.table.core.query({ trans: O, limit: L.limit, values: !0, query: { index: W, range: L.range } }).then(function(U) {
              return U = U.result, F ? U.map(F) : U;
            });
          }
          var ue = [];
          return vo(L, function(U) {
            return ue.push(U);
          }, O, L.table.core).then(function() {
            return ue;
          });
        }, _);
      }, rn.prototype.offset = function(_) {
        var j = this._ctx;
        return _ <= 0 || (j.offset += _, Mi(j) ? xo(j, function() {
          var O = _;
          return function(L, F) {
            return O === 0 || (O === 1 ? --O : F(function() {
              L.advance(O), O = 0;
            }), !1);
          };
        }) : xo(j, function() {
          var O = _;
          return function() {
            return --O < 0;
          };
        })), this;
      }, rn.prototype.limit = function(_) {
        return this._ctx.limit = Math.min(this._ctx.limit, _), xo(this._ctx, function() {
          var j = _;
          return function(O, L, F) {
            return --j <= 0 && L(F), 0 <= j;
          };
        }, !0), this;
      }, rn.prototype.until = function(_, j) {
        return Va(this._ctx, function(O, L, F) {
          return !_(O.value) || (L(F), j);
        }), this;
      }, rn.prototype.first = function(_) {
        return this.limit(1).toArray(function(j) {
          return j[0];
        }).then(_);
      }, rn.prototype.last = function(_) {
        return this.reverse().first(_);
      }, rn.prototype.filter = function(_) {
        var j;
        return Va(this._ctx, function(O) {
          return _(O.value);
        }), (j = this._ctx).isMatch = Us(j.isMatch, _), this;
      }, rn.prototype.and = function(_) {
        return this.filter(_);
      }, rn.prototype.or = function(_) {
        return new this.db.WhereClause(this._ctx.table, _, this);
      }, rn.prototype.reverse = function() {
        return this._ctx.dir = this._ctx.dir === "prev" ? "next" : "prev", this._ondirectionchange && this._ondirectionchange(this._ctx.dir), this;
      }, rn.prototype.desc = function() {
        return this.reverse();
      }, rn.prototype.eachKey = function(_) {
        var j = this._ctx;
        return j.keysOnly = !j.isMatch, this.each(function(O, L) {
          _(L.key, L);
        });
      }, rn.prototype.eachUniqueKey = function(_) {
        return this._ctx.unique = "unique", this.eachKey(_);
      }, rn.prototype.eachPrimaryKey = function(_) {
        var j = this._ctx;
        return j.keysOnly = !j.isMatch, this.each(function(O, L) {
          _(L.primaryKey, L);
        });
      }, rn.prototype.keys = function(_) {
        var j = this._ctx;
        j.keysOnly = !j.isMatch;
        var O = [];
        return this.each(function(L, F) {
          O.push(F.key);
        }).then(function() {
          return O;
        }).then(_);
      }, rn.prototype.primaryKeys = function(_) {
        var j = this._ctx;
        if (j.dir === "next" && Mi(j, !0) && 0 < j.limit) return this._read(function(L) {
          var F = Oi(j, j.table.core.schema);
          return j.table.core.query({ trans: L, values: !1, limit: j.limit, query: { index: F, range: j.range } });
        }).then(function(L) {
          return L.result;
        }).then(_);
        j.keysOnly = !j.isMatch;
        var O = [];
        return this.each(function(L, F) {
          O.push(F.primaryKey);
        }).then(function() {
          return O;
        }).then(_);
      }, rn.prototype.uniqueKeys = function(_) {
        return this._ctx.unique = "unique", this.keys(_);
      }, rn.prototype.firstKey = function(_) {
        return this.limit(1).keys(function(j) {
          return j[0];
        }).then(_);
      }, rn.prototype.lastKey = function(_) {
        return this.reverse().firstKey(_);
      }, rn.prototype.distinct = function() {
        var _ = this._ctx, _ = _.index && _.table.schema.idxByName[_.index];
        if (!_ || !_.multi) return this;
        var j = {};
        return Va(this._ctx, function(F) {
          var L = F.primaryKey.toString(), F = m(j, L);
          return j[L] = !0, !F;
        }), this;
      }, rn.prototype.modify = function(_) {
        var j = this, O = this._ctx;
        return this._write(function(L) {
          var F = typeof _ == "function" ? _ : function(ke) {
            return Vs(ke, _);
          }, W = O.table.core, ie = W.schema.primaryKey, ue = ie.outbound, U = ie.extractKey, se = 200, ie = j.db._options.modifyChunkSize;
          ie && (se = typeof ie == "object" ? ie[W.name] || ie["*"] || 200 : ie);
          function me(ke, ze) {
            var Ae = ze.failures, ze = ze.numFailures;
            _e += ke - ze;
            for (var qe = 0, Ve = a(Ae); qe < Ve.length; qe++) {
              var rt = Ve[qe];
              he.push(Ae[rt]);
            }
          }
          var he = [], _e = 0, be = [], we = _ === zd;
          return j.clone().primaryKeys().then(function(ke) {
            function Te(ze) {
              var qe = Math.min(se, ke.length - ze), Ve = ke.slice(ze, ze + qe);
              return (we ? Promise.resolve([]) : W.getMany({ trans: L, keys: Ve, cache: "immutable" })).then(function(rt) {
                var ut = [], He = [], ot = ue ? [] : null, ct = we ? Ve : [];
                if (!we) for (var tt = 0; tt < qe; ++tt) {
                  var vt = rt[tt], Ct = { value: le(vt), primKey: ke[ze + tt] };
                  F.call(Ct, Ct.value, Ct) !== !1 && (Ct.value == null ? ct.push(ke[ze + tt]) : ue || Vt(U(vt), U(Ct.value)) === 0 ? (He.push(Ct.value), ue && ot.push(ke[ze + tt])) : (ct.push(ke[ze + tt]), ut.push(Ct.value)));
                }
                return Promise.resolve(0 < ut.length && W.mutate({ trans: L, type: "add", values: ut }).then(function(Lt) {
                  for (var qt in Lt.failures) ct.splice(parseInt(qt), 1);
                  me(ut.length, Lt);
                })).then(function() {
                  return (0 < He.length || Ae && typeof _ == "object") && W.mutate({ trans: L, type: "put", keys: ot, values: He, criteria: Ae, changeSpec: typeof _ != "function" && _, isAdditionalChunk: 0 < ze }).then(function(Lt) {
                    return me(He.length, Lt);
                  });
                }).then(function() {
                  return (0 < ct.length || Ae && we) && W.mutate({ trans: L, type: "delete", keys: ct, criteria: Ae, isAdditionalChunk: 0 < ze }).then(function(Lt) {
                    return Nr(O.table, ct, Lt);
                  }).then(function(Lt) {
                    return me(ct.length, Lt);
                  });
                }).then(function() {
                  return ke.length > ze + qe && Te(ze + se);
                });
              });
            }
            var Ae = Mi(O) && O.limit === 1 / 0 && (typeof _ != "function" || we) && { index: O.index, range: O.range };
            return Te(0).then(function() {
              if (0 < he.length) throw new ve("Error modifying one or more objects", he, _e, be);
              return ke.length;
            });
          });
        });
      }, rn.prototype.delete = function() {
        var _ = this._ctx, j = _.range;
        return !Mi(_) || _.table.schema.yProps || !_.isPrimKey && j.type !== 3 ? this.modify(zd) : this._write(function(O) {
          var L = _.table.core.schema.primaryKey, F = j;
          return _.table.core.count({ trans: O, query: { index: L, range: F } }).then(function(W) {
            return _.table.core.mutate({ trans: O, type: "deleteRange", range: F }).then(function(se) {
              var U = se.failures, se = se.numFailures;
              if (se) throw new ve("Could not delete some values", Object.keys(U).map(function(ie) {
                return U[ie];
              }), W - se);
              return W - se;
            });
          });
        });
      }, rn);
      function rn() {
      }
      var zd = function(_, j) {
        return j.value = null;
      };
      function dc(_, j) {
        return _ < j ? -1 : _ === j ? 0 : 1;
      }
      function Dh(_, j) {
        return j < _ ? -1 : _ === j ? 0 : 1;
      }
      function _i(_, j, O) {
        return _ = _ instanceof Ga ? new _.Collection(_) : _, _._ctx.error = new (O || TypeError)(j), _;
      }
      function Gs(_) {
        return new _.Collection(_, function() {
          return fc("");
        }).limit(0);
      }
      function Gi(_, j, O, L) {
        var F, W, ue, U, se, ie, me, he = O.length;
        if (!O.every(function(we) {
          return typeof we == "string";
        })) return _i(_, or);
        function _e(we) {
          F = we === "next" ? function(Te) {
            return Te.toUpperCase();
          } : function(Te) {
            return Te.toLowerCase();
          }, W = we === "next" ? function(Te) {
            return Te.toLowerCase();
          } : function(Te) {
            return Te.toUpperCase();
          }, ue = we === "next" ? dc : Dh;
          var ke = O.map(function(Te) {
            return { lower: W(Te), upper: F(Te) };
          }).sort(function(Te, Ae) {
            return ue(Te.lower, Ae.lower);
          });
          U = ke.map(function(Te) {
            return Te.upper;
          }), se = ke.map(function(Te) {
            return Te.lower;
          }), me = (ie = we) === "next" ? "" : L;
        }
        _e("next"), _ = new _.Collection(_, function() {
          return Ks(U[0], se[he - 1] + L);
        }), _._ondirectionchange = function(we) {
          _e(we);
        };
        var be = 0;
        return _._addAlgorithm(function(we, ke, Te) {
          var Ae = we.key;
          if (typeof Ae != "string") return !1;
          var ze = W(Ae);
          if (j(ze, se, be)) return !0;
          for (var qe = null, Ve = be; Ve < he; ++Ve) {
            var rt = (function(ut, He, ot, ct, tt, vt) {
              for (var Ct = Math.min(ut.length, ct.length), Lt = -1, qt = 0; qt < Ct; ++qt) {
                var Zn = He[qt];
                if (Zn !== ct[qt]) return tt(ut[qt], ot[qt]) < 0 ? ut.substr(0, qt) + ot[qt] + ot.substr(qt + 1) : tt(ut[qt], ct[qt]) < 0 ? ut.substr(0, qt) + ct[qt] + ot.substr(qt + 1) : 0 <= Lt ? ut.substr(0, Lt) + He[Lt] + ot.substr(Lt + 1) : null;
                tt(ut[qt], Zn) < 0 && (Lt = qt);
              }
              return Ct < ct.length && vt === "next" ? ut + ot.substr(ut.length) : Ct < ut.length && vt === "prev" ? ut.substr(0, ot.length) : Lt < 0 ? null : ut.substr(0, Lt) + ct[Lt] + ot.substr(Lt + 1);
            })(Ae, ze, U[Ve], se[Ve], ue, ie);
            rt === null && qe === null ? be = Ve + 1 : (qe === null || 0 < ue(qe, rt)) && (qe = rt);
          }
          return ke(qe !== null ? function() {
            we.continue(qe + me);
          } : Te), !1;
        }), _;
      }
      function Ks(_, j, O, L) {
        return { type: 2, lower: _, upper: j, lowerOpen: O, upperOpen: L };
      }
      function fc(_) {
        return { type: 1, lower: _, upper: _ };
      }
      var Ga = (Object.defineProperty(Kn.prototype, "Collection", { get: function() {
        return this._ctx.table.db.Collection;
      }, enumerable: !1, configurable: !0 }), Kn.prototype.between = function(_, j, O, L) {
        O = O !== !1, L = L === !0;
        try {
          return 0 < this._cmp(_, j) || this._cmp(_, j) === 0 && (O || L) && (!O || !L) ? Gs(this) : new this.Collection(this, function() {
            return Ks(_, j, !O, !L);
          });
        } catch {
          return _i(this, _r);
        }
      }, Kn.prototype.equals = function(_) {
        return _ == null ? _i(this, _r) : new this.Collection(this, function() {
          return fc(_);
        });
      }, Kn.prototype.above = function(_) {
        return _ == null ? _i(this, _r) : new this.Collection(this, function() {
          return Ks(_, void 0, !0);
        });
      }, Kn.prototype.aboveOrEqual = function(_) {
        return _ == null ? _i(this, _r) : new this.Collection(this, function() {
          return Ks(_, void 0, !1);
        });
      }, Kn.prototype.below = function(_) {
        return _ == null ? _i(this, _r) : new this.Collection(this, function() {
          return Ks(void 0, _, !1, !0);
        });
      }, Kn.prototype.belowOrEqual = function(_) {
        return _ == null ? _i(this, _r) : new this.Collection(this, function() {
          return Ks(void 0, _);
        });
      }, Kn.prototype.startsWith = function(_) {
        return typeof _ != "string" ? _i(this, or) : this.between(_, _ + wi, !0, !0);
      }, Kn.prototype.startsWithIgnoreCase = function(_) {
        return _ === "" ? this.startsWith(_) : Gi(this, function(j, O) {
          return j.indexOf(O[0]) === 0;
        }, [_], wi);
      }, Kn.prototype.equalsIgnoreCase = function(_) {
        return Gi(this, function(j, O) {
          return j === O[0];
        }, [_], "");
      }, Kn.prototype.anyOfIgnoreCase = function() {
        var _ = H.apply(de, arguments);
        return _.length === 0 ? Gs(this) : Gi(this, function(j, O) {
          return O.indexOf(j) !== -1;
        }, _, "");
      }, Kn.prototype.startsWithAnyOfIgnoreCase = function() {
        var _ = H.apply(de, arguments);
        return _.length === 0 ? Gs(this) : Gi(this, function(j, O) {
          return O.some(function(L) {
            return j.indexOf(L) === 0;
          });
        }, _, wi);
      }, Kn.prototype.anyOf = function() {
        var _ = this, j = H.apply(de, arguments), O = this._cmp;
        try {
          j.sort(O);
        } catch {
          return _i(this, _r);
        }
        if (j.length === 0) return Gs(this);
        var L = new this.Collection(this, function() {
          return Ks(j[0], j[j.length - 1]);
        });
        L._ondirectionchange = function(W) {
          O = W === "next" ? _._ascending : _._descending, j.sort(O);
        };
        var F = 0;
        return L._addAlgorithm(function(W, ue, U) {
          for (var se = W.key; 0 < O(se, j[F]); ) if (++F === j.length) return ue(U), !1;
          return O(se, j[F]) === 0 || (ue(function() {
            W.continue(j[F]);
          }), !1);
        }), L;
      }, Kn.prototype.notEqual = function(_) {
        return this.inAnyRange([[-1 / 0, _], [_, this.db._maxKey]], { includeLowers: !1, includeUppers: !1 });
      }, Kn.prototype.noneOf = function() {
        var _ = H.apply(de, arguments);
        if (_.length === 0) return new this.Collection(this);
        try {
          _.sort(this._ascending);
        } catch {
          return _i(this, _r);
        }
        var j = _.reduce(function(O, L) {
          return O ? O.concat([[O[O.length - 1][1], L]]) : [[-1 / 0, L]];
        }, null);
        return j.push([_[_.length - 1], this.db._maxKey]), this.inAnyRange(j, { includeLowers: !1, includeUppers: !1 });
      }, Kn.prototype.inAnyRange = function(Ae, j) {
        var O = this, L = this._cmp, F = this._ascending, W = this._descending, ue = this._min, U = this._max;
        if (Ae.length === 0) return Gs(this);
        if (!Ae.every(function(ze) {
          return ze[0] !== void 0 && ze[1] !== void 0 && F(ze[0], ze[1]) <= 0;
        })) return _i(this, "First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower", Re.InvalidArgument);
        var se = !j || j.includeLowers !== !1, ie = j && j.includeUppers === !0, me, he = F;
        function _e(ze, qe) {
          return he(ze[0], qe[0]);
        }
        try {
          (me = Ae.reduce(function(ze, qe) {
            for (var Ve = 0, rt = ze.length; Ve < rt; ++Ve) {
              var ut = ze[Ve];
              if (L(qe[0], ut[1]) < 0 && 0 < L(qe[1], ut[0])) {
                ut[0] = ue(ut[0], qe[0]), ut[1] = U(ut[1], qe[1]);
                break;
              }
            }
            return Ve === rt && ze.push(qe), ze;
          }, [])).sort(_e);
        } catch {
          return _i(this, _r);
        }
        var be = 0, we = ie ? function(ze) {
          return 0 < F(ze, me[be][1]);
        } : function(ze) {
          return 0 <= F(ze, me[be][1]);
        }, ke = se ? function(ze) {
          return 0 < W(ze, me[be][0]);
        } : function(ze) {
          return 0 <= W(ze, me[be][0]);
        }, Te = we, Ae = new this.Collection(this, function() {
          return Ks(me[0][0], me[me.length - 1][1], !se, !ie);
        });
        return Ae._ondirectionchange = function(ze) {
          he = ze === "next" ? (Te = we, F) : (Te = ke, W), me.sort(_e);
        }, Ae._addAlgorithm(function(ze, qe, Ve) {
          for (var rt, ut = ze.key; Te(ut); ) if (++be === me.length) return qe(Ve), !1;
          return !we(rt = ut) && !ke(rt) || (O._cmp(ut, me[be][1]) === 0 || O._cmp(ut, me[be][0]) === 0 || qe(function() {
            he === F ? ze.continue(me[be][0]) : ze.continue(me[be][1]);
          }), !1);
        }), Ae;
      }, Kn.prototype.startsWithAnyOf = function() {
        var _ = H.apply(de, arguments);
        return _.every(function(j) {
          return typeof j == "string";
        }) ? _.length === 0 ? Gs(this) : this.inAnyRange(_.map(function(j) {
          return [j, j + wi];
        })) : _i(this, "startsWithAnyOf() only works with strings");
      }, Kn);
      function Kn() {
      }
      function hs(_) {
        return Tn(function(j) {
          return bo(j), _(j.target.error), !1;
        });
      }
      function bo(_) {
        _.stopPropagation && _.stopPropagation(), _.preventDefault && _.preventDefault();
      }
      var ul = "storagemutated", va = "x-storagemutated-1", Wr = yo(null, ul), Pd = (Si.prototype._lock = function() {
        return M(!nt.global), ++this._reculock, this._reculock !== 1 || nt.global || (nt.lockOwnerFor = this), this;
      }, Si.prototype._unlock = function() {
        if (M(!nt.global), --this._reculock == 0) for (nt.global || (nt.lockOwnerFor = null); 0 < this._blockedFuncs.length && !this._locked(); ) {
          var _ = this._blockedFuncs.shift();
          try {
            Ni(_[1], _[0]);
          } catch {
          }
        }
        return this;
      }, Si.prototype._locked = function() {
        return this._reculock && nt.lockOwnerFor !== this;
      }, Si.prototype.create = function(_) {
        var j = this;
        if (!this.mode) return this;
        var O = this.db.idbdb, L = this.db._state.dbOpenError;
        if (M(!this.idbtrans), !_ && !O) switch (L && L.name) {
          case "DatabaseClosedError":
            throw new Re.DatabaseClosed(L);
          case "MissingAPIError":
            throw new Re.MissingAPI(L.message, L);
          default:
            throw new Re.OpenFailed(L);
        }
        if (!this.active) throw new Re.TransactionInactive();
        return M(this._completion._state === null), (_ = this.idbtrans = _ || (this.db.core || O).transaction(this.storeNames, this.mode, { durability: this.chromeTransactionDurability })).onerror = Tn(function(F) {
          bo(F), j._reject(_.error);
        }), _.onabort = Tn(function(F) {
          bo(F), j.active && j._reject(new Re.Abort(_.error)), j.active = !1, j.on("abort").fire(F);
        }), _.oncomplete = Tn(function() {
          j.active = !1, j._resolve(), "mutatedParts" in _ && Wr.storagemutated.fire(_.mutatedParts);
        }), this;
      }, Si.prototype._promise = function(_, j, O) {
        var L = this;
        if (_ === "readwrite" && this.mode !== "readwrite") return mn(new Re.ReadOnly("Transaction is readonly"));
        if (!this.active) return mn(new Re.TransactionInactive());
        if (this._locked()) return new st(function(W, ue) {
          L._blockedFuncs.push([function() {
            L._promise(_, j, O).then(W, ue);
          }, nt]);
        });
        if (O) return Rn(function() {
          var W = new st(function(ue, U) {
            L._lock();
            var se = j(ue, U, L);
            se && se.then && se.then(ue, U);
          });
          return W.finally(function() {
            return L._unlock();
          }), W._lib = !0, W;
        });
        var F = new st(function(W, ue) {
          var U = j(W, ue, L);
          U && U.then && U.then(W, ue);
        });
        return F._lib = !0, F;
      }, Si.prototype._root = function() {
        return this.parent ? this.parent._root() : this;
      }, Si.prototype.waitFor = function(_) {
        var j, O = this._root(), L = st.resolve(_);
        O._waitingFor ? O._waitingFor = O._waitingFor.then(function() {
          return L;
        }) : (O._waitingFor = L, O._waitingQueue = [], j = O.idbtrans.objectStore(O.storeNames[0]), (function W() {
          for (++O._spinCount; O._waitingQueue.length; ) O._waitingQueue.shift()();
          O._waitingFor && (j.get(-1 / 0).onsuccess = W);
        })());
        var F = O._waitingFor;
        return new st(function(W, ue) {
          L.then(function(U) {
            return O._waitingQueue.push(Tn(W.bind(null, U)));
          }, function(U) {
            return O._waitingQueue.push(Tn(ue.bind(null, U)));
          }).finally(function() {
            O._waitingFor === F && (O._waitingFor = null);
          });
        });
      }, Si.prototype.abort = function() {
        this.active && (this.active = !1, this.idbtrans && this.idbtrans.abort(), this._reject(new Re.Abort()));
      }, Si.prototype.table = function(_) {
        var j = this._memoizedTables || (this._memoizedTables = {});
        if (m(j, _)) return j[_];
        var O = this.schema[_];
        if (!O) throw new Re.NotFound("Table " + _ + " not part of transaction");
        return O = new this.db.Table(_, O, this), O.core = this.db.core.table(_), j[_] = O;
      }, Si);
      function Si() {
      }
      function Ys(_, j, O, L, F, W, ue, U) {
        return { name: _, keyPath: j, unique: O, multi: L, auto: F, compound: W, src: (O && !ue ? "&" : "") + (L ? "*" : "") + (F ? "++" : "") + hc(j), type: U };
      }
      function hc(_) {
        return typeof _ == "string" ? _ : _ ? "[" + [].join.call(_, "+") + "]" : "";
      }
      function vn(_, j, O) {
        return { name: _, primKey: j, indexes: O, mappedClass: null, idxByName: (L = function(F) {
          return [F.name, F];
        }, O.reduce(function(F, W, ue) {
          return ue = L(W, ue), ue && (F[ue[0]] = ue[1]), F;
        }, {})) };
        var L;
      }
      var gn = function(_) {
        try {
          return _.only([[]]), gn = function() {
            return [[]];
          }, [[]];
        } catch {
          return gn = function() {
            return wi;
          }, wi;
        }
      };
      function cl(_) {
        return _ == null ? function() {
        } : typeof _ == "string" ? (j = _).split(".").length === 1 ? function(O) {
          return O[j];
        } : function(O) {
          return D(O, j);
        } : function(O) {
          return D(O, _);
        };
        var j;
      }
      function mu(_) {
        return [].slice.call(_);
      }
      var zh = 0;
      function Rr(_) {
        return _ == null ? ":id" : typeof _ == "string" ? _ : "[".concat(_.join("+"), "]");
      }
      function wo(_, j, se) {
        function L(Te) {
          if (Te.type === 3) return null;
          if (Te.type === 4) throw new Error("Cannot convert never type to IDBKeyRange");
          var be = Te.lower, we = Te.upper, ke = Te.lowerOpen, Te = Te.upperOpen;
          return be === void 0 ? we === void 0 ? null : j.upperBound(we, !!Te) : we === void 0 ? j.lowerBound(be, !!ke) : j.bound(be, we, !!ke, !!Te);
        }
        function F(_e) {
          var be, we = _e.name;
          return { name: we, schema: _e, mutate: function(ke) {
            var Te = ke.trans, Ae = ke.type, ze = ke.keys, qe = ke.values, Ve = ke.range;
            return new Promise(function(rt, ut) {
              rt = Tn(rt);
              var He = Te.objectStore(we), ot = He.keyPath == null, ct = Ae === "put" || Ae === "add";
              if (!ct && Ae !== "delete" && Ae !== "deleteRange") throw new Error("Invalid operation type: " + Ae);
              var tt, vt = (ze || qe || { length: 1 }).length;
              if (ze && qe && ze.length !== qe.length) throw new Error("Given keys array must have same length as given values array.");
              if (vt === 0) return rt({ numFailures: 0, failures: {}, results: [], lastResult: void 0 });
              function Ct(Cr) {
                ++Zn, bo(Cr);
              }
              var Lt = [], qt = [], Zn = 0;
              if (Ae === "deleteRange") {
                if (Ve.type === 4) return rt({ numFailures: Zn, failures: qt, results: [], lastResult: void 0 });
                Ve.type === 3 ? Lt.push(tt = He.clear()) : Lt.push(tt = He.delete(L(Ve)));
              } else {
                var ot = ct ? ot ? [qe, ze] : [qe, null] : [ze, null], Rt = ot[0], Er = ot[1];
                if (ct) for (var Ln = 0; Ln < vt; ++Ln) Lt.push(tt = Er && Er[Ln] !== void 0 ? He[Ae](Rt[Ln], Er[Ln]) : He[Ae](Rt[Ln])), tt.onerror = Ct;
                else for (Ln = 0; Ln < vt; ++Ln) Lt.push(tt = He[Ae](Rt[Ln])), tt.onerror = Ct;
              }
              function xl(Cr) {
                Cr = Cr.target.result, Lt.forEach(function(ui, Sc) {
                  return ui.error != null && (qt[Sc] = ui.error);
                }), rt({ numFailures: Zn, failures: qt, results: Ae === "delete" ? ze : Lt.map(function(ui) {
                  return ui.result;
                }), lastResult: Cr });
              }
              tt.onerror = function(Cr) {
                Ct(Cr), xl(Cr);
              }, tt.onsuccess = xl;
            });
          }, getMany: function(ke) {
            var Te = ke.trans, Ae = ke.keys;
            return new Promise(function(ze, qe) {
              ze = Tn(ze);
              for (var Ve, rt = Te.objectStore(we), ut = Ae.length, He = new Array(ut), ot = 0, ct = 0, tt = function(Lt) {
                Lt = Lt.target, He[Lt._pos] = Lt.result, ++ct === ot && ze(He);
              }, vt = hs(qe), Ct = 0; Ct < ut; ++Ct) Ae[Ct] != null && ((Ve = rt.get(Ae[Ct]))._pos = Ct, Ve.onsuccess = tt, Ve.onerror = vt, ++ot);
              ot === 0 && ze(He);
            });
          }, get: function(ke) {
            var Te = ke.trans, Ae = ke.key;
            return new Promise(function(ze, qe) {
              ze = Tn(ze);
              var Ve = Te.objectStore(we).get(Ae);
              Ve.onsuccess = function(rt) {
                return ze(rt.target.result);
              }, Ve.onerror = hs(qe);
            });
          }, query: (be = ie, function(ke) {
            return new Promise(function(Te, Ae) {
              Te = Tn(Te);
              var ze, qe, Ve, ot = ke.trans, rt = ke.values, ut = ke.limit, tt = ke.query, He = ut === 1 / 0 ? void 0 : ut, ct = tt.index, tt = tt.range, ot = ot.objectStore(we), ct = ct.isPrimaryKey ? ot : ot.index(ct.name), tt = L(tt);
              if (ut === 0) return Te({ result: [] });
              be ? ((He = rt ? ct.getAll(tt, He) : ct.getAllKeys(tt, He)).onsuccess = function(vt) {
                return Te({ result: vt.target.result });
              }, He.onerror = hs(Ae)) : (ze = 0, qe = !rt && "openKeyCursor" in ct ? ct.openKeyCursor(tt) : ct.openCursor(tt), Ve = [], qe.onsuccess = function(vt) {
                var Ct = qe.result;
                return Ct ? (Ve.push(rt ? Ct.value : Ct.primaryKey), ++ze === ut ? Te({ result: Ve }) : void Ct.continue()) : Te({ result: Ve });
              }, qe.onerror = hs(Ae));
            });
          }), openCursor: function(ke) {
            var Te = ke.trans, Ae = ke.values, ze = ke.query, qe = ke.reverse, Ve = ke.unique;
            return new Promise(function(rt, ut) {
              rt = Tn(rt);
              var ct = ze.index, He = ze.range, ot = Te.objectStore(we), ot = ct.isPrimaryKey ? ot : ot.index(ct.name), ct = qe ? Ve ? "prevunique" : "prev" : Ve ? "nextunique" : "next", tt = !Ae && "openKeyCursor" in ot ? ot.openKeyCursor(L(He), ct) : ot.openCursor(L(He), ct);
              tt.onerror = hs(ut), tt.onsuccess = Tn(function(vt) {
                var Ct, Lt, qt, Zn, Rt = tt.result;
                Rt ? (Rt.___id = ++zh, Rt.done = !1, Ct = Rt.continue.bind(Rt), Lt = (Lt = Rt.continuePrimaryKey) && Lt.bind(Rt), qt = Rt.advance.bind(Rt), Zn = function() {
                  throw new Error("Cursor not stopped");
                }, Rt.trans = Te, Rt.stop = Rt.continue = Rt.continuePrimaryKey = Rt.advance = function() {
                  throw new Error("Cursor not started");
                }, Rt.fail = Tn(ut), Rt.next = function() {
                  var Er = this, Ln = 1;
                  return this.start(function() {
                    return Ln-- ? Er.continue() : Er.stop();
                  }).then(function() {
                    return Er;
                  });
                }, Rt.start = function(Er) {
                  function Ln() {
                    if (tt.result) try {
                      Er();
                    } catch (Cr) {
                      Rt.fail(Cr);
                    }
                    else Rt.done = !0, Rt.start = function() {
                      throw new Error("Cursor behind last entry");
                    }, Rt.stop();
                  }
                  var xl = new Promise(function(Cr, ui) {
                    Cr = Tn(Cr), tt.onerror = hs(ui), Rt.fail = ui, Rt.stop = function(Sc) {
                      Rt.stop = Rt.continue = Rt.continuePrimaryKey = Rt.advance = Zn, Cr(Sc);
                    };
                  });
                  return tt.onsuccess = Tn(function(Cr) {
                    tt.onsuccess = Ln, Ln();
                  }), Rt.continue = Ct, Rt.continuePrimaryKey = Lt, Rt.advance = qt, Ln(), xl;
                }, rt(Rt)) : rt(null);
              }, ut);
            });
          }, count: function(ke) {
            var Te = ke.query, Ae = ke.trans, ze = Te.index, qe = Te.range;
            return new Promise(function(Ve, rt) {
              var ut = Ae.objectStore(we), He = ze.isPrimaryKey ? ut : ut.index(ze.name), ut = L(qe), He = ut ? He.count(ut) : He.count();
              He.onsuccess = Tn(function(ot) {
                return Ve(ot.target.result);
              }), He.onerror = hs(rt);
            });
          } };
        }
        var W, ue, U, me = (ue = se, U = mu((W = _).objectStoreNames), { schema: { name: W.name, tables: U.map(function(_e) {
          return ue.objectStore(_e);
        }).map(function(_e) {
          var be = _e.keyPath, Te = _e.autoIncrement, we = u(be), ke = {}, Te = { name: _e.name, primaryKey: { name: null, isPrimaryKey: !0, outbound: be == null, compound: we, keyPath: be, autoIncrement: Te, unique: !0, extractKey: cl(be) }, indexes: mu(_e.indexNames).map(function(Ae) {
            return _e.index(Ae);
          }).map(function(Ve) {
            var ze = Ve.name, qe = Ve.unique, rt = Ve.multiEntry, Ve = Ve.keyPath, rt = { name: ze, compound: u(Ve), keyPath: Ve, unique: qe, multiEntry: rt, extractKey: cl(Ve) };
            return ke[Rr(Ve)] = rt;
          }), getIndexByKeyPath: function(Ae) {
            return ke[Rr(Ae)];
          } };
          return ke[":id"] = Te.primaryKey, be != null && (ke[Rr(be)] = Te.primaryKey), Te;
        }) }, hasGetAll: 0 < U.length && "getAll" in ue.objectStore(U[0]) && !(typeof navigator < "u" && /Safari/.test(navigator.userAgent) && !/(Chrome\/|Edge\/)/.test(navigator.userAgent) && [].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1] < 604) }), se = me.schema, ie = me.hasGetAll, me = se.tables.map(F), he = {};
        return me.forEach(function(_e) {
          return he[_e.name] = _e;
        }), { stack: "dbcore", transaction: _.transaction.bind(_), table: function(_e) {
          if (!he[_e]) throw new Error("Table '".concat(_e, "' not found"));
          return he[_e];
        }, MIN_KEY: -1 / 0, MAX_KEY: gn(j), schema: se };
      }
      function pc(_, j, O, L) {
        var F = O.IDBKeyRange;
        return { dbcore: (L = wo(j, F, L), _.dbcore.reduce(function(W, ue) {
          return ue = ue.create, r(r({}, W), ue(W));
        }, L)) };
      }
      function ba(_, L) {
        var O = L.db, L = pc(_._middlewares, O, _._deps, L);
        _.core = L.dbcore, _.tables.forEach(function(F) {
          var W = F.name;
          _.core.schema.tables.some(function(ue) {
            return ue.name === W;
          }) && (F.core = _.core.table(W), _[W] instanceof _.Table && (_[W].core = F.core));
        });
      }
      function mc(_, j, O, L) {
        O.forEach(function(F) {
          var W = L[F];
          j.forEach(function(ue) {
            var U = (function se(ie, me) {
              return C(ie, me) || (ie = f(ie)) && se(ie, me);
            })(ue, F);
            (!U || "value" in U && U.value === void 0) && (ue === _.Transaction.prototype || ue instanceof _.Transaction ? w(ue, F, { get: function() {
              return this.table(F);
            }, set: function(se) {
              b(this, F, { value: se, writable: !0, configurable: !0, enumerable: !0 });
            } }) : ue[F] = new _.Table(F, W));
          });
        });
      }
      function lr(_, j) {
        j.forEach(function(O) {
          for (var L in O) O[L] instanceof _.Table && delete O[L];
        });
      }
      function gu(_, j) {
        return _._cfg.version - j._cfg.version;
      }
      function ps(_, j, O, L) {
        var F = _._dbSchema;
        O.objectStoreNames.contains("$meta") && !F.$meta && (F.$meta = vn("$meta", Ld("")[0], []), _._storeNames.push("$meta"));
        var W = _._createTransaction("readwrite", _._storeNames, F);
        W.create(O), W._completion.catch(L);
        var ue = W._reject.bind(W), U = nt.transless || nt;
        Rn(function() {
          return nt.trans = W, nt.transless = U, j !== 0 ? (ba(_, O), ie = j, ((se = W).storeNames.includes("$meta") ? se.table("$meta").get("version").then(function(me) {
            return me ?? ie;
          }) : st.resolve(ie)).then(function(me) {
            return _e = me, be = W, we = O, ke = [], me = (he = _)._versions, Te = he._dbSchema = _o(0, he.idbdb, we), (me = me.filter(function(Ae) {
              return Ae._cfg.version >= _e;
            })).length !== 0 ? (me.forEach(function(Ae) {
              ke.push(function() {
                var ze = Te, qe = Ae._cfg.dbschema;
                vu(he, ze, we), vu(he, qe, we), Te = he._dbSchema = qe;
                var Ve = dl(ze, qe);
                Ve.add.forEach(function(ct) {
                  Ei(we, ct[0], ct[1].primKey, ct[1].indexes);
                }), Ve.change.forEach(function(ct) {
                  if (ct.recreate) throw new Re.Upgrade("Not yet support for changing primary key");
                  var tt = we.objectStore(ct.name);
                  ct.add.forEach(function(vt) {
                    return xu(tt, vt);
                  }), ct.change.forEach(function(vt) {
                    tt.deleteIndex(vt.name), xu(tt, vt);
                  }), ct.del.forEach(function(vt) {
                    return tt.deleteIndex(vt);
                  });
                });
                var rt = Ae._cfg.contentUpgrade;
                if (rt && Ae._cfg.version > _e) {
                  ba(he, we), be._memoizedTables = {};
                  var ut = Y(qe);
                  Ve.del.forEach(function(ct) {
                    ut[ct] = ze[ct];
                  }), lr(he, [he.Transaction.prototype]), mc(he, [he.Transaction.prototype], a(ut), ut), be.schema = ut;
                  var He, ot = J(rt);
                  return ot && ar(), Ve = st.follow(function() {
                    var ct;
                    (He = rt(be)) && ot && (ct = Yr.bind(null, null), He.then(ct, ct));
                  }), He && typeof He.then == "function" ? st.resolve(He) : Ve.then(function() {
                    return He;
                  });
                }
              }), ke.push(function(ze) {
                var qe, Ve, rt = Ae._cfg.dbschema;
                qe = rt, Ve = ze, [].slice.call(Ve.db.objectStoreNames).forEach(function(ut) {
                  return qe[ut] == null && Ve.db.deleteObjectStore(ut);
                }), lr(he, [he.Transaction.prototype]), mc(he, [he.Transaction.prototype], he._storeNames, he._dbSchema), be.schema = he._dbSchema;
              }), ke.push(function(ze) {
                he.idbdb.objectStoreNames.contains("$meta") && (Math.ceil(he.idbdb.version / 10) === Ae._cfg.version ? (he.idbdb.deleteObjectStore("$meta"), delete he._dbSchema.$meta, he._storeNames = he._storeNames.filter(function(qe) {
                  return qe !== "$meta";
                })) : ze.objectStore("$meta").put(Ae._cfg.version, "version"));
              });
            }), (function Ae() {
              return ke.length ? st.resolve(ke.shift()(be.idbtrans)).then(Ae) : st.resolve();
            })().then(function() {
              Id(Te, we);
            })) : st.resolve();
            var he, _e, be, we, ke, Te;
          }).catch(ue)) : (a(F).forEach(function(me) {
            Ei(O, me, F[me].primKey, F[me].indexes);
          }), ba(_, O), void st.follow(function() {
            return _.on.populate.fire(W);
          }).catch(ue));
          var se, ie;
        });
      }
      function yu(_, j) {
        Id(_._dbSchema, j), j.db.version % 10 != 0 || j.objectStoreNames.contains("$meta") || j.db.createObjectStore("$meta").add(Math.ceil(j.db.version / 10 - 1), "version");
        var O = _o(0, _.idbdb, j);
        vu(_, _._dbSchema, j);
        for (var L = 0, F = dl(O, _._dbSchema).change; L < F.length; L++) {
          var W = (function(ue) {
            if (ue.change.length || ue.recreate) return console.warn("Unable to patch indexes of table ".concat(ue.name, " because it has changes on the type of index or primary key.")), { value: void 0 };
            var U = j.objectStore(ue.name);
            ue.add.forEach(function(se) {
              Ht && console.debug("Dexie upgrade patch: Creating missing index ".concat(ue.name, ".").concat(se.src)), xu(U, se);
            });
          })(F[L]);
          if (typeof W == "object") return W.value;
        }
      }
      function dl(_, j) {
        var O, L = { del: [], add: [], change: [] };
        for (O in _) j[O] || L.del.push(O);
        for (O in j) {
          var F = _[O], W = j[O];
          if (F) {
            var ue = { name: O, def: W, recreate: !1, del: [], add: [], change: [] };
            if ("" + (F.primKey.keyPath || "") != "" + (W.primKey.keyPath || "") || F.primKey.auto !== W.primKey.auto) ue.recreate = !0, L.change.push(ue);
            else {
              var U = F.idxByName, se = W.idxByName, ie = void 0;
              for (ie in U) se[ie] || ue.del.push(ie);
              for (ie in se) {
                var me = U[ie], he = se[ie];
                me ? me.src !== he.src && ue.change.push(he) : ue.add.push(he);
              }
              (0 < ue.del.length || 0 < ue.add.length || 0 < ue.change.length) && L.change.push(ue);
            }
          } else L.add.push([O, W]);
        }
        return L;
      }
      function Ei(_, j, O, L) {
        var F = _.db.createObjectStore(j, O.keyPath ? { keyPath: O.keyPath, autoIncrement: O.auto } : { autoIncrement: O.auto });
        return L.forEach(function(W) {
          return xu(F, W);
        }), F;
      }
      function Id(_, j) {
        a(_).forEach(function(O) {
          j.db.objectStoreNames.contains(O) || (Ht && console.debug("Dexie: Creating missing table", O), Ei(j, O, _[O].primKey, _[O].indexes));
        });
      }
      function xu(_, j) {
        _.createIndex(j.name, j.keyPath, { unique: j.unique, multiEntry: j.multi });
      }
      function _o(_, j, O) {
        var L = {};
        return R(j.objectStoreNames, 0).forEach(function(F) {
          for (var W = O.objectStore(F), ue = Ys(hc(ie = W.keyPath), ie || "", !0, !1, !!W.autoIncrement, ie && typeof ie != "string", !0), U = [], se = 0; se < W.indexNames.length; ++se) {
            var me = W.index(W.indexNames[se]), ie = me.keyPath, me = Ys(me.name, ie, !!me.unique, !!me.multiEntry, !1, ie && typeof ie != "string", !1);
            U.push(me);
          }
          L[F] = vn(F, ue, U);
        }), L;
      }
      function vu(_, j, O) {
        for (var L = O.db.objectStoreNames, F = 0; F < L.length; ++F) {
          var W = L[F], ue = O.objectStore(W);
          _._hasGetAll = "getAll" in ue;
          for (var U = 0; U < ue.indexNames.length; ++U) {
            var se = ue.indexNames[U], ie = ue.index(se).keyPath, me = typeof ie == "string" ? ie : "[" + R(ie).join("+") + "]";
            !j[W] || (ie = j[W].idxByName[me]) && (ie.name = se, delete j[W].idxByName[me], j[W].idxByName[se] = ie);
          }
        }
        typeof navigator < "u" && /Safari/.test(navigator.userAgent) && !/(Chrome\/|Edge\/)/.test(navigator.userAgent) && s.WorkerGlobalScope && s instanceof s.WorkerGlobalScope && [].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1] < 604 && (_._hasGetAll = !1);
      }
      function Ld(_) {
        return _.split(",").map(function(j, O) {
          var W = j.split(":"), L = (F = W[1]) === null || F === void 0 ? void 0 : F.trim(), F = (j = W[0].trim()).replace(/([&*]|\+\+)/g, ""), W = /^\[/.test(F) ? F.match(/^\[(.*)\]$/)[1].split("+") : F;
          return Ys(F, W || null, /\&/.test(j), /\*/.test(j), /\+\+/.test(j), u(W), O === 0, L);
        });
      }
      var Ph = (Mr.prototype._createTableSchema = vn, Mr.prototype._parseIndexSyntax = Ld, Mr.prototype._parseStoresSpec = function(_, j) {
        var O = this;
        a(_).forEach(function(L) {
          if (_[L] !== null) {
            var F = O._parseIndexSyntax(_[L]), W = F.shift();
            if (!W) throw new Re.Schema("Invalid schema for table " + L + ": " + _[L]);
            if (W.unique = !0, W.multi) throw new Re.Schema("Primary key cannot be multiEntry*");
            F.forEach(function(ue) {
              if (ue.auto) throw new Re.Schema("Only primary key can be marked as autoIncrement (++)");
              if (!ue.keyPath) throw new Re.Schema("Index must have a name and cannot be an empty string");
            }), F = O._createTableSchema(L, W, F), j[L] = F;
          }
        });
      }, Mr.prototype.stores = function(O) {
        var j = this.db;
        this._cfg.storesSource = this._cfg.storesSource ? d(this._cfg.storesSource, O) : O;
        var O = j._versions, L = {}, F = {};
        return O.forEach(function(W) {
          d(L, W._cfg.storesSource), F = W._cfg.dbschema = {}, W._parseStoresSpec(L, F);
        }), j._dbSchema = F, lr(j, [j._allTables, j, j.Transaction.prototype]), mc(j, [j._allTables, j, j.Transaction.prototype, this._cfg.tables], a(F), F), j._storeNames = a(F), this;
      }, Mr.prototype.upgrade = function(_) {
        return this._cfg.contentUpgrade = pn(this._cfg.contentUpgrade || Je, _), this;
      }, Mr);
      function Mr() {
      }
      function Bd(_, j) {
        var O = _._dbNamesDB;
        return O || (O = _._dbNamesDB = new oi(mo, { addons: [], indexedDB: _, IDBKeyRange: j })).version(1).stores({ dbnames: "name" }), O.table("dbnames");
      }
      function ai(_) {
        return _ && typeof _.databases == "function";
      }
      function $d(_) {
        return Rn(function() {
          return nt.letThrough = !0, _();
        });
      }
      function gc(_) {
        return !("from" in _);
      }
      var Yn = function(_, j) {
        if (!this) {
          var O = new Yn();
          return _ && "d" in _ && d(O, _), O;
        }
        d(this, arguments.length ? { d: 1, from: _, to: 1 < arguments.length ? j : _ } : { d: 0 });
      };
      function Ka(_, j, O) {
        var L = Vt(j, O);
        if (!isNaN(L)) {
          if (0 < L) throw RangeError();
          if (gc(_)) return d(_, { from: j, to: O, d: 1 });
          var F = _.l, L = _.r;
          if (Vt(O, _.from) < 0) return F ? Ka(F, j, O) : _.l = { from: j, to: O, d: 1, l: null, r: null }, yc(_);
          if (0 < Vt(j, _.to)) return L ? Ka(L, j, O) : _.r = { from: j, to: O, d: 1, l: null, r: null }, yc(_);
          Vt(j, _.from) < 0 && (_.from = j, _.l = null, _.d = L ? L.d + 1 : 1), 0 < Vt(O, _.to) && (_.to = O, _.r = null, _.d = _.l ? _.l.d + 1 : 1), O = !_.r, F && !_.l && wa(_, F), L && O && wa(_, L);
        }
      }
      function wa(_, j) {
        gc(j) || (function O(L, se) {
          var W = se.from, ue = se.to, U = se.l, se = se.r;
          Ka(L, W, ue), U && O(L, U), se && O(L, se);
        })(_, j);
      }
      function In(_, j) {
        var O = ms(j), L = O.next();
        if (L.done) return !1;
        for (var F = L.value, W = ms(_), ue = W.next(F.from), U = ue.value; !L.done && !ue.done; ) {
          if (Vt(U.from, F.to) <= 0 && 0 <= Vt(U.to, F.from)) return !0;
          Vt(F.from, U.from) < 0 ? F = (L = O.next(U.from)).value : U = (ue = W.next(F.from)).value;
        }
        return !1;
      }
      function ms(_) {
        var j = gc(_) ? null : { s: 0, n: _ };
        return { next: function(O) {
          for (var L = 0 < arguments.length; j; ) switch (j.s) {
            case 0:
              if (j.s = 1, L) for (; j.n.l && Vt(O, j.n.from) < 0; ) j = { up: j, n: j.n.l, s: 1 };
              else for (; j.n.l; ) j = { up: j, n: j.n.l, s: 1 };
            case 1:
              if (j.s = 2, !L || Vt(O, j.n.to) <= 0) return { value: j.n, done: !1 };
            case 2:
              if (j.n.r) {
                j.s = 3, j = { up: j, n: j.n.r, s: 0 };
                continue;
              }
            case 3:
              j = j.up;
          }
          return { done: !0 };
        } };
      }
      function yc(_) {
        var j, O, L = (((j = _.r) === null || j === void 0 ? void 0 : j.d) || 0) - (((O = _.l) === null || O === void 0 ? void 0 : O.d) || 0), F = 1 < L ? "r" : L < -1 ? "l" : "";
        F && (j = F == "r" ? "l" : "r", O = r({}, _), L = _[F], _.from = L.from, _.to = L.to, _[F] = L[F], O[F] = L[j], (_[j] = O).d = qd(O)), _.d = qd(_);
      }
      function qd(O) {
        var j = O.r, O = O.l;
        return (j ? O ? Math.max(j.d, O.d) : j.d : O ? O.d : 0) + 1;
      }
      function fl(_, j) {
        return a(j).forEach(function(O) {
          _[O] ? wa(_[O], j[O]) : _[O] = (function L(F) {
            var W, ue, U = {};
            for (W in F) m(F, W) && (ue = F[W], U[W] = !ue || typeof ue != "object" || $.has(ue.constructor) ? ue : L(ue));
            return U;
          })(j[O]);
        }), _;
      }
      function Fd(_, j) {
        return _.all || j.all || Object.keys(_).some(function(O) {
          return j[O] && In(j[O], _[O]);
        });
      }
      x(Yn.prototype, ((li = { add: function(_) {
        return wa(this, _), this;
      }, addKey: function(_) {
        return Ka(this, _, _), this;
      }, addKeys: function(_) {
        var j = this;
        return _.forEach(function(O) {
          return Ka(j, O, O);
        }), this;
      }, hasKey: function(_) {
        var j = ms(this).next(_).value;
        return j && Vt(j.from, _) <= 0 && 0 <= Vt(j.to, _);
      } })[X] = function() {
        return ms(this);
      }, li));
      var So = {}, Ud = {}, xc = !1;
      function Eo(_) {
        fl(Ud, _), xc || (xc = !0, setTimeout(function() {
          xc = !1, Ya(Ud, !(Ud = {}));
        }, 0));
      }
      function Ya(_, j) {
        j === void 0 && (j = !1);
        var O = /* @__PURE__ */ new Set();
        if (_.all) for (var L = 0, F = Object.values(So); L < F.length; L++) Ih(ue = F[L], _, O, j);
        else for (var W in _) {
          var ue, U = /^idb\:\/\/(.*)\/(.*)\//.exec(W);
          U && (W = U[1], U = U[2], (ue = So["idb://".concat(W, "/").concat(U)]) && Ih(ue, _, O, j));
        }
        O.forEach(function(se) {
          return se();
        });
      }
      function Ih(_, j, O, L) {
        for (var F = [], W = 0, ue = Object.entries(_.queries.query); W < ue.length; W++) {
          for (var U = ue[W], se = U[0], ie = [], me = 0, he = U[1]; me < he.length; me++) {
            var _e = he[me];
            Fd(j, _e.obsSet) ? _e.subscribers.forEach(function(Te) {
              return O.add(Te);
            }) : L && ie.push(_e);
          }
          L && F.push([se, ie]);
        }
        if (L) for (var be = 0, we = F; be < we.length; be++) {
          var ke = we[be], se = ke[0], ie = ke[1];
          _.queries.query[se] = ie;
        }
      }
      function Lh(_) {
        var j = _._state, O = _._deps.indexedDB;
        if (j.isBeingOpened || _.idbdb) return j.dbReadyPromise.then(function() {
          return j.dbOpenError ? mn(j.dbOpenError) : _;
        });
        j.isBeingOpened = !0, j.dbOpenError = null, j.openComplete = !1;
        var L = j.openCanceller, F = Math.round(10 * _.verno), W = !1;
        function ue() {
          if (j.openCanceller !== L) throw new Re.DatabaseClosed("db.open() was cancelled");
        }
        function U() {
          return new st(function(_e, be) {
            if (ue(), !O) throw new Re.MissingAPI();
            var we = _.name, ke = j.autoSchema || !F ? O.open(we) : O.open(we, F);
            if (!ke) throw new Re.MissingAPI();
            ke.onerror = hs(be), ke.onblocked = Tn(_._fireOnBlocked), ke.onupgradeneeded = Tn(function(Te) {
              var Ae;
              me = ke.transaction, j.autoSchema && !_._options.allowEmptyDB ? (ke.onerror = bo, me.abort(), ke.result.close(), (Ae = O.deleteDatabase(we)).onsuccess = Ae.onerror = Tn(function() {
                be(new Re.NoSuchDatabase("Database ".concat(we, " doesnt exist")));
              })) : (me.onerror = hs(be), Te = Te.oldVersion > Math.pow(2, 62) ? 0 : Te.oldVersion, he = Te < 1, _.idbdb = ke.result, W && yu(_, me), ps(_, Te / 10, me, be));
            }, be), ke.onsuccess = Tn(function() {
              me = null;
              var Te, Ae, ze, qe, Ve, rt = _.idbdb = ke.result, ut = R(rt.objectStoreNames);
              if (0 < ut.length) try {
                var He = rt.transaction((qe = ut).length === 1 ? qe[0] : qe, "readonly");
                if (j.autoSchema) Ae = rt, ze = He, (Te = _).verno = Ae.version / 10, ze = Te._dbSchema = _o(0, Ae, ze), Te._storeNames = R(Ae.objectStoreNames, 0), mc(Te, [Te._allTables], a(ze), ze);
                else if (vu(_, _._dbSchema, He), ((Ve = dl(_o(0, (Ve = _).idbdb, He), Ve._dbSchema)).add.length || Ve.change.some(function(ot) {
                  return ot.add.length || ot.change.length;
                })) && !W) return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."), rt.close(), F = rt.version + 1, W = !0, _e(U());
                ba(_, He);
              } catch {
              }
              xa.push(_), rt.onversionchange = Tn(function(ot) {
                j.vcFired = !0, _.on("versionchange").fire(ot);
              }), rt.onclose = Tn(function() {
                _.close({ disableAutoOpen: !1 });
              }), he && (Ve = _._deps, He = we, rt = Ve.indexedDB, Ve = Ve.IDBKeyRange, ai(rt) || He === mo || Bd(rt, Ve).put({ name: He }).catch(Je)), _e();
            }, be);
          }).catch(function(_e) {
            switch (_e == null ? void 0 : _e.name) {
              case "UnknownError":
                if (0 < j.PR1398_maxLoop) return j.PR1398_maxLoop--, console.warn("Dexie: Workaround for Chrome UnknownError on open()"), U();
                break;
              case "VersionError":
                if (0 < F) return F = 0, U();
            }
            return st.reject(_e);
          });
        }
        var se, ie = j.dbReadyResolve, me = null, he = !1;
        return st.race([L, (typeof navigator > "u" ? st.resolve() : !navigator.userAgentData && /Safari\//.test(navigator.userAgent) && !/Chrom(e|ium)\//.test(navigator.userAgent) && indexedDB.databases ? new Promise(function(_e) {
          function be() {
            return indexedDB.databases().finally(_e);
          }
          se = setInterval(be, 100), be();
        }).finally(function() {
          return clearInterval(se);
        }) : Promise.resolve()).then(U)]).then(function() {
          return ue(), j.onReadyBeingFired = [], st.resolve($d(function() {
            return _.on.ready.fire(_.vip);
          })).then(function _e() {
            if (0 < j.onReadyBeingFired.length) {
              var be = j.onReadyBeingFired.reduce(pn, Je);
              return j.onReadyBeingFired = [], st.resolve($d(function() {
                return be(_.vip);
              })).then(_e);
            }
          });
        }).finally(function() {
          j.openCanceller === L && (j.onReadyBeingFired = null, j.isBeingOpened = !1);
        }).catch(function(_e) {
          j.dbOpenError = _e;
          try {
            me && me.abort();
          } catch {
          }
          return L === j.openCanceller && _._close(), mn(_e);
        }).finally(function() {
          j.openComplete = !0, ie();
        }).then(function() {
          var _e;
          return he && (_e = {}, _.tables.forEach(function(be) {
            be.schema.indexes.forEach(function(we) {
              we.name && (_e["idb://".concat(_.name, "/").concat(be.name, "/").concat(we.name)] = new Yn(-1 / 0, [[[]]]));
            }), _e["idb://".concat(_.name, "/").concat(be.name, "/")] = _e["idb://".concat(_.name, "/").concat(be.name, "/:dels")] = new Yn(-1 / 0, [[[]]]);
          }), Wr(ul).fire(_e), Ya(_e, !0)), _;
        });
      }
      function hl(_) {
        function j(W) {
          return _.next(W);
        }
        var O = F(j), L = F(function(W) {
          return _.throw(W);
        });
        function F(W) {
          return function(se) {
            var U = W(se), se = U.value;
            return U.done ? se : se && typeof se.then == "function" ? se.then(O, L) : u(se) ? Promise.all(se).then(O, L) : O(se);
          };
        }
        return F(j)();
      }
      function Ws(_, j, O) {
        for (var L = u(_) ? _.slice() : [_], F = 0; F < O; ++F) L.push(j);
        return L;
      }
      var Hd = { stack: "dbcore", name: "VirtualIndexMiddleware", level: 1, create: function(_) {
        return r(r({}, _), { table: function(j) {
          var O = _.table(j), L = O.schema, F = {}, W = [];
          function ue(he, _e, be) {
            var we = Rr(he), ke = F[we] = F[we] || [], Te = he == null ? 0 : typeof he == "string" ? 1 : he.length, Ae = 0 < _e, Ae = r(r({}, be), { name: Ae ? "".concat(we, "(virtual-from:").concat(be.name, ")") : be.name, lowLevelIndex: be, isVirtual: Ae, keyTail: _e, keyLength: Te, extractKey: cl(he), unique: !Ae && be.unique });
            return ke.push(Ae), Ae.isPrimaryKey || W.push(Ae), 1 < Te && ue(Te === 2 ? he[0] : he.slice(0, Te - 1), _e + 1, be), ke.sort(function(ze, qe) {
              return ze.keyTail - qe.keyTail;
            }), Ae;
          }
          j = ue(L.primaryKey.keyPath, 0, L.primaryKey), F[":id"] = [j];
          for (var U = 0, se = L.indexes; U < se.length; U++) {
            var ie = se[U];
            ue(ie.keyPath, 0, ie);
          }
          function me(he) {
            var _e, be = he.query.index;
            return be.isVirtual ? r(r({}, he), { query: { index: be.lowLevelIndex, range: (_e = he.query.range, be = be.keyTail, { type: _e.type === 1 ? 2 : _e.type, lower: Ws(_e.lower, _e.lowerOpen ? _.MAX_KEY : _.MIN_KEY, be), lowerOpen: !0, upper: Ws(_e.upper, _e.upperOpen ? _.MIN_KEY : _.MAX_KEY, be), upperOpen: !0 }) } }) : he;
          }
          return r(r({}, O), { schema: r(r({}, L), { primaryKey: j, indexes: W, getIndexByKeyPath: function(he) {
            return (he = F[Rr(he)]) && he[0];
          } }), count: function(he) {
            return O.count(me(he));
          }, query: function(he) {
            return O.query(me(he));
          }, openCursor: function(he) {
            var _e = he.query.index, be = _e.keyTail, we = _e.isVirtual, ke = _e.keyLength;
            return we ? O.openCursor(me(he)).then(function(Ae) {
              return Ae && Te(Ae);
            }) : O.openCursor(he);
            function Te(Ae) {
              return Object.create(Ae, { continue: { value: function(ze) {
                ze != null ? Ae.continue(Ws(ze, he.reverse ? _.MAX_KEY : _.MIN_KEY, be)) : he.unique ? Ae.continue(Ae.key.slice(0, ke).concat(he.reverse ? _.MIN_KEY : _.MAX_KEY, be)) : Ae.continue();
              } }, continuePrimaryKey: { value: function(ze, qe) {
                Ae.continuePrimaryKey(Ws(ze, _.MAX_KEY, be), qe);
              } }, primaryKey: { get: function() {
                return Ae.primaryKey;
              } }, key: { get: function() {
                var ze = Ae.key;
                return ke === 1 ? ze[0] : ze.slice(0, ke);
              } }, value: { get: function() {
                return Ae.value;
              } } });
            }
          } });
        } });
      } };
      function bu(_, j, O, L) {
        return O = O || {}, L = L || "", a(_).forEach(function(F) {
          var W, ue, U;
          m(j, F) ? (W = _[F], ue = j[F], typeof W == "object" && typeof ue == "object" && W && ue ? (U = oe(W)) !== oe(ue) ? O[L + F] = j[F] : U === "Object" ? bu(W, ue, O, L + F + ".") : W !== ue && (O[L + F] = j[F]) : W !== ue && (O[L + F] = j[F])) : O[L + F] = void 0;
        }), a(j).forEach(function(F) {
          m(_, F) || (O[L + F] = j[F]);
        }), O;
      }
      function vc(_, j) {
        return j.type === "delete" ? j.keys : j.keys || j.values.map(_.extractKey);
      }
      var bc = { stack: "dbcore", name: "HooksMiddleware", level: 2, create: function(_) {
        return r(r({}, _), { table: function(j) {
          var O = _.table(j), L = O.schema.primaryKey;
          return r(r({}, O), { mutate: function(F) {
            var W = nt.trans, ue = W.table(j).hook, U = ue.deleting, se = ue.creating, ie = ue.updating;
            switch (F.type) {
              case "add":
                if (se.fire === Je) break;
                return W._promise("readwrite", function() {
                  return me(F);
                }, !0);
              case "put":
                if (se.fire === Je && ie.fire === Je) break;
                return W._promise("readwrite", function() {
                  return me(F);
                }, !0);
              case "delete":
                if (U.fire === Je) break;
                return W._promise("readwrite", function() {
                  return me(F);
                }, !0);
              case "deleteRange":
                if (U.fire === Je) break;
                return W._promise("readwrite", function() {
                  return (function he(_e, be, we) {
                    return O.query({ trans: _e, values: !1, query: { index: L, range: be }, limit: we }).then(function(ke) {
                      var Te = ke.result;
                      return me({ type: "delete", keys: Te, trans: _e }).then(function(Ae) {
                        return 0 < Ae.numFailures ? Promise.reject(Ae.failures[0]) : Te.length < we ? { failures: [], numFailures: 0, lastResult: void 0 } : he(_e, r(r({}, be), { lower: Te[Te.length - 1], lowerOpen: !0 }), we);
                      });
                    });
                  })(F.trans, F.range, 1e4);
                }, !0);
            }
            return O.mutate(F);
            function me(he) {
              var _e, be, we, ke = nt.trans, Te = he.keys || vc(L, he);
              if (!Te) throw new Error("Keys missing");
              return (he = he.type === "add" || he.type === "put" ? r(r({}, he), { keys: Te }) : r({}, he)).type !== "delete" && (he.values = i([], he.values)), he.keys && (he.keys = i([], he.keys)), _e = O, we = Te, ((be = he).type === "add" ? Promise.resolve([]) : _e.getMany({ trans: be.trans, keys: we, cache: "immutable" })).then(function(Ae) {
                var ze = Te.map(function(qe, Ve) {
                  var rt, ut, He, ot = Ae[Ve], ct = { onerror: null, onsuccess: null };
                  return he.type === "delete" ? U.fire.call(ct, qe, ot, ke) : he.type === "add" || ot === void 0 ? (rt = se.fire.call(ct, qe, he.values[Ve], ke), qe == null && rt != null && (he.keys[Ve] = qe = rt, L.outbound || q(he.values[Ve], L.keyPath, qe))) : (rt = bu(ot, he.values[Ve]), (ut = ie.fire.call(ct, rt, qe, ot, ke)) && (He = he.values[Ve], Object.keys(ut).forEach(function(tt) {
                    m(He, tt) ? He[tt] = ut[tt] : q(He, tt, ut[tt]);
                  }))), ct;
                });
                return O.mutate(he).then(function(qe) {
                  for (var Ve = qe.failures, rt = qe.results, ut = qe.numFailures, qe = qe.lastResult, He = 0; He < Te.length; ++He) {
                    var ot = (rt || Te)[He], ct = ze[He];
                    ot == null ? ct.onerror && ct.onerror(Ve[He]) : ct.onsuccess && ct.onsuccess(he.type === "put" && Ae[He] ? he.values[He] : ot);
                  }
                  return { failures: Ve, results: rt, numFailures: ut, lastResult: qe };
                }).catch(function(qe) {
                  return ze.forEach(function(Ve) {
                    return Ve.onerror && Ve.onerror(qe);
                  }), Promise.reject(qe);
                });
              });
            }
          } });
        } });
      } };
      function wu(_, j, O) {
        try {
          if (!j || j.keys.length < _.length) return null;
          for (var L = [], F = 0, W = 0; F < j.keys.length && W < _.length; ++F) Vt(j.keys[F], _[W]) === 0 && (L.push(O ? le(j.values[F]) : j.values[F]), ++W);
          return L.length === _.length ? L : null;
        } catch {
          return null;
        }
      }
      var Bh = { stack: "dbcore", level: -1, create: function(_) {
        return { table: function(j) {
          var O = _.table(j);
          return r(r({}, O), { getMany: function(L) {
            if (!L.cache) return O.getMany(L);
            var F = wu(L.keys, L.trans._cache, L.cache === "clone");
            return F ? st.resolve(F) : O.getMany(L).then(function(W) {
              return L.trans._cache = { keys: L.keys, values: L.cache === "clone" ? le(W) : W }, W;
            });
          }, mutate: function(L) {
            return L.type !== "add" && (L.trans._cache = null), O.mutate(L);
          } });
        } };
      } };
      function Wa(_, j) {
        return _.trans.mode === "readonly" && !!_.subscr && !_.trans.explicit && _.trans.db._options.cache !== "disabled" && !j.schema.primaryKey.outbound;
      }
      function Ci(_, j) {
        switch (_) {
          case "query":
            return j.values && !j.unique;
          case "get":
          case "getMany":
          case "count":
          case "openCursor":
            return !1;
        }
      }
      var Vd = { stack: "dbcore", level: 0, name: "Observability", create: function(_) {
        var j = _.schema.name, O = new Yn(_.MIN_KEY, _.MAX_KEY);
        return r(r({}, _), { transaction: function(L, F, W) {
          if (nt.subscr && F !== "readonly") throw new Re.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(nt.querier));
          return _.transaction(L, F, W);
        }, table: function(L) {
          var F = _.table(L), W = F.schema, ue = W.primaryKey, he = W.indexes, U = ue.extractKey, se = ue.outbound, ie = ue.autoIncrement && he.filter(function(be) {
            return be.compound && be.keyPath.includes(ue.keyPath);
          }), me = r(r({}, F), { mutate: function(be) {
            function we(tt) {
              return tt = "idb://".concat(j, "/").concat(L, "/").concat(tt), qe[tt] || (qe[tt] = new Yn());
            }
            var ke, Te, Ae, ze = be.trans, qe = be.mutatedParts || (be.mutatedParts = {}), Ve = we(""), rt = we(":dels"), ut = be.type, ct = be.type === "deleteRange" ? [be.range] : be.type === "delete" ? [be.keys] : be.values.length < 50 ? [vc(ue, be).filter(function(tt) {
              return tt;
            }), be.values] : [], He = ct[0], ot = ct[1], ct = be.trans._cache;
            return u(He) ? (Ve.addKeys(He), (ct = ut === "delete" || He.length === ot.length ? wu(He, ct) : null) || rt.addKeys(He), (ct || ot) && (ke = we, Te = ct, Ae = ot, W.indexes.forEach(function(tt) {
              var vt = ke(tt.name || "");
              function Ct(qt) {
                return qt != null ? tt.extractKey(qt) : null;
              }
              function Lt(qt) {
                return tt.multiEntry && u(qt) ? qt.forEach(function(Zn) {
                  return vt.addKey(Zn);
                }) : vt.addKey(qt);
              }
              (Te || Ae).forEach(function(qt, Er) {
                var Rt = Te && Ct(Te[Er]), Er = Ae && Ct(Ae[Er]);
                Vt(Rt, Er) !== 0 && (Rt != null && Lt(Rt), Er != null && Lt(Er));
              });
            }))) : He ? (ot = { from: (ot = He.lower) !== null && ot !== void 0 ? ot : _.MIN_KEY, to: (ot = He.upper) !== null && ot !== void 0 ? ot : _.MAX_KEY }, rt.add(ot), Ve.add(ot)) : (Ve.add(O), rt.add(O), W.indexes.forEach(function(tt) {
              return we(tt.name).add(O);
            })), F.mutate(be).then(function(tt) {
              return !He || be.type !== "add" && be.type !== "put" || (Ve.addKeys(tt.results), ie && ie.forEach(function(vt) {
                for (var Ct = be.values.map(function(Rt) {
                  return vt.extractKey(Rt);
                }), Lt = vt.keyPath.findIndex(function(Rt) {
                  return Rt === ue.keyPath;
                }), qt = 0, Zn = tt.results.length; qt < Zn; ++qt) Ct[qt][Lt] = tt.results[qt];
                we(vt.name).addKeys(Ct);
              })), ze.mutatedParts = fl(ze.mutatedParts || {}, qe), tt;
            });
          } }), he = function(we) {
            var ke = we.query, we = ke.index, ke = ke.range;
            return [we, new Yn((we = ke.lower) !== null && we !== void 0 ? we : _.MIN_KEY, (ke = ke.upper) !== null && ke !== void 0 ? ke : _.MAX_KEY)];
          }, _e = { get: function(be) {
            return [ue, new Yn(be.key)];
          }, getMany: function(be) {
            return [ue, new Yn().addKeys(be.keys)];
          }, count: he, query: he, openCursor: he };
          return a(_e).forEach(function(be) {
            me[be] = function(we) {
              var ke = nt.subscr, Te = !!ke, Ae = Wa(nt, F) && Ci(be, we) ? we.obsSet = {} : ke;
              if (Te) {
                var ze = function(ot) {
                  return ot = "idb://".concat(j, "/").concat(L, "/").concat(ot), Ae[ot] || (Ae[ot] = new Yn());
                }, qe = ze(""), Ve = ze(":dels"), ke = _e[be](we), Te = ke[0], ke = ke[1];
                if ((be === "query" && Te.isPrimaryKey && !we.values ? Ve : ze(Te.name || "")).add(ke), !Te.isPrimaryKey) {
                  if (be !== "count") {
                    var rt = be === "query" && se && we.values && F.query(r(r({}, we), { values: !1 }));
                    return F[be].apply(this, arguments).then(function(ot) {
                      if (be === "query") {
                        if (se && we.values) return rt.then(function(Ct) {
                          return Ct = Ct.result, qe.addKeys(Ct), ot;
                        });
                        var ct = we.values ? ot.result.map(U) : ot.result;
                        (we.values ? qe : Ve).addKeys(ct);
                      } else if (be === "openCursor") {
                        var tt = ot, vt = we.values;
                        return tt && Object.create(tt, { key: { get: function() {
                          return Ve.addKey(tt.primaryKey), tt.key;
                        } }, primaryKey: { get: function() {
                          var Ct = tt.primaryKey;
                          return Ve.addKey(Ct), Ct;
                        } }, value: { get: function() {
                          return vt && qe.addKey(tt.primaryKey), tt.value;
                        } } });
                      }
                      return ot;
                    });
                  }
                  Ve.add(O);
                }
              }
              return F[be].apply(this, arguments);
            };
          }), me;
        } });
      } };
      function pl(_, j, O) {
        if (O.numFailures === 0) return j;
        if (j.type === "deleteRange") return null;
        var L = j.keys ? j.keys.length : "values" in j && j.values ? j.values.length : 1;
        return O.numFailures === L ? null : (j = r({}, j), u(j.keys) && (j.keys = j.keys.filter(function(F, W) {
          return !(W in O.failures);
        })), "values" in j && u(j.values) && (j.values = j.values.filter(function(F, W) {
          return !(W in O.failures);
        })), j);
      }
      function _u(_, j) {
        return O = _, ((L = j).lower === void 0 || (L.lowerOpen ? 0 < Vt(O, L.lower) : 0 <= Vt(O, L.lower))) && (_ = _, (j = j).upper === void 0 || (j.upperOpen ? Vt(_, j.upper) < 0 : Vt(_, j.upper) <= 0));
        var O, L;
      }
      function wc(_, j, _e, L, F, W) {
        if (!_e || _e.length === 0) return _;
        var ue = j.query.index, U = ue.multiEntry, se = j.query.range, ie = L.schema.primaryKey.extractKey, me = ue.extractKey, he = (ue.lowLevelIndex || ue).extractKey, _e = _e.reduce(function(be, we) {
          var ke = be, Te = [];
          if (we.type === "add" || we.type === "put") for (var Ae = new Yn(), ze = we.values.length - 1; 0 <= ze; --ze) {
            var qe, Ve = we.values[ze], rt = ie(Ve);
            Ae.hasKey(rt) || (qe = me(Ve), (U && u(qe) ? qe.some(function(tt) {
              return _u(tt, se);
            }) : _u(qe, se)) && (Ae.addKey(rt), Te.push(Ve)));
          }
          switch (we.type) {
            case "add":
              var ut = new Yn().addKeys(j.values ? be.map(function(vt) {
                return ie(vt);
              }) : be), ke = be.concat(j.values ? Te.filter(function(vt) {
                return vt = ie(vt), !ut.hasKey(vt) && (ut.addKey(vt), !0);
              }) : Te.map(function(vt) {
                return ie(vt);
              }).filter(function(vt) {
                return !ut.hasKey(vt) && (ut.addKey(vt), !0);
              }));
              break;
            case "put":
              var He = new Yn().addKeys(we.values.map(function(vt) {
                return ie(vt);
              }));
              ke = be.filter(function(vt) {
                return !He.hasKey(j.values ? ie(vt) : vt);
              }).concat(j.values ? Te : Te.map(function(vt) {
                return ie(vt);
              }));
              break;
            case "delete":
              var ot = new Yn().addKeys(we.keys);
              ke = be.filter(function(vt) {
                return !ot.hasKey(j.values ? ie(vt) : vt);
              });
              break;
            case "deleteRange":
              var ct = we.range;
              ke = be.filter(function(vt) {
                return !_u(ie(vt), ct);
              });
          }
          return ke;
        }, _);
        return _e === _ ? _ : (_e.sort(function(be, we) {
          return Vt(he(be), he(we)) || Vt(ie(be), ie(we));
        }), j.limit && j.limit < 1 / 0 && (_e.length > j.limit ? _e.length = j.limit : _.length === j.limit && _e.length < j.limit && (F.dirty = !0)), W ? Object.freeze(_e) : _e);
      }
      function ml(_, j) {
        return Vt(_.lower, j.lower) === 0 && Vt(_.upper, j.upper) === 0 && !!_.lowerOpen == !!j.lowerOpen && !!_.upperOpen == !!j.upperOpen;
      }
      function Su(_, j) {
        return (function(O, L, F, W) {
          if (O === void 0) return L !== void 0 ? -1 : 0;
          if (L === void 0) return 1;
          if ((L = Vt(O, L)) === 0) {
            if (F && W) return 0;
            if (F) return 1;
            if (W) return -1;
          }
          return L;
        })(_.lower, j.lower, _.lowerOpen, j.lowerOpen) <= 0 && 0 <= (function(O, L, F, W) {
          if (O === void 0) return L !== void 0 ? 1 : 0;
          if (L === void 0) return -1;
          if ((L = Vt(O, L)) === 0) {
            if (F && W) return 0;
            if (F) return -1;
            if (W) return 1;
          }
          return L;
        })(_.upper, j.upper, _.upperOpen, j.upperOpen);
      }
      function ig(_, j, O, L) {
        _.subscribers.add(O), L.addEventListener("abort", function() {
          var F, W;
          _.subscribers.delete(O), _.subscribers.size === 0 && (F = _, W = j, setTimeout(function() {
            F.subscribers.size === 0 && pe(W, F);
          }, 3e3));
        });
      }
      var _c = { stack: "dbcore", level: 0, name: "Cache", create: function(_) {
        var j = _.schema.name;
        return r(r({}, _), { transaction: function(O, L, F) {
          var W, ue, U = _.transaction(O, L, F);
          return L === "readwrite" && (ue = (W = new AbortController()).signal, F = function(se) {
            return function() {
              if (W.abort(), L === "readwrite") {
                for (var ie = /* @__PURE__ */ new Set(), me = 0, he = O; me < he.length; me++) {
                  var _e = he[me], be = So["idb://".concat(j, "/").concat(_e)];
                  if (be) {
                    var we = _.table(_e), ke = be.optimisticOps.filter(function(vt) {
                      return vt.trans === U;
                    });
                    if (U._explicit && se && U.mutatedParts) for (var Te = 0, Ae = Object.values(be.queries.query); Te < Ae.length; Te++) for (var ze = 0, qe = (ut = Ae[Te]).slice(); ze < qe.length; ze++) Fd((He = qe[ze]).obsSet, U.mutatedParts) && (pe(ut, He), He.subscribers.forEach(function(vt) {
                      return ie.add(vt);
                    }));
                    else if (0 < ke.length) {
                      be.optimisticOps = be.optimisticOps.filter(function(vt) {
                        return vt.trans !== U;
                      });
                      for (var Ve = 0, rt = Object.values(be.queries.query); Ve < rt.length; Ve++) for (var ut, He, ot, ct = 0, tt = (ut = rt[Ve]).slice(); ct < tt.length; ct++) (He = tt[ct]).res != null && U.mutatedParts && (se && !He.dirty ? (ot = Object.isFrozen(He.res), ot = wc(He.res, He.req, ke, we, He, ot), He.dirty ? (pe(ut, He), He.subscribers.forEach(function(vt) {
                        return ie.add(vt);
                      })) : ot !== He.res && (He.res = ot, He.promise = st.resolve({ result: ot }))) : (He.dirty && pe(ut, He), He.subscribers.forEach(function(vt) {
                        return ie.add(vt);
                      })));
                    }
                  }
                }
                ie.forEach(function(vt) {
                  return vt();
                });
              }
            };
          }, U.addEventListener("abort", F(!1), { signal: ue }), U.addEventListener("error", F(!1), { signal: ue }), U.addEventListener("complete", F(!0), { signal: ue })), U;
        }, table: function(O) {
          var L = _.table(O), F = L.schema.primaryKey;
          return r(r({}, L), { mutate: function(W) {
            var ue = nt.trans;
            if (F.outbound || ue.db._options.cache === "disabled" || ue.explicit || ue.idbtrans.mode !== "readwrite") return L.mutate(W);
            var U = So["idb://".concat(j, "/").concat(O)];
            return U ? (ue = L.mutate(W), W.type !== "add" && W.type !== "put" || !(50 <= W.values.length || vc(F, W).some(function(se) {
              return se == null;
            })) ? (U.optimisticOps.push(W), W.mutatedParts && Eo(W.mutatedParts), ue.then(function(se) {
              0 < se.numFailures && (pe(U.optimisticOps, W), (se = pl(0, W, se)) && U.optimisticOps.push(se), W.mutatedParts && Eo(W.mutatedParts));
            }), ue.catch(function() {
              pe(U.optimisticOps, W), W.mutatedParts && Eo(W.mutatedParts);
            })) : ue.then(function(se) {
              var ie = pl(0, r(r({}, W), { values: W.values.map(function(me, he) {
                var _e;
                return se.failures[he] ? me : (me = (_e = F.keyPath) !== null && _e !== void 0 && _e.includes(".") ? le(me) : r({}, me), q(me, F.keyPath, se.results[he]), me);
              }) }), se);
              U.optimisticOps.push(ie), queueMicrotask(function() {
                return W.mutatedParts && Eo(W.mutatedParts);
              });
            }), ue) : L.mutate(W);
          }, query: function(W) {
            if (!Wa(nt, L) || !Ci("query", W)) return L.query(W);
            var ue = ((ie = nt.trans) === null || ie === void 0 ? void 0 : ie.db._options.cache) === "immutable", he = nt, U = he.requery, se = he.signal, ie = (function(we, ke, Te, Ae) {
              var ze = So["idb://".concat(we, "/").concat(ke)];
              if (!ze) return [];
              if (!(ke = ze.queries[Te])) return [null, !1, ze, null];
              var qe = ke[(Ae.query ? Ae.query.index.name : null) || ""];
              if (!qe) return [null, !1, ze, null];
              switch (Te) {
                case "query":
                  var Ve = qe.find(function(rt) {
                    return rt.req.limit === Ae.limit && rt.req.values === Ae.values && ml(rt.req.query.range, Ae.query.range);
                  });
                  return Ve ? [Ve, !0, ze, qe] : [qe.find(function(rt) {
                    return ("limit" in rt.req ? rt.req.limit : 1 / 0) >= Ae.limit && (!Ae.values || rt.req.values) && Su(rt.req.query.range, Ae.query.range);
                  }), !1, ze, qe];
                case "count":
                  return Ve = qe.find(function(rt) {
                    return ml(rt.req.query.range, Ae.query.range);
                  }), [Ve, !!Ve, ze, qe];
              }
            })(j, O, "query", W), me = ie[0], he = ie[1], _e = ie[2], be = ie[3];
            return me && he ? me.obsSet = W.obsSet : (he = L.query(W).then(function(we) {
              var ke = we.result;
              if (me && (me.res = ke), ue) {
                for (var Te = 0, Ae = ke.length; Te < Ae; ++Te) Object.freeze(ke[Te]);
                Object.freeze(ke);
              } else we.result = le(ke);
              return we;
            }).catch(function(we) {
              return be && me && pe(be, me), Promise.reject(we);
            }), me = { obsSet: W.obsSet, promise: he, subscribers: /* @__PURE__ */ new Set(), type: "query", req: W, dirty: !1 }, be ? be.push(me) : (be = [me], (_e = _e || (So["idb://".concat(j, "/").concat(O)] = { queries: { query: {}, count: {} }, objs: /* @__PURE__ */ new Map(), optimisticOps: [], unsignaledParts: {} })).queries.query[W.query.index.name || ""] = be)), ig(me, be, U, se), me.promise.then(function(we) {
              return { result: wc(we.result, W, _e == null ? void 0 : _e.optimisticOps, L, me, ue) };
            });
          } });
        } });
      } };
      function Eu(_, j) {
        return new Proxy(_, { get: function(O, L, F) {
          return L === "db" ? j : Reflect.get(O, L, F);
        } });
      }
      var oi = (Wn.prototype.version = function(_) {
        if (isNaN(_) || _ < 0.1) throw new Re.Type("Given version is not a positive number");
        if (_ = Math.round(10 * _) / 10, this.idbdb || this._state.isBeingOpened) throw new Re.Schema("Cannot add version when database is open");
        this.verno = Math.max(this.verno, _);
        var j = this._versions, O = j.filter(function(L) {
          return L._cfg.version === _;
        })[0];
        return O || (O = new this.Version(_), j.push(O), j.sort(gu), O.stores({}), this._state.autoSchema = !1, O);
      }, Wn.prototype._whenReady = function(_) {
        var j = this;
        return this.idbdb && (this._state.openComplete || nt.letThrough || this._vip) ? _() : new st(function(O, L) {
          if (j._state.openComplete) return L(new Re.DatabaseClosed(j._state.dbOpenError));
          if (!j._state.isBeingOpened) {
            if (!j._state.autoOpen) return void L(new Re.DatabaseClosed());
            j.open().catch(Je);
          }
          j._state.dbReadyPromise.then(O, L);
        }).then(_);
      }, Wn.prototype.use = function(_) {
        var j = _.stack, O = _.create, L = _.level, F = _.name;
        return F && this.unuse({ stack: j, name: F }), _ = this._middlewares[j] || (this._middlewares[j] = []), _.push({ stack: j, create: O, level: L ?? 10, name: F }), _.sort(function(W, ue) {
          return W.level - ue.level;
        }), this;
      }, Wn.prototype.unuse = function(_) {
        var j = _.stack, O = _.name, L = _.create;
        return j && this._middlewares[j] && (this._middlewares[j] = this._middlewares[j].filter(function(F) {
          return L ? F.create !== L : !!O && F.name !== O;
        })), this;
      }, Wn.prototype.open = function() {
        var _ = this;
        return Ni(fn, function() {
          return Lh(_);
        });
      }, Wn.prototype._close = function() {
        this.on.close.fire(new CustomEvent("close"));
        var _ = this._state, j = xa.indexOf(this);
        if (0 <= j && xa.splice(j, 1), this.idbdb) {
          try {
            this.idbdb.close();
          } catch {
          }
          this.idbdb = null;
        }
        _.isBeingOpened || (_.dbReadyPromise = new st(function(O) {
          _.dbReadyResolve = O;
        }), _.openCanceller = new st(function(O, L) {
          _.cancelOpen = L;
        }));
      }, Wn.prototype.close = function(O) {
        var j = (O === void 0 ? { disableAutoOpen: !0 } : O).disableAutoOpen, O = this._state;
        j ? (O.isBeingOpened && O.cancelOpen(new Re.DatabaseClosed()), this._close(), O.autoOpen = !1, O.dbOpenError = new Re.DatabaseClosed()) : (this._close(), O.autoOpen = this._options.autoOpen || O.isBeingOpened, O.openComplete = !1, O.dbOpenError = null);
      }, Wn.prototype.delete = function(_) {
        var j = this;
        _ === void 0 && (_ = { disableAutoOpen: !0 });
        var O = 0 < arguments.length && typeof arguments[0] != "object", L = this._state;
        return new st(function(F, W) {
          function ue() {
            j.close(_);
            var U = j._deps.indexedDB.deleteDatabase(j.name);
            U.onsuccess = Tn(function() {
              var se, ie, me;
              se = j._deps, ie = j.name, me = se.indexedDB, se = se.IDBKeyRange, ai(me) || ie === mo || Bd(me, se).delete(ie).catch(Je), F();
            }), U.onerror = hs(W), U.onblocked = j._fireOnBlocked;
          }
          if (O) throw new Re.InvalidArgument("Invalid closeOptions argument to db.delete()");
          L.isBeingOpened ? L.dbReadyPromise.then(ue) : ue();
        });
      }, Wn.prototype.backendDB = function() {
        return this.idbdb;
      }, Wn.prototype.isOpen = function() {
        return this.idbdb !== null;
      }, Wn.prototype.hasBeenClosed = function() {
        var _ = this._state.dbOpenError;
        return _ && _.name === "DatabaseClosed";
      }, Wn.prototype.hasFailed = function() {
        return this._state.dbOpenError !== null;
      }, Wn.prototype.dynamicallyOpened = function() {
        return this._state.autoSchema;
      }, Object.defineProperty(Wn.prototype, "tables", { get: function() {
        var _ = this;
        return a(this._allTables).map(function(j) {
          return _._allTables[j];
        });
      }, enumerable: !1, configurable: !0 }), Wn.prototype.transaction = function() {
        var _ = (function(j, O, L) {
          var F = arguments.length;
          if (F < 2) throw new Re.InvalidArgument("Too few arguments");
          for (var W = new Array(F - 1); --F; ) W[F - 1] = arguments[F];
          return L = W.pop(), [j, V(W), L];
        }).apply(this, arguments);
        return this._transaction.apply(this, _);
      }, Wn.prototype._transaction = function(_, j, O) {
        var L = this, F = nt.trans;
        F && F.db === this && _.indexOf("!") === -1 || (F = null);
        var W, ue, U = _.indexOf("?") !== -1;
        _ = _.replace("!", "").replace("?", "");
        try {
          if (ue = j.map(function(ie) {
            if (ie = ie instanceof L.Table ? ie.name : ie, typeof ie != "string") throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");
            return ie;
          }), _ == "r" || _ === Hi) W = Hi;
          else {
            if (_ != "rw" && _ != fs) throw new Re.InvalidArgument("Invalid transaction mode: " + _);
            W = fs;
          }
          if (F) {
            if (F.mode === Hi && W === fs) {
              if (!U) throw new Re.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");
              F = null;
            }
            F && ue.forEach(function(ie) {
              if (F && F.storeNames.indexOf(ie) === -1) {
                if (!U) throw new Re.SubTransaction("Table " + ie + " not included in parent transaction.");
                F = null;
              }
            }), U && F && !F.active && (F = null);
          }
        } catch (ie) {
          return F ? F._promise(null, function(me, he) {
            he(ie);
          }) : mn(ie);
        }
        var se = (function ie(me, he, _e, be, we) {
          return st.resolve().then(function() {
            var ke = nt.transless || nt, Te = me._createTransaction(he, _e, me._dbSchema, be);
            if (Te.explicit = !0, ke = { trans: Te, transless: ke }, be) Te.idbtrans = be.idbtrans;
            else try {
              Te.create(), Te.idbtrans._explicit = !0, me._state.PR1398_maxLoop = 3;
            } catch (qe) {
              return qe.name === Me.InvalidState && me.isOpen() && 0 < --me._state.PR1398_maxLoop ? (console.warn("Dexie: Need to reopen db"), me.close({ disableAutoOpen: !1 }), me.open().then(function() {
                return ie(me, he, _e, null, we);
              })) : mn(qe);
            }
            var Ae, ze = J(we);
            return ze && ar(), ke = st.follow(function() {
              var qe;
              (Ae = we.call(Te, Te)) && (ze ? (qe = Yr.bind(null, null), Ae.then(qe, qe)) : typeof Ae.next == "function" && typeof Ae.throw == "function" && (Ae = hl(Ae)));
            }, ke), (Ae && typeof Ae.then == "function" ? st.resolve(Ae).then(function(qe) {
              return Te.active ? qe : mn(new Re.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"));
            }) : ke.then(function() {
              return Ae;
            })).then(function(qe) {
              return be && Te._resolve(), Te._completion.then(function() {
                return qe;
              });
            }).catch(function(qe) {
              return Te._reject(qe), mn(qe);
            });
          });
        }).bind(null, this, W, ue, F, O);
        return F ? F._promise(W, se, "lock") : nt.trans ? Ni(nt.transless, function() {
          return L._whenReady(se);
        }) : this._whenReady(se);
      }, Wn.prototype.table = function(_) {
        if (!m(this._allTables, _)) throw new Re.InvalidTable("Table ".concat(_, " does not exist"));
        return this._allTables[_];
      }, Wn);
      function Wn(_, j) {
        var O = this;
        this._middlewares = {}, this.verno = 0;
        var L = Wn.dependencies;
        this._options = j = r({ addons: Wn.addons, autoOpen: !0, indexedDB: L.indexedDB, IDBKeyRange: L.IDBKeyRange, cache: "cloned" }, j), this._deps = { indexedDB: j.indexedDB, IDBKeyRange: j.IDBKeyRange }, L = j.addons, this._dbSchema = {}, this._versions = [], this._storeNames = [], this._allTables = {}, this.idbdb = null, this._novip = this;
        var F, W, ue, U, se, ie = { dbOpenError: null, isBeingOpened: !1, onReadyBeingFired: null, openComplete: !1, dbReadyResolve: Je, dbReadyPromise: null, cancelOpen: Je, openCanceller: null, autoSchema: !0, PR1398_maxLoop: 3, autoOpen: j.autoOpen };
        ie.dbReadyPromise = new st(function(he) {
          ie.dbReadyResolve = he;
        }), ie.openCanceller = new st(function(he, _e) {
          ie.cancelOpen = _e;
        }), this._state = ie, this.name = _, this.on = yo(this, "populate", "blocked", "versionchange", "close", { ready: [pn, Je] }), this.once = function(he, _e) {
          var be = function() {
            for (var we = [], ke = 0; ke < arguments.length; ke++) we[ke] = arguments[ke];
            O.on(he).unsubscribe(be), _e.apply(O, we);
          };
          return O.on(he, be);
        }, this.on.ready.subscribe = N(this.on.ready.subscribe, function(he) {
          return function(_e, be) {
            Wn.vip(function() {
              var we, ke = O._state;
              ke.openComplete ? (ke.dbOpenError || st.resolve().then(_e), be && he(_e)) : ke.onReadyBeingFired ? (ke.onReadyBeingFired.push(_e), be && he(_e)) : (he(_e), we = O, be || he(function Te() {
                we.on.ready.unsubscribe(_e), we.on.ready.unsubscribe(Te);
              }));
            });
          };
        }), this.Collection = (F = this, Sr(Oh.prototype, function(Ae, Te) {
          this.db = F;
          var be = ll, we = null;
          if (Te) try {
            be = Te();
          } catch (ze) {
            we = ze;
          }
          var ke = Ae._ctx, Te = ke.table, Ae = Te.hook.reading.fire;
          this._ctx = { table: Te, index: ke.index, isPrimKey: !ke.index || Te.schema.primKey.keyPath && ke.index === Te.schema.primKey.name, range: be, keysOnly: !1, dir: "next", unique: "", algorithm: null, filter: null, replayFilter: null, justLimit: !0, isMatch: null, offset: 0, limit: 1 / 0, error: we, or: ke.or, valueMapper: Ae !== ft ? Ae : null };
        })), this.Table = (W = this, Sr(Ha.prototype, function(he, _e, be) {
          this.db = W, this._tx = be, this.name = he, this.schema = _e, this.hook = W._allTables[he] ? W._allTables[he].hook : yo(null, { creating: [Le, Je], reading: [yt, ft], updating: [gt, Je], deleting: [Ye, Je] });
        })), this.Transaction = (ue = this, Sr(Pd.prototype, function(he, _e, be, we, ke) {
          var Te = this;
          he !== "readonly" && _e.forEach(function(Ae) {
            Ae = (Ae = be[Ae]) === null || Ae === void 0 ? void 0 : Ae.yProps, Ae && (_e = _e.concat(Ae.map(function(ze) {
              return ze.updatesTable;
            })));
          }), this.db = ue, this.mode = he, this.storeNames = _e, this.schema = be, this.chromeTransactionDurability = we, this.idbtrans = null, this.on = yo(this, "complete", "error", "abort"), this.parent = ke || null, this.active = !0, this._reculock = 0, this._blockedFuncs = [], this._resolve = null, this._reject = null, this._waitingFor = null, this._waitingQueue = null, this._spinCount = 0, this._completion = new st(function(Ae, ze) {
            Te._resolve = Ae, Te._reject = ze;
          }), this._completion.then(function() {
            Te.active = !1, Te.on.complete.fire();
          }, function(Ae) {
            var ze = Te.active;
            return Te.active = !1, Te.on.error.fire(Ae), Te.parent ? Te.parent._reject(Ae) : ze && Te.idbtrans && Te.idbtrans.abort(), mn(Ae);
          });
        })), this.Version = (U = this, Sr(Ph.prototype, function(he) {
          this.db = U, this._cfg = { version: he, storesSource: null, dbschema: {}, tables: {}, contentUpgrade: null };
        })), this.WhereClause = (se = this, Sr(Ga.prototype, function(he, _e, be) {
          if (this.db = se, this._ctx = { table: he, index: _e === ":id" ? null : _e, or: be }, this._cmp = this._ascending = Vt, this._descending = function(we, ke) {
            return Vt(ke, we);
          }, this._max = function(we, ke) {
            return 0 < Vt(we, ke) ? we : ke;
          }, this._min = function(we, ke) {
            return Vt(we, ke) < 0 ? we : ke;
          }, this._IDBKeyRange = se._deps.IDBKeyRange, !this._IDBKeyRange) throw new Re.MissingAPI();
        })), this.on("versionchange", function(he) {
          0 < he.newVersion ? console.warn("Another connection wants to upgrade database '".concat(O.name, "'. Closing db now to resume the upgrade.")) : console.warn("Another connection wants to delete database '".concat(O.name, "'. Closing db now to resume the delete request.")), O.close({ disableAutoOpen: !1 });
        }), this.on("blocked", function(he) {
          !he.newVersion || he.newVersion < he.oldVersion ? console.warn("Dexie.delete('".concat(O.name, "') was blocked")) : console.warn("Upgrade '".concat(O.name, "' blocked by other connection holding version ").concat(he.oldVersion / 10));
        }), this._maxKey = gn(j.IDBKeyRange), this._createTransaction = function(he, _e, be, we) {
          return new O.Transaction(he, _e, be, O._options.chromeTransactionDurability, we);
        }, this._fireOnBlocked = function(he) {
          O.on("blocked").fire(he), xa.filter(function(_e) {
            return _e.name === O.name && _e !== O && !_e._state.vcFired;
          }).map(function(_e) {
            return _e.on("versionchange").fire(he);
          });
        }, this.use(Bh), this.use(_c), this.use(Vd), this.use(Hd), this.use(bc);
        var me = new Proxy(this, { get: function(he, _e, be) {
          if (_e === "_vip") return !0;
          if (_e === "table") return function(ke) {
            return Eu(O.table(ke), me);
          };
          var we = Reflect.get(he, _e, be);
          return we instanceof Ha ? Eu(we, me) : _e === "tables" ? we.map(function(ke) {
            return Eu(ke, me);
          }) : _e === "_createTransaction" ? function() {
            return Eu(we.apply(this, arguments), me);
          } : we;
        } });
        this.vip = me, L.forEach(function(he) {
          return he(O);
        });
      }
      var gl, li = typeof Symbol < "u" && "observable" in Symbol ? Symbol.observable : "@@observable", Gd = (gs.prototype.subscribe = function(_, j, O) {
        return this._subscribe(_ && typeof _ != "function" ? _ : { next: _, error: j, complete: O });
      }, gs.prototype[li] = function() {
        return this;
      }, gs);
      function gs(_) {
        this._subscribe = _;
      }
      try {
        gl = { indexedDB: s.indexedDB || s.mozIndexedDB || s.webkitIndexedDB || s.msIndexedDB, IDBKeyRange: s.IDBKeyRange || s.webkitIDBKeyRange };
      } catch {
        gl = { indexedDB: null, IDBKeyRange: null };
      }
      function Cu(_) {
        var j, O = !1, L = new Gd(function(F) {
          var W = J(_), ue, U = !1, se = {}, ie = {}, me = { get closed() {
            return U;
          }, unsubscribe: function() {
            U || (U = !0, ue && ue.abort(), he && Wr.storagemutated.unsubscribe(be));
          } };
          F.start && F.start(me);
          var he = !1, _e = function() {
            return Fs(we);
          }, be = function(ke) {
            fl(se, ke), Fd(ie, se) && _e();
          }, we = function() {
            var ke, Te, Ae;
            !U && gl.indexedDB && (se = {}, ke = {}, ue && ue.abort(), ue = new AbortController(), Ae = (function(ze) {
              var qe = Ls();
              try {
                W && ar();
                var Ve = Rn(_, ze);
                return Ve = W ? Ve.finally(Yr) : Ve;
              } finally {
                qe && Ui();
              }
            })(Te = { subscr: ke, signal: ue.signal, requery: _e, querier: _, trans: null }), Promise.resolve(Ae).then(function(ze) {
              O = !0, j = ze, U || Te.signal.aborted || (se = {}, (function(qe) {
                for (var Ve in qe) if (m(qe, Ve)) return;
                return 1;
              })(ie = ke) || he || (Wr(ul, be), he = !0), Fs(function() {
                return !U && F.next && F.next(ze);
              }));
            }, function(ze) {
              O = !1, ["DatabaseClosedError", "AbortError"].includes(ze == null ? void 0 : ze.name) || U || Fs(function() {
                U || F.error && F.error(ze);
              });
            }));
          };
          return setTimeout(_e, 0), me;
        });
        return L.hasValue = function() {
          return O;
        }, L.getValue = function() {
          return j;
        }, L;
      }
      var Co = oi;
      function Kd(_) {
        var j = Di;
        try {
          Di = !0, Wr.storagemutated.fire(_), Ya(_, !0);
        } finally {
          Di = j;
        }
      }
      x(Co, r(r({}, dt), { delete: function(_) {
        return new Co(_, { addons: [] }).delete();
      }, exists: function(_) {
        return new Co(_, { addons: [] }).open().then(function(j) {
          return j.close(), !0;
        }).catch("NoSuchDatabaseError", function() {
          return !1;
        });
      }, getDatabaseNames: function(_) {
        try {
          return j = Co.dependencies, O = j.indexedDB, j = j.IDBKeyRange, (ai(O) ? Promise.resolve(O.databases()).then(function(L) {
            return L.map(function(F) {
              return F.name;
            }).filter(function(F) {
              return F !== mo;
            });
          }) : Bd(O, j).toCollection().primaryKeys()).then(_);
        } catch {
          return mn(new Re.MissingAPI());
        }
        var j, O;
      }, defineClass: function() {
        return function(_) {
          d(this, _);
        };
      }, ignoreTransaction: function(_) {
        return nt.trans ? Ni(nt.transless, _) : _();
      }, vip: $d, async: function(_) {
        return function() {
          try {
            var j = hl(_.apply(this, arguments));
            return j && typeof j.then == "function" ? j : st.resolve(j);
          } catch (O) {
            return mn(O);
          }
        };
      }, spawn: function(_, j, O) {
        try {
          var L = hl(_.apply(O, j || []));
          return L && typeof L.then == "function" ? L : st.resolve(L);
        } catch (F) {
          return mn(F);
        }
      }, currentTransaction: { get: function() {
        return nt.trans || null;
      } }, waitFor: function(_, j) {
        return j = st.resolve(typeof _ == "function" ? Co.ignoreTransaction(_) : _).timeout(j || 6e4), nt.trans ? nt.trans.waitFor(j) : j;
      }, Promise: st, debug: { get: function() {
        return Ht;
      }, set: function(_) {
        zn(_);
      } }, derive: S, extend: d, props: x, override: N, Events: yo, on: Wr, liveQuery: Cu, extendObservabilitySet: fl, getByKeyPath: D, setByKeyPath: q, delByKeyPath: function(_, j) {
        typeof j == "string" ? q(_, j, void 0) : "length" in j && [].map.call(j, function(O) {
          q(_, O, void 0);
        });
      }, shallowClone: Y, deepClone: le, getObjectDiff: bu, cmp: Vt, asap: P, minKey: -1 / 0, addons: [], connections: xa, errnames: Me, dependencies: gl, cache: So, semVer: "4.2.1", version: "4.2.1".split(".").map(function(_) {
        return parseInt(_);
      }).reduce(function(_, j, O) {
        return _ + j / Math.pow(10, 2 * O);
      }) })), Co.maxKey = gn(Co.dependencies.IDBKeyRange), typeof dispatchEvent < "u" && typeof addEventListener < "u" && (Wr(ul, function(_) {
        Di || (_ = new CustomEvent(va, { detail: _ }), Di = !0, dispatchEvent(_), Di = !1);
      }), addEventListener(va, function(_) {
        _ = _.detail, Di || Kd(_);
      }));
      var yl, Di = !1, Vn = function() {
      };
      return typeof BroadcastChannel < "u" && ((Vn = function() {
        (yl = new BroadcastChannel(va)).onmessage = function(_) {
          return _.data && Kd(_.data);
        };
      })(), typeof yl.unref == "function" && yl.unref(), Wr(ul, function(_) {
        Di || yl.postMessage(_);
      })), typeof addEventListener < "u" && (addEventListener("pagehide", function(_) {
        if (!oi.disableBfCache && _.persisted) {
          Ht && console.debug("Dexie: handling persisted pagehide"), yl != null && yl.close();
          for (var j = 0, O = xa; j < O.length; j++) O[j].close({ disableAutoOpen: !1 });
        }
      }), addEventListener("pageshow", function(_) {
        !oi.disableBfCache && _.persisted && (Ht && console.debug("Dexie: handling persisted pageshow"), Vn(), Kd({ all: new Yn(-1 / 0, [[]]) }));
      })), st.rejectionMapper = function(_, j) {
        return !_ || _ instanceof Q || _ instanceof TypeError || _ instanceof SyntaxError || !_.name || !mt[_.name] ? _ : (j = new mt[_.name](j || _.message, _), "stack" in _ && w(j, "stack", { get: function() {
          return this.inner.stack;
        } }), j);
      }, zn(Ht), r(oi, Object.freeze({ __proto__: null, Dexie: oi, liveQuery: Cu, Entity: uc, cmp: Vt, PropModification: Hs, replacePrefix: function(_, j) {
        return new Hs({ replacePrefix: [_, j] });
      }, add: function(_) {
        return new Hs({ add: _ });
      }, remove: function(_) {
        return new Hs({ remove: _ });
      }, default: oi, RangeSet: Yn, mergeRanges: wa, rangesOverlap: In }), { default: oi }), oi;
    });
  })(I1)), I1.exports;
}
var DW = /* @__PURE__ */ OW();
const E3 = /* @__PURE__ */ jd(DW), JA = Symbol.for("Dexie"), Ey = globalThis[JA] || (globalThis[JA] = E3);
if (E3.semVer !== Ey.semVer)
  throw new Error(`Two different versions of Dexie loaded in the same app: ${E3.semVer} and ${Ey.semVer}`);
var Q0 = { exports: {} };
/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */
var zW = Q0.exports, eN;
function PW() {
  return eN || (eN = 1, (function(e, t) {
    (function() {
      var n, r = "4.17.21", i = 200, s = "Unsupported core-js use. Try https://npms.io/search?q=ponyfill.", a = "Expected a function", u = "Invalid `variable` option passed into `_.template`", d = "__lodash_hash_undefined__", f = 500, h = "__lodash_placeholder__", m = 1, x = 2, b = 4, w = 1, S = 2, C = 1, T = 2, R = 4, N = 8, M = 16, P = 32, D = 64, q = 128, Y = 256, te = 512, V = 30, $ = "...", G = 800, le = 16, Z = 1, oe = 2, X = 3, ce = 1 / 0, pe = 9007199254740991, de = 17976931348623157e292, H = NaN, J = 4294967295, ge = J - 1, Q = J >>> 1, fe = [
        ["ary", q],
        ["bind", C],
        ["bindKey", T],
        ["curry", N],
        ["curryRight", M],
        ["flip", te],
        ["partial", P],
        ["partialRight", D],
        ["rearg", Y]
      ], ve = "[object Arguments]", Se = "[object Array]", Me = "[object AsyncFunction]", Ie = "[object Boolean]", Re = "[object Date]", mt = "[object DOMException]", dt = "[object Error]", Je = "[object Function]", ft = "[object GeneratorFunction]", yt = "[object Map]", ht = "[object Number]", Le = "[object Null]", Ye = "[object Object]", gt = "[object Promise]", Dt = "[object Proxy]", pn = "[object RegExp]", Ht = "[object Set]", zn = "[object String]", nn = "[object Symbol]", kn = "[object Undefined]", Nn = "[object WeakMap]", $e = "[object WeakSet]", Qe = "[object ArrayBuffer]", bt = "[object DataView]", jt = "[object Float32Array]", $t = "[object Float64Array]", Un = "[object Int8Array]", Hn = "[object Int16Array]", on = "[object Int32Array]", Jt = "[object Uint8Array]", fn = "[object Uint8ClampedArray]", nt = "[object Uint16Array]", er = "[object Uint32Array]", Pn = /\b__p \+= '';/g, sr = /\b(__p \+=) '' \+/g, st = /(__e\(.*?\)|\b__t\)) \+\n'';/g, $r = /&(?:amp|lt|gt|quot|#39);/g, Is = /[&<>"']/g, bi = RegExp($r.source), At = RegExp(Is.source), tr = /<%-([\s\S]+?)%>/g, Dd = /<%([\s\S]+?)%>/g, cu = /<%=([\s\S]+?)%>/g, Ls = /\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/, Ui = /^\w*$/, du = /[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g, ya = /[\\^$.*+?()[\]{}|]/g, Tn = RegExp(ya.source), Gn = /^\s+/, fu = /\s/, Fa = /\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/, ho = /\{\n\/\* \[wrapped with (.+)\] \*/, po = /,? & /, Bs = /[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g, Rn = /[()=,{}\[\]\/\s]/, ar = /\\(\\)?/g, Yr = /\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g, $s = /\w*$/, lc = /^[-+]0x[0-9a-f]+$/i, qs = /^0b[01]+$/i, hu = /^\[object .+?Constructor\]$/, Ni = /^0o[0-7]+$/i, ol = /^(?:0|[1-9]\d*)$/, Fs = /[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g, mn = /($^)/, wi = /['\n\r\u2028\u2029\\]/g, _r = "\\ud800-\\udfff", or = "\\u0300-\\u036f", xa = "\\ufe20-\\ufe2f", mo = "\\u20d0-\\u20ff", Hi = or + xa + mo, fs = "\\u2700-\\u27bf", Us = "a-z\\xdf-\\xf6\\xf8-\\xff", ll = "\\xac\\xb1\\xd7\\xf7", go = "\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf", uc = "\\u2000-\\u206f", Vt = " \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000", Ua = "A-Z\\xc0-\\xd6\\xd8-\\xde", Ri = "\\ufe0e\\ufe0f", Nr = ll + go + uc + Vt, Hs = "[']", cc = "[" + _r + "]", Vs = "[" + Nr + "]", Ha = "[" + Hi + "]", ln = "\\d+", yo = "[" + fs + "]", Sr = "[" + Us + "]", Mi = "[^" + _r + Nr + ln + fs + Us + Ua + "]", Va = "\\ud83c[\\udffb-\\udfff]", xo = "(?:" + Ha + "|" + Va + ")", Oi = "[^" + _r + "]", pu = "(?:\\ud83c[\\udde6-\\uddff]){2}", vo = "[\\ud800-\\udbff][\\udc00-\\udfff]", Vi = "[" + Ua + "]", Oh = "\\u200d", rn = "(?:" + Sr + "|" + Mi + ")", zd = "(?:" + Vi + "|" + Mi + ")", dc = "(?:" + Hs + "(?:d|ll|m|re|s|t|ve))?", Dh = "(?:" + Hs + "(?:D|LL|M|RE|S|T|VE))?", _i = xo + "?", Gs = "[" + Ri + "]?", Gi = "(?:" + Oh + "(?:" + [Oi, pu, vo].join("|") + ")" + Gs + _i + ")*", Ks = "\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])", fc = "\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])", Ga = Gs + _i + Gi, Kn = "(?:" + [yo, pu, vo].join("|") + ")" + Ga, hs = "(?:" + [Oi + Ha + "?", Ha, pu, vo, cc].join("|") + ")", bo = RegExp(Hs, "g"), ul = RegExp(Ha, "g"), va = RegExp(Va + "(?=" + Va + ")|" + hs + Ga, "g"), Wr = RegExp([
        Vi + "?" + Sr + "+" + dc + "(?=" + [Vs, Vi, "$"].join("|") + ")",
        zd + "+" + Dh + "(?=" + [Vs, Vi + rn, "$"].join("|") + ")",
        Vi + "?" + rn + "+" + dc,
        Vi + "+" + Dh,
        fc,
        Ks,
        ln,
        Kn
      ].join("|"), "g"), Pd = RegExp("[" + Oh + _r + Hi + Ri + "]"), Si = /[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/, Ys = [
        "Array",
        "Buffer",
        "DataView",
        "Date",
        "Error",
        "Float32Array",
        "Float64Array",
        "Function",
        "Int8Array",
        "Int16Array",
        "Int32Array",
        "Map",
        "Math",
        "Object",
        "Promise",
        "RegExp",
        "Set",
        "String",
        "Symbol",
        "TypeError",
        "Uint8Array",
        "Uint8ClampedArray",
        "Uint16Array",
        "Uint32Array",
        "WeakMap",
        "_",
        "clearTimeout",
        "isFinite",
        "parseInt",
        "setTimeout"
      ], hc = -1, vn = {};
      vn[jt] = vn[$t] = vn[Un] = vn[Hn] = vn[on] = vn[Jt] = vn[fn] = vn[nt] = vn[er] = !0, vn[ve] = vn[Se] = vn[Qe] = vn[Ie] = vn[bt] = vn[Re] = vn[dt] = vn[Je] = vn[yt] = vn[ht] = vn[Ye] = vn[pn] = vn[Ht] = vn[zn] = vn[Nn] = !1;
      var gn = {};
      gn[ve] = gn[Se] = gn[Qe] = gn[bt] = gn[Ie] = gn[Re] = gn[jt] = gn[$t] = gn[Un] = gn[Hn] = gn[on] = gn[yt] = gn[ht] = gn[Ye] = gn[pn] = gn[Ht] = gn[zn] = gn[nn] = gn[Jt] = gn[fn] = gn[nt] = gn[er] = !0, gn[dt] = gn[Je] = gn[Nn] = !1;
      var cl = {
        // Latin-1 Supplement block.
        : "A",
        : "A",
        : "A",
        : "A",
        : "A",
        : "A",
        : "a",
        : "a",
        : "a",
        : "a",
        : "a",
        : "a",
        : "C",
        : "c",
        : "D",
        : "d",
        : "E",
        : "E",
        : "E",
        : "E",
        : "e",
        : "e",
        : "e",
        : "e",
        : "I",
        : "I",
        : "I",
        : "I",
        : "i",
        : "i",
        : "i",
        : "i",
        : "N",
        : "n",
        : "O",
        : "O",
        : "O",
        : "O",
        : "O",
        : "O",
        : "o",
        : "o",
        : "o",
        : "o",
        : "o",
        : "o",
        : "U",
        : "U",
        : "U",
        : "U",
        : "u",
        : "u",
        : "u",
        : "u",
        : "Y",
        : "y",
        : "y",
        : "Ae",
        : "ae",
        : "Th",
        : "th",
        : "ss",
        // Latin Extended-A block.
        : "A",
        : "A",
        : "A",
        : "a",
        : "a",
        : "a",
        : "C",
        : "C",
        : "C",
        : "C",
        : "c",
        : "c",
        : "c",
        : "c",
        : "D",
        : "D",
        : "d",
        : "d",
        : "E",
        : "E",
        : "E",
        : "E",
        : "E",
        : "e",
        : "e",
        : "e",
        : "e",
        : "e",
        : "G",
        : "G",
        : "G",
        : "G",
        : "g",
        : "g",
        : "g",
        : "g",
        : "H",
        : "H",
        : "h",
        : "h",
        : "I",
        : "I",
        : "I",
        : "I",
        : "I",
        : "i",
        : "i",
        : "i",
        : "i",
        : "i",
        : "J",
        : "j",
        : "K",
        : "k",
        : "k",
        : "L",
        : "L",
        : "L",
        : "L",
        : "L",
        : "l",
        : "l",
        : "l",
        : "l",
        : "l",
        : "N",
        : "N",
        : "N",
        : "N",
        : "n",
        : "n",
        : "n",
        : "n",
        : "O",
        : "O",
        : "O",
        : "o",
        : "o",
        : "o",
        : "R",
        : "R",
        : "R",
        : "r",
        : "r",
        : "r",
        : "S",
        : "S",
        : "S",
        : "S",
        : "s",
        : "s",
        : "s",
        : "s",
        : "T",
        : "T",
        : "T",
        : "t",
        : "t",
        : "t",
        : "U",
        : "U",
        : "U",
        : "U",
        : "U",
        : "U",
        : "u",
        : "u",
        : "u",
        : "u",
        : "u",
        : "u",
        : "W",
        : "w",
        : "Y",
        : "y",
        : "Y",
        : "Z",
        : "Z",
        : "Z",
        : "z",
        : "z",
        : "z",
        : "IJ",
        : "ij",
        : "Oe",
        : "oe",
        : "'n",
        : "s"
      }, mu = {
        "&": "&amp;",
        "<": "&lt;",
        ">": "&gt;",
        '"': "&quot;",
        "'": "&#39;"
      }, zh = {
        "&amp;": "&",
        "&lt;": "<",
        "&gt;": ">",
        "&quot;": '"',
        "&#39;": "'"
      }, Rr = {
        "\\": "\\",
        "'": "'",
        "\n": "n",
        "\r": "r",
        "\u2028": "u2028",
        "\u2029": "u2029"
      }, wo = parseFloat, pc = parseInt, ba = typeof Gu == "object" && Gu && Gu.Object === Object && Gu, mc = typeof self == "object" && self && self.Object === Object && self, lr = ba || mc || Function("return this")(), gu = t && !t.nodeType && t, ps = gu && !0 && e && !e.nodeType && e, yu = ps && ps.exports === gu, dl = yu && ba.process, Ei = (function() {
        try {
          var U = ps && ps.require && ps.require("util").types;
          return U || dl && dl.binding && dl.binding("util");
        } catch {
        }
      })(), Id = Ei && Ei.isArrayBuffer, xu = Ei && Ei.isDate, _o = Ei && Ei.isMap, vu = Ei && Ei.isRegExp, Ld = Ei && Ei.isSet, Ph = Ei && Ei.isTypedArray;
      function Mr(U, se, ie) {
        switch (ie.length) {
          case 0:
            return U.call(se);
          case 1:
            return U.call(se, ie[0]);
          case 2:
            return U.call(se, ie[0], ie[1]);
          case 3:
            return U.call(se, ie[0], ie[1], ie[2]);
        }
        return U.apply(se, ie);
      }
      function Bd(U, se, ie, me) {
        for (var he = -1, _e = U == null ? 0 : U.length; ++he < _e; ) {
          var be = U[he];
          se(me, be, ie(be), U);
        }
        return me;
      }
      function ai(U, se) {
        for (var ie = -1, me = U == null ? 0 : U.length; ++ie < me && se(U[ie], ie, U) !== !1; )
          ;
        return U;
      }
      function $d(U, se) {
        for (var ie = U == null ? 0 : U.length; ie-- && se(U[ie], ie, U) !== !1; )
          ;
        return U;
      }
      function gc(U, se) {
        for (var ie = -1, me = U == null ? 0 : U.length; ++ie < me; )
          if (!se(U[ie], ie, U))
            return !1;
        return !0;
      }
      function Yn(U, se) {
        for (var ie = -1, me = U == null ? 0 : U.length, he = 0, _e = []; ++ie < me; ) {
          var be = U[ie];
          se(be, ie, U) && (_e[he++] = be);
        }
        return _e;
      }
      function Ka(U, se) {
        var ie = U == null ? 0 : U.length;
        return !!ie && Ya(U, se, 0) > -1;
      }
      function wa(U, se, ie) {
        for (var me = -1, he = U == null ? 0 : U.length; ++me < he; )
          if (ie(se, U[me]))
            return !0;
        return !1;
      }
      function In(U, se) {
        for (var ie = -1, me = U == null ? 0 : U.length, he = Array(me); ++ie < me; )
          he[ie] = se(U[ie], ie, U);
        return he;
      }
      function ms(U, se) {
        for (var ie = -1, me = se.length, he = U.length; ++ie < me; )
          U[he + ie] = se[ie];
        return U;
      }
      function yc(U, se, ie, me) {
        var he = -1, _e = U == null ? 0 : U.length;
        for (me && _e && (ie = U[++he]); ++he < _e; )
          ie = se(ie, U[he], he, U);
        return ie;
      }
      function qd(U, se, ie, me) {
        var he = U == null ? 0 : U.length;
        for (me && he && (ie = U[--he]); he--; )
          ie = se(ie, U[he], he, U);
        return ie;
      }
      function fl(U, se) {
        for (var ie = -1, me = U == null ? 0 : U.length; ++ie < me; )
          if (se(U[ie], ie, U))
            return !0;
        return !1;
      }
      var Fd = Ws("length");
      function So(U) {
        return U.split("");
      }
      function Ud(U) {
        return U.match(Bs) || [];
      }
      function xc(U, se, ie) {
        var me;
        return ie(U, function(he, _e, be) {
          if (se(he, _e, be))
            return me = _e, !1;
        }), me;
      }
      function Eo(U, se, ie, me) {
        for (var he = U.length, _e = ie + (me ? 1 : -1); me ? _e-- : ++_e < he; )
          if (se(U[_e], _e, U))
            return _e;
        return -1;
      }
      function Ya(U, se, ie) {
        return se === se ? Kd(U, se, ie) : Eo(U, Lh, ie);
      }
      function Ih(U, se, ie, me) {
        for (var he = ie - 1, _e = U.length; ++he < _e; )
          if (me(U[he], se))
            return he;
        return -1;
      }
      function Lh(U) {
        return U !== U;
      }
      function hl(U, se) {
        var ie = U == null ? 0 : U.length;
        return ie ? bc(U, se) / ie : H;
      }
      function Ws(U) {
        return function(se) {
          return se == null ? n : se[U];
        };
      }
      function Hd(U) {
        return function(se) {
          return U == null ? n : U[se];
        };
      }
      function bu(U, se, ie, me, he) {
        return he(U, function(_e, be, we) {
          ie = me ? (me = !1, _e) : se(ie, _e, be, we);
        }), ie;
      }
      function vc(U, se) {
        var ie = U.length;
        for (U.sort(se); ie--; )
          U[ie] = U[ie].value;
        return U;
      }
      function bc(U, se) {
        for (var ie, me = -1, he = U.length; ++me < he; ) {
          var _e = se(U[me]);
          _e !== n && (ie = ie === n ? _e : ie + _e);
        }
        return ie;
      }
      function wu(U, se) {
        for (var ie = -1, me = Array(U); ++ie < U; )
          me[ie] = se(ie);
        return me;
      }
      function Bh(U, se) {
        return In(se, function(ie) {
          return [ie, U[ie]];
        });
      }
      function Wa(U) {
        return U && U.slice(0, _(U) + 1).replace(Gn, "");
      }
      function Ci(U) {
        return function(se) {
          return U(se);
        };
      }
      function Vd(U, se) {
        return In(se, function(ie) {
          return U[ie];
        });
      }
      function pl(U, se) {
        return U.has(se);
      }
      function _u(U, se) {
        for (var ie = -1, me = U.length; ++ie < me && Ya(se, U[ie], 0) > -1; )
          ;
        return ie;
      }
      function wc(U, se) {
        for (var ie = U.length; ie-- && Ya(se, U[ie], 0) > -1; )
          ;
        return ie;
      }
      function ml(U, se) {
        for (var ie = U.length, me = 0; ie--; )
          U[ie] === se && ++me;
        return me;
      }
      var Su = Hd(cl), ig = Hd(mu);
      function _c(U) {
        return "\\" + Rr[U];
      }
      function Eu(U, se) {
        return U == null ? n : U[se];
      }
      function oi(U) {
        return Pd.test(U);
      }
      function Wn(U) {
        return Si.test(U);
      }
      function gl(U) {
        for (var se, ie = []; !(se = U.next()).done; )
          ie.push(se.value);
        return ie;
      }
      function li(U) {
        var se = -1, ie = Array(U.size);
        return U.forEach(function(me, he) {
          ie[++se] = [he, me];
        }), ie;
      }
      function Gd(U, se) {
        return function(ie) {
          return U(se(ie));
        };
      }
      function gs(U, se) {
        for (var ie = -1, me = U.length, he = 0, _e = []; ++ie < me; ) {
          var be = U[ie];
          (be === se || be === h) && (U[ie] = h, _e[he++] = ie);
        }
        return _e;
      }
      function Cu(U) {
        var se = -1, ie = Array(U.size);
        return U.forEach(function(me) {
          ie[++se] = me;
        }), ie;
      }
      function Co(U) {
        var se = -1, ie = Array(U.size);
        return U.forEach(function(me) {
          ie[++se] = [me, me];
        }), ie;
      }
      function Kd(U, se, ie) {
        for (var me = ie - 1, he = U.length; ++me < he; )
          if (U[me] === se)
            return me;
        return -1;
      }
      function yl(U, se, ie) {
        for (var me = ie + 1; me--; )
          if (U[me] === se)
            return me;
        return me;
      }
      function Di(U) {
        return oi(U) ? O(U) : Fd(U);
      }
      function Vn(U) {
        return oi(U) ? L(U) : So(U);
      }
      function _(U) {
        for (var se = U.length; se-- && fu.test(U.charAt(se)); )
          ;
        return se;
      }
      var j = Hd(zh);
      function O(U) {
        for (var se = va.lastIndex = 0; va.test(U); )
          ++se;
        return se;
      }
      function L(U) {
        return U.match(va) || [];
      }
      function F(U) {
        return U.match(Wr) || [];
      }
      var W = (function U(se) {
        se = se == null ? lr : ue.defaults(lr.Object(), se, ue.pick(lr, Ys));
        var ie = se.Array, me = se.Date, he = se.Error, _e = se.Function, be = se.Math, we = se.Object, ke = se.RegExp, Te = se.String, Ae = se.TypeError, ze = ie.prototype, qe = _e.prototype, Ve = we.prototype, rt = se["__core-js_shared__"], ut = qe.toString, He = Ve.hasOwnProperty, ot = 0, ct = (function() {
          var g = /[^.]+$/.exec(rt && rt.keys && rt.keys.IE_PROTO || "");
          return g ? "Symbol(src)_1." + g : "";
        })(), tt = Ve.toString, vt = ut.call(we), Ct = lr._, Lt = ke(
          "^" + ut.call(He).replace(ya, "\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g, "$1.*?") + "$"
        ), qt = yu ? se.Buffer : n, Zn = se.Symbol, Rt = se.Uint8Array, Er = qt ? qt.allocUnsafe : n, Ln = Gd(we.getPrototypeOf, we), xl = we.create, Cr = Ve.propertyIsEnumerable, ui = ze.splice, Sc = Zn ? Zn.isConcatSpreadable : n, ci = Zn ? Zn.iterator : n, ko = Zn ? Zn.toStringTag : n, Zs = (function() {
          try {
            var g = Rl(we, "defineProperty");
            return g({}, "", {}), g;
          } catch {
          }
        })(), bx = se.clearTimeout !== lr.clearTimeout && se.clearTimeout, $h = me && me.now !== lr.Date.now && me.now, ku = se.setTimeout !== lr.setTimeout && se.setTimeout, Ec = be.ceil, Yd = be.floor, Wd = we.getOwnPropertySymbols, wx = qt ? qt.isBuffer : n, ys = se.isFinite, Cc = ze.join, kc = Gd(we.keys, we), hr = be.max, Or = be.min, Xs = me.now, Qs = se.parseInt, To = be.random, Za = ze.reverse, Js = Rl(se, "DataView"), xs = Rl(se, "Map"), qh = Rl(se, "Promise"), vl = Rl(se, "Set"), Tu = Rl(se, "WeakMap"), Tc = Rl(we, "create"), Dr = Tu && new Tu(), En = {}, un = ji(Js), bl = ji(xs), ea = ji(qh), sg = ji(vl), wl = ji(Tu), Zd = Zn ? Zn.prototype : n, jc = Zd ? Zd.valueOf : n, ju = Zd ? Zd.toString : n;
        function re(g) {
          if (gr(g) && !Ft(g) && !(g instanceof Gt)) {
            if (g instanceof Ki)
              return g;
            if (He.call(g, "__wrapped__"))
              return xp(g);
          }
          return new Ki(g);
        }
        var _l = /* @__PURE__ */ (function() {
          function g() {
          }
          return function(v) {
            if (!rr(v))
              return {};
            if (xl)
              return xl(v);
            g.prototype = v;
            var k = new g();
            return g.prototype = n, k;
          };
        })();
        function Sl() {
        }
        function Ki(g, v) {
          this.__wrapped__ = g, this.__actions__ = [], this.__chain__ = !!v, this.__index__ = 0, this.__values__ = n;
        }
        re.templateSettings = {
          /**
           * Used to detect `data` property values to be HTML-escaped.
           *
           * @memberOf _.templateSettings
           * @type {RegExp}
           */
          escape: tr,
          /**
           * Used to detect code to be evaluated.
           *
           * @memberOf _.templateSettings
           * @type {RegExp}
           */
          evaluate: Dd,
          /**
           * Used to detect `data` property values to inject.
           *
           * @memberOf _.templateSettings
           * @type {RegExp}
           */
          interpolate: cu,
          /**
           * Used to reference the data object in the template text.
           *
           * @memberOf _.templateSettings
           * @type {string}
           */
          variable: "",
          /**
           * Used to import variables into the compiled template.
           *
           * @memberOf _.templateSettings
           * @type {Object}
           */
          imports: {
            /**
             * A reference to the `lodash` function.
             *
             * @memberOf _.templateSettings.imports
             * @type {Function}
             */
            _: re
          }
        }, re.prototype = Sl.prototype, re.prototype.constructor = re, Ki.prototype = _l(Sl.prototype), Ki.prototype.constructor = Ki;
        function Gt(g) {
          this.__wrapped__ = g, this.__actions__ = [], this.__dir__ = 1, this.__filtered__ = !1, this.__iteratees__ = [], this.__takeCount__ = J, this.__views__ = [];
        }
        function jo() {
          var g = new Gt(this.__wrapped__);
          return g.__actions__ = Pi(this.__actions__), g.__dir__ = this.__dir__, g.__filtered__ = this.__filtered__, g.__iteratees__ = Pi(this.__iteratees__), g.__takeCount__ = this.__takeCount__, g.__views__ = Pi(this.__views__), g;
        }
        function El() {
          if (this.__filtered__) {
            var g = new Gt(this);
            g.__dir__ = -1, g.__filtered__ = !0;
          } else
            g = this.clone(), g.__dir__ *= -1;
          return g;
        }
        function Ao() {
          var g = this.__wrapped__.value(), v = this.__dir__, k = Ft(g), z = v < 0, K = k ? g.length : 0, ae = Xw(0, K, this.__views__), ye = ae.start, Ee = ae.end, Ne = Ee - ye, We = z ? Ee : ye - 1, Ze = this.__iteratees__, et = Ze.length, xt = 0, Et = Or(Ne, this.__takeCount__);
          if (!k || !z && K == Ne && Et == Ne)
            return bg(g, this.__actions__);
          var Pt = [];
          e:
            for (; Ne-- && xt < Et; ) {
              We += v;
              for (var Qt = -1, It = g[We]; ++Qt < et; ) {
                var cn = Ze[Qt], yn = cn.iteratee, Oa = cn.type, Ns = yn(It);
                if (Oa == oe)
                  It = Ns;
                else if (!Ns) {
                  if (Oa == Z)
                    continue e;
                  break e;
                }
              }
              Pt[xt++] = It;
            }
          return Pt;
        }
        Gt.prototype = _l(Sl.prototype), Gt.prototype.constructor = Gt;
        function No(g) {
          var v = -1, k = g == null ? 0 : g.length;
          for (this.clear(); ++v < k; ) {
            var z = g[v];
            this.set(z[0], z[1]);
          }
        }
        function ag() {
          this.__data__ = Tc ? Tc(null) : {}, this.size = 0;
        }
        function Ac(g) {
          var v = this.has(g) && delete this.__data__[g];
          return this.size -= v ? 1 : 0, v;
        }
        function Fh(g) {
          var v = this.__data__;
          if (Tc) {
            var k = v[g];
            return k === d ? n : k;
          }
          return He.call(v, g) ? v[g] : n;
        }
        function Au(g) {
          var v = this.__data__;
          return Tc ? v[g] !== n : He.call(v, g);
        }
        function di(g, v) {
          var k = this.__data__;
          return this.size += this.has(g) ? 0 : 1, k[g] = Tc && v === n ? d : v, this;
        }
        No.prototype.clear = ag, No.prototype.delete = Ac, No.prototype.get = Fh, No.prototype.has = Au, No.prototype.set = di;
        function ta(g) {
          var v = -1, k = g == null ? 0 : g.length;
          for (this.clear(); ++v < k; ) {
            var z = g[v];
            this.set(z[0], z[1]);
          }
        }
        function _x() {
          this.__data__ = [], this.size = 0;
        }
        function Uw(g) {
          var v = this.__data__, k = Xa(v, g);
          if (k < 0)
            return !1;
          var z = v.length - 1;
          return k == z ? v.pop() : ui.call(v, k, 1), --this.size, !0;
        }
        function Hw(g) {
          var v = this.__data__, k = Xa(v, g);
          return k < 0 ? n : v[k][1];
        }
        function Vw(g) {
          return Xa(this.__data__, g) > -1;
        }
        function zr(g, v) {
          var k = this.__data__, z = Xa(k, g);
          return z < 0 ? (++this.size, k.push([g, v])) : k[z][1] = v, this;
        }
        ta.prototype.clear = _x, ta.prototype.delete = Uw, ta.prototype.get = Hw, ta.prototype.has = Vw, ta.prototype.set = zr;
        function _a(g) {
          var v = -1, k = g == null ? 0 : g.length;
          for (this.clear(); ++v < k; ) {
            var z = g[v];
            this.set(z[0], z[1]);
          }
        }
        function Xd() {
          this.size = 0, this.__data__ = {
            hash: new No(),
            map: new (xs || ta)(),
            string: new No()
          };
        }
        function Qd(g) {
          var v = yf(this, g).delete(g);
          return this.size -= v ? 1 : 0, v;
        }
        function og(g) {
          return yf(this, g).get(g);
        }
        function Nc(g) {
          return yf(this, g).has(g);
        }
        function Rc(g, v) {
          var k = yf(this, g), z = k.size;
          return k.set(g, v), this.size += k.size == z ? 0 : 1, this;
        }
        _a.prototype.clear = Xd, _a.prototype.delete = Qd, _a.prototype.get = og, _a.prototype.has = Nc, _a.prototype.set = Rc;
        function Nu(g) {
          var v = -1, k = g == null ? 0 : g.length;
          for (this.__data__ = new _a(); ++v < k; )
            this.add(g[v]);
        }
        function Sx(g) {
          return this.__data__.set(g, d), this;
        }
        function Gw(g) {
          return this.__data__.has(g);
        }
        Nu.prototype.add = Nu.prototype.push = Sx, Nu.prototype.has = Gw;
        function na(g) {
          var v = this.__data__ = new ta(g);
          this.size = v.size;
        }
        function Ru() {
          this.__data__ = new ta(), this.size = 0;
        }
        function lg(g) {
          var v = this.__data__, k = v.delete(g);
          return this.size = v.size, k;
        }
        function Uh(g) {
          return this.__data__.get(g);
        }
        function Ex(g) {
          return this.__data__.has(g);
        }
        function Mc(g, v) {
          var k = this.__data__;
          if (k instanceof ta) {
            var z = k.__data__;
            if (!xs || z.length < i - 1)
              return z.push([g, v]), this.size = ++k.size, this;
            k = this.__data__ = new _a(z);
          }
          return k.set(g, v), this.size = k.size, this;
        }
        na.prototype.clear = Ru, na.prototype.delete = lg, na.prototype.get = Uh, na.prototype.has = Ex, na.prototype.set = Mc;
        function Hh(g, v) {
          var k = Ft(g), z = !k && Bu(g), K = !k && !z && Ll(g), ae = !k && !z && !K && Bl(g), ye = k || z || K || ae, Ee = ye ? wu(g.length, Te) : [], Ne = Ee.length;
          for (var We in g)
            (v || He.call(g, We)) && !(ye && // Safari 9 has enumerable `arguments.length` in strict mode.
            (We == "length" || // Node.js 0.10 has enumerable non-index properties on buffers.
            K && (We == "offset" || We == "parent") || // PhantomJS 2 has enumerable non-index properties on typed arrays.
            ae && (We == "buffer" || We == "byteLength" || We == "byteOffset") || // Skip index properties.
            Aa(We, Ne))) && Ee.push(We);
          return Ee;
        }
        function Jd(g) {
          var v = g.length;
          return v ? g[$c(0, v - 1)] : n;
        }
        function Vh(g, v) {
          return Cf(Pi(g), Ea(v, 0, g.length));
        }
        function Cx(g) {
          return Cf(Pi(g));
        }
        function Gh(g, v, k) {
          (k !== n && !Ts(g[v], k) || k === n && !(v in g)) && vs(g, v, k);
        }
        function Sa(g, v, k) {
          var z = g[v];
          (!(He.call(g, v) && Ts(z, k)) || k === n && !(v in g)) && vs(g, v, k);
        }
        function Xa(g, v) {
          for (var k = g.length; k--; )
            if (Ts(g[k][0], v))
              return k;
          return -1;
        }
        function kx(g, v, k, z) {
          return Qa(g, function(K, ae, ye) {
            v(z, K, k(K), ye);
          }), z;
        }
        function ug(g, v) {
          return g && aa(v, Xr(v), g);
        }
        function Oc(g, v) {
          return g && aa(v, rs(v), g);
        }
        function vs(g, v, k) {
          v == "__proto__" && Zs ? Zs(g, v, {
            configurable: !0,
            enumerable: !0,
            value: k,
            writable: !0
          }) : g[v] = k;
        }
        function Dc(g, v) {
          for (var k = -1, z = v.length, K = ie(z), ae = g == null; ++k < z; )
            K[k] = ae ? n : $l(g, v[k]);
          return K;
        }
        function Ea(g, v, k) {
          return g === g && (k !== n && (g = g <= k ? g : k), v !== n && (g = g >= v ? g : v)), g;
        }
        function zi(g, v, k, z, K, ae) {
          var ye, Ee = v & m, Ne = v & x, We = v & b;
          if (k && (ye = K ? k(g, z, K, ae) : k(g)), ye !== n)
            return ye;
          if (!rr(g))
            return g;
          var Ze = Ft(g);
          if (Ze) {
            if (ye = Ux(g), !Ee)
              return Pi(g, ye);
          } else {
            var et = hi(g), xt = et == Je || et == ft;
            if (Ll(g))
              return Sg(g, Ee);
            if (et == Ye || et == ve || xt && !K) {
              if (ye = Ne || xt ? {} : Ig(g), !Ee)
                return Ne ? Lx(g, Oc(ye, g)) : Ix(g, ug(ye, g));
            } else {
              if (!gn[et])
                return K ? g : {};
              ye = Hx(g, et, Ee);
            }
          }
          ae || (ae = new na());
          var Et = ae.get(g);
          if (Et)
            return Et;
          ae.set(g, ye), qf(g) ? g.forEach(function(It) {
            ye.add(zi(It, v, k, It, g, ae));
          }) : kv(g) && g.forEach(function(It, cn) {
            ye.set(cn, zi(It, v, k, cn, g, ae));
          });
          var Pt = We ? Ne ? Pg : cp : Ne ? rs : Xr, Qt = Ze ? n : Pt(g);
          return ai(Qt || g, function(It, cn) {
            Qt && (cn = It, It = g[cn]), Sa(ye, cn, zi(It, v, k, cn, g, ae));
          }), ye;
        }
        function Tx(g) {
          var v = Xr(g);
          return function(k) {
            return Cl(k, g, v);
          };
        }
        function Cl(g, v, k) {
          var z = k.length;
          if (g == null)
            return !z;
          for (g = we(g); z--; ) {
            var K = k[z], ae = v[K], ye = g[K];
            if (ye === n && !(K in g) || !ae(ye))
              return !1;
          }
          return !0;
        }
        function cg(g, v, k) {
          if (typeof g != "function")
            throw new Ae(a);
          return Ef(function() {
            g.apply(n, k);
          }, v);
        }
        function ra(g, v, k, z) {
          var K = -1, ae = Ka, ye = !0, Ee = g.length, Ne = [], We = v.length;
          if (!Ee)
            return Ne;
          k && (v = In(v, Ci(k))), z ? (ae = wa, ye = !1) : v.length >= i && (ae = pl, ye = !1, v = new Nu(v));
          e:
            for (; ++K < Ee; ) {
              var Ze = g[K], et = k == null ? Ze : k(Ze);
              if (Ze = z || Ze !== 0 ? Ze : 0, ye && et === et) {
                for (var xt = We; xt--; )
                  if (v[xt] === et)
                    continue e;
                Ne.push(Ze);
              } else ae(v, et, z) || Ne.push(Ze);
            }
          return Ne;
        }
        var Qa = Tg(ka), Kh = Tg(Wh, !0);
        function kl(g, v) {
          var k = !0;
          return Qa(g, function(z, K, ae) {
            return k = !!v(z, K, ae), k;
          }), k;
        }
        function Ca(g, v, k) {
          for (var z = -1, K = g.length; ++z < K; ) {
            var ae = g[z], ye = v(ae);
            if (ye != null && (Ee === n ? ye === ye && !ns(ye) : k(ye, Ee)))
              var Ee = ye, Ne = ae;
          }
          return Ne;
        }
        function ef(g, v, k, z) {
          var K = g.length;
          for (k = zt(k), k < 0 && (k = -k > K ? 0 : K + k), z = z === n || z > K ? K : zt(z), z < 0 && (z += K), z = k > z ? 0 : _0(z); k < z; )
            g[k++] = v;
          return g;
        }
        function Yh(g, v) {
          var k = [];
          return Qa(g, function(z, K, ae) {
            v(z, K, ae) && k.push(z);
          }), k;
        }
        function qr(g, v, k, z, K) {
          var ae = -1, ye = g.length;
          for (k || (k = Bg), K || (K = []); ++ae < ye; ) {
            var Ee = g[ae];
            v > 0 && k(Ee) ? v > 1 ? qr(Ee, v - 1, k, z, K) : ms(K, Ee) : z || (K[K.length] = Ee);
          }
          return K;
        }
        var Mu = jg(), zc = jg(!0);
        function ka(g, v) {
          return g && Mu(g, v, Xr);
        }
        function Wh(g, v) {
          return g && zc(g, v, Xr);
        }
        function Ro(g, v) {
          return Yn(v, function(k) {
            return js(g[k]);
          });
        }
        function Ja(g, v) {
          v = Ss(v, g);
          for (var k = 0, z = v.length; g != null && k < z; )
            g = g[Zi(v[k++])];
          return k && k == z ? g : n;
        }
        function dg(g, v, k) {
          var z = v(g);
          return Ft(g) ? z : ms(z, k(g));
        }
        function fi(g) {
          return g == null ? g === n ? kn : Le : ko && ko in we(g) ? xf(g) : qg(g);
        }
        function tf(g, v) {
          return g > v;
        }
        function bs(g, v) {
          return g != null && He.call(g, v);
        }
        function ia(g, v) {
          return g != null && v in we(g);
        }
        function Tl(g, v, k) {
          return g >= Or(v, k) && g < hr(v, k);
        }
        function nf(g, v, k) {
          for (var z = k ? wa : Ka, K = g[0].length, ae = g.length, ye = ae, Ee = ie(ae), Ne = 1 / 0, We = []; ye--; ) {
            var Ze = g[ye];
            ye && v && (Ze = In(Ze, Ci(v))), Ne = Or(Ze.length, Ne), Ee[ye] = !k && (v || K >= 120 && Ze.length >= 120) ? new Nu(ye && Ze) : n;
          }
          Ze = g[0];
          var et = -1, xt = Ee[0];
          e:
            for (; ++et < K && We.length < Ne; ) {
              var Et = Ze[et], Pt = v ? v(Et) : Et;
              if (Et = k || Et !== 0 ? Et : 0, !(xt ? pl(xt, Pt) : z(We, Pt, k))) {
                for (ye = ae; --ye; ) {
                  var Qt = Ee[ye];
                  if (!(Qt ? pl(Qt, Pt) : z(g[ye], Pt, k)))
                    continue e;
                }
                xt && xt.push(Pt), We.push(Et);
              }
            }
          return We;
        }
        function jx(g, v, k, z) {
          return ka(g, function(K, ae, ye) {
            v(z, k(K), ae, ye);
          }), z;
        }
        function sa(g, v, k) {
          v = Ss(v, g), g = _f(g, v);
          var z = g == null ? g : g[Zi(Qn(v))];
          return z == null ? n : Mr(z, g, k);
        }
        function Yi(g) {
          return gr(g) && fi(g) == ve;
        }
        function kr(g) {
          return gr(g) && fi(g) == Qe;
        }
        function Zh(g) {
          return gr(g) && fi(g) == Re;
        }
        function ws(g, v, k, z, K) {
          return g === v ? !0 : g == null || v == null || !gr(g) && !gr(v) ? g !== g && v !== v : Kt(g, v, k, z, ws, K);
        }
        function Kt(g, v, k, z, K, ae) {
          var ye = Ft(g), Ee = Ft(v), Ne = ye ? Se : hi(g), We = Ee ? Se : hi(v);
          Ne = Ne == ve ? Ye : Ne, We = We == ve ? Ye : We;
          var Ze = Ne == Ye, et = We == Ye, xt = Ne == We;
          if (xt && Ll(g)) {
            if (!Ll(v))
              return !1;
            ye = !0, Ze = !1;
          }
          if (xt && !Ze)
            return ae || (ae = new na()), ye || Bl(g) ? mf(g, v, k, z, K, ae) : Fx(g, v, Ne, k, z, K, ae);
          if (!(k & w)) {
            var Et = Ze && He.call(g, "__wrapped__"), Pt = et && He.call(v, "__wrapped__");
            if (Et || Pt) {
              var Qt = Et ? g.value() : g, It = Pt ? v.value() : v;
              return ae || (ae = new na()), K(Qt, It, k, z, ae);
            }
          }
          return xt ? (ae || (ae = new na()), zg(g, v, k, z, K, ae)) : !1;
        }
        function Mn(g) {
          return gr(g) && hi(g) == yt;
        }
        function pr(g, v, k, z) {
          var K = k.length, ae = K, ye = !z;
          if (g == null)
            return !ae;
          for (g = we(g); K--; ) {
            var Ee = k[K];
            if (ye && Ee[2] ? Ee[1] !== g[Ee[0]] : !(Ee[0] in g))
              return !1;
          }
          for (; ++K < ae; ) {
            Ee = k[K];
            var Ne = Ee[0], We = g[Ne], Ze = Ee[1];
            if (ye && Ee[2]) {
              if (We === n && !(Ne in g))
                return !1;
            } else {
              var et = new na();
              if (z)
                var xt = z(We, Ze, Ne, g, v, et);
              if (!(xt === n ? ws(Ze, We, w | S, z, et) : xt))
                return !1;
            }
          }
          return !0;
        }
        function rf(g) {
          if (!rr(g) || Vx(g))
            return !1;
          var v = js(g) ? Lt : hu;
          return v.test(ji(g));
        }
        function Pc(g) {
          return gr(g) && fi(g) == pn;
        }
        function Ou(g) {
          return gr(g) && hi(g) == Ht;
        }
        function Xh(g) {
          return gr(g) && Rp(g.length) && !!vn[fi(g)];
        }
        function Ic(g) {
          return typeof g == "function" ? g : g == null ? Li : typeof g == "object" ? Ft(g) ? fg(g[0], g[1]) : Jh(g) : ne(g);
        }
        function jl(g) {
          if (!Vc(g))
            return kc(g);
          var v = [];
          for (var k in we(g))
            He.call(g, k) && k != "constructor" && v.push(k);
          return v;
        }
        function Kw(g) {
          if (!rr(g))
            return Oo(g);
          var v = Vc(g), k = [];
          for (var z in g)
            z == "constructor" && (v || !He.call(g, z)) || k.push(z);
          return k;
        }
        function nr(g, v) {
          return g < v;
        }
        function Qh(g, v) {
          var k = -1, z = ts(g) ? ie(g.length) : [];
          return Qa(g, function(K, ae, ye) {
            z[++k] = v(K, ae, ye);
          }), z;
        }
        function Jh(g) {
          var v = dp(g);
          return v.length == 1 && v[0][2] ? gp(v[0][0], v[0][1]) : function(k) {
            return k === g || pr(k, g, v);
          };
        }
        function fg(g, v) {
          return bf(g) && to(v) ? gp(Zi(g), v) : function(k) {
            var z = $l(k, g);
            return z === n && z === v ? E0(k, g) : ws(v, z, w | S);
          };
        }
        function sf(g, v, k, z, K) {
          g !== v && Mu(v, function(ae, ye) {
            if (K || (K = new na()), rr(ae))
              Yw(g, v, ye, k, sf, z, K);
            else {
              var Ee = z ? z(Bn(g, ye), ae, ye + "", g, v, K) : n;
              Ee === n && (Ee = ae), Gh(g, ye, Ee);
            }
          }, rs);
        }
        function Yw(g, v, k, z, K, ae, ye) {
          var Ee = Bn(g, k), Ne = Bn(v, k), We = ye.get(Ne);
          if (We) {
            Gh(g, k, We);
            return;
          }
          var Ze = ae ? ae(Ee, Ne, k + "", g, v, ye) : n, et = Ze === n;
          if (et) {
            var xt = Ft(Ne), Et = !xt && Ll(Ne), Pt = !xt && !Et && Bl(Ne);
            Ze = Ne, xt || Et || Pt ? Ft(Ee) ? Ze = Ee : jr(Ee) ? Ze = Pi(Ee) : Et ? (et = !1, Ze = Sg(Ne, !0)) : Pt ? (et = !1, Ze = Eg(Ne, !0)) : Ze = [] : Bf(Ne) || Bu(Ne) ? (Ze = Ee, Bu(Ee) ? Ze = Mp(Ee) : (!rr(Ee) || js(Ee)) && (Ze = Ig(Ne))) : et = !1;
          }
          et && (ye.set(Ne, Ze), K(Ze, Ne, z, ae, ye), ye.delete(Ne)), Gh(g, k, Ze);
        }
        function ep(g, v) {
          var k = g.length;
          if (k)
            return v += v < 0 ? k : 0, Aa(v, k) ? g[v] : n;
        }
        function tp(g, v, k) {
          v.length ? v = In(v, function(ae) {
            return Ft(ae) ? function(ye) {
              return Ja(ye, ae.length === 1 ? ae[0] : ae);
            } : ae;
          }) : v = [Li];
          var z = -1;
          v = In(v, Ci(Nt()));
          var K = Qh(g, function(ae, ye, Ee) {
            var Ne = In(v, function(We) {
              return We(ae);
            });
            return { criteria: Ne, index: ++z, value: ae };
          });
          return vc(K, function(ae, ye) {
            return Px(ae, ye, k);
          });
        }
        function hg(g, v) {
          return ki(g, v, function(k, z) {
            return E0(g, z);
          });
        }
        function ki(g, v, k) {
          for (var z = -1, K = v.length, ae = {}; ++z < K; ) {
            var ye = v[z], Ee = Ja(g, ye);
            k(Ee, ye) && qc(ae, Ss(ye, g), Ee);
          }
          return ae;
        }
        function Tr(g) {
          return function(v) {
            return Ja(v, g);
          };
        }
        function Lc(g, v, k, z) {
          var K = z ? Ih : Ya, ae = -1, ye = v.length, Ee = g;
          for (g === v && (v = Pi(v)), k && (Ee = In(g, Ci(k))); ++ae < ye; )
            for (var Ne = 0, We = v[ae], Ze = k ? k(We) : We; (Ne = K(Ee, Ze, Ne, z)) > -1; )
              Ee !== g && ui.call(Ee, Ne, 1), ui.call(g, Ne, 1);
          return g;
        }
        function Bc(g, v) {
          for (var k = g ? v.length : 0, z = k - 1; k--; ) {
            var K = v[k];
            if (k == z || K !== ae) {
              var ae = K;
              Aa(K) ? ui.call(g, K, 1) : af(g, K);
            }
          }
          return g;
        }
        function $c(g, v) {
          return g + Yd(To() * (v - g + 1));
        }
        function pg(g, v, k, z) {
          for (var K = -1, ae = hr(Ec((v - g) / (k || 1)), 0), ye = ie(ae); ae--; )
            ye[z ? ae : ++K] = g, g += k;
          return ye;
        }
        function Ta(g, v) {
          var k = "";
          if (!g || v < 1 || v > pe)
            return k;
          do
            v % 2 && (k += g), v = Yd(v / 2), v && (g += g);
          while (v);
          return k;
        }
        function Yt(g, v) {
          return yp(Fg(g, v, Li), g + "");
        }
        function mg(g) {
          return Jd(sd(g));
        }
        function gg(g, v) {
          var k = sd(g);
          return Cf(k, Ea(v, 0, k.length));
        }
        function qc(g, v, k, z) {
          if (!rr(g))
            return g;
          v = Ss(v, g);
          for (var K = -1, ae = v.length, ye = ae - 1, Ee = g; Ee != null && ++K < ae; ) {
            var Ne = Zi(v[K]), We = k;
            if (Ne === "__proto__" || Ne === "constructor" || Ne === "prototype")
              return g;
            if (K != ye) {
              var Ze = Ee[Ne];
              We = z ? z(Ze, Ne, Ee) : n, We === n && (We = rr(Ze) ? Ze : Aa(v[K + 1]) ? [] : {});
            }
            Sa(Ee, Ne, We), Ee = Ee[Ne];
          }
          return g;
        }
        var yg = Dr ? function(g, v) {
          return Dr.set(g, v), g;
        } : Li, Ax = Zs ? function(g, v) {
          return Zs(g, "toString", {
            configurable: !0,
            enumerable: !1,
            value: od(v),
            writable: !0
          });
        } : Li;
        function Nx(g) {
          return Cf(sd(g));
        }
        function _s(g, v, k) {
          var z = -1, K = g.length;
          v < 0 && (v = -v > K ? 0 : K + v), k = k > K ? K : k, k < 0 && (k += K), K = v > k ? 0 : k - v >>> 0, v >>>= 0;
          for (var ae = ie(K); ++z < K; )
            ae[z] = g[z + v];
          return ae;
        }
        function Rx(g, v) {
          var k;
          return Qa(g, function(z, K, ae) {
            return k = v(z, K, ae), !k;
          }), !!k;
        }
        function Fc(g, v, k) {
          var z = 0, K = g == null ? z : g.length;
          if (typeof v == "number" && v === v && K <= Q) {
            for (; z < K; ) {
              var ae = z + K >>> 1, ye = g[ae];
              ye !== null && !ns(ye) && (k ? ye <= v : ye < v) ? z = ae + 1 : K = ae;
            }
            return K;
          }
          return np(g, v, Li, k);
        }
        function np(g, v, k, z) {
          var K = 0, ae = g == null ? 0 : g.length;
          if (ae === 0)
            return 0;
          v = k(v);
          for (var ye = v !== v, Ee = v === null, Ne = ns(v), We = v === n; K < ae; ) {
            var Ze = Yd((K + ae) / 2), et = k(g[Ze]), xt = et !== n, Et = et === null, Pt = et === et, Qt = ns(et);
            if (ye)
              var It = z || Pt;
            else We ? It = Pt && (z || xt) : Ee ? It = Pt && xt && (z || !Et) : Ne ? It = Pt && xt && !Et && (z || !Qt) : Et || Qt ? It = !1 : It = z ? et <= v : et < v;
            It ? K = Ze + 1 : ae = Ze;
          }
          return Or(ae, ge);
        }
        function Mx(g, v) {
          for (var k = -1, z = g.length, K = 0, ae = []; ++k < z; ) {
            var ye = g[k], Ee = v ? v(ye) : ye;
            if (!k || !Ts(Ee, Ne)) {
              var Ne = Ee;
              ae[K++] = ye === 0 ? 0 : ye;
            }
          }
          return ae;
        }
        function xg(g) {
          return typeof g == "number" ? g : ns(g) ? H : +g;
        }
        function Wi(g) {
          if (typeof g == "string")
            return g;
          if (Ft(g))
            return In(g, Wi) + "";
          if (ns(g))
            return ju ? ju.call(g) : "";
          var v = g + "";
          return v == "0" && 1 / g == -ce ? "-0" : v;
        }
        function Mo(g, v, k) {
          var z = -1, K = Ka, ae = g.length, ye = !0, Ee = [], Ne = Ee;
          if (k)
            ye = !1, K = wa;
          else if (ae >= i) {
            var We = v ? null : $x(g);
            if (We)
              return Cu(We);
            ye = !1, K = pl, Ne = new Nu();
          } else
            Ne = v ? [] : Ee;
          e:
            for (; ++z < ae; ) {
              var Ze = g[z], et = v ? v(Ze) : Ze;
              if (Ze = k || Ze !== 0 ? Ze : 0, ye && et === et) {
                for (var xt = Ne.length; xt--; )
                  if (Ne[xt] === et)
                    continue e;
                v && Ne.push(et), Ee.push(Ze);
              } else K(Ne, et, k) || (Ne !== Ee && Ne.push(et), Ee.push(Ze));
            }
          return Ee;
        }
        function af(g, v) {
          return v = Ss(v, g), g = _f(g, v), g == null || delete g[Zi(Qn(v))];
        }
        function vg(g, v, k, z) {
          return qc(g, v, k(Ja(g, v)), z);
        }
        function of(g, v, k, z) {
          for (var K = g.length, ae = z ? K : -1; (z ? ae-- : ++ae < K) && v(g[ae], ae, g); )
            ;
          return k ? _s(g, z ? 0 : ae, z ? ae + 1 : K) : _s(g, z ? ae + 1 : 0, z ? K : ae);
        }
        function bg(g, v) {
          var k = g;
          return k instanceof Gt && (k = k.value()), yc(v, function(z, K) {
            return K.func.apply(K.thisArg, ms([z], K.args));
          }, k);
        }
        function rp(g, v, k) {
          var z = g.length;
          if (z < 2)
            return z ? Mo(g[0]) : [];
          for (var K = -1, ae = ie(z); ++K < z; )
            for (var ye = g[K], Ee = -1; ++Ee < z; )
              Ee != K && (ae[K] = ra(ae[K] || ye, g[Ee], v, k));
          return Mo(qr(ae, 1), v, k);
        }
        function wg(g, v, k) {
          for (var z = -1, K = g.length, ae = v.length, ye = {}; ++z < K; ) {
            var Ee = z < ae ? v[z] : n;
            k(ye, g[z], Ee);
          }
          return ye;
        }
        function _g(g) {
          return jr(g) ? g : [];
        }
        function ip(g) {
          return typeof g == "function" ? g : Li;
        }
        function Ss(g, v) {
          return Ft(g) ? g : bf(g, v) ? [g] : Ug(Cn(g));
        }
        var Ox = Yt;
        function ja(g, v, k) {
          var z = g.length;
          return k = k === n ? z : k, !v && k >= z ? g : _s(g, v, k);
        }
        var lf = bx || function(g) {
          return lr.clearTimeout(g);
        };
        function Sg(g, v) {
          if (v)
            return g.slice();
          var k = g.length, z = Er ? Er(k) : new g.constructor(k);
          return g.copy(z), z;
        }
        function uf(g) {
          var v = new g.constructor(g.byteLength);
          return new Rt(v).set(new Rt(g)), v;
        }
        function Ww(g, v) {
          var k = v ? uf(g.buffer) : g.buffer;
          return new g.constructor(k, g.byteOffset, g.byteLength);
        }
        function Dx(g) {
          var v = new g.constructor(g.source, $s.exec(g));
          return v.lastIndex = g.lastIndex, v;
        }
        function zx(g) {
          return jc ? we(jc.call(g)) : {};
        }
        function Eg(g, v) {
          var k = v ? uf(g.buffer) : g.buffer;
          return new g.constructor(k, g.byteOffset, g.length);
        }
        function Cg(g, v) {
          if (g !== v) {
            var k = g !== n, z = g === null, K = g === g, ae = ns(g), ye = v !== n, Ee = v === null, Ne = v === v, We = ns(v);
            if (!Ee && !We && !ae && g > v || ae && ye && Ne && !Ee && !We || z && ye && Ne || !k && Ne || !K)
              return 1;
            if (!z && !ae && !We && g < v || We && k && K && !z && !ae || Ee && k && K || !ye && K || !Ne)
              return -1;
          }
          return 0;
        }
        function Px(g, v, k) {
          for (var z = -1, K = g.criteria, ae = v.criteria, ye = K.length, Ee = k.length; ++z < ye; ) {
            var Ne = Cg(K[z], ae[z]);
            if (Ne) {
              if (z >= Ee)
                return Ne;
              var We = k[z];
              return Ne * (We == "desc" ? -1 : 1);
            }
          }
          return g.index - v.index;
        }
        function sp(g, v, k, z) {
          for (var K = -1, ae = g.length, ye = k.length, Ee = -1, Ne = v.length, We = hr(ae - ye, 0), Ze = ie(Ne + We), et = !z; ++Ee < Ne; )
            Ze[Ee] = v[Ee];
          for (; ++K < ye; )
            (et || K < ae) && (Ze[k[K]] = g[K]);
          for (; We--; )
            Ze[Ee++] = g[K++];
          return Ze;
        }
        function kg(g, v, k, z) {
          for (var K = -1, ae = g.length, ye = -1, Ee = k.length, Ne = -1, We = v.length, Ze = hr(ae - Ee, 0), et = ie(Ze + We), xt = !z; ++K < Ze; )
            et[K] = g[K];
          for (var Et = K; ++Ne < We; )
            et[Et + Ne] = v[Ne];
          for (; ++ye < Ee; )
            (xt || K < ae) && (et[Et + k[ye]] = g[K++]);
          return et;
        }
        function Pi(g, v) {
          var k = -1, z = g.length;
          for (v || (v = ie(z)); ++k < z; )
            v[k] = g[k];
          return v;
        }
        function aa(g, v, k, z) {
          var K = !k;
          k || (k = {});
          for (var ae = -1, ye = v.length; ++ae < ye; ) {
            var Ee = v[ae], Ne = z ? z(k[Ee], g[Ee], Ee, k, g) : n;
            Ne === n && (Ne = g[Ee]), K ? vs(k, Ee, Ne) : Sa(k, Ee, Ne);
          }
          return k;
        }
        function Ix(g, v) {
          return aa(g, fp(g), v);
        }
        function Lx(g, v) {
          return aa(g, vf(g), v);
        }
        function ap(g, v) {
          return function(k, z) {
            var K = Ft(k) ? Bd : kx, ae = v ? v() : {};
            return K(k, g, Nt(z, 2), ae);
          };
        }
        function Al(g) {
          return Yt(function(v, k) {
            var z = -1, K = k.length, ae = K > 1 ? k[K - 1] : n, ye = K > 2 ? k[2] : n;
            for (ae = g.length > 3 && typeof ae == "function" ? (K--, ae) : n, ye && Ti(k[0], k[1], ye) && (ae = K < 3 ? n : ae, K = 1), v = we(v); ++z < K; ) {
              var Ee = k[z];
              Ee && g(v, Ee, z, ae);
            }
            return v;
          });
        }
        function Tg(g, v) {
          return function(k, z) {
            if (k == null)
              return k;
            if (!ts(k))
              return g(k, z);
            for (var K = k.length, ae = v ? K : -1, ye = we(k); (v ? ae-- : ++ae < K) && z(ye[ae], ae, ye) !== !1; )
              ;
            return k;
          };
        }
        function jg(g) {
          return function(v, k, z) {
            for (var K = -1, ae = we(v), ye = z(v), Ee = ye.length; Ee--; ) {
              var Ne = ye[g ? Ee : ++K];
              if (k(ae[Ne], Ne, ae) === !1)
                break;
            }
            return v;
          };
        }
        function Ag(g, v, k) {
          var z = v & C, K = cf(g);
          function ae() {
            var ye = this && this !== lr && this instanceof ae ? K : g;
            return ye.apply(z ? k : this, arguments);
          }
          return ae;
        }
        function Ng(g) {
          return function(v) {
            v = Cn(v);
            var k = oi(v) ? Vn(v) : n, z = k ? k[0] : v.charAt(0), K = k ? ja(k, 1).join("") : v.slice(1);
            return z[g]() + K;
          };
        }
        function Du(g) {
          return function(v) {
            return yc(Jv(ad(v).replace(bo, "")), g, "");
          };
        }
        function cf(g) {
          return function() {
            var v = arguments;
            switch (v.length) {
              case 0:
                return new g();
              case 1:
                return new g(v[0]);
              case 2:
                return new g(v[0], v[1]);
              case 3:
                return new g(v[0], v[1], v[2]);
              case 4:
                return new g(v[0], v[1], v[2], v[3]);
              case 5:
                return new g(v[0], v[1], v[2], v[3], v[4]);
              case 6:
                return new g(v[0], v[1], v[2], v[3], v[4], v[5]);
              case 7:
                return new g(v[0], v[1], v[2], v[3], v[4], v[5], v[6]);
            }
            var k = _l(g.prototype), z = g.apply(k, v);
            return rr(z) ? z : k;
          };
        }
        function Zw(g, v, k) {
          var z = cf(g);
          function K() {
            for (var ae = arguments.length, ye = ie(ae), Ee = ae, Ne = mr(K); Ee--; )
              ye[Ee] = arguments[Ee];
            var We = ae < 3 && ye[0] !== Ne && ye[ae - 1] !== Ne ? [] : gs(ye, Ne);
            if (ae -= We.length, ae < k)
              return up(
                g,
                v,
                Hc,
                K.placeholder,
                n,
                ye,
                We,
                n,
                n,
                k - ae
              );
            var Ze = this && this !== lr && this instanceof K ? z : g;
            return Mr(Ze, this, ye);
          }
          return K;
        }
        function Rg(g) {
          return function(v, k, z) {
            var K = we(v);
            if (!ts(v)) {
              var ae = Nt(k, 3);
              v = Xr(v), k = function(Ee) {
                return ae(K[Ee], Ee, K);
              };
            }
            var ye = g(v, k, z);
            return ye > -1 ? K[ae ? v[ye] : ye] : n;
          };
        }
        function Uc(g) {
          return eo(function(v) {
            var k = v.length, z = k, K = Ki.prototype.thru;
            for (g && v.reverse(); z--; ) {
              var ae = v[z];
              if (typeof ae != "function")
                throw new Ae(a);
              if (K && !ye && ur(ae) == "wrapper")
                var ye = new Ki([], !0);
            }
            for (z = ye ? z : k; ++z < k; ) {
              ae = v[z];
              var Ee = ur(ae), Ne = Ee == "wrapper" ? gf(ae) : n;
              Ne && wf(Ne[0]) && Ne[1] == (q | N | P | Y) && !Ne[4].length && Ne[9] == 1 ? ye = ye[ur(Ne[0])].apply(ye, Ne[3]) : ye = ae.length == 1 && wf(ae) ? ye[Ee]() : ye.thru(ae);
            }
            return function() {
              var We = arguments, Ze = We[0];
              if (ye && We.length == 1 && Ft(Ze))
                return ye.plant(Ze).value();
              for (var et = 0, xt = k ? v[et].apply(this, We) : Ze; ++et < k; )
                xt = v[et].call(this, xt);
              return xt;
            };
          });
        }
        function Hc(g, v, k, z, K, ae, ye, Ee, Ne, We) {
          var Ze = v & q, et = v & C, xt = v & T, Et = v & (N | M), Pt = v & te, Qt = xt ? n : cf(g);
          function It() {
            for (var cn = arguments.length, yn = ie(cn), Oa = cn; Oa--; )
              yn[Oa] = arguments[Oa];
            if (Et)
              var Ns = mr(It), Da = ml(yn, Ns);
            if (z && (yn = sp(yn, z, K, Et)), ae && (yn = kg(yn, ae, ye, Et)), cn -= Da, Et && cn < We) {
              var Ur = gs(yn, Ns);
              return up(
                g,
                v,
                Hc,
                It.placeholder,
                k,
                yn,
                Ur,
                Ee,
                Ne,
                We - cn
              );
            }
            var Fo = et ? k : this, qu = xt ? Fo[g] : g;
            return cn = yn.length, Ee ? yn = Sf(yn, Ee) : Pt && cn > 1 && yn.reverse(), Ze && Ne < cn && (yn.length = Ne), this && this !== lr && this instanceof It && (qu = Qt || cf(qu)), qu.apply(Fo, yn);
          }
          return It;
        }
        function df(g, v) {
          return function(k, z) {
            return jx(k, g, v(z), {});
          };
        }
        function ff(g, v) {
          return function(k, z) {
            var K;
            if (k === n && z === n)
              return v;
            if (k !== n && (K = k), z !== n) {
              if (K === n)
                return z;
              typeof k == "string" || typeof z == "string" ? (k = Wi(k), z = Wi(z)) : (k = xg(k), z = xg(z)), K = g(k, z);
            }
            return K;
          };
        }
        function op(g) {
          return eo(function(v) {
            return v = In(v, Ci(Nt())), Yt(function(k) {
              var z = this;
              return g(v, function(K) {
                return Mr(K, z, k);
              });
            });
          });
        }
        function Nl(g, v) {
          v = v === n ? " " : Wi(v);
          var k = v.length;
          if (k < 2)
            return k ? Ta(v, g) : v;
          var z = Ta(v, Ec(g / Di(v)));
          return oi(v) ? ja(Vn(z), 0, g).join("") : z.slice(0, g);
        }
        function Bx(g, v, k, z) {
          var K = v & C, ae = cf(g);
          function ye() {
            for (var Ee = -1, Ne = arguments.length, We = -1, Ze = z.length, et = ie(Ze + Ne), xt = this && this !== lr && this instanceof ye ? ae : g; ++We < Ze; )
              et[We] = z[We];
            for (; Ne--; )
              et[We++] = arguments[++Ee];
            return Mr(xt, K ? k : this, et);
          }
          return ye;
        }
        function lp(g) {
          return function(v, k, z) {
            return z && typeof z != "number" && Ti(v, k, z) && (k = z = n), v = $o(v), k === n ? (k = v, v = 0) : k = $o(k), z = z === n ? v < k ? 1 : -1 : $o(z), pg(v, k, z, g);
          };
        }
        function hf(g) {
          return function(v, k) {
            return typeof v == "string" && typeof k == "string" || (v = As(v), k = As(k)), g(v, k);
          };
        }
        function up(g, v, k, z, K, ae, ye, Ee, Ne, We) {
          var Ze = v & N, et = Ze ? ye : n, xt = Ze ? n : ye, Et = Ze ? ae : n, Pt = Ze ? n : ae;
          v |= Ze ? P : D, v &= ~(Ze ? D : P), v & R || (v &= -4);
          var Qt = [
            g,
            v,
            K,
            Et,
            et,
            Pt,
            xt,
            Ee,
            Ne,
            We
          ], It = k.apply(n, Qt);
          return wf(g) && Kx(It, Qt), It.placeholder = z, Gc(It, g, v);
        }
        function pf(g) {
          var v = be[g];
          return function(k, z) {
            if (k = As(k), z = z == null ? 0 : Or(zt(z), 292), z && ys(k)) {
              var K = (Cn(k) + "e").split("e"), ae = v(K[0] + "e" + (+K[1] + z));
              return K = (Cn(ae) + "e").split("e"), +(K[0] + "e" + (+K[1] - z));
            }
            return v(k);
          };
        }
        var $x = vl && 1 / Cu(new vl([, -0]))[1] == ce ? function(g) {
          return new vl(g);
        } : p;
        function Mg(g) {
          return function(v) {
            var k = hi(v);
            return k == yt ? li(v) : k == Ht ? Co(v) : Bh(v, g(v));
          };
        }
        function Ii(g, v, k, z, K, ae, ye, Ee) {
          var Ne = v & T;
          if (!Ne && typeof g != "function")
            throw new Ae(a);
          var We = z ? z.length : 0;
          if (We || (v &= -97, z = K = n), ye = ye === n ? ye : hr(zt(ye), 0), Ee = Ee === n ? Ee : zt(Ee), We -= K ? K.length : 0, v & D) {
            var Ze = z, et = K;
            z = K = n;
          }
          var xt = Ne ? n : gf(g), Et = [
            g,
            v,
            k,
            z,
            K,
            Ze,
            et,
            ae,
            ye,
            Ee
          ];
          if (xt && Gx(Et, xt), g = Et[0], v = Et[1], k = Et[2], z = Et[3], K = Et[4], Ee = Et[9] = Et[9] === n ? Ne ? 0 : g.length : hr(Et[9] - We, 0), !Ee && v & (N | M) && (v &= -25), !v || v == C)
            var Pt = Ag(g, v, k);
          else v == N || v == M ? Pt = Zw(g, v, Ee) : (v == P || v == (C | P)) && !K.length ? Pt = Bx(g, v, k, z) : Pt = Hc.apply(n, Et);
          var Qt = xt ? yg : Kx;
          return Gc(Qt(Pt, Et), g, v);
        }
        function Og(g, v, k, z) {
          return g === n || Ts(g, Ve[k]) && !He.call(z, k) ? v : g;
        }
        function Dg(g, v, k, z, K, ae) {
          return rr(g) && rr(v) && (ae.set(v, g), sf(g, v, n, Dg, ae), ae.delete(v)), g;
        }
        function qx(g) {
          return Bf(g) ? n : g;
        }
        function mf(g, v, k, z, K, ae) {
          var ye = k & w, Ee = g.length, Ne = v.length;
          if (Ee != Ne && !(ye && Ne > Ee))
            return !1;
          var We = ae.get(g), Ze = ae.get(v);
          if (We && Ze)
            return We == v && Ze == g;
          var et = -1, xt = !0, Et = k & S ? new Nu() : n;
          for (ae.set(g, v), ae.set(v, g); ++et < Ee; ) {
            var Pt = g[et], Qt = v[et];
            if (z)
              var It = ye ? z(Qt, Pt, et, v, g, ae) : z(Pt, Qt, et, g, v, ae);
            if (It !== n) {
              if (It)
                continue;
              xt = !1;
              break;
            }
            if (Et) {
              if (!fl(v, function(cn, yn) {
                if (!pl(Et, yn) && (Pt === cn || K(Pt, cn, k, z, ae)))
                  return Et.push(yn);
              })) {
                xt = !1;
                break;
              }
            } else if (!(Pt === Qt || K(Pt, Qt, k, z, ae))) {
              xt = !1;
              break;
            }
          }
          return ae.delete(g), ae.delete(v), xt;
        }
        function Fx(g, v, k, z, K, ae, ye) {
          switch (k) {
            case bt:
              if (g.byteLength != v.byteLength || g.byteOffset != v.byteOffset)
                return !1;
              g = g.buffer, v = v.buffer;
            case Qe:
              return !(g.byteLength != v.byteLength || !ae(new Rt(g), new Rt(v)));
            case Ie:
            case Re:
            case ht:
              return Ts(+g, +v);
            case dt:
              return g.name == v.name && g.message == v.message;
            case pn:
            case zn:
              return g == v + "";
            case yt:
              var Ee = li;
            case Ht:
              var Ne = z & w;
              if (Ee || (Ee = Cu), g.size != v.size && !Ne)
                return !1;
              var We = ye.get(g);
              if (We)
                return We == v;
              z |= S, ye.set(g, v);
              var Ze = mf(Ee(g), Ee(v), z, K, ae, ye);
              return ye.delete(g), Ze;
            case nn:
              if (jc)
                return jc.call(g) == jc.call(v);
          }
          return !1;
        }
        function zg(g, v, k, z, K, ae) {
          var ye = k & w, Ee = cp(g), Ne = Ee.length, We = cp(v), Ze = We.length;
          if (Ne != Ze && !ye)
            return !1;
          for (var et = Ne; et--; ) {
            var xt = Ee[et];
            if (!(ye ? xt in v : He.call(v, xt)))
              return !1;
          }
          var Et = ae.get(g), Pt = ae.get(v);
          if (Et && Pt)
            return Et == v && Pt == g;
          var Qt = !0;
          ae.set(g, v), ae.set(v, g);
          for (var It = ye; ++et < Ne; ) {
            xt = Ee[et];
            var cn = g[xt], yn = v[xt];
            if (z)
              var Oa = ye ? z(yn, cn, xt, v, g, ae) : z(cn, yn, xt, g, v, ae);
            if (!(Oa === n ? cn === yn || K(cn, yn, k, z, ae) : Oa)) {
              Qt = !1;
              break;
            }
            It || (It = xt == "constructor");
          }
          if (Qt && !It) {
            var Ns = g.constructor, Da = v.constructor;
            Ns != Da && "constructor" in g && "constructor" in v && !(typeof Ns == "function" && Ns instanceof Ns && typeof Da == "function" && Da instanceof Da) && (Qt = !1);
          }
          return ae.delete(g), ae.delete(v), Qt;
        }
        function eo(g) {
          return yp(Fg(g, n, Xn), g + "");
        }
        function cp(g) {
          return dg(g, Xr, fp);
        }
        function Pg(g) {
          return dg(g, rs, vf);
        }
        var gf = Dr ? function(g) {
          return Dr.get(g);
        } : p;
        function ur(g) {
          for (var v = g.name + "", k = En[v], z = He.call(En, v) ? k.length : 0; z--; ) {
            var K = k[z], ae = K.func;
            if (ae == null || ae == g)
              return K.name;
          }
          return v;
        }
        function mr(g) {
          var v = He.call(re, "placeholder") ? re : g;
          return v.placeholder;
        }
        function Nt() {
          var g = re.iteratee || Kf;
          return g = g === Kf ? Ic : g, arguments.length ? g(arguments[0], arguments[1]) : g;
        }
        function yf(g, v) {
          var k = g.__data__;
          return mp(v) ? k[typeof v == "string" ? "string" : "hash"] : k.map;
        }
        function dp(g) {
          for (var v = Xr(g), k = v.length; k--; ) {
            var z = v[k], K = g[z];
            v[k] = [z, K, to(K)];
          }
          return v;
        }
        function Rl(g, v) {
          var k = Eu(g, v);
          return rf(k) ? k : n;
        }
        function xf(g) {
          var v = He.call(g, ko), k = g[ko];
          try {
            g[ko] = n;
            var z = !0;
          } catch {
          }
          var K = tt.call(g);
          return z && (v ? g[ko] = k : delete g[ko]), K;
        }
        var fp = Wd ? function(g) {
          return g == null ? [] : (g = we(g), Yn(Wd(g), function(v) {
            return Cr.call(g, v);
          }));
        } : Ke, vf = Wd ? function(g) {
          for (var v = []; g; )
            ms(v, fp(g)), g = Ln(g);
          return v;
        } : Ke, hi = fi;
        (Js && hi(new Js(new ArrayBuffer(1))) != bt || xs && hi(new xs()) != yt || qh && hi(qh.resolve()) != gt || vl && hi(new vl()) != Ht || Tu && hi(new Tu()) != Nn) && (hi = function(g) {
          var v = fi(g), k = v == Ye ? g.constructor : n, z = k ? ji(k) : "";
          if (z)
            switch (z) {
              case un:
                return bt;
              case bl:
                return yt;
              case ea:
                return gt;
              case sg:
                return Ht;
              case wl:
                return Nn;
            }
          return v;
        });
        function Xw(g, v, k) {
          for (var z = -1, K = k.length; ++z < K; ) {
            var ae = k[z], ye = ae.size;
            switch (ae.type) {
              case "drop":
                g += ye;
                break;
              case "dropRight":
                v -= ye;
                break;
              case "take":
                v = Or(v, g + ye);
                break;
              case "takeRight":
                g = hr(g, v - ye);
                break;
            }
          }
          return { start: g, end: v };
        }
        function hp(g) {
          var v = g.match(ho);
          return v ? v[1].split(po) : [];
        }
        function pp(g, v, k) {
          v = Ss(v, g);
          for (var z = -1, K = v.length, ae = !1; ++z < K; ) {
            var ye = Zi(v[z]);
            if (!(ae = g != null && k(g, ye)))
              break;
            g = g[ye];
          }
          return ae || ++z != K ? ae : (K = g == null ? 0 : g.length, !!K && Rp(K) && Aa(ye, K) && (Ft(g) || Bu(g)));
        }
        function Ux(g) {
          var v = g.length, k = new g.constructor(v);
          return v && typeof g[0] == "string" && He.call(g, "index") && (k.index = g.index, k.input = g.input), k;
        }
        function Ig(g) {
          return typeof g.constructor == "function" && !Vc(g) ? _l(Ln(g)) : {};
        }
        function Hx(g, v, k) {
          var z = g.constructor;
          switch (v) {
            case Qe:
              return uf(g);
            case Ie:
            case Re:
              return new z(+g);
            case bt:
              return Ww(g, k);
            case jt:
            case $t:
            case Un:
            case Hn:
            case on:
            case Jt:
            case fn:
            case nt:
            case er:
              return Eg(g, k);
            case yt:
              return new z();
            case ht:
            case zn:
              return new z(g);
            case pn:
              return Dx(g);
            case Ht:
              return new z();
            case nn:
              return zx(g);
          }
        }
        function Lg(g, v) {
          var k = v.length;
          if (!k)
            return g;
          var z = k - 1;
          return v[z] = (k > 1 ? "& " : "") + v[z], v = v.join(k > 2 ? ", " : " "), g.replace(Fa, `{
/* [wrapped with ` + v + `] */
`);
        }
        function Bg(g) {
          return Ft(g) || Bu(g) || !!(Sc && g && g[Sc]);
        }
        function Aa(g, v) {
          var k = typeof g;
          return v = v ?? pe, !!v && (k == "number" || k != "symbol" && ol.test(g)) && g > -1 && g % 1 == 0 && g < v;
        }
        function Ti(g, v, k) {
          if (!rr(k))
            return !1;
          var z = typeof v;
          return (z == "number" ? ts(k) && Aa(v, k.length) : z == "string" && v in k) ? Ts(k[v], g) : !1;
        }
        function bf(g, v) {
          if (Ft(g))
            return !1;
          var k = typeof g;
          return k == "number" || k == "symbol" || k == "boolean" || g == null || ns(g) ? !0 : Ui.test(g) || !Ls.test(g) || v != null && g in we(v);
        }
        function mp(g) {
          var v = typeof g;
          return v == "string" || v == "number" || v == "symbol" || v == "boolean" ? g !== "__proto__" : g === null;
        }
        function wf(g) {
          var v = ur(g), k = re[v];
          if (typeof k != "function" || !(v in Gt.prototype))
            return !1;
          if (g === k)
            return !0;
          var z = gf(k);
          return !!z && g === z[0];
        }
        function Vx(g) {
          return !!ct && ct in g;
        }
        var $g = rt ? js : Pe;
        function Vc(g) {
          var v = g && g.constructor, k = typeof v == "function" && v.prototype || Ve;
          return g === k;
        }
        function to(g) {
          return g === g && !rr(g);
        }
        function gp(g, v) {
          return function(k) {
            return k == null ? !1 : k[g] === v && (v !== n || g in we(k));
          };
        }
        function Qw(g) {
          var v = zf(g, function(z) {
            return k.size === f && k.clear(), z;
          }), k = v.cache;
          return v;
        }
        function Gx(g, v) {
          var k = g[1], z = v[1], K = k | z, ae = K < (C | T | q), ye = z == q && k == N || z == q && k == Y && g[7].length <= v[8] || z == (q | Y) && v[7].length <= v[8] && k == N;
          if (!(ae || ye))
            return g;
          z & C && (g[2] = v[2], K |= k & C ? 0 : R);
          var Ee = v[3];
          if (Ee) {
            var Ne = g[3];
            g[3] = Ne ? sp(Ne, Ee, v[4]) : Ee, g[4] = Ne ? gs(g[3], h) : v[4];
          }
          return Ee = v[5], Ee && (Ne = g[5], g[5] = Ne ? kg(Ne, Ee, v[6]) : Ee, g[6] = Ne ? gs(g[5], h) : v[6]), Ee = v[7], Ee && (g[7] = Ee), z & q && (g[8] = g[8] == null ? v[8] : Or(g[8], v[8])), g[9] == null && (g[9] = v[9]), g[0] = v[0], g[1] = K, g;
        }
        function Oo(g) {
          var v = [];
          if (g != null)
            for (var k in we(g))
              v.push(k);
          return v;
        }
        function qg(g) {
          return tt.call(g);
        }
        function Fg(g, v, k) {
          return v = hr(v === n ? g.length - 1 : v, 0), function() {
            for (var z = arguments, K = -1, ae = hr(z.length - v, 0), ye = ie(ae); ++K < ae; )
              ye[K] = z[v + K];
            K = -1;
            for (var Ee = ie(v + 1); ++K < v; )
              Ee[K] = z[K];
            return Ee[v] = k(ye), Mr(g, this, Ee);
          };
        }
        function _f(g, v) {
          return v.length < 2 ? g : Ja(g, _s(v, 0, -1));
        }
        function Sf(g, v) {
          for (var k = g.length, z = Or(v.length, k), K = Pi(g); z--; ) {
            var ae = v[z];
            g[z] = Aa(ae, k) ? K[ae] : n;
          }
          return g;
        }
        function Bn(g, v) {
          if (!(v === "constructor" && typeof g[v] == "function") && v != "__proto__")
            return g[v];
        }
        var Kx = Do(yg), Ef = ku || function(g, v) {
          return lr.setTimeout(g, v);
        }, yp = Do(Ax);
        function Gc(g, v, k) {
          var z = v + "";
          return yp(g, Lg(z, Yx(hp(z), k)));
        }
        function Do(g) {
          var v = 0, k = 0;
          return function() {
            var z = Xs(), K = le - (z - k);
            if (k = z, K > 0) {
              if (++v >= G)
                return arguments[0];
            } else
              v = 0;
            return g.apply(n, arguments);
          };
        }
        function Cf(g, v) {
          var k = -1, z = g.length, K = z - 1;
          for (v = v === n ? z : v; ++k < v; ) {
            var ae = $c(k, K), ye = g[ae];
            g[ae] = g[k], g[k] = ye;
          }
          return g.length = v, g;
        }
        var Ug = Qw(function(g) {
          var v = [];
          return g.charCodeAt(0) === 46 && v.push(""), g.replace(du, function(k, z, K, ae) {
            v.push(K ? ae.replace(ar, "$1") : z || k);
          }), v;
        });
        function Zi(g) {
          if (typeof g == "string" || ns(g))
            return g;
          var v = g + "";
          return v == "0" && 1 / g == -ce ? "-0" : v;
        }
        function ji(g) {
          if (g != null) {
            try {
              return ut.call(g);
            } catch {
            }
            try {
              return g + "";
            } catch {
            }
          }
          return "";
        }
        function Yx(g, v) {
          return ai(fe, function(k) {
            var z = "_." + k[0];
            v & k[1] && !Ka(g, z) && g.push(z);
          }), g.sort();
        }
        function xp(g) {
          if (g instanceof Gt)
            return g.clone();
          var v = new Ki(g.__wrapped__, g.__chain__);
          return v.__actions__ = Pi(g.__actions__), v.__index__ = g.__index__, v.__values__ = g.__values__, v;
        }
        function Wx(g, v, k) {
          (k ? Ti(g, v, k) : v === n) ? v = 1 : v = hr(zt(v), 0);
          var z = g == null ? 0 : g.length;
          if (!z || v < 1)
            return [];
          for (var K = 0, ae = 0, ye = ie(Ec(z / v)); K < z; )
            ye[ae++] = _s(g, K, K += v);
          return ye;
        }
        function Hg(g) {
          for (var v = -1, k = g == null ? 0 : g.length, z = 0, K = []; ++v < k; ) {
            var ae = g[v];
            ae && (K[z++] = ae);
          }
          return K;
        }
        function Vg() {
          var g = arguments.length;
          if (!g)
            return [];
          for (var v = ie(g - 1), k = arguments[0], z = g; z--; )
            v[z - 1] = arguments[z];
          return ms(Ft(k) ? Pi(k) : [k], qr(v, 1));
        }
        var vp = Yt(function(g, v) {
          return jr(g) ? ra(g, qr(v, 1, jr, !0)) : [];
        }), Zx = Yt(function(g, v) {
          var k = Qn(v);
          return jr(k) && (k = n), jr(g) ? ra(g, qr(v, 1, jr, !0), Nt(k, 2)) : [];
        }), zo = Yt(function(g, v) {
          var k = Qn(v);
          return jr(k) && (k = n), jr(g) ? ra(g, qr(v, 1, jr, !0), n, k) : [];
        });
        function Pr(g, v, k) {
          var z = g == null ? 0 : g.length;
          return z ? (v = k || v === n ? 1 : zt(v), _s(g, v < 0 ? 0 : v, z)) : [];
        }
        function Gg(g, v, k) {
          var z = g == null ? 0 : g.length;
          return z ? (v = k || v === n ? 1 : zt(v), v = z - v, _s(g, 0, v < 0 ? 0 : v)) : [];
        }
        function Xx(g, v) {
          return g && g.length ? of(g, Nt(v, 3), !0, !0) : [];
        }
        function Zr(g, v) {
          return g && g.length ? of(g, Nt(v, 3), !0) : [];
        }
        function Jw(g, v, k, z) {
          var K = g == null ? 0 : g.length;
          return K ? (k && typeof k != "number" && Ti(g, v, k) && (k = 0, z = K), ef(g, v, k, z)) : [];
        }
        function Kg(g, v, k) {
          var z = g == null ? 0 : g.length;
          if (!z)
            return -1;
          var K = k == null ? 0 : zt(k);
          return K < 0 && (K = hr(z + K, 0)), Eo(g, Nt(v, 3), K);
        }
        function Yg(g, v, k) {
          var z = g == null ? 0 : g.length;
          if (!z)
            return -1;
          var K = z - 1;
          return k !== n && (K = zt(k), K = k < 0 ? hr(z + K, 0) : Or(K, z - 1)), Eo(g, Nt(v, 3), K, !0);
        }
        function Xn(g) {
          var v = g == null ? 0 : g.length;
          return v ? qr(g, 1) : [];
        }
        function Xi(g) {
          var v = g == null ? 0 : g.length;
          return v ? qr(g, ce) : [];
        }
        function Po(g, v) {
          var k = g == null ? 0 : g.length;
          return k ? (v = v === n ? 1 : zt(v), qr(g, v)) : [];
        }
        function Qx(g) {
          for (var v = -1, k = g == null ? 0 : g.length, z = {}; ++v < k; ) {
            var K = g[v];
            z[K[0]] = K[1];
          }
          return z;
        }
        function Wg(g) {
          return g && g.length ? g[0] : n;
        }
        function Jx(g, v, k) {
          var z = g == null ? 0 : g.length;
          if (!z)
            return -1;
          var K = k == null ? 0 : zt(k);
          return K < 0 && (K = hr(z + K, 0)), Ya(g, v, K);
        }
        function e2(g) {
          var v = g == null ? 0 : g.length;
          return v ? _s(g, 0, -1) : [];
        }
        var bp = Yt(function(g) {
          var v = In(g, _g);
          return v.length && v[0] === g[0] ? nf(v) : [];
        }), Qi = Yt(function(g) {
          var v = Qn(g), k = In(g, _g);
          return v === Qn(k) ? v = n : k.pop(), k.length && k[0] === g[0] ? nf(k, Nt(v, 2)) : [];
        }), Na = Yt(function(g) {
          var v = Qn(g), k = In(g, _g);
          return v = typeof v == "function" ? v : n, v && k.pop(), k.length && k[0] === g[0] ? nf(k, n, v) : [];
        });
        function ev(g, v) {
          return g == null ? "" : Cc.call(g, v);
        }
        function Qn(g) {
          var v = g == null ? 0 : g.length;
          return v ? g[v - 1] : n;
        }
        function tv(g, v, k) {
          var z = g == null ? 0 : g.length;
          if (!z)
            return -1;
          var K = z;
          return k !== n && (K = zt(k), K = K < 0 ? hr(z + K, 0) : Or(K, z - 1)), v === v ? yl(g, v, K) : Eo(g, Lh, K, !0);
        }
        function Io(g, v) {
          return g && g.length ? ep(g, zt(v)) : n;
        }
        var zu = Yt(no);
        function no(g, v) {
          return g && g.length && v && v.length ? Lc(g, v) : g;
        }
        function Zg(g, v, k) {
          return g && g.length && v && v.length ? Lc(g, v, Nt(k, 2)) : g;
        }
        function Xg(g, v, k) {
          return g && g.length && v && v.length ? Lc(g, v, n, k) : g;
        }
        var Ra = eo(function(g, v) {
          var k = g == null ? 0 : g.length, z = Dc(g, v);
          return Bc(g, In(v, function(K) {
            return Aa(K, k) ? +K : K;
          }).sort(Cg)), z;
        });
        function nv(g, v) {
          var k = [];
          if (!(g && g.length))
            return k;
          var z = -1, K = [], ae = g.length;
          for (v = Nt(v, 3); ++z < ae; ) {
            var ye = g[z];
            v(ye, z, g) && (k.push(ye), K.push(z));
          }
          return Bc(g, K), k;
        }
        function Ml(g) {
          return g == null ? g : Za.call(g);
        }
        function kf(g, v, k) {
          var z = g == null ? 0 : g.length;
          return z ? (k && typeof k != "number" && Ti(g, v, k) ? (v = 0, k = z) : (v = v == null ? 0 : zt(v), k = k === n ? z : zt(k)), _s(g, v, k)) : [];
        }
        function Tf(g, v) {
          return Fc(g, v);
        }
        function Kc(g, v, k) {
          return np(g, v, Nt(k, 2));
        }
        function rv(g, v) {
          var k = g == null ? 0 : g.length;
          if (k) {
            var z = Fc(g, v);
            if (z < k && Ts(g[z], v))
              return z;
          }
          return -1;
        }
        function iv(g, v) {
          return Fc(g, v, !0);
        }
        function jf(g, v, k) {
          return np(g, v, Nt(k, 2), !0);
        }
        function sv(g, v) {
          var k = g == null ? 0 : g.length;
          if (k) {
            var z = Fc(g, v, !0) - 1;
            if (Ts(g[z], v))
              return z;
          }
          return -1;
        }
        function wp(g) {
          return g && g.length ? Mx(g) : [];
        }
        function av(g, v) {
          return g && g.length ? Mx(g, Nt(v, 2)) : [];
        }
        function t2(g) {
          var v = g == null ? 0 : g.length;
          return v ? _s(g, 1, v) : [];
        }
        function n2(g, v, k) {
          return g && g.length ? (v = k || v === n ? 1 : zt(v), _s(g, 0, v < 0 ? 0 : v)) : [];
        }
        function Sn(g, v, k) {
          var z = g == null ? 0 : g.length;
          return z ? (v = k || v === n ? 1 : zt(v), v = z - v, _s(g, v < 0 ? 0 : v, z)) : [];
        }
        function $n(g, v) {
          return g && g.length ? of(g, Nt(v, 3), !1, !0) : [];
        }
        function en(g, v) {
          return g && g.length ? of(g, Nt(v, 3)) : [];
        }
        var sn = Yt(function(g) {
          return Mo(qr(g, 1, jr, !0));
        }), jn = Yt(function(g) {
          var v = Qn(g);
          return jr(v) && (v = n), Mo(qr(g, 1, jr, !0), Nt(v, 2));
        }), Es = Yt(function(g) {
          var v = Qn(g);
          return v = typeof v == "function" ? v : n, Mo(qr(g, 1, jr, !0), n, v);
        });
        function Ol(g) {
          return g && g.length ? Mo(g) : [];
        }
        function Yc(g, v) {
          return g && g.length ? Mo(g, Nt(v, 2)) : [];
        }
        function Qg(g, v) {
          return v = typeof v == "function" ? v : n, g && g.length ? Mo(g, n, v) : [];
        }
        function Ma(g) {
          if (!(g && g.length))
            return [];
          var v = 0;
          return g = Yn(g, function(k) {
            if (jr(k))
              return v = hr(k.length, v), !0;
          }), wu(v, function(k) {
            return In(g, Ws(k));
          });
        }
        function cr(g, v) {
          if (!(g && g.length))
            return [];
          var k = Ma(g);
          return v == null ? k : In(k, function(z) {
            return Mr(v, n, z);
          });
        }
        var Dl = Yt(function(g, v) {
          return jr(g) ? ra(g, v) : [];
        }), Pu = Yt(function(g) {
          return rp(Yn(g, jr));
        }), Jg = Yt(function(g) {
          var v = Qn(g);
          return jr(v) && (v = n), rp(Yn(g, jr), Nt(v, 2));
        }), Cs = Yt(function(g) {
          var v = Qn(g);
          return v = typeof v == "function" ? v : n, rp(Yn(g, jr), n, v);
        }), Wc = Yt(Ma);
        function Af(g, v) {
          return wg(g || [], v || [], Sa);
        }
        function Ji(g, v) {
          return wg(g || [], v || [], qc);
        }
        var e0 = Yt(function(g) {
          var v = g.length, k = v > 1 ? g[v - 1] : n;
          return k = typeof k == "function" ? (g.pop(), k) : n, cr(g, k);
        });
        function Nf(g) {
          var v = re(g);
          return v.__chain__ = !0, v;
        }
        function ov(g, v) {
          return v(g), g;
        }
        function Iu(g, v) {
          return v(g);
        }
        var _p = eo(function(g) {
          var v = g.length, k = v ? g[0] : 0, z = this.__wrapped__, K = function(ae) {
            return Dc(ae, g);
          };
          return v > 1 || this.__actions__.length || !(z instanceof Gt) || !Aa(k) ? this.thru(K) : (z = z.slice(k, +k + (v ? 1 : 0)), z.__actions__.push({
            func: Iu,
            args: [K],
            thisArg: n
          }), new Ki(z, this.__chain__).thru(function(ae) {
            return v && !ae.length && ae.push(n), ae;
          }));
        });
        function zl() {
          return Nf(this);
        }
        function Fr() {
          return new Ki(this.value(), this.__chain__);
        }
        function Pl() {
          this.__values__ === n && (this.__values__ = Rv(this.value()));
          var g = this.__index__ >= this.__values__.length, v = g ? n : this.__values__[this.__index__++];
          return { done: g, value: v };
        }
        function Zc() {
          return this;
        }
        function Lo(g) {
          for (var v, k = this; k instanceof Sl; ) {
            var z = xp(k);
            z.__index__ = 0, z.__values__ = n, v ? K.__wrapped__ = z : v = z;
            var K = z;
            k = k.__wrapped__;
          }
          return K.__wrapped__ = g, v;
        }
        function t0() {
          var g = this.__wrapped__;
          if (g instanceof Gt) {
            var v = g;
            return this.__actions__.length && (v = new Gt(this)), v = v.reverse(), v.__actions__.push({
              func: Iu,
              args: [Ml],
              thisArg: n
            }), new Ki(v, this.__chain__);
          }
          return this.thru(Ml);
        }
        function n0() {
          return bg(this.__wrapped__, this.__actions__);
        }
        var lv = ap(function(g, v, k) {
          He.call(g, k) ? ++g[k] : vs(g, k, 1);
        });
        function Rf(g, v, k) {
          var z = Ft(g) ? gc : kl;
          return k && Ti(g, v, k) && (v = n), z(g, Nt(v, 3));
        }
        function r0(g, v) {
          var k = Ft(g) ? Yn : Yh;
          return k(g, Nt(v, 3));
        }
        var ks = Rg(Kg), uv = Rg(Yg);
        function es(g, v) {
          return qr(Mf(g, v), 1);
        }
        function cv(g, v) {
          return qr(Mf(g, v), ce);
        }
        function dv(g, v, k) {
          return k = k === n ? 1 : zt(k), qr(Mf(g, v), k);
        }
        function fv(g, v) {
          var k = Ft(g) ? ai : Qa;
          return k(g, Nt(v, 3));
        }
        function Bo(g, v) {
          var k = Ft(g) ? $d : Kh;
          return k(g, Nt(v, 3));
        }
        var Sp = ap(function(g, v, k) {
          He.call(g, k) ? g[k].push(v) : vs(g, k, [v]);
        });
        function i0(g, v, k, z) {
          g = ts(g) ? g : sd(g), k = k && !z ? zt(k) : 0;
          var K = g.length;
          return k < 0 && (k = hr(K + k, 0)), Ff(g) ? k <= K && g.indexOf(v, k) > -1 : !!K && Ya(g, v, k) > -1;
        }
        var Xc = Yt(function(g, v, k) {
          var z = -1, K = typeof v == "function", ae = ts(g) ? ie(g.length) : [];
          return Qa(g, function(ye) {
            ae[++z] = K ? Mr(v, ye, k) : sa(ye, v, k);
          }), ae;
        }), hv = ap(function(g, v, k) {
          vs(g, k, v);
        });
        function Mf(g, v) {
          var k = Ft(g) ? In : Qh;
          return k(g, Nt(v, 3));
        }
        function pv(g, v, k, z) {
          return g == null ? [] : (Ft(v) || (v = v == null ? [] : [v]), k = z ? n : k, Ft(k) || (k = k == null ? [] : [k]), tp(g, v, k));
        }
        var mv = ap(function(g, v, k) {
          g[k ? 0 : 1].push(v);
        }, function() {
          return [[], []];
        });
        function Ep(g, v, k) {
          var z = Ft(g) ? yc : bu, K = arguments.length < 3;
          return z(g, Nt(v, 4), k, K, Qa);
        }
        function s0(g, v, k) {
          var z = Ft(g) ? qd : bu, K = arguments.length < 3;
          return z(g, Nt(v, 4), k, K, Kh);
        }
        function r2(g, v) {
          var k = Ft(g) ? Yn : Yh;
          return k(g, Tp(Nt(v, 3)));
        }
        function i2(g) {
          var v = Ft(g) ? Jd : mg;
          return v(g);
        }
        function s2(g, v, k) {
          (k ? Ti(g, v, k) : v === n) ? v = 1 : v = zt(v);
          var z = Ft(g) ? Vh : gg;
          return z(g, v);
        }
        function gv(g) {
          var v = Ft(g) ? Cx : Nx;
          return v(g);
        }
        function yv(g) {
          if (g == null)
            return 0;
          if (ts(g))
            return Ff(g) ? Di(g) : g.length;
          var v = hi(g);
          return v == yt || v == Ht ? g.size : jl(g).length;
        }
        function Qc(g, v, k) {
          var z = Ft(g) ? fl : Rx;
          return k && Ti(g, v, k) && (v = n), z(g, Nt(v, 3));
        }
        var Cp = Yt(function(g, v) {
          if (g == null)
            return [];
          var k = v.length;
          return k > 1 && Ti(g, v[0], v[1]) ? v = [] : k > 2 && Ti(v[0], v[1], v[2]) && (v = [v[0]]), tp(g, qr(v, 1), []);
        }), Of = $h || function() {
          return lr.Date.now();
        };
        function xv(g, v) {
          if (typeof v != "function")
            throw new Ae(a);
          return g = zt(g), function() {
            if (--g < 1)
              return v.apply(this, arguments);
          };
        }
        function a0(g, v, k) {
          return v = k ? n : v, v = g && v == null ? g.length : v, Ii(g, q, n, n, n, n, v);
        }
        function o0(g, v) {
          var k;
          if (typeof v != "function")
            throw new Ae(a);
          return g = zt(g), function() {
            return --g > 0 && (k = v.apply(this, arguments)), g <= 1 && (v = n), k;
          };
        }
        var kp = Yt(function(g, v, k) {
          var z = C;
          if (k.length) {
            var K = gs(k, mr(kp));
            z |= P;
          }
          return Ii(g, z, v, k, K);
        }), l0 = Yt(function(g, v, k) {
          var z = C | T;
          if (k.length) {
            var K = gs(k, mr(l0));
            z |= P;
          }
          return Ii(v, z, g, k, K);
        });
        function Df(g, v, k) {
          v = k ? n : v;
          var z = Ii(g, N, n, n, n, n, n, v);
          return z.placeholder = Df.placeholder, z;
        }
        function u0(g, v, k) {
          v = k ? n : v;
          var z = Ii(g, M, n, n, n, n, n, v);
          return z.placeholder = u0.placeholder, z;
        }
        function c0(g, v, k) {
          var z, K, ae, ye, Ee, Ne, We = 0, Ze = !1, et = !1, xt = !0;
          if (typeof g != "function")
            throw new Ae(a);
          v = As(v) || 0, rr(k) && (Ze = !!k.leading, et = "maxWait" in k, ae = et ? hr(As(k.maxWait) || 0, v) : ae, xt = "trailing" in k ? !!k.trailing : xt);
          function Et(Ur) {
            var Fo = z, qu = K;
            return z = K = n, We = Ur, ye = g.apply(qu, Fo), ye;
          }
          function Pt(Ur) {
            return We = Ur, Ee = Ef(cn, v), Ze ? Et(Ur) : ye;
          }
          function Qt(Ur) {
            var Fo = Ur - Ne, qu = Ur - We, eA = v - Fo;
            return et ? Or(eA, ae - qu) : eA;
          }
          function It(Ur) {
            var Fo = Ur - Ne, qu = Ur - We;
            return Ne === n || Fo >= v || Fo < 0 || et && qu >= ae;
          }
          function cn() {
            var Ur = Of();
            if (It(Ur))
              return yn(Ur);
            Ee = Ef(cn, Qt(Ur));
          }
          function yn(Ur) {
            return Ee = n, xt && z ? Et(Ur) : (z = K = n, ye);
          }
          function Oa() {
            Ee !== n && lf(Ee), We = 0, z = Ne = K = Ee = n;
          }
          function Ns() {
            return Ee === n ? ye : yn(Of());
          }
          function Da() {
            var Ur = Of(), Fo = It(Ur);
            if (z = arguments, K = this, Ne = Ur, Fo) {
              if (Ee === n)
                return Pt(Ne);
              if (et)
                return lf(Ee), Ee = Ef(cn, v), Et(Ne);
            }
            return Ee === n && (Ee = Ef(cn, v)), ye;
          }
          return Da.cancel = Oa, Da.flush = Ns, Da;
        }
        var An = Yt(function(g, v) {
          return cg(g, 1, v);
        }), d0 = Yt(function(g, v, k) {
          return cg(g, As(v) || 0, k);
        });
        function a2(g) {
          return Ii(g, te);
        }
        function zf(g, v) {
          if (typeof g != "function" || v != null && typeof v != "function")
            throw new Ae(a);
          var k = function() {
            var z = arguments, K = v ? v.apply(this, z) : z[0], ae = k.cache;
            if (ae.has(K))
              return ae.get(K);
            var ye = g.apply(this, z);
            return k.cache = ae.set(K, ye) || ae, ye;
          };
          return k.cache = new (zf.Cache || _a)(), k;
        }
        zf.Cache = _a;
        function Tp(g) {
          if (typeof g != "function")
            throw new Ae(a);
          return function() {
            var v = arguments;
            switch (v.length) {
              case 0:
                return !g.call(this);
              case 1:
                return !g.call(this, v[0]);
              case 2:
                return !g.call(this, v[0], v[1]);
              case 3:
                return !g.call(this, v[0], v[1], v[2]);
            }
            return !g.apply(this, v);
          };
        }
        function o2(g) {
          return o0(2, g);
        }
        var l2 = Ox(function(g, v) {
          v = v.length == 1 && Ft(v[0]) ? In(v[0], Ci(Nt())) : In(qr(v, 1), Ci(Nt()));
          var k = v.length;
          return Yt(function(z) {
            for (var K = -1, ae = Or(z.length, k); ++K < ae; )
              z[K] = v[K].call(this, z[K]);
            return Mr(g, this, z);
          });
        }), Jc = Yt(function(g, v) {
          var k = gs(v, mr(Jc));
          return Ii(g, P, n, v, k);
        }), Lu = Yt(function(g, v) {
          var k = gs(v, mr(Lu));
          return Ii(g, D, n, v, k);
        }), f0 = eo(function(g, v) {
          return Ii(g, Y, n, n, n, v);
        });
        function jp(g, v) {
          if (typeof g != "function")
            throw new Ae(a);
          return v = v === n ? v : zt(v), Yt(g, v);
        }
        function h0(g, v) {
          if (typeof g != "function")
            throw new Ae(a);
          return v = v == null ? 0 : hr(zt(v), 0), Yt(function(k) {
            var z = k[v], K = ja(k, 0, v);
            return z && ms(K, z), Mr(g, this, K);
          });
        }
        function Il(g, v, k) {
          var z = !0, K = !0;
          if (typeof g != "function")
            throw new Ae(a);
          return rr(k) && (z = "leading" in k ? !!k.leading : z, K = "trailing" in k ? !!k.trailing : K), c0(g, v, {
            leading: z,
            maxWait: v,
            trailing: K
          });
        }
        function ro(g) {
          return a0(g, 1);
        }
        function Pf(g, v) {
          return Jc(ip(v), g);
        }
        function u2() {
          if (!arguments.length)
            return [];
          var g = arguments[0];
          return Ft(g) ? g : [g];
        }
        function vv(g) {
          return zi(g, b);
        }
        function bv(g, v) {
          return v = typeof v == "function" ? v : n, zi(g, b, v);
        }
        function wv(g) {
          return zi(g, m | b);
        }
        function _v(g, v) {
          return v = typeof v == "function" ? v : n, zi(g, m | b, v);
        }
        function c2(g, v) {
          return v == null || Cl(g, v, Xr(v));
        }
        function Ts(g, v) {
          return g === v || g !== g && v !== v;
        }
        var Sv = hf(tf), Ev = hf(function(g, v) {
          return g >= v;
        }), Bu = Yi(/* @__PURE__ */ (function() {
          return arguments;
        })()) ? Yi : function(g) {
          return gr(g) && He.call(g, "callee") && !Cr.call(g, "callee");
        }, Ft = ie.isArray, p0 = Id ? Ci(Id) : kr;
        function ts(g) {
          return g != null && Rp(g.length) && !js(g);
        }
        function jr(g) {
          return gr(g) && ts(g);
        }
        function If(g) {
          return g === !0 || g === !1 || gr(g) && fi(g) == Ie;
        }
        var Ll = wx || Pe, Cv = xu ? Ci(xu) : Zh;
        function tn(g) {
          return gr(g) && g.nodeType === 1 && !Bf(g);
        }
        function m0(g) {
          if (g == null)
            return !0;
          if (ts(g) && (Ft(g) || typeof g == "string" || typeof g.splice == "function" || Ll(g) || Bl(g) || Bu(g)))
            return !g.length;
          var v = hi(g);
          if (v == yt || v == Ht)
            return !g.size;
          if (Vc(g))
            return !jl(g).length;
          for (var k in g)
            if (He.call(g, k))
              return !1;
          return !0;
        }
        function Ap(g, v) {
          return ws(g, v);
        }
        function g0(g, v, k) {
          k = typeof k == "function" ? k : n;
          var z = k ? k(g, v) : n;
          return z === n ? ws(g, v, n, k) : !!z;
        }
        function Np(g) {
          if (!gr(g))
            return !1;
          var v = fi(g);
          return v == dt || v == mt || typeof g.message == "string" && typeof g.name == "string" && !Bf(g);
        }
        function y0(g) {
          return typeof g == "number" && ys(g);
        }
        function js(g) {
          if (!rr(g))
            return !1;
          var v = fi(g);
          return v == Je || v == ft || v == Me || v == Dt;
        }
        function Lf(g) {
          return typeof g == "number" && g == zt(g);
        }
        function Rp(g) {
          return typeof g == "number" && g > -1 && g % 1 == 0 && g <= pe;
        }
        function rr(g) {
          var v = typeof g;
          return g != null && (v == "object" || v == "function");
        }
        function gr(g) {
          return g != null && typeof g == "object";
        }
        var kv = _o ? Ci(_o) : Mn;
        function Tv(g, v) {
          return g === v || pr(g, v, dp(v));
        }
        function jv(g, v, k) {
          return k = typeof k == "function" ? k : n, pr(g, v, dp(v), k);
        }
        function On(g) {
          return v0(g) && g != +g;
        }
        function x0(g) {
          if ($g(g))
            throw new he(s);
          return rf(g);
        }
        function pi(g) {
          return g === null;
        }
        function d2(g) {
          return g == null;
        }
        function v0(g) {
          return typeof g == "number" || gr(g) && fi(g) == ht;
        }
        function Bf(g) {
          if (!gr(g) || fi(g) != Ye)
            return !1;
          var v = Ln(g);
          if (v === null)
            return !0;
          var k = He.call(v, "constructor") && v.constructor;
          return typeof k == "function" && k instanceof k && ut.call(k) == vt;
        }
        var $f = vu ? Ci(vu) : Pc;
        function b0(g) {
          return Lf(g) && g >= -pe && g <= pe;
        }
        var qf = Ld ? Ci(Ld) : Ou;
        function Ff(g) {
          return typeof g == "string" || !Ft(g) && gr(g) && fi(g) == zn;
        }
        function ns(g) {
          return typeof g == "symbol" || gr(g) && fi(g) == nn;
        }
        var Bl = Ph ? Ci(Ph) : Xh;
        function w0(g) {
          return g === n;
        }
        function f2(g) {
          return gr(g) && hi(g) == Nn;
        }
        function Av(g) {
          return gr(g) && fi(g) == $e;
        }
        var h2 = hf(nr), Nv = hf(function(g, v) {
          return g <= v;
        });
        function Rv(g) {
          if (!g)
            return [];
          if (ts(g))
            return Ff(g) ? Vn(g) : Pi(g);
          if (ci && g[ci])
            return gl(g[ci]());
          var v = hi(g), k = v == yt ? li : v == Ht ? Cu : sd;
          return k(g);
        }
        function $o(g) {
          if (!g)
            return g === 0 ? g : 0;
          if (g = As(g), g === ce || g === -ce) {
            var v = g < 0 ? -1 : 1;
            return v * de;
          }
          return g === g ? g : 0;
        }
        function zt(g) {
          var v = $o(g), k = v % 1;
          return v === v ? k ? v - k : v : 0;
        }
        function _0(g) {
          return g ? Ea(zt(g), 0, J) : 0;
        }
        function As(g) {
          if (typeof g == "number")
            return g;
          if (ns(g))
            return H;
          if (rr(g)) {
            var v = typeof g.valueOf == "function" ? g.valueOf() : g;
            g = rr(v) ? v + "" : v;
          }
          if (typeof g != "string")
            return g === 0 ? g : +g;
          g = Wa(g);
          var k = qs.test(g);
          return k || Ni.test(g) ? pc(g.slice(2), k ? 2 : 8) : lc.test(g) ? H : +g;
        }
        function Mp(g) {
          return aa(g, rs(g));
        }
        function p2(g) {
          return g ? Ea(zt(g), -pe, pe) : g === 0 ? g : 0;
        }
        function Cn(g) {
          return g == null ? "" : Wi(g);
        }
        var Mv = Al(function(g, v) {
          if (Vc(v) || ts(v)) {
            aa(v, Xr(v), g);
            return;
          }
          for (var k in v)
            He.call(v, k) && Sa(g, k, v[k]);
        }), Op = Al(function(g, v) {
          aa(v, rs(v), g);
        }), ed = Al(function(g, v, k, z) {
          aa(v, rs(v), g, z);
        }), m2 = Al(function(g, v, k, z) {
          aa(v, Xr(v), g, z);
        }), oa = eo(Dc);
        function S0(g, v) {
          var k = _l(g);
          return v == null ? k : ug(k, v);
        }
        var Ov = Yt(function(g, v) {
          g = we(g);
          var k = -1, z = v.length, K = z > 2 ? v[2] : n;
          for (K && Ti(v[0], v[1], K) && (z = 1); ++k < z; )
            for (var ae = v[k], ye = rs(ae), Ee = -1, Ne = ye.length; ++Ee < Ne; ) {
              var We = ye[Ee], Ze = g[We];
              (Ze === n || Ts(Ze, Ve[We]) && !He.call(g, We)) && (g[We] = ae[We]);
            }
          return g;
        }), Dv = Yt(function(g) {
          return g.push(n, Dg), Mr(nd, n, g);
        });
        function zv(g, v) {
          return xc(g, Nt(v, 3), ka);
        }
        function Uf(g, v) {
          return xc(g, Nt(v, 3), Wh);
        }
        function la(g, v) {
          return g == null ? g : Mu(g, Nt(v, 3), rs);
        }
        function Pv(g, v) {
          return g == null ? g : zc(g, Nt(v, 3), rs);
        }
        function Dp(g, v) {
          return g && ka(g, Nt(v, 3));
        }
        function qo(g, v) {
          return g && Wh(g, Nt(v, 3));
        }
        function g2(g) {
          return g == null ? [] : Ro(g, Xr(g));
        }
        function y2(g) {
          return g == null ? [] : Ro(g, rs(g));
        }
        function $l(g, v, k) {
          var z = g == null ? n : Ja(g, v);
          return z === n ? k : z;
        }
        function Iv(g, v) {
          return g != null && pp(g, v, bs);
        }
        function E0(g, v) {
          return g != null && pp(g, v, ia);
        }
        var x2 = df(function(g, v, k) {
          v != null && typeof v.toString != "function" && (v = tt.call(v)), g[v] = k;
        }, od(Li)), v2 = df(function(g, v, k) {
          v != null && typeof v.toString != "function" && (v = tt.call(v)), He.call(g, v) ? g[v].push(k) : g[v] = [k];
        }, Nt), b2 = Yt(sa);
        function Xr(g) {
          return ts(g) ? Hh(g) : jl(g);
        }
        function rs(g) {
          return ts(g) ? Hh(g, !0) : Kw(g);
        }
        function w2(g, v) {
          var k = {};
          return v = Nt(v, 3), ka(g, function(z, K, ae) {
            vs(k, v(z, K, ae), z);
          }), k;
        }
        function Lv(g, v) {
          var k = {};
          return v = Nt(v, 3), ka(g, function(z, K, ae) {
            vs(k, K, v(z, K, ae));
          }), k;
        }
        var td = Al(function(g, v, k) {
          sf(g, v, k);
        }), nd = Al(function(g, v, k, z) {
          sf(g, v, k, z);
        }), Bv = eo(function(g, v) {
          var k = {};
          if (g == null)
            return k;
          var z = !1;
          v = In(v, function(ae) {
            return ae = Ss(ae, g), z || (z = ae.length > 1), ae;
          }), aa(g, Pg(g), k), z && (k = zi(k, m | x | b, qx));
          for (var K = v.length; K--; )
            af(k, v[K]);
          return k;
        });
        function _2(g, v) {
          return id(g, Tp(Nt(v)));
        }
        var rd = eo(function(g, v) {
          return g == null ? {} : hg(g, v);
        });
        function id(g, v) {
          if (g == null)
            return {};
          var k = In(Pg(g), function(z) {
            return [z];
          });
          return v = Nt(v), ki(g, k, function(z, K) {
            return v(z, K[0]);
          });
        }
        function $v(g, v, k) {
          v = Ss(v, g);
          var z = -1, K = v.length;
          for (K || (K = 1, g = n); ++z < K; ) {
            var ae = g == null ? n : g[Zi(v[z])];
            ae === n && (z = K, ae = k), g = js(ae) ? ae.call(g) : ae;
          }
          return g;
        }
        function zp(g, v, k) {
          return g == null ? g : qc(g, v, k);
        }
        function C0(g, v, k, z) {
          return z = typeof z == "function" ? z : n, g == null ? g : qc(g, v, k, z);
        }
        var Pp = Mg(Xr), Hf = Mg(rs);
        function qv(g, v, k) {
          var z = Ft(g), K = z || Ll(g) || Bl(g);
          if (v = Nt(v, 4), k == null) {
            var ae = g && g.constructor;
            K ? k = z ? new ae() : [] : rr(g) ? k = js(ae) ? _l(Ln(g)) : {} : k = {};
          }
          return (K ? ai : ka)(g, function(ye, Ee, Ne) {
            return v(k, ye, Ee, Ne);
          }), k;
        }
        function Fv(g, v) {
          return g == null ? !0 : af(g, v);
        }
        function S2(g, v, k) {
          return g == null ? g : vg(g, v, ip(k));
        }
        function Uv(g, v, k, z) {
          return z = typeof z == "function" ? z : n, g == null ? g : vg(g, v, ip(k), z);
        }
        function sd(g) {
          return g == null ? [] : Vd(g, Xr(g));
        }
        function k0(g) {
          return g == null ? [] : Vd(g, rs(g));
        }
        function E2(g, v, k) {
          return k === n && (k = v, v = n), k !== n && (k = As(k), k = k === k ? k : 0), v !== n && (v = As(v), v = v === v ? v : 0), Ea(As(g), v, k);
        }
        function Ip(g, v, k) {
          return v = $o(v), k === n ? (k = v, v = 0) : k = $o(k), g = As(g), Tl(g, v, k);
        }
        function Lp(g, v, k) {
          if (k && typeof k != "boolean" && Ti(g, v, k) && (v = k = n), k === n && (typeof v == "boolean" ? (k = v, v = n) : typeof g == "boolean" && (k = g, g = n)), g === n && v === n ? (g = 0, v = 1) : (g = $o(g), v === n ? (v = g, g = 0) : v = $o(v)), g > v) {
            var z = g;
            g = v, v = z;
          }
          if (k || g % 1 || v % 1) {
            var K = To();
            return Or(g + K * (v - g + wo("1e-" + ((K + "").length - 1))), v);
          }
          return $c(g, v);
        }
        var Bp = Du(function(g, v, k) {
          return v = v.toLowerCase(), g + (k ? Hv(v) : v);
        });
        function Hv(g) {
          return $u(Cn(g).toLowerCase());
        }
        function ad(g) {
          return g = Cn(g), g && g.replace(Fs, Su).replace(ul, "");
        }
        function C2(g, v, k) {
          g = Cn(g), v = Wi(v);
          var z = g.length;
          k = k === n ? z : Ea(zt(k), 0, z);
          var K = k;
          return k -= v.length, k >= 0 && g.slice(k, K) == v;
        }
        function Vv(g) {
          return g = Cn(g), g && At.test(g) ? g.replace(Is, ig) : g;
        }
        function Gv(g) {
          return g = Cn(g), g && Tn.test(g) ? g.replace(ya, "\\$&") : g;
        }
        var Kv = Du(function(g, v, k) {
          return g + (k ? "-" : "") + v.toLowerCase();
        }), Yv = Du(function(g, v, k) {
          return g + (k ? " " : "") + v.toLowerCase();
        }), T0 = Ng("toLowerCase");
        function Wv(g, v, k) {
          g = Cn(g), v = zt(v);
          var z = v ? Di(g) : 0;
          if (!v || z >= v)
            return g;
          var K = (v - z) / 2;
          return Nl(Yd(K), k) + g + Nl(Ec(K), k);
        }
        function Zv(g, v, k) {
          g = Cn(g), v = zt(v);
          var z = v ? Di(g) : 0;
          return v && z < v ? g + Nl(v - z, k) : g;
        }
        function $p(g, v, k) {
          g = Cn(g), v = zt(v);
          var z = v ? Di(g) : 0;
          return v && z < v ? Nl(v - z, k) + g : g;
        }
        function k2(g, v, k) {
          return k || v == null ? v = 0 : v && (v = +v), Qs(Cn(g).replace(Gn, ""), v || 0);
        }
        function T2(g, v, k) {
          return (k ? Ti(g, v, k) : v === n) ? v = 1 : v = zt(v), Ta(Cn(g), v);
        }
        function j0() {
          var g = arguments, v = Cn(g[0]);
          return g.length < 3 ? v : v.replace(g[1], g[2]);
        }
        var A0 = Du(function(g, v, k) {
          return g + (k ? "_" : "") + v.toLowerCase();
        });
        function qp(g, v, k) {
          return k && typeof k != "number" && Ti(g, v, k) && (v = k = n), k = k === n ? J : k >>> 0, k ? (g = Cn(g), g && (typeof v == "string" || v != null && !$f(v)) && (v = Wi(v), !v && oi(g)) ? ja(Vn(g), 0, k) : g.split(v, k)) : [];
        }
        var N0 = Du(function(g, v, k) {
          return g + (k ? " " : "") + $u(v);
        });
        function Xv(g, v, k) {
          return g = Cn(g), k = k == null ? 0 : Ea(zt(k), 0, g.length), v = Wi(v), g.slice(k, k + v.length) == v;
        }
        function R0(g, v, k) {
          var z = re.templateSettings;
          k && Ti(g, v, k) && (v = n), g = Cn(g), v = ed({}, v, z, Og);
          var K = ed({}, v.imports, z.imports, Og), ae = Xr(K), ye = Vd(K, ae), Ee, Ne, We = 0, Ze = v.interpolate || mn, et = "__p += '", xt = ke(
            (v.escape || mn).source + "|" + Ze.source + "|" + (Ze === cu ? Yr : mn).source + "|" + (v.evaluate || mn).source + "|$",
            "g"
          ), Et = "//# sourceURL=" + (He.call(v, "sourceURL") ? (v.sourceURL + "").replace(/\s/g, " ") : "lodash.templateSources[" + ++hc + "]") + `
`;
          g.replace(xt, function(It, cn, yn, Oa, Ns, Da) {
            return yn || (yn = Oa), et += g.slice(We, Da).replace(wi, _c), cn && (Ee = !0, et += `' +
__e(` + cn + `) +
'`), Ns && (Ne = !0, et += `';
` + Ns + `;
__p += '`), yn && (et += `' +
((__t = (` + yn + `)) == null ? '' : __t) +
'`), We = Da + It.length, It;
          }), et += `';
`;
          var Pt = He.call(v, "variable") && v.variable;
          if (!Pt)
            et = `with (obj) {
` + et + `
}
`;
          else if (Rn.test(Pt))
            throw new he(u);
          et = (Ne ? et.replace(Pn, "") : et).replace(sr, "$1").replace(st, "$1;"), et = "function(" + (Pt || "obj") + `) {
` + (Pt ? "" : `obj || (obj = {});
`) + "var __t, __p = ''" + (Ee ? ", __e = _.escape" : "") + (Ne ? `, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
` : `;
`) + et + `return __p
}`;
          var Qt = M0(function() {
            return _e(ae, Et + "return " + et).apply(n, ye);
          });
          if (Qt.source = et, Np(Qt))
            throw Qt;
          return Qt;
        }
        function ql(g) {
          return Cn(g).toLowerCase();
        }
        function Fl(g) {
          return Cn(g).toUpperCase();
        }
        function Ul(g, v, k) {
          if (g = Cn(g), g && (k || v === n))
            return Wa(g);
          if (!g || !(v = Wi(v)))
            return g;
          var z = Vn(g), K = Vn(v), ae = _u(z, K), ye = wc(z, K) + 1;
          return ja(z, ae, ye).join("");
        }
        function Vf(g, v, k) {
          if (g = Cn(g), g && (k || v === n))
            return g.slice(0, _(g) + 1);
          if (!g || !(v = Wi(v)))
            return g;
          var z = Vn(g), K = wc(z, Vn(v)) + 1;
          return ja(z, 0, K).join("");
        }
        function Gf(g, v, k) {
          if (g = Cn(g), g && (k || v === n))
            return g.replace(Gn, "");
          if (!g || !(v = Wi(v)))
            return g;
          var z = Vn(g), K = _u(z, Vn(v));
          return ja(z, K).join("");
        }
        function Hl(g, v) {
          var k = V, z = $;
          if (rr(v)) {
            var K = "separator" in v ? v.separator : K;
            k = "length" in v ? zt(v.length) : k, z = "omission" in v ? Wi(v.omission) : z;
          }
          g = Cn(g);
          var ae = g.length;
          if (oi(g)) {
            var ye = Vn(g);
            ae = ye.length;
          }
          if (k >= ae)
            return g;
          var Ee = k - Di(z);
          if (Ee < 1)
            return z;
          var Ne = ye ? ja(ye, 0, Ee).join("") : g.slice(0, Ee);
          if (K === n)
            return Ne + z;
          if (ye && (Ee += Ne.length - Ee), $f(K)) {
            if (g.slice(Ee).search(K)) {
              var We, Ze = Ne;
              for (K.global || (K = ke(K.source, Cn($s.exec(K)) + "g")), K.lastIndex = 0; We = K.exec(Ze); )
                var et = We.index;
              Ne = Ne.slice(0, et === n ? Ee : et);
            }
          } else if (g.indexOf(Wi(K), Ee) != Ee) {
            var xt = Ne.lastIndexOf(K);
            xt > -1 && (Ne = Ne.slice(0, xt));
          }
          return Ne + z;
        }
        function j2(g) {
          return g = Cn(g), g && bi.test(g) ? g.replace($r, j) : g;
        }
        var Qv = Du(function(g, v, k) {
          return g + (k ? " " : "") + v.toUpperCase();
        }), $u = Ng("toUpperCase");
        function Jv(g, v, k) {
          return g = Cn(g), v = k ? n : v, v === n ? Wn(g) ? F(g) : Ud(g) : g.match(v) || [];
        }
        var M0 = Yt(function(g, v) {
          try {
            return Mr(g, n, v);
          } catch (k) {
            return Np(k) ? k : new he(k);
          }
        }), Fp = eo(function(g, v) {
          return ai(v, function(k) {
            k = Zi(k), vs(g, k, kp(g[k], g));
          }), g;
        });
        function e1(g) {
          var v = g == null ? 0 : g.length, k = Nt();
          return g = v ? In(g, function(z) {
            if (typeof z[1] != "function")
              throw new Ae(a);
            return [k(z[0]), z[1]];
          }) : [], Yt(function(z) {
            for (var K = -1; ++K < v; ) {
              var ae = g[K];
              if (Mr(ae[0], this, z))
                return Mr(ae[1], this, z);
            }
          });
        }
        function A2(g) {
          return Tx(zi(g, m));
        }
        function od(g) {
          return function() {
            return g;
          };
        }
        function Up(g, v) {
          return g == null || g !== g ? v : g;
        }
        var t1 = Uc(), ld = Uc(!0);
        function Li(g) {
          return g;
        }
        function Kf(g) {
          return Ic(typeof g == "function" ? g : zi(g, m));
        }
        function Hp(g) {
          return Jh(zi(g, m));
        }
        function n1(g, v) {
          return fg(g, zi(v, m));
        }
        var N2 = Yt(function(g, v) {
          return function(k) {
            return sa(k, g, v);
          };
        }), Vp = Yt(function(g, v) {
          return function(k) {
            return sa(g, k, v);
          };
        });
        function o(g, v, k) {
          var z = Xr(v), K = Ro(v, z);
          k == null && !(rr(v) && (K.length || !z.length)) && (k = v, v = g, g = this, K = Ro(v, Xr(v)));
          var ae = !(rr(k) && "chain" in k) || !!k.chain, ye = js(g);
          return ai(K, function(Ee) {
            var Ne = v[Ee];
            g[Ee] = Ne, ye && (g.prototype[Ee] = function() {
              var We = this.__chain__;
              if (ae || We) {
                var Ze = g(this.__wrapped__), et = Ze.__actions__ = Pi(this.__actions__);
                return et.push({ func: Ne, args: arguments, thisArg: g }), Ze.__chain__ = We, Ze;
              }
              return Ne.apply(g, ms([this.value()], arguments));
            });
          }), g;
        }
        function l() {
          return lr._ === this && (lr._ = Ct), this;
        }
        function p() {
        }
        function y(g) {
          return g = zt(g), Yt(function(v) {
            return ep(v, g);
          });
        }
        var E = op(In), A = op(gc), B = op(fl);
        function ne(g) {
          return bf(g) ? Ws(Zi(g)) : Tr(g);
        }
        function xe(g) {
          return function(v) {
            return g == null ? n : Ja(g, v);
          };
        }
        var De = lp(), Ue = lp(!0);
        function Ke() {
          return [];
        }
        function Pe() {
          return !1;
        }
        function Be() {
          return {};
        }
        function _t() {
          return "";
        }
        function Mt() {
          return !0;
        }
        function Dn(g, v) {
          if (g = zt(g), g < 1 || g > pe)
            return [];
          var k = J, z = Or(g, J);
          v = Nt(v), g -= J;
          for (var K = wu(z, v); ++k < g; )
            v(k);
          return K;
        }
        function je(g) {
          return Ft(g) ? In(g, Zi) : ns(g) ? [g] : Pi(Ug(Cn(g)));
        }
        function Ce(g) {
          var v = ++ot;
          return Cn(g) + v;
        }
        var Oe = ff(function(g, v) {
          return g + v;
        }, 0), Ge = pf("ceil"), kt = ff(function(g, v) {
          return g / v;
        }, 1), bn = pf("floor");
        function St(g) {
          return g && g.length ? Ca(g, Li, tf) : n;
        }
        function Zt(g, v) {
          return g && g.length ? Ca(g, Nt(v, 2), tf) : n;
        }
        function an(g) {
          return hl(g, Li);
        }
        function wn(g, v) {
          return hl(g, Nt(v, 2));
        }
        function Vl(g) {
          return g && g.length ? Ca(g, Li, nr) : n;
        }
        function R2(g, v) {
          return g && g.length ? Ca(g, Nt(v, 2), nr) : n;
        }
        var yU = ff(function(g, v) {
          return g * v;
        }, 1), xU = pf("round"), vU = ff(function(g, v) {
          return g - v;
        }, 0);
        function bU(g) {
          return g && g.length ? bc(g, Li) : 0;
        }
        function wU(g, v) {
          return g && g.length ? bc(g, Nt(v, 2)) : 0;
        }
        return re.after = xv, re.ary = a0, re.assign = Mv, re.assignIn = Op, re.assignInWith = ed, re.assignWith = m2, re.at = oa, re.before = o0, re.bind = kp, re.bindAll = Fp, re.bindKey = l0, re.castArray = u2, re.chain = Nf, re.chunk = Wx, re.compact = Hg, re.concat = Vg, re.cond = e1, re.conforms = A2, re.constant = od, re.countBy = lv, re.create = S0, re.curry = Df, re.curryRight = u0, re.debounce = c0, re.defaults = Ov, re.defaultsDeep = Dv, re.defer = An, re.delay = d0, re.difference = vp, re.differenceBy = Zx, re.differenceWith = zo, re.drop = Pr, re.dropRight = Gg, re.dropRightWhile = Xx, re.dropWhile = Zr, re.fill = Jw, re.filter = r0, re.flatMap = es, re.flatMapDeep = cv, re.flatMapDepth = dv, re.flatten = Xn, re.flattenDeep = Xi, re.flattenDepth = Po, re.flip = a2, re.flow = t1, re.flowRight = ld, re.fromPairs = Qx, re.functions = g2, re.functionsIn = y2, re.groupBy = Sp, re.initial = e2, re.intersection = bp, re.intersectionBy = Qi, re.intersectionWith = Na, re.invert = x2, re.invertBy = v2, re.invokeMap = Xc, re.iteratee = Kf, re.keyBy = hv, re.keys = Xr, re.keysIn = rs, re.map = Mf, re.mapKeys = w2, re.mapValues = Lv, re.matches = Hp, re.matchesProperty = n1, re.memoize = zf, re.merge = td, re.mergeWith = nd, re.method = N2, re.methodOf = Vp, re.mixin = o, re.negate = Tp, re.nthArg = y, re.omit = Bv, re.omitBy = _2, re.once = o2, re.orderBy = pv, re.over = E, re.overArgs = l2, re.overEvery = A, re.overSome = B, re.partial = Jc, re.partialRight = Lu, re.partition = mv, re.pick = rd, re.pickBy = id, re.property = ne, re.propertyOf = xe, re.pull = zu, re.pullAll = no, re.pullAllBy = Zg, re.pullAllWith = Xg, re.pullAt = Ra, re.range = De, re.rangeRight = Ue, re.rearg = f0, re.reject = r2, re.remove = nv, re.rest = jp, re.reverse = Ml, re.sampleSize = s2, re.set = zp, re.setWith = C0, re.shuffle = gv, re.slice = kf, re.sortBy = Cp, re.sortedUniq = wp, re.sortedUniqBy = av, re.split = qp, re.spread = h0, re.tail = t2, re.take = n2, re.takeRight = Sn, re.takeRightWhile = $n, re.takeWhile = en, re.tap = ov, re.throttle = Il, re.thru = Iu, re.toArray = Rv, re.toPairs = Pp, re.toPairsIn = Hf, re.toPath = je, re.toPlainObject = Mp, re.transform = qv, re.unary = ro, re.union = sn, re.unionBy = jn, re.unionWith = Es, re.uniq = Ol, re.uniqBy = Yc, re.uniqWith = Qg, re.unset = Fv, re.unzip = Ma, re.unzipWith = cr, re.update = S2, re.updateWith = Uv, re.values = sd, re.valuesIn = k0, re.without = Dl, re.words = Jv, re.wrap = Pf, re.xor = Pu, re.xorBy = Jg, re.xorWith = Cs, re.zip = Wc, re.zipObject = Af, re.zipObjectDeep = Ji, re.zipWith = e0, re.entries = Pp, re.entriesIn = Hf, re.extend = Op, re.extendWith = ed, o(re, re), re.add = Oe, re.attempt = M0, re.camelCase = Bp, re.capitalize = Hv, re.ceil = Ge, re.clamp = E2, re.clone = vv, re.cloneDeep = wv, re.cloneDeepWith = _v, re.cloneWith = bv, re.conformsTo = c2, re.deburr = ad, re.defaultTo = Up, re.divide = kt, re.endsWith = C2, re.eq = Ts, re.escape = Vv, re.escapeRegExp = Gv, re.every = Rf, re.find = ks, re.findIndex = Kg, re.findKey = zv, re.findLast = uv, re.findLastIndex = Yg, re.findLastKey = Uf, re.floor = bn, re.forEach = fv, re.forEachRight = Bo, re.forIn = la, re.forInRight = Pv, re.forOwn = Dp, re.forOwnRight = qo, re.get = $l, re.gt = Sv, re.gte = Ev, re.has = Iv, re.hasIn = E0, re.head = Wg, re.identity = Li, re.includes = i0, re.indexOf = Jx, re.inRange = Ip, re.invoke = b2, re.isArguments = Bu, re.isArray = Ft, re.isArrayBuffer = p0, re.isArrayLike = ts, re.isArrayLikeObject = jr, re.isBoolean = If, re.isBuffer = Ll, re.isDate = Cv, re.isElement = tn, re.isEmpty = m0, re.isEqual = Ap, re.isEqualWith = g0, re.isError = Np, re.isFinite = y0, re.isFunction = js, re.isInteger = Lf, re.isLength = Rp, re.isMap = kv, re.isMatch = Tv, re.isMatchWith = jv, re.isNaN = On, re.isNative = x0, re.isNil = d2, re.isNull = pi, re.isNumber = v0, re.isObject = rr, re.isObjectLike = gr, re.isPlainObject = Bf, re.isRegExp = $f, re.isSafeInteger = b0, re.isSet = qf, re.isString = Ff, re.isSymbol = ns, re.isTypedArray = Bl, re.isUndefined = w0, re.isWeakMap = f2, re.isWeakSet = Av, re.join = ev, re.kebabCase = Kv, re.last = Qn, re.lastIndexOf = tv, re.lowerCase = Yv, re.lowerFirst = T0, re.lt = h2, re.lte = Nv, re.max = St, re.maxBy = Zt, re.mean = an, re.meanBy = wn, re.min = Vl, re.minBy = R2, re.stubArray = Ke, re.stubFalse = Pe, re.stubObject = Be, re.stubString = _t, re.stubTrue = Mt, re.multiply = yU, re.nth = Io, re.noConflict = l, re.noop = p, re.now = Of, re.pad = Wv, re.padEnd = Zv, re.padStart = $p, re.parseInt = k2, re.random = Lp, re.reduce = Ep, re.reduceRight = s0, re.repeat = T2, re.replace = j0, re.result = $v, re.round = xU, re.runInContext = U, re.sample = i2, re.size = yv, re.snakeCase = A0, re.some = Qc, re.sortedIndex = Tf, re.sortedIndexBy = Kc, re.sortedIndexOf = rv, re.sortedLastIndex = iv, re.sortedLastIndexBy = jf, re.sortedLastIndexOf = sv, re.startCase = N0, re.startsWith = Xv, re.subtract = vU, re.sum = bU, re.sumBy = wU, re.template = R0, re.times = Dn, re.toFinite = $o, re.toInteger = zt, re.toLength = _0, re.toLower = ql, re.toNumber = As, re.toSafeInteger = p2, re.toString = Cn, re.toUpper = Fl, re.trim = Ul, re.trimEnd = Vf, re.trimStart = Gf, re.truncate = Hl, re.unescape = j2, re.uniqueId = Ce, re.upperCase = Qv, re.upperFirst = $u, re.each = fv, re.eachRight = Bo, re.first = Wg, o(re, (function() {
          var g = {};
          return ka(re, function(v, k) {
            He.call(re.prototype, k) || (g[k] = v);
          }), g;
        })(), { chain: !1 }), re.VERSION = r, ai(["bind", "bindKey", "curry", "curryRight", "partial", "partialRight"], function(g) {
          re[g].placeholder = re;
        }), ai(["drop", "take"], function(g, v) {
          Gt.prototype[g] = function(k) {
            k = k === n ? 1 : hr(zt(k), 0);
            var z = this.__filtered__ && !v ? new Gt(this) : this.clone();
            return z.__filtered__ ? z.__takeCount__ = Or(k, z.__takeCount__) : z.__views__.push({
              size: Or(k, J),
              type: g + (z.__dir__ < 0 ? "Right" : "")
            }), z;
          }, Gt.prototype[g + "Right"] = function(k) {
            return this.reverse()[g](k).reverse();
          };
        }), ai(["filter", "map", "takeWhile"], function(g, v) {
          var k = v + 1, z = k == Z || k == X;
          Gt.prototype[g] = function(K) {
            var ae = this.clone();
            return ae.__iteratees__.push({
              iteratee: Nt(K, 3),
              type: k
            }), ae.__filtered__ = ae.__filtered__ || z, ae;
          };
        }), ai(["head", "last"], function(g, v) {
          var k = "take" + (v ? "Right" : "");
          Gt.prototype[g] = function() {
            return this[k](1).value()[0];
          };
        }), ai(["initial", "tail"], function(g, v) {
          var k = "drop" + (v ? "" : "Right");
          Gt.prototype[g] = function() {
            return this.__filtered__ ? new Gt(this) : this[k](1);
          };
        }), Gt.prototype.compact = function() {
          return this.filter(Li);
        }, Gt.prototype.find = function(g) {
          return this.filter(g).head();
        }, Gt.prototype.findLast = function(g) {
          return this.reverse().find(g);
        }, Gt.prototype.invokeMap = Yt(function(g, v) {
          return typeof g == "function" ? new Gt(this) : this.map(function(k) {
            return sa(k, g, v);
          });
        }), Gt.prototype.reject = function(g) {
          return this.filter(Tp(Nt(g)));
        }, Gt.prototype.slice = function(g, v) {
          g = zt(g);
          var k = this;
          return k.__filtered__ && (g > 0 || v < 0) ? new Gt(k) : (g < 0 ? k = k.takeRight(-g) : g && (k = k.drop(g)), v !== n && (v = zt(v), k = v < 0 ? k.dropRight(-v) : k.take(v - g)), k);
        }, Gt.prototype.takeRightWhile = function(g) {
          return this.reverse().takeWhile(g).reverse();
        }, Gt.prototype.toArray = function() {
          return this.take(J);
        }, ka(Gt.prototype, function(g, v) {
          var k = /^(?:filter|find|map|reject)|While$/.test(v), z = /^(?:head|last)$/.test(v), K = re[z ? "take" + (v == "last" ? "Right" : "") : v], ae = z || /^find/.test(v);
          K && (re.prototype[v] = function() {
            var ye = this.__wrapped__, Ee = z ? [1] : arguments, Ne = ye instanceof Gt, We = Ee[0], Ze = Ne || Ft(ye), et = function(cn) {
              var yn = K.apply(re, ms([cn], Ee));
              return z && xt ? yn[0] : yn;
            };
            Ze && k && typeof We == "function" && We.length != 1 && (Ne = Ze = !1);
            var xt = this.__chain__, Et = !!this.__actions__.length, Pt = ae && !xt, Qt = Ne && !Et;
            if (!ae && Ze) {
              ye = Qt ? ye : new Gt(this);
              var It = g.apply(ye, Ee);
              return It.__actions__.push({ func: Iu, args: [et], thisArg: n }), new Ki(It, xt);
            }
            return Pt && Qt ? g.apply(this, Ee) : (It = this.thru(et), Pt ? z ? It.value()[0] : It.value() : It);
          });
        }), ai(["pop", "push", "shift", "sort", "splice", "unshift"], function(g) {
          var v = ze[g], k = /^(?:push|sort|unshift)$/.test(g) ? "tap" : "thru", z = /^(?:pop|shift)$/.test(g);
          re.prototype[g] = function() {
            var K = arguments;
            if (z && !this.__chain__) {
              var ae = this.value();
              return v.apply(Ft(ae) ? ae : [], K);
            }
            return this[k](function(ye) {
              return v.apply(Ft(ye) ? ye : [], K);
            });
          };
        }), ka(Gt.prototype, function(g, v) {
          var k = re[v];
          if (k) {
            var z = k.name + "";
            He.call(En, z) || (En[z] = []), En[z].push({ name: v, func: k });
          }
        }), En[Hc(n, T).name] = [{
          name: "wrapper",
          func: n
        }], Gt.prototype.clone = jo, Gt.prototype.reverse = El, Gt.prototype.value = Ao, re.prototype.at = _p, re.prototype.chain = zl, re.prototype.commit = Fr, re.prototype.next = Pl, re.prototype.plant = Lo, re.prototype.reverse = t0, re.prototype.toJSON = re.prototype.valueOf = re.prototype.value = n0, re.prototype.first = re.prototype.head, ci && (re.prototype[ci] = Zc), re;
      }), ue = W();
      ps ? ((ps.exports = ue)._ = ue, gu._ = ue) : lr._ = ue;
    }).call(zW);
  })(Q0, Q0.exports)), Q0.exports;
}
var IW = /* @__PURE__ */ PW();
const o1 = {
  timeOut: 5e3,
  extendedTimeOut: 1e3,
  closeButton: !0,
  progressBar: !0
}, rh = class rh {
  constructor() {
  }
  static getInstance() {
    return rh.instance || (rh.instance = new rh()), rh.instance;
  }
  /**
   *  toastr 
   */
  getToastr() {
    return window.toastr || null;
  }
  /**
   * 
   * V0.9.10:  action 
   */
  success(t, n = "Engram", r = {}) {
    var a, u;
    const i = this.getToastr(), s = ((a = r.action) == null ? void 0 : a.onClick) ?? ((u = r.action) != null && u.goto ? () => this.navigate(r.action.goto) : void 0);
    i ? i.success(t, n, {
      ...o1,
      ...r,
      onclick: this.buildClickHandler(s),
      tapToDismiss: !!s
    }) : console.log(`[Engram] SUCCESS: ${n} - ${t}`), ee.info("Notification", `Success: ${t}`);
  }
  /**
   * 
   * V0.9.10:  action 
   */
  info(t, n = "Engram", r = {}) {
    var a, u;
    const i = this.getToastr(), s = ((a = r.action) == null ? void 0 : a.onClick) ?? ((u = r.action) != null && u.goto ? () => this.navigate(r.action.goto) : void 0);
    i ? i.info(t, n, {
      ...o1,
      ...r,
      onclick: this.buildClickHandler(s),
      tapToDismiss: !!s
    }) : console.log(`[Engram] INFO: ${n} - ${t}`), ee.info("Notification", `Info: ${t}`);
  }
  /**
   * 
   * V0.9.10:  action 
   */
  warning(t, n = "Engram", r = {}) {
    var a, u;
    const i = this.getToastr(), s = ((a = r.action) == null ? void 0 : a.onClick) ?? ((u = r.action) != null && u.goto ? () => this.navigate(r.action.goto) : void 0);
    i ? i.warning(t, n, {
      ...o1,
      ...r,
      onclick: this.buildClickHandler(s),
      tapToDismiss: !!s
    }) : console.warn(`[Engram] WARNING: ${n} - ${t}`), ee.warn("Notification", `Warning: ${t}`);
  }
  /**
   * 
   * V0.9.10: 
   */
  error(t, n = "Engram", r = {}) {
    const i = this.getToastr(), s = r.action ?? { goto: "devlog" }, a = this.buildClickHandler(s.onClick ?? s.goto ? () => this.navigate(s.goto) : void 0);
    i ? i.error(t, n, {
      ...o1,
      timeOut: 8e3,
      ...r,
      onclick: a,
      tapToDismiss: !!a
    }) : console.error(`[Engram] ERROR: ${n} - ${t}`), ee.error("Notification", `Error: ${t}`);
  }
  /**
   *  UI 
   */
  navigate(t) {
    ee.info("Notification", `: ${t}`), X5.emit({ type: "UI_NAVIGATE_REQUEST", payload: t });
  }
  /**
   * 
   */
  buildClickHandler(t) {
    if (t)
      return () => {
        try {
          t();
        } catch (n) {
          console.error("[Engram] Notification click handler error:", n);
        }
      };
  }
  /**
   * 
   * @param message 
   * @param title 
   * @param onCancel 
   * @returns toastr 
   */
  running(t, n = "Engram", r) {
    const i = this.getToastr();
    if (i) {
      const s = r ? `${t} <small style="opacity:0.7">()</small>` : t;
      return i.info(s, n, {
        timeOut: 2e4,
        //  20 
        extendedTimeOut: 0,
        // 
        closeButton: !1,
        // 
        progressBar: !0,
        // 
        tapToDismiss: !!r,
        // 
        onclick: r ? () => {
          ee.info("Notification", ""), r();
        } : void 0,
        escapeHtml: !1
        //  HTML
      });
    } else
      return console.log(`[Engram] RUNNING: ${n} - ${t}`), null;
  }
  /**
   *  toastr 
   */
  remove(t) {
    const n = this.getToastr();
    n && t && n.remove(t);
  }
  /**
   * 
   */
  clear() {
    const t = this.getToastr();
    t && t.clear();
  }
};
lt(rh, "instance");
let C3 = rh;
const xn = C3.getInstance(), ss = Fe.DATA_SYNC, LW = 3e3, BW = "Engram_sync_", $W = ".json", ih = class ih {
  constructor() {
    lt(this, "debouncedUploads", /* @__PURE__ */ new Map());
    lt(this, "isImporting", !1);
    ee.info(ss, "Initialized SyncService"), this.initEventListeners();
  }
  // 
  get isImportingState() {
    return this.isImporting;
  }
  initEventListeners() {
    setTimeout(async () => {
      var i, s;
      const { EventBus: t, TavernEventType: n } = await Promise.resolve().then(() => Bz);
      t.on(n.CHAT_CHANGED, async () => {
        var d;
        const { getSTContext: a } = await Promise.resolve().then(() => oy), u = (d = a()) == null ? void 0 : d.chatId;
        u && (ee.info(ss, `Chat changed to ${u}, checking sync...`), setTimeout(() => this.autoSyncDownload(u), 1e3));
      });
      const { getSTContext: r } = await Promise.resolve().then(() => oy);
      (i = r()) != null && i.chatId && this.autoSyncDownload((s = r()) == null ? void 0 : s.chatId);
    }, 2e3);
  }
  static getInstance() {
    return ih.instance || (ih.instance = new ih()), ih.instance;
  }
  /**
   * 
   * : Engram_sync_{chatId}.json
   */
  getSyncFileName(t) {
    const n = t.replace(/[^a-zA-Z0-9_-]/g, "_");
    return `${BW}${n}${$W}`;
  }
  /**
   *  URL ( fetch)
   */
  getSyncFileUrl(t) {
    return `/user/files/${t}?t=${Date.now()}`;
  }
  /**
   * 
   */
  scheduleUpload(t) {
    if (this.isImporting) {
      ee.debug(ss, `Skipping upload schedule for ${t} (Importing)`);
      return;
    }
    const n = it.getSettings().syncConfig;
    if (!(n != null && n.enabled) || !(n != null && n.autoSync))
      return;
    if (!this.debouncedUploads.has(t)) {
      const i = IW.debounce(() => {
        const s = it.getSettings().syncConfig;
        !(s != null && s.enabled) || !(s != null && s.autoSync) || this.upload(t).catch((a) => {
          ee.error(ss, `Auto-upload failed for ${t}`, a);
        });
      }, LW);
      this.debouncedUploads.set(t, i);
    }
    const r = this.debouncedUploads.get(t);
    r && r();
  }
  /**
   *  ()
   */
  async upload(t) {
    var n;
    try {
      ee.info(ss, `Starting upload for ${t}...`);
      const r = await Jo(t), i = await FP(r);
      let s = (n = await r.meta.get("lastModified")) == null ? void 0 : n.value;
      s || (s = Date.now(), await r.meta.put({ key: "lastModified", value: s }), i.meta.lastModified = s);
      const a = s;
      ee.debug(ss, `: ${i.events.length} , ${i.entities.length} `);
      const u = JSON.stringify(i), d = this.getSyncFileName(t), f = await fetch("/api/files/upload", {
        method: "POST",
        headers: S3(),
        body: JSON.stringify({
          name: d,
          data: btoa(unescape(encodeURIComponent(u)))
          //  UTF-8  Base64 
        })
      });
      if (!f.ok) {
        const h = await f.text();
        throw new Error(`Upload failed: ${f.statusText} - ${h}`);
      }
      return ee.success(ss, `: ${d}`), !0;
    } catch (r) {
      return ee.error(ss, `Upload error for ${t}`, r), !1;
    }
  }
  /**
   *  ( user/files/ )
   */
  async purge(t) {
    try {
      const n = this.getSyncFileName(t);
      await fetch("/api/files/delete", {
        method: "POST",
        headers: S3(),
        body: JSON.stringify({
          path: n
          // files API  path ()
        })
      });
    } catch {
    }
  }
  /**
   * 
   * 
   */
  async getRemoteStatus(t) {
    try {
      const n = this.getSyncFileName(t), r = this.getSyncFileUrl(n), i = await fetch(r);
      if (!i.ok) return { exists: !1, timestamp: 0 };
      const s = await i.json();
      return !s.meta || !s.meta.lastModified ? { exists: !1, timestamp: 0 } : {
        exists: !0,
        timestamp: s.meta.lastModified
      };
    } catch {
      return { exists: !1, timestamp: 0 };
    }
  }
  /**
   * 
   */
  async download(t) {
    var n, r;
    try {
      ee.info(ss, `Downloading for ${t}...`), this.isImporting = !0;
      const i = this.getSyncFileName(t), s = this.getSyncFileUrl(i), a = await fetch(s);
      if (!a.ok)
        return ee.warn(ss, `No remote data found for ${t} (HTTP ${a.status})`), this.isImporting = !1, "no_data";
      const u = await a.json();
      if (!u.events || !u.entities)
        throw this.isImporting = !1, new Error("Invalid file format: missing events or entities");
      ee.debug(ss, `: ${(n = u.events) == null ? void 0 : n.length} , ${(r = u.entities) == null ? void 0 : r.length} `);
      const d = await Jo(t);
      await UP(d, u);
      const f = await d.events.count(), h = await d.entities.count();
      return ee.debug(ss, `: ${f} , ${h} `), "success";
    } catch (i) {
      return ee.error(ss, `Download failed for ${t}`, i), "error";
    } finally {
      setTimeout(() => {
        this.isImporting = !1;
      }, 1e3);
    }
  }
  /**
   *  ( -> )
   * 
   */
  async autoSyncDownload(t) {
    const n = it.getSettings().syncConfig;
    if (!(n != null && n.enabled) || !(n != null && n.autoSync)) return;
    const r = await this.getRemoteStatus(t);
    if (!r.exists) return;
    const s = await (await Jo(t)).meta.get("lastModified"), a = (s == null ? void 0 : s.value) || 0;
    r.timestamp > a ? (ee.info(ss, `Found newer remote data (${r.timestamp} > ${a}), downloading...`), await this.download(t) === "success" && xn.success("", "Engram", { timeOut: 3e3 })) : ee.debug(ss, `Local data is up to date (Remote: ${r.timestamp} <= Local: ${a})`);
  }
  /**
   * 
   * @returns 'downloaded' | 'uploaded' | 'synced' | 'error' | 'ignored'
   */
  async autoSync(t) {
    const n = await this.getRemoteStatus(t);
    if (!n.exists)
      return "ignored";
    const i = await (await Jo(t)).meta.get("lastModified"), s = (i == null ? void 0 : i.value) || 0;
    return n.timestamp > s ? (ee.info(ss, `Remote is newer (${n.timestamp} > ${s}), downloading...`), await this.download(t) === "success" ? "downloaded" : "error") : "synced";
  }
};
lt(ih, "instance");
let k3 = ih;
const T3 = k3.getInstance(), L1 = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  syncService: T3
}, Symbol.toStringTag, { value: "Module" })), Cy = "Database";
class qP extends Ey {
  constructor(n) {
    super(`Engram_${n}`);
    lt(this, "events");
    lt(this, "entities");
    lt(this, "meta");
    lt(this, "chatId");
    this.chatId = n, this.version(2).stores({
      // Events: 
      events: "id, timestamp, significance_score, level",
      // Entities:  (V0.9.4:  aliases )
      entities: "id, type, name, *aliases",
      // Meta:  (lastSummarizedFloor )
      meta: "key"
    });
    const r = () => this.updateLastModified();
    this.events.hook("creating", r), this.entities.hook("updating", r), this.events.hook("deleting", r), this.entities.hook("creating", r), this.entities.hook("updating", r), this.entities.hook("deleting", r);
  }
  /**
   * 
   */
  updateLastModified() {
    try {
      if (T3.isImportingState)
        return;
      Ey.ignoreTransaction(() => {
        this.meta.put({ key: "lastModified", value: Date.now() }).catch((n) => {
          ee.error(Cy, " lastModified ", n);
        });
      }), T3.scheduleUpload(this.chatId);
    } catch (n) {
      ee.error(Cy, "Hook  ()", n);
    }
  }
}
async function FP(e) {
  const t = await e.events.toArray(), n = await e.entities.toArray(), i = (await e.meta.toArray()).reduce((s, a) => ({ ...s, [a.key]: a.value }), {});
  return { events: t, entities: n, meta: i };
}
async function UP(e, t) {
  await e.transaction("rw", e.events, e.entities, e.meta, async () => {
    await e.events.clear(), await e.entities.clear(), await e.meta.clear(), await e.events.bulkAdd(t.events), await e.entities.bulkAdd(t.entities);
    const n = Object.entries(t.meta || {}).map(([r, i]) => ({ key: r, value: i }));
    await e.meta.bulkAdd(n);
  });
}
const fh = /* @__PURE__ */ new Map();
function Jo(e) {
  if (!e)
    throw new Error("[Engram DB] chatId is required");
  return fh.has(e) || (ee.debug(Cy, `Creating database for chat: ${e}`), fh.set(e, new qP(e))), fh.get(e);
}
function qW(e) {
  const t = fh.get(e);
  t && (t.close(), fh.delete(e), ee.debug(Cy, `Closed database for chat: ${e}`));
}
function FW(e) {
  return fh.has(e);
}
function vd(e) {
  return fh.get(e) || null;
}
async function HP(e) {
  qW(e), await Ey.delete(`Engram_${e}`), ee.info(Cy, `Deleted database for chat: ${e}`);
}
const UW = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  ChatDatabase: qP,
  deleteDatabase: HP,
  exportChatData: FP,
  getDbForChat: Jo,
  hasDbForChat: FW,
  importChatData: UP,
  tryGetDbForChat: vd
}, Symbol.toStringTag, { value: "Module" }));
class HW {
  async search(t) {
    const n = t.toLowerCase().trim();
    if (!n || n.length < 2) return [];
    const r = xi();
    if (!r) return [];
    const i = vd(r);
    if (!i) return [];
    try {
      return (await i.events.orderBy("timestamp").reverse().filter((a) => a.summary.toLowerCase().includes(n)).limit(5).toArray()).map((a) => ({
        id: `memory-${a.id}`,
        type: "memory",
        title: a.summary.slice(0, 50) + (a.summary.length > 50 ? "..." : ""),
        description: new Date(a.timestamp).toLocaleString(),
        icon: ru,
        action: (u) => u("/memory"),
        // TODO: Nav to specific item?
        score: 5
        // Lower score than exact commands
      }));
    } catch (s) {
      return console.error("Memory search failed", s), [];
    }
  }
}
class VW {
  async search(t) {
    const n = t.toLowerCase().trim();
    if (!n) return [];
    const r = [];
    return (it.get("promptTemplates") || []).forEach((s) => {
      s.name.toLowerCase().includes(n) && r.push({
        id: `template-${s.id}`,
        type: "setting",
        // or 'template'
        title: `: ${s.name}`,
        description: `Prompt Template (${s.category})`,
        icon: ru,
        action: (a) => a("presets:prompt"),
        // Ideally navigates to specific template
        score: 7
      });
    }), r;
  }
}
window.__ENGRAM_SEARCH_INIT__ || (md.registerAdapter(new cT()), md.registerAdapter(new AW()), md.registerAdapter(new NW()), md.registerAdapter(new HW()), md.registerAdapter(new VW()), window.__ENGRAM_SEARCH_INIT__ = !0);
const GW = ({ onNavigate: e }) => {
  const [t, n] = I.useState(""), [r, i] = I.useState(!1), [s, a] = I.useState(0), [u, d] = I.useState([]), f = I.useRef(null);
  I.useEffect(() => {
    (async () => {
      if (!t.trim()) {
        const S = await new cT().search("");
        d(S);
        return;
      }
      const w = await md.search(t);
      d(w), a(0);
    })();
  }, [t, r]), I.useEffect(() => {
    const b = (w) => {
      (w.metaKey || w.ctrlKey) && w.key === "k" && (w.preventDefault(), i(!0));
    };
    return window.addEventListener("keydown", b), () => window.removeEventListener("keydown", b);
  }, []), I.useEffect(() => {
    r && setTimeout(() => {
      var b;
      return (b = f.current) == null ? void 0 : b.focus();
    }, 50);
  }, [r]), I.useEffect(() => {
    Promise.resolve().then(() => nL).then(({ setCommandPaletteCallback: b }) => {
      b(() => i(!0));
    }).catch(() => {
    });
  }, []);
  const h = (b) => {
    const w = u.length + (t ? 1 : 0);
    switch (b.key) {
      case "ArrowDown":
        b.preventDefault(), a((S) => (S + 1) % w);
        break;
      case "ArrowUp":
        b.preventDefault(), a((S) => (S - 1 + w) % w);
        break;
      case "Enter":
        b.preventDefault(), m();
        break;
      case "Escape":
        i(!1);
        break;
    }
  }, m = () => {
    u.length > 0 && s < u.length ? u[s].action(e) : t && (console.log("Searching memory for:", t), e("/memory")), i(!1), n("");
  }, x = /* @__PURE__ */ c.jsx(
    "div",
    {
      className: "fixed inset-0 flex items-start justify-center pt-[15vh] px-4 animate-in fade-in duration-200",
      style: {
        height: "100dvh",
        width: "100vw",
        backgroundColor: "rgba(0,0,0,0.4)",
        // Slightly more transparent to not feel too heavy
        backdropFilter: "var(--glass-backdrop-filter, blur(4px))",
        zIndex: 2147483647
        // Max safe integer to ensure it's on top of SillyTavern UI
      },
      onClick: (b) => {
        b.target === b.currentTarget && i(!1);
      },
      children: /* @__PURE__ */ c.jsxs(
        "div",
        {
          className: "w-full max-w-xl border border-border rounded-xl shadow-2xl overflow-hidden flex flex-col animate-in zoom-in-95 slide-in-from-top-4 duration-200",
          style: {
            backgroundColor: "var(--popover)",
            color: "var(--popover-foreground)",
            backdropFilter: "var(--glass-backdrop-filter)",
            maxHeight: "70vh"
          },
          children: [
            /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-3 px-4 py-3 border-b border-border/50", children: [
              /* @__PURE__ */ c.jsx(Ai, { size: 20, className: "text-muted-foreground shrink-0" }),
              /* @__PURE__ */ c.jsx(
                "input",
                {
                  ref: f,
                  type: "text",
                  className: "flex-1 bg-transparent border-none outline-none text-lg text-foreground placeholder:text-muted-foreground/50",
                  placeholder: "...",
                  value: t,
                  onChange: (b) => n(b.target.value),
                  onKeyDown: h
                }
              ),
              /* @__PURE__ */ c.jsx("div", { className: "text-[10px] text-muted-foreground border border-border px-1.5 py-0.5 rounded bg-muted/50 hidden sm:block", children: "ESC" })
            ] }),
            /* @__PURE__ */ c.jsxs("div", { className: "overflow-y-auto p-2 scroll-smooth", children: [
              u.length > 0 && /* @__PURE__ */ c.jsx("div", { className: "space-y-1", children: u.map((b, w) => /* @__PURE__ */ c.jsxs(
                "div",
                {
                  className: `flex items-center gap-3 px-3 py-2.5 rounded-lg cursor-pointer transition-all duration-[var(--duration-fast)] ${w === s ? "bg-primary/10 text-primary" : "text-foreground hover:bg-muted/50"}`,
                  onClick: () => {
                    b.action(e), i(!1), n("");
                  },
                  onMouseEnter: () => a(w),
                  children: [
                    /* @__PURE__ */ c.jsx("div", { className: `
                                        w-8 h-8 rounded-md flex items-center justify-center shrink-0
                                        ${w === s ? "bg-primary/20" : "bg-muted/50 text-muted-foreground"}
                                    `, children: b.icon ? /* @__PURE__ */ c.jsx(b.icon, { size: 16 }) : /* @__PURE__ */ c.jsx(hA, { size: 16 }) }),
                    /* @__PURE__ */ c.jsxs("div", { className: "flex-1 min-w-0", children: [
                      /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2", children: [
                        /* @__PURE__ */ c.jsx("span", { className: "text-sm font-medium", children: b.title }),
                        b.type !== "command" && /* @__PURE__ */ c.jsx("span", { className: "text-[10px] px-1.5 py-0.5 rounded-full bg-muted text-muted-foreground uppercase", children: b.type })
                      ] }),
                      b.description && /* @__PURE__ */ c.jsx("div", { className: "text-xs text-muted-foreground/80 truncate", children: b.description })
                    ] }),
                    w === s && /* @__PURE__ */ c.jsx(pA, { size: 16, className: "text-muted-foreground/50" })
                  ]
                },
                b.id
              )) }),
              t && /* @__PURE__ */ c.jsxs(
                "div",
                {
                  className: `
                            mt-2 pt-2 border-t border-border/50
                            flex items-center gap-3 px-3 py-2.5 rounded-lg cursor-pointer transition-colors
                            ${s === u.length ? "bg-primary/10 text-primary" : "text-foreground hover:bg-muted/50"}
                        `,
                  onClick: () => m(),
                  onMouseEnter: () => a(u.length),
                  children: [
                    /* @__PURE__ */ c.jsx("div", { className: `w-8 h-8 rounded-md flex items-center justify-center shrink-0 ${s === u.length ? "bg-primary/20" : "bg-muted/50 text-muted-foreground"}`, children: /* @__PURE__ */ c.jsx(Ai, { size: 16 }) }),
                    /* @__PURE__ */ c.jsxs("div", { className: "flex-1 min-w-0", children: [
                      /* @__PURE__ */ c.jsxs("div", { className: "text-sm font-medium", children: [
                        ': "',
                        /* @__PURE__ */ c.jsx("span", { className: "text-primary", children: t }),
                        '"'
                      ] }),
                      /* @__PURE__ */ c.jsx("div", { className: "text-xs text-muted-foreground/80", children: "..." })
                    ] }),
                    s === u.length && /* @__PURE__ */ c.jsx(pA, { size: 16, className: "text-muted-foreground/50" })
                  ]
                }
              ),
              u.length === 0 && !t && /* @__PURE__ */ c.jsxs("div", { className: "px-4 py-8 text-center text-muted-foreground text-sm", children: [
                /* @__PURE__ */ c.jsx(hA, { size: 32, className: "mx-auto mb-2 opacity-20" }),
                /* @__PURE__ */ c.jsx("p", { children: " (Cmd+K)" })
              ] })
            ] })
          ]
        }
      )
    }
  );
  return /* @__PURE__ */ c.jsxs(c.Fragment, { children: [
    /* @__PURE__ */ c.jsx(
      "button",
      {
        onClick: () => i(!0),
        className: "p-2 rounded-md hover:bg-accent hover:text-accent-foreground transition-all duration-[var(--duration-fast)] text-muted-foreground hover:scale-110 active:scale-95",
        title: " (Cmd+K)",
        children: /* @__PURE__ */ c.jsx(Ai, { size: 20 })
      }
    ),
    r && Vb.createPortal(x, document.body)
  ] });
}, KW = ({ className: e = "", size: t = 24 }) => /* @__PURE__ */ c.jsx(
  "svg",
  {
    xmlns: "http://www.w3.org/2000/svg",
    viewBox: "0 96 400 400",
    width: t,
    height: t,
    className: e,
    "aria-label": "Engram Icon",
    children: /* @__PURE__ */ c.jsx(
      "path",
      {
        fill: "currentColor",
        d: `M103.875908,522.166260
                C75.225380,521.276611 55.289425,503.229828 52.249313,475.852142
                C49.879883,454.514191 63.027035,433.000366 83.930901,424.858398
                C88.449257,423.098541 89.857674,420.860199 89.801926,416.150269
                C89.555420,395.322357 89.621246,374.489380 89.762306,353.659515
                C89.787170,349.987000 88.728760,348.057556 85.120293,346.642609
                C64.672897,338.625031 52.338894,320.951630 52.085896,299.869415
                C51.832878,278.785156 63.730618,260.903198 84.118019,252.449951
                C88.288918,250.720566 89.867378,248.680847 89.807304,244.052597
                C89.539139,223.391968 89.589142,202.724701 89.796356,182.062561
                C89.836380,178.071609 88.518524,176.326385 84.841705,174.787247
                C57.730556,163.438416 45.530682,135.966721 55.436111,109.194000
                C62.627293,89.757439 81.922821,76.710289 103.282494,76.841476
                C124.355003,76.970901 143.082275,89.740875 149.993118,109.121849
                C151.315979,112.831749 153.184799,113.869263 156.863403,113.853104
                C186.192612,113.724319 215.522736,113.698357 244.851929,113.811600
                C248.773117,113.826736 250.677307,112.652130 252.052902,108.765602
                C259.013885,89.098465 278.589447,76.365829 300.503601,76.811897
                C322.171844,77.252960 341.040283,91.132324 347.255371,111.201912
                C356.569763,141.279358 340.344788,170.373184 309.893127,176.623123
                C283.359375,182.068970 260.376740,167.450562 251.980011,145.670181
                C250.492157,141.810806 248.818085,140.240295 244.552948,140.266785
                C215.390915,140.447968 186.227219,140.357330 157.064072,140.375076
                C154.628784,140.376556 151.855545,139.805771 151.141357,143.359161
                C150.400787,147.043839 146.628937,150.064713 151.136917,154.478546
                C184.592346,187.235229 217.778336,220.267349 250.982285,253.280014
                C253.021469,255.307434 254.527191,255.254166 257.033264,254.047714
                C276.199188,244.820953 294.752930,247.045853 310.978485,259.993408
                C328.011017,273.584869 333.936798,292.106659 327.764038,313.282837
                C321.779785,333.812378 307.254517,345.637268 286.367889,349.037231
                C276.405396,350.658997 266.352570,349.443024 257.275055,344.363342
                C254.265045,342.678986 252.301132,343.049744 249.903275,345.441406
                C230.205368,365.088531 210.395386,384.623230 190.631638,404.204376
                C177.732651,416.984222 164.859726,429.790344 151.962982,442.572388
                C148.257980,446.244415 148.113403,452.901764 151.629196,456.671387
                C152.707138,457.827148 154.029282,457.681976 155.328629,457.681946
                C185.658203,457.681458 215.987854,457.631042 246.317261,457.695557
                C249.355972,457.702026 250.687012,456.399414 251.717636,453.698944
                C259.314423,433.793579 278.324493,420.868317 299.341309,421.146240
                C320.526215,421.426361 339.575745,434.206421 346.686249,452.909271
                C354.337341,473.034058 348.794159,495.642761 332.699371,509.956390
                C307.061371,532.757202 263.380280,521.715210 251.978027,489.436371
                C250.838303,486.209961 249.371201,484.953583 245.964813,484.962799
                C216.302094,485.043304 186.639008,484.985840 156.976028,484.969330
                C154.436981,484.967896 152.081528,484.923981 150.916916,488.054077
                C142.892441,509.621246 126.842339,520.325989 103.875908,522.166260
                M141.430466,266.110352
                C145.394760,270.906738 148.503693,276.196198 150.388428,282.139069
                C151.211502,284.734314 152.692291,285.770782 155.494156,285.760895
                C179.139755,285.677429 202.787949,285.547394 226.430206,285.843811
                C232.373352,285.918304 231.388184,281.058533 233.335602,278.254700
                C235.007233,275.847992 233.916855,274.189880 232.000244,272.304352
                C199.956863,240.780380 167.866821,209.301468 136.133682,177.467056
                C131.183243,172.500824 127.483856,170.729507 121.013550,174.621368
                C117.660522,176.638214 116.183739,178.155136 116.217278,182.042480
                C116.398239,203.022598 116.444160,224.006012 116.243645,244.985474
                C116.204666,249.064667 117.676285,250.918961 121.328865,252.228989
                C128.972488,254.970444 135.505173,259.524170 141.430466,266.110352
                M116.349434,377.499908
                C116.351860,390.663696 116.870338,403.855377 116.161102,416.980713
                C115.742699,424.723846 121.926743,423.801880 125.649162,426.262665
                C129.080231,428.530792 130.798965,425.706268 132.741440,423.784821
                C165.551407,391.329803 198.234940,358.745361 231.274231,326.525696
                C235.764252,322.147095 232.377243,319.155212 231.599960,315.493317
                C230.884583,312.123138 228.193359,312.382568 225.670288,312.382812
                C202.675171,312.384949 179.679749,312.445435 156.685303,312.323212
                C153.331955,312.305389 151.624329,313.386505 150.456299,316.584381
                C145.119888,331.194611 135.004120,341.287384 120.496223,346.769958
                C117.238434,348.001068 116.190170,349.706024 116.267418,353.006317
                C116.450615,360.833862 116.340004,368.668243 116.349434,377.499908z`
      }
    )
  }
), YW = ({
  onToggleSidebar: e,
  isMobile: t,
  // Deprecated prop, handled by CSS
  onClose: n,
  onNavigate: r
}) => /* @__PURE__ */ c.jsxs("header", { className: "h-10 flex items-center justify-between px-4 bg-transparent z-50 transition-all duration-300 w-full flex-shrink-0", children: [
  /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-3 w-16 md:w-64", children: [
    /* @__PURE__ */ c.jsx(
      "button",
      {
        className: "p-2 -ml-2 rounded-md hover:bg-sidebar-accent hover:text-sidebar-accent-foreground transition-colors md:hidden",
        onClick: e,
        title: "",
        children: /* @__PURE__ */ c.jsx(eV, { size: 18 })
      }
    ),
    /* @__PURE__ */ c.jsxs("div", { className: "hidden md:flex items-center gap-2", children: [
      /* @__PURE__ */ c.jsx(KW, { size: 18, className: "text-primary" }),
      /* @__PURE__ */ c.jsx("span", { className: "font-semibold text-sidebar-foreground tracking-tight", children: "Engram" })
    ] })
  ] }),
  /* @__PURE__ */ c.jsx("div", { className: "flex-1" }),
  /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-1 md:gap-2", children: [
    /* @__PURE__ */ c.jsx(GW, { onNavigate: r }),
    /* @__PURE__ */ c.jsx("div", { className: "h-4 w-[1px] bg-border mx-1" }),
    /* @__PURE__ */ c.jsx(
      "button",
      {
        className: "p-2 rounded-md hover:bg-destructive hover:text-destructive-foreground transition-colors text-muted-foreground",
        onClick: n,
        title: "",
        children: /* @__PURE__ */ c.jsx(Wu, { size: 20 })
      }
    )
  ] })
] }), WW = ({ className: e = "", height: t = 24 }) => {
  const n = Math.round(t * 3.17);
  return /* @__PURE__ */ c.jsxs(
    "svg",
    {
      xmlns: "http://www.w3.org/2000/svg",
      viewBox: "235 175 555 175",
      width: n,
      height: t,
      className: e,
      "aria-label": "Engram",
      children: [
        /* @__PURE__ */ c.jsx("path", { fill: "currentColor", d: "M752.3,294.5c-0.2-11.8-0.3-23.1-0.4-34.4c0-2.7,0-5.3-0.2-8c-0.6-6.4-4.1-10.1-9.8-10.9 c-6.9-0.9-12.2,2-14.5,7.9c-1,2.5-1.2,5.2-1.2,7.9c0,11,-0.3,22,0,33c0.1,5.2-1.7,6.9-6.7,6.4c-3.3-0.3-6.7-0.3-10,0 c-4.9,0.5-5.9-1.9-5.8-6.2c0.2-11.8,0.2-23.7,0-35.5c-0.2-9.4-5.4-14.3-14.1-13.5c-6.4,0.6-11.1,5.7-11.3,13 c-0.3,11.7-0.2,23.3-0.3,35c0,7.1,0,7.1-7.3,7.1c-3.3,0-6.7-0.1-10,0c-3.3,0.1-4.9-1.1-4.9-4.6c0.1-21.5,0-43-0.1-64.5 c0-2.9,1.3-4.3,4.2-4.3c3.2,0,6.3-0.1,9.5,0.1c4,0,8.8-1,7.5,6.6c8.6-6.1,16.9-8.7,26.3-7c5.2,1,10.1,2.7,13.7,6.6 c2.8,2.9,4.6,2.4,7.4,0c6.8-5.8,15-7.9,23.8-6.9c16.3,1.8,25.1,11.7,25.8,29.5c0.5,13.3,0.1,26.6,0.2,40 c0,3.4-1.2,5.1-4.7,4.7C763.8,295.7,757.9,298,752.3,294.5z" }),
        /* @__PURE__ */ c.jsx("path", { fill: "currentColor", d: "M463.1,324.1c-10.8-0.7-20.9-2.4-30.2-7.5c-3.6-2-5-4-2.4-7.8c2.3-3.4,4.1-7.1,6.5-11.3 c6.1,3.6,11.8,6.8,18.5,7.7c5.3,0.7,10.6,1.1,15.8-0.5c8.3-2.6,12.2-9.1,10.9-18.6c-9.1,7.5-19.3,8.6-30.2,6.4 c-7.8-1.6-14.2-5.6-19.2-11.8c-10.5-12.8-10.6-32.5-0.5-45.5c11.2-14.3,28.6-16.4,50.9-6.1c-0.4-6.2,3.5-6.3,8.1-6.2 c13,0.2,13,0.1,13,13c0,16.3-0.5,32.7,0.1,49C505.4,309.3,491.3,322.1,467.6,324C466.2,324.1,464.9,324.1,463.1,324.1z M482.1,252.6 c-0.6-2.1-1.6-4-3-5.7c-4.6-6-13.5-8.4-21.2-5.5c-7.4,2.7-11.1,8.9-10.6,17.8c0.4,7.4,5.7,13.5,13.6,15.2 C474.1,277.2,485.2,266.4,482.1,252.6z" }),
        /* @__PURE__ */ c.jsx("path", { fill: "currentColor", d: "M258.1,201.6c20.3,0,40.1,0.1,60-0.1c4.5,0,6.3,1.3,6.1,5.9c-0.4,14.6,2.1,12.6-12.7,12.7 c-10.7,0.1-21.3,0.1-32-0.1c-3.8-0.1-5.2,1-5.3,5.1c0,13.4-0.2,13.4,13.4,13.4c8.7,0,17.3,0.1,26,0c3.4-0.1,4.7,1.2,4.7,4.7 c-0.2,16.4,1.9,13.7-13.1,13.9c-8.8,0.1-17.7,0.1-26.5,0c-3.2,0-4.6,1.1-4.4,4.4c0.2,3.8,0.2,7.7,0,11.5 c-0.2,3.5,1.1,4.7,4.6,4.7c13.7-0.1,27.3,0.2,41-0.1c5.1-0.1,6.6,1.5,6.5,6.5c-0.2,12.3,0,12.3-12.1,12.3 c-18.7-0.1-37.3-0.2-56,0c-4.9,0.1-6.7-1.2-6.7-6.4c0.2-27.5,0.2-55,0-82.5C251.6,203,253,200.9,258.1,201.6z" }),
        /* @__PURE__ */ c.jsx("path", { fill: "currentColor", d: "M599.5,239.6c-5.6,0.9-10.6,2.1-15,4.9c-2.5,1.6-4,0.9-5.1-1.6c-0.9-2-1.9-3.9-2.9-5.8 c-3.1-6.1-3-6.4,3-9.3c11.6-5.6,23.9-7.1,36.5-4.6c15.1,2.9,23.6,12.8,24.1,28.7c0.4,13.3,0.1,26.6,0.2,40 c0,3.5-1.5,4.8-4.8,4.6c-3,0-6,0-9,0.1c-4.2,0.2-8.1,0.2-6.6-6.6c-12.4,9.5-24.9,10.4-37.7,3.9c-8.5-4.3-11.9-12-11.3-21.2 c0.6-9.1,5.9-15,14.4-17.9c5.7-1.9,11.6-2.8,17.7-2.8c4.6,0,9.3,0.5,13.8-0.4c1.9-7.2-7.4-13.5-17.2-11.9 M617.7,271.9 c-0.1-2.5,1-5.8-3.3-5.8c-5,0-10-0.1-15,0.2c-4,0.3-6.9,2.4-7.1,6.9c-0.2,4.5,2.2,7.2,6.3,8.4C606.5,283.8,613.8,280.3,617.7,271.9z" }),
        /* @__PURE__ */ c.jsx("path", { fill: "currentColor", d: "M346.2,222.9c2.6,0,4.8,0.1,7,0c4.7-0.4,8.1,0.7,7,7.3c6-4,11.6-7.1,18.2-7.9c18.2-2.1,34.8,7.7,35,29.4 c0.1,13.2-0.1,26.3,0.1,39.5c0,3.9-1.2,5.5-5.2,5.2c-4,0-8,0-12,0.2c-3.5,0.2-4.7-1.3-4.7-4.7c0.1-10.3,0.1-20.7,0-31 c0-2.3-0.1-4.7-0.5-7c-1.3-8.4-5.4-12.3-12.9-12.6c-8.4-0.3-14.3,3.9-16,11.9c-2,9.6-0.7,19.3-0.9,28.9 c-0.2,14.4,0,14.4-14.4,14.4c-7.8,0-7.9,0-7.9-8c0-19.5,0-39,0-58.5C339,223.3,339.2,223.2,346.2,222.9z" }),
        /* @__PURE__ */ c.jsx("path", { fill: "currentColor", d: "M543.2,258.4c-0.1,11.1-0.3,21.8-0.2,32.4c0,4-1.2,5.9-5.4,5.6c-4.3-0.3-8.7-0.1-13-0.1 c-2.7,0-3.9-1.3-3.9-4c0-21.8,0-43.6,0-65.5c0-2.8,1.3-3.9,3.9-4c2.8,0,5.7,0,8.5-0.1c4.8-0.2,9.6-0.5,8.7,6.4 c2.1,0.8,2.8-0.7,3.9-1.3c2.3-1.2,4.5-2.8,7-3.8c11.8-4.7,14.3-3,14.3,9.3c0,0.8-0.1,1.7,0,2.5c0.6,4.6-1,6.4-6,6.5 C550,242.6,544.8,247.5,543.2,258.4z" })
      ]
    }
  );
}, tN = ({
  activeTab: e,
  onNavigate: t,
  isMobile: n,
  isOpen: r = !1,
  onClose: i,
  onShowUpdateNotice: s,
  hasUnreadUpdate: a
}) => {
  const u = (f) => {
    t(f), n && i && i();
  }, d = () => /* @__PURE__ */ c.jsxs("div", { className: "pt-4 border-t border-border/30 mt-2 space-y-2", children: [
    /* @__PURE__ */ c.jsxs(
      "button",
      {
        onClick: s,
        className: "w-full flex items-center gap-2 px-2 py-1.5 rounded-lg transition-all duration-[var(--duration-fast)] text-muted-foreground hover:text-foreground hover:bg-muted/10 text-left",
        children: [
          /* @__PURE__ */ c.jsxs("div", { className: "relative", children: [
            /* @__PURE__ */ c.jsx(
              GU,
              {
                size: 16,
                strokeWidth: 1.5,
                className: a ? "engram-animate-bell-ring" : ""
              }
            ),
            a && /* @__PURE__ */ c.jsx("span", { className: "absolute -top-1 -right-1 w-2 h-2 bg-red-500 rounded-full engram-animate-pulse" })
          ] }),
          /* @__PURE__ */ c.jsx("span", { className: "text-xs", children: "" }),
          a && /* @__PURE__ */ c.jsx("span", { className: "ml-auto text-[10px] px-1.5 py-0.5 bg-primary/20 text-primary rounded-full", children: "NEW" })
        ]
      }
    ),
    /* @__PURE__ */ c.jsxs(
      "a",
      {
        href: "https://github.com/shiyue137mh-netizen/Engram",
        target: "_blank",
        rel: "noopener noreferrer",
        className: "group w-full flex items-center gap-2 px-2 py-1.5 rounded-lg transition-all duration-200 text-muted-foreground hover:text-foreground hover:bg-muted/10",
        title: "",
        children: [
          /* @__PURE__ */ c.jsx(RH, { size: 16, strokeWidth: 1.5, className: "group-hover:text-primary transition-colors" }),
          /* @__PURE__ */ c.jsx("span", { className: "text-xs", children: "GitHub" }),
          /* @__PURE__ */ c.jsx("span", { className: "ml-auto text-[10px] text-primary opacity-0 group-hover:opacity-100 transition-opacity", children: "Star " })
        ]
      }
    ),
    /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2 px-2 py-1 opacity-50", children: [
      /* @__PURE__ */ c.jsx(WW, { height: 12 }),
      /* @__PURE__ */ c.jsxs("span", { className: "text-[10px] text-muted-foreground font-mono", children: [
        "v",
        Y5.version
      ] })
    ] })
  ] });
  return n && !r ? null : n ? /* @__PURE__ */ c.jsxs(
    "div",
    {
      className: "fixed inset-0 z-[60] flex justify-start",
      style: { height: "100dvh", width: "100vw" },
      children: [
        /* @__PURE__ */ c.jsx(
          "div",
          {
            className: "absolute inset-0 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",
            onClick: i
          }
        ),
        /* @__PURE__ */ c.jsxs(
          "div",
          {
            id: "mobile-menu-drawer",
            className: "relative w-64 max-w-[80vw] h-full bg-sidebar border-r border-border shadow-2xl flex flex-col p-6 animate-in slide-in-from-left duration-300",
            style: { height: "100dvh" },
            children: [
              /* @__PURE__ */ c.jsxs("div", { className: "flex justify-between items-center mb-8", children: [
                /* @__PURE__ */ c.jsx("span", { className: "text-lg font-semibold text-sidebar-foreground/80", children: "" }),
                /* @__PURE__ */ c.jsx(
                  "button",
                  {
                    onClick: i,
                    className: "p-2 -mr-2 rounded-md hover:bg-sidebar-accent text-muted-foreground hover:text-sidebar-accent-foreground transition-colors",
                    children: /* @__PURE__ */ c.jsx(Wu, { size: 20 })
                  }
                )
              ] }),
              /* @__PURE__ */ c.jsx("nav", { className: "space-y-2 flex-1 overflow-y-auto", children: tb.map((f) => {
                const h = f.icon, m = e === f.id;
                return /* @__PURE__ */ c.jsxs(
                  "button",
                  {
                    onClick: () => u(f.id),
                    className: `
                                    group w-full flex items-center gap-4 px-4 py-3 rounded-xl text-left
                                    transition-all duration-[var(--duration-fast)] ease-[var(--ease-out)]
                                    active:scale-[0.98]
                                    ${m ? "bg-primary/10 text-primary font-medium" : "text-muted-foreground hover:bg-sidebar-accent hover:text-sidebar-foreground"}
                                `,
                    children: [
                      /* @__PURE__ */ c.jsx(
                        h,
                        {
                          size: 22,
                          className: `transition-transform duration-[var(--duration-fast)] group-hover:scale-110 ${m ? "text-primary" : "text-muted-foreground/70"}`
                        }
                      ),
                      /* @__PURE__ */ c.jsx("span", { children: f.label })
                    ]
                  },
                  f.id
                );
              }) }),
              /* @__PURE__ */ c.jsx("div", { className: "mt-auto", children: /* @__PURE__ */ c.jsx(d, {}) })
            ]
          }
        )
      ]
    }
  ) : /* @__PURE__ */ c.jsxs("aside", { className: "[display:none] md:flex w-36 flex-shrink-0 bg-sidebar flex-col z-40 pt-4 px-2 border-r border-border/50 animate-in slide-in-from-left-4 fade-in duration-500 fill-mode-both", style: { animationDelay: "100ms", animationFillMode: "both" }, children: [
    /* @__PURE__ */ c.jsx("nav", { className: "flex-1 w-full flex flex-col gap-1 overflow-y-auto no-scrollbar", children: tb.map((f) => {
      const h = f.icon, m = e === f.id;
      return /* @__PURE__ */ c.jsxs(
        "button",
        {
          onClick: () => u(f.id),
          className: `
                                    group w-full flex items-center gap-2 px-2 py-2 rounded-lg text-left
                                    transition-all duration-[var(--duration-fast)] ease-[var(--ease-out)]
                                    ${m ? "bg-primary/10 text-primary" : "text-muted-foreground hover:text-foreground hover:bg-muted/10"}
                                `,
          children: [
            /* @__PURE__ */ c.jsx(
              h,
              {
                size: 18,
                strokeWidth: m ? 2 : 1.5,
                className: "flex-shrink-0 transition-transform duration-[var(--duration-fast)] group-hover:scale-110"
              }
            ),
            /* @__PURE__ */ c.jsx("span", { className: `text-xs ${m ? "font-medium" : "font-normal"}`, children: f.label })
          ]
        },
        f.id
      );
    }) }),
    /* @__PURE__ */ c.jsx("div", { className: "pb-3", children: /* @__PURE__ */ c.jsx(d, {}) })
  ] });
}, Yp = {
  owner: "shiyue137mh-netizen",
  repo: "Engram",
  branch: "master"
}, l1 = Y5.version;
let I0 = null, L0 = null;
function K2(e, t) {
  const n = e.split(".").map(Number), r = t.split(".").map(Number);
  for (let i = 0; i < Math.max(n.length, r.length); i++) {
    const s = n[i] || 0, a = r[i] || 0;
    if (s > a) return 1;
    if (s < a) return -1;
  }
  return 0;
}
class Wl {
  /**
   * 
   */
  static getCurrentVersion() {
    return l1;
  }
  /**
   *  GitHub 
   */
  static async getLatestVersion() {
    if (I0)
      return I0;
    try {
      const t = `https://raw.githubusercontent.com/${Yp.owner}/${Yp.repo}/${Yp.branch}/manifest.json`, n = await fetch(t);
      return n.ok ? (I0 = (await n.json()).version || null, I0) : null;
    } catch {
      return null;
    }
  }
  /**
   * 
   */
  static async hasUpdate() {
    const t = await this.getLatestVersion();
    return t ? K2(t, l1) > 0 : !1;
  }
  /**
   * 
   */
  static async getChangelog() {
    if (L0)
      return L0;
    try {
      const t = `https://raw.githubusercontent.com/${Yp.owner}/${Yp.repo}/${Yp.branch}/CHANGELOG.md`, n = await fetch(t);
      return n.ok ? (L0 = await n.text(), L0) : (console.warn("[Engram] UpdateService: ", n.status), xn.warning(`: ${n.status}`, ""), null);
    } catch (t) {
      return console.error("[Engram] UpdateService: ", t), xn.error("", ""), null;
    }
  }
  /**
   * 
   */
  static getReadVersion() {
    try {
      return it.get("lastReadVersion") || "0.0.0";
    } catch {
      return "0.0.0";
    }
  }
  /**
   * 
   */
  static async markAsRead(t) {
    const n = t || await this.getLatestVersion() || l1;
    try {
      it.set("lastReadVersion", n), console.debug("[Engram] UpdateService: ", n);
    } catch (r) {
      console.error("[Engram] UpdateService: ", r);
    }
  }
  /**
   * 
   */
  static async hasUnreadUpdate() {
    const t = await this.getLatestVersion();
    if (!t || K2(t, l1) <= 0)
      return !1;
    const n = this.getReadVersion();
    return K2(t, n) > 0;
  }
  /**
   * 
   */
  static clearCache() {
    I0 = null, L0 = null;
  }
}
function ZW(e, t) {
  const n = {};
  return (e[e.length - 1] === "" ? [...e, ""] : e).join(
    (n.padRight ? " " : "") + "," + (n.padLeft === !1 ? "" : " ")
  ).trim();
}
const XW = /^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u, QW = /^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u, JW = {};
function nN(e, t) {
  return (JW.jsx ? QW : XW).test(e);
}
const eZ = /[ \t\n\f\r]/g;
function tZ(e) {
  return typeof e == "object" ? e.type === "text" ? rN(e.value) : !1 : rN(e);
}
function rN(e) {
  return e.replace(eZ, "") === "";
}
class Qy {
  /**
   * @param {SchemaType['property']} property
   *   Property.
   * @param {SchemaType['normal']} normal
   *   Normal.
   * @param {Space | undefined} [space]
   *   Space.
   * @returns
   *   Schema.
   */
  constructor(t, n, r) {
    this.normal = n, this.property = t, r && (this.space = r);
  }
}
Qy.prototype.normal = {};
Qy.prototype.property = {};
Qy.prototype.space = void 0;
function VP(e, t) {
  const n = {}, r = {};
  for (const i of e)
    Object.assign(n, i.property), Object.assign(r, i.normal);
  return new Qy(n, r, t);
}
function j3(e) {
  return e.toLowerCase();
}
class ga {
  /**
   * @param {string} property
   *   Property.
   * @param {string} attribute
   *   Attribute.
   * @returns
   *   Info.
   */
  constructor(t, n) {
    this.attribute = n, this.property = t;
  }
}
ga.prototype.attribute = "";
ga.prototype.booleanish = !1;
ga.prototype.boolean = !1;
ga.prototype.commaOrSpaceSeparated = !1;
ga.prototype.commaSeparated = !1;
ga.prototype.defined = !1;
ga.prototype.mustUseProperty = !1;
ga.prototype.number = !1;
ga.prototype.overloadedBoolean = !1;
ga.prototype.property = "";
ga.prototype.spaceSeparated = !1;
ga.prototype.space = void 0;
let nZ = 0;
const Xt = Th(), Qr = Th(), A3 = Th(), at = Th(), ir = Th(), xm = Th(), za = Th();
function Th() {
  return 2 ** ++nZ;
}
const N3 = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  boolean: Xt,
  booleanish: Qr,
  commaOrSpaceSeparated: za,
  commaSeparated: xm,
  number: at,
  overloadedBoolean: A3,
  spaceSeparated: ir
}, Symbol.toStringTag, { value: "Module" })), Y2 = (
  /** @type {ReadonlyArray<keyof typeof types>} */
  Object.keys(N3)
);
class dT extends ga {
  /**
   * @constructor
   * @param {string} property
   *   Property.
   * @param {string} attribute
   *   Attribute.
   * @param {number | null | undefined} [mask]
   *   Mask.
   * @param {Space | undefined} [space]
   *   Space.
   * @returns
   *   Info.
   */
  constructor(t, n, r, i) {
    let s = -1;
    if (super(t, n), iN(this, "space", i), typeof r == "number")
      for (; ++s < Y2.length; ) {
        const a = Y2[s];
        iN(this, Y2[s], (r & N3[a]) === N3[a]);
      }
  }
}
dT.prototype.defined = !0;
function iN(e, t, n) {
  n && (e[t] = n);
}
function Hm(e) {
  const t = {}, n = {};
  for (const [r, i] of Object.entries(e.properties)) {
    const s = new dT(
      r,
      e.transform(e.attributes || {}, r),
      i,
      e.space
    );
    e.mustUseProperty && e.mustUseProperty.includes(r) && (s.mustUseProperty = !0), t[r] = s, n[j3(r)] = r, n[j3(s.attribute)] = r;
  }
  return new Qy(t, n, e.space);
}
const GP = Hm({
  properties: {
    ariaActiveDescendant: null,
    ariaAtomic: Qr,
    ariaAutoComplete: null,
    ariaBusy: Qr,
    ariaChecked: Qr,
    ariaColCount: at,
    ariaColIndex: at,
    ariaColSpan: at,
    ariaControls: ir,
    ariaCurrent: null,
    ariaDescribedBy: ir,
    ariaDetails: null,
    ariaDisabled: Qr,
    ariaDropEffect: ir,
    ariaErrorMessage: null,
    ariaExpanded: Qr,
    ariaFlowTo: ir,
    ariaGrabbed: Qr,
    ariaHasPopup: null,
    ariaHidden: Qr,
    ariaInvalid: null,
    ariaKeyShortcuts: null,
    ariaLabel: null,
    ariaLabelledBy: ir,
    ariaLevel: at,
    ariaLive: null,
    ariaModal: Qr,
    ariaMultiLine: Qr,
    ariaMultiSelectable: Qr,
    ariaOrientation: null,
    ariaOwns: ir,
    ariaPlaceholder: null,
    ariaPosInSet: at,
    ariaPressed: Qr,
    ariaReadOnly: Qr,
    ariaRelevant: null,
    ariaRequired: Qr,
    ariaRoleDescription: ir,
    ariaRowCount: at,
    ariaRowIndex: at,
    ariaRowSpan: at,
    ariaSelected: Qr,
    ariaSetSize: at,
    ariaSort: null,
    ariaValueMax: at,
    ariaValueMin: at,
    ariaValueNow: at,
    ariaValueText: null,
    role: null
  },
  transform(e, t) {
    return t === "role" ? t : "aria-" + t.slice(4).toLowerCase();
  }
});
function KP(e, t) {
  return t in e ? e[t] : t;
}
function YP(e, t) {
  return KP(e, t.toLowerCase());
}
const rZ = Hm({
  attributes: {
    acceptcharset: "accept-charset",
    classname: "class",
    htmlfor: "for",
    httpequiv: "http-equiv"
  },
  mustUseProperty: ["checked", "multiple", "muted", "selected"],
  properties: {
    // Standard Properties.
    abbr: null,
    accept: xm,
    acceptCharset: ir,
    accessKey: ir,
    action: null,
    allow: null,
    allowFullScreen: Xt,
    allowPaymentRequest: Xt,
    allowUserMedia: Xt,
    alt: null,
    as: null,
    async: Xt,
    autoCapitalize: null,
    autoComplete: ir,
    autoFocus: Xt,
    autoPlay: Xt,
    blocking: ir,
    capture: null,
    charSet: null,
    checked: Xt,
    cite: null,
    className: ir,
    cols: at,
    colSpan: null,
    content: null,
    contentEditable: Qr,
    controls: Xt,
    controlsList: ir,
    coords: at | xm,
    crossOrigin: null,
    data: null,
    dateTime: null,
    decoding: null,
    default: Xt,
    defer: Xt,
    dir: null,
    dirName: null,
    disabled: Xt,
    download: A3,
    draggable: Qr,
    encType: null,
    enterKeyHint: null,
    fetchPriority: null,
    form: null,
    formAction: null,
    formEncType: null,
    formMethod: null,
    formNoValidate: Xt,
    formTarget: null,
    headers: ir,
    height: at,
    hidden: A3,
    high: at,
    href: null,
    hrefLang: null,
    htmlFor: ir,
    httpEquiv: ir,
    id: null,
    imageSizes: null,
    imageSrcSet: null,
    inert: Xt,
    inputMode: null,
    integrity: null,
    is: null,
    isMap: Xt,
    itemId: null,
    itemProp: ir,
    itemRef: ir,
    itemScope: Xt,
    itemType: ir,
    kind: null,
    label: null,
    lang: null,
    language: null,
    list: null,
    loading: null,
    loop: Xt,
    low: at,
    manifest: null,
    max: null,
    maxLength: at,
    media: null,
    method: null,
    min: null,
    minLength: at,
    multiple: Xt,
    muted: Xt,
    name: null,
    nonce: null,
    noModule: Xt,
    noValidate: Xt,
    onAbort: null,
    onAfterPrint: null,
    onAuxClick: null,
    onBeforeMatch: null,
    onBeforePrint: null,
    onBeforeToggle: null,
    onBeforeUnload: null,
    onBlur: null,
    onCancel: null,
    onCanPlay: null,
    onCanPlayThrough: null,
    onChange: null,
    onClick: null,
    onClose: null,
    onContextLost: null,
    onContextMenu: null,
    onContextRestored: null,
    onCopy: null,
    onCueChange: null,
    onCut: null,
    onDblClick: null,
    onDrag: null,
    onDragEnd: null,
    onDragEnter: null,
    onDragExit: null,
    onDragLeave: null,
    onDragOver: null,
    onDragStart: null,
    onDrop: null,
    onDurationChange: null,
    onEmptied: null,
    onEnded: null,
    onError: null,
    onFocus: null,
    onFormData: null,
    onHashChange: null,
    onInput: null,
    onInvalid: null,
    onKeyDown: null,
    onKeyPress: null,
    onKeyUp: null,
    onLanguageChange: null,
    onLoad: null,
    onLoadedData: null,
    onLoadedMetadata: null,
    onLoadEnd: null,
    onLoadStart: null,
    onMessage: null,
    onMessageError: null,
    onMouseDown: null,
    onMouseEnter: null,
    onMouseLeave: null,
    onMouseMove: null,
    onMouseOut: null,
    onMouseOver: null,
    onMouseUp: null,
    onOffline: null,
    onOnline: null,
    onPageHide: null,
    onPageShow: null,
    onPaste: null,
    onPause: null,
    onPlay: null,
    onPlaying: null,
    onPopState: null,
    onProgress: null,
    onRateChange: null,
    onRejectionHandled: null,
    onReset: null,
    onResize: null,
    onScroll: null,
    onScrollEnd: null,
    onSecurityPolicyViolation: null,
    onSeeked: null,
    onSeeking: null,
    onSelect: null,
    onSlotChange: null,
    onStalled: null,
    onStorage: null,
    onSubmit: null,
    onSuspend: null,
    onTimeUpdate: null,
    onToggle: null,
    onUnhandledRejection: null,
    onUnload: null,
    onVolumeChange: null,
    onWaiting: null,
    onWheel: null,
    open: Xt,
    optimum: at,
    pattern: null,
    ping: ir,
    placeholder: null,
    playsInline: Xt,
    popover: null,
    popoverTarget: null,
    popoverTargetAction: null,
    poster: null,
    preload: null,
    readOnly: Xt,
    referrerPolicy: null,
    rel: ir,
    required: Xt,
    reversed: Xt,
    rows: at,
    rowSpan: at,
    sandbox: ir,
    scope: null,
    scoped: Xt,
    seamless: Xt,
    selected: Xt,
    shadowRootClonable: Xt,
    shadowRootDelegatesFocus: Xt,
    shadowRootMode: null,
    shape: null,
    size: at,
    sizes: null,
    slot: null,
    span: at,
    spellCheck: Qr,
    src: null,
    srcDoc: null,
    srcLang: null,
    srcSet: null,
    start: at,
    step: null,
    style: null,
    tabIndex: at,
    target: null,
    title: null,
    translate: null,
    type: null,
    typeMustMatch: Xt,
    useMap: null,
    value: Qr,
    width: at,
    wrap: null,
    writingSuggestions: null,
    // Legacy.
    // See: https://html.spec.whatwg.org/#other-elements,-attributes-and-apis
    align: null,
    // Several. Use CSS `text-align` instead,
    aLink: null,
    // `<body>`. Use CSS `a:active {color}` instead
    archive: ir,
    // `<object>`. List of URIs to archives
    axis: null,
    // `<td>` and `<th>`. Use `scope` on `<th>`
    background: null,
    // `<body>`. Use CSS `background-image` instead
    bgColor: null,
    // `<body>` and table elements. Use CSS `background-color` instead
    border: at,
    // `<table>`. Use CSS `border-width` instead,
    borderColor: null,
    // `<table>`. Use CSS `border-color` instead,
    bottomMargin: at,
    // `<body>`
    cellPadding: null,
    // `<table>`
    cellSpacing: null,
    // `<table>`
    char: null,
    // Several table elements. When `align=char`, sets the character to align on
    charOff: null,
    // Several table elements. When `char`, offsets the alignment
    classId: null,
    // `<object>`
    clear: null,
    // `<br>`. Use CSS `clear` instead
    code: null,
    // `<object>`
    codeBase: null,
    // `<object>`
    codeType: null,
    // `<object>`
    color: null,
    // `<font>` and `<hr>`. Use CSS instead
    compact: Xt,
    // Lists. Use CSS to reduce space between items instead
    declare: Xt,
    // `<object>`
    event: null,
    // `<script>`
    face: null,
    // `<font>`. Use CSS instead
    frame: null,
    // `<table>`
    frameBorder: null,
    // `<iframe>`. Use CSS `border` instead
    hSpace: at,
    // `<img>` and `<object>`
    leftMargin: at,
    // `<body>`
    link: null,
    // `<body>`. Use CSS `a:link {color: *}` instead
    longDesc: null,
    // `<frame>`, `<iframe>`, and `<img>`. Use an `<a>`
    lowSrc: null,
    // `<img>`. Use a `<picture>`
    marginHeight: at,
    // `<body>`
    marginWidth: at,
    // `<body>`
    noResize: Xt,
    // `<frame>`
    noHref: Xt,
    // `<area>`. Use no href instead of an explicit `nohref`
    noShade: Xt,
    // `<hr>`. Use background-color and height instead of borders
    noWrap: Xt,
    // `<td>` and `<th>`
    object: null,
    // `<applet>`
    profile: null,
    // `<head>`
    prompt: null,
    // `<isindex>`
    rev: null,
    // `<link>`
    rightMargin: at,
    // `<body>`
    rules: null,
    // `<table>`
    scheme: null,
    // `<meta>`
    scrolling: Qr,
    // `<frame>`. Use overflow in the child context
    standby: null,
    // `<object>`
    summary: null,
    // `<table>`
    text: null,
    // `<body>`. Use CSS `color` instead
    topMargin: at,
    // `<body>`
    valueType: null,
    // `<param>`
    version: null,
    // `<html>`. Use a doctype.
    vAlign: null,
    // Several. Use CSS `vertical-align` instead
    vLink: null,
    // `<body>`. Use CSS `a:visited {color}` instead
    vSpace: at,
    // `<img>` and `<object>`
    // Non-standard Properties.
    allowTransparency: null,
    autoCorrect: null,
    autoSave: null,
    disablePictureInPicture: Xt,
    disableRemotePlayback: Xt,
    prefix: null,
    property: null,
    results: at,
    security: null,
    unselectable: null
  },
  space: "html",
  transform: YP
}), iZ = Hm({
  attributes: {
    accentHeight: "accent-height",
    alignmentBaseline: "alignment-baseline",
    arabicForm: "arabic-form",
    baselineShift: "baseline-shift",
    capHeight: "cap-height",
    className: "class",
    clipPath: "clip-path",
    clipRule: "clip-rule",
    colorInterpolation: "color-interpolation",
    colorInterpolationFilters: "color-interpolation-filters",
    colorProfile: "color-profile",
    colorRendering: "color-rendering",
    crossOrigin: "crossorigin",
    dataType: "datatype",
    dominantBaseline: "dominant-baseline",
    enableBackground: "enable-background",
    fillOpacity: "fill-opacity",
    fillRule: "fill-rule",
    floodColor: "flood-color",
    floodOpacity: "flood-opacity",
    fontFamily: "font-family",
    fontSize: "font-size",
    fontSizeAdjust: "font-size-adjust",
    fontStretch: "font-stretch",
    fontStyle: "font-style",
    fontVariant: "font-variant",
    fontWeight: "font-weight",
    glyphName: "glyph-name",
    glyphOrientationHorizontal: "glyph-orientation-horizontal",
    glyphOrientationVertical: "glyph-orientation-vertical",
    hrefLang: "hreflang",
    horizAdvX: "horiz-adv-x",
    horizOriginX: "horiz-origin-x",
    horizOriginY: "horiz-origin-y",
    imageRendering: "image-rendering",
    letterSpacing: "letter-spacing",
    lightingColor: "lighting-color",
    markerEnd: "marker-end",
    markerMid: "marker-mid",
    markerStart: "marker-start",
    navDown: "nav-down",
    navDownLeft: "nav-down-left",
    navDownRight: "nav-down-right",
    navLeft: "nav-left",
    navNext: "nav-next",
    navPrev: "nav-prev",
    navRight: "nav-right",
    navUp: "nav-up",
    navUpLeft: "nav-up-left",
    navUpRight: "nav-up-right",
    onAbort: "onabort",
    onActivate: "onactivate",
    onAfterPrint: "onafterprint",
    onBeforePrint: "onbeforeprint",
    onBegin: "onbegin",
    onCancel: "oncancel",
    onCanPlay: "oncanplay",
    onCanPlayThrough: "oncanplaythrough",
    onChange: "onchange",
    onClick: "onclick",
    onClose: "onclose",
    onCopy: "oncopy",
    onCueChange: "oncuechange",
    onCut: "oncut",
    onDblClick: "ondblclick",
    onDrag: "ondrag",
    onDragEnd: "ondragend",
    onDragEnter: "ondragenter",
    onDragExit: "ondragexit",
    onDragLeave: "ondragleave",
    onDragOver: "ondragover",
    onDragStart: "ondragstart",
    onDrop: "ondrop",
    onDurationChange: "ondurationchange",
    onEmptied: "onemptied",
    onEnd: "onend",
    onEnded: "onended",
    onError: "onerror",
    onFocus: "onfocus",
    onFocusIn: "onfocusin",
    onFocusOut: "onfocusout",
    onHashChange: "onhashchange",
    onInput: "oninput",
    onInvalid: "oninvalid",
    onKeyDown: "onkeydown",
    onKeyPress: "onkeypress",
    onKeyUp: "onkeyup",
    onLoad: "onload",
    onLoadedData: "onloadeddata",
    onLoadedMetadata: "onloadedmetadata",
    onLoadStart: "onloadstart",
    onMessage: "onmessage",
    onMouseDown: "onmousedown",
    onMouseEnter: "onmouseenter",
    onMouseLeave: "onmouseleave",
    onMouseMove: "onmousemove",
    onMouseOut: "onmouseout",
    onMouseOver: "onmouseover",
    onMouseUp: "onmouseup",
    onMouseWheel: "onmousewheel",
    onOffline: "onoffline",
    onOnline: "ononline",
    onPageHide: "onpagehide",
    onPageShow: "onpageshow",
    onPaste: "onpaste",
    onPause: "onpause",
    onPlay: "onplay",
    onPlaying: "onplaying",
    onPopState: "onpopstate",
    onProgress: "onprogress",
    onRateChange: "onratechange",
    onRepeat: "onrepeat",
    onReset: "onreset",
    onResize: "onresize",
    onScroll: "onscroll",
    onSeeked: "onseeked",
    onSeeking: "onseeking",
    onSelect: "onselect",
    onShow: "onshow",
    onStalled: "onstalled",
    onStorage: "onstorage",
    onSubmit: "onsubmit",
    onSuspend: "onsuspend",
    onTimeUpdate: "ontimeupdate",
    onToggle: "ontoggle",
    onUnload: "onunload",
    onVolumeChange: "onvolumechange",
    onWaiting: "onwaiting",
    onZoom: "onzoom",
    overlinePosition: "overline-position",
    overlineThickness: "overline-thickness",
    paintOrder: "paint-order",
    panose1: "panose-1",
    pointerEvents: "pointer-events",
    referrerPolicy: "referrerpolicy",
    renderingIntent: "rendering-intent",
    shapeRendering: "shape-rendering",
    stopColor: "stop-color",
    stopOpacity: "stop-opacity",
    strikethroughPosition: "strikethrough-position",
    strikethroughThickness: "strikethrough-thickness",
    strokeDashArray: "stroke-dasharray",
    strokeDashOffset: "stroke-dashoffset",
    strokeLineCap: "stroke-linecap",
    strokeLineJoin: "stroke-linejoin",
    strokeMiterLimit: "stroke-miterlimit",
    strokeOpacity: "stroke-opacity",
    strokeWidth: "stroke-width",
    tabIndex: "tabindex",
    textAnchor: "text-anchor",
    textDecoration: "text-decoration",
    textRendering: "text-rendering",
    transformOrigin: "transform-origin",
    typeOf: "typeof",
    underlinePosition: "underline-position",
    underlineThickness: "underline-thickness",
    unicodeBidi: "unicode-bidi",
    unicodeRange: "unicode-range",
    unitsPerEm: "units-per-em",
    vAlphabetic: "v-alphabetic",
    vHanging: "v-hanging",
    vIdeographic: "v-ideographic",
    vMathematical: "v-mathematical",
    vectorEffect: "vector-effect",
    vertAdvY: "vert-adv-y",
    vertOriginX: "vert-origin-x",
    vertOriginY: "vert-origin-y",
    wordSpacing: "word-spacing",
    writingMode: "writing-mode",
    xHeight: "x-height",
    // These were camelcased in Tiny. Now lowercased in SVG 2
    playbackOrder: "playbackorder",
    timelineBegin: "timelinebegin"
  },
  properties: {
    about: za,
    accentHeight: at,
    accumulate: null,
    additive: null,
    alignmentBaseline: null,
    alphabetic: at,
    amplitude: at,
    arabicForm: null,
    ascent: at,
    attributeName: null,
    attributeType: null,
    azimuth: at,
    bandwidth: null,
    baselineShift: null,
    baseFrequency: null,
    baseProfile: null,
    bbox: null,
    begin: null,
    bias: at,
    by: null,
    calcMode: null,
    capHeight: at,
    className: ir,
    clip: null,
    clipPath: null,
    clipPathUnits: null,
    clipRule: null,
    color: null,
    colorInterpolation: null,
    colorInterpolationFilters: null,
    colorProfile: null,
    colorRendering: null,
    content: null,
    contentScriptType: null,
    contentStyleType: null,
    crossOrigin: null,
    cursor: null,
    cx: null,
    cy: null,
    d: null,
    dataType: null,
    defaultAction: null,
    descent: at,
    diffuseConstant: at,
    direction: null,
    display: null,
    dur: null,
    divisor: at,
    dominantBaseline: null,
    download: Xt,
    dx: null,
    dy: null,
    edgeMode: null,
    editable: null,
    elevation: at,
    enableBackground: null,
    end: null,
    event: null,
    exponent: at,
    externalResourcesRequired: null,
    fill: null,
    fillOpacity: at,
    fillRule: null,
    filter: null,
    filterRes: null,
    filterUnits: null,
    floodColor: null,
    floodOpacity: null,
    focusable: null,
    focusHighlight: null,
    fontFamily: null,
    fontSize: null,
    fontSizeAdjust: null,
    fontStretch: null,
    fontStyle: null,
    fontVariant: null,
    fontWeight: null,
    format: null,
    fr: null,
    from: null,
    fx: null,
    fy: null,
    g1: xm,
    g2: xm,
    glyphName: xm,
    glyphOrientationHorizontal: null,
    glyphOrientationVertical: null,
    glyphRef: null,
    gradientTransform: null,
    gradientUnits: null,
    handler: null,
    hanging: at,
    hatchContentUnits: null,
    hatchUnits: null,
    height: null,
    href: null,
    hrefLang: null,
    horizAdvX: at,
    horizOriginX: at,
    horizOriginY: at,
    id: null,
    ideographic: at,
    imageRendering: null,
    initialVisibility: null,
    in: null,
    in2: null,
    intercept: at,
    k: at,
    k1: at,
    k2: at,
    k3: at,
    k4: at,
    kernelMatrix: za,
    kernelUnitLength: null,
    keyPoints: null,
    // SEMI_COLON_SEPARATED
    keySplines: null,
    // SEMI_COLON_SEPARATED
    keyTimes: null,
    // SEMI_COLON_SEPARATED
    kerning: null,
    lang: null,
    lengthAdjust: null,
    letterSpacing: null,
    lightingColor: null,
    limitingConeAngle: at,
    local: null,
    markerEnd: null,
    markerMid: null,
    markerStart: null,
    markerHeight: null,
    markerUnits: null,
    markerWidth: null,
    mask: null,
    maskContentUnits: null,
    maskUnits: null,
    mathematical: null,
    max: null,
    media: null,
    mediaCharacterEncoding: null,
    mediaContentEncodings: null,
    mediaSize: at,
    mediaTime: null,
    method: null,
    min: null,
    mode: null,
    name: null,
    navDown: null,
    navDownLeft: null,
    navDownRight: null,
    navLeft: null,
    navNext: null,
    navPrev: null,
    navRight: null,
    navUp: null,
    navUpLeft: null,
    navUpRight: null,
    numOctaves: null,
    observer: null,
    offset: null,
    onAbort: null,
    onActivate: null,
    onAfterPrint: null,
    onBeforePrint: null,
    onBegin: null,
    onCancel: null,
    onCanPlay: null,
    onCanPlayThrough: null,
    onChange: null,
    onClick: null,
    onClose: null,
    onCopy: null,
    onCueChange: null,
    onCut: null,
    onDblClick: null,
    onDrag: null,
    onDragEnd: null,
    onDragEnter: null,
    onDragExit: null,
    onDragLeave: null,
    onDragOver: null,
    onDragStart: null,
    onDrop: null,
    onDurationChange: null,
    onEmptied: null,
    onEnd: null,
    onEnded: null,
    onError: null,
    onFocus: null,
    onFocusIn: null,
    onFocusOut: null,
    onHashChange: null,
    onInput: null,
    onInvalid: null,
    onKeyDown: null,
    onKeyPress: null,
    onKeyUp: null,
    onLoad: null,
    onLoadedData: null,
    onLoadedMetadata: null,
    onLoadStart: null,
    onMessage: null,
    onMouseDown: null,
    onMouseEnter: null,
    onMouseLeave: null,
    onMouseMove: null,
    onMouseOut: null,
    onMouseOver: null,
    onMouseUp: null,
    onMouseWheel: null,
    onOffline: null,
    onOnline: null,
    onPageHide: null,
    onPageShow: null,
    onPaste: null,
    onPause: null,
    onPlay: null,
    onPlaying: null,
    onPopState: null,
    onProgress: null,
    onRateChange: null,
    onRepeat: null,
    onReset: null,
    onResize: null,
    onScroll: null,
    onSeeked: null,
    onSeeking: null,
    onSelect: null,
    onShow: null,
    onStalled: null,
    onStorage: null,
    onSubmit: null,
    onSuspend: null,
    onTimeUpdate: null,
    onToggle: null,
    onUnload: null,
    onVolumeChange: null,
    onWaiting: null,
    onZoom: null,
    opacity: null,
    operator: null,
    order: null,
    orient: null,
    orientation: null,
    origin: null,
    overflow: null,
    overlay: null,
    overlinePosition: at,
    overlineThickness: at,
    paintOrder: null,
    panose1: null,
    path: null,
    pathLength: at,
    patternContentUnits: null,
    patternTransform: null,
    patternUnits: null,
    phase: null,
    ping: ir,
    pitch: null,
    playbackOrder: null,
    pointerEvents: null,
    points: null,
    pointsAtX: at,
    pointsAtY: at,
    pointsAtZ: at,
    preserveAlpha: null,
    preserveAspectRatio: null,
    primitiveUnits: null,
    propagate: null,
    property: za,
    r: null,
    radius: null,
    referrerPolicy: null,
    refX: null,
    refY: null,
    rel: za,
    rev: za,
    renderingIntent: null,
    repeatCount: null,
    repeatDur: null,
    requiredExtensions: za,
    requiredFeatures: za,
    requiredFonts: za,
    requiredFormats: za,
    resource: null,
    restart: null,
    result: null,
    rotate: null,
    rx: null,
    ry: null,
    scale: null,
    seed: null,
    shapeRendering: null,
    side: null,
    slope: null,
    snapshotTime: null,
    specularConstant: at,
    specularExponent: at,
    spreadMethod: null,
    spacing: null,
    startOffset: null,
    stdDeviation: null,
    stemh: null,
    stemv: null,
    stitchTiles: null,
    stopColor: null,
    stopOpacity: null,
    strikethroughPosition: at,
    strikethroughThickness: at,
    string: null,
    stroke: null,
    strokeDashArray: za,
    strokeDashOffset: null,
    strokeLineCap: null,
    strokeLineJoin: null,
    strokeMiterLimit: at,
    strokeOpacity: at,
    strokeWidth: null,
    style: null,
    surfaceScale: at,
    syncBehavior: null,
    syncBehaviorDefault: null,
    syncMaster: null,
    syncTolerance: null,
    syncToleranceDefault: null,
    systemLanguage: za,
    tabIndex: at,
    tableValues: null,
    target: null,
    targetX: at,
    targetY: at,
    textAnchor: null,
    textDecoration: null,
    textRendering: null,
    textLength: null,
    timelineBegin: null,
    title: null,
    transformBehavior: null,
    type: null,
    typeOf: za,
    to: null,
    transform: null,
    transformOrigin: null,
    u1: null,
    u2: null,
    underlinePosition: at,
    underlineThickness: at,
    unicode: null,
    unicodeBidi: null,
    unicodeRange: null,
    unitsPerEm: at,
    values: null,
    vAlphabetic: at,
    vMathematical: at,
    vectorEffect: null,
    vHanging: at,
    vIdeographic: at,
    version: null,
    vertAdvY: at,
    vertOriginX: at,
    vertOriginY: at,
    viewBox: null,
    viewTarget: null,
    visibility: null,
    width: null,
    widths: null,
    wordSpacing: null,
    writingMode: null,
    x: null,
    x1: null,
    x2: null,
    xChannelSelector: null,
    xHeight: at,
    y: null,
    y1: null,
    y2: null,
    yChannelSelector: null,
    z: null,
    zoomAndPan: null
  },
  space: "svg",
  transform: KP
}), WP = Hm({
  properties: {
    xLinkActuate: null,
    xLinkArcRole: null,
    xLinkHref: null,
    xLinkRole: null,
    xLinkShow: null,
    xLinkTitle: null,
    xLinkType: null
  },
  space: "xlink",
  transform(e, t) {
    return "xlink:" + t.slice(5).toLowerCase();
  }
}), ZP = Hm({
  attributes: { xmlnsxlink: "xmlns:xlink" },
  properties: { xmlnsXLink: null, xmlns: null },
  space: "xmlns",
  transform: YP
}), XP = Hm({
  properties: { xmlBase: null, xmlLang: null, xmlSpace: null },
  space: "xml",
  transform(e, t) {
    return "xml:" + t.slice(3).toLowerCase();
  }
}), sZ = {
  classId: "classID",
  dataType: "datatype",
  itemId: "itemID",
  strokeDashArray: "strokeDasharray",
  strokeDashOffset: "strokeDashoffset",
  strokeLineCap: "strokeLinecap",
  strokeLineJoin: "strokeLinejoin",
  strokeMiterLimit: "strokeMiterlimit",
  typeOf: "typeof",
  xLinkActuate: "xlinkActuate",
  xLinkArcRole: "xlinkArcrole",
  xLinkHref: "xlinkHref",
  xLinkRole: "xlinkRole",
  xLinkShow: "xlinkShow",
  xLinkTitle: "xlinkTitle",
  xLinkType: "xlinkType",
  xmlnsXLink: "xmlnsXlink"
}, aZ = /[A-Z]/g, sN = /-[a-z]/g, oZ = /^data[-\w.:]+$/i;
function lZ(e, t) {
  const n = j3(t);
  let r = t, i = ga;
  if (n in e.normal)
    return e.property[e.normal[n]];
  if (n.length > 4 && n.slice(0, 4) === "data" && oZ.test(t)) {
    if (t.charAt(4) === "-") {
      const s = t.slice(5).replace(sN, cZ);
      r = "data" + s.charAt(0).toUpperCase() + s.slice(1);
    } else {
      const s = t.slice(4);
      if (!sN.test(s)) {
        let a = s.replace(aZ, uZ);
        a.charAt(0) !== "-" && (a = "-" + a), t = "data" + a;
      }
    }
    i = dT;
  }
  return new i(r, t);
}
function uZ(e) {
  return "-" + e.toLowerCase();
}
function cZ(e) {
  return e.charAt(1).toUpperCase();
}
const dZ = VP([GP, rZ, WP, ZP, XP], "html"), fT = VP([GP, iZ, WP, ZP, XP], "svg");
function fZ(e) {
  return e.join(" ").trim();
}
var Wp = {}, W2, aN;
function hZ() {
  if (aN) return W2;
  aN = 1;
  var e = /\/\*[^*]*\*+([^/*][^*]*\*+)*\//g, t = /\n/g, n = /^\s*/, r = /^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/, i = /^:\s*/, s = /^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/, a = /^[;\s]*/, u = /^\s+|\s+$/g, d = `
`, f = "/", h = "*", m = "", x = "comment", b = "declaration";
  function w(C, T) {
    if (typeof C != "string")
      throw new TypeError("First argument must be a string");
    if (!C) return [];
    T = T || {};
    var R = 1, N = 1;
    function M(Z) {
      var oe = Z.match(t);
      oe && (R += oe.length);
      var X = Z.lastIndexOf(d);
      N = ~X ? Z.length - X : N + Z.length;
    }
    function P() {
      var Z = { line: R, column: N };
      return function(oe) {
        return oe.position = new D(Z), te(), oe;
      };
    }
    function D(Z) {
      this.start = Z, this.end = { line: R, column: N }, this.source = T.source;
    }
    D.prototype.content = C;
    function q(Z) {
      var oe = new Error(
        T.source + ":" + R + ":" + N + ": " + Z
      );
      if (oe.reason = Z, oe.filename = T.source, oe.line = R, oe.column = N, oe.source = C, !T.silent) throw oe;
    }
    function Y(Z) {
      var oe = Z.exec(C);
      if (oe) {
        var X = oe[0];
        return M(X), C = C.slice(X.length), oe;
      }
    }
    function te() {
      Y(n);
    }
    function V(Z) {
      var oe;
      for (Z = Z || []; oe = $(); )
        oe !== !1 && Z.push(oe);
      return Z;
    }
    function $() {
      var Z = P();
      if (!(f != C.charAt(0) || h != C.charAt(1))) {
        for (var oe = 2; m != C.charAt(oe) && (h != C.charAt(oe) || f != C.charAt(oe + 1)); )
          ++oe;
        if (oe += 2, m === C.charAt(oe - 1))
          return q("End of comment missing");
        var X = C.slice(2, oe - 2);
        return N += 2, M(X), C = C.slice(oe), N += 2, Z({
          type: x,
          comment: X
        });
      }
    }
    function G() {
      var Z = P(), oe = Y(r);
      if (oe) {
        if ($(), !Y(i)) return q("property missing ':'");
        var X = Y(s), ce = Z({
          type: b,
          property: S(oe[0].replace(e, m)),
          value: X ? S(X[0].replace(e, m)) : m
        });
        return Y(a), ce;
      }
    }
    function le() {
      var Z = [];
      V(Z);
      for (var oe; oe = G(); )
        oe !== !1 && (Z.push(oe), V(Z));
      return Z;
    }
    return te(), le();
  }
  function S(C) {
    return C ? C.replace(u, m) : m;
  }
  return W2 = w, W2;
}
var oN;
function pZ() {
  if (oN) return Wp;
  oN = 1;
  var e = Wp && Wp.__importDefault || function(r) {
    return r && r.__esModule ? r : { default: r };
  };
  Object.defineProperty(Wp, "__esModule", { value: !0 }), Wp.default = n;
  const t = e(/* @__PURE__ */ hZ());
  function n(r, i) {
    let s = null;
    if (!r || typeof r != "string")
      return s;
    const a = (0, t.default)(r), u = typeof i == "function";
    return a.forEach((d) => {
      if (d.type !== "declaration")
        return;
      const { property: f, value: h } = d;
      u ? i(f, h, d) : h && (s = s || {}, s[f] = h);
    }), s;
  }
  return Wp;
}
var B0 = {}, lN;
function mZ() {
  if (lN) return B0;
  lN = 1, Object.defineProperty(B0, "__esModule", { value: !0 }), B0.camelCase = void 0;
  var e = /^--[a-zA-Z0-9_-]+$/, t = /-([a-z])/g, n = /^[^-]+$/, r = /^-(webkit|moz|ms|o|khtml)-/, i = /^-(ms)-/, s = function(f) {
    return !f || n.test(f) || e.test(f);
  }, a = function(f, h) {
    return h.toUpperCase();
  }, u = function(f, h) {
    return "".concat(h, "-");
  }, d = function(f, h) {
    return h === void 0 && (h = {}), s(f) ? f : (f = f.toLowerCase(), h.reactCompat ? f = f.replace(i, u) : f = f.replace(r, u), f.replace(t, a));
  };
  return B0.camelCase = d, B0;
}
var $0, uN;
function gZ() {
  if (uN) return $0;
  uN = 1;
  var e = $0 && $0.__importDefault || function(i) {
    return i && i.__esModule ? i : { default: i };
  }, t = e(/* @__PURE__ */ pZ()), n = /* @__PURE__ */ mZ();
  function r(i, s) {
    var a = {};
    return !i || typeof i != "string" || (0, t.default)(i, function(u, d) {
      u && d && (a[(0, n.camelCase)(u, s)] = d);
    }), a;
  }
  return r.default = r, $0 = r, $0;
}
var yZ = /* @__PURE__ */ gZ();
const xZ = /* @__PURE__ */ jd(yZ), QP = JP("end"), hT = JP("start");
function JP(e) {
  return t;
  function t(n) {
    const r = n && n.position && n.position[e] || {};
    if (typeof r.line == "number" && r.line > 0 && typeof r.column == "number" && r.column > 0)
      return {
        line: r.line,
        column: r.column,
        offset: typeof r.offset == "number" && r.offset > -1 ? r.offset : void 0
      };
  }
}
function vZ(e) {
  const t = hT(e), n = QP(e);
  if (t && n)
    return { start: t, end: n };
}
function ly(e) {
  return !e || typeof e != "object" ? "" : "position" in e || "type" in e ? cN(e.position) : "start" in e || "end" in e ? cN(e) : "line" in e || "column" in e ? R3(e) : "";
}
function R3(e) {
  return dN(e && e.line) + ":" + dN(e && e.column);
}
function cN(e) {
  return R3(e && e.start) + "-" + R3(e && e.end);
}
function dN(e) {
  return e && typeof e == "number" ? e : 1;
}
class ds extends Error {
  /**
   * Create a message for `reason`.
   *
   * >  **Note**: also has obsolete signatures.
   *
   * @overload
   * @param {string} reason
   * @param {Options | null | undefined} [options]
   * @returns
   *
   * @overload
   * @param {string} reason
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns
   *
   * @overload
   * @param {string} reason
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns
   *
   * @overload
   * @param {string} reason
   * @param {string | null | undefined} [origin]
   * @returns
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {string | null | undefined} [origin]
   * @returns
   *
   * @param {Error | VFileMessage | string} causeOrReason
   *   Reason for message, should use markdown.
   * @param {Node | NodeLike | Options | Point | Position | string | null | undefined} [optionsOrParentOrPlace]
   *   Configuration (optional).
   * @param {string | null | undefined} [origin]
   *   Place in code where the message originates (example:
   *   `'my-package:my-rule'` or `'my-rule'`).
   * @returns
   *   Instance of `VFileMessage`.
   */
  // eslint-disable-next-line complexity
  constructor(t, n, r) {
    super(), typeof n == "string" && (r = n, n = void 0);
    let i = "", s = {}, a = !1;
    if (n && ("line" in n && "column" in n ? s = { place: n } : "start" in n && "end" in n ? s = { place: n } : "type" in n ? s = {
      ancestors: [n],
      place: n.position
    } : s = { ...n }), typeof t == "string" ? i = t : !s.cause && t && (a = !0, i = t.message, s.cause = t), !s.ruleId && !s.source && typeof r == "string") {
      const d = r.indexOf(":");
      d === -1 ? s.ruleId = r : (s.source = r.slice(0, d), s.ruleId = r.slice(d + 1));
    }
    if (!s.place && s.ancestors && s.ancestors) {
      const d = s.ancestors[s.ancestors.length - 1];
      d && (s.place = d.position);
    }
    const u = s.place && "start" in s.place ? s.place.start : s.place;
    this.ancestors = s.ancestors || void 0, this.cause = s.cause || void 0, this.column = u ? u.column : void 0, this.fatal = void 0, this.file = "", this.message = i, this.line = u ? u.line : void 0, this.name = ly(s.place) || "1:1", this.place = s.place || void 0, this.reason = this.message, this.ruleId = s.ruleId || void 0, this.source = s.source || void 0, this.stack = a && s.cause && typeof s.cause.stack == "string" ? s.cause.stack : "", this.actual = void 0, this.expected = void 0, this.note = void 0, this.url = void 0;
  }
}
ds.prototype.file = "";
ds.prototype.name = "";
ds.prototype.reason = "";
ds.prototype.message = "";
ds.prototype.stack = "";
ds.prototype.column = void 0;
ds.prototype.line = void 0;
ds.prototype.ancestors = void 0;
ds.prototype.cause = void 0;
ds.prototype.fatal = void 0;
ds.prototype.place = void 0;
ds.prototype.ruleId = void 0;
ds.prototype.source = void 0;
const pT = {}.hasOwnProperty, bZ = /* @__PURE__ */ new Map(), wZ = /[A-Z]/g, _Z = /* @__PURE__ */ new Set(["table", "tbody", "thead", "tfoot", "tr"]), SZ = /* @__PURE__ */ new Set(["td", "th"]), eI = "https://github.com/syntax-tree/hast-util-to-jsx-runtime";
function EZ(e, t) {
  if (!t || t.Fragment === void 0)
    throw new TypeError("Expected `Fragment` in options");
  const n = t.filePath || void 0;
  let r;
  if (t.development) {
    if (typeof t.jsxDEV != "function")
      throw new TypeError(
        "Expected `jsxDEV` in options when `development: true`"
      );
    r = MZ(n, t.jsxDEV);
  } else {
    if (typeof t.jsx != "function")
      throw new TypeError("Expected `jsx` in production options");
    if (typeof t.jsxs != "function")
      throw new TypeError("Expected `jsxs` in production options");
    r = RZ(n, t.jsx, t.jsxs);
  }
  const i = {
    Fragment: t.Fragment,
    ancestors: [],
    components: t.components || {},
    create: r,
    elementAttributeNameCase: t.elementAttributeNameCase || "react",
    evaluater: t.createEvaluater ? t.createEvaluater() : void 0,
    filePath: n,
    ignoreInvalidStyle: t.ignoreInvalidStyle || !1,
    passKeys: t.passKeys !== !1,
    passNode: t.passNode || !1,
    schema: t.space === "svg" ? fT : dZ,
    stylePropertyNameCase: t.stylePropertyNameCase || "dom",
    tableCellAlignToStyle: t.tableCellAlignToStyle !== !1
  }, s = tI(i, e, void 0);
  return s && typeof s != "string" ? s : i.create(
    e,
    i.Fragment,
    { children: s || void 0 },
    void 0
  );
}
function tI(e, t, n) {
  if (t.type === "element")
    return CZ(e, t, n);
  if (t.type === "mdxFlowExpression" || t.type === "mdxTextExpression")
    return kZ(e, t);
  if (t.type === "mdxJsxFlowElement" || t.type === "mdxJsxTextElement")
    return jZ(e, t, n);
  if (t.type === "mdxjsEsm")
    return TZ(e, t);
  if (t.type === "root")
    return AZ(e, t, n);
  if (t.type === "text")
    return NZ(e, t);
}
function CZ(e, t, n) {
  const r = e.schema;
  let i = r;
  t.tagName.toLowerCase() === "svg" && r.space === "html" && (i = fT, e.schema = i), e.ancestors.push(t);
  const s = rI(e, t.tagName, !1), a = OZ(e, t);
  let u = gT(e, t);
  return _Z.has(t.tagName) && (u = u.filter(function(d) {
    return typeof d == "string" ? !tZ(d) : !0;
  })), nI(e, a, s, t), mT(a, u), e.ancestors.pop(), e.schema = r, e.create(t, s, a, n);
}
function kZ(e, t) {
  if (t.data && t.data.estree && e.evaluater) {
    const r = t.data.estree.body[0];
    return (
      /** @type {Child | undefined} */
      e.evaluater.evaluateExpression(r.expression)
    );
  }
  ky(e, t.position);
}
function TZ(e, t) {
  if (t.data && t.data.estree && e.evaluater)
    return (
      /** @type {Child | undefined} */
      e.evaluater.evaluateProgram(t.data.estree)
    );
  ky(e, t.position);
}
function jZ(e, t, n) {
  const r = e.schema;
  let i = r;
  t.name === "svg" && r.space === "html" && (i = fT, e.schema = i), e.ancestors.push(t);
  const s = t.name === null ? e.Fragment : rI(e, t.name, !0), a = DZ(e, t), u = gT(e, t);
  return nI(e, a, s, t), mT(a, u), e.ancestors.pop(), e.schema = r, e.create(t, s, a, n);
}
function AZ(e, t, n) {
  const r = {};
  return mT(r, gT(e, t)), e.create(t, e.Fragment, r, n);
}
function NZ(e, t) {
  return t.value;
}
function nI(e, t, n, r) {
  typeof n != "string" && n !== e.Fragment && e.passNode && (t.node = r);
}
function mT(e, t) {
  if (t.length > 0) {
    const n = t.length > 1 ? t : t[0];
    n && (e.children = n);
  }
}
function RZ(e, t, n) {
  return r;
  function r(i, s, a, u) {
    const f = Array.isArray(a.children) ? n : t;
    return u ? f(s, a, u) : f(s, a);
  }
}
function MZ(e, t) {
  return n;
  function n(r, i, s, a) {
    const u = Array.isArray(s.children), d = hT(r);
    return t(
      i,
      s,
      a,
      u,
      {
        columnNumber: d ? d.column - 1 : void 0,
        fileName: e,
        lineNumber: d ? d.line : void 0
      },
      void 0
    );
  }
}
function OZ(e, t) {
  const n = {};
  let r, i;
  for (i in t.properties)
    if (i !== "children" && pT.call(t.properties, i)) {
      const s = zZ(e, i, t.properties[i]);
      if (s) {
        const [a, u] = s;
        e.tableCellAlignToStyle && a === "align" && typeof u == "string" && SZ.has(t.tagName) ? r = u : n[a] = u;
      }
    }
  if (r) {
    const s = (
      /** @type {Style} */
      n.style || (n.style = {})
    );
    s[e.stylePropertyNameCase === "css" ? "text-align" : "textAlign"] = r;
  }
  return n;
}
function DZ(e, t) {
  const n = {};
  for (const r of t.attributes)
    if (r.type === "mdxJsxExpressionAttribute")
      if (r.data && r.data.estree && e.evaluater) {
        const u = r.data.estree.body[0].expression.properties[0];
        Object.assign(
          n,
          e.evaluater.evaluateExpression(u.argument)
        );
      } else
        ky(e, t.position);
    else {
      const i = r.name;
      let s;
      if (r.value && typeof r.value == "object")
        if (r.value.data && r.value.data.estree && e.evaluater) {
          const u = r.value.data.estree.body[0];
          s = e.evaluater.evaluateExpression(u.expression);
        } else
          ky(e, t.position);
      else
        s = r.value === null ? !0 : r.value;
      n[i] = /** @type {Props[keyof Props]} */
      s;
    }
  return n;
}
function gT(e, t) {
  const n = [];
  let r = -1;
  const i = e.passKeys ? /* @__PURE__ */ new Map() : bZ;
  for (; ++r < t.children.length; ) {
    const s = t.children[r];
    let a;
    if (e.passKeys) {
      const d = s.type === "element" ? s.tagName : s.type === "mdxJsxFlowElement" || s.type === "mdxJsxTextElement" ? s.name : void 0;
      if (d) {
        const f = i.get(d) || 0;
        a = d + "-" + f, i.set(d, f + 1);
      }
    }
    const u = tI(e, s, a);
    u !== void 0 && n.push(u);
  }
  return n;
}
function zZ(e, t, n) {
  const r = lZ(e.schema, t);
  if (!(n == null || typeof n == "number" && Number.isNaN(n))) {
    if (Array.isArray(n) && (n = r.commaSeparated ? ZW(n) : fZ(n)), r.property === "style") {
      let i = typeof n == "object" ? n : PZ(e, String(n));
      return e.stylePropertyNameCase === "css" && (i = IZ(i)), ["style", i];
    }
    return [
      e.elementAttributeNameCase === "react" && r.space ? sZ[r.property] || r.property : r.attribute,
      n
    ];
  }
}
function PZ(e, t) {
  try {
    return xZ(t, { reactCompat: !0 });
  } catch (n) {
    if (e.ignoreInvalidStyle)
      return {};
    const r = (
      /** @type {Error} */
      n
    ), i = new ds("Cannot parse `style` attribute", {
      ancestors: e.ancestors,
      cause: r,
      ruleId: "style",
      source: "hast-util-to-jsx-runtime"
    });
    throw i.file = e.filePath || void 0, i.url = eI + "#cannot-parse-style-attribute", i;
  }
}
function rI(e, t, n) {
  let r;
  if (!n)
    r = { type: "Literal", value: t };
  else if (t.includes(".")) {
    const i = t.split(".");
    let s = -1, a;
    for (; ++s < i.length; ) {
      const u = nN(i[s]) ? { type: "Identifier", name: i[s] } : { type: "Literal", value: i[s] };
      a = a ? {
        type: "MemberExpression",
        object: a,
        property: u,
        computed: !!(s && u.type === "Literal"),
        optional: !1
      } : u;
    }
    r = a;
  } else
    r = nN(t) && !/^[a-z]/.test(t) ? { type: "Identifier", name: t } : { type: "Literal", value: t };
  if (r.type === "Literal") {
    const i = (
      /** @type {string | number} */
      r.value
    );
    return pT.call(e.components, i) ? e.components[i] : i;
  }
  if (e.evaluater)
    return e.evaluater.evaluateExpression(r);
  ky(e);
}
function ky(e, t) {
  const n = new ds(
    "Cannot handle MDX estrees without `createEvaluater`",
    {
      ancestors: e.ancestors,
      place: t,
      ruleId: "mdx-estree",
      source: "hast-util-to-jsx-runtime"
    }
  );
  throw n.file = e.filePath || void 0, n.url = eI + "#cannot-handle-mdx-estrees-without-createevaluater", n;
}
function IZ(e) {
  const t = {};
  let n;
  for (n in e)
    pT.call(e, n) && (t[LZ(n)] = e[n]);
  return t;
}
function LZ(e) {
  let t = e.replace(wZ, BZ);
  return t.slice(0, 3) === "ms-" && (t = "-" + t), t;
}
function BZ(e) {
  return "-" + e.toLowerCase();
}
const Z2 = {
  action: ["form"],
  cite: ["blockquote", "del", "ins", "q"],
  data: ["object"],
  formAction: ["button", "input"],
  href: ["a", "area", "base", "link"],
  icon: ["menuitem"],
  itemId: null,
  manifest: ["html"],
  ping: ["a", "area"],
  poster: ["video"],
  src: [
    "audio",
    "embed",
    "iframe",
    "img",
    "input",
    "script",
    "source",
    "track",
    "video"
  ]
}, $Z = {};
function yT(e, t) {
  const n = $Z, r = typeof n.includeImageAlt == "boolean" ? n.includeImageAlt : !0, i = typeof n.includeHtml == "boolean" ? n.includeHtml : !0;
  return iI(e, r, i);
}
function iI(e, t, n) {
  if (qZ(e)) {
    if ("value" in e)
      return e.type === "html" && !n ? "" : e.value;
    if (t && "alt" in e && e.alt)
      return e.alt;
    if ("children" in e)
      return fN(e.children, t, n);
  }
  return Array.isArray(e) ? fN(e, t, n) : "";
}
function fN(e, t, n) {
  const r = [];
  let i = -1;
  for (; ++i < e.length; )
    r[i] = iI(e[i], t, n);
  return r.join("");
}
function qZ(e) {
  return !!(e && typeof e == "object");
}
const hN = document.createElement("i");
function xT(e) {
  const t = "&" + e + ";";
  hN.innerHTML = t;
  const n = hN.textContent;
  return (
    // @ts-expect-error: TypeScript is wrong that `textContent` on elements can
    // yield `null`.
    n.charCodeAt(n.length - 1) === 59 && e !== "semi" || n === t ? !1 : n
  );
}
function $a(e, t, n, r) {
  const i = e.length;
  let s = 0, a;
  if (t < 0 ? t = -t > i ? 0 : i + t : t = t > i ? i : t, n = n > 0 ? n : 0, r.length < 1e4)
    a = Array.from(r), a.unshift(t, n), e.splice(...a);
  else
    for (n && e.splice(t, n); s < r.length; )
      a = r.slice(s, s + 1e4), a.unshift(t, 0), e.splice(...a), s += 1e4, t += 1e4;
}
function so(e, t) {
  return e.length > 0 ? ($a(e, e.length, 0, t), e) : t;
}
const pN = {}.hasOwnProperty;
function sI(e) {
  const t = {};
  let n = -1;
  for (; ++n < e.length; )
    FZ(t, e[n]);
  return t;
}
function FZ(e, t) {
  let n;
  for (n in t) {
    const i = (pN.call(e, n) ? e[n] : void 0) || (e[n] = {}), s = t[n];
    let a;
    if (s)
      for (a in s) {
        pN.call(i, a) || (i[a] = []);
        const u = s[a];
        UZ(
          // @ts-expect-error Looks like a list.
          i[a],
          Array.isArray(u) ? u : u ? [u] : []
        );
      }
  }
}
function UZ(e, t) {
  let n = -1;
  const r = [];
  for (; ++n < t.length; )
    (t[n].add === "after" ? e : r).push(t[n]);
  $a(e, 0, 0, r);
}
function aI(e, t) {
  const n = Number.parseInt(e, t);
  return (
    // C0 except for HT, LF, FF, CR, space.
    n < 9 || n === 11 || n > 13 && n < 32 || // Control character (DEL) of C0, and C1 controls.
    n > 126 && n < 160 || // Lone high surrogates and low surrogates.
    n > 55295 && n < 57344 || // Noncharacters.
    n > 64975 && n < 65008 || /* eslint-disable no-bitwise */
    (n & 65535) === 65535 || (n & 65535) === 65534 || /* eslint-enable no-bitwise */
    // Out of range
    n > 1114111 ? "" : String.fromCodePoint(n)
  );
}
function rl(e) {
  return e.replace(/[\t\n\r ]+/g, " ").replace(/^ | $/g, "").toLowerCase().toUpperCase();
}
const Os = Ad(/[A-Za-z]/), os = Ad(/[\dA-Za-z]/), HZ = Ad(/[#-'*+\--9=?A-Z^-~]/);
function cb(e) {
  return (
    // Special whitespace codes (which have negative values), C0 and Control
    // character DEL
    e !== null && (e < 32 || e === 127)
  );
}
const M3 = Ad(/\d/), VZ = Ad(/[\dA-Fa-f]/), GZ = Ad(/[!-/:-@[-`{-~]/);
function Ot(e) {
  return e !== null && e < -2;
}
function Jn(e) {
  return e !== null && (e < 0 || e === 32);
}
function dn(e) {
  return e === -2 || e === -1 || e === 32;
}
const Jb = Ad(new RegExp("\\p{P}|\\p{S}", "u")), bh = Ad(/\s/);
function Ad(e) {
  return t;
  function t(n) {
    return n !== null && n > -1 && e.test(String.fromCharCode(n));
  }
}
function Vm(e) {
  const t = [];
  let n = -1, r = 0, i = 0;
  for (; ++n < e.length; ) {
    const s = e.charCodeAt(n);
    let a = "";
    if (s === 37 && os(e.charCodeAt(n + 1)) && os(e.charCodeAt(n + 2)))
      i = 2;
    else if (s < 128)
      /[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(s)) || (a = String.fromCharCode(s));
    else if (s > 55295 && s < 57344) {
      const u = e.charCodeAt(n + 1);
      s < 56320 && u > 56319 && u < 57344 ? (a = String.fromCharCode(s, u), i = 1) : a = "";
    } else
      a = String.fromCharCode(s);
    a && (t.push(e.slice(r, n), encodeURIComponent(a)), r = n + i + 1, a = ""), i && (n += i, i = 0);
  }
  return t.join("") + e.slice(r);
}
function _n(e, t, n, r) {
  const i = r ? r - 1 : Number.POSITIVE_INFINITY;
  let s = 0;
  return a;
  function a(d) {
    return dn(d) ? (e.enter(n), u(d)) : t(d);
  }
  function u(d) {
    return dn(d) && s++ < i ? (e.consume(d), u) : (e.exit(n), t(d));
  }
}
const KZ = {
  tokenize: YZ
};
function YZ(e) {
  const t = e.attempt(this.parser.constructs.contentInitial, r, i);
  let n;
  return t;
  function r(u) {
    if (u === null) {
      e.consume(u);
      return;
    }
    return e.enter("lineEnding"), e.consume(u), e.exit("lineEnding"), _n(e, t, "linePrefix");
  }
  function i(u) {
    return e.enter("paragraph"), s(u);
  }
  function s(u) {
    const d = e.enter("chunkText", {
      contentType: "text",
      previous: n
    });
    return n && (n.next = d), n = d, a(u);
  }
  function a(u) {
    if (u === null) {
      e.exit("chunkText"), e.exit("paragraph"), e.consume(u);
      return;
    }
    return Ot(u) ? (e.consume(u), e.exit("chunkText"), s) : (e.consume(u), a);
  }
}
const WZ = {
  tokenize: ZZ
}, mN = {
  tokenize: XZ
};
function ZZ(e) {
  const t = this, n = [];
  let r = 0, i, s, a;
  return u;
  function u(N) {
    if (r < n.length) {
      const M = n[r];
      return t.containerState = M[1], e.attempt(M[0].continuation, d, f)(N);
    }
    return f(N);
  }
  function d(N) {
    if (r++, t.containerState._closeFlow) {
      t.containerState._closeFlow = void 0, i && R();
      const M = t.events.length;
      let P = M, D;
      for (; P--; )
        if (t.events[P][0] === "exit" && t.events[P][1].type === "chunkFlow") {
          D = t.events[P][1].end;
          break;
        }
      T(r);
      let q = M;
      for (; q < t.events.length; )
        t.events[q][1].end = {
          ...D
        }, q++;
      return $a(t.events, P + 1, 0, t.events.slice(M)), t.events.length = q, f(N);
    }
    return u(N);
  }
  function f(N) {
    if (r === n.length) {
      if (!i)
        return x(N);
      if (i.currentConstruct && i.currentConstruct.concrete)
        return w(N);
      t.interrupt = !!(i.currentConstruct && !i._gfmTableDynamicInterruptHack);
    }
    return t.containerState = {}, e.check(mN, h, m)(N);
  }
  function h(N) {
    return i && R(), T(r), x(N);
  }
  function m(N) {
    return t.parser.lazy[t.now().line] = r !== n.length, a = t.now().offset, w(N);
  }
  function x(N) {
    return t.containerState = {}, e.attempt(mN, b, w)(N);
  }
  function b(N) {
    return r++, n.push([t.currentConstruct, t.containerState]), x(N);
  }
  function w(N) {
    if (N === null) {
      i && R(), T(0), e.consume(N);
      return;
    }
    return i = i || t.parser.flow(t.now()), e.enter("chunkFlow", {
      _tokenizer: i,
      contentType: "flow",
      previous: s
    }), S(N);
  }
  function S(N) {
    if (N === null) {
      C(e.exit("chunkFlow"), !0), T(0), e.consume(N);
      return;
    }
    return Ot(N) ? (e.consume(N), C(e.exit("chunkFlow")), r = 0, t.interrupt = void 0, u) : (e.consume(N), S);
  }
  function C(N, M) {
    const P = t.sliceStream(N);
    if (M && P.push(null), N.previous = s, s && (s.next = N), s = N, i.defineSkip(N.start), i.write(P), t.parser.lazy[N.start.line]) {
      let D = i.events.length;
      for (; D--; )
        if (
          // The token starts before the line ending
          i.events[D][1].start.offset < a && // and either is not ended yet
          (!i.events[D][1].end || // or ends after it.
          i.events[D][1].end.offset > a)
        )
          return;
      const q = t.events.length;
      let Y = q, te, V;
      for (; Y--; )
        if (t.events[Y][0] === "exit" && t.events[Y][1].type === "chunkFlow") {
          if (te) {
            V = t.events[Y][1].end;
            break;
          }
          te = !0;
        }
      for (T(r), D = q; D < t.events.length; )
        t.events[D][1].end = {
          ...V
        }, D++;
      $a(t.events, Y + 1, 0, t.events.slice(q)), t.events.length = D;
    }
  }
  function T(N) {
    let M = n.length;
    for (; M-- > N; ) {
      const P = n[M];
      t.containerState = P[1], P[0].exit.call(t, e);
    }
    n.length = N;
  }
  function R() {
    i.write([null]), s = void 0, i = void 0, t.containerState._closeFlow = void 0;
  }
}
function XZ(e, t, n) {
  return _n(e, e.attempt(this.parser.constructs.document, t, n), "linePrefix", this.parser.constructs.disable.null.includes("codeIndented") ? void 0 : 4);
}
function Mm(e) {
  if (e === null || Jn(e) || bh(e))
    return 1;
  if (Jb(e))
    return 2;
}
function ew(e, t, n) {
  const r = [];
  let i = -1;
  for (; ++i < e.length; ) {
    const s = e[i].resolveAll;
    s && !r.includes(s) && (t = s(t, n), r.push(s));
  }
  return t;
}
const O3 = {
  name: "attention",
  resolveAll: QZ,
  tokenize: JZ
};
function QZ(e, t) {
  let n = -1, r, i, s, a, u, d, f, h;
  for (; ++n < e.length; )
    if (e[n][0] === "enter" && e[n][1].type === "attentionSequence" && e[n][1]._close) {
      for (r = n; r--; )
        if (e[r][0] === "exit" && e[r][1].type === "attentionSequence" && e[r][1]._open && // If the markers are the same:
        t.sliceSerialize(e[r][1]).charCodeAt(0) === t.sliceSerialize(e[n][1]).charCodeAt(0)) {
          if ((e[r][1]._close || e[n][1]._open) && (e[n][1].end.offset - e[n][1].start.offset) % 3 && !((e[r][1].end.offset - e[r][1].start.offset + e[n][1].end.offset - e[n][1].start.offset) % 3))
            continue;
          d = e[r][1].end.offset - e[r][1].start.offset > 1 && e[n][1].end.offset - e[n][1].start.offset > 1 ? 2 : 1;
          const m = {
            ...e[r][1].end
          }, x = {
            ...e[n][1].start
          };
          gN(m, -d), gN(x, d), a = {
            type: d > 1 ? "strongSequence" : "emphasisSequence",
            start: m,
            end: {
              ...e[r][1].end
            }
          }, u = {
            type: d > 1 ? "strongSequence" : "emphasisSequence",
            start: {
              ...e[n][1].start
            },
            end: x
          }, s = {
            type: d > 1 ? "strongText" : "emphasisText",
            start: {
              ...e[r][1].end
            },
            end: {
              ...e[n][1].start
            }
          }, i = {
            type: d > 1 ? "strong" : "emphasis",
            start: {
              ...a.start
            },
            end: {
              ...u.end
            }
          }, e[r][1].end = {
            ...a.start
          }, e[n][1].start = {
            ...u.end
          }, f = [], e[r][1].end.offset - e[r][1].start.offset && (f = so(f, [["enter", e[r][1], t], ["exit", e[r][1], t]])), f = so(f, [["enter", i, t], ["enter", a, t], ["exit", a, t], ["enter", s, t]]), f = so(f, ew(t.parser.constructs.insideSpan.null, e.slice(r + 1, n), t)), f = so(f, [["exit", s, t], ["enter", u, t], ["exit", u, t], ["exit", i, t]]), e[n][1].end.offset - e[n][1].start.offset ? (h = 2, f = so(f, [["enter", e[n][1], t], ["exit", e[n][1], t]])) : h = 0, $a(e, r - 1, n - r + 3, f), n = r + f.length - h - 2;
          break;
        }
    }
  for (n = -1; ++n < e.length; )
    e[n][1].type === "attentionSequence" && (e[n][1].type = "data");
  return e;
}
function JZ(e, t) {
  const n = this.parser.constructs.attentionMarkers.null, r = this.previous, i = Mm(r);
  let s;
  return a;
  function a(d) {
    return s = d, e.enter("attentionSequence"), u(d);
  }
  function u(d) {
    if (d === s)
      return e.consume(d), u;
    const f = e.exit("attentionSequence"), h = Mm(d), m = !h || h === 2 && i || n.includes(d), x = !i || i === 2 && h || n.includes(r);
    return f._open = !!(s === 42 ? m : m && (i || !x)), f._close = !!(s === 42 ? x : x && (h || !m)), t(d);
  }
}
function gN(e, t) {
  e.column += t, e.offset += t, e._bufferIndex += t;
}
const eX = {
  name: "autolink",
  tokenize: tX
};
function tX(e, t, n) {
  let r = 0;
  return i;
  function i(b) {
    return e.enter("autolink"), e.enter("autolinkMarker"), e.consume(b), e.exit("autolinkMarker"), e.enter("autolinkProtocol"), s;
  }
  function s(b) {
    return Os(b) ? (e.consume(b), a) : b === 64 ? n(b) : f(b);
  }
  function a(b) {
    return b === 43 || b === 45 || b === 46 || os(b) ? (r = 1, u(b)) : f(b);
  }
  function u(b) {
    return b === 58 ? (e.consume(b), r = 0, d) : (b === 43 || b === 45 || b === 46 || os(b)) && r++ < 32 ? (e.consume(b), u) : (r = 0, f(b));
  }
  function d(b) {
    return b === 62 ? (e.exit("autolinkProtocol"), e.enter("autolinkMarker"), e.consume(b), e.exit("autolinkMarker"), e.exit("autolink"), t) : b === null || b === 32 || b === 60 || cb(b) ? n(b) : (e.consume(b), d);
  }
  function f(b) {
    return b === 64 ? (e.consume(b), h) : HZ(b) ? (e.consume(b), f) : n(b);
  }
  function h(b) {
    return os(b) ? m(b) : n(b);
  }
  function m(b) {
    return b === 46 ? (e.consume(b), r = 0, h) : b === 62 ? (e.exit("autolinkProtocol").type = "autolinkEmail", e.enter("autolinkMarker"), e.consume(b), e.exit("autolinkMarker"), e.exit("autolink"), t) : x(b);
  }
  function x(b) {
    if ((b === 45 || os(b)) && r++ < 63) {
      const w = b === 45 ? x : m;
      return e.consume(b), w;
    }
    return n(b);
  }
}
const Jy = {
  partial: !0,
  tokenize: nX
};
function nX(e, t, n) {
  return r;
  function r(s) {
    return dn(s) ? _n(e, i, "linePrefix")(s) : i(s);
  }
  function i(s) {
    return s === null || Ot(s) ? t(s) : n(s);
  }
}
const oI = {
  continuation: {
    tokenize: iX
  },
  exit: sX,
  name: "blockQuote",
  tokenize: rX
};
function rX(e, t, n) {
  const r = this;
  return i;
  function i(a) {
    if (a === 62) {
      const u = r.containerState;
      return u.open || (e.enter("blockQuote", {
        _container: !0
      }), u.open = !0), e.enter("blockQuotePrefix"), e.enter("blockQuoteMarker"), e.consume(a), e.exit("blockQuoteMarker"), s;
    }
    return n(a);
  }
  function s(a) {
    return dn(a) ? (e.enter("blockQuotePrefixWhitespace"), e.consume(a), e.exit("blockQuotePrefixWhitespace"), e.exit("blockQuotePrefix"), t) : (e.exit("blockQuotePrefix"), t(a));
  }
}
function iX(e, t, n) {
  const r = this;
  return i;
  function i(a) {
    return dn(a) ? _n(e, s, "linePrefix", r.parser.constructs.disable.null.includes("codeIndented") ? void 0 : 4)(a) : s(a);
  }
  function s(a) {
    return e.attempt(oI, t, n)(a);
  }
}
function sX(e) {
  e.exit("blockQuote");
}
const lI = {
  name: "characterEscape",
  tokenize: aX
};
function aX(e, t, n) {
  return r;
  function r(s) {
    return e.enter("characterEscape"), e.enter("escapeMarker"), e.consume(s), e.exit("escapeMarker"), i;
  }
  function i(s) {
    return GZ(s) ? (e.enter("characterEscapeValue"), e.consume(s), e.exit("characterEscapeValue"), e.exit("characterEscape"), t) : n(s);
  }
}
const uI = {
  name: "characterReference",
  tokenize: oX
};
function oX(e, t, n) {
  const r = this;
  let i = 0, s, a;
  return u;
  function u(m) {
    return e.enter("characterReference"), e.enter("characterReferenceMarker"), e.consume(m), e.exit("characterReferenceMarker"), d;
  }
  function d(m) {
    return m === 35 ? (e.enter("characterReferenceMarkerNumeric"), e.consume(m), e.exit("characterReferenceMarkerNumeric"), f) : (e.enter("characterReferenceValue"), s = 31, a = os, h(m));
  }
  function f(m) {
    return m === 88 || m === 120 ? (e.enter("characterReferenceMarkerHexadecimal"), e.consume(m), e.exit("characterReferenceMarkerHexadecimal"), e.enter("characterReferenceValue"), s = 6, a = VZ, h) : (e.enter("characterReferenceValue"), s = 7, a = M3, h(m));
  }
  function h(m) {
    if (m === 59 && i) {
      const x = e.exit("characterReferenceValue");
      return a === os && !xT(r.sliceSerialize(x)) ? n(m) : (e.enter("characterReferenceMarker"), e.consume(m), e.exit("characterReferenceMarker"), e.exit("characterReference"), t);
    }
    return a(m) && i++ < s ? (e.consume(m), h) : n(m);
  }
}
const yN = {
  partial: !0,
  tokenize: uX
}, xN = {
  concrete: !0,
  name: "codeFenced",
  tokenize: lX
};
function lX(e, t, n) {
  const r = this, i = {
    partial: !0,
    tokenize: P
  };
  let s = 0, a = 0, u;
  return d;
  function d(D) {
    return f(D);
  }
  function f(D) {
    const q = r.events[r.events.length - 1];
    return s = q && q[1].type === "linePrefix" ? q[2].sliceSerialize(q[1], !0).length : 0, u = D, e.enter("codeFenced"), e.enter("codeFencedFence"), e.enter("codeFencedFenceSequence"), h(D);
  }
  function h(D) {
    return D === u ? (a++, e.consume(D), h) : a < 3 ? n(D) : (e.exit("codeFencedFenceSequence"), dn(D) ? _n(e, m, "whitespace")(D) : m(D));
  }
  function m(D) {
    return D === null || Ot(D) ? (e.exit("codeFencedFence"), r.interrupt ? t(D) : e.check(yN, S, M)(D)) : (e.enter("codeFencedFenceInfo"), e.enter("chunkString", {
      contentType: "string"
    }), x(D));
  }
  function x(D) {
    return D === null || Ot(D) ? (e.exit("chunkString"), e.exit("codeFencedFenceInfo"), m(D)) : dn(D) ? (e.exit("chunkString"), e.exit("codeFencedFenceInfo"), _n(e, b, "whitespace")(D)) : D === 96 && D === u ? n(D) : (e.consume(D), x);
  }
  function b(D) {
    return D === null || Ot(D) ? m(D) : (e.enter("codeFencedFenceMeta"), e.enter("chunkString", {
      contentType: "string"
    }), w(D));
  }
  function w(D) {
    return D === null || Ot(D) ? (e.exit("chunkString"), e.exit("codeFencedFenceMeta"), m(D)) : D === 96 && D === u ? n(D) : (e.consume(D), w);
  }
  function S(D) {
    return e.attempt(i, M, C)(D);
  }
  function C(D) {
    return e.enter("lineEnding"), e.consume(D), e.exit("lineEnding"), T;
  }
  function T(D) {
    return s > 0 && dn(D) ? _n(e, R, "linePrefix", s + 1)(D) : R(D);
  }
  function R(D) {
    return D === null || Ot(D) ? e.check(yN, S, M)(D) : (e.enter("codeFlowValue"), N(D));
  }
  function N(D) {
    return D === null || Ot(D) ? (e.exit("codeFlowValue"), R(D)) : (e.consume(D), N);
  }
  function M(D) {
    return e.exit("codeFenced"), t(D);
  }
  function P(D, q, Y) {
    let te = 0;
    return V;
    function V(oe) {
      return D.enter("lineEnding"), D.consume(oe), D.exit("lineEnding"), $;
    }
    function $(oe) {
      return D.enter("codeFencedFence"), dn(oe) ? _n(D, G, "linePrefix", r.parser.constructs.disable.null.includes("codeIndented") ? void 0 : 4)(oe) : G(oe);
    }
    function G(oe) {
      return oe === u ? (D.enter("codeFencedFenceSequence"), le(oe)) : Y(oe);
    }
    function le(oe) {
      return oe === u ? (te++, D.consume(oe), le) : te >= a ? (D.exit("codeFencedFenceSequence"), dn(oe) ? _n(D, Z, "whitespace")(oe) : Z(oe)) : Y(oe);
    }
    function Z(oe) {
      return oe === null || Ot(oe) ? (D.exit("codeFencedFence"), q(oe)) : Y(oe);
    }
  }
}
function uX(e, t, n) {
  const r = this;
  return i;
  function i(a) {
    return a === null ? n(a) : (e.enter("lineEnding"), e.consume(a), e.exit("lineEnding"), s);
  }
  function s(a) {
    return r.parser.lazy[r.now().line] ? n(a) : t(a);
  }
}
const X2 = {
  name: "codeIndented",
  tokenize: dX
}, cX = {
  partial: !0,
  tokenize: fX
};
function dX(e, t, n) {
  const r = this;
  return i;
  function i(f) {
    return e.enter("codeIndented"), _n(e, s, "linePrefix", 5)(f);
  }
  function s(f) {
    const h = r.events[r.events.length - 1];
    return h && h[1].type === "linePrefix" && h[2].sliceSerialize(h[1], !0).length >= 4 ? a(f) : n(f);
  }
  function a(f) {
    return f === null ? d(f) : Ot(f) ? e.attempt(cX, a, d)(f) : (e.enter("codeFlowValue"), u(f));
  }
  function u(f) {
    return f === null || Ot(f) ? (e.exit("codeFlowValue"), a(f)) : (e.consume(f), u);
  }
  function d(f) {
    return e.exit("codeIndented"), t(f);
  }
}
function fX(e, t, n) {
  const r = this;
  return i;
  function i(a) {
    return r.parser.lazy[r.now().line] ? n(a) : Ot(a) ? (e.enter("lineEnding"), e.consume(a), e.exit("lineEnding"), i) : _n(e, s, "linePrefix", 5)(a);
  }
  function s(a) {
    const u = r.events[r.events.length - 1];
    return u && u[1].type === "linePrefix" && u[2].sliceSerialize(u[1], !0).length >= 4 ? t(a) : Ot(a) ? i(a) : n(a);
  }
}
const hX = {
  name: "codeText",
  previous: mX,
  resolve: pX,
  tokenize: gX
};
function pX(e) {
  let t = e.length - 4, n = 3, r, i;
  if ((e[n][1].type === "lineEnding" || e[n][1].type === "space") && (e[t][1].type === "lineEnding" || e[t][1].type === "space")) {
    for (r = n; ++r < t; )
      if (e[r][1].type === "codeTextData") {
        e[n][1].type = "codeTextPadding", e[t][1].type = "codeTextPadding", n += 2, t -= 2;
        break;
      }
  }
  for (r = n - 1, t++; ++r <= t; )
    i === void 0 ? r !== t && e[r][1].type !== "lineEnding" && (i = r) : (r === t || e[r][1].type === "lineEnding") && (e[i][1].type = "codeTextData", r !== i + 2 && (e[i][1].end = e[r - 1][1].end, e.splice(i + 2, r - i - 2), t -= r - i - 2, r = i + 2), i = void 0);
  return e;
}
function mX(e) {
  return e !== 96 || this.events[this.events.length - 1][1].type === "characterEscape";
}
function gX(e, t, n) {
  let r = 0, i, s;
  return a;
  function a(m) {
    return e.enter("codeText"), e.enter("codeTextSequence"), u(m);
  }
  function u(m) {
    return m === 96 ? (e.consume(m), r++, u) : (e.exit("codeTextSequence"), d(m));
  }
  function d(m) {
    return m === null ? n(m) : m === 32 ? (e.enter("space"), e.consume(m), e.exit("space"), d) : m === 96 ? (s = e.enter("codeTextSequence"), i = 0, h(m)) : Ot(m) ? (e.enter("lineEnding"), e.consume(m), e.exit("lineEnding"), d) : (e.enter("codeTextData"), f(m));
  }
  function f(m) {
    return m === null || m === 32 || m === 96 || Ot(m) ? (e.exit("codeTextData"), d(m)) : (e.consume(m), f);
  }
  function h(m) {
    return m === 96 ? (e.consume(m), i++, h) : i === r ? (e.exit("codeTextSequence"), e.exit("codeText"), t(m)) : (s.type = "codeTextData", f(m));
  }
}
class yX {
  /**
   * @param {ReadonlyArray<T> | null | undefined} [initial]
   *   Initial items (optional).
   * @returns
   *   Splice buffer.
   */
  constructor(t) {
    this.left = t ? [...t] : [], this.right = [];
  }
  /**
   * Array access;
   * does not move the cursor.
   *
   * @param {number} index
   *   Index.
   * @return {T}
   *   Item.
   */
  get(t) {
    if (t < 0 || t >= this.left.length + this.right.length)
      throw new RangeError("Cannot access index `" + t + "` in a splice buffer of size `" + (this.left.length + this.right.length) + "`");
    return t < this.left.length ? this.left[t] : this.right[this.right.length - t + this.left.length - 1];
  }
  /**
   * The length of the splice buffer, one greater than the largest index in the
   * array.
   */
  get length() {
    return this.left.length + this.right.length;
  }
  /**
   * Remove and return `list[0]`;
   * moves the cursor to `0`.
   *
   * @returns {T | undefined}
   *   Item, optional.
   */
  shift() {
    return this.setCursor(0), this.right.pop();
  }
  /**
   * Slice the buffer to get an array;
   * does not move the cursor.
   *
   * @param {number} start
   *   Start.
   * @param {number | null | undefined} [end]
   *   End (optional).
   * @returns {Array<T>}
   *   Array of items.
   */
  slice(t, n) {
    const r = n ?? Number.POSITIVE_INFINITY;
    return r < this.left.length ? this.left.slice(t, r) : t > this.left.length ? this.right.slice(this.right.length - r + this.left.length, this.right.length - t + this.left.length).reverse() : this.left.slice(t).concat(this.right.slice(this.right.length - r + this.left.length).reverse());
  }
  /**
   * Mimics the behavior of Array.prototype.splice() except for the change of
   * interface necessary to avoid segfaults when patching in very large arrays.
   *
   * This operation moves cursor is moved to `start` and results in the cursor
   * placed after any inserted items.
   *
   * @param {number} start
   *   Start;
   *   zero-based index at which to start changing the array;
   *   negative numbers count backwards from the end of the array and values
   *   that are out-of bounds are clamped to the appropriate end of the array.
   * @param {number | null | undefined} [deleteCount=0]
   *   Delete count (default: `0`);
   *   maximum number of elements to delete, starting from start.
   * @param {Array<T> | null | undefined} [items=[]]
   *   Items to include in place of the deleted items (default: `[]`).
   * @return {Array<T>}
   *   Any removed items.
   */
  splice(t, n, r) {
    const i = n || 0;
    this.setCursor(Math.trunc(t));
    const s = this.right.splice(this.right.length - i, Number.POSITIVE_INFINITY);
    return r && q0(this.left, r), s.reverse();
  }
  /**
   * Remove and return the highest-numbered item in the array, so
   * `list[list.length - 1]`;
   * Moves the cursor to `length`.
   *
   * @returns {T | undefined}
   *   Item, optional.
   */
  pop() {
    return this.setCursor(Number.POSITIVE_INFINITY), this.left.pop();
  }
  /**
   * Inserts a single item to the high-numbered side of the array;
   * moves the cursor to `length`.
   *
   * @param {T} item
   *   Item.
   * @returns {undefined}
   *   Nothing.
   */
  push(t) {
    this.setCursor(Number.POSITIVE_INFINITY), this.left.push(t);
  }
  /**
   * Inserts many items to the high-numbered side of the array.
   * Moves the cursor to `length`.
   *
   * @param {Array<T>} items
   *   Items.
   * @returns {undefined}
   *   Nothing.
   */
  pushMany(t) {
    this.setCursor(Number.POSITIVE_INFINITY), q0(this.left, t);
  }
  /**
   * Inserts a single item to the low-numbered side of the array;
   * Moves the cursor to `0`.
   *
   * @param {T} item
   *   Item.
   * @returns {undefined}
   *   Nothing.
   */
  unshift(t) {
    this.setCursor(0), this.right.push(t);
  }
  /**
   * Inserts many items to the low-numbered side of the array;
   * moves the cursor to `0`.
   *
   * @param {Array<T>} items
   *   Items.
   * @returns {undefined}
   *   Nothing.
   */
  unshiftMany(t) {
    this.setCursor(0), q0(this.right, t.reverse());
  }
  /**
   * Move the cursor to a specific position in the array. Requires
   * time proportional to the distance moved.
   *
   * If `n < 0`, the cursor will end up at the beginning.
   * If `n > length`, the cursor will end up at the end.
   *
   * @param {number} n
   *   Position.
   * @return {undefined}
   *   Nothing.
   */
  setCursor(t) {
    if (!(t === this.left.length || t > this.left.length && this.right.length === 0 || t < 0 && this.left.length === 0))
      if (t < this.left.length) {
        const n = this.left.splice(t, Number.POSITIVE_INFINITY);
        q0(this.right, n.reverse());
      } else {
        const n = this.right.splice(this.left.length + this.right.length - t, Number.POSITIVE_INFINITY);
        q0(this.left, n.reverse());
      }
  }
}
function q0(e, t) {
  let n = 0;
  if (t.length < 1e4)
    e.push(...t);
  else
    for (; n < t.length; )
      e.push(...t.slice(n, n + 1e4)), n += 1e4;
}
function cI(e) {
  const t = {};
  let n = -1, r, i, s, a, u, d, f;
  const h = new yX(e);
  for (; ++n < h.length; ) {
    for (; n in t; )
      n = t[n];
    if (r = h.get(n), n && r[1].type === "chunkFlow" && h.get(n - 1)[1].type === "listItemPrefix" && (d = r[1]._tokenizer.events, s = 0, s < d.length && d[s][1].type === "lineEndingBlank" && (s += 2), s < d.length && d[s][1].type === "content"))
      for (; ++s < d.length && d[s][1].type !== "content"; )
        d[s][1].type === "chunkText" && (d[s][1]._isInFirstContentOfListItem = !0, s++);
    if (r[0] === "enter")
      r[1].contentType && (Object.assign(t, xX(h, n)), n = t[n], f = !0);
    else if (r[1]._container) {
      for (s = n, i = void 0; s--; )
        if (a = h.get(s), a[1].type === "lineEnding" || a[1].type === "lineEndingBlank")
          a[0] === "enter" && (i && (h.get(i)[1].type = "lineEndingBlank"), a[1].type = "lineEnding", i = s);
        else if (!(a[1].type === "linePrefix" || a[1].type === "listItemIndent")) break;
      i && (r[1].end = {
        ...h.get(i)[1].start
      }, u = h.slice(i, n), u.unshift(r), h.splice(i, n - i + 1, u));
    }
  }
  return $a(e, 0, Number.POSITIVE_INFINITY, h.slice(0)), !f;
}
function xX(e, t) {
  const n = e.get(t)[1], r = e.get(t)[2];
  let i = t - 1;
  const s = [];
  let a = n._tokenizer;
  a || (a = r.parser[n.contentType](n.start), n._contentTypeTextTrailing && (a._contentTypeTextTrailing = !0));
  const u = a.events, d = [], f = {};
  let h, m, x = -1, b = n, w = 0, S = 0;
  const C = [S];
  for (; b; ) {
    for (; e.get(++i)[1] !== b; )
      ;
    s.push(i), b._tokenizer || (h = r.sliceStream(b), b.next || h.push(null), m && a.defineSkip(b.start), b._isInFirstContentOfListItem && (a._gfmTasklistFirstContentOfListItem = !0), a.write(h), b._isInFirstContentOfListItem && (a._gfmTasklistFirstContentOfListItem = void 0)), m = b, b = b.next;
  }
  for (b = n; ++x < u.length; )
    // Find a void token that includes a break.
    u[x][0] === "exit" && u[x - 1][0] === "enter" && u[x][1].type === u[x - 1][1].type && u[x][1].start.line !== u[x][1].end.line && (S = x + 1, C.push(S), b._tokenizer = void 0, b.previous = void 0, b = b.next);
  for (a.events = [], b ? (b._tokenizer = void 0, b.previous = void 0) : C.pop(), x = C.length; x--; ) {
    const T = u.slice(C[x], C[x + 1]), R = s.pop();
    d.push([R, R + T.length - 1]), e.splice(R, 2, T);
  }
  for (d.reverse(), x = -1; ++x < d.length; )
    f[w + d[x][0]] = w + d[x][1], w += d[x][1] - d[x][0] - 1;
  return f;
}
const vX = {
  resolve: wX,
  tokenize: _X
}, bX = {
  partial: !0,
  tokenize: SX
};
function wX(e) {
  return cI(e), e;
}
function _X(e, t) {
  let n;
  return r;
  function r(u) {
    return e.enter("content"), n = e.enter("chunkContent", {
      contentType: "content"
    }), i(u);
  }
  function i(u) {
    return u === null ? s(u) : Ot(u) ? e.check(bX, a, s)(u) : (e.consume(u), i);
  }
  function s(u) {
    return e.exit("chunkContent"), e.exit("content"), t(u);
  }
  function a(u) {
    return e.consume(u), e.exit("chunkContent"), n.next = e.enter("chunkContent", {
      contentType: "content",
      previous: n
    }), n = n.next, i;
  }
}
function SX(e, t, n) {
  const r = this;
  return i;
  function i(a) {
    return e.exit("chunkContent"), e.enter("lineEnding"), e.consume(a), e.exit("lineEnding"), _n(e, s, "linePrefix");
  }
  function s(a) {
    if (a === null || Ot(a))
      return n(a);
    const u = r.events[r.events.length - 1];
    return !r.parser.constructs.disable.null.includes("codeIndented") && u && u[1].type === "linePrefix" && u[2].sliceSerialize(u[1], !0).length >= 4 ? t(a) : e.interrupt(r.parser.constructs.flow, n, t)(a);
  }
}
function dI(e, t, n, r, i, s, a, u, d) {
  const f = d || Number.POSITIVE_INFINITY;
  let h = 0;
  return m;
  function m(T) {
    return T === 60 ? (e.enter(r), e.enter(i), e.enter(s), e.consume(T), e.exit(s), x) : T === null || T === 32 || T === 41 || cb(T) ? n(T) : (e.enter(r), e.enter(a), e.enter(u), e.enter("chunkString", {
      contentType: "string"
    }), S(T));
  }
  function x(T) {
    return T === 62 ? (e.enter(s), e.consume(T), e.exit(s), e.exit(i), e.exit(r), t) : (e.enter(u), e.enter("chunkString", {
      contentType: "string"
    }), b(T));
  }
  function b(T) {
    return T === 62 ? (e.exit("chunkString"), e.exit(u), x(T)) : T === null || T === 60 || Ot(T) ? n(T) : (e.consume(T), T === 92 ? w : b);
  }
  function w(T) {
    return T === 60 || T === 62 || T === 92 ? (e.consume(T), b) : b(T);
  }
  function S(T) {
    return !h && (T === null || T === 41 || Jn(T)) ? (e.exit("chunkString"), e.exit(u), e.exit(a), e.exit(r), t(T)) : h < f && T === 40 ? (e.consume(T), h++, S) : T === 41 ? (e.consume(T), h--, S) : T === null || T === 32 || T === 40 || cb(T) ? n(T) : (e.consume(T), T === 92 ? C : S);
  }
  function C(T) {
    return T === 40 || T === 41 || T === 92 ? (e.consume(T), S) : S(T);
  }
}
function fI(e, t, n, r, i, s) {
  const a = this;
  let u = 0, d;
  return f;
  function f(b) {
    return e.enter(r), e.enter(i), e.consume(b), e.exit(i), e.enter(s), h;
  }
  function h(b) {
    return u > 999 || b === null || b === 91 || b === 93 && !d || // To do: remove in the future once weve switched from
    // `micromark-extension-footnote` to `micromark-extension-gfm-footnote`,
    // which doesnt need this.
    // Hidden footnotes hook.
    /* c8 ignore next 3 */
    b === 94 && !u && "_hiddenFootnoteSupport" in a.parser.constructs ? n(b) : b === 93 ? (e.exit(s), e.enter(i), e.consume(b), e.exit(i), e.exit(r), t) : Ot(b) ? (e.enter("lineEnding"), e.consume(b), e.exit("lineEnding"), h) : (e.enter("chunkString", {
      contentType: "string"
    }), m(b));
  }
  function m(b) {
    return b === null || b === 91 || b === 93 || Ot(b) || u++ > 999 ? (e.exit("chunkString"), h(b)) : (e.consume(b), d || (d = !dn(b)), b === 92 ? x : m);
  }
  function x(b) {
    return b === 91 || b === 92 || b === 93 ? (e.consume(b), u++, m) : m(b);
  }
}
function hI(e, t, n, r, i, s) {
  let a;
  return u;
  function u(x) {
    return x === 34 || x === 39 || x === 40 ? (e.enter(r), e.enter(i), e.consume(x), e.exit(i), a = x === 40 ? 41 : x, d) : n(x);
  }
  function d(x) {
    return x === a ? (e.enter(i), e.consume(x), e.exit(i), e.exit(r), t) : (e.enter(s), f(x));
  }
  function f(x) {
    return x === a ? (e.exit(s), d(a)) : x === null ? n(x) : Ot(x) ? (e.enter("lineEnding"), e.consume(x), e.exit("lineEnding"), _n(e, f, "linePrefix")) : (e.enter("chunkString", {
      contentType: "string"
    }), h(x));
  }
  function h(x) {
    return x === a || x === null || Ot(x) ? (e.exit("chunkString"), f(x)) : (e.consume(x), x === 92 ? m : h);
  }
  function m(x) {
    return x === a || x === 92 ? (e.consume(x), h) : h(x);
  }
}
function uy(e, t) {
  let n;
  return r;
  function r(i) {
    return Ot(i) ? (e.enter("lineEnding"), e.consume(i), e.exit("lineEnding"), n = !0, r) : dn(i) ? _n(e, r, n ? "linePrefix" : "lineSuffix")(i) : t(i);
  }
}
const EX = {
  name: "definition",
  tokenize: kX
}, CX = {
  partial: !0,
  tokenize: TX
};
function kX(e, t, n) {
  const r = this;
  let i;
  return s;
  function s(b) {
    return e.enter("definition"), a(b);
  }
  function a(b) {
    return fI.call(
      r,
      e,
      u,
      // Note: we dont need to reset the way `markdown-rs` does.
      n,
      "definitionLabel",
      "definitionLabelMarker",
      "definitionLabelString"
    )(b);
  }
  function u(b) {
    return i = rl(r.sliceSerialize(r.events[r.events.length - 1][1]).slice(1, -1)), b === 58 ? (e.enter("definitionMarker"), e.consume(b), e.exit("definitionMarker"), d) : n(b);
  }
  function d(b) {
    return Jn(b) ? uy(e, f)(b) : f(b);
  }
  function f(b) {
    return dI(
      e,
      h,
      // Note: we dont need to reset the way `markdown-rs` does.
      n,
      "definitionDestination",
      "definitionDestinationLiteral",
      "definitionDestinationLiteralMarker",
      "definitionDestinationRaw",
      "definitionDestinationString"
    )(b);
  }
  function h(b) {
    return e.attempt(CX, m, m)(b);
  }
  function m(b) {
    return dn(b) ? _n(e, x, "whitespace")(b) : x(b);
  }
  function x(b) {
    return b === null || Ot(b) ? (e.exit("definition"), r.parser.defined.push(i), t(b)) : n(b);
  }
}
function TX(e, t, n) {
  return r;
  function r(u) {
    return Jn(u) ? uy(e, i)(u) : n(u);
  }
  function i(u) {
    return hI(e, s, n, "definitionTitle", "definitionTitleMarker", "definitionTitleString")(u);
  }
  function s(u) {
    return dn(u) ? _n(e, a, "whitespace")(u) : a(u);
  }
  function a(u) {
    return u === null || Ot(u) ? t(u) : n(u);
  }
}
const jX = {
  name: "hardBreakEscape",
  tokenize: AX
};
function AX(e, t, n) {
  return r;
  function r(s) {
    return e.enter("hardBreakEscape"), e.consume(s), i;
  }
  function i(s) {
    return Ot(s) ? (e.exit("hardBreakEscape"), t(s)) : n(s);
  }
}
const NX = {
  name: "headingAtx",
  resolve: RX,
  tokenize: MX
};
function RX(e, t) {
  let n = e.length - 2, r = 3, i, s;
  return e[r][1].type === "whitespace" && (r += 2), n - 2 > r && e[n][1].type === "whitespace" && (n -= 2), e[n][1].type === "atxHeadingSequence" && (r === n - 1 || n - 4 > r && e[n - 2][1].type === "whitespace") && (n -= r + 1 === n ? 2 : 4), n > r && (i = {
    type: "atxHeadingText",
    start: e[r][1].start,
    end: e[n][1].end
  }, s = {
    type: "chunkText",
    start: e[r][1].start,
    end: e[n][1].end,
    contentType: "text"
  }, $a(e, r, n - r + 1, [["enter", i, t], ["enter", s, t], ["exit", s, t], ["exit", i, t]])), e;
}
function MX(e, t, n) {
  let r = 0;
  return i;
  function i(h) {
    return e.enter("atxHeading"), s(h);
  }
  function s(h) {
    return e.enter("atxHeadingSequence"), a(h);
  }
  function a(h) {
    return h === 35 && r++ < 6 ? (e.consume(h), a) : h === null || Jn(h) ? (e.exit("atxHeadingSequence"), u(h)) : n(h);
  }
  function u(h) {
    return h === 35 ? (e.enter("atxHeadingSequence"), d(h)) : h === null || Ot(h) ? (e.exit("atxHeading"), t(h)) : dn(h) ? _n(e, u, "whitespace")(h) : (e.enter("atxHeadingText"), f(h));
  }
  function d(h) {
    return h === 35 ? (e.consume(h), d) : (e.exit("atxHeadingSequence"), u(h));
  }
  function f(h) {
    return h === null || h === 35 || Jn(h) ? (e.exit("atxHeadingText"), u(h)) : (e.consume(h), f);
  }
}
const OX = [
  "address",
  "article",
  "aside",
  "base",
  "basefont",
  "blockquote",
  "body",
  "caption",
  "center",
  "col",
  "colgroup",
  "dd",
  "details",
  "dialog",
  "dir",
  "div",
  "dl",
  "dt",
  "fieldset",
  "figcaption",
  "figure",
  "footer",
  "form",
  "frame",
  "frameset",
  "h1",
  "h2",
  "h3",
  "h4",
  "h5",
  "h6",
  "head",
  "header",
  "hr",
  "html",
  "iframe",
  "legend",
  "li",
  "link",
  "main",
  "menu",
  "menuitem",
  "nav",
  "noframes",
  "ol",
  "optgroup",
  "option",
  "p",
  "param",
  "search",
  "section",
  "summary",
  "table",
  "tbody",
  "td",
  "tfoot",
  "th",
  "thead",
  "title",
  "tr",
  "track",
  "ul"
], vN = ["pre", "script", "style", "textarea"], DX = {
  concrete: !0,
  name: "htmlFlow",
  resolveTo: IX,
  tokenize: LX
}, zX = {
  partial: !0,
  tokenize: $X
}, PX = {
  partial: !0,
  tokenize: BX
};
function IX(e) {
  let t = e.length;
  for (; t-- && !(e[t][0] === "enter" && e[t][1].type === "htmlFlow"); )
    ;
  return t > 1 && e[t - 2][1].type === "linePrefix" && (e[t][1].start = e[t - 2][1].start, e[t + 1][1].start = e[t - 2][1].start, e.splice(t - 2, 2)), e;
}
function LX(e, t, n) {
  const r = this;
  let i, s, a, u, d;
  return f;
  function f(Q) {
    return h(Q);
  }
  function h(Q) {
    return e.enter("htmlFlow"), e.enter("htmlFlowData"), e.consume(Q), m;
  }
  function m(Q) {
    return Q === 33 ? (e.consume(Q), x) : Q === 47 ? (e.consume(Q), s = !0, S) : Q === 63 ? (e.consume(Q), i = 3, r.interrupt ? t : H) : Os(Q) ? (e.consume(Q), a = String.fromCharCode(Q), C) : n(Q);
  }
  function x(Q) {
    return Q === 45 ? (e.consume(Q), i = 2, b) : Q === 91 ? (e.consume(Q), i = 5, u = 0, w) : Os(Q) ? (e.consume(Q), i = 4, r.interrupt ? t : H) : n(Q);
  }
  function b(Q) {
    return Q === 45 ? (e.consume(Q), r.interrupt ? t : H) : n(Q);
  }
  function w(Q) {
    const fe = "CDATA[";
    return Q === fe.charCodeAt(u++) ? (e.consume(Q), u === fe.length ? r.interrupt ? t : G : w) : n(Q);
  }
  function S(Q) {
    return Os(Q) ? (e.consume(Q), a = String.fromCharCode(Q), C) : n(Q);
  }
  function C(Q) {
    if (Q === null || Q === 47 || Q === 62 || Jn(Q)) {
      const fe = Q === 47, ve = a.toLowerCase();
      return !fe && !s && vN.includes(ve) ? (i = 1, r.interrupt ? t(Q) : G(Q)) : OX.includes(a.toLowerCase()) ? (i = 6, fe ? (e.consume(Q), T) : r.interrupt ? t(Q) : G(Q)) : (i = 7, r.interrupt && !r.parser.lazy[r.now().line] ? n(Q) : s ? R(Q) : N(Q));
    }
    return Q === 45 || os(Q) ? (e.consume(Q), a += String.fromCharCode(Q), C) : n(Q);
  }
  function T(Q) {
    return Q === 62 ? (e.consume(Q), r.interrupt ? t : G) : n(Q);
  }
  function R(Q) {
    return dn(Q) ? (e.consume(Q), R) : V(Q);
  }
  function N(Q) {
    return Q === 47 ? (e.consume(Q), V) : Q === 58 || Q === 95 || Os(Q) ? (e.consume(Q), M) : dn(Q) ? (e.consume(Q), N) : V(Q);
  }
  function M(Q) {
    return Q === 45 || Q === 46 || Q === 58 || Q === 95 || os(Q) ? (e.consume(Q), M) : P(Q);
  }
  function P(Q) {
    return Q === 61 ? (e.consume(Q), D) : dn(Q) ? (e.consume(Q), P) : N(Q);
  }
  function D(Q) {
    return Q === null || Q === 60 || Q === 61 || Q === 62 || Q === 96 ? n(Q) : Q === 34 || Q === 39 ? (e.consume(Q), d = Q, q) : dn(Q) ? (e.consume(Q), D) : Y(Q);
  }
  function q(Q) {
    return Q === d ? (e.consume(Q), d = null, te) : Q === null || Ot(Q) ? n(Q) : (e.consume(Q), q);
  }
  function Y(Q) {
    return Q === null || Q === 34 || Q === 39 || Q === 47 || Q === 60 || Q === 61 || Q === 62 || Q === 96 || Jn(Q) ? P(Q) : (e.consume(Q), Y);
  }
  function te(Q) {
    return Q === 47 || Q === 62 || dn(Q) ? N(Q) : n(Q);
  }
  function V(Q) {
    return Q === 62 ? (e.consume(Q), $) : n(Q);
  }
  function $(Q) {
    return Q === null || Ot(Q) ? G(Q) : dn(Q) ? (e.consume(Q), $) : n(Q);
  }
  function G(Q) {
    return Q === 45 && i === 2 ? (e.consume(Q), X) : Q === 60 && i === 1 ? (e.consume(Q), ce) : Q === 62 && i === 4 ? (e.consume(Q), J) : Q === 63 && i === 3 ? (e.consume(Q), H) : Q === 93 && i === 5 ? (e.consume(Q), de) : Ot(Q) && (i === 6 || i === 7) ? (e.exit("htmlFlowData"), e.check(zX, ge, le)(Q)) : Q === null || Ot(Q) ? (e.exit("htmlFlowData"), le(Q)) : (e.consume(Q), G);
  }
  function le(Q) {
    return e.check(PX, Z, ge)(Q);
  }
  function Z(Q) {
    return e.enter("lineEnding"), e.consume(Q), e.exit("lineEnding"), oe;
  }
  function oe(Q) {
    return Q === null || Ot(Q) ? le(Q) : (e.enter("htmlFlowData"), G(Q));
  }
  function X(Q) {
    return Q === 45 ? (e.consume(Q), H) : G(Q);
  }
  function ce(Q) {
    return Q === 47 ? (e.consume(Q), a = "", pe) : G(Q);
  }
  function pe(Q) {
    if (Q === 62) {
      const fe = a.toLowerCase();
      return vN.includes(fe) ? (e.consume(Q), J) : G(Q);
    }
    return Os(Q) && a.length < 8 ? (e.consume(Q), a += String.fromCharCode(Q), pe) : G(Q);
  }
  function de(Q) {
    return Q === 93 ? (e.consume(Q), H) : G(Q);
  }
  function H(Q) {
    return Q === 62 ? (e.consume(Q), J) : Q === 45 && i === 2 ? (e.consume(Q), H) : G(Q);
  }
  function J(Q) {
    return Q === null || Ot(Q) ? (e.exit("htmlFlowData"), ge(Q)) : (e.consume(Q), J);
  }
  function ge(Q) {
    return e.exit("htmlFlow"), t(Q);
  }
}
function BX(e, t, n) {
  const r = this;
  return i;
  function i(a) {
    return Ot(a) ? (e.enter("lineEnding"), e.consume(a), e.exit("lineEnding"), s) : n(a);
  }
  function s(a) {
    return r.parser.lazy[r.now().line] ? n(a) : t(a);
  }
}
function $X(e, t, n) {
  return r;
  function r(i) {
    return e.enter("lineEnding"), e.consume(i), e.exit("lineEnding"), e.attempt(Jy, t, n);
  }
}
const qX = {
  name: "htmlText",
  tokenize: FX
};
function FX(e, t, n) {
  const r = this;
  let i, s, a;
  return u;
  function u(H) {
    return e.enter("htmlText"), e.enter("htmlTextData"), e.consume(H), d;
  }
  function d(H) {
    return H === 33 ? (e.consume(H), f) : H === 47 ? (e.consume(H), P) : H === 63 ? (e.consume(H), N) : Os(H) ? (e.consume(H), Y) : n(H);
  }
  function f(H) {
    return H === 45 ? (e.consume(H), h) : H === 91 ? (e.consume(H), s = 0, w) : Os(H) ? (e.consume(H), R) : n(H);
  }
  function h(H) {
    return H === 45 ? (e.consume(H), b) : n(H);
  }
  function m(H) {
    return H === null ? n(H) : H === 45 ? (e.consume(H), x) : Ot(H) ? (a = m, ce(H)) : (e.consume(H), m);
  }
  function x(H) {
    return H === 45 ? (e.consume(H), b) : m(H);
  }
  function b(H) {
    return H === 62 ? X(H) : H === 45 ? x(H) : m(H);
  }
  function w(H) {
    const J = "CDATA[";
    return H === J.charCodeAt(s++) ? (e.consume(H), s === J.length ? S : w) : n(H);
  }
  function S(H) {
    return H === null ? n(H) : H === 93 ? (e.consume(H), C) : Ot(H) ? (a = S, ce(H)) : (e.consume(H), S);
  }
  function C(H) {
    return H === 93 ? (e.consume(H), T) : S(H);
  }
  function T(H) {
    return H === 62 ? X(H) : H === 93 ? (e.consume(H), T) : S(H);
  }
  function R(H) {
    return H === null || H === 62 ? X(H) : Ot(H) ? (a = R, ce(H)) : (e.consume(H), R);
  }
  function N(H) {
    return H === null ? n(H) : H === 63 ? (e.consume(H), M) : Ot(H) ? (a = N, ce(H)) : (e.consume(H), N);
  }
  function M(H) {
    return H === 62 ? X(H) : N(H);
  }
  function P(H) {
    return Os(H) ? (e.consume(H), D) : n(H);
  }
  function D(H) {
    return H === 45 || os(H) ? (e.consume(H), D) : q(H);
  }
  function q(H) {
    return Ot(H) ? (a = q, ce(H)) : dn(H) ? (e.consume(H), q) : X(H);
  }
  function Y(H) {
    return H === 45 || os(H) ? (e.consume(H), Y) : H === 47 || H === 62 || Jn(H) ? te(H) : n(H);
  }
  function te(H) {
    return H === 47 ? (e.consume(H), X) : H === 58 || H === 95 || Os(H) ? (e.consume(H), V) : Ot(H) ? (a = te, ce(H)) : dn(H) ? (e.consume(H), te) : X(H);
  }
  function V(H) {
    return H === 45 || H === 46 || H === 58 || H === 95 || os(H) ? (e.consume(H), V) : $(H);
  }
  function $(H) {
    return H === 61 ? (e.consume(H), G) : Ot(H) ? (a = $, ce(H)) : dn(H) ? (e.consume(H), $) : te(H);
  }
  function G(H) {
    return H === null || H === 60 || H === 61 || H === 62 || H === 96 ? n(H) : H === 34 || H === 39 ? (e.consume(H), i = H, le) : Ot(H) ? (a = G, ce(H)) : dn(H) ? (e.consume(H), G) : (e.consume(H), Z);
  }
  function le(H) {
    return H === i ? (e.consume(H), i = void 0, oe) : H === null ? n(H) : Ot(H) ? (a = le, ce(H)) : (e.consume(H), le);
  }
  function Z(H) {
    return H === null || H === 34 || H === 39 || H === 60 || H === 61 || H === 96 ? n(H) : H === 47 || H === 62 || Jn(H) ? te(H) : (e.consume(H), Z);
  }
  function oe(H) {
    return H === 47 || H === 62 || Jn(H) ? te(H) : n(H);
  }
  function X(H) {
    return H === 62 ? (e.consume(H), e.exit("htmlTextData"), e.exit("htmlText"), t) : n(H);
  }
  function ce(H) {
    return e.exit("htmlTextData"), e.enter("lineEnding"), e.consume(H), e.exit("lineEnding"), pe;
  }
  function pe(H) {
    return dn(H) ? _n(e, de, "linePrefix", r.parser.constructs.disable.null.includes("codeIndented") ? void 0 : 4)(H) : de(H);
  }
  function de(H) {
    return e.enter("htmlTextData"), a(H);
  }
}
const vT = {
  name: "labelEnd",
  resolveAll: GX,
  resolveTo: KX,
  tokenize: YX
}, UX = {
  tokenize: WX
}, HX = {
  tokenize: ZX
}, VX = {
  tokenize: XX
};
function GX(e) {
  let t = -1;
  const n = [];
  for (; ++t < e.length; ) {
    const r = e[t][1];
    if (n.push(e[t]), r.type === "labelImage" || r.type === "labelLink" || r.type === "labelEnd") {
      const i = r.type === "labelImage" ? 4 : 2;
      r.type = "data", t += i;
    }
  }
  return e.length !== n.length && $a(e, 0, e.length, n), e;
}
function KX(e, t) {
  let n = e.length, r = 0, i, s, a, u;
  for (; n--; )
    if (i = e[n][1], s) {
      if (i.type === "link" || i.type === "labelLink" && i._inactive)
        break;
      e[n][0] === "enter" && i.type === "labelLink" && (i._inactive = !0);
    } else if (a) {
      if (e[n][0] === "enter" && (i.type === "labelImage" || i.type === "labelLink") && !i._balanced && (s = n, i.type !== "labelLink")) {
        r = 2;
        break;
      }
    } else i.type === "labelEnd" && (a = n);
  const d = {
    type: e[s][1].type === "labelLink" ? "link" : "image",
    start: {
      ...e[s][1].start
    },
    end: {
      ...e[e.length - 1][1].end
    }
  }, f = {
    type: "label",
    start: {
      ...e[s][1].start
    },
    end: {
      ...e[a][1].end
    }
  }, h = {
    type: "labelText",
    start: {
      ...e[s + r + 2][1].end
    },
    end: {
      ...e[a - 2][1].start
    }
  };
  return u = [["enter", d, t], ["enter", f, t]], u = so(u, e.slice(s + 1, s + r + 3)), u = so(u, [["enter", h, t]]), u = so(u, ew(t.parser.constructs.insideSpan.null, e.slice(s + r + 4, a - 3), t)), u = so(u, [["exit", h, t], e[a - 2], e[a - 1], ["exit", f, t]]), u = so(u, e.slice(a + 1)), u = so(u, [["exit", d, t]]), $a(e, s, e.length, u), e;
}
function YX(e, t, n) {
  const r = this;
  let i = r.events.length, s, a;
  for (; i--; )
    if ((r.events[i][1].type === "labelImage" || r.events[i][1].type === "labelLink") && !r.events[i][1]._balanced) {
      s = r.events[i][1];
      break;
    }
  return u;
  function u(x) {
    return s ? s._inactive ? m(x) : (a = r.parser.defined.includes(rl(r.sliceSerialize({
      start: s.end,
      end: r.now()
    }))), e.enter("labelEnd"), e.enter("labelMarker"), e.consume(x), e.exit("labelMarker"), e.exit("labelEnd"), d) : n(x);
  }
  function d(x) {
    return x === 40 ? e.attempt(UX, h, a ? h : m)(x) : x === 91 ? e.attempt(HX, h, a ? f : m)(x) : a ? h(x) : m(x);
  }
  function f(x) {
    return e.attempt(VX, h, m)(x);
  }
  function h(x) {
    return t(x);
  }
  function m(x) {
    return s._balanced = !0, n(x);
  }
}
function WX(e, t, n) {
  return r;
  function r(m) {
    return e.enter("resource"), e.enter("resourceMarker"), e.consume(m), e.exit("resourceMarker"), i;
  }
  function i(m) {
    return Jn(m) ? uy(e, s)(m) : s(m);
  }
  function s(m) {
    return m === 41 ? h(m) : dI(e, a, u, "resourceDestination", "resourceDestinationLiteral", "resourceDestinationLiteralMarker", "resourceDestinationRaw", "resourceDestinationString", 32)(m);
  }
  function a(m) {
    return Jn(m) ? uy(e, d)(m) : h(m);
  }
  function u(m) {
    return n(m);
  }
  function d(m) {
    return m === 34 || m === 39 || m === 40 ? hI(e, f, n, "resourceTitle", "resourceTitleMarker", "resourceTitleString")(m) : h(m);
  }
  function f(m) {
    return Jn(m) ? uy(e, h)(m) : h(m);
  }
  function h(m) {
    return m === 41 ? (e.enter("resourceMarker"), e.consume(m), e.exit("resourceMarker"), e.exit("resource"), t) : n(m);
  }
}
function ZX(e, t, n) {
  const r = this;
  return i;
  function i(u) {
    return fI.call(r, e, s, a, "reference", "referenceMarker", "referenceString")(u);
  }
  function s(u) {
    return r.parser.defined.includes(rl(r.sliceSerialize(r.events[r.events.length - 1][1]).slice(1, -1))) ? t(u) : n(u);
  }
  function a(u) {
    return n(u);
  }
}
function XX(e, t, n) {
  return r;
  function r(s) {
    return e.enter("reference"), e.enter("referenceMarker"), e.consume(s), e.exit("referenceMarker"), i;
  }
  function i(s) {
    return s === 93 ? (e.enter("referenceMarker"), e.consume(s), e.exit("referenceMarker"), e.exit("reference"), t) : n(s);
  }
}
const QX = {
  name: "labelStartImage",
  resolveAll: vT.resolveAll,
  tokenize: JX
};
function JX(e, t, n) {
  const r = this;
  return i;
  function i(u) {
    return e.enter("labelImage"), e.enter("labelImageMarker"), e.consume(u), e.exit("labelImageMarker"), s;
  }
  function s(u) {
    return u === 91 ? (e.enter("labelMarker"), e.consume(u), e.exit("labelMarker"), e.exit("labelImage"), a) : n(u);
  }
  function a(u) {
    return u === 94 && "_hiddenFootnoteSupport" in r.parser.constructs ? n(u) : t(u);
  }
}
const eQ = {
  name: "labelStartLink",
  resolveAll: vT.resolveAll,
  tokenize: tQ
};
function tQ(e, t, n) {
  const r = this;
  return i;
  function i(a) {
    return e.enter("labelLink"), e.enter("labelMarker"), e.consume(a), e.exit("labelMarker"), e.exit("labelLink"), s;
  }
  function s(a) {
    return a === 94 && "_hiddenFootnoteSupport" in r.parser.constructs ? n(a) : t(a);
  }
}
const Q2 = {
  name: "lineEnding",
  tokenize: nQ
};
function nQ(e, t) {
  return n;
  function n(r) {
    return e.enter("lineEnding"), e.consume(r), e.exit("lineEnding"), _n(e, t, "linePrefix");
  }
}
const B1 = {
  name: "thematicBreak",
  tokenize: rQ
};
function rQ(e, t, n) {
  let r = 0, i;
  return s;
  function s(f) {
    return e.enter("thematicBreak"), a(f);
  }
  function a(f) {
    return i = f, u(f);
  }
  function u(f) {
    return f === i ? (e.enter("thematicBreakSequence"), d(f)) : r >= 3 && (f === null || Ot(f)) ? (e.exit("thematicBreak"), t(f)) : n(f);
  }
  function d(f) {
    return f === i ? (e.consume(f), r++, d) : (e.exit("thematicBreakSequence"), dn(f) ? _n(e, u, "whitespace")(f) : u(f));
  }
}
const ua = {
  continuation: {
    tokenize: oQ
  },
  exit: uQ,
  name: "list",
  tokenize: aQ
}, iQ = {
  partial: !0,
  tokenize: cQ
}, sQ = {
  partial: !0,
  tokenize: lQ
};
function aQ(e, t, n) {
  const r = this, i = r.events[r.events.length - 1];
  let s = i && i[1].type === "linePrefix" ? i[2].sliceSerialize(i[1], !0).length : 0, a = 0;
  return u;
  function u(b) {
    const w = r.containerState.type || (b === 42 || b === 43 || b === 45 ? "listUnordered" : "listOrdered");
    if (w === "listUnordered" ? !r.containerState.marker || b === r.containerState.marker : M3(b)) {
      if (r.containerState.type || (r.containerState.type = w, e.enter(w, {
        _container: !0
      })), w === "listUnordered")
        return e.enter("listItemPrefix"), b === 42 || b === 45 ? e.check(B1, n, f)(b) : f(b);
      if (!r.interrupt || b === 49)
        return e.enter("listItemPrefix"), e.enter("listItemValue"), d(b);
    }
    return n(b);
  }
  function d(b) {
    return M3(b) && ++a < 10 ? (e.consume(b), d) : (!r.interrupt || a < 2) && (r.containerState.marker ? b === r.containerState.marker : b === 41 || b === 46) ? (e.exit("listItemValue"), f(b)) : n(b);
  }
  function f(b) {
    return e.enter("listItemMarker"), e.consume(b), e.exit("listItemMarker"), r.containerState.marker = r.containerState.marker || b, e.check(
      Jy,
      // Cant be empty when interrupting.
      r.interrupt ? n : h,
      e.attempt(iQ, x, m)
    );
  }
  function h(b) {
    return r.containerState.initialBlankLine = !0, s++, x(b);
  }
  function m(b) {
    return dn(b) ? (e.enter("listItemPrefixWhitespace"), e.consume(b), e.exit("listItemPrefixWhitespace"), x) : n(b);
  }
  function x(b) {
    return r.containerState.size = s + r.sliceSerialize(e.exit("listItemPrefix"), !0).length, t(b);
  }
}
function oQ(e, t, n) {
  const r = this;
  return r.containerState._closeFlow = void 0, e.check(Jy, i, s);
  function i(u) {
    return r.containerState.furtherBlankLines = r.containerState.furtherBlankLines || r.containerState.initialBlankLine, _n(e, t, "listItemIndent", r.containerState.size + 1)(u);
  }
  function s(u) {
    return r.containerState.furtherBlankLines || !dn(u) ? (r.containerState.furtherBlankLines = void 0, r.containerState.initialBlankLine = void 0, a(u)) : (r.containerState.furtherBlankLines = void 0, r.containerState.initialBlankLine = void 0, e.attempt(sQ, t, a)(u));
  }
  function a(u) {
    return r.containerState._closeFlow = !0, r.interrupt = void 0, _n(e, e.attempt(ua, t, n), "linePrefix", r.parser.constructs.disable.null.includes("codeIndented") ? void 0 : 4)(u);
  }
}
function lQ(e, t, n) {
  const r = this;
  return _n(e, i, "listItemIndent", r.containerState.size + 1);
  function i(s) {
    const a = r.events[r.events.length - 1];
    return a && a[1].type === "listItemIndent" && a[2].sliceSerialize(a[1], !0).length === r.containerState.size ? t(s) : n(s);
  }
}
function uQ(e) {
  e.exit(this.containerState.type);
}
function cQ(e, t, n) {
  const r = this;
  return _n(e, i, "listItemPrefixWhitespace", r.parser.constructs.disable.null.includes("codeIndented") ? void 0 : 5);
  function i(s) {
    const a = r.events[r.events.length - 1];
    return !dn(s) && a && a[1].type === "listItemPrefixWhitespace" ? t(s) : n(s);
  }
}
const bN = {
  name: "setextUnderline",
  resolveTo: dQ,
  tokenize: fQ
};
function dQ(e, t) {
  let n = e.length, r, i, s;
  for (; n--; )
    if (e[n][0] === "enter") {
      if (e[n][1].type === "content") {
        r = n;
        break;
      }
      e[n][1].type === "paragraph" && (i = n);
    } else
      e[n][1].type === "content" && e.splice(n, 1), !s && e[n][1].type === "definition" && (s = n);
  const a = {
    type: "setextHeading",
    start: {
      ...e[r][1].start
    },
    end: {
      ...e[e.length - 1][1].end
    }
  };
  return e[i][1].type = "setextHeadingText", s ? (e.splice(i, 0, ["enter", a, t]), e.splice(s + 1, 0, ["exit", e[r][1], t]), e[r][1].end = {
    ...e[s][1].end
  }) : e[r][1] = a, e.push(["exit", a, t]), e;
}
function fQ(e, t, n) {
  const r = this;
  let i;
  return s;
  function s(f) {
    let h = r.events.length, m;
    for (; h--; )
      if (r.events[h][1].type !== "lineEnding" && r.events[h][1].type !== "linePrefix" && r.events[h][1].type !== "content") {
        m = r.events[h][1].type === "paragraph";
        break;
      }
    return !r.parser.lazy[r.now().line] && (r.interrupt || m) ? (e.enter("setextHeadingLine"), i = f, a(f)) : n(f);
  }
  function a(f) {
    return e.enter("setextHeadingLineSequence"), u(f);
  }
  function u(f) {
    return f === i ? (e.consume(f), u) : (e.exit("setextHeadingLineSequence"), dn(f) ? _n(e, d, "lineSuffix")(f) : d(f));
  }
  function d(f) {
    return f === null || Ot(f) ? (e.exit("setextHeadingLine"), t(f)) : n(f);
  }
}
const hQ = {
  tokenize: pQ
};
function pQ(e) {
  const t = this, n = e.attempt(
    // Try to parse a blank line.
    Jy,
    r,
    // Try to parse initial flow (essentially, only code).
    e.attempt(this.parser.constructs.flowInitial, i, _n(e, e.attempt(this.parser.constructs.flow, i, e.attempt(vX, i)), "linePrefix"))
  );
  return n;
  function r(s) {
    if (s === null) {
      e.consume(s);
      return;
    }
    return e.enter("lineEndingBlank"), e.consume(s), e.exit("lineEndingBlank"), t.currentConstruct = void 0, n;
  }
  function i(s) {
    if (s === null) {
      e.consume(s);
      return;
    }
    return e.enter("lineEnding"), e.consume(s), e.exit("lineEnding"), t.currentConstruct = void 0, n;
  }
}
const mQ = {
  resolveAll: mI()
}, gQ = pI("string"), yQ = pI("text");
function pI(e) {
  return {
    resolveAll: mI(e === "text" ? xQ : void 0),
    tokenize: t
  };
  function t(n) {
    const r = this, i = this.parser.constructs[e], s = n.attempt(i, a, u);
    return a;
    function a(h) {
      return f(h) ? s(h) : u(h);
    }
    function u(h) {
      if (h === null) {
        n.consume(h);
        return;
      }
      return n.enter("data"), n.consume(h), d;
    }
    function d(h) {
      return f(h) ? (n.exit("data"), s(h)) : (n.consume(h), d);
    }
    function f(h) {
      if (h === null)
        return !0;
      const m = i[h];
      let x = -1;
      if (m)
        for (; ++x < m.length; ) {
          const b = m[x];
          if (!b.previous || b.previous.call(r, r.previous))
            return !0;
        }
      return !1;
    }
  }
}
function mI(e) {
  return t;
  function t(n, r) {
    let i = -1, s;
    for (; ++i <= n.length; )
      s === void 0 ? n[i] && n[i][1].type === "data" && (s = i, i++) : (!n[i] || n[i][1].type !== "data") && (i !== s + 2 && (n[s][1].end = n[i - 1][1].end, n.splice(s + 2, i - s - 2), i = s + 2), s = void 0);
    return e ? e(n, r) : n;
  }
}
function xQ(e, t) {
  let n = 0;
  for (; ++n <= e.length; )
    if ((n === e.length || e[n][1].type === "lineEnding") && e[n - 1][1].type === "data") {
      const r = e[n - 1][1], i = t.sliceStream(r);
      let s = i.length, a = -1, u = 0, d;
      for (; s--; ) {
        const f = i[s];
        if (typeof f == "string") {
          for (a = f.length; f.charCodeAt(a - 1) === 32; )
            u++, a--;
          if (a) break;
          a = -1;
        } else if (f === -2)
          d = !0, u++;
        else if (f !== -1) {
          s++;
          break;
        }
      }
      if (t._contentTypeTextTrailing && n === e.length && (u = 0), u) {
        const f = {
          type: n === e.length || d || u < 2 ? "lineSuffix" : "hardBreakTrailing",
          start: {
            _bufferIndex: s ? a : r.start._bufferIndex + a,
            _index: r.start._index + s,
            line: r.end.line,
            column: r.end.column - u,
            offset: r.end.offset - u
          },
          end: {
            ...r.end
          }
        };
        r.end = {
          ...f.start
        }, r.start.offset === r.end.offset ? Object.assign(r, f) : (e.splice(n, 0, ["enter", f, t], ["exit", f, t]), n += 2);
      }
      n++;
    }
  return e;
}
const vQ = {
  42: ua,
  43: ua,
  45: ua,
  48: ua,
  49: ua,
  50: ua,
  51: ua,
  52: ua,
  53: ua,
  54: ua,
  55: ua,
  56: ua,
  57: ua,
  62: oI
}, bQ = {
  91: EX
}, wQ = {
  [-2]: X2,
  [-1]: X2,
  32: X2
}, _Q = {
  35: NX,
  42: B1,
  45: [bN, B1],
  60: DX,
  61: bN,
  95: B1,
  96: xN,
  126: xN
}, SQ = {
  38: uI,
  92: lI
}, EQ = {
  [-5]: Q2,
  [-4]: Q2,
  [-3]: Q2,
  33: QX,
  38: uI,
  42: O3,
  60: [eX, qX],
  91: eQ,
  92: [jX, lI],
  93: vT,
  95: O3,
  96: hX
}, CQ = {
  null: [O3, mQ]
}, kQ = {
  null: [42, 95]
}, TQ = {
  null: []
}, jQ = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  attentionMarkers: kQ,
  contentInitial: bQ,
  disable: TQ,
  document: vQ,
  flow: _Q,
  flowInitial: wQ,
  insideSpan: CQ,
  string: SQ,
  text: EQ
}, Symbol.toStringTag, { value: "Module" }));
function AQ(e, t, n) {
  let r = {
    _bufferIndex: -1,
    _index: 0,
    line: n && n.line || 1,
    column: n && n.column || 1,
    offset: n && n.offset || 0
  };
  const i = {}, s = [];
  let a = [], u = [];
  const d = {
    attempt: q(P),
    check: q(D),
    consume: R,
    enter: N,
    exit: M,
    interrupt: q(D, {
      interrupt: !0
    })
  }, f = {
    code: null,
    containerState: {},
    defineSkip: S,
    events: [],
    now: w,
    parser: e,
    previous: null,
    sliceSerialize: x,
    sliceStream: b,
    write: m
  };
  let h = t.tokenize.call(f, d);
  return t.resolveAll && s.push(t), f;
  function m($) {
    return a = so(a, $), C(), a[a.length - 1] !== null ? [] : (Y(t, 0), f.events = ew(s, f.events, f), f.events);
  }
  function x($, G) {
    return RQ(b($), G);
  }
  function b($) {
    return NQ(a, $);
  }
  function w() {
    const {
      _bufferIndex: $,
      _index: G,
      line: le,
      column: Z,
      offset: oe
    } = r;
    return {
      _bufferIndex: $,
      _index: G,
      line: le,
      column: Z,
      offset: oe
    };
  }
  function S($) {
    i[$.line] = $.column, V();
  }
  function C() {
    let $;
    for (; r._index < a.length; ) {
      const G = a[r._index];
      if (typeof G == "string")
        for ($ = r._index, r._bufferIndex < 0 && (r._bufferIndex = 0); r._index === $ && r._bufferIndex < G.length; )
          T(G.charCodeAt(r._bufferIndex));
      else
        T(G);
    }
  }
  function T($) {
    h = h($);
  }
  function R($) {
    Ot($) ? (r.line++, r.column = 1, r.offset += $ === -3 ? 2 : 1, V()) : $ !== -1 && (r.column++, r.offset++), r._bufferIndex < 0 ? r._index++ : (r._bufferIndex++, r._bufferIndex === // Points w/ non-negative `_bufferIndex` reference
    // strings.
    /** @type {string} */
    a[r._index].length && (r._bufferIndex = -1, r._index++)), f.previous = $;
  }
  function N($, G) {
    const le = G || {};
    return le.type = $, le.start = w(), f.events.push(["enter", le, f]), u.push(le), le;
  }
  function M($) {
    const G = u.pop();
    return G.end = w(), f.events.push(["exit", G, f]), G;
  }
  function P($, G) {
    Y($, G.from);
  }
  function D($, G) {
    G.restore();
  }
  function q($, G) {
    return le;
    function le(Z, oe, X) {
      let ce, pe, de, H;
      return Array.isArray(Z) ? (
        /* c8 ignore next 1 */
        ge(Z)
      ) : "tokenize" in Z ? (
        // Looks like a construct.
        ge([
          /** @type {Construct} */
          Z
        ])
      ) : J(Z);
      function J(Se) {
        return Me;
        function Me(Ie) {
          const Re = Ie !== null && Se[Ie], mt = Ie !== null && Se.null, dt = [
            // To do: add more extension tests.
            /* c8 ignore next 2 */
            ...Array.isArray(Re) ? Re : Re ? [Re] : [],
            ...Array.isArray(mt) ? mt : mt ? [mt] : []
          ];
          return ge(dt)(Ie);
        }
      }
      function ge(Se) {
        return ce = Se, pe = 0, Se.length === 0 ? X : Q(Se[pe]);
      }
      function Q(Se) {
        return Me;
        function Me(Ie) {
          return H = te(), de = Se, Se.partial || (f.currentConstruct = Se), Se.name && f.parser.constructs.disable.null.includes(Se.name) ? ve() : Se.tokenize.call(
            // If we do have fields, create an object w/ `context` as its
            // prototype.
            // This allows a live binding, which is needed for `interrupt`.
            G ? Object.assign(Object.create(f), G) : f,
            d,
            fe,
            ve
          )(Ie);
        }
      }
      function fe(Se) {
        return $(de, H), oe;
      }
      function ve(Se) {
        return H.restore(), ++pe < ce.length ? Q(ce[pe]) : X;
      }
    }
  }
  function Y($, G) {
    $.resolveAll && !s.includes($) && s.push($), $.resolve && $a(f.events, G, f.events.length - G, $.resolve(f.events.slice(G), f)), $.resolveTo && (f.events = $.resolveTo(f.events, f));
  }
  function te() {
    const $ = w(), G = f.previous, le = f.currentConstruct, Z = f.events.length, oe = Array.from(u);
    return {
      from: Z,
      restore: X
    };
    function X() {
      r = $, f.previous = G, f.currentConstruct = le, f.events.length = Z, u = oe, V();
    }
  }
  function V() {
    r.line in i && r.column < 2 && (r.column = i[r.line], r.offset += i[r.line] - 1);
  }
}
function NQ(e, t) {
  const n = t.start._index, r = t.start._bufferIndex, i = t.end._index, s = t.end._bufferIndex;
  let a;
  if (n === i)
    a = [e[n].slice(r, s)];
  else {
    if (a = e.slice(n, i), r > -1) {
      const u = a[0];
      typeof u == "string" ? a[0] = u.slice(r) : a.shift();
    }
    s > 0 && a.push(e[i].slice(0, s));
  }
  return a;
}
function RQ(e, t) {
  let n = -1;
  const r = [];
  let i;
  for (; ++n < e.length; ) {
    const s = e[n];
    let a;
    if (typeof s == "string")
      a = s;
    else switch (s) {
      case -5: {
        a = "\r";
        break;
      }
      case -4: {
        a = `
`;
        break;
      }
      case -3: {
        a = `\r
`;
        break;
      }
      case -2: {
        a = t ? " " : "	";
        break;
      }
      case -1: {
        if (!t && i) continue;
        a = " ";
        break;
      }
      default:
        a = String.fromCharCode(s);
    }
    i = s === -2, r.push(a);
  }
  return r.join("");
}
function MQ(e) {
  const r = {
    constructs: (
      /** @type {FullNormalizedExtension} */
      sI([jQ, ...(e || {}).extensions || []])
    ),
    content: i(KZ),
    defined: [],
    document: i(WZ),
    flow: i(hQ),
    lazy: {},
    string: i(gQ),
    text: i(yQ)
  };
  return r;
  function i(s) {
    return a;
    function a(u) {
      return AQ(r, s, u);
    }
  }
}
function OQ(e) {
  for (; !cI(e); )
    ;
  return e;
}
const wN = /[\0\t\n\r]/g;
function DQ() {
  let e = 1, t = "", n = !0, r;
  return i;
  function i(s, a, u) {
    const d = [];
    let f, h, m, x, b;
    for (s = t + (typeof s == "string" ? s.toString() : new TextDecoder(a || void 0).decode(s)), m = 0, t = "", n && (s.charCodeAt(0) === 65279 && m++, n = void 0); m < s.length; ) {
      if (wN.lastIndex = m, f = wN.exec(s), x = f && f.index !== void 0 ? f.index : s.length, b = s.charCodeAt(x), !f) {
        t = s.slice(m);
        break;
      }
      if (b === 10 && m === x && r)
        d.push(-3), r = void 0;
      else
        switch (r && (d.push(-5), r = void 0), m < x && (d.push(s.slice(m, x)), e += x - m), b) {
          case 0: {
            d.push(65533), e++;
            break;
          }
          case 9: {
            for (h = Math.ceil(e / 4) * 4, d.push(-2); e++ < h; ) d.push(-1);
            break;
          }
          case 10: {
            d.push(-4), e = 1;
            break;
          }
          default:
            r = !0, e = 1;
        }
      m = x + 1;
    }
    return u && (r && d.push(-5), t && d.push(t), d.push(null)), d;
  }
}
const zQ = /\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;
function PQ(e) {
  return e.replace(zQ, IQ);
}
function IQ(e, t, n) {
  if (t)
    return t;
  if (n.charCodeAt(0) === 35) {
    const i = n.charCodeAt(1), s = i === 120 || i === 88;
    return aI(n.slice(s ? 2 : 1), s ? 16 : 10);
  }
  return xT(n) || e;
}
const gI = {}.hasOwnProperty;
function LQ(e, t, n) {
  return typeof t != "string" && (n = t, t = void 0), BQ(n)(OQ(MQ(n).document().write(DQ()(e, t, !0))));
}
function BQ(e) {
  const t = {
    transforms: [],
    canContainEols: ["emphasis", "fragment", "heading", "paragraph", "strong"],
    enter: {
      autolink: s(Dt),
      autolinkProtocol: te,
      autolinkEmail: te,
      atxHeading: s(ht),
      blockQuote: s(mt),
      characterEscape: te,
      characterReference: te,
      codeFenced: s(dt),
      codeFencedFenceInfo: a,
      codeFencedFenceMeta: a,
      codeIndented: s(dt, a),
      codeText: s(Je, a),
      codeTextData: te,
      data: te,
      codeFlowValue: te,
      definition: s(ft),
      definitionDestinationString: a,
      definitionLabelString: a,
      definitionTitleString: a,
      emphasis: s(yt),
      hardBreakEscape: s(Le),
      hardBreakTrailing: s(Le),
      htmlFlow: s(Ye, a),
      htmlFlowData: te,
      htmlText: s(Ye, a),
      htmlTextData: te,
      image: s(gt),
      label: a,
      link: s(Dt),
      listItem: s(Ht),
      listItemValue: x,
      listOrdered: s(pn, m),
      listUnordered: s(pn),
      paragraph: s(zn),
      reference: Q,
      referenceString: a,
      resourceDestinationString: a,
      resourceTitleString: a,
      setextHeading: s(ht),
      strong: s(nn),
      thematicBreak: s(Nn)
    },
    exit: {
      atxHeading: d(),
      atxHeadingSequence: P,
      autolink: d(),
      autolinkEmail: Re,
      autolinkProtocol: Ie,
      blockQuote: d(),
      characterEscapeValue: V,
      characterReferenceMarkerHexadecimal: ve,
      characterReferenceMarkerNumeric: ve,
      characterReferenceValue: Se,
      characterReference: Me,
      codeFenced: d(C),
      codeFencedFence: S,
      codeFencedFenceInfo: b,
      codeFencedFenceMeta: w,
      codeFlowValue: V,
      codeIndented: d(T),
      codeText: d(oe),
      codeTextData: V,
      data: V,
      definition: d(),
      definitionDestinationString: M,
      definitionLabelString: R,
      definitionTitleString: N,
      emphasis: d(),
      hardBreakEscape: d(G),
      hardBreakTrailing: d(G),
      htmlFlow: d(le),
      htmlFlowData: V,
      htmlText: d(Z),
      htmlTextData: V,
      image: d(ce),
      label: de,
      labelText: pe,
      lineEnding: $,
      link: d(X),
      listItem: d(),
      listOrdered: d(),
      listUnordered: d(),
      paragraph: d(),
      referenceString: fe,
      resourceDestinationString: H,
      resourceTitleString: J,
      resource: ge,
      setextHeading: d(Y),
      setextHeadingLineSequence: q,
      setextHeadingText: D,
      strong: d(),
      thematicBreak: d()
    }
  };
  yI(t, (e || {}).mdastExtensions || []);
  const n = {};
  return r;
  function r($e) {
    let Qe = {
      type: "root",
      children: []
    };
    const bt = {
      stack: [Qe],
      tokenStack: [],
      config: t,
      enter: u,
      exit: f,
      buffer: a,
      resume: h,
      data: n
    }, jt = [];
    let $t = -1;
    for (; ++$t < $e.length; )
      if ($e[$t][1].type === "listOrdered" || $e[$t][1].type === "listUnordered")
        if ($e[$t][0] === "enter")
          jt.push($t);
        else {
          const Un = jt.pop();
          $t = i($e, Un, $t);
        }
    for ($t = -1; ++$t < $e.length; ) {
      const Un = t[$e[$t][0]];
      gI.call(Un, $e[$t][1].type) && Un[$e[$t][1].type].call(Object.assign({
        sliceSerialize: $e[$t][2].sliceSerialize
      }, bt), $e[$t][1]);
    }
    if (bt.tokenStack.length > 0) {
      const Un = bt.tokenStack[bt.tokenStack.length - 1];
      (Un[1] || _N).call(bt, void 0, Un[0]);
    }
    for (Qe.position = {
      start: ud($e.length > 0 ? $e[0][1].start : {
        line: 1,
        column: 1,
        offset: 0
      }),
      end: ud($e.length > 0 ? $e[$e.length - 2][1].end : {
        line: 1,
        column: 1,
        offset: 0
      })
    }, $t = -1; ++$t < t.transforms.length; )
      Qe = t.transforms[$t](Qe) || Qe;
    return Qe;
  }
  function i($e, Qe, bt) {
    let jt = Qe - 1, $t = -1, Un = !1, Hn, on, Jt, fn;
    for (; ++jt <= bt; ) {
      const nt = $e[jt];
      switch (nt[1].type) {
        case "listUnordered":
        case "listOrdered":
        case "blockQuote": {
          nt[0] === "enter" ? $t++ : $t--, fn = void 0;
          break;
        }
        case "lineEndingBlank": {
          nt[0] === "enter" && (Hn && !fn && !$t && !Jt && (Jt = jt), fn = void 0);
          break;
        }
        case "linePrefix":
        case "listItemValue":
        case "listItemMarker":
        case "listItemPrefix":
        case "listItemPrefixWhitespace":
          break;
        default:
          fn = void 0;
      }
      if (!$t && nt[0] === "enter" && nt[1].type === "listItemPrefix" || $t === -1 && nt[0] === "exit" && (nt[1].type === "listUnordered" || nt[1].type === "listOrdered")) {
        if (Hn) {
          let er = jt;
          for (on = void 0; er--; ) {
            const Pn = $e[er];
            if (Pn[1].type === "lineEnding" || Pn[1].type === "lineEndingBlank") {
              if (Pn[0] === "exit") continue;
              on && ($e[on][1].type = "lineEndingBlank", Un = !0), Pn[1].type = "lineEnding", on = er;
            } else if (!(Pn[1].type === "linePrefix" || Pn[1].type === "blockQuotePrefix" || Pn[1].type === "blockQuotePrefixWhitespace" || Pn[1].type === "blockQuoteMarker" || Pn[1].type === "listItemIndent")) break;
          }
          Jt && (!on || Jt < on) && (Hn._spread = !0), Hn.end = Object.assign({}, on ? $e[on][1].start : nt[1].end), $e.splice(on || jt, 0, ["exit", Hn, nt[2]]), jt++, bt++;
        }
        if (nt[1].type === "listItemPrefix") {
          const er = {
            type: "listItem",
            _spread: !1,
            start: Object.assign({}, nt[1].start),
            // @ts-expect-error: well add `end` in a second.
            end: void 0
          };
          Hn = er, $e.splice(jt, 0, ["enter", er, nt[2]]), jt++, bt++, Jt = void 0, fn = !0;
        }
      }
    }
    return $e[Qe][1]._spread = Un, bt;
  }
  function s($e, Qe) {
    return bt;
    function bt(jt) {
      u.call(this, $e(jt), jt), Qe && Qe.call(this, jt);
    }
  }
  function a() {
    this.stack.push({
      type: "fragment",
      children: []
    });
  }
  function u($e, Qe, bt) {
    this.stack[this.stack.length - 1].children.push($e), this.stack.push($e), this.tokenStack.push([Qe, bt || void 0]), $e.position = {
      start: ud(Qe.start),
      // @ts-expect-error: `end` will be patched later.
      end: void 0
    };
  }
  function d($e) {
    return Qe;
    function Qe(bt) {
      $e && $e.call(this, bt), f.call(this, bt);
    }
  }
  function f($e, Qe) {
    const bt = this.stack.pop(), jt = this.tokenStack.pop();
    if (jt)
      jt[0].type !== $e.type && (Qe ? Qe.call(this, $e, jt[0]) : (jt[1] || _N).call(this, $e, jt[0]));
    else throw new Error("Cannot close `" + $e.type + "` (" + ly({
      start: $e.start,
      end: $e.end
    }) + "): its not open");
    bt.position.end = ud($e.end);
  }
  function h() {
    return yT(this.stack.pop());
  }
  function m() {
    this.data.expectingFirstListItemValue = !0;
  }
  function x($e) {
    if (this.data.expectingFirstListItemValue) {
      const Qe = this.stack[this.stack.length - 2];
      Qe.start = Number.parseInt(this.sliceSerialize($e), 10), this.data.expectingFirstListItemValue = void 0;
    }
  }
  function b() {
    const $e = this.resume(), Qe = this.stack[this.stack.length - 1];
    Qe.lang = $e;
  }
  function w() {
    const $e = this.resume(), Qe = this.stack[this.stack.length - 1];
    Qe.meta = $e;
  }
  function S() {
    this.data.flowCodeInside || (this.buffer(), this.data.flowCodeInside = !0);
  }
  function C() {
    const $e = this.resume(), Qe = this.stack[this.stack.length - 1];
    Qe.value = $e.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g, ""), this.data.flowCodeInside = void 0;
  }
  function T() {
    const $e = this.resume(), Qe = this.stack[this.stack.length - 1];
    Qe.value = $e.replace(/(\r?\n|\r)$/g, "");
  }
  function R($e) {
    const Qe = this.resume(), bt = this.stack[this.stack.length - 1];
    bt.label = Qe, bt.identifier = rl(this.sliceSerialize($e)).toLowerCase();
  }
  function N() {
    const $e = this.resume(), Qe = this.stack[this.stack.length - 1];
    Qe.title = $e;
  }
  function M() {
    const $e = this.resume(), Qe = this.stack[this.stack.length - 1];
    Qe.url = $e;
  }
  function P($e) {
    const Qe = this.stack[this.stack.length - 1];
    if (!Qe.depth) {
      const bt = this.sliceSerialize($e).length;
      Qe.depth = bt;
    }
  }
  function D() {
    this.data.setextHeadingSlurpLineEnding = !0;
  }
  function q($e) {
    const Qe = this.stack[this.stack.length - 1];
    Qe.depth = this.sliceSerialize($e).codePointAt(0) === 61 ? 1 : 2;
  }
  function Y() {
    this.data.setextHeadingSlurpLineEnding = void 0;
  }
  function te($e) {
    const bt = this.stack[this.stack.length - 1].children;
    let jt = bt[bt.length - 1];
    (!jt || jt.type !== "text") && (jt = kn(), jt.position = {
      start: ud($e.start),
      // @ts-expect-error: well add `end` later.
      end: void 0
    }, bt.push(jt)), this.stack.push(jt);
  }
  function V($e) {
    const Qe = this.stack.pop();
    Qe.value += this.sliceSerialize($e), Qe.position.end = ud($e.end);
  }
  function $($e) {
    const Qe = this.stack[this.stack.length - 1];
    if (this.data.atHardBreak) {
      const bt = Qe.children[Qe.children.length - 1];
      bt.position.end = ud($e.end), this.data.atHardBreak = void 0;
      return;
    }
    !this.data.setextHeadingSlurpLineEnding && t.canContainEols.includes(Qe.type) && (te.call(this, $e), V.call(this, $e));
  }
  function G() {
    this.data.atHardBreak = !0;
  }
  function le() {
    const $e = this.resume(), Qe = this.stack[this.stack.length - 1];
    Qe.value = $e;
  }
  function Z() {
    const $e = this.resume(), Qe = this.stack[this.stack.length - 1];
    Qe.value = $e;
  }
  function oe() {
    const $e = this.resume(), Qe = this.stack[this.stack.length - 1];
    Qe.value = $e;
  }
  function X() {
    const $e = this.stack[this.stack.length - 1];
    if (this.data.inReference) {
      const Qe = this.data.referenceType || "shortcut";
      $e.type += "Reference", $e.referenceType = Qe, delete $e.url, delete $e.title;
    } else
      delete $e.identifier, delete $e.label;
    this.data.referenceType = void 0;
  }
  function ce() {
    const $e = this.stack[this.stack.length - 1];
    if (this.data.inReference) {
      const Qe = this.data.referenceType || "shortcut";
      $e.type += "Reference", $e.referenceType = Qe, delete $e.url, delete $e.title;
    } else
      delete $e.identifier, delete $e.label;
    this.data.referenceType = void 0;
  }
  function pe($e) {
    const Qe = this.sliceSerialize($e), bt = this.stack[this.stack.length - 2];
    bt.label = PQ(Qe), bt.identifier = rl(Qe).toLowerCase();
  }
  function de() {
    const $e = this.stack[this.stack.length - 1], Qe = this.resume(), bt = this.stack[this.stack.length - 1];
    if (this.data.inReference = !0, bt.type === "link") {
      const jt = $e.children;
      bt.children = jt;
    } else
      bt.alt = Qe;
  }
  function H() {
    const $e = this.resume(), Qe = this.stack[this.stack.length - 1];
    Qe.url = $e;
  }
  function J() {
    const $e = this.resume(), Qe = this.stack[this.stack.length - 1];
    Qe.title = $e;
  }
  function ge() {
    this.data.inReference = void 0;
  }
  function Q() {
    this.data.referenceType = "collapsed";
  }
  function fe($e) {
    const Qe = this.resume(), bt = this.stack[this.stack.length - 1];
    bt.label = Qe, bt.identifier = rl(this.sliceSerialize($e)).toLowerCase(), this.data.referenceType = "full";
  }
  function ve($e) {
    this.data.characterReferenceType = $e.type;
  }
  function Se($e) {
    const Qe = this.sliceSerialize($e), bt = this.data.characterReferenceType;
    let jt;
    bt ? (jt = aI(Qe, bt === "characterReferenceMarkerNumeric" ? 10 : 16), this.data.characterReferenceType = void 0) : jt = xT(Qe);
    const $t = this.stack[this.stack.length - 1];
    $t.value += jt;
  }
  function Me($e) {
    const Qe = this.stack.pop();
    Qe.position.end = ud($e.end);
  }
  function Ie($e) {
    V.call(this, $e);
    const Qe = this.stack[this.stack.length - 1];
    Qe.url = this.sliceSerialize($e);
  }
  function Re($e) {
    V.call(this, $e);
    const Qe = this.stack[this.stack.length - 1];
    Qe.url = "mailto:" + this.sliceSerialize($e);
  }
  function mt() {
    return {
      type: "blockquote",
      children: []
    };
  }
  function dt() {
    return {
      type: "code",
      lang: null,
      meta: null,
      value: ""
    };
  }
  function Je() {
    return {
      type: "inlineCode",
      value: ""
    };
  }
  function ft() {
    return {
      type: "definition",
      identifier: "",
      label: null,
      title: null,
      url: ""
    };
  }
  function yt() {
    return {
      type: "emphasis",
      children: []
    };
  }
  function ht() {
    return {
      type: "heading",
      // @ts-expect-error `depth` will be set later.
      depth: 0,
      children: []
    };
  }
  function Le() {
    return {
      type: "break"
    };
  }
  function Ye() {
    return {
      type: "html",
      value: ""
    };
  }
  function gt() {
    return {
      type: "image",
      title: null,
      url: "",
      alt: null
    };
  }
  function Dt() {
    return {
      type: "link",
      title: null,
      url: "",
      children: []
    };
  }
  function pn($e) {
    return {
      type: "list",
      ordered: $e.type === "listOrdered",
      start: null,
      spread: $e._spread,
      children: []
    };
  }
  function Ht($e) {
    return {
      type: "listItem",
      spread: $e._spread,
      checked: null,
      children: []
    };
  }
  function zn() {
    return {
      type: "paragraph",
      children: []
    };
  }
  function nn() {
    return {
      type: "strong",
      children: []
    };
  }
  function kn() {
    return {
      type: "text",
      value: ""
    };
  }
  function Nn() {
    return {
      type: "thematicBreak"
    };
  }
}
function ud(e) {
  return {
    line: e.line,
    column: e.column,
    offset: e.offset
  };
}
function yI(e, t) {
  let n = -1;
  for (; ++n < t.length; ) {
    const r = t[n];
    Array.isArray(r) ? yI(e, r) : $Q(e, r);
  }
}
function $Q(e, t) {
  let n;
  for (n in t)
    if (gI.call(t, n))
      switch (n) {
        case "canContainEols": {
          const r = t[n];
          r && e[n].push(...r);
          break;
        }
        case "transforms": {
          const r = t[n];
          r && e[n].push(...r);
          break;
        }
        case "enter":
        case "exit": {
          const r = t[n];
          r && Object.assign(e[n], r);
          break;
        }
      }
}
function _N(e, t) {
  throw e ? new Error("Cannot close `" + e.type + "` (" + ly({
    start: e.start,
    end: e.end
  }) + "): a different token (`" + t.type + "`, " + ly({
    start: t.start,
    end: t.end
  }) + ") is open") : new Error("Cannot close document, a token (`" + t.type + "`, " + ly({
    start: t.start,
    end: t.end
  }) + ") is still open");
}
function qQ(e) {
  const t = this;
  t.parser = n;
  function n(r) {
    return LQ(r, {
      ...t.data("settings"),
      ...e,
      // Note: these options are not in the readme.
      // The goal is for them to be set by plugins on `data` instead of being
      // passed by users.
      extensions: t.data("micromarkExtensions") || [],
      mdastExtensions: t.data("fromMarkdownExtensions") || []
    });
  }
}
function FQ(e, t) {
  const n = {
    type: "element",
    tagName: "blockquote",
    properties: {},
    children: e.wrap(e.all(t), !0)
  };
  return e.patch(t, n), e.applyData(t, n);
}
function UQ(e, t) {
  const n = { type: "element", tagName: "br", properties: {}, children: [] };
  return e.patch(t, n), [e.applyData(t, n), { type: "text", value: `
` }];
}
function HQ(e, t) {
  const n = t.value ? t.value + `
` : "", r = {}, i = t.lang ? t.lang.split(/\s+/) : [];
  i.length > 0 && (r.className = ["language-" + i[0]]);
  let s = {
    type: "element",
    tagName: "code",
    properties: r,
    children: [{ type: "text", value: n }]
  };
  return t.meta && (s.data = { meta: t.meta }), e.patch(t, s), s = e.applyData(t, s), s = { type: "element", tagName: "pre", properties: {}, children: [s] }, e.patch(t, s), s;
}
function VQ(e, t) {
  const n = {
    type: "element",
    tagName: "del",
    properties: {},
    children: e.all(t)
  };
  return e.patch(t, n), e.applyData(t, n);
}
function GQ(e, t) {
  const n = {
    type: "element",
    tagName: "em",
    properties: {},
    children: e.all(t)
  };
  return e.patch(t, n), e.applyData(t, n);
}
function KQ(e, t) {
  const n = typeof e.options.clobberPrefix == "string" ? e.options.clobberPrefix : "user-content-", r = String(t.identifier).toUpperCase(), i = Vm(r.toLowerCase()), s = e.footnoteOrder.indexOf(r);
  let a, u = e.footnoteCounts.get(r);
  u === void 0 ? (u = 0, e.footnoteOrder.push(r), a = e.footnoteOrder.length) : a = s + 1, u += 1, e.footnoteCounts.set(r, u);
  const d = {
    type: "element",
    tagName: "a",
    properties: {
      href: "#" + n + "fn-" + i,
      id: n + "fnref-" + i + (u > 1 ? "-" + u : ""),
      dataFootnoteRef: !0,
      ariaDescribedBy: ["footnote-label"]
    },
    children: [{ type: "text", value: String(a) }]
  };
  e.patch(t, d);
  const f = {
    type: "element",
    tagName: "sup",
    properties: {},
    children: [d]
  };
  return e.patch(t, f), e.applyData(t, f);
}
function YQ(e, t) {
  const n = {
    type: "element",
    tagName: "h" + t.depth,
    properties: {},
    children: e.all(t)
  };
  return e.patch(t, n), e.applyData(t, n);
}
function WQ(e, t) {
  if (e.options.allowDangerousHtml) {
    const n = { type: "raw", value: t.value };
    return e.patch(t, n), e.applyData(t, n);
  }
}
function xI(e, t) {
  const n = t.referenceType;
  let r = "]";
  if (n === "collapsed" ? r += "[]" : n === "full" && (r += "[" + (t.label || t.identifier) + "]"), t.type === "imageReference")
    return [{ type: "text", value: "![" + t.alt + r }];
  const i = e.all(t), s = i[0];
  s && s.type === "text" ? s.value = "[" + s.value : i.unshift({ type: "text", value: "[" });
  const a = i[i.length - 1];
  return a && a.type === "text" ? a.value += r : i.push({ type: "text", value: r }), i;
}
function ZQ(e, t) {
  const n = String(t.identifier).toUpperCase(), r = e.definitionById.get(n);
  if (!r)
    return xI(e, t);
  const i = { src: Vm(r.url || ""), alt: t.alt };
  r.title !== null && r.title !== void 0 && (i.title = r.title);
  const s = { type: "element", tagName: "img", properties: i, children: [] };
  return e.patch(t, s), e.applyData(t, s);
}
function XQ(e, t) {
  const n = { src: Vm(t.url) };
  t.alt !== null && t.alt !== void 0 && (n.alt = t.alt), t.title !== null && t.title !== void 0 && (n.title = t.title);
  const r = { type: "element", tagName: "img", properties: n, children: [] };
  return e.patch(t, r), e.applyData(t, r);
}
function QQ(e, t) {
  const n = { type: "text", value: t.value.replace(/\r?\n|\r/g, " ") };
  e.patch(t, n);
  const r = {
    type: "element",
    tagName: "code",
    properties: {},
    children: [n]
  };
  return e.patch(t, r), e.applyData(t, r);
}
function JQ(e, t) {
  const n = String(t.identifier).toUpperCase(), r = e.definitionById.get(n);
  if (!r)
    return xI(e, t);
  const i = { href: Vm(r.url || "") };
  r.title !== null && r.title !== void 0 && (i.title = r.title);
  const s = {
    type: "element",
    tagName: "a",
    properties: i,
    children: e.all(t)
  };
  return e.patch(t, s), e.applyData(t, s);
}
function eJ(e, t) {
  const n = { href: Vm(t.url) };
  t.title !== null && t.title !== void 0 && (n.title = t.title);
  const r = {
    type: "element",
    tagName: "a",
    properties: n,
    children: e.all(t)
  };
  return e.patch(t, r), e.applyData(t, r);
}
function tJ(e, t, n) {
  const r = e.all(t), i = n ? nJ(n) : vI(t), s = {}, a = [];
  if (typeof t.checked == "boolean") {
    const h = r[0];
    let m;
    h && h.type === "element" && h.tagName === "p" ? m = h : (m = { type: "element", tagName: "p", properties: {}, children: [] }, r.unshift(m)), m.children.length > 0 && m.children.unshift({ type: "text", value: " " }), m.children.unshift({
      type: "element",
      tagName: "input",
      properties: { type: "checkbox", checked: t.checked, disabled: !0 },
      children: []
    }), s.className = ["task-list-item"];
  }
  let u = -1;
  for (; ++u < r.length; ) {
    const h = r[u];
    (i || u !== 0 || h.type !== "element" || h.tagName !== "p") && a.push({ type: "text", value: `
` }), h.type === "element" && h.tagName === "p" && !i ? a.push(...h.children) : a.push(h);
  }
  const d = r[r.length - 1];
  d && (i || d.type !== "element" || d.tagName !== "p") && a.push({ type: "text", value: `
` });
  const f = { type: "element", tagName: "li", properties: s, children: a };
  return e.patch(t, f), e.applyData(t, f);
}
function nJ(e) {
  let t = !1;
  if (e.type === "list") {
    t = e.spread || !1;
    const n = e.children;
    let r = -1;
    for (; !t && ++r < n.length; )
      t = vI(n[r]);
  }
  return t;
}
function vI(e) {
  const t = e.spread;
  return t ?? e.children.length > 1;
}
function rJ(e, t) {
  const n = {}, r = e.all(t);
  let i = -1;
  for (typeof t.start == "number" && t.start !== 1 && (n.start = t.start); ++i < r.length; ) {
    const a = r[i];
    if (a.type === "element" && a.tagName === "li" && a.properties && Array.isArray(a.properties.className) && a.properties.className.includes("task-list-item")) {
      n.className = ["contains-task-list"];
      break;
    }
  }
  const s = {
    type: "element",
    tagName: t.ordered ? "ol" : "ul",
    properties: n,
    children: e.wrap(r, !0)
  };
  return e.patch(t, s), e.applyData(t, s);
}
function iJ(e, t) {
  const n = {
    type: "element",
    tagName: "p",
    properties: {},
    children: e.all(t)
  };
  return e.patch(t, n), e.applyData(t, n);
}
function sJ(e, t) {
  const n = { type: "root", children: e.wrap(e.all(t)) };
  return e.patch(t, n), e.applyData(t, n);
}
function aJ(e, t) {
  const n = {
    type: "element",
    tagName: "strong",
    properties: {},
    children: e.all(t)
  };
  return e.patch(t, n), e.applyData(t, n);
}
function oJ(e, t) {
  const n = e.all(t), r = n.shift(), i = [];
  if (r) {
    const a = {
      type: "element",
      tagName: "thead",
      properties: {},
      children: e.wrap([r], !0)
    };
    e.patch(t.children[0], a), i.push(a);
  }
  if (n.length > 0) {
    const a = {
      type: "element",
      tagName: "tbody",
      properties: {},
      children: e.wrap(n, !0)
    }, u = hT(t.children[1]), d = QP(t.children[t.children.length - 1]);
    u && d && (a.position = { start: u, end: d }), i.push(a);
  }
  const s = {
    type: "element",
    tagName: "table",
    properties: {},
    children: e.wrap(i, !0)
  };
  return e.patch(t, s), e.applyData(t, s);
}
function lJ(e, t, n) {
  const r = n ? n.children : void 0, s = (r ? r.indexOf(t) : 1) === 0 ? "th" : "td", a = n && n.type === "table" ? n.align : void 0, u = a ? a.length : t.children.length;
  let d = -1;
  const f = [];
  for (; ++d < u; ) {
    const m = t.children[d], x = {}, b = a ? a[d] : void 0;
    b && (x.align = b);
    let w = { type: "element", tagName: s, properties: x, children: [] };
    m && (w.children = e.all(m), e.patch(m, w), w = e.applyData(m, w)), f.push(w);
  }
  const h = {
    type: "element",
    tagName: "tr",
    properties: {},
    children: e.wrap(f, !0)
  };
  return e.patch(t, h), e.applyData(t, h);
}
function uJ(e, t) {
  const n = {
    type: "element",
    tagName: "td",
    // Assume body cell.
    properties: {},
    children: e.all(t)
  };
  return e.patch(t, n), e.applyData(t, n);
}
const SN = 9, EN = 32;
function cJ(e) {
  const t = String(e), n = /\r?\n|\r/g;
  let r = n.exec(t), i = 0;
  const s = [];
  for (; r; )
    s.push(
      CN(t.slice(i, r.index), i > 0, !0),
      r[0]
    ), i = r.index + r[0].length, r = n.exec(t);
  return s.push(CN(t.slice(i), i > 0, !1)), s.join("");
}
function CN(e, t, n) {
  let r = 0, i = e.length;
  if (t) {
    let s = e.codePointAt(r);
    for (; s === SN || s === EN; )
      r++, s = e.codePointAt(r);
  }
  if (n) {
    let s = e.codePointAt(i - 1);
    for (; s === SN || s === EN; )
      i--, s = e.codePointAt(i - 1);
  }
  return i > r ? e.slice(r, i) : "";
}
function dJ(e, t) {
  const n = { type: "text", value: cJ(String(t.value)) };
  return e.patch(t, n), e.applyData(t, n);
}
function fJ(e, t) {
  const n = {
    type: "element",
    tagName: "hr",
    properties: {},
    children: []
  };
  return e.patch(t, n), e.applyData(t, n);
}
const hJ = {
  blockquote: FQ,
  break: UQ,
  code: HQ,
  delete: VQ,
  emphasis: GQ,
  footnoteReference: KQ,
  heading: YQ,
  html: WQ,
  imageReference: ZQ,
  image: XQ,
  inlineCode: QQ,
  linkReference: JQ,
  link: eJ,
  listItem: tJ,
  list: rJ,
  paragraph: iJ,
  // @ts-expect-error: root is different, but hard to type.
  root: sJ,
  strong: aJ,
  table: oJ,
  tableCell: uJ,
  tableRow: lJ,
  text: dJ,
  thematicBreak: fJ,
  toml: u1,
  yaml: u1,
  definition: u1,
  footnoteDefinition: u1
};
function u1() {
}
const bI = -1, tw = 0, cy = 1, db = 2, bT = 3, wT = 4, _T = 5, ST = 6, wI = 7, _I = 8, kN = typeof self == "object" ? self : globalThis, pJ = (e, t) => {
  const n = (i, s) => (e.set(s, i), i), r = (i) => {
    if (e.has(i))
      return e.get(i);
    const [s, a] = t[i];
    switch (s) {
      case tw:
      case bI:
        return n(a, i);
      case cy: {
        const u = n([], i);
        for (const d of a)
          u.push(r(d));
        return u;
      }
      case db: {
        const u = n({}, i);
        for (const [d, f] of a)
          u[r(d)] = r(f);
        return u;
      }
      case bT:
        return n(new Date(a), i);
      case wT: {
        const { source: u, flags: d } = a;
        return n(new RegExp(u, d), i);
      }
      case _T: {
        const u = n(/* @__PURE__ */ new Map(), i);
        for (const [d, f] of a)
          u.set(r(d), r(f));
        return u;
      }
      case ST: {
        const u = n(/* @__PURE__ */ new Set(), i);
        for (const d of a)
          u.add(r(d));
        return u;
      }
      case wI: {
        const { name: u, message: d } = a;
        return n(new kN[u](d), i);
      }
      case _I:
        return n(BigInt(a), i);
      case "BigInt":
        return n(Object(BigInt(a)), i);
      case "ArrayBuffer":
        return n(new Uint8Array(a).buffer, a);
      case "DataView": {
        const { buffer: u } = new Uint8Array(a);
        return n(new DataView(u), a);
      }
    }
    return n(new kN[s](a), i);
  };
  return r;
}, TN = (e) => pJ(/* @__PURE__ */ new Map(), e)(0), Zp = "", { toString: mJ } = {}, { keys: gJ } = Object, F0 = (e) => {
  const t = typeof e;
  if (t !== "object" || !e)
    return [tw, t];
  const n = mJ.call(e).slice(8, -1);
  switch (n) {
    case "Array":
      return [cy, Zp];
    case "Object":
      return [db, Zp];
    case "Date":
      return [bT, Zp];
    case "RegExp":
      return [wT, Zp];
    case "Map":
      return [_T, Zp];
    case "Set":
      return [ST, Zp];
    case "DataView":
      return [cy, n];
  }
  return n.includes("Array") ? [cy, n] : n.includes("Error") ? [wI, n] : [db, n];
}, c1 = ([e, t]) => e === tw && (t === "function" || t === "symbol"), yJ = (e, t, n, r) => {
  const i = (a, u) => {
    const d = r.push(a) - 1;
    return n.set(u, d), d;
  }, s = (a) => {
    if (n.has(a))
      return n.get(a);
    let [u, d] = F0(a);
    switch (u) {
      case tw: {
        let h = a;
        switch (d) {
          case "bigint":
            u = _I, h = a.toString();
            break;
          case "function":
          case "symbol":
            if (e)
              throw new TypeError("unable to serialize " + d);
            h = null;
            break;
          case "undefined":
            return i([bI], a);
        }
        return i([u, h], a);
      }
      case cy: {
        if (d) {
          let x = a;
          return d === "DataView" ? x = new Uint8Array(a.buffer) : d === "ArrayBuffer" && (x = new Uint8Array(a)), i([d, [...x]], a);
        }
        const h = [], m = i([u, h], a);
        for (const x of a)
          h.push(s(x));
        return m;
      }
      case db: {
        if (d)
          switch (d) {
            case "BigInt":
              return i([d, a.toString()], a);
            case "Boolean":
            case "Number":
            case "String":
              return i([d, a.valueOf()], a);
          }
        if (t && "toJSON" in a)
          return s(a.toJSON());
        const h = [], m = i([u, h], a);
        for (const x of gJ(a))
          (e || !c1(F0(a[x]))) && h.push([s(x), s(a[x])]);
        return m;
      }
      case bT:
        return i([u, a.toISOString()], a);
      case wT: {
        const { source: h, flags: m } = a;
        return i([u, { source: h, flags: m }], a);
      }
      case _T: {
        const h = [], m = i([u, h], a);
        for (const [x, b] of a)
          (e || !(c1(F0(x)) || c1(F0(b)))) && h.push([s(x), s(b)]);
        return m;
      }
      case ST: {
        const h = [], m = i([u, h], a);
        for (const x of a)
          (e || !c1(F0(x))) && h.push(s(x));
        return m;
      }
    }
    const { message: f } = a;
    return i([u, { name: d, message: f }], a);
  };
  return s;
}, jN = (e, { json: t, lossy: n } = {}) => {
  const r = [];
  return yJ(!(t || n), !!t, /* @__PURE__ */ new Map(), r)(e), r;
}, fb = typeof structuredClone == "function" ? (
  /* c8 ignore start */
  (e, t) => t && ("json" in t || "lossy" in t) ? TN(jN(e, t)) : structuredClone(e)
) : (e, t) => TN(jN(e, t));
function xJ(e, t) {
  const n = [{ type: "text", value: "" }];
  return t > 1 && n.push({
    type: "element",
    tagName: "sup",
    properties: {},
    children: [{ type: "text", value: String(t) }]
  }), n;
}
function vJ(e, t) {
  return "Back to reference " + (e + 1) + (t > 1 ? "-" + t : "");
}
function bJ(e) {
  const t = typeof e.options.clobberPrefix == "string" ? e.options.clobberPrefix : "user-content-", n = e.options.footnoteBackContent || xJ, r = e.options.footnoteBackLabel || vJ, i = e.options.footnoteLabel || "Footnotes", s = e.options.footnoteLabelTagName || "h2", a = e.options.footnoteLabelProperties || {
    className: ["sr-only"]
  }, u = [];
  let d = -1;
  for (; ++d < e.footnoteOrder.length; ) {
    const f = e.footnoteById.get(
      e.footnoteOrder[d]
    );
    if (!f)
      continue;
    const h = e.all(f), m = String(f.identifier).toUpperCase(), x = Vm(m.toLowerCase());
    let b = 0;
    const w = [], S = e.footnoteCounts.get(m);
    for (; S !== void 0 && ++b <= S; ) {
      w.length > 0 && w.push({ type: "text", value: " " });
      let R = typeof n == "string" ? n : n(d, b);
      typeof R == "string" && (R = { type: "text", value: R }), w.push({
        type: "element",
        tagName: "a",
        properties: {
          href: "#" + t + "fnref-" + x + (b > 1 ? "-" + b : ""),
          dataFootnoteBackref: "",
          ariaLabel: typeof r == "string" ? r : r(d, b),
          className: ["data-footnote-backref"]
        },
        children: Array.isArray(R) ? R : [R]
      });
    }
    const C = h[h.length - 1];
    if (C && C.type === "element" && C.tagName === "p") {
      const R = C.children[C.children.length - 1];
      R && R.type === "text" ? R.value += " " : C.children.push({ type: "text", value: " " }), C.children.push(...w);
    } else
      h.push(...w);
    const T = {
      type: "element",
      tagName: "li",
      properties: { id: t + "fn-" + x },
      children: e.wrap(h, !0)
    };
    e.patch(f, T), u.push(T);
  }
  if (u.length !== 0)
    return {
      type: "element",
      tagName: "section",
      properties: { dataFootnotes: !0, className: ["footnotes"] },
      children: [
        {
          type: "element",
          tagName: s,
          properties: {
            ...fb(a),
            id: "footnote-label"
          },
          children: [{ type: "text", value: i }]
        },
        { type: "text", value: `
` },
        {
          type: "element",
          tagName: "ol",
          properties: {},
          children: e.wrap(u, !0)
        },
        { type: "text", value: `
` }
      ]
    };
}
const nw = (
  // Note: overloads in JSDoc cant yet use different `@template`s.
  /**
   * @type {(
   *   (<Condition extends string>(test: Condition) => (node: unknown, index?: number | null | undefined, parent?: Parent | null | undefined, context?: unknown) => node is Node & {type: Condition}) &
   *   (<Condition extends Props>(test: Condition) => (node: unknown, index?: number | null | undefined, parent?: Parent | null | undefined, context?: unknown) => node is Node & Condition) &
   *   (<Condition extends TestFunction>(test: Condition) => (node: unknown, index?: number | null | undefined, parent?: Parent | null | undefined, context?: unknown) => node is Node & Predicate<Condition, Node>) &
   *   ((test?: null | undefined) => (node?: unknown, index?: number | null | undefined, parent?: Parent | null | undefined, context?: unknown) => node is Node) &
   *   ((test?: Test) => Check)
   * )}
   */
  /**
   * @param {Test} [test]
   * @returns {Check}
   */
  (function(e) {
    if (e == null)
      return EJ;
    if (typeof e == "function")
      return rw(e);
    if (typeof e == "object")
      return Array.isArray(e) ? wJ(e) : (
        // Cast because `ReadonlyArray` goes into the above but `isArray`
        // narrows to `Array`.
        _J(
          /** @type {Props} */
          e
        )
      );
    if (typeof e == "string")
      return SJ(e);
    throw new Error("Expected function, string, or object as test");
  })
);
function wJ(e) {
  const t = [];
  let n = -1;
  for (; ++n < e.length; )
    t[n] = nw(e[n]);
  return rw(r);
  function r(...i) {
    let s = -1;
    for (; ++s < t.length; )
      if (t[s].apply(this, i)) return !0;
    return !1;
  }
}
function _J(e) {
  const t = (
    /** @type {Record<string, unknown>} */
    e
  );
  return rw(n);
  function n(r) {
    const i = (
      /** @type {Record<string, unknown>} */
      /** @type {unknown} */
      r
    );
    let s;
    for (s in e)
      if (i[s] !== t[s]) return !1;
    return !0;
  }
}
function SJ(e) {
  return rw(t);
  function t(n) {
    return n && n.type === e;
  }
}
function rw(e) {
  return t;
  function t(n, r, i) {
    return !!(CJ(n) && e.call(
      this,
      n,
      typeof r == "number" ? r : void 0,
      i || void 0
    ));
  }
}
function EJ() {
  return !0;
}
function CJ(e) {
  return e !== null && typeof e == "object" && "type" in e;
}
const SI = [], kJ = !0, D3 = !1, TJ = "skip";
function EI(e, t, n, r) {
  let i;
  typeof t == "function" && typeof n != "function" ? (r = n, n = t) : i = t;
  const s = nw(i), a = r ? -1 : 1;
  u(e, void 0, [])();
  function u(d, f, h) {
    const m = (
      /** @type {Record<string, unknown>} */
      d && typeof d == "object" ? d : {}
    );
    if (typeof m.type == "string") {
      const b = (
        // `hast`
        typeof m.tagName == "string" ? m.tagName : (
          // `xast`
          typeof m.name == "string" ? m.name : void 0
        )
      );
      Object.defineProperty(x, "name", {
        value: "node (" + (d.type + (b ? "<" + b + ">" : "")) + ")"
      });
    }
    return x;
    function x() {
      let b = SI, w, S, C;
      if ((!t || s(d, f, h[h.length - 1] || void 0)) && (b = jJ(n(d, h)), b[0] === D3))
        return b;
      if ("children" in d && d.children) {
        const T = (
          /** @type {UnistParent} */
          d
        );
        if (T.children && b[0] !== TJ)
          for (S = (r ? T.children.length : -1) + a, C = h.concat(T); S > -1 && S < T.children.length; ) {
            const R = T.children[S];
            if (w = u(R, S, C)(), w[0] === D3)
              return w;
            S = typeof w[1] == "number" ? w[1] : S + a;
          }
      }
      return b;
    }
  }
}
function jJ(e) {
  return Array.isArray(e) ? e : typeof e == "number" ? [kJ, e] : e == null ? SI : [e];
}
function ET(e, t, n, r) {
  let i, s, a;
  typeof t == "function" && typeof n != "function" ? (s = void 0, a = t, i = n) : (s = t, a = n, i = r), EI(e, s, u, i);
  function u(d, f) {
    const h = f[f.length - 1], m = h ? h.children.indexOf(d) : void 0;
    return a(d, m, h);
  }
}
const z3 = {}.hasOwnProperty, AJ = {};
function NJ(e, t) {
  const n = t || AJ, r = /* @__PURE__ */ new Map(), i = /* @__PURE__ */ new Map(), s = /* @__PURE__ */ new Map(), a = { ...hJ, ...n.handlers }, u = {
    all: f,
    applyData: MJ,
    definitionById: r,
    footnoteById: i,
    footnoteCounts: s,
    footnoteOrder: [],
    handlers: a,
    one: d,
    options: n,
    patch: RJ,
    wrap: DJ
  };
  return ET(e, function(h) {
    if (h.type === "definition" || h.type === "footnoteDefinition") {
      const m = h.type === "definition" ? r : i, x = String(h.identifier).toUpperCase();
      m.has(x) || m.set(x, h);
    }
  }), u;
  function d(h, m) {
    const x = h.type, b = u.handlers[x];
    if (z3.call(u.handlers, x) && b)
      return b(u, h, m);
    if (u.options.passThrough && u.options.passThrough.includes(x)) {
      if ("children" in h) {
        const { children: S, ...C } = h, T = fb(C);
        return T.children = u.all(h), T;
      }
      return fb(h);
    }
    return (u.options.unknownHandler || OJ)(u, h, m);
  }
  function f(h) {
    const m = [];
    if ("children" in h) {
      const x = h.children;
      let b = -1;
      for (; ++b < x.length; ) {
        const w = u.one(x[b], h);
        if (w) {
          if (b && x[b - 1].type === "break" && (!Array.isArray(w) && w.type === "text" && (w.value = AN(w.value)), !Array.isArray(w) && w.type === "element")) {
            const S = w.children[0];
            S && S.type === "text" && (S.value = AN(S.value));
          }
          Array.isArray(w) ? m.push(...w) : m.push(w);
        }
      }
    }
    return m;
  }
}
function RJ(e, t) {
  e.position && (t.position = vZ(e));
}
function MJ(e, t) {
  let n = t;
  if (e && e.data) {
    const r = e.data.hName, i = e.data.hChildren, s = e.data.hProperties;
    if (typeof r == "string")
      if (n.type === "element")
        n.tagName = r;
      else {
        const a = "children" in n ? n.children : [n];
        n = { type: "element", tagName: r, properties: {}, children: a };
      }
    n.type === "element" && s && Object.assign(n.properties, fb(s)), "children" in n && n.children && i !== null && i !== void 0 && (n.children = i);
  }
  return n;
}
function OJ(e, t) {
  const n = t.data || {}, r = "value" in t && !(z3.call(n, "hProperties") || z3.call(n, "hChildren")) ? { type: "text", value: t.value } : {
    type: "element",
    tagName: "div",
    properties: {},
    children: e.all(t)
  };
  return e.patch(t, r), e.applyData(t, r);
}
function DJ(e, t) {
  const n = [];
  let r = -1;
  for (t && n.push({ type: "text", value: `
` }); ++r < e.length; )
    r && n.push({ type: "text", value: `
` }), n.push(e[r]);
  return t && e.length > 0 && n.push({ type: "text", value: `
` }), n;
}
function AN(e) {
  let t = 0, n = e.charCodeAt(t);
  for (; n === 9 || n === 32; )
    t++, n = e.charCodeAt(t);
  return e.slice(t);
}
function NN(e, t) {
  const n = NJ(e, t), r = n.one(e, void 0), i = bJ(n), s = Array.isArray(r) ? { type: "root", children: r } : r || { type: "root", children: [] };
  return i && s.children.push({ type: "text", value: `
` }, i), s;
}
function zJ(e, t) {
  return e && "run" in e ? async function(n, r) {
    const i = (
      /** @type {HastRoot} */
      NN(n, { file: r, ...t })
    );
    await e.run(i, r);
  } : function(n, r) {
    return (
      /** @type {HastRoot} */
      NN(n, { file: r, ...e || t })
    );
  };
}
function RN(e) {
  if (e)
    throw e;
}
var J2, MN;
function PJ() {
  if (MN) return J2;
  MN = 1;
  var e = Object.prototype.hasOwnProperty, t = Object.prototype.toString, n = Object.defineProperty, r = Object.getOwnPropertyDescriptor, i = function(f) {
    return typeof Array.isArray == "function" ? Array.isArray(f) : t.call(f) === "[object Array]";
  }, s = function(f) {
    if (!f || t.call(f) !== "[object Object]")
      return !1;
    var h = e.call(f, "constructor"), m = f.constructor && f.constructor.prototype && e.call(f.constructor.prototype, "isPrototypeOf");
    if (f.constructor && !h && !m)
      return !1;
    var x;
    for (x in f)
      ;
    return typeof x > "u" || e.call(f, x);
  }, a = function(f, h) {
    n && h.name === "__proto__" ? n(f, h.name, {
      enumerable: !0,
      configurable: !0,
      value: h.newValue,
      writable: !0
    }) : f[h.name] = h.newValue;
  }, u = function(f, h) {
    if (h === "__proto__")
      if (e.call(f, h)) {
        if (r)
          return r(f, h).value;
      } else return;
    return f[h];
  };
  return J2 = function d() {
    var f, h, m, x, b, w, S = arguments[0], C = 1, T = arguments.length, R = !1;
    for (typeof S == "boolean" && (R = S, S = arguments[1] || {}, C = 2), (S == null || typeof S != "object" && typeof S != "function") && (S = {}); C < T; ++C)
      if (f = arguments[C], f != null)
        for (h in f)
          m = u(S, h), x = u(f, h), S !== x && (R && x && (s(x) || (b = i(x))) ? (b ? (b = !1, w = m && i(m) ? m : []) : w = m && s(m) ? m : {}, a(S, { name: h, newValue: d(R, w, x) })) : typeof x < "u" && a(S, { name: h, newValue: x }));
    return S;
  }, J2;
}
var IJ = /* @__PURE__ */ PJ();
const e_ = /* @__PURE__ */ jd(IJ);
function P3(e) {
  if (typeof e != "object" || e === null)
    return !1;
  const t = Object.getPrototypeOf(e);
  return (t === null || t === Object.prototype || Object.getPrototypeOf(t) === null) && !(Symbol.toStringTag in e) && !(Symbol.iterator in e);
}
function LJ() {
  const e = [], t = { run: n, use: r };
  return t;
  function n(...i) {
    let s = -1;
    const a = i.pop();
    if (typeof a != "function")
      throw new TypeError("Expected function as last argument, not " + a);
    u(null, ...i);
    function u(d, ...f) {
      const h = e[++s];
      let m = -1;
      if (d) {
        a(d);
        return;
      }
      for (; ++m < i.length; )
        (f[m] === null || f[m] === void 0) && (f[m] = i[m]);
      i = f, h ? BJ(h, u)(...f) : a(null, ...f);
    }
  }
  function r(i) {
    if (typeof i != "function")
      throw new TypeError(
        "Expected `middelware` to be a function, not " + i
      );
    return e.push(i), t;
  }
}
function BJ(e, t) {
  let n;
  return r;
  function r(...a) {
    const u = e.length > a.length;
    let d;
    u && a.push(i);
    try {
      d = e.apply(this, a);
    } catch (f) {
      const h = (
        /** @type {Error} */
        f
      );
      if (u && n)
        throw h;
      return i(h);
    }
    u || (d && d.then && typeof d.then == "function" ? d.then(s, i) : d instanceof Error ? i(d) : s(d));
  }
  function i(a, ...u) {
    n || (n = !0, t(a, ...u));
  }
  function s(a) {
    i(null, a);
  }
}
const Yl = { basename: $J, dirname: qJ, extname: FJ, join: UJ, sep: "/" };
function $J(e, t) {
  if (t !== void 0 && typeof t != "string")
    throw new TypeError('"ext" argument must be a string');
  ex(e);
  let n = 0, r = -1, i = e.length, s;
  if (t === void 0 || t.length === 0 || t.length > e.length) {
    for (; i--; )
      if (e.codePointAt(i) === 47) {
        if (s) {
          n = i + 1;
          break;
        }
      } else r < 0 && (s = !0, r = i + 1);
    return r < 0 ? "" : e.slice(n, r);
  }
  if (t === e)
    return "";
  let a = -1, u = t.length - 1;
  for (; i--; )
    if (e.codePointAt(i) === 47) {
      if (s) {
        n = i + 1;
        break;
      }
    } else
      a < 0 && (s = !0, a = i + 1), u > -1 && (e.codePointAt(i) === t.codePointAt(u--) ? u < 0 && (r = i) : (u = -1, r = a));
  return n === r ? r = a : r < 0 && (r = e.length), e.slice(n, r);
}
function qJ(e) {
  if (ex(e), e.length === 0)
    return ".";
  let t = -1, n = e.length, r;
  for (; --n; )
    if (e.codePointAt(n) === 47) {
      if (r) {
        t = n;
        break;
      }
    } else r || (r = !0);
  return t < 0 ? e.codePointAt(0) === 47 ? "/" : "." : t === 1 && e.codePointAt(0) === 47 ? "//" : e.slice(0, t);
}
function FJ(e) {
  ex(e);
  let t = e.length, n = -1, r = 0, i = -1, s = 0, a;
  for (; t--; ) {
    const u = e.codePointAt(t);
    if (u === 47) {
      if (a) {
        r = t + 1;
        break;
      }
      continue;
    }
    n < 0 && (a = !0, n = t + 1), u === 46 ? i < 0 ? i = t : s !== 1 && (s = 1) : i > -1 && (s = -1);
  }
  return i < 0 || n < 0 || // We saw a non-dot character immediately before the dot.
  s === 0 || // The (right-most) trimmed path component is exactly `..`.
  s === 1 && i === n - 1 && i === r + 1 ? "" : e.slice(i, n);
}
function UJ(...e) {
  let t = -1, n;
  for (; ++t < e.length; )
    ex(e[t]), e[t] && (n = n === void 0 ? e[t] : n + "/" + e[t]);
  return n === void 0 ? "." : HJ(n);
}
function HJ(e) {
  ex(e);
  const t = e.codePointAt(0) === 47;
  let n = VJ(e, !t);
  return n.length === 0 && !t && (n = "."), n.length > 0 && e.codePointAt(e.length - 1) === 47 && (n += "/"), t ? "/" + n : n;
}
function VJ(e, t) {
  let n = "", r = 0, i = -1, s = 0, a = -1, u, d;
  for (; ++a <= e.length; ) {
    if (a < e.length)
      u = e.codePointAt(a);
    else {
      if (u === 47)
        break;
      u = 47;
    }
    if (u === 47) {
      if (!(i === a - 1 || s === 1)) if (i !== a - 1 && s === 2) {
        if (n.length < 2 || r !== 2 || n.codePointAt(n.length - 1) !== 46 || n.codePointAt(n.length - 2) !== 46) {
          if (n.length > 2) {
            if (d = n.lastIndexOf("/"), d !== n.length - 1) {
              d < 0 ? (n = "", r = 0) : (n = n.slice(0, d), r = n.length - 1 - n.lastIndexOf("/")), i = a, s = 0;
              continue;
            }
          } else if (n.length > 0) {
            n = "", r = 0, i = a, s = 0;
            continue;
          }
        }
        t && (n = n.length > 0 ? n + "/.." : "..", r = 2);
      } else
        n.length > 0 ? n += "/" + e.slice(i + 1, a) : n = e.slice(i + 1, a), r = a - i - 1;
      i = a, s = 0;
    } else u === 46 && s > -1 ? s++ : s = -1;
  }
  return n;
}
function ex(e) {
  if (typeof e != "string")
    throw new TypeError(
      "Path must be a string. Received " + JSON.stringify(e)
    );
}
const GJ = { cwd: KJ };
function KJ() {
  return "/";
}
function I3(e) {
  return !!(e !== null && typeof e == "object" && "href" in e && e.href && "protocol" in e && e.protocol && // @ts-expect-error: indexing is fine.
  e.auth === void 0);
}
function YJ(e) {
  if (typeof e == "string")
    e = new URL(e);
  else if (!I3(e)) {
    const t = new TypeError(
      'The "path" argument must be of type string or an instance of URL. Received `' + e + "`"
    );
    throw t.code = "ERR_INVALID_ARG_TYPE", t;
  }
  if (e.protocol !== "file:") {
    const t = new TypeError("The URL must be of scheme file");
    throw t.code = "ERR_INVALID_URL_SCHEME", t;
  }
  return WJ(e);
}
function WJ(e) {
  if (e.hostname !== "") {
    const r = new TypeError(
      'File URL host must be "localhost" or empty on darwin'
    );
    throw r.code = "ERR_INVALID_FILE_URL_HOST", r;
  }
  const t = e.pathname;
  let n = -1;
  for (; ++n < t.length; )
    if (t.codePointAt(n) === 37 && t.codePointAt(n + 1) === 50) {
      const r = t.codePointAt(n + 2);
      if (r === 70 || r === 102) {
        const i = new TypeError(
          "File URL path must not include encoded / characters"
        );
        throw i.code = "ERR_INVALID_FILE_URL_PATH", i;
      }
    }
  return decodeURIComponent(t);
}
const t_ = (
  /** @type {const} */
  [
    "history",
    "path",
    "basename",
    "stem",
    "extname",
    "dirname"
  ]
);
class CI {
  /**
   * Create a new virtual file.
   *
   * `options` is treated as:
   *
   * *   `string` or `Uint8Array`  `{value: options}`
   * *   `URL`  `{path: options}`
   * *   `VFile`  shallow copies its data over to the new file
   * *   `object`  all fields are shallow copied over to the new file
   *
   * Path related fields are set in the following order (least specific to
   * most specific): `history`, `path`, `basename`, `stem`, `extname`,
   * `dirname`.
   *
   * You cannot set `dirname` or `extname` without setting either `history`,
   * `path`, `basename`, or `stem` too.
   *
   * @param {Compatible | null | undefined} [value]
   *   File value.
   * @returns
   *   New instance.
   */
  constructor(t) {
    let n;
    t ? I3(t) ? n = { path: t } : typeof t == "string" || ZJ(t) ? n = { value: t } : n = t : n = {}, this.cwd = "cwd" in n ? "" : GJ.cwd(), this.data = {}, this.history = [], this.messages = [];
    let r = -1;
    for (; ++r < t_.length; ) {
      const s = t_[r];
      s in n && n[s] !== void 0 && n[s] !== null && (this[s] = s === "history" ? [...n[s]] : n[s]);
    }
    let i;
    for (i in n)
      t_.includes(i) || (this[i] = n[i]);
  }
  /**
   * Get the basename (including extname) (example: `'index.min.js'`).
   *
   * @returns {string | undefined}
   *   Basename.
   */
  get basename() {
    return typeof this.path == "string" ? Yl.basename(this.path) : void 0;
  }
  /**
   * Set basename (including extname) (`'index.min.js'`).
   *
   * Cannot contain path separators (`'/'` on unix, macOS, and browsers, `'\'`
   * on windows).
   * Cannot be nullified (use `file.path = file.dirname` instead).
   *
   * @param {string} basename
   *   Basename.
   * @returns {undefined}
   *   Nothing.
   */
  set basename(t) {
    r_(t, "basename"), n_(t, "basename"), this.path = Yl.join(this.dirname || "", t);
  }
  /**
   * Get the parent path (example: `'~'`).
   *
   * @returns {string | undefined}
   *   Dirname.
   */
  get dirname() {
    return typeof this.path == "string" ? Yl.dirname(this.path) : void 0;
  }
  /**
   * Set the parent path (example: `'~'`).
   *
   * Cannot be set if theres no `path` yet.
   *
   * @param {string | undefined} dirname
   *   Dirname.
   * @returns {undefined}
   *   Nothing.
   */
  set dirname(t) {
    ON(this.basename, "dirname"), this.path = Yl.join(t || "", this.basename);
  }
  /**
   * Get the extname (including dot) (example: `'.js'`).
   *
   * @returns {string | undefined}
   *   Extname.
   */
  get extname() {
    return typeof this.path == "string" ? Yl.extname(this.path) : void 0;
  }
  /**
   * Set the extname (including dot) (example: `'.js'`).
   *
   * Cannot contain path separators (`'/'` on unix, macOS, and browsers, `'\'`
   * on windows).
   * Cannot be set if theres no `path` yet.
   *
   * @param {string | undefined} extname
   *   Extname.
   * @returns {undefined}
   *   Nothing.
   */
  set extname(t) {
    if (n_(t, "extname"), ON(this.dirname, "extname"), t) {
      if (t.codePointAt(0) !== 46)
        throw new Error("`extname` must start with `.`");
      if (t.includes(".", 1))
        throw new Error("`extname` cannot contain multiple dots");
    }
    this.path = Yl.join(this.dirname, this.stem + (t || ""));
  }
  /**
   * Get the full path (example: `'~/index.min.js'`).
   *
   * @returns {string}
   *   Path.
   */
  get path() {
    return this.history[this.history.length - 1];
  }
  /**
   * Set the full path (example: `'~/index.min.js'`).
   *
   * Cannot be nullified.
   * You can set a file URL (a `URL` object with a `file:` protocol) which will
   * be turned into a path with `url.fileURLToPath`.
   *
   * @param {URL | string} path
   *   Path.
   * @returns {undefined}
   *   Nothing.
   */
  set path(t) {
    I3(t) && (t = YJ(t)), r_(t, "path"), this.path !== t && this.history.push(t);
  }
  /**
   * Get the stem (basename w/o extname) (example: `'index.min'`).
   *
   * @returns {string | undefined}
   *   Stem.
   */
  get stem() {
    return typeof this.path == "string" ? Yl.basename(this.path, this.extname) : void 0;
  }
  /**
   * Set the stem (basename w/o extname) (example: `'index.min'`).
   *
   * Cannot contain path separators (`'/'` on unix, macOS, and browsers, `'\'`
   * on windows).
   * Cannot be nullified (use `file.path = file.dirname` instead).
   *
   * @param {string} stem
   *   Stem.
   * @returns {undefined}
   *   Nothing.
   */
  set stem(t) {
    r_(t, "stem"), n_(t, "stem"), this.path = Yl.join(this.dirname || "", t + (this.extname || ""));
  }
  // Normal prototypal methods.
  /**
   * Create a fatal message for `reason` associated with the file.
   *
   * The `fatal` field of the message is set to `true` (error; file not usable)
   * and the `file` field is set to the current file path.
   * The message is added to the `messages` field on `file`.
   *
   * >  **Note**: also has obsolete signatures.
   *
   * @overload
   * @param {string} reason
   * @param {MessageOptions | null | undefined} [options]
   * @returns {never}
   *
   * @overload
   * @param {string} reason
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns {never}
   *
   * @overload
   * @param {string} reason
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns {never}
   *
   * @overload
   * @param {string} reason
   * @param {string | null | undefined} [origin]
   * @returns {never}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns {never}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns {never}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {string | null | undefined} [origin]
   * @returns {never}
   *
   * @param {Error | VFileMessage | string} causeOrReason
   *   Reason for message, should use markdown.
   * @param {Node | NodeLike | MessageOptions | Point | Position | string | null | undefined} [optionsOrParentOrPlace]
   *   Configuration (optional).
   * @param {string | null | undefined} [origin]
   *   Place in code where the message originates (example:
   *   `'my-package:my-rule'` or `'my-rule'`).
   * @returns {never}
   *   Never.
   * @throws {VFileMessage}
   *   Message.
   */
  fail(t, n, r) {
    const i = this.message(t, n, r);
    throw i.fatal = !0, i;
  }
  /**
   * Create an info message for `reason` associated with the file.
   *
   * The `fatal` field of the message is set to `undefined` (info; change
   * likely not needed) and the `file` field is set to the current file path.
   * The message is added to the `messages` field on `file`.
   *
   * >  **Note**: also has obsolete signatures.
   *
   * @overload
   * @param {string} reason
   * @param {MessageOptions | null | undefined} [options]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {string} reason
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {string} reason
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {string} reason
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @param {Error | VFileMessage | string} causeOrReason
   *   Reason for message, should use markdown.
   * @param {Node | NodeLike | MessageOptions | Point | Position | string | null | undefined} [optionsOrParentOrPlace]
   *   Configuration (optional).
   * @param {string | null | undefined} [origin]
   *   Place in code where the message originates (example:
   *   `'my-package:my-rule'` or `'my-rule'`).
   * @returns {VFileMessage}
   *   Message.
   */
  info(t, n, r) {
    const i = this.message(t, n, r);
    return i.fatal = void 0, i;
  }
  /**
   * Create a message for `reason` associated with the file.
   *
   * The `fatal` field of the message is set to `false` (warning; change may be
   * needed) and the `file` field is set to the current file path.
   * The message is added to the `messages` field on `file`.
   *
   * >  **Note**: also has obsolete signatures.
   *
   * @overload
   * @param {string} reason
   * @param {MessageOptions | null | undefined} [options]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {string} reason
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {string} reason
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {string} reason
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Node | NodeLike | null | undefined} parent
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {Point | Position | null | undefined} place
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @overload
   * @param {Error | VFileMessage} cause
   * @param {string | null | undefined} [origin]
   * @returns {VFileMessage}
   *
   * @param {Error | VFileMessage | string} causeOrReason
   *   Reason for message, should use markdown.
   * @param {Node | NodeLike | MessageOptions | Point | Position | string | null | undefined} [optionsOrParentOrPlace]
   *   Configuration (optional).
   * @param {string | null | undefined} [origin]
   *   Place in code where the message originates (example:
   *   `'my-package:my-rule'` or `'my-rule'`).
   * @returns {VFileMessage}
   *   Message.
   */
  message(t, n, r) {
    const i = new ds(
      // @ts-expect-error: the overloads are fine.
      t,
      n,
      r
    );
    return this.path && (i.name = this.path + ":" + i.name, i.file = this.path), i.fatal = !1, this.messages.push(i), i;
  }
  /**
   * Serialize the file.
   *
   * > **Note**: which encodings are supported depends on the engine.
   * > For info on Node.js, see:
   * > <https://nodejs.org/api/util.html#whatwg-supported-encodings>.
   *
   * @param {string | null | undefined} [encoding='utf8']
   *   Character encoding to understand `value` as when its a `Uint8Array`
   *   (default: `'utf-8'`).
   * @returns {string}
   *   Serialized file.
   */
  toString(t) {
    return this.value === void 0 ? "" : typeof this.value == "string" ? this.value : new TextDecoder(t || void 0).decode(this.value);
  }
}
function n_(e, t) {
  if (e && e.includes(Yl.sep))
    throw new Error(
      "`" + t + "` cannot be a path: did not expect `" + Yl.sep + "`"
    );
}
function r_(e, t) {
  if (!e)
    throw new Error("`" + t + "` cannot be empty");
}
function ON(e, t) {
  if (!e)
    throw new Error("Setting `" + t + "` requires `path` to be set too");
}
function ZJ(e) {
  return !!(e && typeof e == "object" && "byteLength" in e && "byteOffset" in e);
}
const XJ = (
  /**
   * @type {new <Parameters extends Array<unknown>, Result>(property: string | symbol) => (...parameters: Parameters) => Result}
   */
  /** @type {unknown} */
  /**
   * @this {Function}
   * @param {string | symbol} property
   * @returns {(...parameters: Array<unknown>) => unknown}
   */
  (function(e) {
    const r = (
      /** @type {Record<string | symbol, Function>} */
      // Prototypes do exist.
      // type-coverage:ignore-next-line
      this.constructor.prototype
    ), i = r[e], s = function() {
      return i.apply(s, arguments);
    };
    return Object.setPrototypeOf(s, r), s;
  })
), QJ = {}.hasOwnProperty;
class CT extends XJ {
  /**
   * Create a processor.
   */
  constructor() {
    super("copy"), this.Compiler = void 0, this.Parser = void 0, this.attachers = [], this.compiler = void 0, this.freezeIndex = -1, this.frozen = void 0, this.namespace = {}, this.parser = void 0, this.transformers = LJ();
  }
  /**
   * Copy a processor.
   *
   * @deprecated
   *   This is a private internal method and should not be used.
   * @returns {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>}
   *   New *unfrozen* processor ({@linkcode Processor}) that is
   *   configured to work the same as its ancestor.
   *   When the descendant processor is configured in the future it does not
   *   affect the ancestral processor.
   */
  copy() {
    const t = (
      /** @type {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>} */
      new CT()
    );
    let n = -1;
    for (; ++n < this.attachers.length; ) {
      const r = this.attachers[n];
      t.use(...r);
    }
    return t.data(e_(!0, {}, this.namespace)), t;
  }
  /**
   * Configure the processor with info available to all plugins.
   * Information is stored in an object.
   *
   * Typically, options can be given to a specific plugin, but sometimes it
   * makes sense to have information shared with several plugins.
   * For example, a list of HTML elements that are self-closing, which is
   * needed during all phases.
   *
   * > **Note**: setting information cannot occur on *frozen* processors.
   * > Call the processor first to create a new unfrozen processor.
   *
   * > **Note**: to register custom data in TypeScript, augment the
   * > {@linkcode Data} interface.
   *
   * @example
   *   This example show how to get and set info:
   *
   *   ```js
   *   import {unified} from 'unified'
   *
   *   const processor = unified().data('alpha', 'bravo')
   *
   *   processor.data('alpha') // => 'bravo'
   *
   *   processor.data() // => {alpha: 'bravo'}
   *
   *   processor.data({charlie: 'delta'})
   *
   *   processor.data() // => {charlie: 'delta'}
   *   ```
   *
   * @template {keyof Data} Key
   *
   * @overload
   * @returns {Data}
   *
   * @overload
   * @param {Data} dataset
   * @returns {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>}
   *
   * @overload
   * @param {Key} key
   * @returns {Data[Key]}
   *
   * @overload
   * @param {Key} key
   * @param {Data[Key]} value
   * @returns {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>}
   *
   * @param {Data | Key} [key]
   *   Key to get or set, or entire dataset to set, or nothing to get the
   *   entire dataset (optional).
   * @param {Data[Key]} [value]
   *   Value to set (optional).
   * @returns {unknown}
   *   The current processor when setting, the value at `key` when getting, or
   *   the entire dataset when getting without key.
   */
  data(t, n) {
    return typeof t == "string" ? arguments.length === 2 ? (a_("data", this.frozen), this.namespace[t] = n, this) : QJ.call(this.namespace, t) && this.namespace[t] || void 0 : t ? (a_("data", this.frozen), this.namespace = t, this) : this.namespace;
  }
  /**
   * Freeze a processor.
   *
   * Frozen processors are meant to be extended and not to be configured
   * directly.
   *
   * When a processor is frozen it cannot be unfrozen.
   * New processors working the same way can be created by calling the
   * processor.
   *
   * Its possible to freeze processors explicitly by calling `.freeze()`.
   * Processors freeze automatically when `.parse()`, `.run()`, `.runSync()`,
   * `.stringify()`, `.process()`, or `.processSync()` are called.
   *
   * @returns {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>}
   *   The current processor.
   */
  freeze() {
    if (this.frozen)
      return this;
    const t = (
      /** @type {Processor} */
      /** @type {unknown} */
      this
    );
    for (; ++this.freezeIndex < this.attachers.length; ) {
      const [n, ...r] = this.attachers[this.freezeIndex];
      if (r[0] === !1)
        continue;
      r[0] === !0 && (r[0] = void 0);
      const i = n.call(t, ...r);
      typeof i == "function" && this.transformers.use(i);
    }
    return this.frozen = !0, this.freezeIndex = Number.POSITIVE_INFINITY, this;
  }
  /**
   * Parse text to a syntax tree.
   *
   * > **Note**: `parse` freezes the processor if not already *frozen*.
   *
   * > **Note**: `parse` performs the parse phase, not the run phase or other
   * > phases.
   *
   * @param {Compatible | undefined} [file]
   *   file to parse (optional); typically `string` or `VFile`; any value
   *   accepted as `x` in `new VFile(x)`.
   * @returns {ParseTree extends undefined ? Node : ParseTree}
   *   Syntax tree representing `file`.
   */
  parse(t) {
    this.freeze();
    const n = d1(t), r = this.parser || this.Parser;
    return i_("parse", r), r(String(n), n);
  }
  /**
   * Process the given file as configured on the processor.
   *
   * > **Note**: `process` freezes the processor if not already *frozen*.
   *
   * > **Note**: `process` performs the parse, run, and stringify phases.
   *
   * @overload
   * @param {Compatible | undefined} file
   * @param {ProcessCallback<VFileWithOutput<CompileResult>>} done
   * @returns {undefined}
   *
   * @overload
   * @param {Compatible | undefined} [file]
   * @returns {Promise<VFileWithOutput<CompileResult>>}
   *
   * @param {Compatible | undefined} [file]
   *   File (optional); typically `string` or `VFile`]; any value accepted as
   *   `x` in `new VFile(x)`.
   * @param {ProcessCallback<VFileWithOutput<CompileResult>> | undefined} [done]
   *   Callback (optional).
   * @returns {Promise<VFile> | undefined}
   *   Nothing if `done` is given.
   *   Otherwise a promise, rejected with a fatal error or resolved with the
   *   processed file.
   *
   *   The parsed, transformed, and compiled value is available at
   *   `file.value` (see note).
   *
   *   > **Note**: unified typically compiles by serializing: most
   *   > compilers return `string` (or `Uint8Array`).
   *   > Some compilers, such as the one configured with
   *   > [`rehype-react`][rehype-react], return other values (in this case, a
   *   > React tree).
   *   > If youre using a compiler that doesnt serialize, expect different
   *   > result values.
   *   >
   *   > To register custom results in TypeScript, add them to
   *   > {@linkcode CompileResultMap}.
   *
   *   [rehype-react]: https://github.com/rehypejs/rehype-react
   */
  process(t, n) {
    const r = this;
    return this.freeze(), i_("process", this.parser || this.Parser), s_("process", this.compiler || this.Compiler), n ? i(void 0, n) : new Promise(i);
    function i(s, a) {
      const u = d1(t), d = (
        /** @type {HeadTree extends undefined ? Node : HeadTree} */
        /** @type {unknown} */
        r.parse(u)
      );
      r.run(d, u, function(h, m, x) {
        if (h || !m || !x)
          return f(h);
        const b = (
          /** @type {CompileTree extends undefined ? Node : CompileTree} */
          /** @type {unknown} */
          m
        ), w = r.stringify(b, x);
        tee(w) ? x.value = w : x.result = w, f(
          h,
          /** @type {VFileWithOutput<CompileResult>} */
          x
        );
      });
      function f(h, m) {
        h || !m ? a(h) : s ? s(m) : n(void 0, m);
      }
    }
  }
  /**
   * Process the given file as configured on the processor.
   *
   * An error is thrown if asynchronous transforms are configured.
   *
   * > **Note**: `processSync` freezes the processor if not already *frozen*.
   *
   * > **Note**: `processSync` performs the parse, run, and stringify phases.
   *
   * @param {Compatible | undefined} [file]
   *   File (optional); typically `string` or `VFile`; any value accepted as
   *   `x` in `new VFile(x)`.
   * @returns {VFileWithOutput<CompileResult>}
   *   The processed file.
   *
   *   The parsed, transformed, and compiled value is available at
   *   `file.value` (see note).
   *
   *   > **Note**: unified typically compiles by serializing: most
   *   > compilers return `string` (or `Uint8Array`).
   *   > Some compilers, such as the one configured with
   *   > [`rehype-react`][rehype-react], return other values (in this case, a
   *   > React tree).
   *   > If youre using a compiler that doesnt serialize, expect different
   *   > result values.
   *   >
   *   > To register custom results in TypeScript, add them to
   *   > {@linkcode CompileResultMap}.
   *
   *   [rehype-react]: https://github.com/rehypejs/rehype-react
   */
  processSync(t) {
    let n = !1, r;
    return this.freeze(), i_("processSync", this.parser || this.Parser), s_("processSync", this.compiler || this.Compiler), this.process(t, i), zN("processSync", "process", n), r;
    function i(s, a) {
      n = !0, RN(s), r = a;
    }
  }
  /**
   * Run *transformers* on a syntax tree.
   *
   * > **Note**: `run` freezes the processor if not already *frozen*.
   *
   * > **Note**: `run` performs the run phase, not other phases.
   *
   * @overload
   * @param {HeadTree extends undefined ? Node : HeadTree} tree
   * @param {RunCallback<TailTree extends undefined ? Node : TailTree>} done
   * @returns {undefined}
   *
   * @overload
   * @param {HeadTree extends undefined ? Node : HeadTree} tree
   * @param {Compatible | undefined} file
   * @param {RunCallback<TailTree extends undefined ? Node : TailTree>} done
   * @returns {undefined}
   *
   * @overload
   * @param {HeadTree extends undefined ? Node : HeadTree} tree
   * @param {Compatible | undefined} [file]
   * @returns {Promise<TailTree extends undefined ? Node : TailTree>}
   *
   * @param {HeadTree extends undefined ? Node : HeadTree} tree
   *   Tree to transform and inspect.
   * @param {(
   *   RunCallback<TailTree extends undefined ? Node : TailTree> |
   *   Compatible
   * )} [file]
   *   File associated with `node` (optional); any value accepted as `x` in
   *   `new VFile(x)`.
   * @param {RunCallback<TailTree extends undefined ? Node : TailTree>} [done]
   *   Callback (optional).
   * @returns {Promise<TailTree extends undefined ? Node : TailTree> | undefined}
   *   Nothing if `done` is given.
   *   Otherwise, a promise rejected with a fatal error or resolved with the
   *   transformed tree.
   */
  run(t, n, r) {
    DN(t), this.freeze();
    const i = this.transformers;
    return !r && typeof n == "function" && (r = n, n = void 0), r ? s(void 0, r) : new Promise(s);
    function s(a, u) {
      const d = d1(n);
      i.run(t, d, f);
      function f(h, m, x) {
        const b = (
          /** @type {TailTree extends undefined ? Node : TailTree} */
          m || t
        );
        h ? u(h) : a ? a(b) : r(void 0, b, x);
      }
    }
  }
  /**
   * Run *transformers* on a syntax tree.
   *
   * An error is thrown if asynchronous transforms are configured.
   *
   * > **Note**: `runSync` freezes the processor if not already *frozen*.
   *
   * > **Note**: `runSync` performs the run phase, not other phases.
   *
   * @param {HeadTree extends undefined ? Node : HeadTree} tree
   *   Tree to transform and inspect.
   * @param {Compatible | undefined} [file]
   *   File associated with `node` (optional); any value accepted as `x` in
   *   `new VFile(x)`.
   * @returns {TailTree extends undefined ? Node : TailTree}
   *   Transformed tree.
   */
  runSync(t, n) {
    let r = !1, i;
    return this.run(t, n, s), zN("runSync", "run", r), i;
    function s(a, u) {
      RN(a), i = u, r = !0;
    }
  }
  /**
   * Compile a syntax tree.
   *
   * > **Note**: `stringify` freezes the processor if not already *frozen*.
   *
   * > **Note**: `stringify` performs the stringify phase, not the run phase
   * > or other phases.
   *
   * @param {CompileTree extends undefined ? Node : CompileTree} tree
   *   Tree to compile.
   * @param {Compatible | undefined} [file]
   *   File associated with `node` (optional); any value accepted as `x` in
   *   `new VFile(x)`.
   * @returns {CompileResult extends undefined ? Value : CompileResult}
   *   Textual representation of the tree (see note).
   *
   *   > **Note**: unified typically compiles by serializing: most compilers
   *   > return `string` (or `Uint8Array`).
   *   > Some compilers, such as the one configured with
   *   > [`rehype-react`][rehype-react], return other values (in this case, a
   *   > React tree).
   *   > If youre using a compiler that doesnt serialize, expect different
   *   > result values.
   *   >
   *   > To register custom results in TypeScript, add them to
   *   > {@linkcode CompileResultMap}.
   *
   *   [rehype-react]: https://github.com/rehypejs/rehype-react
   */
  stringify(t, n) {
    this.freeze();
    const r = d1(n), i = this.compiler || this.Compiler;
    return s_("stringify", i), DN(t), i(t, r);
  }
  /**
   * Configure the processor to use a plugin, a list of usable values, or a
   * preset.
   *
   * If the processor is already using a plugin, the previous plugin
   * configuration is changed based on the options that are passed in.
   * In other words, the plugin is not added a second time.
   *
   * > **Note**: `use` cannot be called on *frozen* processors.
   * > Call the processor first to create a new unfrozen processor.
   *
   * @example
   *   There are many ways to pass plugins to `.use()`.
   *   This example gives an overview:
   *
   *   ```js
   *   import {unified} from 'unified'
   *
   *   unified()
   *     // Plugin with options:
   *     .use(pluginA, {x: true, y: true})
   *     // Passing the same plugin again merges configuration (to `{x: true, y: false, z: true}`):
   *     .use(pluginA, {y: false, z: true})
   *     // Plugins:
   *     .use([pluginB, pluginC])
   *     // Two plugins, the second with options:
   *     .use([pluginD, [pluginE, {}]])
   *     // Preset with plugins and settings:
   *     .use({plugins: [pluginF, [pluginG, {}]], settings: {position: false}})
   *     // Settings only:
   *     .use({settings: {position: false}})
   *   ```
   *
   * @template {Array<unknown>} [Parameters=[]]
   * @template {Node | string | undefined} [Input=undefined]
   * @template [Output=Input]
   *
   * @overload
   * @param {Preset | null | undefined} [preset]
   * @returns {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>}
   *
   * @overload
   * @param {PluggableList} list
   * @returns {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>}
   *
   * @overload
   * @param {Plugin<Parameters, Input, Output>} plugin
   * @param {...(Parameters | [boolean])} parameters
   * @returns {UsePlugin<ParseTree, HeadTree, TailTree, CompileTree, CompileResult, Input, Output>}
   *
   * @param {PluggableList | Plugin | Preset | null | undefined} value
   *   Usable value.
   * @param {...unknown} parameters
   *   Parameters, when a plugin is given as a usable value.
   * @returns {Processor<ParseTree, HeadTree, TailTree, CompileTree, CompileResult>}
   *   Current processor.
   */
  use(t, ...n) {
    const r = this.attachers, i = this.namespace;
    if (a_("use", this.frozen), t != null) if (typeof t == "function")
      d(t, n);
    else if (typeof t == "object")
      Array.isArray(t) ? u(t) : a(t);
    else
      throw new TypeError("Expected usable value, not `" + t + "`");
    return this;
    function s(f) {
      if (typeof f == "function")
        d(f, []);
      else if (typeof f == "object")
        if (Array.isArray(f)) {
          const [h, ...m] = (
            /** @type {PluginTuple<Array<unknown>>} */
            f
          );
          d(h, m);
        } else
          a(f);
      else
        throw new TypeError("Expected usable value, not `" + f + "`");
    }
    function a(f) {
      if (!("plugins" in f) && !("settings" in f))
        throw new Error(
          "Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither"
        );
      u(f.plugins), f.settings && (i.settings = e_(!0, i.settings, f.settings));
    }
    function u(f) {
      let h = -1;
      if (f != null) if (Array.isArray(f))
        for (; ++h < f.length; ) {
          const m = f[h];
          s(m);
        }
      else
        throw new TypeError("Expected a list of plugins, not `" + f + "`");
    }
    function d(f, h) {
      let m = -1, x = -1;
      for (; ++m < r.length; )
        if (r[m][0] === f) {
          x = m;
          break;
        }
      if (x === -1)
        r.push([f, ...h]);
      else if (h.length > 0) {
        let [b, ...w] = h;
        const S = r[x][1];
        P3(S) && P3(b) && (b = e_(!0, S, b)), r[x] = [f, b, ...w];
      }
    }
  }
}
const JJ = new CT().freeze();
function i_(e, t) {
  if (typeof t != "function")
    throw new TypeError("Cannot `" + e + "` without `parser`");
}
function s_(e, t) {
  if (typeof t != "function")
    throw new TypeError("Cannot `" + e + "` without `compiler`");
}
function a_(e, t) {
  if (t)
    throw new Error(
      "Cannot call `" + e + "` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`."
    );
}
function DN(e) {
  if (!P3(e) || typeof e.type != "string")
    throw new TypeError("Expected node, got `" + e + "`");
}
function zN(e, t, n) {
  if (!n)
    throw new Error(
      "`" + e + "` finished async. Use `" + t + "` instead"
    );
}
function d1(e) {
  return eee(e) ? e : new CI(e);
}
function eee(e) {
  return !!(e && typeof e == "object" && "message" in e && "messages" in e);
}
function tee(e) {
  return typeof e == "string" || nee(e);
}
function nee(e) {
  return !!(e && typeof e == "object" && "byteLength" in e && "byteOffset" in e);
}
const PN = [], IN = { allowDangerousHtml: !0 }, ree = /^(https?|ircs?|mailto|xmpp)$/i, iee = [
  { from: "astPlugins", id: "remove-buggy-html-in-markdown-parser" },
  { from: "allowDangerousHtml", id: "remove-buggy-html-in-markdown-parser" },
  {
    from: "allowNode",
    id: "replace-allownode-allowedtypes-and-disallowedtypes",
    to: "allowElement"
  },
  {
    from: "allowedTypes",
    id: "replace-allownode-allowedtypes-and-disallowedtypes",
    to: "allowedElements"
  },
  { from: "className", id: "remove-classname" },
  {
    from: "disallowedTypes",
    id: "replace-allownode-allowedtypes-and-disallowedtypes",
    to: "disallowedElements"
  },
  { from: "escapeHtml", id: "remove-buggy-html-in-markdown-parser" },
  { from: "includeElementIndex", id: "#remove-includeelementindex" },
  {
    from: "includeNodeIndex",
    id: "change-includenodeindex-to-includeelementindex"
  },
  { from: "linkTarget", id: "remove-linktarget" },
  { from: "plugins", id: "change-plugins-to-remarkplugins", to: "remarkPlugins" },
  { from: "rawSourcePos", id: "#remove-rawsourcepos" },
  { from: "renderers", id: "change-renderers-to-components", to: "components" },
  { from: "source", id: "change-source-to-children", to: "children" },
  { from: "sourcePos", id: "#remove-sourcepos" },
  { from: "transformImageUri", id: "#add-urltransform", to: "urlTransform" },
  { from: "transformLinkUri", id: "#add-urltransform", to: "urlTransform" }
];
function see(e) {
  const t = aee(e), n = oee(e);
  return lee(t.runSync(t.parse(n), n), e);
}
function aee(e) {
  const t = e.rehypePlugins || PN, n = e.remarkPlugins || PN, r = e.remarkRehypeOptions ? { ...e.remarkRehypeOptions, ...IN } : IN;
  return JJ().use(qQ).use(n).use(zJ, r).use(t);
}
function oee(e) {
  const t = e.children || "", n = new CI();
  return typeof t == "string" && (n.value = t), n;
}
function lee(e, t) {
  const n = t.allowedElements, r = t.allowElement, i = t.components, s = t.disallowedElements, a = t.skipHtml, u = t.unwrapDisallowed, d = t.urlTransform || uee;
  for (const h of iee)
    ;
  return ET(e, f), EZ(e, {
    Fragment: c.Fragment,
    components: i,
    ignoreInvalidStyle: !0,
    jsx: c.jsx,
    jsxs: c.jsxs,
    passKeys: !0,
    passNode: !0
  });
  function f(h, m, x) {
    if (h.type === "raw" && x && typeof m == "number")
      return a ? x.children.splice(m, 1) : x.children[m] = { type: "text", value: h.value }, m;
    if (h.type === "element") {
      let b;
      for (b in Z2)
        if (Object.hasOwn(Z2, b) && Object.hasOwn(h.properties, b)) {
          const w = h.properties[b], S = Z2[b];
          (S === null || S.includes(h.tagName)) && (h.properties[b] = d(String(w || ""), b, h));
        }
    }
    if (h.type === "element") {
      let b = n ? !n.includes(h.tagName) : s ? s.includes(h.tagName) : !1;
      if (!b && r && typeof m == "number" && (b = !r(h, m, x)), b && x && typeof m == "number")
        return u && h.children ? x.children.splice(m, 1, ...h.children) : x.children.splice(m, 1), m;
    }
  }
}
function uee(e) {
  const t = e.indexOf(":"), n = e.indexOf("?"), r = e.indexOf("#"), i = e.indexOf("/");
  return (
    // If there is no protocol, its relative.
    t === -1 || // If the first colon is after a `?`, `#`, or `/`, its not a protocol.
    i !== -1 && t > i || n !== -1 && t > n || r !== -1 && t > r || // It is a protocol, it should be allowed.
    ree.test(e.slice(0, t)) ? e : ""
  );
}
function LN(e, t) {
  const n = String(e);
  if (typeof t != "string")
    throw new TypeError("Expected character");
  let r = 0, i = n.indexOf(t);
  for (; i !== -1; )
    r++, i = n.indexOf(t, i + t.length);
  return r;
}
function cee(e) {
  if (typeof e != "string")
    throw new TypeError("Expected a string");
  return e.replace(/[|\\{}()[\]^$+*?.]/g, "\\$&").replace(/-/g, "\\x2d");
}
function dee(e, t, n) {
  const i = nw((n || {}).ignore || []), s = fee(t);
  let a = -1;
  for (; ++a < s.length; )
    EI(e, "text", u);
  function u(f, h) {
    let m = -1, x;
    for (; ++m < h.length; ) {
      const b = h[m], w = x ? x.children : void 0;
      if (i(
        b,
        w ? w.indexOf(b) : void 0,
        x
      ))
        return;
      x = b;
    }
    if (x)
      return d(f, h);
  }
  function d(f, h) {
    const m = h[h.length - 1], x = s[a][0], b = s[a][1];
    let w = 0;
    const C = m.children.indexOf(f);
    let T = !1, R = [];
    x.lastIndex = 0;
    let N = x.exec(f.value);
    for (; N; ) {
      const M = N.index, P = {
        index: N.index,
        input: N.input,
        stack: [...h, f]
      };
      let D = b(...N, P);
      if (typeof D == "string" && (D = D.length > 0 ? { type: "text", value: D } : void 0), D === !1 ? x.lastIndex = M + 1 : (w !== M && R.push({
        type: "text",
        value: f.value.slice(w, M)
      }), Array.isArray(D) ? R.push(...D) : D && R.push(D), w = M + N[0].length, T = !0), !x.global)
        break;
      N = x.exec(f.value);
    }
    return T ? (w < f.value.length && R.push({ type: "text", value: f.value.slice(w) }), m.children.splice(C, 1, ...R)) : R = [f], C + R.length;
  }
}
function fee(e) {
  const t = [];
  if (!Array.isArray(e))
    throw new TypeError("Expected find and replace tuple or list of tuples");
  const n = !e[0] || Array.isArray(e[0]) ? e : [e];
  let r = -1;
  for (; ++r < n.length; ) {
    const i = n[r];
    t.push([hee(i[0]), pee(i[1])]);
  }
  return t;
}
function hee(e) {
  return typeof e == "string" ? new RegExp(cee(e), "g") : e;
}
function pee(e) {
  return typeof e == "function" ? e : function() {
    return e;
  };
}
const o_ = "phrasing", l_ = ["autolink", "link", "image", "label"];
function mee() {
  return {
    transforms: [_ee],
    enter: {
      literalAutolink: yee,
      literalAutolinkEmail: u_,
      literalAutolinkHttp: u_,
      literalAutolinkWww: u_
    },
    exit: {
      literalAutolink: wee,
      literalAutolinkEmail: bee,
      literalAutolinkHttp: xee,
      literalAutolinkWww: vee
    }
  };
}
function gee() {
  return {
    unsafe: [
      {
        character: "@",
        before: "[+\\-.\\w]",
        after: "[\\-.\\w]",
        inConstruct: o_,
        notInConstruct: l_
      },
      {
        character: ".",
        before: "[Ww]",
        after: "[\\-.\\w]",
        inConstruct: o_,
        notInConstruct: l_
      },
      {
        character: ":",
        before: "[ps]",
        after: "\\/",
        inConstruct: o_,
        notInConstruct: l_
      }
    ]
  };
}
function yee(e) {
  this.enter({ type: "link", title: null, url: "", children: [] }, e);
}
function u_(e) {
  this.config.enter.autolinkProtocol.call(this, e);
}
function xee(e) {
  this.config.exit.autolinkProtocol.call(this, e);
}
function vee(e) {
  this.config.exit.data.call(this, e);
  const t = this.stack[this.stack.length - 1];
  t.url = "http://" + this.sliceSerialize(e);
}
function bee(e) {
  this.config.exit.autolinkEmail.call(this, e);
}
function wee(e) {
  this.exit(e);
}
function _ee(e) {
  dee(
    e,
    [
      [/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi, See],
      [new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)", "gu"), Eee]
    ],
    { ignore: ["link", "linkReference"] }
  );
}
function See(e, t, n, r, i) {
  let s = "";
  if (!kI(i) || (/^w/i.test(t) && (n = t + n, t = "", s = "http://"), !Cee(n)))
    return !1;
  const a = kee(n + r);
  if (!a[0]) return !1;
  const u = {
    type: "link",
    title: null,
    url: s + t + a[0],
    children: [{ type: "text", value: t + a[0] }]
  };
  return a[1] ? [u, { type: "text", value: a[1] }] : u;
}
function Eee(e, t, n, r) {
  return (
    // Not an expected previous character.
    !kI(r, !0) || // Label ends in not allowed character.
    /[-\d_]$/.test(n) ? !1 : {
      type: "link",
      title: null,
      url: "mailto:" + t + "@" + n,
      children: [{ type: "text", value: t + "@" + n }]
    }
  );
}
function Cee(e) {
  const t = e.split(".");
  return !(t.length < 2 || t[t.length - 1] && (/_/.test(t[t.length - 1]) || !/[a-zA-Z\d]/.test(t[t.length - 1])) || t[t.length - 2] && (/_/.test(t[t.length - 2]) || !/[a-zA-Z\d]/.test(t[t.length - 2])));
}
function kee(e) {
  const t = /[!"&'),.:;<>?\]}]+$/.exec(e);
  if (!t)
    return [e, void 0];
  e = e.slice(0, t.index);
  let n = t[0], r = n.indexOf(")");
  const i = LN(e, "(");
  let s = LN(e, ")");
  for (; r !== -1 && i > s; )
    e += n.slice(0, r + 1), n = n.slice(r + 1), r = n.indexOf(")"), s++;
  return [e, n];
}
function kI(e, t) {
  const n = e.input.charCodeAt(e.index - 1);
  return (e.index === 0 || bh(n) || Jb(n)) && // If its an email, the previous character should not be a slash.
  (!t || n !== 47);
}
TI.peek = zee;
function Tee() {
  this.buffer();
}
function jee(e) {
  this.enter({ type: "footnoteReference", identifier: "", label: "" }, e);
}
function Aee() {
  this.buffer();
}
function Nee(e) {
  this.enter(
    { type: "footnoteDefinition", identifier: "", label: "", children: [] },
    e
  );
}
function Ree(e) {
  const t = this.resume(), n = this.stack[this.stack.length - 1];
  n.identifier = rl(
    this.sliceSerialize(e)
  ).toLowerCase(), n.label = t;
}
function Mee(e) {
  this.exit(e);
}
function Oee(e) {
  const t = this.resume(), n = this.stack[this.stack.length - 1];
  n.identifier = rl(
    this.sliceSerialize(e)
  ).toLowerCase(), n.label = t;
}
function Dee(e) {
  this.exit(e);
}
function zee() {
  return "[";
}
function TI(e, t, n, r) {
  const i = n.createTracker(r);
  let s = i.move("[^");
  const a = n.enter("footnoteReference"), u = n.enter("reference");
  return s += i.move(
    n.safe(n.associationId(e), { after: "]", before: s })
  ), u(), a(), s += i.move("]"), s;
}
function Pee() {
  return {
    enter: {
      gfmFootnoteCallString: Tee,
      gfmFootnoteCall: jee,
      gfmFootnoteDefinitionLabelString: Aee,
      gfmFootnoteDefinition: Nee
    },
    exit: {
      gfmFootnoteCallString: Ree,
      gfmFootnoteCall: Mee,
      gfmFootnoteDefinitionLabelString: Oee,
      gfmFootnoteDefinition: Dee
    }
  };
}
function Iee(e) {
  let t = !1;
  return e && e.firstLineBlank && (t = !0), {
    handlers: { footnoteDefinition: n, footnoteReference: TI },
    // This is on by default already.
    unsafe: [{ character: "[", inConstruct: ["label", "phrasing", "reference"] }]
  };
  function n(r, i, s, a) {
    const u = s.createTracker(a);
    let d = u.move("[^");
    const f = s.enter("footnoteDefinition"), h = s.enter("label");
    return d += u.move(
      s.safe(s.associationId(r), { before: d, after: "]" })
    ), h(), d += u.move("]:"), r.children && r.children.length > 0 && (u.shift(4), d += u.move(
      (t ? `
` : " ") + s.indentLines(
        s.containerFlow(r, u.current()),
        t ? jI : Lee
      )
    )), f(), d;
  }
}
function Lee(e, t, n) {
  return t === 0 ? e : jI(e, t, n);
}
function jI(e, t, n) {
  return (n ? "" : "    ") + e;
}
const Bee = [
  "autolink",
  "destinationLiteral",
  "destinationRaw",
  "reference",
  "titleQuote",
  "titleApostrophe"
];
AI.peek = Hee;
function $ee() {
  return {
    canContainEols: ["delete"],
    enter: { strikethrough: Fee },
    exit: { strikethrough: Uee }
  };
}
function qee() {
  return {
    unsafe: [
      {
        character: "~",
        inConstruct: "phrasing",
        notInConstruct: Bee
      }
    ],
    handlers: { delete: AI }
  };
}
function Fee(e) {
  this.enter({ type: "delete", children: [] }, e);
}
function Uee(e) {
  this.exit(e);
}
function AI(e, t, n, r) {
  const i = n.createTracker(r), s = n.enter("strikethrough");
  let a = i.move("~~");
  return a += n.containerPhrasing(e, {
    ...i.current(),
    before: a,
    after: "~"
  }), a += i.move("~~"), s(), a;
}
function Hee() {
  return "~";
}
function Vee(e) {
  return e.length;
}
function Gee(e, t) {
  const n = t || {}, r = (n.align || []).concat(), i = n.stringLength || Vee, s = [], a = [], u = [], d = [];
  let f = 0, h = -1;
  for (; ++h < e.length; ) {
    const S = [], C = [];
    let T = -1;
    for (e[h].length > f && (f = e[h].length); ++T < e[h].length; ) {
      const R = Kee(e[h][T]);
      if (n.alignDelimiters !== !1) {
        const N = i(R);
        C[T] = N, (d[T] === void 0 || N > d[T]) && (d[T] = N);
      }
      S.push(R);
    }
    a[h] = S, u[h] = C;
  }
  let m = -1;
  if (typeof r == "object" && "length" in r)
    for (; ++m < f; )
      s[m] = BN(r[m]);
  else {
    const S = BN(r);
    for (; ++m < f; )
      s[m] = S;
  }
  m = -1;
  const x = [], b = [];
  for (; ++m < f; ) {
    const S = s[m];
    let C = "", T = "";
    S === 99 ? (C = ":", T = ":") : S === 108 ? C = ":" : S === 114 && (T = ":");
    let R = n.alignDelimiters === !1 ? 1 : Math.max(
      1,
      d[m] - C.length - T.length
    );
    const N = C + "-".repeat(R) + T;
    n.alignDelimiters !== !1 && (R = C.length + R + T.length, R > d[m] && (d[m] = R), b[m] = R), x[m] = N;
  }
  a.splice(1, 0, x), u.splice(1, 0, b), h = -1;
  const w = [];
  for (; ++h < a.length; ) {
    const S = a[h], C = u[h];
    m = -1;
    const T = [];
    for (; ++m < f; ) {
      const R = S[m] || "";
      let N = "", M = "";
      if (n.alignDelimiters !== !1) {
        const P = d[m] - (C[m] || 0), D = s[m];
        D === 114 ? N = " ".repeat(P) : D === 99 ? P % 2 ? (N = " ".repeat(P / 2 + 0.5), M = " ".repeat(P / 2 - 0.5)) : (N = " ".repeat(P / 2), M = N) : M = " ".repeat(P);
      }
      n.delimiterStart !== !1 && !m && T.push("|"), n.padding !== !1 && // Dont add the opening space if were not aligning and the cell is
      // empty: there will be a closing space.
      !(n.alignDelimiters === !1 && R === "") && (n.delimiterStart !== !1 || m) && T.push(" "), n.alignDelimiters !== !1 && T.push(N), T.push(R), n.alignDelimiters !== !1 && T.push(M), n.padding !== !1 && T.push(" "), (n.delimiterEnd !== !1 || m !== f - 1) && T.push("|");
    }
    w.push(
      n.delimiterEnd === !1 ? T.join("").replace(/ +$/, "") : T.join("")
    );
  }
  return w.join(`
`);
}
function Kee(e) {
  return e == null ? "" : String(e);
}
function BN(e) {
  const t = typeof e == "string" ? e.codePointAt(0) : 0;
  return t === 67 || t === 99 ? 99 : t === 76 || t === 108 ? 108 : t === 82 || t === 114 ? 114 : 0;
}
function Yee(e, t, n, r) {
  const i = n.enter("blockquote"), s = n.createTracker(r);
  s.move("> "), s.shift(2);
  const a = n.indentLines(
    n.containerFlow(e, s.current()),
    Wee
  );
  return i(), a;
}
function Wee(e, t, n) {
  return ">" + (n ? "" : " ") + e;
}
function Zee(e, t) {
  return $N(e, t.inConstruct, !0) && !$N(e, t.notInConstruct, !1);
}
function $N(e, t, n) {
  if (typeof t == "string" && (t = [t]), !t || t.length === 0)
    return n;
  let r = -1;
  for (; ++r < t.length; )
    if (e.includes(t[r]))
      return !0;
  return !1;
}
function qN(e, t, n, r) {
  let i = -1;
  for (; ++i < n.unsafe.length; )
    if (n.unsafe[i].character === `
` && Zee(n.stack, n.unsafe[i]))
      return /[ \t]/.test(r.before) ? "" : " ";
  return `\\
`;
}
function Xee(e, t) {
  const n = String(e);
  let r = n.indexOf(t), i = r, s = 0, a = 0;
  if (typeof t != "string")
    throw new TypeError("Expected substring");
  for (; r !== -1; )
    r === i ? ++s > a && (a = s) : s = 1, i = r + t.length, r = n.indexOf(t, i);
  return a;
}
function Qee(e, t) {
  return !!(t.options.fences === !1 && e.value && // If theres no info
  !e.lang && // And theres a non-whitespace character
  /[^ \r\n]/.test(e.value) && // And the value doesnt start or end in a blank
  !/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value));
}
function Jee(e) {
  const t = e.options.fence || "`";
  if (t !== "`" && t !== "~")
    throw new Error(
      "Cannot serialize code with `" + t + "` for `options.fence`, expected `` ` `` or `~`"
    );
  return t;
}
function ete(e, t, n, r) {
  const i = Jee(n), s = e.value || "", a = i === "`" ? "GraveAccent" : "Tilde";
  if (Qee(e, n)) {
    const m = n.enter("codeIndented"), x = n.indentLines(s, tte);
    return m(), x;
  }
  const u = n.createTracker(r), d = i.repeat(Math.max(Xee(s, i) + 1, 3)), f = n.enter("codeFenced");
  let h = u.move(d);
  if (e.lang) {
    const m = n.enter(`codeFencedLang${a}`);
    h += u.move(
      n.safe(e.lang, {
        before: h,
        after: " ",
        encode: ["`"],
        ...u.current()
      })
    ), m();
  }
  if (e.lang && e.meta) {
    const m = n.enter(`codeFencedMeta${a}`);
    h += u.move(" "), h += u.move(
      n.safe(e.meta, {
        before: h,
        after: `
`,
        encode: ["`"],
        ...u.current()
      })
    ), m();
  }
  return h += u.move(`
`), s && (h += u.move(s + `
`)), h += u.move(d), f(), h;
}
function tte(e, t, n) {
  return (n ? "" : "    ") + e;
}
function kT(e) {
  const t = e.options.quote || '"';
  if (t !== '"' && t !== "'")
    throw new Error(
      "Cannot serialize title with `" + t + "` for `options.quote`, expected `\"`, or `'`"
    );
  return t;
}
function nte(e, t, n, r) {
  const i = kT(n), s = i === '"' ? "Quote" : "Apostrophe", a = n.enter("definition");
  let u = n.enter("label");
  const d = n.createTracker(r);
  let f = d.move("[");
  return f += d.move(
    n.safe(n.associationId(e), {
      before: f,
      after: "]",
      ...d.current()
    })
  ), f += d.move("]: "), u(), // If theres no url, or
  !e.url || // If there are control characters or whitespace.
  /[\0- \u007F]/.test(e.url) ? (u = n.enter("destinationLiteral"), f += d.move("<"), f += d.move(
    n.safe(e.url, { before: f, after: ">", ...d.current() })
  ), f += d.move(">")) : (u = n.enter("destinationRaw"), f += d.move(
    n.safe(e.url, {
      before: f,
      after: e.title ? " " : `
`,
      ...d.current()
    })
  )), u(), e.title && (u = n.enter(`title${s}`), f += d.move(" " + i), f += d.move(
    n.safe(e.title, {
      before: f,
      after: i,
      ...d.current()
    })
  ), f += d.move(i), u()), a(), f;
}
function rte(e) {
  const t = e.options.emphasis || "*";
  if (t !== "*" && t !== "_")
    throw new Error(
      "Cannot serialize emphasis with `" + t + "` for `options.emphasis`, expected `*`, or `_`"
    );
  return t;
}
function Ty(e) {
  return "&#x" + e.toString(16).toUpperCase() + ";";
}
function hb(e, t, n) {
  const r = Mm(e), i = Mm(t);
  return r === void 0 ? i === void 0 ? (
    // Letter inside:
    // we have to encode *both* letters for `_` as it is looser.
    // it already forms for `*` (and GFMs `~`).
    n === "_" ? { inside: !0, outside: !0 } : { inside: !1, outside: !1 }
  ) : i === 1 ? (
    // Whitespace inside: encode both (letter, whitespace).
    { inside: !0, outside: !0 }
  ) : (
    // Punctuation inside: encode outer (letter)
    { inside: !1, outside: !0 }
  ) : r === 1 ? i === void 0 ? (
    // Letter inside: already forms.
    { inside: !1, outside: !1 }
  ) : i === 1 ? (
    // Whitespace inside: encode both (whitespace).
    { inside: !0, outside: !0 }
  ) : (
    // Punctuation inside: already forms.
    { inside: !1, outside: !1 }
  ) : i === void 0 ? (
    // Letter inside: already forms.
    { inside: !1, outside: !1 }
  ) : i === 1 ? (
    // Whitespace inside: encode inner (whitespace).
    { inside: !0, outside: !1 }
  ) : (
    // Punctuation inside: already forms.
    { inside: !1, outside: !1 }
  );
}
NI.peek = ite;
function NI(e, t, n, r) {
  const i = rte(n), s = n.enter("emphasis"), a = n.createTracker(r), u = a.move(i);
  let d = a.move(
    n.containerPhrasing(e, {
      after: i,
      before: u,
      ...a.current()
    })
  );
  const f = d.charCodeAt(0), h = hb(
    r.before.charCodeAt(r.before.length - 1),
    f,
    i
  );
  h.inside && (d = Ty(f) + d.slice(1));
  const m = d.charCodeAt(d.length - 1), x = hb(r.after.charCodeAt(0), m, i);
  x.inside && (d = d.slice(0, -1) + Ty(m));
  const b = a.move(i);
  return s(), n.attentionEncodeSurroundingInfo = {
    after: x.outside,
    before: h.outside
  }, u + d + b;
}
function ite(e, t, n) {
  return n.options.emphasis || "*";
}
function ste(e, t) {
  let n = !1;
  return ET(e, function(r) {
    if ("value" in r && /\r?\n|\r/.test(r.value) || r.type === "break")
      return n = !0, D3;
  }), !!((!e.depth || e.depth < 3) && yT(e) && (t.options.setext || n));
}
function ate(e, t, n, r) {
  const i = Math.max(Math.min(6, e.depth || 1), 1), s = n.createTracker(r);
  if (ste(e, n)) {
    const h = n.enter("headingSetext"), m = n.enter("phrasing"), x = n.containerPhrasing(e, {
      ...s.current(),
      before: `
`,
      after: `
`
    });
    return m(), h(), x + `
` + (i === 1 ? "=" : "-").repeat(
      // The whole size
      x.length - // Minus the position of the character after the last EOL (or
      // 0 if there is none)
      (Math.max(x.lastIndexOf("\r"), x.lastIndexOf(`
`)) + 1)
    );
  }
  const a = "#".repeat(i), u = n.enter("headingAtx"), d = n.enter("phrasing");
  s.move(a + " ");
  let f = n.containerPhrasing(e, {
    before: "# ",
    after: `
`,
    ...s.current()
  });
  return /^[\t ]/.test(f) && (f = Ty(f.charCodeAt(0)) + f.slice(1)), f = f ? a + " " + f : a, n.options.closeAtx && (f += " " + a), d(), u(), f;
}
RI.peek = ote;
function RI(e) {
  return e.value || "";
}
function ote() {
  return "<";
}
MI.peek = lte;
function MI(e, t, n, r) {
  const i = kT(n), s = i === '"' ? "Quote" : "Apostrophe", a = n.enter("image");
  let u = n.enter("label");
  const d = n.createTracker(r);
  let f = d.move("![");
  return f += d.move(
    n.safe(e.alt, { before: f, after: "]", ...d.current() })
  ), f += d.move("]("), u(), // If theres no url but there is a title
  !e.url && e.title || // If there are control characters or whitespace.
  /[\0- \u007F]/.test(e.url) ? (u = n.enter("destinationLiteral"), f += d.move("<"), f += d.move(
    n.safe(e.url, { before: f, after: ">", ...d.current() })
  ), f += d.move(">")) : (u = n.enter("destinationRaw"), f += d.move(
    n.safe(e.url, {
      before: f,
      after: e.title ? " " : ")",
      ...d.current()
    })
  )), u(), e.title && (u = n.enter(`title${s}`), f += d.move(" " + i), f += d.move(
    n.safe(e.title, {
      before: f,
      after: i,
      ...d.current()
    })
  ), f += d.move(i), u()), f += d.move(")"), a(), f;
}
function lte() {
  return "!";
}
OI.peek = ute;
function OI(e, t, n, r) {
  const i = e.referenceType, s = n.enter("imageReference");
  let a = n.enter("label");
  const u = n.createTracker(r);
  let d = u.move("![");
  const f = n.safe(e.alt, {
    before: d,
    after: "]",
    ...u.current()
  });
  d += u.move(f + "]["), a();
  const h = n.stack;
  n.stack = [], a = n.enter("reference");
  const m = n.safe(n.associationId(e), {
    before: d,
    after: "]",
    ...u.current()
  });
  return a(), n.stack = h, s(), i === "full" || !f || f !== m ? d += u.move(m + "]") : i === "shortcut" ? d = d.slice(0, -1) : d += u.move("]"), d;
}
function ute() {
  return "!";
}
DI.peek = cte;
function DI(e, t, n) {
  let r = e.value || "", i = "`", s = -1;
  for (; new RegExp("(^|[^`])" + i + "([^`]|$)").test(r); )
    i += "`";
  for (/[^ \r\n]/.test(r) && (/^[ \r\n]/.test(r) && /[ \r\n]$/.test(r) || /^`|`$/.test(r)) && (r = " " + r + " "); ++s < n.unsafe.length; ) {
    const a = n.unsafe[s], u = n.compilePattern(a);
    let d;
    if (a.atBreak)
      for (; d = u.exec(r); ) {
        let f = d.index;
        r.charCodeAt(f) === 10 && r.charCodeAt(f - 1) === 13 && f--, r = r.slice(0, f) + " " + r.slice(d.index + 1);
      }
  }
  return i + r + i;
}
function cte() {
  return "`";
}
function zI(e, t) {
  const n = yT(e);
  return !!(!t.options.resourceLink && // If theres a url
  e.url && // And theres a no title
  !e.title && // And the content of `node` is a single text node
  e.children && e.children.length === 1 && e.children[0].type === "text" && // And if the url is the same as the content
  (n === e.url || "mailto:" + n === e.url) && // And that starts w/ a protocol
  /^[a-z][a-z+.-]+:/i.test(e.url) && // And that doesnt contain ASCII control codes (character escapes and
  // references dont work), space, or angle brackets
  !/[\0- <>\u007F]/.test(e.url));
}
PI.peek = dte;
function PI(e, t, n, r) {
  const i = kT(n), s = i === '"' ? "Quote" : "Apostrophe", a = n.createTracker(r);
  let u, d;
  if (zI(e, n)) {
    const h = n.stack;
    n.stack = [], u = n.enter("autolink");
    let m = a.move("<");
    return m += a.move(
      n.containerPhrasing(e, {
        before: m,
        after: ">",
        ...a.current()
      })
    ), m += a.move(">"), u(), n.stack = h, m;
  }
  u = n.enter("link"), d = n.enter("label");
  let f = a.move("[");
  return f += a.move(
    n.containerPhrasing(e, {
      before: f,
      after: "](",
      ...a.current()
    })
  ), f += a.move("]("), d(), // If theres no url but there is a title
  !e.url && e.title || // If there are control characters or whitespace.
  /[\0- \u007F]/.test(e.url) ? (d = n.enter("destinationLiteral"), f += a.move("<"), f += a.move(
    n.safe(e.url, { before: f, after: ">", ...a.current() })
  ), f += a.move(">")) : (d = n.enter("destinationRaw"), f += a.move(
    n.safe(e.url, {
      before: f,
      after: e.title ? " " : ")",
      ...a.current()
    })
  )), d(), e.title && (d = n.enter(`title${s}`), f += a.move(" " + i), f += a.move(
    n.safe(e.title, {
      before: f,
      after: i,
      ...a.current()
    })
  ), f += a.move(i), d()), f += a.move(")"), u(), f;
}
function dte(e, t, n) {
  return zI(e, n) ? "<" : "[";
}
II.peek = fte;
function II(e, t, n, r) {
  const i = e.referenceType, s = n.enter("linkReference");
  let a = n.enter("label");
  const u = n.createTracker(r);
  let d = u.move("[");
  const f = n.containerPhrasing(e, {
    before: d,
    after: "]",
    ...u.current()
  });
  d += u.move(f + "]["), a();
  const h = n.stack;
  n.stack = [], a = n.enter("reference");
  const m = n.safe(n.associationId(e), {
    before: d,
    after: "]",
    ...u.current()
  });
  return a(), n.stack = h, s(), i === "full" || !f || f !== m ? d += u.move(m + "]") : i === "shortcut" ? d = d.slice(0, -1) : d += u.move("]"), d;
}
function fte() {
  return "[";
}
function TT(e) {
  const t = e.options.bullet || "*";
  if (t !== "*" && t !== "+" && t !== "-")
    throw new Error(
      "Cannot serialize items with `" + t + "` for `options.bullet`, expected `*`, `+`, or `-`"
    );
  return t;
}
function hte(e) {
  const t = TT(e), n = e.options.bulletOther;
  if (!n)
    return t === "*" ? "-" : "*";
  if (n !== "*" && n !== "+" && n !== "-")
    throw new Error(
      "Cannot serialize items with `" + n + "` for `options.bulletOther`, expected `*`, `+`, or `-`"
    );
  if (n === t)
    throw new Error(
      "Expected `bullet` (`" + t + "`) and `bulletOther` (`" + n + "`) to be different"
    );
  return n;
}
function pte(e) {
  const t = e.options.bulletOrdered || ".";
  if (t !== "." && t !== ")")
    throw new Error(
      "Cannot serialize items with `" + t + "` for `options.bulletOrdered`, expected `.` or `)`"
    );
  return t;
}
function LI(e) {
  const t = e.options.rule || "*";
  if (t !== "*" && t !== "-" && t !== "_")
    throw new Error(
      "Cannot serialize rules with `" + t + "` for `options.rule`, expected `*`, `-`, or `_`"
    );
  return t;
}
function mte(e, t, n, r) {
  const i = n.enter("list"), s = n.bulletCurrent;
  let a = e.ordered ? pte(n) : TT(n);
  const u = e.ordered ? a === "." ? ")" : "." : hte(n);
  let d = t && n.bulletLastUsed ? a === n.bulletLastUsed : !1;
  if (!e.ordered) {
    const h = e.children ? e.children[0] : void 0;
    if (
      // Bullet could be used as a thematic break marker:
      (a === "*" || a === "-") && // Empty first list item:
      h && (!h.children || !h.children[0]) && // Directly in two other list items:
      n.stack[n.stack.length - 1] === "list" && n.stack[n.stack.length - 2] === "listItem" && n.stack[n.stack.length - 3] === "list" && n.stack[n.stack.length - 4] === "listItem" && // That are each the first child.
      n.indexStack[n.indexStack.length - 1] === 0 && n.indexStack[n.indexStack.length - 2] === 0 && n.indexStack[n.indexStack.length - 3] === 0 && (d = !0), LI(n) === a && h
    ) {
      let m = -1;
      for (; ++m < e.children.length; ) {
        const x = e.children[m];
        if (x && x.type === "listItem" && x.children && x.children[0] && x.children[0].type === "thematicBreak") {
          d = !0;
          break;
        }
      }
    }
  }
  d && (a = u), n.bulletCurrent = a;
  const f = n.containerFlow(e, r);
  return n.bulletLastUsed = a, n.bulletCurrent = s, i(), f;
}
function gte(e) {
  const t = e.options.listItemIndent || "one";
  if (t !== "tab" && t !== "one" && t !== "mixed")
    throw new Error(
      "Cannot serialize items with `" + t + "` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`"
    );
  return t;
}
function yte(e, t, n, r) {
  const i = gte(n);
  let s = n.bulletCurrent || TT(n);
  t && t.type === "list" && t.ordered && (s = (typeof t.start == "number" && t.start > -1 ? t.start : 1) + (n.options.incrementListMarker === !1 ? 0 : t.children.indexOf(e)) + s);
  let a = s.length + 1;
  (i === "tab" || i === "mixed" && (t && t.type === "list" && t.spread || e.spread)) && (a = Math.ceil(a / 4) * 4);
  const u = n.createTracker(r);
  u.move(s + " ".repeat(a - s.length)), u.shift(a);
  const d = n.enter("listItem"), f = n.indentLines(
    n.containerFlow(e, u.current()),
    h
  );
  return d(), f;
  function h(m, x, b) {
    return x ? (b ? "" : " ".repeat(a)) + m : (b ? s : s + " ".repeat(a - s.length)) + m;
  }
}
function xte(e, t, n, r) {
  const i = n.enter("paragraph"), s = n.enter("phrasing"), a = n.containerPhrasing(e, r);
  return s(), i(), a;
}
const vte = (
  /** @type {(node?: unknown) => node is Exclude<PhrasingContent, Html>} */
  nw([
    "break",
    "delete",
    "emphasis",
    // To do: next major: removed since footnotes were added to GFM.
    "footnote",
    "footnoteReference",
    "image",
    "imageReference",
    "inlineCode",
    // Enabled by `mdast-util-math`:
    "inlineMath",
    "link",
    "linkReference",
    // Enabled by `mdast-util-mdx`:
    "mdxJsxTextElement",
    // Enabled by `mdast-util-mdx`:
    "mdxTextExpression",
    "strong",
    "text",
    // Enabled by `mdast-util-directive`:
    "textDirective"
  ])
);
function bte(e, t, n, r) {
  return (e.children.some(function(a) {
    return vte(a);
  }) ? n.containerPhrasing : n.containerFlow).call(n, e, r);
}
function wte(e) {
  const t = e.options.strong || "*";
  if (t !== "*" && t !== "_")
    throw new Error(
      "Cannot serialize strong with `" + t + "` for `options.strong`, expected `*`, or `_`"
    );
  return t;
}
BI.peek = _te;
function BI(e, t, n, r) {
  const i = wte(n), s = n.enter("strong"), a = n.createTracker(r), u = a.move(i + i);
  let d = a.move(
    n.containerPhrasing(e, {
      after: i,
      before: u,
      ...a.current()
    })
  );
  const f = d.charCodeAt(0), h = hb(
    r.before.charCodeAt(r.before.length - 1),
    f,
    i
  );
  h.inside && (d = Ty(f) + d.slice(1));
  const m = d.charCodeAt(d.length - 1), x = hb(r.after.charCodeAt(0), m, i);
  x.inside && (d = d.slice(0, -1) + Ty(m));
  const b = a.move(i + i);
  return s(), n.attentionEncodeSurroundingInfo = {
    after: x.outside,
    before: h.outside
  }, u + d + b;
}
function _te(e, t, n) {
  return n.options.strong || "*";
}
function Ste(e, t, n, r) {
  return n.safe(e.value, r);
}
function Ete(e) {
  const t = e.options.ruleRepetition || 3;
  if (t < 3)
    throw new Error(
      "Cannot serialize rules with repetition `" + t + "` for `options.ruleRepetition`, expected `3` or more"
    );
  return t;
}
function Cte(e, t, n) {
  const r = (LI(n) + (n.options.ruleSpaces ? " " : "")).repeat(Ete(n));
  return n.options.ruleSpaces ? r.slice(0, -1) : r;
}
const $I = {
  blockquote: Yee,
  break: qN,
  code: ete,
  definition: nte,
  emphasis: NI,
  hardBreak: qN,
  heading: ate,
  html: RI,
  image: MI,
  imageReference: OI,
  inlineCode: DI,
  link: PI,
  linkReference: II,
  list: mte,
  listItem: yte,
  paragraph: xte,
  root: bte,
  strong: BI,
  text: Ste,
  thematicBreak: Cte
};
function kte() {
  return {
    enter: {
      table: Tte,
      tableData: FN,
      tableHeader: FN,
      tableRow: Ate
    },
    exit: {
      codeText: Nte,
      table: jte,
      tableData: c_,
      tableHeader: c_,
      tableRow: c_
    }
  };
}
function Tte(e) {
  const t = e._align;
  this.enter(
    {
      type: "table",
      align: t.map(function(n) {
        return n === "none" ? null : n;
      }),
      children: []
    },
    e
  ), this.data.inTable = !0;
}
function jte(e) {
  this.exit(e), this.data.inTable = void 0;
}
function Ate(e) {
  this.enter({ type: "tableRow", children: [] }, e);
}
function c_(e) {
  this.exit(e);
}
function FN(e) {
  this.enter({ type: "tableCell", children: [] }, e);
}
function Nte(e) {
  let t = this.resume();
  this.data.inTable && (t = t.replace(/\\([\\|])/g, Rte));
  const n = this.stack[this.stack.length - 1];
  n.value = t, this.exit(e);
}
function Rte(e, t) {
  return t === "|" ? t : e;
}
function Mte(e) {
  const t = e || {}, n = t.tableCellPadding, r = t.tablePipeAlign, i = t.stringLength, s = n ? " " : "|";
  return {
    unsafe: [
      { character: "\r", inConstruct: "tableCell" },
      { character: `
`, inConstruct: "tableCell" },
      // A pipe, when followed by a tab or space (padding), or a dash or colon
      // (unpadded delimiter row), could result in a table.
      { atBreak: !0, character: "|", after: "[	 :-]" },
      // A pipe in a cell must be encoded.
      { character: "|", inConstruct: "tableCell" },
      // A colon must be followed by a dash, in which case it could start a
      // delimiter row.
      { atBreak: !0, character: ":", after: "-" },
      // A delimiter row can also start with a dash, when followed by more
      // dashes, a colon, or a pipe.
      // This is a stricter version than the built in check for lists, thematic
      // breaks, and setex heading underlines though:
      // <https://github.com/syntax-tree/mdast-util-to-markdown/blob/51a2038/lib/unsafe.js#L57>
      { atBreak: !0, character: "-", after: "[:|-]" }
    ],
    handlers: {
      inlineCode: x,
      table: a,
      tableCell: d,
      tableRow: u
    }
  };
  function a(b, w, S, C) {
    return f(h(b, S, C), b.align);
  }
  function u(b, w, S, C) {
    const T = m(b, S, C), R = f([T]);
    return R.slice(0, R.indexOf(`
`));
  }
  function d(b, w, S, C) {
    const T = S.enter("tableCell"), R = S.enter("phrasing"), N = S.containerPhrasing(b, {
      ...C,
      before: s,
      after: s
    });
    return R(), T(), N;
  }
  function f(b, w) {
    return Gee(b, {
      align: w,
      // @ts-expect-error: `markdown-table` types should support `null`.
      alignDelimiters: r,
      // @ts-expect-error: `markdown-table` types should support `null`.
      padding: n,
      // @ts-expect-error: `markdown-table` types should support `null`.
      stringLength: i
    });
  }
  function h(b, w, S) {
    const C = b.children;
    let T = -1;
    const R = [], N = w.enter("table");
    for (; ++T < C.length; )
      R[T] = m(C[T], w, S);
    return N(), R;
  }
  function m(b, w, S) {
    const C = b.children;
    let T = -1;
    const R = [], N = w.enter("tableRow");
    for (; ++T < C.length; )
      R[T] = d(C[T], b, w, S);
    return N(), R;
  }
  function x(b, w, S) {
    let C = $I.inlineCode(b, w, S);
    return S.stack.includes("tableCell") && (C = C.replace(/\|/g, "\\$&")), C;
  }
}
function Ote() {
  return {
    exit: {
      taskListCheckValueChecked: UN,
      taskListCheckValueUnchecked: UN,
      paragraph: zte
    }
  };
}
function Dte() {
  return {
    unsafe: [{ atBreak: !0, character: "-", after: "[:|-]" }],
    handlers: { listItem: Pte }
  };
}
function UN(e) {
  const t = this.stack[this.stack.length - 2];
  t.checked = e.type === "taskListCheckValueChecked";
}
function zte(e) {
  const t = this.stack[this.stack.length - 2];
  if (t && t.type === "listItem" && typeof t.checked == "boolean") {
    const n = this.stack[this.stack.length - 1], r = n.children[0];
    if (r && r.type === "text") {
      const i = t.children;
      let s = -1, a;
      for (; ++s < i.length; ) {
        const u = i[s];
        if (u.type === "paragraph") {
          a = u;
          break;
        }
      }
      a === n && (r.value = r.value.slice(1), r.value.length === 0 ? n.children.shift() : n.position && r.position && typeof r.position.start.offset == "number" && (r.position.start.column++, r.position.start.offset++, n.position.start = Object.assign({}, r.position.start)));
    }
  }
  this.exit(e);
}
function Pte(e, t, n, r) {
  const i = e.children[0], s = typeof e.checked == "boolean" && i && i.type === "paragraph", a = "[" + (e.checked ? "x" : " ") + "] ", u = n.createTracker(r);
  s && u.move(a);
  let d = $I.listItem(e, t, n, {
    ...r,
    ...u.current()
  });
  return s && (d = d.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/, f)), d;
  function f(h) {
    return h + a;
  }
}
function Ite() {
  return [
    mee(),
    Pee(),
    $ee(),
    kte(),
    Ote()
  ];
}
function Lte(e) {
  return {
    extensions: [
      gee(),
      Iee(e),
      qee(),
      Mte(e),
      Dte()
    ]
  };
}
const Bte = {
  tokenize: Vte,
  partial: !0
}, qI = {
  tokenize: Gte,
  partial: !0
}, FI = {
  tokenize: Kte,
  partial: !0
}, UI = {
  tokenize: Yte,
  partial: !0
}, $te = {
  tokenize: Wte,
  partial: !0
}, HI = {
  name: "wwwAutolink",
  tokenize: Ute,
  previous: GI
}, VI = {
  name: "protocolAutolink",
  tokenize: Hte,
  previous: KI
}, ic = {
  name: "emailAutolink",
  tokenize: Fte,
  previous: YI
}, au = {};
function qte() {
  return {
    text: au
  };
}
let Wf = 48;
for (; Wf < 123; )
  au[Wf] = ic, Wf++, Wf === 58 ? Wf = 65 : Wf === 91 && (Wf = 97);
au[43] = ic;
au[45] = ic;
au[46] = ic;
au[95] = ic;
au[72] = [ic, VI];
au[104] = [ic, VI];
au[87] = [ic, HI];
au[119] = [ic, HI];
function Fte(e, t, n) {
  const r = this;
  let i, s;
  return a;
  function a(m) {
    return !L3(m) || !YI.call(r, r.previous) || jT(r.events) ? n(m) : (e.enter("literalAutolink"), e.enter("literalAutolinkEmail"), u(m));
  }
  function u(m) {
    return L3(m) ? (e.consume(m), u) : m === 64 ? (e.consume(m), d) : n(m);
  }
  function d(m) {
    return m === 46 ? e.check($te, h, f)(m) : m === 45 || m === 95 || os(m) ? (s = !0, e.consume(m), d) : h(m);
  }
  function f(m) {
    return e.consume(m), i = !0, d;
  }
  function h(m) {
    return s && i && Os(r.previous) ? (e.exit("literalAutolinkEmail"), e.exit("literalAutolink"), t(m)) : n(m);
  }
}
function Ute(e, t, n) {
  const r = this;
  return i;
  function i(a) {
    return a !== 87 && a !== 119 || !GI.call(r, r.previous) || jT(r.events) ? n(a) : (e.enter("literalAutolink"), e.enter("literalAutolinkWww"), e.check(Bte, e.attempt(qI, e.attempt(FI, s), n), n)(a));
  }
  function s(a) {
    return e.exit("literalAutolinkWww"), e.exit("literalAutolink"), t(a);
  }
}
function Hte(e, t, n) {
  const r = this;
  let i = "", s = !1;
  return a;
  function a(m) {
    return (m === 72 || m === 104) && KI.call(r, r.previous) && !jT(r.events) ? (e.enter("literalAutolink"), e.enter("literalAutolinkHttp"), i += String.fromCodePoint(m), e.consume(m), u) : n(m);
  }
  function u(m) {
    if (Os(m) && i.length < 5)
      return i += String.fromCodePoint(m), e.consume(m), u;
    if (m === 58) {
      const x = i.toLowerCase();
      if (x === "http" || x === "https")
        return e.consume(m), d;
    }
    return n(m);
  }
  function d(m) {
    return m === 47 ? (e.consume(m), s ? f : (s = !0, d)) : n(m);
  }
  function f(m) {
    return m === null || cb(m) || Jn(m) || bh(m) || Jb(m) ? n(m) : e.attempt(qI, e.attempt(FI, h), n)(m);
  }
  function h(m) {
    return e.exit("literalAutolinkHttp"), e.exit("literalAutolink"), t(m);
  }
}
function Vte(e, t, n) {
  let r = 0;
  return i;
  function i(a) {
    return (a === 87 || a === 119) && r < 3 ? (r++, e.consume(a), i) : a === 46 && r === 3 ? (e.consume(a), s) : n(a);
  }
  function s(a) {
    return a === null ? n(a) : t(a);
  }
}
function Gte(e, t, n) {
  let r, i, s;
  return a;
  function a(f) {
    return f === 46 || f === 95 ? e.check(UI, d, u)(f) : f === null || Jn(f) || bh(f) || f !== 45 && Jb(f) ? d(f) : (s = !0, e.consume(f), a);
  }
  function u(f) {
    return f === 95 ? r = !0 : (i = r, r = void 0), e.consume(f), a;
  }
  function d(f) {
    return i || r || !s ? n(f) : t(f);
  }
}
function Kte(e, t) {
  let n = 0, r = 0;
  return i;
  function i(a) {
    return a === 40 ? (n++, e.consume(a), i) : a === 41 && r < n ? s(a) : a === 33 || a === 34 || a === 38 || a === 39 || a === 41 || a === 42 || a === 44 || a === 46 || a === 58 || a === 59 || a === 60 || a === 63 || a === 93 || a === 95 || a === 126 ? e.check(UI, t, s)(a) : a === null || Jn(a) || bh(a) ? t(a) : (e.consume(a), i);
  }
  function s(a) {
    return a === 41 && r++, e.consume(a), i;
  }
}
function Yte(e, t, n) {
  return r;
  function r(u) {
    return u === 33 || u === 34 || u === 39 || u === 41 || u === 42 || u === 44 || u === 46 || u === 58 || u === 59 || u === 63 || u === 95 || u === 126 ? (e.consume(u), r) : u === 38 ? (e.consume(u), s) : u === 93 ? (e.consume(u), i) : (
      // `<` is an end.
      u === 60 || // So is whitespace.
      u === null || Jn(u) || bh(u) ? t(u) : n(u)
    );
  }
  function i(u) {
    return u === null || u === 40 || u === 91 || Jn(u) || bh(u) ? t(u) : r(u);
  }
  function s(u) {
    return Os(u) ? a(u) : n(u);
  }
  function a(u) {
    return u === 59 ? (e.consume(u), r) : Os(u) ? (e.consume(u), a) : n(u);
  }
}
function Wte(e, t, n) {
  return r;
  function r(s) {
    return e.consume(s), i;
  }
  function i(s) {
    return os(s) ? n(s) : t(s);
  }
}
function GI(e) {
  return e === null || e === 40 || e === 42 || e === 95 || e === 91 || e === 93 || e === 126 || Jn(e);
}
function KI(e) {
  return !Os(e);
}
function YI(e) {
  return !(e === 47 || L3(e));
}
function L3(e) {
  return e === 43 || e === 45 || e === 46 || e === 95 || os(e);
}
function jT(e) {
  let t = e.length, n = !1;
  for (; t--; ) {
    const r = e[t][1];
    if ((r.type === "labelLink" || r.type === "labelImage") && !r._balanced) {
      n = !0;
      break;
    }
    if (r._gfmAutolinkLiteralWalkedInto) {
      n = !1;
      break;
    }
  }
  return e.length > 0 && !n && (e[e.length - 1][1]._gfmAutolinkLiteralWalkedInto = !0), n;
}
const Zte = {
  tokenize: ine,
  partial: !0
};
function Xte() {
  return {
    document: {
      91: {
        name: "gfmFootnoteDefinition",
        tokenize: tne,
        continuation: {
          tokenize: nne
        },
        exit: rne
      }
    },
    text: {
      91: {
        name: "gfmFootnoteCall",
        tokenize: ene
      },
      93: {
        name: "gfmPotentialFootnoteCall",
        add: "after",
        tokenize: Qte,
        resolveTo: Jte
      }
    }
  };
}
function Qte(e, t, n) {
  const r = this;
  let i = r.events.length;
  const s = r.parser.gfmFootnotes || (r.parser.gfmFootnotes = []);
  let a;
  for (; i--; ) {
    const d = r.events[i][1];
    if (d.type === "labelImage") {
      a = d;
      break;
    }
    if (d.type === "gfmFootnoteCall" || d.type === "labelLink" || d.type === "label" || d.type === "image" || d.type === "link")
      break;
  }
  return u;
  function u(d) {
    if (!a || !a._balanced)
      return n(d);
    const f = rl(r.sliceSerialize({
      start: a.end,
      end: r.now()
    }));
    return f.codePointAt(0) !== 94 || !s.includes(f.slice(1)) ? n(d) : (e.enter("gfmFootnoteCallLabelMarker"), e.consume(d), e.exit("gfmFootnoteCallLabelMarker"), t(d));
  }
}
function Jte(e, t) {
  let n = e.length;
  for (; n-- && !(e[n][1].type === "labelImage" && e[n][0] === "enter"); )
    ;
  e[n + 1][1].type = "data", e[n + 3][1].type = "gfmFootnoteCallLabelMarker";
  const r = {
    type: "gfmFootnoteCall",
    start: Object.assign({}, e[n + 3][1].start),
    end: Object.assign({}, e[e.length - 1][1].end)
  }, i = {
    type: "gfmFootnoteCallMarker",
    start: Object.assign({}, e[n + 3][1].end),
    end: Object.assign({}, e[n + 3][1].end)
  };
  i.end.column++, i.end.offset++, i.end._bufferIndex++;
  const s = {
    type: "gfmFootnoteCallString",
    start: Object.assign({}, i.end),
    end: Object.assign({}, e[e.length - 1][1].start)
  }, a = {
    type: "chunkString",
    contentType: "string",
    start: Object.assign({}, s.start),
    end: Object.assign({}, s.end)
  }, u = [
    // Take the `labelImageMarker` (now `data`, the `!`)
    e[n + 1],
    e[n + 2],
    ["enter", r, t],
    // The `[`
    e[n + 3],
    e[n + 4],
    // The `^`.
    ["enter", i, t],
    ["exit", i, t],
    // Everything in between.
    ["enter", s, t],
    ["enter", a, t],
    ["exit", a, t],
    ["exit", s, t],
    // The ending (`]`, properly parsed and labelled).
    e[e.length - 2],
    e[e.length - 1],
    ["exit", r, t]
  ];
  return e.splice(n, e.length - n + 1, ...u), e;
}
function ene(e, t, n) {
  const r = this, i = r.parser.gfmFootnotes || (r.parser.gfmFootnotes = []);
  let s = 0, a;
  return u;
  function u(m) {
    return e.enter("gfmFootnoteCall"), e.enter("gfmFootnoteCallLabelMarker"), e.consume(m), e.exit("gfmFootnoteCallLabelMarker"), d;
  }
  function d(m) {
    return m !== 94 ? n(m) : (e.enter("gfmFootnoteCallMarker"), e.consume(m), e.exit("gfmFootnoteCallMarker"), e.enter("gfmFootnoteCallString"), e.enter("chunkString").contentType = "string", f);
  }
  function f(m) {
    if (
      // Too long.
      s > 999 || // Closing brace with nothing.
      m === 93 && !a || // Space or tab is not supported by GFM for some reason.
      // `\n` and `[` not being supported makes sense.
      m === null || m === 91 || Jn(m)
    )
      return n(m);
    if (m === 93) {
      e.exit("chunkString");
      const x = e.exit("gfmFootnoteCallString");
      return i.includes(rl(r.sliceSerialize(x))) ? (e.enter("gfmFootnoteCallLabelMarker"), e.consume(m), e.exit("gfmFootnoteCallLabelMarker"), e.exit("gfmFootnoteCall"), t) : n(m);
    }
    return Jn(m) || (a = !0), s++, e.consume(m), m === 92 ? h : f;
  }
  function h(m) {
    return m === 91 || m === 92 || m === 93 ? (e.consume(m), s++, f) : f(m);
  }
}
function tne(e, t, n) {
  const r = this, i = r.parser.gfmFootnotes || (r.parser.gfmFootnotes = []);
  let s, a = 0, u;
  return d;
  function d(w) {
    return e.enter("gfmFootnoteDefinition")._container = !0, e.enter("gfmFootnoteDefinitionLabel"), e.enter("gfmFootnoteDefinitionLabelMarker"), e.consume(w), e.exit("gfmFootnoteDefinitionLabelMarker"), f;
  }
  function f(w) {
    return w === 94 ? (e.enter("gfmFootnoteDefinitionMarker"), e.consume(w), e.exit("gfmFootnoteDefinitionMarker"), e.enter("gfmFootnoteDefinitionLabelString"), e.enter("chunkString").contentType = "string", h) : n(w);
  }
  function h(w) {
    if (
      // Too long.
      a > 999 || // Closing brace with nothing.
      w === 93 && !u || // Space or tab is not supported by GFM for some reason.
      // `\n` and `[` not being supported makes sense.
      w === null || w === 91 || Jn(w)
    )
      return n(w);
    if (w === 93) {
      e.exit("chunkString");
      const S = e.exit("gfmFootnoteDefinitionLabelString");
      return s = rl(r.sliceSerialize(S)), e.enter("gfmFootnoteDefinitionLabelMarker"), e.consume(w), e.exit("gfmFootnoteDefinitionLabelMarker"), e.exit("gfmFootnoteDefinitionLabel"), x;
    }
    return Jn(w) || (u = !0), a++, e.consume(w), w === 92 ? m : h;
  }
  function m(w) {
    return w === 91 || w === 92 || w === 93 ? (e.consume(w), a++, h) : h(w);
  }
  function x(w) {
    return w === 58 ? (e.enter("definitionMarker"), e.consume(w), e.exit("definitionMarker"), i.includes(s) || i.push(s), _n(e, b, "gfmFootnoteDefinitionWhitespace")) : n(w);
  }
  function b(w) {
    return t(w);
  }
}
function nne(e, t, n) {
  return e.check(Jy, t, e.attempt(Zte, t, n));
}
function rne(e) {
  e.exit("gfmFootnoteDefinition");
}
function ine(e, t, n) {
  const r = this;
  return _n(e, i, "gfmFootnoteDefinitionIndent", 5);
  function i(s) {
    const a = r.events[r.events.length - 1];
    return a && a[1].type === "gfmFootnoteDefinitionIndent" && a[2].sliceSerialize(a[1], !0).length === 4 ? t(s) : n(s);
  }
}
function sne(e) {
  let n = (e || {}).singleTilde;
  const r = {
    name: "strikethrough",
    tokenize: s,
    resolveAll: i
  };
  return n == null && (n = !0), {
    text: {
      126: r
    },
    insideSpan: {
      null: [r]
    },
    attentionMarkers: {
      null: [126]
    }
  };
  function i(a, u) {
    let d = -1;
    for (; ++d < a.length; )
      if (a[d][0] === "enter" && a[d][1].type === "strikethroughSequenceTemporary" && a[d][1]._close) {
        let f = d;
        for (; f--; )
          if (a[f][0] === "exit" && a[f][1].type === "strikethroughSequenceTemporary" && a[f][1]._open && // If the sizes are the same:
          a[d][1].end.offset - a[d][1].start.offset === a[f][1].end.offset - a[f][1].start.offset) {
            a[d][1].type = "strikethroughSequence", a[f][1].type = "strikethroughSequence";
            const h = {
              type: "strikethrough",
              start: Object.assign({}, a[f][1].start),
              end: Object.assign({}, a[d][1].end)
            }, m = {
              type: "strikethroughText",
              start: Object.assign({}, a[f][1].end),
              end: Object.assign({}, a[d][1].start)
            }, x = [["enter", h, u], ["enter", a[f][1], u], ["exit", a[f][1], u], ["enter", m, u]], b = u.parser.constructs.insideSpan.null;
            b && $a(x, x.length, 0, ew(b, a.slice(f + 1, d), u)), $a(x, x.length, 0, [["exit", m, u], ["enter", a[d][1], u], ["exit", a[d][1], u], ["exit", h, u]]), $a(a, f - 1, d - f + 3, x), d = f + x.length - 2;
            break;
          }
      }
    for (d = -1; ++d < a.length; )
      a[d][1].type === "strikethroughSequenceTemporary" && (a[d][1].type = "data");
    return a;
  }
  function s(a, u, d) {
    const f = this.previous, h = this.events;
    let m = 0;
    return x;
    function x(w) {
      return f === 126 && h[h.length - 1][1].type !== "characterEscape" ? d(w) : (a.enter("strikethroughSequenceTemporary"), b(w));
    }
    function b(w) {
      const S = Mm(f);
      if (w === 126)
        return m > 1 ? d(w) : (a.consume(w), m++, b);
      if (m < 2 && !n) return d(w);
      const C = a.exit("strikethroughSequenceTemporary"), T = Mm(w);
      return C._open = !T || T === 2 && !!S, C._close = !S || S === 2 && !!T, u(w);
    }
  }
}
class ane {
  /**
   * Create a new edit map.
   */
  constructor() {
    this.map = [];
  }
  /**
   * Create an edit: a remove and/or add at a certain place.
   *
   * @param {number} index
   * @param {number} remove
   * @param {Array<Event>} add
   * @returns {undefined}
   */
  add(t, n, r) {
    one(this, t, n, r);
  }
  // To do: add this when moving to `micromark`.
  // /**
  //  * Create an edit: but insert `add` before existing additions.
  //  *
  //  * @param {number} index
  //  * @param {number} remove
  //  * @param {Array<Event>} add
  //  * @returns {undefined}
  //  */
  // addBefore(index, remove, add) {
  //   addImplementation(this, index, remove, add, true)
  // }
  /**
   * Done, change the events.
   *
   * @param {Array<Event>} events
   * @returns {undefined}
   */
  consume(t) {
    if (this.map.sort(function(s, a) {
      return s[0] - a[0];
    }), this.map.length === 0)
      return;
    let n = this.map.length;
    const r = [];
    for (; n > 0; )
      n -= 1, r.push(t.slice(this.map[n][0] + this.map[n][1]), this.map[n][2]), t.length = this.map[n][0];
    r.push(t.slice()), t.length = 0;
    let i = r.pop();
    for (; i; ) {
      for (const s of i)
        t.push(s);
      i = r.pop();
    }
    this.map.length = 0;
  }
}
function one(e, t, n, r) {
  let i = 0;
  if (!(n === 0 && r.length === 0)) {
    for (; i < e.map.length; ) {
      if (e.map[i][0] === t) {
        e.map[i][1] += n, e.map[i][2].push(...r);
        return;
      }
      i += 1;
    }
    e.map.push([t, n, r]);
  }
}
function lne(e, t) {
  let n = !1;
  const r = [];
  for (; t < e.length; ) {
    const i = e[t];
    if (n) {
      if (i[0] === "enter")
        i[1].type === "tableContent" && r.push(e[t + 1][1].type === "tableDelimiterMarker" ? "left" : "none");
      else if (i[1].type === "tableContent") {
        if (e[t - 1][1].type === "tableDelimiterMarker") {
          const s = r.length - 1;
          r[s] = r[s] === "left" ? "center" : "right";
        }
      } else if (i[1].type === "tableDelimiterRow")
        break;
    } else i[0] === "enter" && i[1].type === "tableDelimiterRow" && (n = !0);
    t += 1;
  }
  return r;
}
function une() {
  return {
    flow: {
      null: {
        name: "table",
        tokenize: cne,
        resolveAll: dne
      }
    }
  };
}
function cne(e, t, n) {
  const r = this;
  let i = 0, s = 0, a;
  return u;
  function u(V) {
    let $ = r.events.length - 1;
    for (; $ > -1; ) {
      const Z = r.events[$][1].type;
      if (Z === "lineEnding" || // Note: markdown-rs uses `whitespace` instead of `linePrefix`
      Z === "linePrefix") $--;
      else break;
    }
    const G = $ > -1 ? r.events[$][1].type : null, le = G === "tableHead" || G === "tableRow" ? D : d;
    return le === D && r.parser.lazy[r.now().line] ? n(V) : le(V);
  }
  function d(V) {
    return e.enter("tableHead"), e.enter("tableRow"), f(V);
  }
  function f(V) {
    return V === 124 || (a = !0, s += 1), h(V);
  }
  function h(V) {
    return V === null ? n(V) : Ot(V) ? s > 1 ? (s = 0, r.interrupt = !0, e.exit("tableRow"), e.enter("lineEnding"), e.consume(V), e.exit("lineEnding"), b) : n(V) : dn(V) ? _n(e, h, "whitespace")(V) : (s += 1, a && (a = !1, i += 1), V === 124 ? (e.enter("tableCellDivider"), e.consume(V), e.exit("tableCellDivider"), a = !0, h) : (e.enter("data"), m(V)));
  }
  function m(V) {
    return V === null || V === 124 || Jn(V) ? (e.exit("data"), h(V)) : (e.consume(V), V === 92 ? x : m);
  }
  function x(V) {
    return V === 92 || V === 124 ? (e.consume(V), m) : m(V);
  }
  function b(V) {
    return r.interrupt = !1, r.parser.lazy[r.now().line] ? n(V) : (e.enter("tableDelimiterRow"), a = !1, dn(V) ? _n(e, w, "linePrefix", r.parser.constructs.disable.null.includes("codeIndented") ? void 0 : 4)(V) : w(V));
  }
  function w(V) {
    return V === 45 || V === 58 ? C(V) : V === 124 ? (a = !0, e.enter("tableCellDivider"), e.consume(V), e.exit("tableCellDivider"), S) : P(V);
  }
  function S(V) {
    return dn(V) ? _n(e, C, "whitespace")(V) : C(V);
  }
  function C(V) {
    return V === 58 ? (s += 1, a = !0, e.enter("tableDelimiterMarker"), e.consume(V), e.exit("tableDelimiterMarker"), T) : V === 45 ? (s += 1, T(V)) : V === null || Ot(V) ? M(V) : P(V);
  }
  function T(V) {
    return V === 45 ? (e.enter("tableDelimiterFiller"), R(V)) : P(V);
  }
  function R(V) {
    return V === 45 ? (e.consume(V), R) : V === 58 ? (a = !0, e.exit("tableDelimiterFiller"), e.enter("tableDelimiterMarker"), e.consume(V), e.exit("tableDelimiterMarker"), N) : (e.exit("tableDelimiterFiller"), N(V));
  }
  function N(V) {
    return dn(V) ? _n(e, M, "whitespace")(V) : M(V);
  }
  function M(V) {
    return V === 124 ? w(V) : V === null || Ot(V) ? !a || i !== s ? P(V) : (e.exit("tableDelimiterRow"), e.exit("tableHead"), t(V)) : P(V);
  }
  function P(V) {
    return n(V);
  }
  function D(V) {
    return e.enter("tableRow"), q(V);
  }
  function q(V) {
    return V === 124 ? (e.enter("tableCellDivider"), e.consume(V), e.exit("tableCellDivider"), q) : V === null || Ot(V) ? (e.exit("tableRow"), t(V)) : dn(V) ? _n(e, q, "whitespace")(V) : (e.enter("data"), Y(V));
  }
  function Y(V) {
    return V === null || V === 124 || Jn(V) ? (e.exit("data"), q(V)) : (e.consume(V), V === 92 ? te : Y);
  }
  function te(V) {
    return V === 92 || V === 124 ? (e.consume(V), Y) : Y(V);
  }
}
function dne(e, t) {
  let n = -1, r = !0, i = 0, s = [0, 0, 0, 0], a = [0, 0, 0, 0], u = !1, d = 0, f, h, m;
  const x = new ane();
  for (; ++n < e.length; ) {
    const b = e[n], w = b[1];
    b[0] === "enter" ? w.type === "tableHead" ? (u = !1, d !== 0 && (HN(x, t, d, f, h), h = void 0, d = 0), f = {
      type: "table",
      start: Object.assign({}, w.start),
      // Note: correct end is set later.
      end: Object.assign({}, w.end)
    }, x.add(n, 0, [["enter", f, t]])) : w.type === "tableRow" || w.type === "tableDelimiterRow" ? (r = !0, m = void 0, s = [0, 0, 0, 0], a = [0, n + 1, 0, 0], u && (u = !1, h = {
      type: "tableBody",
      start: Object.assign({}, w.start),
      // Note: correct end is set later.
      end: Object.assign({}, w.end)
    }, x.add(n, 0, [["enter", h, t]])), i = w.type === "tableDelimiterRow" ? 2 : h ? 3 : 1) : i && (w.type === "data" || w.type === "tableDelimiterMarker" || w.type === "tableDelimiterFiller") ? (r = !1, a[2] === 0 && (s[1] !== 0 && (a[0] = a[1], m = f1(x, t, s, i, void 0, m), s = [0, 0, 0, 0]), a[2] = n)) : w.type === "tableCellDivider" && (r ? r = !1 : (s[1] !== 0 && (a[0] = a[1], m = f1(x, t, s, i, void 0, m)), s = a, a = [s[1], n, 0, 0])) : w.type === "tableHead" ? (u = !0, d = n) : w.type === "tableRow" || w.type === "tableDelimiterRow" ? (d = n, s[1] !== 0 ? (a[0] = a[1], m = f1(x, t, s, i, n, m)) : a[1] !== 0 && (m = f1(x, t, a, i, n, m)), i = 0) : i && (w.type === "data" || w.type === "tableDelimiterMarker" || w.type === "tableDelimiterFiller") && (a[3] = n);
  }
  for (d !== 0 && HN(x, t, d, f, h), x.consume(t.events), n = -1; ++n < t.events.length; ) {
    const b = t.events[n];
    b[0] === "enter" && b[1].type === "table" && (b[1]._align = lne(t.events, n));
  }
  return e;
}
function f1(e, t, n, r, i, s) {
  const a = r === 1 ? "tableHeader" : r === 2 ? "tableDelimiter" : "tableData", u = "tableContent";
  n[0] !== 0 && (s.end = Object.assign({}, rm(t.events, n[0])), e.add(n[0], 0, [["exit", s, t]]));
  const d = rm(t.events, n[1]);
  if (s = {
    type: a,
    start: Object.assign({}, d),
    // Note: correct end is set later.
    end: Object.assign({}, d)
  }, e.add(n[1], 0, [["enter", s, t]]), n[2] !== 0) {
    const f = rm(t.events, n[2]), h = rm(t.events, n[3]), m = {
      type: u,
      start: Object.assign({}, f),
      end: Object.assign({}, h)
    };
    if (e.add(n[2], 0, [["enter", m, t]]), r !== 2) {
      const x = t.events[n[2]], b = t.events[n[3]];
      if (x[1].end = Object.assign({}, b[1].end), x[1].type = "chunkText", x[1].contentType = "text", n[3] > n[2] + 1) {
        const w = n[2] + 1, S = n[3] - n[2] - 1;
        e.add(w, S, []);
      }
    }
    e.add(n[3] + 1, 0, [["exit", m, t]]);
  }
  return i !== void 0 && (s.end = Object.assign({}, rm(t.events, i)), e.add(i, 0, [["exit", s, t]]), s = void 0), s;
}
function HN(e, t, n, r, i) {
  const s = [], a = rm(t.events, n);
  i && (i.end = Object.assign({}, a), s.push(["exit", i, t])), r.end = Object.assign({}, a), s.push(["exit", r, t]), e.add(n + 1, 0, s);
}
function rm(e, t) {
  const n = e[t], r = n[0] === "enter" ? "start" : "end";
  return n[1][r];
}
const fne = {
  name: "tasklistCheck",
  tokenize: pne
};
function hne() {
  return {
    text: {
      91: fne
    }
  };
}
function pne(e, t, n) {
  const r = this;
  return i;
  function i(d) {
    return (
      // Exit if theres stuff before.
      r.previous !== null || // Exit if not in the first content that is the first child of a list
      // item.
      !r._gfmTasklistFirstContentOfListItem ? n(d) : (e.enter("taskListCheck"), e.enter("taskListCheckMarker"), e.consume(d), e.exit("taskListCheckMarker"), s)
    );
  }
  function s(d) {
    return Jn(d) ? (e.enter("taskListCheckValueUnchecked"), e.consume(d), e.exit("taskListCheckValueUnchecked"), a) : d === 88 || d === 120 ? (e.enter("taskListCheckValueChecked"), e.consume(d), e.exit("taskListCheckValueChecked"), a) : n(d);
  }
  function a(d) {
    return d === 93 ? (e.enter("taskListCheckMarker"), e.consume(d), e.exit("taskListCheckMarker"), e.exit("taskListCheck"), u) : n(d);
  }
  function u(d) {
    return Ot(d) ? t(d) : dn(d) ? e.check({
      tokenize: mne
    }, t, n)(d) : n(d);
  }
}
function mne(e, t, n) {
  return _n(e, r, "whitespace");
  function r(i) {
    return i === null ? n(i) : t(i);
  }
}
function gne(e) {
  return sI([
    qte(),
    Xte(),
    sne(e),
    une(),
    hne()
  ]);
}
const yne = {};
function xne(e) {
  const t = (
    /** @type {Processor<Root>} */
    this
  ), n = e || yne, r = t.data(), i = r.micromarkExtensions || (r.micromarkExtensions = []), s = r.fromMarkdownExtensions || (r.fromMarkdownExtensions = []), a = r.toMarkdownExtensions || (r.toMarkdownExtensions = []);
  i.push(gne(n)), s.push(Ite()), a.push(Lte(n));
}
const VN = "Engram_project";
async function vne(e) {
  try {
    const t = await fetch("/api/extensions/discover");
    if (!t.ok)
      return console.warn("[Engram] :", t.status), null;
    const r = (await t.json()).find(
      (i) => i.name === e || i.name.endsWith(e)
    );
    return r ? (console.debug("[Engram] :", r.name, ":", r.type), r.type) : (console.warn("[Engram] :", e), null);
  } catch (t) {
    return console.warn("[Engram] ", t), null;
  }
}
function bne() {
  var e, t;
  try {
    if (typeof window.getRequestHeaders == "function")
      return window.getRequestHeaders();
    const n = (t = (e = window.SillyTavern) == null ? void 0 : e.getContext) == null ? void 0 : t.call(e);
    if (n != null && n.getRequestHeaders)
      return n.getRequestHeaders();
  } catch (n) {
    console.warn("[Engram] ", n);
  }
  return {
    "Content-Type": "application/json"
  };
}
async function wne() {
  try {
    const e = bne(), t = await vne(VN), n = t === "global";
    console.debug("[Engram] :", t, "| global:", n);
    const r = await fetch("/api/extensions/update", {
      method: "POST",
      headers: {
        ...e,
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        extensionName: VN,
        global: n
      })
    });
    if (!r.ok) {
      const s = await r.text();
      return console.error("[Engram] :", r.status, s), { success: !1, message: s || r.statusText };
    }
    const i = await r.json();
    return i.isUpToDate ? { success: !0, message: "", isUpToDate: !0 } : {
      success: !0,
      message: `: ${i.shortCommitHash || "latest"}`,
      isUpToDate: !1
    };
  } catch (e) {
    return console.error("[Engram] :", e), { success: !1, message: String(e) };
  }
}
const _ne = ({ isOpen: e, onClose: t }) => {
  const [n, r] = I.useState(!0), [i, s] = I.useState(null), [a, u] = I.useState(null), [d, f] = I.useState(!1), [h, m] = I.useState(!1), [x, b] = I.useState(!1), [w, S] = I.useState(null), C = Wl.getCurrentVersion();
  I.useEffect(() => {
    e && (T(), S(null));
  }, [e]);
  const T = async () => {
    r(!0);
    try {
      const [P, D, q] = await Promise.all([
        Wl.getLatestVersion(),
        Wl.getChangelog(),
        Wl.hasUpdate()
      ]);
      s(P), u(D), f(q);
    } catch (P) {
      console.error("[Engram] ", P);
    } finally {
      r(!1);
    }
  }, R = async () => {
    m(!0);
    try {
      const P = i || C;
      console.debug("[Engram] Marking update as read:", P), await Wl.markAsRead(P), t();
    } finally {
      m(!1);
    }
  }, N = async () => {
    b(!0), S(null);
    try {
      const P = await wne();
      P.success && !P.isUpToDate ? (S(" 2 ..."), xn.success("", "Engram "), i && await Wl.markAsRead(i), setTimeout(() => {
        window.location.reload();
      }, 2e3)) : P.isUpToDate ? (S(""), f(!1)) : (S(`: ${P.message}`), xn.error(`: ${P.message}`, "Engram "));
    } catch (P) {
      S(`: ${String(P)}`), xn.error(`: ${String(P)}`, "Engram ");
    } finally {
      b(!1);
    }
  }, M = () => {
    Wl.clearCache(), T();
  };
  return e ? /* @__PURE__ */ c.jsxs("div", { className: "fixed inset-0 z-[100] flex items-center justify-center p-4", children: [
    /* @__PURE__ */ c.jsx(
      "div",
      {
        className: "absolute inset-0 bg-black/60 backdrop-blur-sm",
        onClick: t
      }
    ),
    /* @__PURE__ */ c.jsxs("div", { className: "relative bg-card border border-border rounded-xl shadow-2xl w-full max-w-lg max-h-[80vh] flex flex-col overflow-hidden animate-in zoom-in-95 duration-200", children: [
      /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between px-5 py-4 border-b border-border/50", children: [
        /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-3", children: [
          /* @__PURE__ */ c.jsx("div", { className: "w-8 h-8 rounded-lg bg-primary/10 flex items-center justify-center", children: /* @__PURE__ */ c.jsx(sy, { size: 16, className: "text-primary" }) }),
          /* @__PURE__ */ c.jsxs("div", { children: [
            /* @__PURE__ */ c.jsx("h2", { className: "text-base font-semibold text-foreground", children: "" }),
            /* @__PURE__ */ c.jsxs("p", { className: "text-xs text-muted-foreground", children: [
              ": v",
              C
            ] })
          ] })
        ] }),
        /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2", children: [
          /* @__PURE__ */ c.jsx(
            "button",
            {
              onClick: M,
              className: "p-2 rounded-lg hover:bg-muted/50 text-muted-foreground hover:text-foreground transition-colors",
              title: "",
              children: /* @__PURE__ */ c.jsx(fr, { size: 16, className: n ? "animate-spin" : "" })
            }
          ),
          /* @__PURE__ */ c.jsx(
            "button",
            {
              onClick: t,
              className: "p-2 rounded-lg hover:bg-muted/50 text-muted-foreground hover:text-foreground transition-colors",
              children: /* @__PURE__ */ c.jsx(Wu, { size: 16 })
            }
          )
        ] })
      ] }),
      /* @__PURE__ */ c.jsx("div", { className: "flex-1 overflow-y-auto p-5", children: n ? /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col items-center justify-center py-12 text-muted-foreground", children: [
        /* @__PURE__ */ c.jsx(fr, { size: 24, className: "animate-spin mb-3" }),
        /* @__PURE__ */ c.jsx("p", { className: "text-sm", children: "..." })
      ] }) : /* @__PURE__ */ c.jsxs("div", { className: "space-y-4", children: [
        /* @__PURE__ */ c.jsx("div", { className: `
                                p-4 rounded-lg border
                                ${d ? "bg-primary/5 border-primary/20" : "bg-green-500/5 border-green-500/20"}
                            `, children: /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-3", children: [
          d ? /* @__PURE__ */ c.jsx(sy, { size: 20, className: "text-primary" }) : /* @__PURE__ */ c.jsx(U5, { size: 20, className: "text-green-500" }),
          /* @__PURE__ */ c.jsxs("div", { className: "flex-1", children: [
            /* @__PURE__ */ c.jsx("p", { className: "font-medium text-foreground", children: d ? `: v${i}` : "" }),
            /* @__PURE__ */ c.jsx("p", { className: "text-xs text-muted-foreground mt-0.5", children: d ? "" : "" })
          ] })
        ] }) }),
        w && /* @__PURE__ */ c.jsx("div", { className: `
                                    p-3 rounded-lg text-sm
                                    ${w.includes("") ? "bg-green-500/10 text-green-600 border border-green-500/20" : w.includes("") || w.includes("") ? "bg-red-500/10 text-red-600 border border-red-500/20" : "bg-muted/30 text-muted-foreground"}
                                `, children: w }),
        a && /* @__PURE__ */ c.jsxs("div", { className: "space-y-2", children: [
          /* @__PURE__ */ c.jsx("h3", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider", children: "" }),
          /* @__PURE__ */ c.jsx("div", { className: "bg-muted/20 rounded-lg p-4 max-h-64 overflow-y-auto engram-changelog-content text-sm", children: /* @__PURE__ */ c.jsx(see, { remarkPlugins: [xne], children: a }) })
        ] }),
        !a && !n && /* @__PURE__ */ c.jsx("div", { className: "text-center py-8 text-muted-foreground", children: /* @__PURE__ */ c.jsx("p", { className: "text-sm", children: "" }) })
      ] }) }),
      /* @__PURE__ */ c.jsxs("div", { className: "px-5 py-4 border-t border-border/50 flex justify-end gap-3", children: [
        /* @__PURE__ */ c.jsx(
          "button",
          {
            onClick: t,
            className: "px-4 py-2 text-sm text-muted-foreground hover:text-foreground transition-colors",
            children: ""
          }
        ),
        d && /* @__PURE__ */ c.jsx(
          "button",
          {
            onClick: R,
            disabled: h || x,
            className: "px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors disabled:opacity-50",
            children: ""
          }
        ),
        /* @__PURE__ */ c.jsx(
          "button",
          {
            onClick: N,
            disabled: x || h,
            className: `px-4 py-2 text-sm rounded-lg transition-colors disabled:opacity-50 flex items-center gap-2 ${d ? "bg-primary text-primary-foreground hover:bg-primary/90" : "border border-border text-muted-foreground hover:text-foreground hover:border-muted-foreground"}`,
            children: x ? /* @__PURE__ */ c.jsxs(c.Fragment, { children: [
              /* @__PURE__ */ c.jsx(rc, { size: 14, className: "animate-spin" }),
              "..."
            ] }) : d ? /* @__PURE__ */ c.jsxs(c.Fragment, { children: [
              /* @__PURE__ */ c.jsx(sy, { size: 14 }),
              ""
            ] }) : /* @__PURE__ */ c.jsxs(c.Fragment, { children: [
              /* @__PURE__ */ c.jsx(fr, { size: 14 }),
              ""
            ] })
          }
        )
      ] })
    ] })
  ] }) : null;
}, Sne = ({ children: e, activeTab: t, setActiveTab: n, onClose: r }) => {
  const [i, s] = I.useState(!1), [a, u] = I.useState(!1), [d, f] = I.useState(!1);
  I.useEffect(() => {
    (async () => {
      try {
        const b = await Wl.hasUnreadUpdate();
        f(b);
      } catch (b) {
        console.debug("[Engram] ", b);
      }
    })();
  }, []);
  const h = () => {
    u(!0);
  }, m = () => {
    u(!1), f(!1);
  };
  return /* @__PURE__ */ c.jsxs("div", { className: "flex absolute inset-0 w-full h-full bg-background text-foreground overflow-hidden font-sans selection:bg-primary/30 selection:text-primary animate-in fade-in duration-300", id: "engram-layout-root", children: [
    /* @__PURE__ */ c.jsx(DU, {}),
    /* @__PURE__ */ c.jsx(
      _ne,
      {
        isOpen: a,
        onClose: m
      }
    ),
    /* @__PURE__ */ c.jsx(
      tN,
      {
        activeTab: t,
        onNavigate: n,
        isMobile: !1,
        onShowUpdateNotice: h,
        hasUnreadUpdate: d
      }
    ),
    /* @__PURE__ */ c.jsx(
      tN,
      {
        activeTab: t,
        onNavigate: n,
        isMobile: !0,
        isOpen: i,
        onClose: () => s(!1),
        onShowUpdateNotice: h,
        hasUnreadUpdate: d
      }
    ),
    /* @__PURE__ */ c.jsxs("div", { className: "flex flex-1 flex-col overflow-hidden", children: [
      /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col flex-shrink-0 border-b border-border bg-sidebar/95 backdrop-blur z-50 transition-all duration-300", children: [
        /* @__PURE__ */ c.jsx(
          YW,
          {
            onToggleSidebar: () => s(!i),
            isMobile: !1,
            onClose: r,
            onNavigate: (x) => n(x.replace("/", ""))
          }
        ),
        /* @__PURE__ */ c.jsx("div", { id: "engram-header-extension", className: "z-40 flex-shrink-0 bg-transparent transition-all empty:hidden" })
      ] }),
      /* @__PURE__ */ c.jsx("main", { className: "flex-1 flex flex-col relative w-full overflow-hidden bg-background", children: /* @__PURE__ */ c.jsx(
        "div",
        {
          className: "flex-1 overflow-y-auto overflow-x-hidden pt-0 px-4 pb-4 md:px-8 md:pb-8 lg:px-12 lg:pb-12 scroll-smooth engram-page-enter",
          children: /* @__PURE__ */ c.jsx("div", { className: "max-w-6xl mx-auto min-h-full pb-20", children: e })
        },
        t
      ) })
    ] }),
    "  "
  ] });
}, Gl = {
  primary: "#FFFFFF",
  grid: "#111111"
}, Ene = ({ onComplete: e }) => {
  const t = I.useRef(null), n = I.useRef(null), r = I.useRef(null), i = I.useRef(null), [s, a] = I.useState(!1);
  I.useEffect(() => {
    if (window.gsap) {
      a(!0);
      return;
    }
    const d = document.createElement("script");
    d.src = "https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js", d.async = !0, d.onload = () => a(!0), document.body.appendChild(d);
  }, []);
  const u = () => {
    var b;
    if (!s || !n.current) return;
    const d = window.gsap, f = n.current, h = f.getTotalLength();
    d.set(f, {
      strokeDasharray: h,
      strokeDashoffset: h,
      stroke: Gl.primary,
      fillOpacity: 0,
      opacity: 1,
      strokeWidth: 2
    });
    const m = (b = r.current) == null ? void 0 : b.querySelectorAll("path");
    m && d.set(m, { opacity: 0, y: 10 }), d.set(i.current, { scale: 1, opacity: 1 }), d.set(t.current, { opacity: 1 });
    const x = d.timeline({
      onComplete: () => {
        d.to(t.current, {
          opacity: 0,
          duration: 0.8,
          ease: "power2.out",
          onComplete: e
        });
      }
    });
    x.to(f, {
      strokeDashoffset: 0,
      duration: 2.5,
      ease: "power2.inOut"
    }), m && x.to(m, {
      opacity: 1,
      y: 0,
      duration: 1.2,
      stagger: 0.08,
      ease: "power3.out"
    }, "-=0.8"), x.to({}, { duration: 1 });
  };
  return I.useEffect(() => {
    if (s) {
      const d = setTimeout(u, 800);
      return () => clearTimeout(d);
    }
  }, [s]), /* @__PURE__ */ c.jsxs(
    "div",
    {
      ref: t,
      className: "fixed inset-0 z-[200] flex flex-col items-center justify-center bg-black overflow-hidden",
      style: { touchAction: "none" },
      children: [
        /* @__PURE__ */ c.jsx(
          "div",
          {
            className: "absolute inset-0 pointer-events-none",
            style: {
              backgroundImage: `
                        linear-gradient(to right, ${Gl.grid} 1px, transparent 1px),
                        linear-gradient(to bottom, ${Gl.grid} 1px, transparent 1px)
                    `,
              backgroundSize: "40px 40px",
              opacity: 0.3
            }
          }
        ),
        /* @__PURE__ */ c.jsx(
          "div",
          {
            className: "absolute inset-0 pointer-events-none",
            style: { background: "radial-gradient(circle at center, transparent 0%, black 100%)", opacity: 0.9 }
          }
        ),
        /* @__PURE__ */ c.jsxs("div", { className: "z-10 relative flex flex-col items-center justify-center w-full h-full p-4", children: [
          /* @__PURE__ */ c.jsx("div", { className: "w-full max-w-[600px] md:max-w-[800px] aspect-[4/3]", children: /* @__PURE__ */ c.jsx(
            "svg",
            {
              version: "1.1",
              xmlns: "http://www.w3.org/2000/svg",
              viewBox: "250 0 550 600",
              className: "w-full h-full overflow-visible",
              children: /* @__PURE__ */ c.jsxs("g", { ref: i, className: "origin-center", children: [
                /* @__PURE__ */ c.jsx(
                  "path",
                  {
                    ref: n,
                    fill: "none",
                    stroke: Gl.primary,
                    strokeWidth: "2",
                    strokeLinecap: "round",
                    strokeLinejoin: "round",
                    d: "M463.360840,364.455627 C437.246704,381.338409 406.466644,366.209045 404.026672,335.650848 C402.910156,321.667206 412.549713,306.544678 426.813293,300.633850 C430.474335,299.116699 431.826355,297.290924 431.760071,293.302460 C431.519287,278.808716 431.584564,264.307892 431.718292,249.811417 C431.748169,246.574463 430.886292,244.713684 427.681274,243.389038 C412.366425,237.059357 404.237366,225.144638 404.208862,208.867447 C404.179871,192.298615 412.621979,180.486938 428.224701,174.293686 C430.850494,173.251419 431.710938,171.751862 431.696136,169.060089 C431.613586,154.062912 431.568054,139.064117 431.723419,124.068092 C431.759430,120.590492 430.119568,119.052467 427.243103,117.790627 C413.349915,111.695946 405.841095,101.009903 404.195740,85.916542 C402.099884,66.690948 418.566650,47.364159 437.884277,46.682220 C456.888519,46.011345 468.064789,52.989845 476.252197,70.840332 C477.174438,72.851059 478.313995,73.541710 480.422974,73.516098 C499.569031,73.283493 518.722961,73.393646 537.862915,73.456795 C545.529785,73.482086 549.225952,71.767975 552.791809,64.663139 C559.898376,50.503635 576.618042,43.921410 592.447876,47.234680 C608.699890,50.636322 619.276489,62.116261 621.438904,78.701805 C623.839478,97.113228 612.679382,114.371338 595.357910,119.034004 C577.219604,123.916542 558.125427,115.204048 550.887390,98.365906 C549.251465,94.560234 547.316284,93.116508 543.150696,93.160004 C522.989380,93.370483 502.824707,93.284561 482.661285,93.261726 C479.716156,93.258385 477.395905,93.379341 475.956635,96.902077 C474.571899,100.291283 475.702576,102.070137 477.892181,104.225159 C501.524139,127.483910 525.127991,150.771423 548.653259,174.137985 C550.803162,176.273376 552.520325,176.380997 555.207153,175.171799 C569.642334,168.675354 583.205750,171.177368 594.759277,181.252563 C606.783813,191.738449 610.379395,205.504944 605.248840,220.725037 C600.321167,235.343246 589.568848,243.345337 574.305420,245.467117 C567.655396,246.391541 561.334045,245.373352 555.347839,242.591797 C552.373169,241.209595 550.274536,241.303284 547.832886,243.728531 C524.197693,267.205322 500.499634,290.619415 476.704651,313.934174 C474.165771,316.421844 475.106598,318.487793 476.015411,321.059723 C476.869354,323.476318 478.159149,324.356232 480.796143,324.332367 C501.456360,324.145294 522.118530,324.019531 542.778870,324.122131 C546.987793,324.143005 549.216675,322.931549 551.044983,318.871887 C558.230042,302.918091 576.073181,294.652069 593.497131,298.684143 C610.451355,302.607544 622.335205,317.668091 622.119812,334.958160 C621.900024,352.608002 609.316650,367.564362 591.822144,370.969543 C574.585754,374.324463 557.004028,364.861755 550.521484,348.456757 C549.268677,345.286346 547.631836,344.200745 544.294861,344.220337 C523.465576,344.342865 502.634888,344.322540 481.805359,344.218109 C478.697174,344.202545 476.993927,345.152252 475.888916,348.205902 C473.513214,354.771179 469.417969,360.183167 463.360840,364.455627 M472.733368,188.880936 C473.545441,190.333145 474.799072,191.702774 475.088898,193.252655 C476.058929,198.439468 479.434326,198.919983 483.888489,198.861130 C499.042145,198.660889 514.201233,198.707901 529.355957,198.872879 C532.819580,198.910583 534.700989,197.913788 536.177185,194.588806 C537.657104,191.255417 536.060120,189.735016 534.097900,187.805573 C510.706268,164.804840 487.354065,141.764008 463.949341,118.776604 C462.445251,117.299316 461.277863,114.441566 458.282349,116.423027 C455.343719,118.366882 451.028107,118.406143 451.180542,123.994591 C451.584534,138.807007 451.429443,153.638779 451.250458,168.459885 C451.208984,171.894135 452.474548,173.487930 455.559784,174.673798 C462.566864,177.367126 468.343140,181.758774 472.733368,188.880936 M457.308807,300.958954 C460.540070,302.823181 462.218414,300.310028 464.063263,298.488586 C487.164032,275.681519 510.248199,252.857559 533.326538,230.027756 C535.300171,228.075378 537.458679,226.516449 535.970032,222.843750 C534.495117,219.205124 532.067688,218.878906 528.898010,218.890778 C513.414001,218.948746 497.929138,219.002151 482.445862,218.887329 C478.998230,218.861771 477.090668,219.941055 475.670502,223.284790 C471.742218,232.533905 465.159332,239.474701 455.665497,243.103836 C452.239746,244.413376 451.216278,246.302231 451.253540,249.781387 C451.406891,264.098541 451.489380,278.421356 451.223358,292.735107 C451.142975,297.059998 452.224640,299.783386 457.308807,300.958954 z"
                  }
                ),
                /* @__PURE__ */ c.jsxs("g", { ref: r, children: [
                  /* @__PURE__ */ c.jsx("path", { fill: Gl.primary, d: "M732.215698,483.876190 C732.750061,488.775055 731.110779,490.523590 726.372742,490.479736 C713.642639,490.361908 713.645874,490.566711 713.641113,477.834442 C713.638428,470.668732 713.788818,463.497284 713.552246,456.338928 C713.318970,449.278015 710.633911,445.451111 705.788818,444.403778 C698.667542,442.864441 692.689270,447.076904 692.324463,454.647736 C691.851685,464.458313 691.862549,474.305084 692.048706,484.128967 C692.137085,488.792786 690.778625,490.578705 685.827454,490.500549 C672.843933,490.295532 672.845886,490.510315 672.820435,477.502625 C672.805786,470.003754 672.887146,462.502136 672.708618,455.006927 C672.557556,448.666412 669.519653,444.981689 664.341858,444.320343 C658.234436,443.540314 653.997803,446.541077 652.162415,452.864807 C651.503052,455.136719 651.331299,457.435608 651.335754,459.781158 C651.352234,468.446747 651.306274,477.112488 651.338745,485.777985 C651.348389,488.341766 651.062439,490.138977 647.717529,490.447815 C632.733521,491.831421 632.748596,491.913239 632.764404,477.031830 C632.778870,463.366852 632.738831,449.701782 632.731445,436.036774 C632.727478,428.732941 632.735718,428.732544 640.257812,428.707031 C641.591003,428.702484 642.924194,428.695312 644.257324,428.701721 C647.429321,428.717010 651.058289,427.916016 650.925598,433.229431 C655.308960,431.486603 658.595154,429.192383 662.595154,428.377930 C670.453491,426.777832 677.619019,428.117981 683.735718,433.181641 C686.512207,435.480164 688.239807,435.373474 690.953918,433.250153 C697.176208,428.382202 704.485840,426.832367 712.194946,428.080414 C725.100098,430.169739 731.944641,439.074829 732.175659,453.896454 C732.328857,463.726379 732.212036,473.560547 732.215698,483.876190 z" }),
                  /* @__PURE__ */ c.jsx("path", { fill: Gl.primary, d: "M487.575867,485.935303 C487.614716,484.616028 487.614716,483.640503 487.614716,481.796417 C479.116760,488.238525 470.153107,489.257660 460.718079,486.787720 C454.401794,485.134186 449.163879,481.675842 445.200134,476.457642 C436.960876,465.610748 437.295532,448.722229 445.889771,438.315796 C455.451538,426.737823 470.295227,425.042450 488.444458,433.733826 C487.913239,428.612457 491.194366,428.604004 494.772766,428.684540 C508.272736,428.988373 506.179840,426.849945 506.294434,440.421967 C506.411133,454.245575 506.366882,468.071228 506.299957,481.895538 C506.205750,501.359833 494.742065,512.847900 475.259460,513.370544 C465.272614,513.638489 455.717651,512.255005 446.682343,507.725311 C443.034790,505.896667 441.336151,503.847290 444.229065,500.105438 C444.329590,499.975464 444.390869,499.814941 444.469086,499.667908 C448.861603,491.411743 448.894196,491.340729 457.207886,495.157196 C463.352356,497.977905 469.817169,498.376801 476.285126,497.456818 C482.543640,496.566620 486.238434,492.476532 487.575867,485.935303 M469.264740,471.577881 C471.084900,471.642700 472.915710,471.865356 474.723328,471.743805 C481.074341,471.316620 486.258820,466.628052 487.489288,460.346558 C488.669373,454.322296 485.713593,448.118378 480.288971,445.234039 C472.426056,441.053253 462.868591,443.867035 459.399658,451.384033 C455.705688,459.388580 459.382996,467.492737 469.264740,471.577881 z" }),
                  /* @__PURE__ */ c.jsx("path", { fill: Gl.primary, d: "M350.790619,410.644409 C354.007477,410.561554 355.147522,411.945587 355.144592,414.620361 C355.128937,428.846375 356.152588,426.165161 344.558044,426.338898 C335.900940,426.468628 327.237854,426.493591 318.582581,426.315826 C314.804382,426.238220 313.157715,427.376373 313.262451,431.424896 C313.571655,443.375275 312.019470,441.570435 323.204529,441.691742 C330.530579,441.771271 337.860626,441.831665 345.183899,441.671692 C348.853607,441.591553 350.203705,443.056824 350.190338,446.675842 C350.143219,459.433014 350.725433,457.207275 340.024445,457.368561 C332.865692,457.476471 325.700195,457.536346 318.545349,457.339996 C314.731018,457.235291 313.250702,458.478516 313.234222,462.478668 C313.185364,474.308960 313.038177,474.321259 324.813477,474.130890 C334.298523,473.977539 343.772430,475.169159 353.264343,474.338776 C354.864075,474.198792 356.466827,474.576569 356.702301,476.439850 C357.203217,480.403656 357.364838,484.405273 356.646729,488.365631 C356.297211,490.293060 354.652405,490.369568 353.118927,490.370575 C334.801880,490.382568 316.484711,490.350647 298.167847,490.412506 C295.104187,490.422852 294.024323,488.921082 294.024200,486.130402 C294.023224,462.484924 294.047699,438.839325 293.967896,415.194092 C293.954620,411.261261 296.028046,410.593658 299.359711,410.610138 C316.344330,410.694275 333.329620,410.638672 350.790619,410.644409 z" }),
                  /* @__PURE__ */ c.jsx("path", { fill: Gl.primary, d: "M620.003906,453.402435 C620.062195,464.023071 619.882812,474.188721 620.189575,484.339661 C620.338318,489.262421 618.431458,490.973572 613.757507,490.452362 C611.783386,490.232208 609.754700,490.291412 607.767883,490.444916 C604.889648,490.667267 602.478821,490.168823 601.296570,486.513000 C594.831909,490.991821 587.888184,491.843719 580.600464,491.328247 C565.916626,490.289642 557.201233,476.053131 563.502625,463.374390 C565.502930,459.349640 568.872803,457.136932 572.794861,455.506927 C578.118103,453.294647 583.702881,452.709900 589.425354,452.731232 C592.879822,452.744110 596.387085,453.235260 599.791443,452.317169 C599.855774,446.843750 597.260681,443.903503 591.552673,443.177338 C585.446533,442.400513 579.495911,443.228607 574.179382,446.386688 C570.948853,448.305603 569.535645,447.214966 568.011658,444.340485 C563.043945,434.970917 563.058899,434.663818 573.199219,430.800537 C582.143921,427.392792 591.347961,426.734100 600.678101,428.904358 C613.358643,431.853943 619.173157,440.405762 620.003906,453.402435 M582.869263,466.083313 C579.496887,469.605530 579.013306,473.431427 581.947998,475.906952 C585.513611,478.914764 589.714966,478.291107 593.721985,477.031647 C597.412354,475.871704 599.990784,473.365112 600.658081,469.369629 C601.070496,466.900665 600.409729,465.044220 597.411255,465.098297 C592.800171,465.181488 588.157471,464.530182 582.869263,466.083313 z" }),
                  /* @__PURE__ */ c.jsx("path", { fill: Gl.primary, d: "M410.915314,457.280090 C410.311127,447.930115 406.925934,444.198608 399.452026,444.194855 C391.667114,444.190948 386.727997,448.953094 386.409271,457.536652 C386.075653,466.521088 386.068634,475.532593 386.350006,484.518738 C386.494904,489.147247 384.896912,490.532959 380.337830,490.481964 C367.440552,490.337616 367.627808,490.513641 367.533173,477.713593 C367.426025,463.226135 368.160004,448.728760 367.168365,434.251617 C366.898468,430.311462 368.239288,428.249725 372.529694,428.668640 C374.840057,428.894196 377.203857,428.868896 379.519684,428.673553 C383.194244,428.363556 385.817352,429.188293 385.487488,434.182526 C390.858826,430.844635 395.856995,428.304504 401.601257,427.794434 C418.292908,426.312286 429.386810,436.518799 429.975342,454.379517 C430.315308,464.696716 429.971527,475.035126 430.046204,485.363190 C430.071198,488.817627 428.985992,490.534210 425.145325,490.442291 C408.307220,490.039520 411.204895,492.848450 410.942963,476.734924 C410.840088,470.406036 410.927368,464.074036 410.915314,457.280090 z" }),
                  /* @__PURE__ */ c.jsx("path", { fill: Gl.primary, d: "M556.799500,444.921539 C554.214233,445.227783 552.026184,445.174683 549.913574,445.548401 C542.544189,446.852142 538.560974,452.210632 538.387756,461.266998 C538.231995,469.411011 538.239258,477.561676 538.377136,485.705963 C538.433838,489.055634 537.355591,490.537964 533.812988,490.447296 C516.656677,490.008148 519.942505,492.939087 519.712585,476.823181 C519.510925,462.693848 519.801025,448.557343 519.590698,434.428253 C519.527222,430.165985 520.732788,428.169983 525.216187,428.665833 C527.350830,428.901917 529.549255,428.854156 531.692566,428.654297 C535.487610,428.300446 537.940002,429.350586 537.432373,434.447845 C542.475464,431.817810 546.689819,428.862549 551.859985,428.147003 C557.409912,427.378845 558.504028,428.019318 558.285950,433.612213 C558.141113,437.327057 559.514648,441.236115 556.799500,444.921539 z" })
                ] })
              ] })
            }
          ) }),
          /* @__PURE__ */ c.jsx("p", { className: "mt-6 md:mt-8 text-white/30 text-xs md:text-sm tracking-widest uppercase", children: "Where memories leave their trace" })
        ] })
      ]
    }
  );
}, Gm = ({ title: e, breadcrumbs: t = [], subtitle: n, actions: r, className: i = "" }) => /* @__PURE__ */ c.jsxs("div", { className: `mb-8 px-4 md:px-0 flex justify-between items-start animate-in fade-in slide-in-from-bottom-2 duration-500 ${i}`, children: [
  /* @__PURE__ */ c.jsxs("div", { children: [
    /* @__PURE__ */ c.jsxs("h1", { className: "text-3xl font-light tracking-tight text-foreground flex items-center gap-2", children: [
      t.map((s, a) => /* @__PURE__ */ c.jsxs(wd.Fragment, { children: [
        /* @__PURE__ */ c.jsx("span", { className: "text-muted-foreground/60 hover:text-foreground/80 transition-colors text-xl", children: s }),
        /* @__PURE__ */ c.jsx(nc, { size: 20, className: "text-muted-foreground/30 px-0.5" })
      ] }, a)),
      /* @__PURE__ */ c.jsx("span", { className: "drop-shadow-[0_0_15px_rgba(255,255,255,0.2)] text-foreground", children: e })
    ] }),
    n && /* @__PURE__ */ c.jsx("p", { className: "mt-2 text-muted-foreground text-sm font-light", children: n })
  ] }),
  r && /* @__PURE__ */ c.jsx("div", { className: "flex gap-2", children: r })
] }), gi = ({
  checked: e,
  onChange: t,
  disabled: n = !1,
  className: r = "",
  id: i
}) => {
  const s = (a) => {
    n || (a.stopPropagation(), t(!e));
  };
  return /* @__PURE__ */ c.jsx(
    "button",
    {
      type: "button",
      role: "switch",
      id: i,
      "aria-checked": e,
      onClick: s,
      disabled: n,
      className: `
                relative inline-flex h-3.5 w-9 shrink-0 cursor-pointer items-center rounded-full border
                transition-all duration-[var(--duration-normal)] ease-[var(--ease-out)]
                focus:outline-none active:scale-95
                ${e ? "bg-primary/20 border-primary/50 shadow-[0_0_10px_rgba(var(--primary),0.2)]" : "bg-black/20 border-border shadow-inner"}
                ${n ? "opacity-50 cursor-not-allowed" : ""}
                ${r}
            `,
      children: /* @__PURE__ */ c.jsx(
        "span",
        {
          className: `
                    pointer-events-none inline-block h-2.5 w-2.5 transform rounded-full shadow-sm ring-0
                    transition-all duration-[var(--duration-normal)] ease-[var(--ease-spring)]
                    ${e ? "bg-primary shadow-[0_0_8px_rgba(var(--primary),0.8)] border border-primary-foreground/20" : "bg-muted-foreground border border-transparent opacity-60"}
                `,
          style: { transform: e ? "translateX(24px)" : "translateX(2px)" }
        }
      )
    }
  );
}, Cne = {
  none: "",
  sm: "my-2",
  md: "my-4",
  lg: "my-6"
}, Br = ({
  orientation: e = "horizontal",
  length: t = 100,
  className: n = "",
  responsive: r = !1,
  spacing: i = "none"
}) => {
  const s = Cne[i];
  return r ? /* @__PURE__ */ c.jsxs(c.Fragment, { children: [
    /* @__PURE__ */ c.jsx(
      "div",
      {
        className: `hidden lg:block absolute left-0 top-1/2 -translate-y-1/2 border-l border-border ${n}`,
        style: { height: `${t}%` }
      }
    ),
    /* @__PURE__ */ c.jsx(
      "div",
      {
        className: `lg:hidden border-t border-border/30 mx-auto ${s} ${n}`,
        style: { width: `${t}%` }
      }
    )
  ] }) : e === "vertical" ? /* @__PURE__ */ c.jsx(
    "div",
    {
      className: `border-l border-border/30 mx-auto ${n}`,
      style: { height: `${t}%` }
    }
  ) : /* @__PURE__ */ c.jsx(
    "div",
    {
      className: `border-t border-border/30 ${s} ${n}`,
      style: { width: `${t}%` }
    }
  );
};
var WI = /* @__PURE__ */ ((e) => (e.Character = "char", e.Location = "loc", e.Item = "item", e.Concept = "concept", e.Unknown = "unknown", e))(WI || {});
const U0 = {
  chatId: "",
  last_summarized_floor: 0,
  token_usage_accumulated: 0,
  last_compressed_at: 0,
  active_summary_order: 9e3,
  last_extracted_floor: 0,
  lastModified: 0
}, d_ = "scope_state", GN = "character_name", h1 = "ChatManager";
class kne {
  constructor() {
    lt(this, "currentChatId", null);
    lt(this, "currentDb", null);
  }
  /**
   * 
   *  chat_id 
   */
  getCurrentDb() {
    const t = xi();
    return t ? (t !== this.currentChatId && (this.currentChatId = t, this.currentDb = Jo(t), ee.debug(h1, `: Engram_${t}`)), this.currentDb) : (ee.warn(h1, " chat_id"), null);
  }
  /**
   *  chatId
   */
  getCurrentChatId() {
    return xi();
  }
  /**
   * 
   */
  getCharacterName() {
    var t;
    return ((t = Qb()) == null ? void 0 : t.name) || "Unknown";
  }
  /**
   * 
   */
  async getState() {
    const t = this.getCurrentDb();
    if (!t) return U0;
    try {
      const n = await t.meta.get(d_);
      return n != null && n.value ? { ...U0, ...n.value } : U0;
    } catch (n) {
      return ee.error(h1, ":", n), U0;
    }
  }
  /**
   * 
   */
  async updateState(t) {
    const n = this.getCurrentDb();
    if (n)
      try {
        const i = { ...await this.getState(), ...t };
        await n.meta.put({ key: d_, value: i });
      } catch (r) {
        ee.error(h1, ":", r);
      }
  }
  /**
   *  UI 
   */
  async saveCharacterName() {
    const t = this.getCurrentDb();
    if (!t) return;
    const n = this.getCharacterName();
    await t.meta.put({ key: GN, value: n });
  }
  /**
   * 
   */
  async getSavedCharacterName() {
    const t = this.getCurrentDb();
    if (!t) return "Unknown";
    const n = await t.meta.get(GN);
    return (n == null ? void 0 : n.value) || "Unknown";
  }
  /**
   * 
   */
  async resetState() {
    const t = this.getCurrentDb();
    t && await t.meta.put({ key: d_, value: U0 });
  }
}
const vm = new kne(), B3 = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  chatManager: vm
}, Symbol.toStringTag, { value: "Module" }));
function Bi() {
  const e = xi();
  return e ? Jo(e) : null;
}
function f_() {
  const e = xi();
  return e ? vd(e) : null;
}
const vi = zz((e, t) => ({
  currentChatId: null,
  lastSummarizedFloor: 0,
  isProcessing: !1,
  recentEvents: [],
  // V0.6 
  currentScope: null,
  resolveScope: async (n, r) => {
    e({ currentChatId: n, currentScope: { id: 1 } });
    const i = await vm.getState();
    return e({ lastSummarizedFloor: i.last_summarized_floor }), { id: 1 };
  },
  initChat: async () => {
    const n = xi();
    if (!n)
      return console.warn("[MemoryStore] No chat_id available"), null;
    if (n !== t().currentChatId) {
      console.debug(`[MemoryStore] Switching to chat: ${n}`);
      const r = await vm.getState();
      e({
        currentChatId: n,
        currentScope: { id: 1 },
        // 
        lastSummarizedFloor: r.last_summarized_floor,
        recentEvents: []
      });
    }
    return Jo(n);
  },
  saveEvent: async (n) => {
    const r = Bi();
    if (!r)
      throw new Error("[MemoryStore] No current chat");
    const i = {
      ...n,
      id: Yo(),
      timestamp: Date.now(),
      is_embedded: n.is_embedded ?? !1,
      // V0.7: 
      is_archived: n.is_archived ?? !1
      // V0.7: 
    };
    return await r.events.add(i), e((s) => ({
      recentEvents: [...s.recentEvents, i].slice(-10)
    })), i;
  },
  saveEvents: async (n) => {
    const r = Bi();
    if (!r)
      throw new Error("[MemoryStore] No current chat");
    if (n.length === 0) return [];
    const i = n.map((s) => ({
      ...s,
      id: Yo(),
      timestamp: Date.now(),
      is_embedded: s.is_embedded ?? !1,
      is_archived: s.is_archived ?? !1
    }));
    return await r.events.bulkAdd(i), e((s) => ({
      recentEvents: [...s.recentEvents, ...i].slice(-10)
    })), i;
  },
  getEventSummaries: async (n) => {
    const r = f_();
    if (!r) return "";
    try {
      const i = await r.events.toArray();
      if (i.length === 0) return "";
      const s = n ? new Set(n) : null, a = i.filter((b) => b.level >= 1), u = i.filter((b) => b.level === 0 && !b.is_archived), d = i.filter(
        (b) => b.level === 0 && b.is_archived && (s == null ? void 0 : s.has(b.id))
      ), f = (b, w) => {
        var N, M, P, D;
        const S = ((N = b.source_range) == null ? void 0 : N.start_index) ?? 0, C = ((M = w.source_range) == null ? void 0 : M.start_index) ?? 0;
        if (S !== C) return S - C;
        const T = ((P = b.source_range) == null ? void 0 : P.end_index) ?? 0, R = ((D = w.source_range) == null ? void 0 : D.end_index) ?? 0;
        return T !== R ? T - R : b.timestamp - w.timestamp;
      };
      a.sort(f), u.sort(f), d.sort(f);
      const h = [], m = (b, w) => {
        var N, M, P, D;
        const S = ((N = b.source_range) == null ? void 0 : N.start_index) ?? 0, C = ((M = b.source_range) == null ? void 0 : M.end_index) ?? 0, T = ((P = w.source_range) == null ? void 0 : P.start_index) ?? 0, R = ((D = w.source_range) == null ? void 0 : D.end_index) ?? 0;
        return S >= T && C <= R;
      }, x = /* @__PURE__ */ new Set();
      for (const b of a) {
        h.push(b.summary);
        for (const w of d)
          m(w, b) && !x.has(w.id) && (h.push(`  () ${w.summary}`), x.add(w.id));
      }
      for (const b of d)
        x.has(b.id) || (h.push(`() ${b.summary}`), x.add(b.id));
      for (const b of u)
        h.push(b.summary);
      return h.length === 0 ? "" : `<summary>
${h.join(`

`)}
</summary>`;
    } catch (i) {
      return console.error("[MemoryStore] Failed to get event summaries:", i), "";
    }
  },
  countEventTokens: async () => {
    const n = Bi();
    if (!n) return { totalTokens: 0, eventCount: 0, activeEventCount: 0 };
    try {
      const r = await n.events.toArray();
      if (r.length === 0) return { totalTokens: 0, eventCount: 0, activeEventCount: 0 };
      const i = r.filter((u) => !u.is_archived), s = i.map((u) => u.summary).join(`

`);
      return {
        totalTokens: await Ba.countTokens(s),
        eventCount: r.length,
        activeEventCount: i.length
        // 
      };
    } catch (r) {
      return console.error("[MemoryStore] Failed to count event tokens:", r), { totalTokens: 0, eventCount: 0, activeEventCount: 0 };
    }
  },
  setLastSummarizedFloor: async (n) => {
    await vm.updateState({ last_summarized_floor: n }), e({ lastSummarizedFloor: n });
  },
  setProcessing: (n) => e({ isProcessing: n }),
  reset: () => e({
    currentChatId: null,
    currentScope: null,
    lastSummarizedFloor: 0,
    isProcessing: !1,
    recentEvents: []
  }),
  // ==================== Trim  ====================
  /**
   * 
   */
  archiveEvents: async (n) => {
    if (n.length === 0) return;
    const r = Bi();
    if (r)
      try {
        await r.events.where("id").anyOf(n).modify({ is_archived: !0 }), console.log(`[MemoryStore] Archived ${n.length} events`);
      } catch (i) {
        console.error("[MemoryStore] Failed to archive events:", i);
      }
  },
  /**
   * 
   */
  markEventsAsEmbedded: async (n) => {
    if (n.length === 0) return;
    const r = Bi();
    if (r)
      try {
        await r.events.where("id").anyOf(n).modify({ is_embedded: !0 }), console.log(`[MemoryStore] Marked ${n.length} events as embedded`);
      } catch (i) {
        console.error("[MemoryStore] Failed to mark events as embedded:", i);
      }
  },
  getEventsToMerge: async (n = 3) => {
    const r = Bi();
    if (!r) return [];
    try {
      const s = (await r.events.orderBy("timestamp").toArray()).filter((a) => a.level === 0 && !a.is_archived);
      return s.length <= n ? [] : s.slice(0, s.length - n);
    } catch (i) {
      return console.error("[MemoryStore] Failed to get events to merge:", i), [];
    }
  },
  deleteEvents: async (n) => {
    if (n.length === 0) return;
    const r = Bi();
    if (r)
      try {
        await r.events.bulkDelete(n), console.log(`[MemoryStore] Deleted ${n.length} events`);
      } catch (i) {
        throw console.error("[MemoryStore] Failed to delete events:", i), i;
      }
  },
  /**
   * 
   */
  updateEvent: async (n, r) => {
    if (!n) return;
    const i = Bi();
    if (i)
      try {
        const { id: s, timestamp: a, ...u } = r;
        await i.events.update(n, u), console.log(`[MemoryStore] Updated event: ${n}`, u);
      } catch (s) {
        throw console.error("[MemoryStore] Failed to update event:", s), s;
      }
  },
  getAllEvents: async () => {
    const n = Bi();
    if (!n) return [];
    try {
      return await n.events.orderBy("timestamp").toArray();
    } catch (r) {
      return console.error("[MemoryStore] Failed to get all events:", r), [];
    }
  },
  // ==================== V0.9  ====================
  getAllEntities: async () => {
    const n = Bi();
    if (!n) return [];
    try {
      return await n.entities.toArray();
    } catch (r) {
      return console.error("[MemoryStore] Failed to get all entities:", r), [];
    }
  },
  saveEntity: async (n) => {
    const r = Bi();
    if (!r)
      throw new Error("[MemoryStore] No current chat");
    const i = {
      ...n,
      id: Yo(),
      last_updated_at: Date.now(),
      aliases: n.aliases || [],
      profile: n.profile || {}
    };
    return await r.entities.add(i), console.log(`[MemoryStore] Saved entity: ${i.name}`), i;
  },
  saveEntities: async (n) => {
    const r = Bi();
    if (!r)
      throw new Error("[MemoryStore] No current chat");
    if (n.length === 0) return [];
    const i = n.map((s) => ({
      ...s,
      id: Yo(),
      last_updated_at: Date.now(),
      aliases: s.aliases || [],
      profile: s.profile || {}
    }));
    return await r.entities.bulkAdd(i), console.log(`[MemoryStore] Bulk saved ${i.length} entities`), i;
  },
  updateEntity: async (n, r) => {
    if (!n) return;
    const i = Bi();
    if (i)
      try {
        const { id: s, ...a } = r;
        await i.entities.update(n, {
          ...a,
          last_updated_at: Date.now()
        }), console.log(`[MemoryStore] Updated entity: ${n}`);
      } catch (s) {
        throw console.error("[MemoryStore] Failed to update entity:", s), s;
      }
  },
  deleteEntity: async (n) => {
    if (!n) return;
    const r = Bi();
    if (r)
      try {
        await r.entities.bulkDelete([n]), console.log(`[MemoryStore] Deleted entity: ${n}`);
      } catch (i) {
        throw console.error("[MemoryStore] Failed to delete entity:", i), i;
      }
  },
  /**
   * 
   */
  deleteEntities: async (n) => {
    if (n.length === 0) return;
    const r = Bi();
    if (r)
      try {
        await r.entities.bulkDelete(n), console.log(`[MemoryStore] Deleted ${n.length} entities`);
      } catch (i) {
        throw console.error("[MemoryStore] Failed to delete entities:", i), i;
      }
  },
  findEntityByName: async (n) => {
    const r = Bi();
    if (!r) return null;
    try {
      const i = await r.entities.where("name").equals(n).first();
      return i || await r.entities.where("aliases").equals(n).first() || null;
    } catch (i) {
      return console.error("[MemoryStore] Failed to find entity by name:", i), null;
    }
  },
  /**
   * V0.9.2:  ()
   *  is_archived=true 
   */
  getArchivedEventSummaries: async () => {
    const n = f_();
    if (!n) return "";
    try {
      const i = (await n.events.toArray()).filter((a) => a.is_archived === !0);
      return i.length === 0 ? "" : (i.sort((a, u) => {
        var h, m;
        const d = ((h = a.source_range) == null ? void 0 : h.start_index) ?? 0, f = ((m = u.source_range) == null ? void 0 : m.start_index) ?? 0;
        return d !== f ? d - f : a.timestamp - u.timestamp;
      }), `<archived_summary>
${i.map((a) => a.summary).join(`

`)}
</archived_summary>`);
    } catch (r) {
      return console.error("[MemoryStore] Failed to get archived event summaries:", r), "";
    }
  },
  /**
   * V1.0.0:  ( XML )
   *  EntityType  XML 
   */
  getEntityStates: async () => {
    const n = f_();
    if (!n) return "";
    try {
      const r = await n.entities.toArray();
      if (r.length === 0) return "";
      const i = {
        char: [],
        loc: [],
        item: [],
        concept: [],
        unknown: []
      };
      for (const u of r) {
        const d = u.type || "unknown";
        i[d] ? i[d].push(u) : i.unknown.push(u);
      }
      const s = {
        char: "character_state",
        loc: "scene_state",
        item: "item_state",
        concept: "concept_state",
        unknown: "entity_state"
      }, a = [];
      for (const [u, d] of Object.entries(i)) {
        if (d.length === 0) continue;
        const f = s[u], h = d.map((m) => m.description || `# ${m.name}
()`).join(`

`);
        a.push(`<${f}>
${h}
</${f}>`);
      }
      return a.join(`

`);
    } catch (r) {
      return console.error("[MemoryStore] Failed to get entity states:", r), "";
    }
  },
  // ====================  ====================
  clearChatDatabase: async () => {
    const n = Bi();
    if (n)
      try {
        await n.transaction("rw", n.events, n.entities, n.meta, async () => {
          await n.events.clear(), await n.entities.clear(), await n.meta.clear();
        }), e({
          lastSummarizedFloor: 0,
          recentEvents: []
        }), console.info("[MemoryStore] Database cleared successfully");
      } catch (r) {
        throw console.error("[MemoryStore] Failed to clear database:", r), r;
      }
  },
  deleteChatDatabase: async () => {
    const n = t().currentChatId;
    if (n)
      try {
        await HP(n), t().reset(), console.info("[MemoryStore] Database deleted successfully");
      } catch (r) {
        throw console.error("[MemoryStore] Failed to delete database:", r), r;
      }
  }
})), ZI = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  useMemoryStore: vi
}, Symbol.toStringTag, { value: "Module" })), Tne = {
  enabled: !0,
  triggerMode: "auto",
  floorInterval: 25,
  // V0.9.5: 20-30 
  worldbookMode: "chat",
  previewEnabled: !0,
  promptTemplateId: null,
  llmPresetId: null,
  bufferSize: 10,
  // V0.9.5:  10 
  autoHide: !1
}, Xp = "engram";
function KN() {
  var e, t;
  try {
    const n = (t = (e = window.SillyTavern) == null ? void 0 : e.getContext) == null ? void 0 : t.call(e);
    return n != null && n.chat_metadata ? n.chat_metadata : window.chat_metadata || null;
  } catch {
    return null;
  }
}
function jne() {
  var e;
  try {
    (e = window.saveChatDebounced) == null || e.call(window);
  } catch {
    console.warn("[Engram] saveChatDebounced ");
  }
}
class Ane {
  constructor(t) {
    lt(this, "config");
    lt(this, "currentChatId", null);
    lt(this, "isRunning", !1);
    lt(this, "isSummarizing", !1);
    lt(this, "cancelRequested", !1);
    // 
    lt(this, "unsubscribeMessage", null);
    lt(this, "unsubscribeChat", null);
    lt(this, "summaryHistory", []);
    // 
    lt(this, "_lastSummarizedFloor", 0);
    const n = it.get("summarizerConfig");
    this.config = { ...Tne, ...n, ...t };
  }
  // ====================  ====================
  // getInfoFromChatMetadata  saveToChatMetadata 
  //  WorldBookStateService
  /**
   * 
   */
  getFromChatMetadata(t) {
    const n = KN();
    if (n)
      return n.extensions || (n.extensions = {}), n.extensions[Xp] || (n.extensions[Xp] = {}), n.extensions[Xp][t];
  }
  /**
   * 
   */
  saveToChatMetadata(t, n) {
    const r = KN();
    r && (r.extensions || (r.extensions = {}), r.extensions[Xp] || (r.extensions[Xp] = {}), r.extensions[Xp][t] = n, this.log("debug", ` chat_metadata: ${t} = ${n}`), jne());
  }
  /**
   * 
   * V0.5:  memoryStore 
   * V0.8:  chatManager.getState() 
   */
  async getLastSummarizedFloor() {
    if (this._lastSummarizedFloor > 0) return this._lastSummarizedFloor;
    try {
      const { chatManager: t } = await Promise.resolve().then(() => B3), n = await t.getState();
      return this._lastSummarizedFloor = n.last_summarized_floor, this.log("debug", " DB  lastSummarizedFloor", { value: this._lastSummarizedFloor }), this._lastSummarizedFloor;
    } catch (t) {
      return this.log("warn", " lastSummarizedFloor  0", t), 0;
    }
  }
  /**
   * 
   * V0.5:  memoryStore (IndexedDB)
   */
  async setLastSummarizedFloor(t) {
    this._lastSummarizedFloor = t, await vi.getState().setLastSummarizedFloor(t);
  }
  // ====================  ====================
  /**
   * 
   */
  getCurrentFloor() {
    var n, r;
    const t = (r = (n = window.SillyTavern) == null ? void 0 : n.getContext) == null ? void 0 : r.call(n);
    return t != null && t.chat ? t.chat.length : 0;
  }
  /**
   *  ID
   */
  getCurrentChatId() {
    var n, r;
    const t = (r = (n = window.SillyTavern) == null ? void 0 : n.getContext) == null ? void 0 : r.call(n);
    return (t == null ? void 0 : t.chatId) || null;
  }
  // ====================  ====================
  /**
   * 
   * V0.5:  EventWatcher 
   */
  start() {
    if (this.isRunning) {
      this.log("warn", "");
      return;
    }
    this.initializeForCurrentChat(), U2.start(), this.unsubscribeMessage = U2.on(
      "onMessageReceived",
      this.handleMessageReceived.bind(this)
    ), this.log("debug", " EventWatcher "), this.unsubscribeChat = U2.on(
      "onChatChanged",
      this.handleChatChanged.bind(this)
    ), this.log("debug", " EventWatcher "), this.isRunning = !0;
    const t = this.getStatus();
    this.log("info", "", t);
  }
  /**
   *  ( 0)
   */
  async resetProgress() {
    await this.setLastSummarizedFloor(0), this.log("info", "");
  }
  /**
   * 
   */
  stop() {
    this.unsubscribeMessage && (this.unsubscribeMessage(), this.unsubscribeMessage = null), this.unsubscribeChat && (this.unsubscribeChat(), this.unsubscribeChat = null), this.isRunning = !1, this.log("info", "");
  }
  /**
   * 
   */
  async initializeForCurrentChat() {
    const t = this.getCurrentChatId(), n = this.getCurrentFloor();
    this.currentChatId = t, this.summaryHistory = [], this._lastSummarizedFloor = 0;
    const r = await this.getLastSummarizedFloor();
    this.log("info", "", {
      chatId: t,
      currentFloor: n,
      lastSummarizedFloor: r,
      pendingFloors: n - r
    });
  }
  // ====================  ====================
  /**
   * 
   * V0.9.1:  Summary 
   */
  async handleMessageReceived() {
    const t = this.getCurrentFloor(), n = await this.getLastSummarizedFloor(), r = t - n;
    this.log("debug", "", {
      currentFloor: t,
      lastSummarized: n,
      pendingFloors: r,
      triggerAt: this.config.floorInterval
    }), await this.checkEntityExtraction(t), r >= this.config.floorInterval && (this.log("info", "", {
      pendingFloors: r,
      interval: this.config.floorInterval
    }), await this.triggerSummary());
  }
  /**
   * V0.9.1: 
   *  Summary 
   */
  async checkEntityExtraction(t) {
    try {
      const { entityBuilder: n } = await Promise.resolve().then(() => rle), { chatManager: r } = await Promise.resolve().then(() => B3);
      if (n.shouldTriggerOnFloor(t)) {
        this.log("info", "", { floor: t });
        const u = [((await r.getState()).last_extracted_floor || 0) + 1, t];
        this.log("debug", "", { range: u }), n.extractByRange(u, !1).catch((d) => {
          this.log("warn", "", { error: d });
        });
      }
    } catch (n) {
      this.log("warn", "", { error: n });
    }
  }
  /**
   * 
   */
  handleChatChanged() {
    const t = this.getCurrentChatId();
    this.log("info", "", {
      from: this.currentChatId,
      to: t
    }), this.initializeForCurrentChat();
  }
  // ====================  ====================
  /**
   * /
   */
  async triggerSummary(t = !1) {
    if (this.isSummarizing)
      return this.log("warn", ""), null;
    if (!this.config.enabled && !t)
      return this.log("debug", ""), null;
    const n = this.getCurrentFloor();
    await this.getLastSummarizedFloor(), this.isSummarizing = !0, this.cancelRequested = !1;
    const r = xn.running("...", "Engram", () => {
      this.cancelRequested = !0, this.log("info", ""), xn.warning("...", "Engram");
    });
    try {
      const i = this._lastSummarizedFloor + 1, s = this.config.bufferSize || 0, a = n - s;
      if (i > a)
        return t && xn.info(" ()", "Engram"), null;
      const u = this.config.floorInterval || 10, d = i + u - 1, f = Math.min(a, d);
      if (i > f) return null;
      const h = [i, f];
      this.log("info", "", { range: h });
      const { WorkflowEngine: m } = await Promise.resolve().then(() => cw), { createSummaryWorkflow: x } = await Promise.resolve().then(() => ale), { WorldBookSlotService: b } = await Promise.resolve().then(() => Hz);
      await b.init();
      const w = await m.run(x(), {
        trigger: t ? "manual" : "auto",
        config: {
          previewEnabled: this.config.previewEnabled,
          autoHide: this.config.autoHide,
          templateId: this.config.promptTemplateId,
          logType: "summarize"
        },
        input: {
          range: h
        }
      }), S = w.output, C = {
        id: Date.now().toString(),
        content: w.cleanedContent || "",
        // The raw text
        sourceFloors: h,
        timestamp: Date.now(),
        tokenCount: 0,
        // TODO: Get from context or re-measure
        writtenToWorldbook: !0
      };
      return this._lastSummarizedFloor = f, this.summaryHistory.push(C), C;
    } catch (i) {
      const s = i instanceof Error ? i.message : String(i);
      return s === "UserCancelled" ? (this.log("info", ""), null) : (this.log("error", "", { error: s }), xn.error(`: ${s}`, "Engram "), null);
    } finally {
      xn.remove(r), this.isSummarizing = !1;
    }
  }
  // ====================  ====================
  /**
   * 
   */
  getStatus() {
    const t = this.getCurrentFloor(), n = this._lastSummarizedFloor;
    return {
      running: this.isRunning,
      currentFloor: t,
      lastSummarizedFloor: n,
      pendingFloors: Math.max(0, t - n),
      historyCount: this.summaryHistory.length,
      isSummarizing: this.isSummarizing
    };
  }
  /**
   * 
   */
  refreshStatus() {
    return this.initializeForCurrentChat(), this.getStatus();
  }
  /**
   * 
   */
  getConfig() {
    return { ...this.config };
  }
  /**
   * 
   */
  updateConfig(t) {
    this.config = { ...this.config, ...t }, it.set("summarizerConfig", this.config), this.log("debug", "", this.config);
  }
  /**
   * 
   */
  getHistory() {
    return [...this.summaryHistory];
  }
  /**
   * 
   */
  async resetBaseFloor() {
    const t = this.getCurrentFloor();
    await this.setLastSummarizedFloor(t), this.log("info", "", { currentFloor: t });
  }
  // ====================  ====================
  /**
   * 
   */
  async log(t, n, r) {
    try {
      const { Logger: i } = await Promise.resolve().then(() => tT);
      i[t]("Summarizer", n, r);
    } catch {
      console.log(`[Summarizer] ${t}: ${n}`, r);
    }
  }
}
const Wo = new Ane(), Nne = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  summarizerService: Wo
}, Symbol.toStringTag, { value: "Module" })), Vo = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  summarizerService: Wo
}, Symbol.toStringTag, { value: "Module" }));
async function $3() {
  const { Logger: e } = await Promise.resolve().then(() => tT);
  await e.init(), e.info("STBridge", "Engram ...");
  const { SettingsManager: t } = await Promise.resolve().then(() => Xb);
  t.initSettings(), e.info("STBridge", "SettingsManager ");
  const n = t.getRegexRules();
  if (n && n.length > 0) {
    const { regexProcessor: i } = await Promise.resolve().then(() => $T);
    i.setRules(n), e.info("STBridge", ` ${n.length} `);
  }
  try {
    const { checkTavernIntegration: i } = await Promise.resolve().then(() => Vz), s = await i();
    e.info("TavernAPI", "", s);
  } catch (i) {
    e.warn("TavernAPI", "", { error: String(i) });
  }
  try {
    const { summarizerService: i } = await Promise.resolve().then(() => Nne);
    i.start();
    const s = i.getStatus();
    e.info("Summarizer", "", s);
  } catch (i) {
    e.warn("Summarizer", "", { error: String(i) });
  }
  Rne();
  const { ThemeManager: r } = await Promise.resolve().then(() => P1);
  r.init();
  try {
    const { injector: i } = await Promise.resolve().then(() => vre);
    i.init(), e.info("Injector", "");
  } catch (i) {
    e.warn("Injector", "", { error: String(i) });
  }
  try {
    const { MacroService: i } = await Promise.resolve().then(() => qT);
    await i.init();
  } catch (i) {
    e.warn("MacroService", "", { error: String(i) });
  }
  try {
    const { initQuickPanelButton: i } = await Promise.resolve().then(() => Jne);
    i(), e.info("QuickPanelButton", "QR ");
  } catch (i) {
    e.warn("QuickPanelButton", "QR ", { error: String(i) });
  }
  Mne();
  try {
    const { CharacterDeleteService: i } = await Promise.resolve().then(() => ole);
    i.init(), e.info("STBridge", "");
  } catch (i) {
    e.warn("STBridge", "", { error: String(i) });
  }
  try {
    const { setupKeyboardShortcuts: i } = await Promise.resolve().then(() => cle), { toggleQuickPanel: s, openCommandPalette: a } = await Promise.resolve().then(() => nL);
    i({
      toggleMainPanel: mb,
      toggleQuickPanel: s,
      openCommandPalette: a
    }), e.info("STBridge", "");
  } catch (i) {
    e.warn("STBridge", "", { error: String(i) });
  }
  e.success("STBridge", "Engram  - Where memories leave their trace.");
}
function Rne() {
  const e = document.querySelector("#top-settings-holder"), t = document.querySelector("#WI-SP-button");
  if (!e)
    return;
  const n = document.createElement("div");
  n.id = "engram-drawer", n.className = "drawer";
  const r = document.createElement("div");
  r.className = "drawer-toggle drawer-header";
  const i = document.createElement("div");
  i.id = "engram-drawer-icon", i.className = "drawer-icon fa-solid fa-e fa-fw closedIcon", i.title = "Engram - ", i.setAttribute("data-i18n", "[title]Engram - Memory OS"), i.addEventListener("click", mb), r.appendChild(i), n.appendChild(r), t ? e.insertBefore(n, t) : e.appendChild(n);
}
let pb = null;
function XI(e) {
  pb = e, pb = e;
}
let q3 = null, YN = null;
function QI(e) {
  q3 = e;
}
function Mne() {
  if (!q3)
    return;
  const e = "engram-global-overlay";
  let t = document.getElementById(e);
  t || (t = document.createElement("div"), t.id = e, t.className = "pointer-events-none fixed inset-0 z-[11000]", document.body.appendChild(t)), YN || (YN = q3(t, () => {
  }));
}
let h_ = !1, H0 = null, $1 = null;
function mb() {
  h_ && H0 ? ($1 && ($1.unmount(), $1 = null), H0.remove(), H0 = null, h_ = !1) : (H0 = One(), document.body.appendChild(H0), h_ = !0);
}
function One() {
  var t;
  const e = document.createElement("div");
  return e.className = "fixed inset-0 w-full h-full z-[10000] flex flex-col bg-background text-foreground overflow-hidden", e.style.backgroundColor = "var(--background)", e.style.color = "var(--foreground)", e.style.height = "100dvh", e.style.width = "100vw", e.style.top = "0", e.style.left = "0", e.id = "engram-panel-root", pb ? $1 = pb(e, mb) : (e.innerHTML = `
            <div class="flex items-center justify-between p-4 border-b border-slate-400/20">
                <h2 class="m-0 text-lg text-slate-200 flex items-center gap-2">Engram</h2>
                <button class="bg-transparent border-none text-slate-400 text-2xl cursor-pointer p-1 hover:text-slate-200">&times;</button>
            </div>
            <div class="flex-1 overflow-auto p-5">
                <p style="color: #94a3b8;">React </p>
            </div>
        `, (t = e.querySelector("button")) == null || t.addEventListener("click", mb)), e;
}
async function JI(e, t) {
  try {
    const r = await new Function("path", "return import(path)")("/scripts/chats.js");
    r && typeof r.hideChatMessageRange == "function" ? (await r.hideChatMessageRange(e, t, !1), console.log(`[Engram] Hidden messages range: ${e}-${t}`)) : console.warn("[Engram] hideChatMessageRange not found in chats.js");
  } catch (n) {
    console.error("[Engram] Failed to hide messages:", n);
  }
}
async function Dne(e, t, n) {
  var r;
  try {
    const i = ma();
    if (!i) throw new Error("ST Context unavailable");
    const s = n || (e === "user" ? i.name1 : i.name2), a = "/scripts/chats.js", u = "/script.js", d = await new Function("path", "return import(path)")(a), f = await new Function("path", "return import(path)")(u);
    if (!i.chat) throw new Error("Chat array unavailable");
    const h = {
      name: s,
      is_user: e === "user",
      is_system: !1,
      send_date: Date.now(),
      mes: t,
      // @ts-ignore
      force_avatar: e === "char" ? (r = f.characters[i.characterId]) == null ? void 0 : r.avatar : void 0
    };
    i.chat.push(h), f.saveChat && await f.saveChat(), f.reloadCurrentChat && await f.reloadCurrentChat();
    const { Logger: m } = await Promise.resolve().then(() => tT);
    m.info("STBridge", "", { role: e, length: t.length });
  } catch (i) {
    throw console.error("[Engram] Failed to inject message:", i), i;
  }
}
async function eL(e, t = "text", n = "") {
  return window.callPopup ? window.callPopup(e, t, n) : (console.warn("[Engram] callPopup not available"), Promise.resolve(t === "confirm" ? !0 : null));
}
const zne = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  callPopup: eL,
  getSTContext: ma,
  hideMessageRange: JI,
  initializeEngram: $3,
  injectMessage: Dne,
  setGlobalRenderer: QI,
  setReactRenderer: XI
}, Symbol.toStringTag, { value: "Module" })), F3 = [
  { value: "input", label: "", description: " LLM " },
  { value: "output", label: "", description: " LLM /" },
  { value: "both", label: "", description: "" }
], jy = [
  {
    id: "remove-think",
    name: "",
    pattern: "<think(?:\\s+[^>]*)?>[\\s\\S]*?<\\/think\\s*>",
    replacement: "",
    enabled: !0,
    flags: "gi",
    scope: "both",
    description: " LLM  <think>...</think> "
  },
  {
    id: "remove-headless-think",
    name: "",
    pattern: "[\\s\\S]*?<\\/think\\s*>",
    replacement: "",
    enabled: !0,
    flags: "gi",
    scope: "both",
    description: " </think> "
  },
  {
    id: "remove-update-variable",
    name: " UpdateVariable",
    pattern: "<UpdateVariable(?:\\s+[^>]*)?>[\\s\\S]*?<\\/UpdateVariable\\s*>",
    replacement: "",
    enabled: !0,
    flags: "gi",
    scope: "both",
    description: " MVU "
  },
  {
    id: "remove-status-placeholder",
    name: " StatusPlaceHolder",
    pattern: "<StatusPlaceHolderImpl(?:\\s+[^>]*)?\\s*\\/>",
    replacement: "",
    enabled: !0,
    flags: "gi",
    scope: "both",
    description: ""
  }
], Ay = {
  enabled: !1,
  templateId: "query_enhance",
  autoTrigger: !0,
  preview: !0
  // 
};
function Pne(e = 2e3) {
  const [t, n] = I.useState(!0), [r, i] = I.useState({
    isConnected: !1,
    characterName: "Unknown",
    currentFloor: 0,
    lastSummarizedFloor: 0,
    pendingFloors: 0,
    floorInterval: 10,
    isSummarizing: !1
  }), [s, a] = I.useState({
    eventCount: 0,
    entityCount: 0,
    entityByType: {},
    archivedCount: 0,
    activeCount: 0,
    estimatedTokens: 0
  }), [u, d] = I.useState({
    summarizer: !0,
    entity: !1,
    embedding: !1,
    recall: !0,
    preprocessing: !1
  }), [f, h] = I.useState({
    shortTermCount: 0,
    shortTermLimit: 0,
    workingCount: 0,
    workingLimit: 0,
    topItems: []
  }), [m, x] = I.useState({
    injectedLength: 0,
    estimatedTokens: 0
  }), b = vi((T) => T.getAllEvents), w = vi((T) => T.getAllEntities), S = I.useCallback(async () => {
    try {
      const T = ma(), R = Wo.getStatus(), N = it.get("summarizerConfig") || {};
      i({
        isConnected: !!T,
        characterName: (T == null ? void 0 : T.name2) || "Unknown",
        currentFloor: R.currentFloor,
        lastSummarizedFloor: R.lastSummarizedFloor,
        pendingFloors: R.pendingFloors,
        floorInterval: N.floorInterval || 10,
        isSummarizing: R.isSummarizing
      });
      const M = await b(), P = await w(), D = {};
      P.forEach((Z) => {
        D[Z.type] = (D[Z.type] || 0) + 1;
      });
      const q = M.filter((Z) => Z.is_archived), Y = M.reduce((Z, oe) => {
        var X;
        return Z + Math.ceil((((X = oe.summary) == null ? void 0 : X.length) || 0) / 4);
      }, 0);
      a({
        eventCount: M.length,
        entityCount: P.length,
        entityByType: D,
        archivedCount: q.length,
        activeCount: M.length - q.length,
        estimatedTokens: Y
      });
      const te = it.get("apiSettings"), V = te == null ? void 0 : te.entityExtractConfig, $ = te == null ? void 0 : te.embeddingConfig, G = te == null ? void 0 : te.recallConfig, le = it.get("preprocessingConfig");
      d({
        summarizer: N.enabled !== !1,
        entity: (V == null ? void 0 : V.enabled) || !1,
        embedding: ($ == null ? void 0 : $.enabled) || !1,
        recall: (G == null ? void 0 : G.enabled) !== !1,
        preprocessing: (le == null ? void 0 : le.enabled) || !1
      });
      try {
        const { brainRecallCache: Z } = await Promise.resolve().then(() => oL), { MacroService: oe } = await Promise.resolve().then(() => qT), X = Z.getShortTermSnapshot(), ce = Z.getConfig(), pe = X.filter((J) => J.tier === "working"), de = X.slice(0, 3).map((J) => ({
          id: J.id,
          label: J.label,
          score: J.finalScore
        })), H = oe.getSummaries();
        h({
          shortTermCount: X.length,
          shortTermLimit: ce.shortTermLimit,
          workingCount: pe.length,
          workingLimit: ce.workingLimit,
          topItems: de
        }), x({
          injectedLength: H.length,
          estimatedTokens: Math.ceil(H.length / 4)
        });
      } catch (Z) {
        console.warn("[useDashboardData] Failed to load brain stats", Z);
      }
      n(!1);
    } catch (T) {
      console.error("[useDashboardData] Error refreshing data:", T), n(!1);
    }
  }, [b, w]), C = I.useCallback((T) => {
    const R = it.get("apiSettings") || {}, N = it.get("summarizerConfig") || {};
    switch (T) {
      case "summarizer":
        const M = !u.summarizer;
        it.set("summarizerConfig", {
          ...N,
          enabled: M
        }), Wo.updateConfig({ enabled: M });
        break;
      case "entity":
        const P = (R == null ? void 0 : R.entityExtractConfig) || {};
        it.set("apiSettings", {
          ...R,
          entityExtractConfig: {
            ...P,
            enabled: !u.entity
          }
        });
        break;
      case "embedding":
        const D = (R == null ? void 0 : R.embeddingConfig) || {};
        it.set("apiSettings", {
          ...R,
          embeddingConfig: {
            ...D,
            enabled: !u.embedding
          }
        });
        break;
      case "recall":
        const q = (R == null ? void 0 : R.recallConfig) || {};
        it.set("apiSettings", {
          ...R,
          recallConfig: {
            ...q,
            enabled: !u.recall
          }
        });
        break;
      case "preprocessing":
        const Y = it.get("preprocessingConfig") || Ay, te = !u.preprocessing;
        it.set("preprocessingConfig", {
          ...Y,
          enabled: te
        }), Promise.resolve().then(() => kW).then(({ getDefaultAPISettings: V }) => {
          const G = it.get("apiSettings") || V(), le = G.recallConfig || {};
          it.set("apiSettings", {
            ...G,
            recallConfig: {
              ...le,
              usePreprocessing: te
            }
          });
        });
        break;
    }
    S();
  }, [u, S]);
  return I.useEffect(() => {
    S();
    const T = setInterval(S, e);
    return () => clearInterval(T);
  }, [S, e]), {
    system: r,
    memory: s,
    features: u,
    brainStats: f,
    contextStats: m,
    isLoading: t,
    toggleFeature: C,
    refresh: S
  };
}
const Ine = (e) => {
  switch (e) {
    case 0:
      return "text-muted-foreground";
    case 1:
      return "text-primary";
    case 2:
      return "text-green-400";
    case 3:
      return "text-yellow-400";
    case 4:
      return "text-red-400";
    default:
      return "text-primary";
  }
}, Lne = [
  { key: "summarizer", label: "", desc: "", icon: xh },
  { key: "entity", label: "", desc: "/", icon: kz },
  { key: "embedding", label: "", desc: "", icon: Ai },
  { key: "recall", label: "RAG ", desc: "", icon: Ai },
  { key: "preprocessing", label: "", desc: "Query /", icon: Nz }
], Bne = tb.filter((e) => e.id !== "dashboard"), WN = ({ onNavigate: e }) => {
  const [t, n] = I.useState([]), { system: r, memory: i, features: s, brainStats: a, contextStats: u, toggleFeature: d } = Pne(2e3);
  I.useEffect(() => (n(ee.getLogs().slice(0, 4)), ee.subscribe((b) => {
    n((w) => [b, ...w].slice(0, 4));
  })), []);
  const f = (x) => e == null ? void 0 : e(x), h = r.floorInterval > 0 ? Math.min(100, r.pendingFloors / r.floorInterval * 100) : 0, m = i.eventCount > 0 ? Math.round(i.archivedCount / i.eventCount * 100) : 0;
  return /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col h-full", children: [
    /* @__PURE__ */ c.jsx(
      Gm,
      {
        title: "",
        subtitle: "",
        className: "mb-6"
      }
    ),
    /* @__PURE__ */ c.jsx(Br, { className: "mb-6" }),
    /* @__PURE__ */ c.jsx("div", { className: "flex-1 overflow-y-auto no-scrollbar", children: /* @__PURE__ */ c.jsxs("div", { className: "grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12 engram-stagger-children", children: [
      /* @__PURE__ */ c.jsxs("section", { className: "space-y-8", children: [
        /* @__PURE__ */ c.jsxs("div", { children: [
          /* @__PURE__ */ c.jsx("h2", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider mb-4", children: "" }),
          /* @__PURE__ */ c.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
            /* @__PURE__ */ c.jsxs("div", { children: [
              /* @__PURE__ */ c.jsx("span", { className: "text-xs text-muted-foreground block mb-1", children: "" }),
              /* @__PURE__ */ c.jsxs("div", { className: `flex items-center gap-2 text-lg font-medium ${r.isConnected ? "text-green-500" : "text-muted-foreground"}`, children: [
                r.isConnected ? /* @__PURE__ */ c.jsx(qb, { size: 18 }) : /* @__PURE__ */ c.jsx(_d, { size: 18 }),
                r.isConnected ? r.characterName : ""
              ] })
            ] }),
            /* @__PURE__ */ c.jsxs("div", { children: [
              /* @__PURE__ */ c.jsx("span", { className: "text-xs text-muted-foreground block mb-1", children: "" }),
              /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2", children: [
                /* @__PURE__ */ c.jsx("span", { className: "text-3xl font-light text-amber-500 font-mono", children: r.pendingFloors }),
                /* @__PURE__ */ c.jsxs("span", { className: "text-muted-foreground", children: [
                  "/ ",
                  r.floorInterval
                ] }),
                r.isSummarizing && /* @__PURE__ */ c.jsx(rc, { size: 14, className: "animate-spin text-primary ml-1" })
              ] }),
              /* @__PURE__ */ c.jsx("div", { className: "mt-2 h-1 bg-border rounded-full overflow-hidden", children: /* @__PURE__ */ c.jsx(
                "div",
                {
                  className: `h-full transition-all duration-300 ${h >= 80 ? "bg-amber-500" : "bg-primary"}`,
                  style: { width: `${h}%` }
                }
              ) })
            ] })
          ] })
        ] }),
        /* @__PURE__ */ c.jsx(Br, { length: 100, spacing: "md" }),
        /* @__PURE__ */ c.jsxs("div", { children: [
          /* @__PURE__ */ c.jsx("h2", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider mb-4", children: "" }),
          /* @__PURE__ */ c.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
            /* @__PURE__ */ c.jsxs("div", { children: [
              /* @__PURE__ */ c.jsx("span", { className: "text-[10px] text-muted-foreground/70 uppercase tracking-wider block mb-1", children: "" }),
              /* @__PURE__ */ c.jsxs("div", { className: "flex items-baseline gap-2", children: [
                /* @__PURE__ */ c.jsx("span", { className: "text-xl font-mono text-foreground/80", children: i.eventCount }),
                /* @__PURE__ */ c.jsxs("span", { className: "text-xs text-muted-foreground", children: [
                  "~",
                  i.estimatedTokens.toLocaleString(),
                  " tok"
                ] })
              ] }),
              /* @__PURE__ */ c.jsxs("div", { className: "mt-2 flex items-center gap-2 text-[10px] text-muted-foreground", children: [
                /* @__PURE__ */ c.jsxs("span", { children: [
                  " ",
                  i.activeCount
                ] }),
                /* @__PURE__ */ c.jsx("div", { className: "flex-1 h-1 bg-border rounded-full overflow-hidden", children: /* @__PURE__ */ c.jsx("div", { className: "h-full bg-primary", style: { width: `${100 - m}%` } }) }),
                /* @__PURE__ */ c.jsxs("span", { children: [
                  " ",
                  i.archivedCount
                ] })
              ] })
            ] }),
            /* @__PURE__ */ c.jsxs("div", { children: [
              /* @__PURE__ */ c.jsx("span", { className: "text-[10px] text-muted-foreground/70 uppercase tracking-wider block mb-1", children: "" }),
              /* @__PURE__ */ c.jsx("div", { className: "text-xl font-mono text-foreground/80", children: i.entityCount }),
              i.entityCount > 0 && /* @__PURE__ */ c.jsx("div", { className: "flex gap-2 mt-2", children: Object.entries(i.entityByType).slice(0, 3).map(([x, b]) => /* @__PURE__ */ c.jsxs("span", { className: "text-[10px] text-muted-foreground", children: [
                x,
                ": ",
                b
              ] }, x)) })
            ] })
          ] })
        ] }),
        /* @__PURE__ */ c.jsx(Br, { length: 30, spacing: "md" }),
        /* @__PURE__ */ c.jsxs("div", { children: [
          /* @__PURE__ */ c.jsx("h2", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider mb-4", children: "" }),
          /* @__PURE__ */ c.jsxs("div", { className: "grid grid-cols-2 gap-6 bg-muted/30 p-4 rounded-lg border border-border/50", children: [
            /* @__PURE__ */ c.jsxs("div", { children: [
              /* @__PURE__ */ c.jsx("span", { className: "text-[10px] text-muted-foreground/70 uppercase tracking-wider block mb-1", children: "" }),
              /* @__PURE__ */ c.jsxs("div", { className: "flex items-baseline gap-2", children: [
                /* @__PURE__ */ c.jsx("span", { className: "text-xl font-mono text-foreground/80", children: a.shortTermCount }),
                /* @__PURE__ */ c.jsxs("span", { className: "text-xs text-muted-foreground", children: [
                  "/ ",
                  a.shortTermLimit
                ] })
              ] }),
              /* @__PURE__ */ c.jsx("div", { className: "mt-3 space-y-1", children: a.topItems.map((x, b) => /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between text-[10px] text-muted-foreground", children: [
                /* @__PURE__ */ c.jsx("span", { className: "truncate max-w-[80px]", title: x.label, children: x.label }),
                /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-1", children: [
                  /* @__PURE__ */ c.jsx("div", { className: "w-12 h-1 bg-border rounded-full overflow-hidden", children: /* @__PURE__ */ c.jsx("div", { className: "h-full bg-primary/70", style: { width: `${Math.min(100, x.score * 100)}%` } }) }),
                  /* @__PURE__ */ c.jsx("span", { className: "font-mono", children: x.score.toFixed(2) })
                ] })
              ] }, x.id)) })
            ] }),
            /* @__PURE__ */ c.jsxs("div", { children: [
              /* @__PURE__ */ c.jsx("span", { className: "text-[10px] text-muted-foreground/70 uppercase tracking-wider block mb-1", children: "" }),
              /* @__PURE__ */ c.jsxs("div", { className: "flex items-baseline gap-2", children: [
                /* @__PURE__ */ c.jsx("span", { className: `text-xl font-mono ${a.workingCount >= a.workingLimit ? "text-amber-500" : "text-foreground/80"}`, children: a.workingCount }),
                /* @__PURE__ */ c.jsxs("span", { className: "text-xs text-muted-foreground", children: [
                  "/ ",
                  a.workingLimit
                ] })
              ] }),
              /* @__PURE__ */ c.jsx(Br, { length: 80, className: "my-3 opacity-50" }),
              /* @__PURE__ */ c.jsx("span", { className: "text-[10px] text-muted-foreground/70 uppercase tracking-wider block mb-1", children: "" }),
              /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-1", children: [
                /* @__PURE__ */ c.jsxs("span", { className: "text-sm font-mono text-foreground/80", children: [
                  u.estimatedTokens.toLocaleString(),
                  " Tok"
                ] }),
                /* @__PURE__ */ c.jsxs("span", { className: "text-[10px] text-muted-foreground", children: [
                  u.injectedLength.toLocaleString(),
                  " chars"
                ] })
              ] })
            ] })
          ] })
        ] }),
        /* @__PURE__ */ c.jsx(Br, { length: 100 }),
        /* @__PURE__ */ c.jsxs("div", { children: [
          /* @__PURE__ */ c.jsx("h2", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider mb-4", children: "" }),
          /* @__PURE__ */ c.jsx("div", { className: "grid grid-cols-5 gap-3", children: Bne.map(({ id: x, label: b, icon: w, path: S }) => /* @__PURE__ */ c.jsxs(
            "button",
            {
              onClick: () => f(S.replace("/", "")),
              className: "flex flex-col items-center gap-2 p-3 rounded-lg text-muted-foreground hover:text-foreground transition-all duration-[var(--duration-fast)] group hover:translate-y-[-2px] active:scale-95",
              children: [
                /* @__PURE__ */ c.jsx(w, { size: 20, className: "text-primary transition-transform duration-[var(--duration-fast)] group-hover:scale-110" }),
                /* @__PURE__ */ c.jsx("span", { className: "text-xs", children: b })
              ]
            },
            x
          )) })
        ] })
      ] }),
      /* @__PURE__ */ c.jsxs("section", { className: "space-y-6 lg:pl-8 relative", children: [
        /* @__PURE__ */ c.jsx(Br, { responsive: !0, length: 30 }),
        /* @__PURE__ */ c.jsxs("div", { children: [
          /* @__PURE__ */ c.jsx("h2", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider mb-4", children: "" }),
          /* @__PURE__ */ c.jsx("div", { className: "space-y-4", children: Lne.map(({ key: x, label: b, desc: w, icon: S }) => {
            const C = s[x];
            return /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between", children: [
              /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-3 min-w-0 flex-1", children: [
                /* @__PURE__ */ c.jsx("div", { className: `p-1.5 rounded-lg ${C ? "bg-primary/10 text-primary" : "bg-muted text-muted-foreground"}`, children: /* @__PURE__ */ c.jsx(S, { size: 14 }) }),
                /* @__PURE__ */ c.jsxs("div", { className: "min-w-0 flex-1", children: [
                  /* @__PURE__ */ c.jsx("span", { className: `text-sm ${C ? "text-foreground" : "text-muted-foreground"}`, children: b }),
                  /* @__PURE__ */ c.jsx("p", { className: "text-[10px] text-muted-foreground truncate", children: w })
                ] })
              ] }),
              /* @__PURE__ */ c.jsx(gi, { checked: C, onChange: () => d(x) })
            ] }, x);
          }) })
        ] }),
        /* @__PURE__ */ c.jsx(Br, { length: 100, spacing: "md" }),
        /* @__PURE__ */ c.jsxs("div", { children: [
          /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between mb-4", children: [
            /* @__PURE__ */ c.jsx("h2", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider", children: "" }),
            /* @__PURE__ */ c.jsxs(
              "button",
              {
                onClick: () => f("devlog"),
                className: "text-[10px] text-primary hover:underline flex items-center gap-0.5",
                children: [
                  " ",
                  /* @__PURE__ */ c.jsx(nc, { size: 12 })
                ]
              }
            )
          ] }),
          /* @__PURE__ */ c.jsx("div", { className: "font-mono text-[11px] space-y-1.5", children: t.length === 0 ? /* @__PURE__ */ c.jsx("div", { className: "text-muted-foreground text-center py-4 italic", children: "" }) : t.map((x) => /* @__PURE__ */ c.jsxs("div", { className: `flex gap-2 opacity-80 ${Ine(x.level)}`, children: [
            /* @__PURE__ */ c.jsxs("span", { className: "text-muted-foreground shrink-0", children: [
              "[",
              new Date(x.timestamp).toLocaleTimeString([], { hour12: !1 }),
              "]"
            ] }),
            /* @__PURE__ */ c.jsx("span", { className: "text-foreground truncate", children: x.message })
          ] }, x.id)) })
        ] })
      ] })
    ] }) })
  ] });
}, $ne = I.lazy(() => Promise.resolve().then(() => Tle).then((e) => ({ default: e.DevLog }))), qne = I.lazy(() => Promise.resolve().then(() => $he).then((e) => ({ default: e.APIPresets }))), Fne = I.lazy(() => Promise.resolve().then(() => Vhe).then((e) => ({ default: e.Settings }))), Une = I.lazy(() => Promise.resolve().then(() => b2e).then((e) => ({ default: e.MemoryStream }))), Hne = I.lazy(() => Promise.resolve().then(() => U2e).then((e) => ({ default: e.ProcessingView }))), Vne = I.lazy(() => Promise.resolve().then(() => V2e).then((e) => ({ default: e.DocsView }))), Gne = () => /* @__PURE__ */ c.jsx("div", { className: "flex items-center justify-center h-full", children: /* @__PURE__ */ c.jsx("div", { className: "animate-spin h-8 w-8 border-2 border-primary border-t-transparent rounded-full" }) }), Kne = ({ onClose: e }) => {
  const [t, n] = I.useState("dashboard"), [r, i] = I.useState(!1), [s, a] = I.useState(!1), u = (h) => {
    const m = h.replace(/^\//, "");
    console.debug("[Engram] Navigating to:", m), n(m);
  };
  I.useEffect(() => {
    const h = setTimeout(() => {
      const m = it.get("hasSeenWelcome");
      console.debug("[Engram] hasSeenWelcome:", m), m || i(!0), a(!0);
    }, 1e3);
    return () => clearTimeout(h);
  }, []), I.useEffect(() => {
    const h = X5.on("UI_NAVIGATE_REQUEST", (m) => {
      console.debug("[Engram] :", m), u(m);
    });
    return () => h.unsubscribe();
  }, []), I.useEffect(() => {
    const m = setTimeout(async () => {
      try {
        if (await Wl.hasUnreadUpdate()) {
          const b = await Wl.getLatestVersion();
          xn.info(
            ` v${b}`,
            "Engram ",
            { action: { goto: "settings" } }
            // 
          );
        }
      } catch (x) {
        console.debug("[Engram] ", x);
      }
    }, 3e3);
    return () => clearTimeout(m);
  }, []);
  const d = () => {
    it.set("hasSeenWelcome", !0), console.debug("[Engram] hasSeenWelcome saved"), i(!1);
  };
  if (!s)
    return null;
  const f = () => {
    const [h, m] = t.split(":");
    switch (h) {
      case "dashboard":
        return /* @__PURE__ */ c.jsx(WN, { onNavigate: n });
      case "presets":
        return /* @__PURE__ */ c.jsx(qne, { initialTab: m });
      case "devlog":
        return /* @__PURE__ */ c.jsx($ne, { initialTab: m });
      case "settings":
        return /* @__PURE__ */ c.jsx(Fne, {});
      case "memory":
        return /* @__PURE__ */ c.jsx(Une, {});
      case "processing":
        return /* @__PURE__ */ c.jsx(Hne, { onNavigate: n });
      case "docs":
        return /* @__PURE__ */ c.jsx(Vne, { initialTab: m });
      // V0.9.11
      default:
        return /* @__PURE__ */ c.jsx(WN, {});
    }
  };
  return (
    /*  */
    /* @__PURE__ */ c.jsxs(c.Fragment, { children: [
      r && /* @__PURE__ */ c.jsx(Ene, { onComplete: d }),
      /* @__PURE__ */ c.jsx(Sne, { activeTab: t, setActiveTab: u, onClose: e, children: /* @__PURE__ */ c.jsx(I.Suspense, { fallback: /* @__PURE__ */ c.jsx(Gne, {}), children: f() }) })
    ] })
  );
}, Yne = () => {
  var w;
  const [e, t] = I.useState(!1), [n, r] = I.useState(null), [i, s] = I.useState(""), [a, u] = I.useState(""), [d, f] = I.useState(!1), [h] = I.useState(!1);
  I.useEffect(() => {
    const S = ao.on(
      Qo.ENGRAM_REQUEST_REVISION,
      (C) => {
        const T = C;
        r(T), s(T.content), u(""), f(!1), t(!0);
      }
    );
    return () => {
      S();
    };
  }, []);
  const m = (S) => {
    if (n) {
      if (S === "reject" && !d) {
        f(!0);
        return;
      }
      n.onResult({
        action: S,
        content: i,
        feedback: S === "reject" ? a : void 0
      }), t(!1), r(null);
    }
  }, x = () => {
    n && n.onCancel && n.onCancel(), t(!1), r(null);
  };
  if (!e) return null;
  const b = (S) => {
    switch (S) {
      case "confirm":
        return { label: "", icon: vh, variant: "primary" };
      case "skip":
        return { label: "(ai))", icon: fr, variant: "secondary" };
      // Icon?
      case "reject":
        return { label: "()", icon: km, variant: "destructive" };
      default:
        return { label: S, icon: vh, variant: "secondary" };
    }
  };
  return Vb.createPortal(
    /* @__PURE__ */ c.jsxs(
      "div",
      {
        className: "fixed inset-0 z-[11000] flex items-center justify-center p-4",
        style: { height: "100dvh", width: "100vw" },
        children: [
          /* @__PURE__ */ c.jsx(
            "div",
            {
              className: "absolute inset-0 bg-background/80 backdrop-blur-sm animate-in fade-in duration-200",
              onClick: x
            }
          ),
          /* @__PURE__ */ c.jsxs("div", { className: "relative w-full max-w-2xl bg-popover border border-border rounded-lg shadow-2xl flex flex-col max-h-[85vh] animate-in zoom-in-95 slide-in-from-bottom-2 duration-200", children: [
            /* @__PURE__ */ c.jsxs("div", { className: "flex items-start justify-between p-5 border-b border-border", children: [
              /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-1", children: [
                /* @__PURE__ */ c.jsx("h3", { className: "text-lg font-medium text-foreground tracking-tight", children: (n == null ? void 0 : n.title) || "" }),
                (n == null ? void 0 : n.description) && /* @__PURE__ */ c.jsx("p", { className: "text-sm text-muted-foreground", children: n.description })
              ] }),
              /* @__PURE__ */ c.jsx(
                "button",
                {
                  onClick: x,
                  className: "p-2 -m-2 text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-all duration-[var(--duration-fast)] hover:rotate-90",
                  "aria-label": "",
                  children: /* @__PURE__ */ c.jsx(Wu, { size: 18 })
                }
              )
            ] }),
            /* @__PURE__ */ c.jsxs("div", { className: "flex-1 p-5 overflow-hidden flex flex-col gap-4", children: [
              /* @__PURE__ */ c.jsxs("div", { className: "flex items-start gap-3 p-3 bg-primary/10 border border-primary/20 rounded-md", children: [
                /* @__PURE__ */ c.jsx(km, { size: 16, className: "text-primary shrink-0 mt-0.5" }),
                /* @__PURE__ */ c.jsx("p", { className: "text-sm text-foreground/80 leading-relaxed", children: "" })
              ] }),
              d ? /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col flex-1 gap-2 animate-in fade-in slide-in-from-bottom-2", children: [
                /* @__PURE__ */ c.jsx("label", { className: "text-sm font-medium text-destructive", children: "" }),
                /* @__PURE__ */ c.jsx(
                  "textarea",
                  {
                    value: a,
                    onChange: (S) => u(S.target.value),
                    className: "flex-1 w-full min-h-[100px] p-4 bg-muted border border-border rounded-md font-sans text-sm text-foreground focus:outline-none focus:ring-2 focus:ring-destructive resize-none",
                    placeholder: "...",
                    autoFocus: !0
                  }
                )
              ] }) : /* @__PURE__ */ c.jsx(
                "textarea",
                {
                  value: i,
                  onChange: (S) => s(S.target.value),
                  className: "flex-1 w-full min-h-[200px] p-4 bg-muted border border-border rounded-md font-mono text-sm text-foreground leading-relaxed placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring resize-none",
                  spellCheck: !1,
                  placeholder: "..."
                }
              ),
              !d && /* @__PURE__ */ c.jsxs("div", { className: "text-xs text-muted-foreground text-right font-mono", children: [
                i.length,
                " "
              ] })
            ] }),
            /* @__PURE__ */ c.jsx("div", { className: "flex items-center justify-end gap-3 px-5 py-4 border-t border-border bg-muted/30", children: d ? /* @__PURE__ */ c.jsxs(c.Fragment, { children: [
              /* @__PURE__ */ c.jsx(
                "button",
                {
                  onClick: () => f(!1),
                  className: "px-4 py-2 text-sm text-muted-foreground hover:text-foreground",
                  children: ""
                }
              ),
              /* @__PURE__ */ c.jsxs(
                "button",
                {
                  onClick: () => m("reject"),
                  disabled: !a.trim(),
                  className: "inline-flex items-center gap-2 px-4 py-2 text-sm bg-destructive text-destructive-foreground rounded-lg hover:bg-destructive/90 transition-all shadow-sm",
                  children: [
                    /* @__PURE__ */ c.jsx(fr, { size: 16 }),
                    ""
                  ]
                }
              )
            ] }) : (w = n == null ? void 0 : n.actions) == null ? void 0 : w.map((S) => {
              const C = b(S), T = C.icon;
              let R = "inline-flex items-center gap-2 px-4 py-2 text-sm rounded-lg transition-all shadow-sm ";
              return C.variant === "primary" ? R += "bg-primary text-primary-foreground hover:bg-primary/90 hover:shadow-[0_0_15px_var(--primary)]" : C.variant === "destructive" ? R += "bg-destructive text-destructive-foreground hover:bg-destructive/90" : R += "bg-secondary text-secondary-foreground hover:bg-secondary/80 border border-border", /* @__PURE__ */ c.jsxs(
                "button",
                {
                  onClick: () => m(S),
                  disabled: h,
                  className: `${R} hover:scale-[1.02] active:scale-95`,
                  children: [
                    /* @__PURE__ */ c.jsx(T, { size: 16 }),
                    C.label
                  ]
                },
                S
              );
            }) })
          ] })
        ]
      }
    ),
    document.body
  );
}, Wne = ({
  isOpen: e,
  onClose: t,
  title: n,
  size: r = "md",
  children: i
}) => {
  if (!e) return null;
  console.log("[Engram Modal] Rendering Modal with Open=true", { title: n, zIndex: 2147483647 });
  const s = {
    sm: "max-w-sm",
    md: "max-w-md",
    lg: "max-w-2xl"
  };
  return Vb.createPortal(
    /* @__PURE__ */ c.jsxs(
      "div",
      {
        className: "fixed inset-0 z-[2147483647] flex items-center justify-center p-4 pointer-events-auto",
        style: { height: "100dvh", width: "100vw" },
        children: [
          /* @__PURE__ */ c.jsx(
            "div",
            {
              className: "absolute inset-0 bg-background/80 backdrop-blur-sm animate-in fade-in duration-200",
              onClick: t
            }
          ),
          /* @__PURE__ */ c.jsxs("div", { className: `relative w-full ${s[r]} bg-popover border border-border rounded-lg shadow-2xl flex flex-col max-h-[85vh] animate-in zoom-in-95 slide-in-from-bottom-2 duration-200`, children: [
            n && /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between p-4 border-b border-border", children: [
              /* @__PURE__ */ c.jsx("h3", { className: "text-base font-medium text-foreground", children: n }),
              /* @__PURE__ */ c.jsx(
                "button",
                {
                  onClick: t,
                  className: "p-2 -m-2 text-muted-foreground hover:text-foreground hover:bg-accent rounded-md transition-all duration-[var(--duration-fast)] hover:rotate-90",
                  "aria-label": "",
                  children: /* @__PURE__ */ c.jsx(Wu, { size: 18 })
                }
              )
            ] }),
            /* @__PURE__ */ c.jsx("div", { className: "flex-1 p-4 overflow-auto", children: i })
          ] })
        ]
      }
    ),
    document.body
  );
}, Zne = ({
  isOpen: e,
  onClose: t,
  title: n,
  children: r,
  initialPosition: i,
  width: s = 320,
  minWidth: a = 280,
  maxWidth: u = 600,
  minHeight: d = 150,
  resizable: f = !0
}) => {
  const h = I.useRef(null), [m, x] = I.useState(i || { x: 100, y: 100 }), [b, w] = I.useState({ width: s, height: "auto" }), [S, C] = I.useState(!1), [T, R] = I.useState(!1), N = I.useRef({ x: 0, y: 0 }), M = I.useRef({ width: 0, height: 0, x: 0, y: 0 });
  I.useEffect(() => {
    e && !i && x({
      x: Math.max(50, (window.innerWidth - s) / 2),
      y: Math.max(50, window.innerHeight - 450)
    });
  }, [e, i, s]);
  const P = I.useCallback((te) => {
    if (!h.current) return;
    const V = h.current.getBoundingClientRect();
    N.current = {
      x: te.clientX - V.left,
      y: te.clientY - V.top
    }, C(!0);
  }, []), D = I.useCallback((te) => {
    if (S) {
      const V = Math.max(0, Math.min(window.innerWidth - (typeof b.width == "number" ? b.width : 300), te.clientX - N.current.x)), $ = Math.max(0, Math.min(window.innerHeight - 100, te.clientY - N.current.y));
      x({ x: V, y: $ });
    } else if (T && h.current) {
      const V = te.clientX - M.current.x, $ = te.clientY - M.current.y, G = Math.max(a, Math.min(u, M.current.width + V)), le = Math.max(d, M.current.height + $);
      w({ width: G, height: le });
    }
  }, [S, T, b.width, a, u, d]), q = I.useCallback(() => {
    C(!1), R(!1);
  }, []), Y = I.useCallback((te) => {
    if (te.preventDefault(), te.stopPropagation(), !h.current) return;
    const V = h.current.getBoundingClientRect();
    M.current = {
      width: V.width,
      height: V.height,
      x: te.clientX,
      y: te.clientY
    }, R(!0);
  }, []);
  return I.useEffect(() => {
    if (S || T)
      return window.addEventListener("mousemove", D), window.addEventListener("mouseup", q), () => {
        window.removeEventListener("mousemove", D), window.removeEventListener("mouseup", q);
      };
  }, [S, T, D, q]), e ? Vb.createPortal(
    /* @__PURE__ */ c.jsxs(
      "div",
      {
        ref: h,
        className: "fixed z-[11000] flex flex-col rounded-lg shadow-2xl border border-border overflow-hidden engram-animate-scale-in",
        style: {
          left: m.x,
          top: m.y,
          width: b.width,
          height: b.height === "auto" ? "auto" : b.height,
          minHeight: d,
          backgroundColor: "var(--popover, #1a1a2e)",
          backdropFilter: "blur(20px)",
          WebkitBackdropFilter: "blur(20px)"
        },
        children: [
          /* @__PURE__ */ c.jsxs(
            "div",
            {
              className: "flex items-center justify-between px-3 py-2 border-b border-border select-none",
              onMouseDown: P,
              style: {
                cursor: S ? "grabbing" : "grab",
                backgroundColor: "var(--surface, rgba(255,255,255,0.05))"
              },
              children: [
                /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2", children: [
                  /* @__PURE__ */ c.jsx(_z, { size: 14, className: "text-muted-foreground" }),
                  /* @__PURE__ */ c.jsx("span", { className: "text-sm font-medium text-foreground", children: n })
                ] }),
                /* @__PURE__ */ c.jsx(
                  "button",
                  {
                    onClick: t,
                    className: "p-1 text-muted-foreground hover:text-foreground rounded transition-all duration-[var(--duration-fast)] hover:rotate-90 hover:bg-accent",
                    style: { backgroundColor: "transparent" },
                    "aria-label": "",
                    onMouseDown: (te) => te.stopPropagation(),
                    children: /* @__PURE__ */ c.jsx(Wu, { size: 14 })
                  }
                )
              ]
            }
          ),
          /* @__PURE__ */ c.jsx("div", { className: "flex-1 overflow-auto p-3", children: r }),
          f && /* @__PURE__ */ c.jsx(
            "div",
            {
              className: "absolute bottom-0 right-0 w-4 h-4 cursor-se-resize",
              onMouseDown: Y,
              style: {
                background: "linear-gradient(135deg, transparent 50%, var(--border, #333) 50%)"
              }
            }
          )
        ]
      }
    ),
    document.body
  ) : null;
}, sh = class sh {
  constructor() {
    lt(this, "cancelRequested", !1);
  }
  // ... (rest of class)
  static getInstance() {
    return sh.instance || (sh.instance = new sh()), sh.instance;
  }
  /**
   * 
   */
  async requestStopGeneration() {
    const { StopGeneration: t } = await Promise.resolve().then(() => cre);
    await t.abort();
  }
  /**
   * 
   * @param userInput 
   * @returns 
   */
  async process(t) {
    var s, a, u;
    const n = Date.now(), r = this.getConfig();
    if (!r.enabled)
      return {
        success: !0,
        output: null,
        query: null,
        rawOutput: "",
        processingTime: 0
      };
    ee.info(Fe.PREPROCESS, "", { inputLength: t.length }), this.cancelRequested = !1;
    const i = xn.running("...", "Engram", () => {
      this.cancelRequested = !0, ee.debug(Fe.PREPROCESS, ""), this.requestStopGeneration(), xn.warning("...", "Engram");
    });
    try {
      const { WorkflowEngine: d } = await Promise.resolve().then(() => cw), { createPreprocessWorkflow: f } = await Promise.resolve().then(() => K2e), h = await d.run(f(), {
        trigger: "auto",
        config: {
          previewEnabled: r.preview,
          templateId: r.templateId,
          logType: "query"
          // Log as 'query' type for ModelLogger
        },
        input: {
          text: t
        }
      });
      if (h.metadata.skipToInjection) {
        ee.info(Fe.PREPROCESS, " AI ");
        const S = h.output;
        if (typeof S == "string") {
          const { injectMessage: C } = await Promise.resolve().then(() => zne);
          await C("char", S), xn.success(" AI ", "Engram");
        } else
          ee.warn(Fe.PREPROCESS, "");
        return {
          success: !0,
          output: "",
          // Clear user input
          query: null,
          rawOutput: ((s = h.llmResponse) == null ? void 0 : s.content) || "",
          processingTime: Date.now() - n
        };
      }
      const m = h.output, x = ((a = h.extractedTags) == null ? void 0 : a.query) || null, b = ((u = h.llmResponse) == null ? void 0 : u.content) || "", w = Date.now() - n;
      return ee.success(Fe.PREPROCESS, "", {
        outputLength: (m == null ? void 0 : m.length) || 0,
        processingTime: w
      }), {
        success: !0,
        output: m,
        query: x,
        rawOutput: b,
        processingTime: w
      };
    } catch (d) {
      const f = d instanceof Error ? d.message : "";
      return f === "UserCancelled" || this.cancelRequested ? (ee.debug(Fe.PREPROCESS, ""), {
        success: !1,
        output: null,
        query: null,
        rawOutput: "",
        processingTime: Date.now() - n,
        error: ""
      }) : (ee.error(Fe.PREPROCESS, "", { error: f }), xn.error(`: ${f}`, "Engram"), {
        success: !1,
        output: null,
        query: null,
        rawOutput: "",
        processingTime: Date.now() - n,
        error: f
      });
    } finally {
      xn.remove(i);
    }
  }
  /**
   * 
   */
  getConfig() {
    return it.get("preprocessingConfig") || Ay;
  }
  /**
   * 
   */
  saveConfig(t) {
    ee.debug(Fe.PREPROCESS, "", t), it.set("preprocessingConfig", t);
  }
  /**
   * /
   */
  toggle() {
    const t = this.getConfig();
    return t.enabled = !t.enabled, this.saveConfig(t), ee.info(Fe.PREPROCESS, t.enabled ? "" : ""), t.enabled;
  }
};
lt(sh, "instance");
let U3 = sh;
const hh = U3.getInstance();
function Xne({ isOpen: e, onClose: t }) {
  var m, x, b, w;
  const [n, r] = I.useState(
    hh.getConfig() || Ay
  ), [i, s] = I.useState(
    ((m = it.get("apiSettings")) == null ? void 0 : m.recallConfig) || {}
  ), [a, u] = I.useState(
    ((x = it.get("apiSettings")) == null ? void 0 : x.promptTemplates) || []
  ), d = I.useMemo(() => a.filter((S) => S.category === "preprocessing").map((S) => ({
    id: S.id,
    name: S.name,
    description: S.userPromptTemplate.slice(0, 30).replace(/\n/g, " ") + "...",
    icon: Nz
  })), [a]);
  I.useEffect(() => {
    if (!e) return;
    const S = () => {
      const T = hh.getConfig() || Ay;
      r((N) => JSON.stringify(N) !== JSON.stringify(T) ? T : N);
      const R = it.get("apiSettings");
      if (R) {
        const N = R.recallConfig || {};
        s((P) => JSON.stringify(P) !== JSON.stringify(N) ? N : P);
        const M = R.promptTemplates || [];
        M.length !== a.length && u(M);
      }
    };
    S();
    const C = setInterval(S, 1e3);
    return () => clearInterval(C);
  }, [e, a.length]);
  const f = I.useCallback(() => {
    const S = (i == null ? void 0 : i.usePreprocessing) ?? !1, C = !S;
    ee.debug("QuickPanel", "", { from: S, to: C });
    const T = it.get("apiSettings");
    if (T && T.recallConfig) {
      const N = { ...T.recallConfig, usePreprocessing: C };
      it.set("apiSettings", {
        ...T,
        recallConfig: N
      });
    }
    const R = { ...n, enabled: C };
    r(R), it.set("preprocessingConfig", R);
  }, [n, i]), h = I.useCallback((S) => {
    ee.debug("QuickPanel", "", { templateId: S });
    const C = { ...n, templateId: S, enabled: !0 };
    r(C), it.set("preprocessingConfig", C);
    const T = it.get("apiSettings");
    if (T && T.recallConfig && !T.recallConfig.usePreprocessing) {
      const R = { ...T.recallConfig, usePreprocessing: !0 };
      it.set("apiSettings", {
        ...T,
        recallConfig: R
      });
    }
  }, [n]);
  return !n.templateId || d.some((S) => S.id === n.templateId), /* @__PURE__ */ c.jsx(
    Zne,
    {
      isOpen: e,
      onClose: t,
      title: "Engram ",
      width: 300,
      children: /* @__PURE__ */ c.jsxs("div", { className: "space-y-3", children: [
        /* @__PURE__ */ c.jsxs(
          "div",
          {
            className: "flex items-center justify-between p-2 rounded-md",
            style: {
              backgroundColor: "var(--surface, rgba(255,255,255,0.05))",
              border: "1px solid var(--border, rgba(255,255,255,0.1))"
            },
            children: [
              /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2", children: [
                /* @__PURE__ */ c.jsx(Ai, { size: 14, style: { color: "var(--primary, #ef7357)" } }),
                /* @__PURE__ */ c.jsx("span", { className: "text-sm font-medium", children: "" })
              ] }),
              /* @__PURE__ */ c.jsx(
                gi,
                {
                  checked: (i == null ? void 0 : i.usePreprocessing) ?? n.enabled,
                  onChange: f
                }
              )
            ]
          }
        ),
        ((i == null ? void 0 : i.usePreprocessing) ?? n.enabled) && /* @__PURE__ */ c.jsxs(
          "div",
          {
            className: "flex items-center justify-between p-2 rounded-md",
            style: {
              backgroundColor: "var(--surface, rgba(255,255,255,0.05))",
              border: "1px solid var(--border, rgba(255,255,255,0.1))"
            },
            children: [
              /* @__PURE__ */ c.jsx("div", { className: "flex items-center gap-2 pl-2", children: /* @__PURE__ */ c.jsx("span", { className: "text-xs text-muted-foreground", children: "" }) }),
              /* @__PURE__ */ c.jsx(
                gi,
                {
                  checked: n.preview,
                  onChange: () => {
                    const S = { ...n, preview: !n.preview };
                    r(S), Promise.resolve().then(() => Xb).then(({ SettingsManager: C }) => {
                      C.set("preprocessingConfig", S);
                    });
                  }
                }
              )
            ]
          }
        ),
        ((i == null ? void 0 : i.usePreprocessing) ?? n.enabled) && /* @__PURE__ */ c.jsxs("div", { className: "space-y-2", children: [
          /* @__PURE__ */ c.jsx("div", { className: "text-xs px-1", style: { color: "var(--muted-foreground, #888)" }, children: "" }),
          d.length === 0 ? /* @__PURE__ */ c.jsxs(
            "div",
            {
              className: "flex items-start gap-2 p-2 rounded-md text-xs mt-2",
              style: {
                backgroundColor: "rgba(var(--primary-rgb, 239,115,87), 0.1)",
                border: "1px solid rgba(var(--primary-rgb, 239,115,87), 0.3)",
                color: "var(--muted-foreground, #888)"
              },
              children: [
                /* @__PURE__ */ c.jsx(_d, { size: 14, style: { color: "var(--primary, #ef7357)", flexShrink: 0, marginTop: 2 } }),
                /* @__PURE__ */ c.jsx("span", { children: " API    'preprocessing' " })
              ]
            }
          ) : /* @__PURE__ */ c.jsx("div", { className: "space-y-1", children: d.map((S) => {
            const C = S.icon, T = n.templateId === S.id;
            return /* @__PURE__ */ c.jsxs(
              "button",
              {
                onClick: () => h(S.id),
                className: "w-full flex items-center gap-3 p-2 rounded-md transition-all text-left",
                style: {
                  backgroundColor: T ? "rgba(var(--primary-rgb, 239,115,87), 0.15)" : "var(--surface, rgba(255,255,255,0.05))",
                  border: T ? "1px solid var(--primary, #ef7357)" : "1px solid var(--border, rgba(255,255,255,0.1))",
                  color: "var(--foreground, #fff)"
                },
                children: [
                  /* @__PURE__ */ c.jsx(
                    C,
                    {
                      size: 16,
                      style: {
                        color: T ? "var(--primary, #ef7357)" : "var(--muted-foreground, #888)"
                      }
                    }
                  ),
                  /* @__PURE__ */ c.jsxs("div", { className: "flex-1 min-w-0", children: [
                    /* @__PURE__ */ c.jsx("div", { className: "text-sm font-medium truncate", children: S.name }),
                    /* @__PURE__ */ c.jsx(
                      "div",
                      {
                        className: "text-xs truncate",
                        style: { color: "var(--muted-foreground, #888)" },
                        children: S.description
                      }
                    )
                  ] })
                ]
              },
              S.id
            );
          }) })
        ] }),
        /* @__PURE__ */ c.jsx(
          "div",
          {
            className: "text-xs text-center pt-2",
            style: {
              borderTop: "1px solid var(--border, rgba(255,255,255,0.1))",
              color: "var(--muted-foreground, #888)"
            },
            children: (i == null ? void 0 : i.usePreprocessing) ?? n.enabled ? (b = d.find((S) => S.id === n.templateId)) != null && b.name ? `  ${(w = d.find((S) => S.id === n.templateId)) == null ? void 0 : w.name}` : "  " : ""
          }
        )
      ] })
    }
  );
}
const im = "QuickPanelButton";
let ZN = !1, H3 = null;
function tL(e) {
  H3 = e;
}
function p_() {
  if (ZN)
    return ee.debug(im, ""), !0;
  const e = document.querySelector("#leftSendForm");
  if (!e)
    return ee.debug(im, "#leftSendForm "), !1;
  const t = document.createElement("div");
  return t.id = "engram-quick-panel-trigger", t.className = "fa-solid fa-layer-group interactable", t.tabIndex = 0, t.title = "Engram ", t.setAttribute("data-i18n", "[title]Engram Quick Panel"), t.addEventListener("click", (n) => {
    n.preventDefault(), n.stopPropagation(), ee.debug(im, ""), H3 ? H3() : ee.warn(im, "");
  }), t.style.cssText = `
        order: 10;
        display: flex;
        width: var(--bottomFormBlockSize);
        height: var(--bottomFormBlockSize);
        align-items: center;
        justify-content: center;
    `, e.appendChild(t), ZN = !0, ee.info(im, " (#leftSendForm)"), !0;
}
function Qne() {
  if (p_())
    return;
  let e = 0;
  const t = 20, n = 500, r = () => {
    e++, !p_() && (e < t ? setTimeout(r, n) : ee.warn(im, ""));
  }, i = new MutationObserver((s, a) => {
    p_() && a.disconnect();
  });
  i.observe(document.body, {
    childList: !0,
    subtree: !0
  }), setTimeout(r, n), setTimeout(() => {
    i.disconnect();
  }, 15e3);
}
const Jne = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  initQuickPanelButton: Qne,
  setQuickPanelCallback: tL
}, Symbol.toStringTag, { value: "Module" }));
let q1 = !1, Om = null, V3 = null;
function ere() {
  Om && (q1 = !q1, Om(q1));
}
function tre() {
  V3 && V3();
}
function nre(e) {
  V3 = e;
}
XI((e, t) => {
  const n = pz.createRoot(e);
  return n.render(wd.createElement(Kne, { onClose: t })), n;
});
function rre() {
  const [e, t] = I.useState(q1);
  return I.useEffect(() => (Om = t, () => {
    Om = null;
  }), []), /* @__PURE__ */ c.jsxs("div", { className: "pointer-events-auto", children: [
    /* @__PURE__ */ c.jsx(Yne, {}),
    /* @__PURE__ */ c.jsx(
      Xne,
      {
        isOpen: e,
        onClose: () => t(!1)
      }
    )
  ] });
}
QI((e) => {
  const t = pz.createRoot(e);
  return t.render(/* @__PURE__ */ c.jsx(rre, {})), t;
});
tL(() => {
  Om && Om(!0);
});
document.readyState === "loading" ? document.addEventListener("DOMContentLoaded", $3) : $3();
const nL = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  openCommandPalette: tre,
  setCommandPaletteCallback: nre,
  toggleQuickPanel: ere
}, Symbol.toStringTag, { value: "Module" }));
function ire(e, t) {
  let n = "assistant";
  return e.is_user ? n = "user" : e.is_system && (n = "system"), {
    id: t,
    role: n,
    content: e.mes || "",
    name: e.name || "",
    isHidden: e.is_hidden ?? !1,
    raw: e
  };
}
class sre {
  /**
   * 
   * @param options 
   */
  static getAllMessages(t = {}) {
    const n = ma();
    if (!(n != null && n.chat))
      return [];
    let r = n.chat.map((i, s) => ire(i, s));
    if (t.includeHidden || (r = r.filter((i) => !i.isHidden)), t.role) {
      const i = Array.isArray(t.role) ? t.role : [t.role];
      r = r.filter((s) => i.includes(s.role));
    }
    return r;
  }
  /**
   *  N 
   * @param count 
   * @param options 
   */
  static getRecentMessages(t, n = {}) {
    return this.getAllMessages(n).slice(-t);
  }
  /**
   * 
   * @param start 
   * @param end 
   * @param options 
   */
  static getMessages(t, n, r = {}) {
    return this.getAllMessages(r).slice(t, n);
  }
  /**
   * 
   * @param options 
   */
  static getFloorCount(t = {}) {
    return this.getAllMessages(t).length;
  }
  /**
   * 
   * @param options 
   */
  static getLastMessage(t = {}) {
    const n = this.getAllMessages(t);
    return n.length > 0 ? n[n.length - 1] : null;
  }
  /**
   * 
   */
  static getCurrentCharacterName() {
    var n;
    const t = ma();
    return !(t != null && t.characters) || t.characterId < 0 ? null : ((n = t.characters[t.characterId]) == null ? void 0 : n.name) || null;
  }
  /**
   *  LLM
   * @param messages 
   * @param format 
   */
  static formatMessagesAsText(t, n = "simple") {
    return n === "simple" ? t.map((r) => `${r.name}: ${r.content}`).join(`

`) : t.map((r) => `[${r.role.toUpperCase()}] ${r.name}:
${r.content}`).join(`

---

`);
  }
  /**
   *  MessageService 
   */
  static isAvailable() {
    return $P();
  }
}
const are = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  MessageService: sre
}, Symbol.toStringTag, { value: "Module" }));
class tx {
  constructor(t) {
    lt(this, "name", "BuildPrompt");
    this.config = t;
  }
  async execute(t) {
    var S, C, T;
    const n = t.config.templateId || this.config.templateId, r = t.config.category || this.config.category, { SettingsManager: i } = await Promise.resolve().then(() => Xb), s = ((S = i.get("apiSettings")) == null ? void 0 : S.promptTemplates) || [];
    Nm.init();
    const a = Nm.getAllTemplates(), u = /* @__PURE__ */ new Map();
    a.forEach((R) => u.set(R.id, R)), s.forEach((R) => u.set(R.id, R));
    const d = Array.from(u.values());
    let f;
    if (n)
      f = d.find((R) => R.id === n);
    else if (r) {
      const R = d.filter((M) => M.category === r && M.enabled), N = R.find((M) => !M.isBuiltIn);
      N ? f = N : f = R[0], f && ee.debug("BuildPrompt", `Using auto-detected enabled template: ${f.name}`);
    }
    if (!f && r && (f = Zb(r), ee.debug("BuildPrompt", `Fallback to builtin template: ${f == null ? void 0 : f.name}`)), !f)
      throw new Error(`BuildPrompt:  (ID: ${n}, Category: ${r})`);
    const h = {
      ...this.config.vars,
      // 
      "{{userInput}}": t.input.text || "",
      "{{chatHistory}}": t.input.chatHistory || "",
      "{{previousOutput}}": t.input.previousOutput || "",
      "{{feedback}}": t.input.feedback || ""
      // ...  MacroService  ( {{worldbookContext}})
    };
    let m = f.systemPrompt, x = f.userPromptTemplate;
    t.input.feedback && (x += `
---
 - 
:
{{previousOutput}}

:
{{feedback}}
`, ee.debug("BuildPrompt", ""));
    for (const [R, N] of Object.entries(h)) {
      const M = new RegExp(R.replace(/[.*+?^${}()|[\]\\]/g, "\\$&"), "g");
      m = m.replace(M, N), x = x.replace(M, N);
    }
    const b = t.input, w = {
      "{{chatHistory}}": b.chatHistory || "",
      "{{engramSummaries}}": b.engramSummaries || "",
      "{{worldbookContext}}": b.worldbookContext || "",
      "{{context}}": b.context || b.worldbookContext || "",
      // Alias
      "{{userPersona}}": b.userPersona || "",
      //  FetchContext 
      "{{char}}": b.charName || "",
      "{{user}}": b.userName || ""
    };
    for (const [R, N] of Object.entries(w))
      m = m.split(R).join(N), x = x.split(R).join(N);
    try {
      const R = (T = (C = window.SillyTavern) == null ? void 0 : C.getContext) == null ? void 0 : T.call(C), N = R == null ? void 0 : R.substituteParams;
      typeof N == "function" && (m = N(m), x = N(x));
    } catch (R) {
      ee.warn("BuildPrompt", "", R);
    }
    t.prompt = {
      system: m,
      user: x,
      templateId: f.id
    }, ee.debug("BuildPrompt", `Prompt  (Template: ${f.name})`, {
      systemLen: m.length,
      userLen: x.length
    });
  }
}
class iw {
  constructor() {
    lt(this, "name", "FetchContext");
  }
  async execute(t) {
    var h, m, x, b;
    ee.debug("FetchContext", "...");
    const n = Qb();
    if (n) {
      const w = n;
      t.input.charName = n.name, t.input.charPersona = w.personality || w.description || "";
    }
    const r = (m = (h = window.SillyTavern) == null ? void 0 : h.getContext) == null ? void 0 : m.call(h);
    r && (t.input.userName = r.name1 || "User");
    const i = t.input.range;
    ee.debug("FetchContext", `: ${i ? i.join("-") : "Recent"}`);
    const s = Ds.getChatHistory(i);
    s ? t.input.chatHistory = s : ee.warn("FetchContext", "");
    const a = t.input.worldbookProfileId;
    let u = "", d = !1;
    if (a) {
      const S = (b = (x = it.getSettings().apiSettings) == null ? void 0 : x.worldbookProfiles) == null ? void 0 : b.find((C) => C.id === a);
      if (S && S.mode === "custom") {
        d = !0, ee.debug("FetchContext", ` [${S.name}] (Custom Mode)`);
        let C = "";
        if (i) {
          const T = LP();
          T && Array.isArray(T) && (C = T.slice(Math.max(0, i[0] - 1), i[1]).map((N) => N.mes || "").join(`
`));
        } else
          C = t.input.text || s || "";
        S.selectedWorldbooks && S.selectedWorldbooks.length > 0 && (u = (await Promise.all(
          S.selectedWorldbooks.map(
            (R) => Ba.scanWorldbook(R, C)
          )
        )).filter(Boolean).join(`

`));
      }
    }
    d || (u = await Ba.getActivatedWorldInfo(void 0, {
      floorRange: i
    })), t.input.worldbookContext = u, t.input.context = u;
    const f = await Ba.getEngramSummariesContent();
    t.input.engramSummaries = f, ee.debug("FetchContext", "", {
      historyLen: (s == null ? void 0 : s.length) || 0,
      wiLen: u.length,
      summaryLen: f.length
    });
  }
}
class rL {
  constructor() {
    lt(this, "name", "FetchEventsToTrim");
  }
  async execute(t) {
    const r = (t.config || {}).keepRecentCount || 3, s = await vi.getState().getEventsToMerge(r);
    if (s.length < 2) {
      if (t.trigger === "manual")
        throw new Error(" ( 2 )");
      ee.debug("FetchEventsToTrim", ""), t.data = t.data || {}, t.data.skipTrimming = !0;
    }
    t.input.eventsToMerge = s, t.data = t.data || {}, t.data.sourceEventIds = s.map((a) => a.id), ee.debug("FetchEventsToTrim", ` ${s.length} `);
  }
}
class iL {
  constructor() {
    lt(this, "name", "FetchExistingEntities");
  }
  async execute(t) {
    const r = await vi.getState().getAllEntities(), i = r.map((s) => ({
      name: s.name,
      type: s.type,
      aliases: s.aliases || []
    }));
    t.input.existingEntities = JSON.stringify(i, null, 2), t.input._rawExistingEntities = r, ee.debug("FetchExistingEntities", ` ${r.length} `);
  }
}
const p1 = "LLMAdapter";
function XN() {
  try {
    return window.TavernHelper || null;
  } catch {
    return null;
  }
}
function ore() {
  var e, t, n, r;
  try {
    const i = (t = (e = window.SillyTavern) == null ? void 0 : e.getContext) == null ? void 0 : t.call(e);
    return ((r = (n = i == null ? void 0 : i.extensionSettings) == null ? void 0 : n.connectionManager) == null ? void 0 : r.profiles) || [];
  } catch {
    return [];
  }
}
class lre {
  /**
   *  LLM 
   * @param request 
   */
  async generate(t) {
    var r, i, s, a, u;
    const n = XN();
    if (!(n != null && n.generateRaw) && !(n != null && n.generate))
      return {
        success: !1,
        content: "",
        error: "TavernHelper "
      };
    try {
      let d;
      const f = it.getSettings();
      let h;
      t.presetId && (h = (i = (r = f.apiSettings) == null ? void 0 : r.llmPresets) == null ? void 0 : i.find((P) => P.id === t.presetId)), !h && ((s = f.apiSettings) != null && s.selectedPresetId) && (h = (u = (a = f.apiSettings) == null ? void 0 : a.llmPresets) == null ? void 0 : u.find((P) => {
        var D;
        return P.id === ((D = f.apiSettings) == null ? void 0 : D.selectedPresetId);
      }));
      let m;
      if (h && h.source !== "tavern") {
        if (m = {}, ee.info(p1, `: ${h.name} (${h.source})`), h.parameters && (m = {
          ...m,
          //  ST API 
          temperature: h.parameters.temperature,
          max_tokens: h.parameters.maxTokens,
          // ST API  max_tokens
          top_p: h.parameters.topP,
          frequency_penalty: h.parameters.frequencyPenalty,
          presence_penalty: h.parameters.presencePenalty
          //  rep_pen  frequency_penalty 
          // rep_pen: preset.parameters.frequencyPenalty,
        }), h.source === "custom" && h.custom)
          m.apiurl = h.custom.apiUrl, m.key = h.custom.apiKey, m.model = h.custom.model, m.source = h.custom.apiSource || "openai";
        else if (h.source === "tavern_profile" && h.tavernProfileId) {
          const D = ore().find((q) => q.id === h.tavernProfileId);
          if (D) {
            ee.info(p1, ` Profile: ${D.name}`), m.model = D.model, m.source = D.api, D["api-url"] ? m.apiurl = D["api-url"] : D.request_url ? m.apiurl = D.request_url : D.openai_url && (m.apiurl = D.openai_url);
            const q = ["key", "request_apikey", "openai_key", "api_key", "auth_token", "password"];
            for (const Y of q)
              if (D[Y]) {
                m.key = D[Y];
                break;
              }
          } else
            ee.warn(p1, ` ID  ${h.tavernProfileId} `), m = void 0;
        }
      }
      const x = t.systemPrompt ? `${t.systemPrompt}

${t.userPrompt}` : t.userPrompt, b = {
        prompt: x,
        // 
        body: {
          messages: [
            { role: "system", content: t.systemPrompt },
            { role: "user", content: t.userPrompt }
          ]
        }
        // 
        // is_engram: true, //  () - 
      }, { EventBus: w, TavernEventType: S } = await Promise.resolve().then(() => Vz);
      await w.emit(S.GENERATION_AFTER_COMMANDS, "engram", {}, !1), await w.emit(S.GENERATE_AFTER_DATA, b);
      const C = typeof b.prompt == "string" ? b.prompt : x;
      let T = t.systemPrompt, R = t.userPrompt;
      C !== x && (T = "", R = C);
      const { regexProcessor: N } = await Promise.resolve().then(() => $T);
      R = N.process(R, "input");
      const M = {
        should_stream: !1,
        // 
        _engram_internal: t.internal
        // 
      };
      if (n.generateRaw) {
        const P = [];
        T && P.push({ role: "system", content: T }), P.push({ role: "user", content: R }), d = await n.generateRaw({
          ordered_prompts: P,
          custom_api: m,
          // V0.8.6 Fix
          ...M
          // [Fix] Apply should_stream: false
        });
      } else if (n.generate)
        d = await n.generate({
          user_input: R,
          system_prompt: T,
          max_chat_history: 0,
          custom_api: m,
          // V0.8.6 Fix
          ...M
          // [Fix] Apply should_stream: false
        });
      else
        throw new Error(" API");
      return {
        success: !0,
        content: d || ""
      };
    } catch (d) {
      const f = d instanceof Error ? d.message : String(d);
      return ee.error(p1, "", d), {
        success: !1,
        content: "",
        error: f
      };
    }
  }
  /**
   *  LLM API 
   */
  isAvailable() {
    const t = XN();
    return !!(t != null && t.generate || t != null && t.generateRaw);
  }
  /**
   *  Token 
   * @param text 
   */
  estimateTokens(t) {
    return Math.ceil(t.length / 3);
  }
}
const sL = new lre(), QN = 100;
class ure {
  constructor() {
    lt(this, "entries", []);
    lt(this, "listeners", /* @__PURE__ */ new Set());
  }
  /**
   * 
   */
  logSend(t) {
    const n = `log_${Date.now()}_${Math.random().toString(36).slice(2, 8)}`, r = {
      id: n,
      timestamp: Date.now(),
      type: t.type,
      direction: "sent",
      systemPrompt: t.systemPrompt,
      userPrompt: t.userPrompt,
      tokensSent: t.tokensSent,
      model: t.model,
      character: t.character,
      floorRange: t.floorRange,
      status: "pending"
    };
    return this.entries.unshift(r), this.trimEntries(), this.notifyListeners(), n;
  }
  /**
   * 
   */
  logReceive(t, n) {
    const r = this.entries.find((a) => a.id === t);
    if (!r) return;
    const i = {
      id: `${t}_recv`,
      timestamp: Date.now(),
      type: r.type,
      direction: "received",
      response: n.response,
      tokensReceived: n.tokensReceived,
      status: n.status,
      error: n.error,
      duration: n.duration,
      model: r.model,
      character: r.character,
      floorRange: r.floorRange
    };
    r.status = n.status, r.duration = n.duration;
    const s = this.entries.findIndex((a) => a.id === t);
    s >= 0 ? this.entries.splice(s, 0, i) : this.entries.unshift(i), this.trimEntries(), this.notifyListeners();
  }
  /**
   * 
   */
  async logCall(t, n) {
    const r = this.logSend(t), i = Date.now();
    try {
      const s = await n();
      return this.logReceive(r, {
        response: typeof s == "string" ? s : JSON.stringify(s),
        status: "success",
        duration: Date.now() - i
      }), s;
    } catch (s) {
      throw this.logReceive(r, {
        status: "error",
        error: s instanceof Error ? s.message : String(s),
        duration: Date.now() - i
      }), s;
    }
  }
  /**
   * 
   */
  getAll() {
    return [...this.entries];
  }
  /**
   * +
   */
  getPaired() {
    const t = [], n = this.entries.filter((r) => r.direction === "sent");
    for (const r of n) {
      const i = this.entries.find(
        (s) => s.id === `${r.id}_recv` && s.direction === "received"
      );
      t.push({ sent: r, received: i });
    }
    return t;
  }
  /**
   * 
   */
  clear() {
    this.entries = [], this.notifyListeners();
  }
  /**
   * 
   */
  subscribe(t) {
    return this.listeners.add(t), () => this.listeners.delete(t);
  }
  /**
   * 
   */
  getCount() {
    return this.entries.filter((t) => t.direction === "sent").length;
  }
  /**
   * 
   */
  trimEntries() {
    this.entries.length > QN * 2 && (this.entries = this.entries.slice(0, QN * 2));
  }
  /**
   * 
   */
  notifyListeners() {
    for (const t of this.listeners)
      t();
  }
}
const oh = new ure();
class nx {
  constructor() {
    lt(this, "name", "LlmRequest");
  }
  async execute(t) {
    var a;
    if (!t.prompt)
      throw new Error("LlmRequest: Prompt  (previous step missing?)");
    const { system: n, user: r } = t.prompt, i = oh.logSend({
      type: t.config.logType || "generation",
      //  config 
      systemPrompt: n,
      userPrompt: r,
      model: BP() || "Unknown",
      character: (a = Qb()) == null ? void 0 : a.name,
      floorRange: t.input.range
    }), s = Date.now();
    try {
      const u = await sL.generate({
        systemPrompt: n,
        userPrompt: r,
        // presetId: context.config.presetId // TODO:  Workflow Config  LLM Preset
        internal: !0
        //  Preprocessor
      });
      if (oh.logReceive(i, {
        response: u.content,
        status: u.success ? "success" : "error",
        error: u.error,
        duration: Date.now() - s
      }), !u.success)
        throw new Error(u.error || "LLM Generation Failed");
      t.llmResponse = {
        content: u.content,
        success: !0,
        tokenUsage: u.tokenUsage
      }, ee.debug("LlmRequest", "LLM ", { duration: Date.now() - s });
    } catch (u) {
      const d = u instanceof Error ? u.message : String(u);
      throw oh.logReceive(i, {
        status: "error",
        error: d,
        duration: Date.now() - s
      }), u;
    }
  }
}
class Km {
  constructor() {
    lt(this, "name", "StopGeneration");
  }
  async execute(t) {
    ee.info(Fe.SYSTEM, " StopGeneration "), await Km.abort();
  }
  /**
   * 
   */
  static async abort() {
    var t, n;
    try {
      const r = (n = (t = window.SillyTavern) == null ? void 0 : t.getContext) == null ? void 0 : n.call(t);
      r != null && r.stopGeneration ? (r.stopGeneration(), ee.info(Fe.SYSTEM, " stopGeneration")) : ee.warn(Fe.SYSTEM, "StopGeneration :  stopGeneration ");
    } catch (r) {
      ee.warn(Fe.SYSTEM, " stopGeneration ", r);
    }
  }
}
const cre = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  StopGeneration: Km
}, Symbol.toStringTag, { value: "Module" }));
class sw {
  constructor(t) {
    lt(this, "name", "UserReview");
    this.config = t;
  }
  async execute(t) {
    var s, a;
    if (!t.config.previewEnabled) {
      t.output = t.cleanedContent || ((s = t.llmResponse) == null ? void 0 : s.content);
      return;
    }
    const n = t.cleanedContent || ((a = t.llmResponse) == null ? void 0 : a.content) || "", r = await Ba.countTokens(n), i = t.input.range ? `${t.input.range[0]} - ${t.input.range[1]} ` : "";
    ee.info("UserReview", "...");
    try {
      const u = await IG.requestRevision(
        this.config.title,
        this.config.description || `: ${i} | Token: ${r}`,
        n,
        ["confirm", "skip", "reject"]
      );
      return u.action === "skip" ? (ee.info("UserReview", " ( AI )"), t.output = u.content, t.metadata.skipToInjection = !0, { action: "finish" }) : u.action === "reject" ? (ee.info("UserReview", ""), t.input.feedback = u.feedback, t.input.previousOutput = n, { action: "jump", targetStep: "BuildPrompt", reason: "User rejected" }) : (t.cleanedContent = u.content, t.output = u.content, ee.info("UserReview", ""), { action: "next" });
    } catch {
      throw ee.warn("UserReview", ""), xn.info("", ""), new Error("UserCancelled");
    }
  }
}
const m_ = {
  openai: "https://api.openai.com/v1/embeddings",
  ollama: "http://localhost:11434/api/embeddings",
  vllm: "http://localhost:8000/v1/embeddings",
  cohere: "https://api.cohere.ai/v1/embed",
  jina: "https://api.jina.ai/v1/embeddings",
  voyage: "https://api.voyageai.com/v1/embeddings"
}, dre = 5;
class fre {
  constructor() {
    lt(this, "config", null);
    lt(this, "concurrency", dre);
    lt(this, "stopSignal", !1);
  }
  /**
   * 
   */
  setConfig(t) {
    this.config = t;
  }
  /**
   * 
   */
  setConcurrency(t) {
    this.concurrency = Math.max(1, Math.min(20, t));
  }
  /**
   * 
   */
  stop() {
    this.stopSignal = !0;
  }
  /**
   * 
   */
  reset() {
    this.stopSignal = !1;
  }
  // ====================  ====================
  /**
   * 
   */
  async embed(t) {
    if (!this.config)
      throw new Error("EmbeddingService: config not set");
    const n = await this.embedBatch([{ id: "single", text: t }]);
    if (n[0].error)
      throw new Error(n[0].error);
    return n[0].embedding;
  }
  /**
   *  ()
   */
  async embedBatch(t, n) {
    if (!this.config)
      throw new Error("EmbeddingService: config not set");
    this.stopSignal = !1;
    const r = new Array(t.length);
    let i = 0, s = 0;
    const a = async (u) => {
      if (u >= t.length || this.stopSignal) return;
      const d = t[u];
      try {
        const f = await this.callEmbeddingAPI(d.text);
        r[u] = { id: d.id, embedding: f };
      } catch (f) {
        s++, r[u] = { id: d.id, embedding: [], error: f.message }, ee.warn(Fe.RAG_EMBED, `: ${d.id}`, { error: f.message });
      } finally {
        i++, n == null || n(i, t.length, s);
      }
    };
    for (let u = 0; u < t.length && !this.stopSignal; u += this.concurrency) {
      const d = Array.from(
        { length: Math.min(this.concurrency, t.length - u) },
        (f, h) => a(u + h)
      );
      await Promise.all(d);
    }
    return r;
  }
  /**
   *  API
   */
  async callEmbeddingAPI(t) {
    const n = this.config;
    switch (n.source) {
      case "openai":
      case "custom":
      case "vllm":
      case "jina":
      case "voyage":
        return this.callOpenAICompatible(t, n);
      case "ollama":
        return this.callOllama(t, n);
      case "cohere":
        return this.callCohere(t, n);
      case "transformers":
        return this.callTransformers(t, n);
      default:
        throw new Error(`Unsupported vector source: ${n.source}`);
    }
  }
  /**
   * OpenAI  API 
   */
  async callOpenAICompatible(t, n) {
    let r = n.apiUrl || m_[n.source] || "";
    if (r && (r = r.replace(/\/+$/, "")), n.autoSuffix !== !1 && n.source !== "ollama" && (r.includes("/embeddings") || (r = `${r}/embeddings`)), !r)
      throw new Error("API endpoint not configured");
    const i = {
      "Content-Type": "application/json"
    };
    n.apiKey && (i.Authorization = `Bearer ${n.apiKey}`);
    const s = {
      model: n.model || "text-embedding-3-small",
      input: t
    };
    n.dimensions && (s.dimensions = n.dimensions);
    try {
      const a = await fetch(r, {
        method: "POST",
        headers: i,
        body: JSON.stringify(s)
      });
      if (!a.ok) {
        const d = await a.text();
        throw new Error(`API error ${a.status} at ${r}: ${d}`);
      }
      const u = await a.json();
      if (!u.data || u.data.length === 0)
        throw new Error("No embedding data returned");
      return u.data[0].embedding;
    } catch (a) {
      throw a.message.includes("at http") ? a : new Error(`Request to ${r} failed: ${a.message}`);
    }
  }
  /**
   * Ollama API 
   */
  async callOllama(t, n) {
    const r = n.apiUrl || m_.ollama, i = r.includes("/api/embed") && !r.includes("/api/embeddings"), s = {
      model: n.model || "nomic-embed-text"
    };
    i ? s.input = t : s.prompt = t;
    const a = await fetch(r, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(s)
    });
    if (!a.ok) {
      const d = await a.text();
      throw new Error(`Ollama error ${a.status}: ${d}`);
    }
    const u = await a.json();
    if (u.embedding)
      return u.embedding;
    if (u.embeddings && u.embeddings.length > 0)
      return u.embeddings[0];
    throw new Error(`No embedding data returned in Ollama response. Keys: ${Object.keys(u).join(", ")}`);
  }
  /**
   * Cohere API 
   */
  async callCohere(t, n) {
    const r = m_.cohere, i = await fetch(r, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        Authorization: `Bearer ${n.apiKey}`
      },
      body: JSON.stringify({
        model: n.model || "embed-multilingual-v3.0",
        texts: [t],
        input_type: "search_document"
      })
    });
    if (!i.ok) {
      const a = await i.text();
      throw new Error(`Cohere error ${i.status}: ${a}`);
    }
    const s = await i.json();
    if (!s.embeddings || s.embeddings.length === 0)
      throw new Error("No embedding data returned");
    return s.embeddings[0];
  }
  /**
   *  Transformers  ()
   */
  async callTransformers(t, n) {
    throw new Error("Transformers embedding not yet implemented");
  }
  // ==================== EventNode  ====================
  /**
   *  EventNode 
   * @param onProgress 
   * @returns 
   */
  async embedUnprocessedEvents(t) {
    const n = xi();
    if (!n)
      throw new Error("No current chat");
    const r = Jo(n), i = await r.events.filter((f) => !f.is_embedded && !f.embedding).toArray();
    if (i.length === 0)
      return { success: 0, failed: 0 };
    ee.info(Fe.RAG_EMBED, ` ${i.length} `);
    const s = i.map((f) => ({
      id: f.id,
      text: f.summary
    })), a = await this.embedBatch(s, t);
    let u = 0, d = 0;
    for (const f of a) {
      if (f.error || f.embedding.length === 0) {
        d++;
        continue;
      }
      await r.events.update(f.id, {
        embedding: f.embedding,
        is_embedded: !0
      }), u++;
    }
    return ee.info(Fe.RAG_EMBED, `: ${u} , ${d} `), { success: u, failed: d };
  }
  /**
   * 
   */
  async embedEvents(t, n) {
    if (t.length === 0)
      return { success: 0, failed: 0 };
    const r = xi();
    if (!r) throw new Error("No current chat");
    const i = Jo(r), s = t.map((f) => ({
      id: f.id,
      text: f.summary
    })), a = await this.embedBatch(s, n);
    let u = 0, d = 0;
    for (const f of a) {
      if (f.error || f.embedding.length === 0) {
        d++;
        continue;
      }
      await i.events.update(f.id, {
        embedding: f.embedding,
        is_embedded: !0
      }), u++;
    }
    return { success: u, failed: d };
  }
  /**
   *  EventNode 
   */
  async embedEvent(t) {
    const n = await this.embed(t.summary), r = xi();
    if (r) {
      const i = vd(r);
      i && await i.events.update(t.id, {
        embedding: n,
        is_embedded: !0
      });
    }
    return n;
  }
  /**
   *  ()
   */
  async reembedAllEvents(t) {
    const n = xi();
    if (!n)
      throw new Error("No current chat");
    const r = Jo(n), i = await r.events.toArray();
    if (i.length === 0)
      return { success: 0, failed: 0 };
    ee.info(Fe.RAG_EMBED, ` ${i.length} `);
    for (const s of i)
      await r.events.update(s.id, {
        embedding: void 0,
        is_embedded: !1
      });
    return this.embedUnprocessedEvents(t);
  }
  // ====================  ====================
  /**
   *  (L2 Norm)
   */
  computeNorm(t) {
    let n = 0;
    for (let r = 0; r < t.length; r++)
      n += t[r] * t[r];
    return n;
  }
  /**
   * 
   * 
   *
   * @param vecA  A
   * @param vecB  B
   * @param normSqA ()  A 
   * @param normSqB ()  B 
   */
  cosineSimilarity(t, n, r, i) {
    if (!t || !n || t.length !== n.length) return 0;
    let s = 0, a = r ?? 0, u = i ?? 0;
    const d = r === void 0, f = i === void 0;
    for (let m = 0; m < t.length; m++)
      s += t[m] * n[m], d && (a += t[m] * t[m]), f && (u += n[m] * n[m]);
    const h = Math.sqrt(a) * Math.sqrt(u);
    return h === 0 ? 0 : s / h;
  }
  /**
   * 
   */
  async getEmbeddingStats() {
    const t = xi();
    if (!t)
      return { total: 0, embedded: 0, pending: 0 };
    const n = vd(t);
    if (!n)
      return { total: 0, embedded: 0, pending: 0 };
    const r = await n.events.toArray(), i = r.filter((s) => s.is_embedded).length;
    return {
      total: r.length,
      embedded: i,
      pending: r.length - i
    };
  }
}
const Vr = new fre(), ah = class ah {
  constructor() {
  }
  static getInstance() {
    return ah.instance || (ah.instance = new ah()), ah.instance;
  }
  /**
   *  Rerank 
   */
  getConfig() {
    const t = it.get("apiSettings");
    return (t == null ? void 0 : t.rerankConfig) || null;
  }
  /**
   *  Rerank 
   */
  isEnabled() {
    const t = this.getConfig();
    return !!(t != null && t.enabled && t.url && t.model);
  }
  /**
   *  Rerank API 
   *
   * @param query 
   * @param documents 
   * @returns 
   */
  async rerank(t, n) {
    var i;
    const r = this.getConfig();
    if (!(r != null && r.enabled))
      return ee.debug(Fe.RAG_RERANK, "Rerank "), n.map((s, a) => ({ index: a, relevance_score: 0 }));
    if (!r.url || !r.model)
      return ee.warn(Fe.RAG_RERANK, "Rerank ", { url: r.url, model: r.model }), n.map((s, a) => ({ index: a, relevance_score: 0 }));
    if (n.length === 0)
      return [];
    try {
      let s = r.url.replace(/\/+$/, "");
      r.autoSuffix !== !1 && !s.endsWith("/rerank") && (s = `${s}/rerank`), ee.debug(Fe.RAG_RERANK, " Rerank API", {
        endpoint: s,
        model: r.model,
        queryLength: t.length,
        documentCount: n.length
      });
      const a = await fetch(s, {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          ...r.apiKey && {
            Authorization: `Bearer ${r.apiKey}`
          }
        },
        body: JSON.stringify({
          model: r.model,
          query: t,
          documents: n,
          top_n: r.topN || 5
        })
      });
      if (!a.ok) {
        const f = await a.text();
        throw new Error(`Rerank API  (${a.status}): ${f}`);
      }
      const u = await a.json(), d = u.results || u.data || [];
      return ee.info(Fe.RAG_RERANK, "Rerank ", {
        resultCount: d.length,
        topScore: (i = d[0]) == null ? void 0 : i.relevance_score
      }), d.sort((f, h) => h.relevance_score - f.relevance_score);
    } catch (s) {
      const a = s instanceof Error ? s.message : "";
      return ee.error(Fe.RAG_RERANK, "Rerank ", { error: a }), n.map((u, d) => ({ index: d, relevance_score: 0 }));
    }
  }
  /**
   *  (alpha)
   * 0 = 1 =  Rerank 
   */
  getHybridAlpha() {
    const t = this.getConfig();
    return (t == null ? void 0 : t.hybridAlpha) ?? 0.5;
  }
};
lt(ah, "instance");
let G3 = ah;
const g_ = G3.getInstance();
function hre(e, t, n) {
  return e == null && t == null ? 0 : e == null ? t ?? 0 : t == null ? e : (1 - n) * e + n * t;
}
function K3(e, t) {
  var r;
  const n = e.map((i) => ({
    ...i,
    hybridScore: hre(
      i.embeddingScore,
      i.rerankScore,
      t
    )
  }));
  return n.sort((i, s) => (s.hybridScore ?? 0) - (i.hybridScore ?? 0)), ee.debug(Fe.RAG_RETRIEVE, "", {
    candidateCount: n.length,
    topScore: (r = n[0]) == null ? void 0 : r.hybridScore,
    alpha: t
  }), n;
}
function pre(e, t, n, r) {
  for (const s of t) {
    const a = n[s.index];
    if (a && e.has(a.id)) {
      const u = e.get(a.id);
      u.rerankScore = s.relevance_score;
    }
  }
  const i = Array.from(e.values());
  return K3(i, r);
}
class mre {
  constructor() {
    lt(this, "logs", []);
    lt(this, "maxLogs", 50);
    lt(this, "subscribers", /* @__PURE__ */ new Set());
  }
  /**
   * 
   */
  log(t) {
    const n = {
      id: `recall-${Date.now()}-${Math.random().toString(36).slice(2, 8)}`,
      timestamp: Date.now(),
      ...t
    };
    this.logs.unshift(n), this.logs.length > this.maxLogs && (this.logs = this.logs.slice(0, this.maxLogs)), ee.debug("RecallLogService", "", {
      query: t.query.substring(0, 50),
      resultCount: t.results.length
    }), this.notifySubscribers();
  }
  /**
   * 
   */
  getLogs() {
    return [...this.logs];
  }
  /**
   * 
   */
  clear() {
    this.logs = [], this.notifySubscribers();
  }
  /**
   * 
   */
  subscribe(t) {
    return this.subscribers.add(t), () => this.subscribers.delete(t);
  }
  /**
   * 
   */
  notifySubscribers() {
    const t = this.getLogs();
    this.subscribers.forEach((n) => n(t));
  }
  /**
   *  JSON 
   */
  exportLogs() {
    const { VERSION: t } = require("@/constants"), n = {
      version: t,
      exportedAt: Date.now(),
      logs: this.getLogs()
    }, r = new Blob([JSON.stringify(n, null, 2)], { type: "application/json" }), i = URL.createObjectURL(r), s = document.createElement("a");
    s.href = i, s.download = `engram_debug_log_${(/* @__PURE__ */ new Date()).toISOString().replace(/[:.]/g, "-")}.json`, document.body.appendChild(s), s.click(), document.body.removeChild(s), URL.revokeObjectURL(i);
  }
}
const F1 = new mre();
class aL {
  constructor() {
    lt(this, "shortTermMemory", /* @__PURE__ */ new Map());
    lt(this, "currentRound", 0);
    lt(this, "config", Yb);
    ee.debug(Fe.RAG_CACHE, " (V1.3.1)");
  }
  setConfig(t) {
    this.config = t;
  }
  getConfig() {
    return this.config;
  }
  nextRound() {
    this.currentRound++, ee.debug(Fe.RAG_CACHE, ` ${this.currentRound} `);
  }
  getCurrentRound() {
    return this.currentRound;
  }
  sigmoid(t, n) {
    return 1 / (1 + Math.exp(-t / n));
  }
  /**
   * 
   */
  process(t) {
    if (!this.config.enabled)
      return t.slice(0, this.config.workingLimit).map((u) => ({
        id: u.id,
        label: u.label || u.id,
        embeddingStrength: u.embeddingScore,
        rerankStrength: u.rerankScore || 0,
        finalScore: u.embeddingScore * 0.4 + (u.rerankScore || 0) * 0.6,
        firstRound: this.currentRound,
        lastRound: this.currentRound,
        recallCount: 1,
        consecutiveWorkingCount: 1,
        tier: "working",
        embeddingVector: u.embeddingVector
      }));
    const n = new Set(t.map((u) => u.id)), r = new Map(t.map((u) => [u.id, u]));
    this.shouldTriggerDecayBomb(t) && (ee.info(Fe.RAG_CACHE, " Decay Bomb"), this.decayBomb());
    for (const [u, d] of this.shortTermMemory)
      if (n.has(u)) {
        const f = r.get(u);
        f.embeddingVector && (d.embeddingVector = f.embeddingVector), f.label && (d.label = f.label), this.reinforceSlot(d, f), d.lastRound = this.currentRound, d.recallCount++;
      } else
        this.decaySlot(d);
    let i = 0;
    for (const u of t)
      if (!this.shortTermMemory.has(u.id)) {
        const d = {
          id: u.id,
          label: u.label || u.id,
          // V1.3.4:  label
          embeddingStrength: u.embeddingScore,
          rerankStrength: u.rerankScore || 0,
          finalScore: 0,
          firstRound: this.currentRound,
          lastRound: this.currentRound,
          recallCount: 1,
          consecutiveWorkingCount: 0,
          tier: "shortTerm",
          embeddingVector: u.embeddingVector
        };
        this.calculateFinalScore(d), this.shortTermMemory.set(u.id, d), i++;
      }
    ee.debug(Fe.RAG_CACHE, `Added ${i} new items. Current Size: ${this.shortTermMemory.size}`);
    const s = this.shortTermMemory.size;
    this.evict(), ee.debug(Fe.RAG_CACHE, `Evicted ${s - this.shortTermMemory.size} items. Current Size: ${this.shortTermMemory.size}`), this.enforceShortTermLimit();
    const a = this.selectWorkingMemoryMMR();
    return this.updateConsecutiveCounts(a), ee.info(Fe.RAG_CACHE, "", {
      round: this.currentRound,
      shortTermSize: this.shortTermMemory.size,
      workingSize: a.length
    }), a;
  }
  /**
   *  (V1.3.3:  Gate )
   * 
   */
  reinforceSlot(t, n) {
    const r = this.config.reinforceFactor || 0.2, i = this.config.maxDamping || 0.1;
    t.embeddingStrength = Math.max(t.embeddingStrength, n.embeddingScore);
    const s = r * (1 - t.rerankStrength), a = Math.min(s, i);
    t.rerankStrength += a, this.calculateFinalScore(t);
  }
  decaySlot(t) {
    const n = this.config.decayRate || 0.08;
    t.embeddingStrength = Math.max(0, t.embeddingStrength - n * 0.5), t.rerankStrength = Math.max(0, t.rerankStrength - n), this.calculateFinalScore(t);
  }
  calculateFinalScore(t) {
    const n = this.config.sigmoidTemperature || 0.15, r = Math.min(0.95, t.rerankStrength), a = (Math.max(r, t.embeddingStrength * 0.8) - 0.35) / n;
    t.finalScore = this.sigmoid(a, n);
  }
  evict() {
    const t = this.config.evictionThreshold;
    for (const [n, r] of this.shortTermMemory)
      r.firstRound !== this.currentRound && r.finalScore < t && this.shortTermMemory.delete(n);
  }
  enforceShortTermLimit() {
    const t = this.config.shortTermLimit;
    if (this.shortTermMemory.size <= t) return;
    const r = Array.from(this.shortTermMemory.values()).sort((i, s) => i.finalScore - s.finalScore).slice(0, this.shortTermMemory.size - t);
    for (const i of r)
      this.shortTermMemory.delete(i.id);
  }
  /**
   * V1.3.1: MMR + Sorting Logic
   */
  selectWorkingMemoryMMR() {
    const t = this.config.workingLimit, n = this.config.mmrThreshold || 0.85, r = this.config.newcomerBoost || 0.2, i = this.config.boredomPenalty || 0.1, s = this.config.boredomThreshold || 5, a = Array.from(this.shortTermMemory.values()).map((d) => {
      const f = d.firstRound === this.currentRound ? r : 0, m = Math.max(0, d.consecutiveWorkingCount - s) * i, x = d.finalScore + f - m;
      return { slot: d, sortScore: x };
    });
    a.sort((d, f) => f.sortScore - d.sortScore);
    const u = [];
    for (const d of a) {
      if (u.length >= t) break;
      const f = d.slot;
      let h = !1;
      if (f.embeddingVector && u.length > 0)
        for (const m of u) {
          if (!m.embeddingVector) continue;
          if (Vr.cosineSimilarity(f.embeddingVector, m.embeddingVector) > n) {
            h = !0;
            break;
          }
        }
      h ? f.tier = "shortTerm" : (u.push(f), f.tier = "working");
    }
    return u;
  }
  updateConsecutiveCounts(t) {
    const n = new Set(t.map((r) => r.id));
    for (const [r, i] of this.shortTermMemory)
      n.has(r) ? i.consecutiveWorkingCount++ : i.consecutiveWorkingCount = 0;
  }
  shouldTriggerDecayBomb(t) {
    if (this.shortTermMemory.size === 0 || t.length === 0) return !1;
    const n = new Set(t.map((d) => d.id));
    let r = 0, i = 0, s = 0;
    for (const [d, f] of this.shortTermMemory)
      if (n.has(d)) {
        r++, i += f.embeddingStrength;
        const h = t.find((m) => m.id === d);
        h && (s += h.embeddingScore);
      }
    if (r === 0) return !0;
    const a = i / r, u = s / r;
    return a < 0.01 ? !1 : u / a < this.config.contextSwitchThreshold;
  }
  decayBomb() {
    for (const [t, n] of this.shortTermMemory)
      n.rerankStrength *= 0.5, n.embeddingStrength *= 0.8, n.consecutiveWorkingCount = 0, this.calculateFinalScore(n);
    this.evict();
  }
  hardReset() {
    this.shortTermMemory.clear(), this.currentRound = 0, ee.info(Fe.RAG_CACHE, "hardReset: ");
  }
  getShortTermSnapshot() {
    return Array.from(this.shortTermMemory.values()).sort((t, n) => n.finalScore - t.finalScore);
  }
}
const pd = new aL(), oL = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  BrainRecallCache: aL,
  brainRecallCache: pd
}, Symbol.toStringTag, { value: "Module" }));
class gre {
  /**
   * 
   */
  getRecallConfig() {
    const t = it.get("apiSettings");
    return (t == null ? void 0 : t.recallConfig) || Wb;
  }
  /**
   * 
   * 
   */
  async hasVectorizedNodes() {
    const t = xi();
    if (!t) return !1;
    const n = vd(t);
    return n ? await n.events.filter((i) => !!i.embedding && i.embedding.length > 0).limit(1).count() > 0 : !1;
  }
  /**
   * 
   */
  getVectorConfig() {
    const t = it.get("apiSettings");
    return t == null ? void 0 : t.vectorConfig;
  }
  /**
   *  Rerank 
   */
  getRerankConfig() {
    const t = it.get("apiSettings");
    return (t == null ? void 0 : t.rerankConfig) || null;
  }
  /**
   * 
   *
   * @param userInput 
   * @param unifiedQueries  ()
   * @returns 
   */
  async search(t, n) {
    var s, a, u;
    const r = this.getRecallConfig(), i = this.getVectorConfig();
    if (r.useEmbedding && i && Vr.setConfig(i), !r.enabled) {
      ee.debug(Fe.RAG_RETRIEVE, "");
      const d = ((s = r.embedding) == null ? void 0 : s.topK) || 20;
      return this.rollingSearch(d);
    }
    if (r.useBruteForce) {
      ee.debug(Fe.RAG_RETRIEVE, " ()");
      const d = ((a = r.embedding) == null ? void 0 : a.topK) || 20;
      return this.rollingSearch(d);
    }
    return r.useEmbedding ? this.hybridSearch(t, n, r) : this.rollingSearch(((u = r.embedding) == null ? void 0 : u.topK) || 20);
  }
  /**
   * Embedding + Rerank
   */
  async hybridSearch(t, n, r) {
    const i = Date.now(), s = Date.now(), a = await this.doEmbeddingSearch(
      t,
      n,
      r
    ), u = Date.now() - s;
    if (a.length === 0)
      return ee.debug(Fe.RAG_RETRIEVE, "Embedding "), { entries: [], nodes: [] };
    let d = a, f = 0;
    if (r.useRerank && g_.isEnabled()) {
      const S = Date.now(), C = (n == null ? void 0 : n[0]) || t, T = a.map((P) => P.summary), R = await g_.rerank(C, T);
      f = Date.now() - S;
      const N = new Map(a.map((P) => [P.id, P])), M = g_.getHybridAlpha();
      d = pre(
        N,
        R,
        a,
        M
      ), ee.info(Fe.RAG_RETRIEVE, "", {
        embeddingCount: a.length,
        rerankCount: R.length,
        finalCount: d.length,
        embeddingTime: u,
        rerankTime: f
      });
    } else
      d = K3(a, 0);
    const h = r.brainRecall || Yb;
    if (h.enabled) {
      pd.setConfig(h), pd.nextRound();
      const S = d.map((R) => {
        var M, P, D;
        let N = R.rerankScore;
        return N === void 0 && r.useRerank && (N = Math.min(0.8, R.embeddingScore || 0)), {
          id: R.id,
          // V1.3.4:  ( Brain Recall UI)
          label: ((P = (M = R.node) == null ? void 0 : M.structured_kv) == null ? void 0 : P.event) || R.summary.slice(0, 10),
          embeddingScore: R.embeddingScore || 0,
          rerankScore: N,
          // V1.3:  MMR
          embeddingVector: (D = R.node) == null ? void 0 : D.embedding
        };
      }), C = pd.process(S), T = new Map(d.map((R) => [R.id, R]));
      d = C.filter((R) => T.has(R.id)).map((R) => ({
        ...T.get(R.id),
        hybridScore: R.finalScore
        // V1.2:  finalScore 
      })), ee.info(Fe.RAG_RETRIEVE, "", {
        inputCount: S.length,
        outputCount: d.length,
        round: pd.getCurrentRound()
      });
    }
    const m = Date.now() - i, x = h.enabled ? {
      round: pd.getCurrentRound(),
      snapshot: pd.getShortTermSnapshot()
    } : void 0;
    F1.log({
      query: t,
      preprocessedQuery: n == null ? void 0 : n[0],
      mode: "hybrid",
      results: d.map((S) => {
        var C, T, R, N;
        return {
          eventId: S.id,
          summary: S.summary,
          category: ((T = (C = S.node) == null ? void 0 : C.structured_kv) == null ? void 0 : T.event) || "unknown",
          embeddingScore: S.embeddingScore || 0,
          rerankScore: S.rerankScore,
          hybridScore: S.hybridScore,
          isTopK: !0,
          isReranked: S.rerankScore != null,
          sourceFloor: (N = (R = S.node) == null ? void 0 : R.source_range) == null ? void 0 : N.start_index
        };
      }),
      stats: {
        totalCandidates: a.length,
        topKCount: a.length,
        rerankCount: d.length,
        latencyMs: m
      },
      brainStats: x
      // V1.3.1: 
    });
    const b = d.filter((S) => S.node).map((S) => S.node), w = d.map((S) => S.summary);
    return ee.info(Fe.RAG_RETRIEVE, "", {
      useEmbedding: r.useEmbedding,
      useRerank: r.useRerank,
      totalTime: m,
      resultCount: b.length
    }), { entries: w, nodes: b };
  }
  /**
   *  Embedding  ()
   */
  async embeddingOnlySearch(t, n, r) {
    const i = await this.doEmbeddingSearch(t, n, r), s = K3(i, 0), a = s.filter((d) => d.node).map((d) => d.node);
    return { entries: s.map((d) => d.summary), nodes: a };
  }
  /**
   *  Embedding 
   */
  async doEmbeddingSearch(t, n, r) {
    var m, x, b;
    const i = xi();
    if (!i)
      return [];
    const s = vd(i);
    if (!s)
      return [];
    const a = await s.events.filter((w) => !!w.embedding && w.embedding.length > 0).toArray();
    if (a.length === 0)
      return ee.debug(Fe.RAG_RETRIEVE, ""), [];
    const u = n && n.length > 0 ? n : [t];
    ee.debug(Fe.RAG_RETRIEVE, "", {
      queryCount: u.length,
      eventCount: a.length
    });
    const d = /* @__PURE__ */ new Map(), f = await Promise.all(
      u.map(async (w) => {
        try {
          const S = await Vr.embed(w), C = Vr.computeNorm(S);
          return { query: w, vector: S, normSq: C };
        } catch (S) {
          return ee.error(Fe.RAG_RETRIEVE, `Query : ${w}`, {
            message: (S == null ? void 0 : S.message) || S
          }), null;
        }
      })
    );
    for (const w of f) {
      if (!w) continue;
      const { vector: S, normSq: C } = w;
      for (const T of a) {
        if (!T.embedding) continue;
        const R = Vr.cosineSimilarity(
          S,
          T.embedding,
          C,
          void 0
          // Event Norm 
        ), N = ((m = r.embedding) == null ? void 0 : m.minScoreThreshold) ?? 0.3;
        if (R < N) continue;
        const M = d.get(T.id);
        (!M || R > (M.embeddingScore || 0)) && d.set(T.id, {
          id: T.id,
          summary: T.summary,
          embeddingScore: R,
          node: T
        });
      }
    }
    this.getVectorConfig();
    const h = Array.from(d.values()).sort((w, S) => (S.embeddingScore || 0) - (w.embeddingScore || 0)).slice(0, ((x = r == null ? void 0 : r.embedding) == null ? void 0 : x.topK) || 20);
    return ee.debug(Fe.RAG_RETRIEVE, "Embedding ", {
      totalMatched: d.size,
      topK: h.length,
      topScore: (b = h[0]) == null ? void 0 : b.embeddingScore
    }), h;
  }
  /**
   *  ()
   * 
   */
  async rollingSearch(t) {
    const n = xi();
    if (!n)
      return { entries: [], nodes: [] };
    const r = vd(n);
    if (!r)
      return { entries: [], nodes: [] };
    const i = await r.events.filter((d) => d.level === 0).reverse().limit(t).toArray(), s = await r.events.filter((d) => d.level === 1).reverse().first(), a = [...i];
    return s && a.unshift(s), { entries: a.map((d) => d.summary), nodes: a };
  }
  /**
   * @deprecated  search() 
   */
  async vectorSearch(t, n) {
    return this.search(t);
  }
}
const Y3 = new gre();
class yre {
  constructor() {
    lt(this, "isInitialized", !1);
    lt(this, "isProcessing", !1);
    // 
    lt(this, "cacheInvalid", !1);
  }
  // V0.9.5:  true
  /**
   * Initialize the Injector
   */
  init() {
    this.isInitialized || (ee.info(Fe.RAG_INJECT, " V0.8 ..."), console.log("[Injector] Starting initialization..."), ao.on(
      Qo.GENERATION_AFTER_COMMANDS,
      async (t, n, r) => {
        console.log("[Injector]  GENERATION_AFTER_COMMANDS triggered", { type: t, dryRun: r }), ee.debug(Fe.RAG_INJECT, " GENERATION_AFTER_COMMANDS", { type: t }), await this.handleGenerationAfterCommands(t, n, r);
      }
    ), ao.on(Qo.CHAT_CHANGED, () => {
      ee.debug(Fe.RAG_INJECT, " CHAT_CHANGED "), this.isProcessing = !1, this.cacheInvalid = !1, Ds.refreshCache().catch((t) => {
        ee.warn(Fe.RAG_INJECT, "", t);
      });
    }), ao.on(Qo.MESSAGE_EDITED, (...t) => {
      var s;
      const n = t[0], r = ma(), i = (s = r == null ? void 0 : r.chat) == null ? void 0 : s[n];
      i != null && i.is_user && (this.cacheInvalid = !0, ee.info(Fe.RAG_INJECT, "", { msgIndex: n }));
    }), this.isInitialized = !0, ee.success(Fe.RAG_INJECT, "V0.8 Injector "), console.log("[Injector]  V0.8 Initialized - Listening for GENERATION_AFTER_COMMANDS"));
  }
  /**
   *  GENERATION_AFTER_COMMANDS 
   *  async  await
   */
  async handleGenerationAfterCommands(t, n, r) {
    try {
      if (r) {
        ee.debug(Fe.RAG_INJECT, "dryRun ");
        return;
      }
      if (t === "quiet" || t === "impersonate") {
        ee.debug(Fe.RAG_INJECT, ` ${t} `);
        return;
      }
      if (t === "regenerate" || t === "swipe") {
        if (!this.cacheInvalid) {
          ee.debug(Fe.RAG_INJECT, `${t} `);
          return;
        }
        ee.info(Fe.RAG_INJECT, `${t} `);
      }
      if (n._engram_processed) {
        ee.debug(Fe.RAG_INJECT, "");
        return;
      }
      if (this.isProcessing) {
        ee.debug(Fe.RAG_INJECT, "");
        return;
      }
      if (n._engram_internal) {
        ee.debug(Fe.RAG_INJECT, "");
        return;
      }
      if (!xi()) {
        ee.warn(Fe.RAG_INJECT, " ID");
        return;
      }
      const s = ma();
      if (!s || !s.chat || s.chat.length === 0) {
        ee.warn(Fe.RAG_INJECT, "");
        return;
      }
      const a = s.chat, u = a.length - 1, d = a[u];
      let f = "", h = "chat";
      if (d && d.is_user) {
        if (d._engram_processed) {
          ee.debug(Fe.RAG_INJECT, " (Prevent Re-entry)", {
            index: u
          });
          return;
        }
        f = d.mes;
      } else {
        const C = document.getElementById("send_textarea");
        if (C && C.value && C.value.trim().length > 0)
          f = C.value, h = "textarea", ee.info(Fe.RAG_INJECT, " Textarea  (Strategy 2)", {
            preview: f.substring(0, 50)
          });
        else {
          ee.debug(Fe.RAG_INJECT, "", {
            index: u,
            isUser: d == null ? void 0 : d.is_user
          });
          return;
        }
      }
      if (!f || f.trim().length === 0) {
        ee.debug(Fe.RAG_INJECT, "");
        return;
      }
      let m, x, b;
      try {
        if (m = it.get("apiSettings"), x = (m == null ? void 0 : m.recallConfig) || Wb, !hh)
          throw new Error("Preprocessor service is undefined");
        b = hh.getConfig();
      } catch (C) {
        throw ee.error(Fe.RAG_INJECT, "", C), C;
      }
      if (ee.info(Fe.RAG_INJECT, "", {
        inputLength: f.length,
        recall: x.enabled,
        preprocess: x.usePreprocessing && b.enabled
      }), x.usePreprocessing && b.enabled && !b.autoTrigger && (ee.debug(Fe.RAG_INJECT, " autoTrigger "), !x.enabled))
        return;
      this.isProcessing = !0, this.cacheInvalid = !1, n._engram_processed = !0, d && (d._engram_processed = !0);
      let w = f, S = [];
      try {
        if (x.usePreprocessing && b.enabled && b.autoTrigger)
          try {
            Ds.setUserInput(f), await Ds.refreshCache();
            const C = await hh.process(f);
            if (C.success && C.output) {
              ee.success(Fe.RAG_INJECT, "", {
                outputLength: C.output.length
              });
              const T = it.getPromptTemplateById(b.templateId), R = (T == null ? void 0 : T.injectionMode) || "replace";
              R === "append" ? w = `${f}

${C.output}` : R === "prepend" ? w = `${C.output}

${f}` : w = C.output, C.query && S.push(C.query);
            } else
              ee.warn(Fe.RAG_INJECT, "");
          } catch (C) {
            ee.warn(Fe.RAG_INJECT, " ", C);
          }
        if (x.enabled)
          try {
            if (!await Y3.hasVectorizedNodes())
              ee.debug(Fe.RAG_INJECT, " RAG");
            else {
              ee.debug(Fe.RAG_INJECT, " RAG ");
              const T = await Y3.search(
                f,
                S.length > 0 ? S : void 0
              );
              T.nodes.length > 0 ? (ee.success(Fe.RAG_INJECT, "RAG ", {
                nodeCount: T.nodes.length
              }), await Ds.refreshCacheWithNodes(T.nodes)) : ee.debug(Fe.RAG_INJECT, "RAG ");
            }
          } catch (C) {
            ee.error(Fe.RAG_INJECT, "RAG ", C);
          }
        if (w = Wm.process(w, "output"), w !== f) {
          if (h === "chat") {
            d.mes = w;
            try {
              const C = s.eventSource, T = s.event_types;
              C && (T != null && T.MESSAGE_UPDATED) && (C.emit(T.MESSAGE_UPDATED, u), ee.debug(Fe.RAG_INJECT, " MESSAGE_UPDATED "));
            } catch (C) {
              ee.warn(Fe.RAG_INJECT, " MESSAGE_UPDATED ", C);
            }
            try {
              const C = document.getElementById("send_textarea");
              C && C.value === f && (C.value = "", C.dispatchEvent(new Event("input", { bubbles: !0 })));
            } catch {
            }
          } else if (h === "textarea") {
            ee.debug(Fe.RAG_INJECT, " Textarea");
            try {
              const C = document.getElementById("send_textarea");
              C && (C.value = w, C.dispatchEvent(new Event("input", { bubbles: !0 }))), n && (n.prompt = w);
            } catch (C) {
              ee.warn(Fe.RAG_INJECT, " Textarea ", C);
            }
          }
        }
      } finally {
        setTimeout(() => {
          this.isProcessing = !1;
        }, 1e3);
      }
    } catch (i) {
      this.isProcessing = !1, ee.error(Fe.RAG_INJECT, "handleGenerationAfterCommands ", {
        message: (i == null ? void 0 : i.message) || i,
        stack: i == null ? void 0 : i.stack
      }), console.error("[Injector] Error:", i);
    }
  }
}
const xre = new yre(), vre = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  injector: xre
}, Symbol.toStringTag, { value: "Module" }));
class lL {
  constructor() {
    lt(this, "name", "ApplyTrim");
  }
  async execute(t) {
    var h;
    if ((h = t.data) != null && h.skipTrimming)
      return;
    const n = vi.getState(), r = t.input.eventsToMerge, i = t.output;
    if (!i || !i.events || i.events.length === 0)
      throw new Error("ApplyTrim: ");
    const s = i.events[0], a = await n.saveEvent({
      summary: i.events.map((m) => m.summary).join(`

`),
      //  summary? 
      structured_kv: {
        time_anchor: s.meta.time_anchor || "",
        role: this.mergeArrays(r.map((m) => m.structured_kv.role)),
        location: Array.isArray(s.meta.location) ? s.meta.location : [s.meta.location].filter((m) => !!m),
        event: "",
        logic: this.mergeArrays(r.map((m) => m.structured_kv.logic)),
        causality: "Chain"
      },
      significance_score: Math.max(...r.map((m) => m.significance_score)),
      level: 1,
      // 
      is_embedded: !1,
      is_archived: !1,
      source_range: {
        start_index: Math.min(...r.map((m) => {
          var x;
          return ((x = m.source_range) == null ? void 0 : x.start_index) ?? 0;
        })),
        end_index: Math.max(...r.map((m) => {
          var x;
          return ((x = m.source_range) == null ? void 0 : x.end_index) ?? 0;
        }))
      }
    }), u = r.map((m) => m.id), d = it.get("apiSettings"), f = d == null ? void 0 : d.embeddingConfig;
    if (f != null && f.enabled && f.trigger === "with_trim") {
      ee.info("ApplyTrim", "", { count: r.length });
      try {
        await Vr.embedEvents(r), await n.markEventsAsEmbedded(u);
      } catch (m) {
        ee.error("ApplyTrim", "", { error: m }), xn.warning("", "Engram");
      }
    }
    await n.archiveEvents(u), await Ds.refreshCache(), ee.success("ApplyTrim", "", {
      merged: r.length,
      newEventId: a.id
    }), t.output = {
      newEvent: a,
      deletedCount: 0,
      sourceEventIds: u
    };
  }
  mergeArrays(t) {
    const n = /* @__PURE__ */ new Set();
    for (const r of t)
      for (const i of r)
        n.add(i);
    return Array.from(n);
  }
}
/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */
var bre = /* @__PURE__ */ (function() {
  var e = function(t, n) {
    return e = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var s in i) i.hasOwnProperty(s) && (r[s] = i[s]);
    }, e(t, n);
  };
  return function(t, n) {
    e(t, n);
    function r() {
      this.constructor = t;
    }
    t.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
})(), wre = Object.prototype.hasOwnProperty;
function _re(e, t) {
  return wre.call(e, t);
}
function Sre(e) {
  if (Array.isArray(e)) {
    for (var t = new Array(e.length), n = 0; n < t.length; n++)
      t[n] = "" + n;
    return t;
  }
  if (Object.keys)
    return Object.keys(e);
  var r = [];
  for (var i in e)
    _re(e, i) && r.push(i);
  return r;
}
function Dm(e) {
  switch (typeof e) {
    case "object":
      return JSON.parse(JSON.stringify(e));
    //Faster than ES5 clone - http://jsperf.com/deep-cloning-of-objects/5
    case "undefined":
      return null;
    //this is how JSON.stringify behaves for array items
    default:
      return e;
  }
}
function W3(e) {
  for (var t = 0, n = e.length, r; t < n; ) {
    if (r = e.charCodeAt(t), r >= 48 && r <= 57) {
      t++;
      continue;
    }
    return !1;
  }
  return !0;
}
function Ere(e) {
  return e.replace(/~1/g, "/").replace(/~0/g, "~");
}
function Z3(e) {
  if (e === void 0)
    return !0;
  if (e) {
    if (Array.isArray(e)) {
      for (var t = 0, n = e.length; t < n; t++)
        if (Z3(e[t]))
          return !0;
    } else if (typeof e == "object") {
      for (var r = Sre(e), i = r.length, s = 0; s < i; s++)
        if (Z3(e[r[s]]))
          return !0;
    }
  }
  return !1;
}
function JN(e, t) {
  var n = [e];
  for (var r in t) {
    var i = typeof t[r] == "object" ? JSON.stringify(t[r], null, 2) : t[r];
    typeof i < "u" && n.push(r + ": " + i);
  }
  return n.join(`
`);
}
var Cre = (
  /** @class */
  (function(e) {
    bre(t, e);
    function t(n, r, i, s, a) {
      var u = this.constructor, d = e.call(this, JN(n, { name: r, index: i, operation: s, tree: a })) || this;
      return d.name = r, d.index = i, d.operation = s, d.tree = a, Object.setPrototypeOf(d, u.prototype), d.message = JN(n, { name: r, index: i, operation: s, tree: a }), d;
    }
    return t;
  })(Error)
), Jr = Cre, om = {
  add: function(e, t, n) {
    return e[t] = this.value, { newDocument: n };
  },
  remove: function(e, t, n) {
    var r = e[t];
    return delete e[t], { newDocument: n, removed: r };
  },
  replace: function(e, t, n) {
    var r = e[t];
    return e[t] = this.value, { newDocument: n, removed: r };
  },
  move: function(e, t, n) {
    var r = X3(n, this.path);
    r && (r = Dm(r));
    var i = dy(n, { op: "remove", path: this.from }).removed;
    return dy(n, { op: "add", path: this.path, value: i }), { newDocument: n, removed: r };
  },
  copy: function(e, t, n) {
    var r = X3(n, this.from);
    return dy(n, { op: "add", path: this.path, value: Dm(r) }), { newDocument: n };
  },
  test: function(e, t, n) {
    return { newDocument: n, test: gb(e[t], this.value) };
  },
  _get: function(e, t, n) {
    return this.value = e[t], { newDocument: n };
  }
}, kre = {
  add: function(e, t, n) {
    return W3(t) ? e.splice(t, 0, this.value) : e[t] = this.value, { newDocument: n, index: t };
  },
  remove: function(e, t, n) {
    var r = e.splice(t, 1);
    return { newDocument: n, removed: r[0] };
  },
  replace: function(e, t, n) {
    var r = e[t];
    return e[t] = this.value, { newDocument: n, removed: r };
  },
  move: om.move,
  copy: om.copy,
  test: om.test,
  _get: om._get
};
function X3(e, t) {
  if (t == "")
    return e;
  var n = { op: "_get", path: t };
  return dy(e, n), n.value;
}
function dy(e, t, n, r, i, s) {
  if (n === void 0 && (n = !1), r === void 0 && (r = !0), i === void 0 && (i = !0), s === void 0 && (s = 0), n && (typeof n == "function" ? n(t, 0, e, t.path) : Q3(t, 0)), t.path === "") {
    var a = { newDocument: e };
    if (t.op === "add")
      return a.newDocument = t.value, a;
    if (t.op === "replace")
      return a.newDocument = t.value, a.removed = e, a;
    if (t.op === "move" || t.op === "copy")
      return a.newDocument = X3(e, t.from), t.op === "move" && (a.removed = e), a;
    if (t.op === "test") {
      if (a.test = gb(e, t.value), a.test === !1)
        throw new Jr("Test operation failed", "TEST_OPERATION_FAILED", s, t, e);
      return a.newDocument = e, a;
    } else {
      if (t.op === "remove")
        return a.removed = e, a.newDocument = null, a;
      if (t.op === "_get")
        return t.value = e, a;
      if (n)
        throw new Jr("Operation `op` property is not one of operations defined in RFC-6902", "OPERATION_OP_INVALID", s, t, e);
      return a;
    }
  } else {
    r || (e = Dm(e));
    var u = t.path || "", d = u.split("/"), f = e, h = 1, m = d.length, x = void 0, b = void 0, w = void 0;
    for (typeof n == "function" ? w = n : w = Q3; ; ) {
      if (b = d[h], b && b.indexOf("~") != -1 && (b = Ere(b)), i && (b == "__proto__" || b == "prototype" && h > 0 && d[h - 1] == "constructor"))
        throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");
      if (n && x === void 0 && (f[b] === void 0 ? x = d.slice(0, h).join("/") : h == m - 1 && (x = t.path), x !== void 0 && w(t, 0, e, x)), h++, Array.isArray(f)) {
        if (b === "-")
          b = f.length;
        else {
          if (n && !W3(b))
            throw new Jr("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index", "OPERATION_PATH_ILLEGAL_ARRAY_INDEX", s, t, e);
          W3(b) && (b = ~~b);
        }
        if (h >= m) {
          if (n && t.op === "add" && b > f.length)
            throw new Jr("The specified index MUST NOT be greater than the number of elements in the array", "OPERATION_VALUE_OUT_OF_BOUNDS", s, t, e);
          var a = kre[t.op].call(t, f, b, e);
          if (a.test === !1)
            throw new Jr("Test operation failed", "TEST_OPERATION_FAILED", s, t, e);
          return a;
        }
      } else if (h >= m) {
        var a = om[t.op].call(t, f, b, e);
        if (a.test === !1)
          throw new Jr("Test operation failed", "TEST_OPERATION_FAILED", s, t, e);
        return a;
      }
      if (f = f[b], n && h < m && (!f || typeof f != "object"))
        throw new Jr("Cannot perform operation at the desired path", "OPERATION_PATH_UNRESOLVABLE", s, t, e);
    }
  }
}
function uL(e, t, n, r, i) {
  if (r === void 0 && (r = !0), i === void 0 && (i = !0), n && !Array.isArray(t))
    throw new Jr("Patch sequence must be an array", "SEQUENCE_NOT_AN_ARRAY");
  r || (e = Dm(e));
  for (var s = new Array(t.length), a = 0, u = t.length; a < u; a++)
    s[a] = dy(e, t[a], n, !0, i, a), e = s[a].newDocument;
  return s.newDocument = e, s;
}
function Q3(e, t, n, r) {
  if (typeof e != "object" || e === null || Array.isArray(e))
    throw new Jr("Operation is not an object", "OPERATION_NOT_AN_OBJECT", t, e, n);
  if (om[e.op]) {
    if (typeof e.path != "string")
      throw new Jr("Operation `path` property is not a string", "OPERATION_PATH_INVALID", t, e, n);
    if (e.path.indexOf("/") !== 0 && e.path.length > 0)
      throw new Jr('Operation `path` property must start with "/"', "OPERATION_PATH_INVALID", t, e, n);
    if ((e.op === "move" || e.op === "copy") && typeof e.from != "string")
      throw new Jr("Operation `from` property is not present (applicable in `move` and `copy` operations)", "OPERATION_FROM_REQUIRED", t, e, n);
    if ((e.op === "add" || e.op === "replace" || e.op === "test") && e.value === void 0)
      throw new Jr("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)", "OPERATION_VALUE_REQUIRED", t, e, n);
    if ((e.op === "add" || e.op === "replace" || e.op === "test") && Z3(e.value))
      throw new Jr("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)", "OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED", t, e, n);
    if (n) {
      if (e.op == "add") {
        var i = e.path.split("/").length, s = r.split("/").length;
        if (i !== s + 1 && i !== s)
          throw new Jr("Cannot perform an `add` operation at the desired path", "OPERATION_PATH_CANNOT_ADD", t, e, n);
      } else if (e.op === "replace" || e.op === "remove" || e.op === "_get") {
        if (e.path !== r)
          throw new Jr("Cannot perform the operation at a path that does not exist", "OPERATION_PATH_UNRESOLVABLE", t, e, n);
      } else if (e.op === "move" || e.op === "copy") {
        var a = { op: "_get", path: e.from, value: void 0 }, u = Tre([a], n);
        if (u && u.name === "OPERATION_PATH_UNRESOLVABLE")
          throw new Jr("Cannot perform the operation from a path that does not exist", "OPERATION_FROM_UNRESOLVABLE", t, e, n);
      }
    }
  } else throw new Jr("Operation `op` property is not one of operations defined in RFC-6902", "OPERATION_OP_INVALID", t, e, n);
}
function Tre(e, t, n) {
  try {
    if (!Array.isArray(e))
      throw new Jr("Patch sequence must be an array", "SEQUENCE_NOT_AN_ARRAY");
    if (t)
      uL(Dm(t), Dm(e), n || !0);
    else {
      n = n || Q3;
      for (var r = 0; r < e.length; r++)
        n(e[r], r, t, void 0);
    }
  } catch (i) {
    if (i instanceof Jr)
      return i;
    throw i;
  }
}
function gb(e, t) {
  if (e === t)
    return !0;
  if (e && t && typeof e == "object" && typeof t == "object") {
    var n = Array.isArray(e), r = Array.isArray(t), i, s, a;
    if (n && r) {
      if (s = e.length, s != t.length)
        return !1;
      for (i = s; i-- !== 0; )
        if (!gb(e[i], t[i]))
          return !1;
      return !0;
    }
    if (n != r)
      return !1;
    var u = Object.keys(e);
    if (s = u.length, s !== Object.keys(t).length)
      return !1;
    for (i = s; i-- !== 0; )
      if (!t.hasOwnProperty(u[i]))
        return !1;
    for (i = s; i-- !== 0; )
      if (a = u[i], !gb(e[a], t[a]))
        return !1;
    return !0;
  }
  return e !== e && t !== t;
}
function Xe(e, t, n) {
  function r(u, d) {
    if (u._zod || Object.defineProperty(u, "_zod", {
      value: {
        def: d,
        constr: a,
        traits: /* @__PURE__ */ new Set()
      },
      enumerable: !1
    }), u._zod.traits.has(e))
      return;
    u._zod.traits.add(e), t(u, d);
    const f = a.prototype, h = Object.keys(f);
    for (let m = 0; m < h.length; m++) {
      const x = h[m];
      x in u || (u[x] = f[x].bind(u));
    }
  }
  const i = (n == null ? void 0 : n.Parent) ?? Object;
  class s extends i {
  }
  Object.defineProperty(s, "name", { value: e });
  function a(u) {
    var d;
    const f = n != null && n.Parent ? new s() : this;
    r(f, u), (d = f._zod).deferred ?? (d.deferred = []);
    for (const h of f._zod.deferred)
      h();
    return f;
  }
  return Object.defineProperty(a, "init", { value: r }), Object.defineProperty(a, Symbol.hasInstance, {
    value: (u) => {
      var d, f;
      return n != null && n.Parent && u instanceof n.Parent ? !0 : (f = (d = u == null ? void 0 : u._zod) == null ? void 0 : d.traits) == null ? void 0 : f.has(e);
    }
  }), Object.defineProperty(a, "name", { value: e }), a;
}
class bm extends Error {
  constructor() {
    super("Encountered Promise during synchronous parse. Use .parseAsync() instead.");
  }
}
class cL extends Error {
  constructor(t) {
    super(`Encountered unidirectional transform during encode: ${t}`), this.name = "ZodEncodeError";
  }
}
const dL = {};
function Cd(e) {
  return dL;
}
function fL(e) {
  const t = Object.values(e).filter((r) => typeof r == "number");
  return Object.entries(e).filter(([r, i]) => t.indexOf(+r) === -1).map(([r, i]) => i);
}
function J3(e, t) {
  return typeof t == "bigint" ? t.toString() : t;
}
function AT(e) {
  return {
    get value() {
      {
        const t = e();
        return Object.defineProperty(this, "value", { value: t }), t;
      }
    }
  };
}
function NT(e) {
  return e == null;
}
function RT(e) {
  const t = e.startsWith("^") ? 1 : 0, n = e.endsWith("$") ? e.length - 1 : e.length;
  return e.slice(t, n);
}
const e6 = Symbol("evaluating");
function Fn(e, t, n) {
  let r;
  Object.defineProperty(e, t, {
    get() {
      if (r !== e6)
        return r === void 0 && (r = e6, r = n()), r;
    },
    set(i) {
      Object.defineProperty(e, t, {
        value: i
        // configurable: true,
      });
    },
    configurable: !0
  });
}
function jh(e, t, n) {
  Object.defineProperty(e, t, {
    value: n,
    writable: !0,
    enumerable: !0,
    configurable: !0
  });
}
function Nd(...e) {
  const t = {};
  for (const n of e) {
    const r = Object.getOwnPropertyDescriptors(n);
    Object.assign(t, r);
  }
  return Object.defineProperties({}, t);
}
function t6(e) {
  return JSON.stringify(e);
}
function jre(e) {
  return e.toLowerCase().trim().replace(/[^\w\s-]/g, "").replace(/[\s_-]+/g, "-").replace(/^-+|-+$/g, "");
}
const hL = "captureStackTrace" in Error ? Error.captureStackTrace : (...e) => {
};
function yb(e) {
  return typeof e == "object" && e !== null && !Array.isArray(e);
}
const Are = AT(() => {
  var e;
  if (typeof navigator < "u" && ((e = navigator == null ? void 0 : navigator.userAgent) != null && e.includes("Cloudflare")))
    return !1;
  try {
    const t = Function;
    return new t(""), !0;
  } catch {
    return !1;
  }
});
function zm(e) {
  if (yb(e) === !1)
    return !1;
  const t = e.constructor;
  if (t === void 0 || typeof t != "function")
    return !0;
  const n = t.prototype;
  return !(yb(n) === !1 || Object.prototype.hasOwnProperty.call(n, "isPrototypeOf") === !1);
}
function pL(e) {
  return zm(e) ? { ...e } : Array.isArray(e) ? [...e] : e;
}
const Nre = /* @__PURE__ */ new Set(["string", "number", "symbol"]);
function aw(e) {
  return e.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
}
function Rd(e, t, n) {
  const r = new e._zod.constr(t ?? e._zod.def);
  return (!t || n != null && n.parent) && (r._zod.parent = e), r;
}
function Ut(e) {
  const t = e;
  if (!t)
    return {};
  if (typeof t == "string")
    return { error: () => t };
  if ((t == null ? void 0 : t.message) !== void 0) {
    if ((t == null ? void 0 : t.error) !== void 0)
      throw new Error("Cannot specify both `message` and `error` params");
    t.error = t.message;
  }
  return delete t.message, typeof t.error == "string" ? { ...t, error: () => t.error } : t;
}
function Rre(e) {
  return Object.keys(e).filter((t) => e[t]._zod.optin === "optional" && e[t]._zod.optout === "optional");
}
function Mre(e, t) {
  const n = e._zod.def, r = n.checks;
  if (r && r.length > 0)
    throw new Error(".pick() cannot be used on object schemas containing refinements");
  const s = Nd(e._zod.def, {
    get shape() {
      const a = {};
      for (const u in t) {
        if (!(u in n.shape))
          throw new Error(`Unrecognized key: "${u}"`);
        t[u] && (a[u] = n.shape[u]);
      }
      return jh(this, "shape", a), a;
    },
    checks: []
  });
  return Rd(e, s);
}
function Ore(e, t) {
  const n = e._zod.def, r = n.checks;
  if (r && r.length > 0)
    throw new Error(".omit() cannot be used on object schemas containing refinements");
  const s = Nd(e._zod.def, {
    get shape() {
      const a = { ...e._zod.def.shape };
      for (const u in t) {
        if (!(u in n.shape))
          throw new Error(`Unrecognized key: "${u}"`);
        t[u] && delete a[u];
      }
      return jh(this, "shape", a), a;
    },
    checks: []
  });
  return Rd(e, s);
}
function Dre(e, t) {
  if (!zm(t))
    throw new Error("Invalid input to extend: expected a plain object");
  const n = e._zod.def.checks;
  if (n && n.length > 0) {
    const s = e._zod.def.shape;
    for (const a in t)
      if (Object.getOwnPropertyDescriptor(s, a) !== void 0)
        throw new Error("Cannot overwrite keys on object schemas containing refinements. Use `.safeExtend()` instead.");
  }
  const i = Nd(e._zod.def, {
    get shape() {
      const s = { ...e._zod.def.shape, ...t };
      return jh(this, "shape", s), s;
    }
  });
  return Rd(e, i);
}
function zre(e, t) {
  if (!zm(t))
    throw new Error("Invalid input to safeExtend: expected a plain object");
  const n = Nd(e._zod.def, {
    get shape() {
      const r = { ...e._zod.def.shape, ...t };
      return jh(this, "shape", r), r;
    }
  });
  return Rd(e, n);
}
function Pre(e, t) {
  const n = Nd(e._zod.def, {
    get shape() {
      const r = { ...e._zod.def.shape, ...t._zod.def.shape };
      return jh(this, "shape", r), r;
    },
    get catchall() {
      return t._zod.def.catchall;
    },
    checks: []
    // delete existing checks
  });
  return Rd(e, n);
}
function Ire(e, t, n) {
  const i = t._zod.def.checks;
  if (i && i.length > 0)
    throw new Error(".partial() cannot be used on object schemas containing refinements");
  const a = Nd(t._zod.def, {
    get shape() {
      const u = t._zod.def.shape, d = { ...u };
      if (n)
        for (const f in n) {
          if (!(f in u))
            throw new Error(`Unrecognized key: "${f}"`);
          n[f] && (d[f] = e ? new e({
            type: "optional",
            innerType: u[f]
          }) : u[f]);
        }
      else
        for (const f in u)
          d[f] = e ? new e({
            type: "optional",
            innerType: u[f]
          }) : u[f];
      return jh(this, "shape", d), d;
    },
    checks: []
  });
  return Rd(t, a);
}
function Lre(e, t, n) {
  const r = Nd(t._zod.def, {
    get shape() {
      const i = t._zod.def.shape, s = { ...i };
      if (n)
        for (const a in n) {
          if (!(a in s))
            throw new Error(`Unrecognized key: "${a}"`);
          n[a] && (s[a] = new e({
            type: "nonoptional",
            innerType: i[a]
          }));
        }
      else
        for (const a in i)
          s[a] = new e({
            type: "nonoptional",
            innerType: i[a]
          });
      return jh(this, "shape", s), s;
    }
  });
  return Rd(t, r);
}
function lm(e, t = 0) {
  var n;
  if (e.aborted === !0)
    return !0;
  for (let r = t; r < e.issues.length; r++)
    if (((n = e.issues[r]) == null ? void 0 : n.continue) !== !0)
      return !0;
  return !1;
}
function um(e, t) {
  return t.map((n) => {
    var r;
    return (r = n).path ?? (r.path = []), n.path.unshift(e), n;
  });
}
function m1(e) {
  return typeof e == "string" ? e : e == null ? void 0 : e.message;
}
function kd(e, t, n) {
  var i, s, a, u, d, f;
  const r = { ...e, path: e.path ?? [] };
  if (!e.message) {
    const h = m1((a = (s = (i = e.inst) == null ? void 0 : i._zod.def) == null ? void 0 : s.error) == null ? void 0 : a.call(s, e)) ?? m1((u = t == null ? void 0 : t.error) == null ? void 0 : u.call(t, e)) ?? m1((d = n.customError) == null ? void 0 : d.call(n, e)) ?? m1((f = n.localeError) == null ? void 0 : f.call(n, e)) ?? "Invalid input";
    r.message = h;
  }
  return delete r.inst, delete r.continue, t != null && t.reportInput || delete r.input, r;
}
function MT(e) {
  return Array.isArray(e) ? "array" : typeof e == "string" ? "string" : "unknown";
}
function Ny(...e) {
  const [t, n, r] = e;
  return typeof t == "string" ? {
    message: t,
    code: "custom",
    input: n,
    inst: r
  } : { ...t };
}
const mL = (e, t) => {
  e.name = "$ZodError", Object.defineProperty(e, "_zod", {
    value: e._zod,
    enumerable: !1
  }), Object.defineProperty(e, "issues", {
    value: t,
    enumerable: !1
  }), e.message = JSON.stringify(t, J3, 2), Object.defineProperty(e, "toString", {
    value: () => e.message,
    enumerable: !1
  });
}, gL = Xe("$ZodError", mL), yL = Xe("$ZodError", mL, { Parent: Error });
function Bre(e, t = (n) => n.message) {
  const n = {}, r = [];
  for (const i of e.issues)
    i.path.length > 0 ? (n[i.path[0]] = n[i.path[0]] || [], n[i.path[0]].push(t(i))) : r.push(t(i));
  return { formErrors: r, fieldErrors: n };
}
function $re(e, t = (n) => n.message) {
  const n = { _errors: [] }, r = (i) => {
    for (const s of i.issues)
      if (s.code === "invalid_union" && s.errors.length)
        s.errors.map((a) => r({ issues: a }));
      else if (s.code === "invalid_key")
        r({ issues: s.issues });
      else if (s.code === "invalid_element")
        r({ issues: s.issues });
      else if (s.path.length === 0)
        n._errors.push(t(s));
      else {
        let a = n, u = 0;
        for (; u < s.path.length; ) {
          const d = s.path[u];
          u === s.path.length - 1 ? (a[d] = a[d] || { _errors: [] }, a[d]._errors.push(t(s))) : a[d] = a[d] || { _errors: [] }, a = a[d], u++;
        }
      }
  };
  return r(e), n;
}
const OT = (e) => (t, n, r, i) => {
  const s = r ? Object.assign(r, { async: !1 }) : { async: !1 }, a = t._zod.run({ value: n, issues: [] }, s);
  if (a instanceof Promise)
    throw new bm();
  if (a.issues.length) {
    const u = new ((i == null ? void 0 : i.Err) ?? e)(a.issues.map((d) => kd(d, s, Cd())));
    throw hL(u, i == null ? void 0 : i.callee), u;
  }
  return a.value;
}, DT = (e) => async (t, n, r, i) => {
  const s = r ? Object.assign(r, { async: !0 }) : { async: !0 };
  let a = t._zod.run({ value: n, issues: [] }, s);
  if (a instanceof Promise && (a = await a), a.issues.length) {
    const u = new ((i == null ? void 0 : i.Err) ?? e)(a.issues.map((d) => kd(d, s, Cd())));
    throw hL(u, i == null ? void 0 : i.callee), u;
  }
  return a.value;
}, ow = (e) => (t, n, r) => {
  const i = r ? { ...r, async: !1 } : { async: !1 }, s = t._zod.run({ value: n, issues: [] }, i);
  if (s instanceof Promise)
    throw new bm();
  return s.issues.length ? {
    success: !1,
    error: new (e ?? gL)(s.issues.map((a) => kd(a, i, Cd())))
  } : { success: !0, data: s.value };
}, qre = /* @__PURE__ */ ow(yL), lw = (e) => async (t, n, r) => {
  const i = r ? Object.assign(r, { async: !0 }) : { async: !0 };
  let s = t._zod.run({ value: n, issues: [] }, i);
  return s instanceof Promise && (s = await s), s.issues.length ? {
    success: !1,
    error: new e(s.issues.map((a) => kd(a, i, Cd())))
  } : { success: !0, data: s.value };
}, Fre = /* @__PURE__ */ lw(yL), Ure = (e) => (t, n, r) => {
  const i = r ? Object.assign(r, { direction: "backward" }) : { direction: "backward" };
  return OT(e)(t, n, i);
}, Hre = (e) => (t, n, r) => OT(e)(t, n, r), Vre = (e) => async (t, n, r) => {
  const i = r ? Object.assign(r, { direction: "backward" }) : { direction: "backward" };
  return DT(e)(t, n, i);
}, Gre = (e) => async (t, n, r) => DT(e)(t, n, r), Kre = (e) => (t, n, r) => {
  const i = r ? Object.assign(r, { direction: "backward" }) : { direction: "backward" };
  return ow(e)(t, n, i);
}, Yre = (e) => (t, n, r) => ow(e)(t, n, r), Wre = (e) => async (t, n, r) => {
  const i = r ? Object.assign(r, { direction: "backward" }) : { direction: "backward" };
  return lw(e)(t, n, i);
}, Zre = (e) => async (t, n, r) => lw(e)(t, n, r), Xre = /^[cC][^\s-]{8,}$/, Qre = /^[0-9a-z]+$/, Jre = /^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/, eie = /^[0-9a-vA-V]{20}$/, tie = /^[A-Za-z0-9]{27}$/, nie = /^[a-zA-Z0-9_-]{21}$/, rie = /^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/, iie = /^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/, n6 = (e) => e ? new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`) : /^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/, sie = /^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/, aie = "^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";
function oie() {
  return new RegExp(aie, "u");
}
const lie = /^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/, uie = /^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/, cie = /^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/, die = /^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/, fie = /^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/, xL = /^[A-Za-z0-9_-]*$/, hie = /^\+[1-9]\d{6,14}$/, vL = "(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))", pie = /* @__PURE__ */ new RegExp(`^${vL}$`);
function bL(e) {
  const t = "(?:[01]\\d|2[0-3]):[0-5]\\d";
  return typeof e.precision == "number" ? e.precision === -1 ? `${t}` : e.precision === 0 ? `${t}:[0-5]\\d` : `${t}:[0-5]\\d\\.\\d{${e.precision}}` : `${t}(?::[0-5]\\d(?:\\.\\d+)?)?`;
}
function mie(e) {
  return new RegExp(`^${bL(e)}$`);
}
function gie(e) {
  const t = bL({ precision: e.precision }), n = ["Z"];
  e.local && n.push(""), e.offset && n.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");
  const r = `${t}(?:${n.join("|")})`;
  return new RegExp(`^${vL}T(?:${r})$`);
}
const yie = (e) => {
  const t = e ? `[\\s\\S]{${(e == null ? void 0 : e.minimum) ?? 0},${(e == null ? void 0 : e.maximum) ?? ""}}` : "[\\s\\S]*";
  return new RegExp(`^${t}$`);
}, xie = /^-?\d+(?:\.\d+)?$/, vie = /^[^A-Z]*$/, bie = /^[^a-z]*$/, ou = /* @__PURE__ */ Xe("$ZodCheck", (e, t) => {
  var n;
  e._zod ?? (e._zod = {}), e._zod.def = t, (n = e._zod).onattach ?? (n.onattach = []);
}), wie = /* @__PURE__ */ Xe("$ZodCheckMaxLength", (e, t) => {
  var n;
  ou.init(e, t), (n = e._zod.def).when ?? (n.when = (r) => {
    const i = r.value;
    return !NT(i) && i.length !== void 0;
  }), e._zod.onattach.push((r) => {
    const i = r._zod.bag.maximum ?? Number.POSITIVE_INFINITY;
    t.maximum < i && (r._zod.bag.maximum = t.maximum);
  }), e._zod.check = (r) => {
    const i = r.value;
    if (i.length <= t.maximum)
      return;
    const a = MT(i);
    r.issues.push({
      origin: a,
      code: "too_big",
      maximum: t.maximum,
      inclusive: !0,
      input: i,
      inst: e,
      continue: !t.abort
    });
  };
}), _ie = /* @__PURE__ */ Xe("$ZodCheckMinLength", (e, t) => {
  var n;
  ou.init(e, t), (n = e._zod.def).when ?? (n.when = (r) => {
    const i = r.value;
    return !NT(i) && i.length !== void 0;
  }), e._zod.onattach.push((r) => {
    const i = r._zod.bag.minimum ?? Number.NEGATIVE_INFINITY;
    t.minimum > i && (r._zod.bag.minimum = t.minimum);
  }), e._zod.check = (r) => {
    const i = r.value;
    if (i.length >= t.minimum)
      return;
    const a = MT(i);
    r.issues.push({
      origin: a,
      code: "too_small",
      minimum: t.minimum,
      inclusive: !0,
      input: i,
      inst: e,
      continue: !t.abort
    });
  };
}), Sie = /* @__PURE__ */ Xe("$ZodCheckLengthEquals", (e, t) => {
  var n;
  ou.init(e, t), (n = e._zod.def).when ?? (n.when = (r) => {
    const i = r.value;
    return !NT(i) && i.length !== void 0;
  }), e._zod.onattach.push((r) => {
    const i = r._zod.bag;
    i.minimum = t.length, i.maximum = t.length, i.length = t.length;
  }), e._zod.check = (r) => {
    const i = r.value, s = i.length;
    if (s === t.length)
      return;
    const a = MT(i), u = s > t.length;
    r.issues.push({
      origin: a,
      ...u ? { code: "too_big", maximum: t.length } : { code: "too_small", minimum: t.length },
      inclusive: !0,
      exact: !0,
      input: r.value,
      inst: e,
      continue: !t.abort
    });
  };
}), uw = /* @__PURE__ */ Xe("$ZodCheckStringFormat", (e, t) => {
  var n, r;
  ou.init(e, t), e._zod.onattach.push((i) => {
    const s = i._zod.bag;
    s.format = t.format, t.pattern && (s.patterns ?? (s.patterns = /* @__PURE__ */ new Set()), s.patterns.add(t.pattern));
  }), t.pattern ? (n = e._zod).check ?? (n.check = (i) => {
    t.pattern.lastIndex = 0, !t.pattern.test(i.value) && i.issues.push({
      origin: "string",
      code: "invalid_format",
      format: t.format,
      input: i.value,
      ...t.pattern ? { pattern: t.pattern.toString() } : {},
      inst: e,
      continue: !t.abort
    });
  }) : (r = e._zod).check ?? (r.check = () => {
  });
}), Eie = /* @__PURE__ */ Xe("$ZodCheckRegex", (e, t) => {
  uw.init(e, t), e._zod.check = (n) => {
    t.pattern.lastIndex = 0, !t.pattern.test(n.value) && n.issues.push({
      origin: "string",
      code: "invalid_format",
      format: "regex",
      input: n.value,
      pattern: t.pattern.toString(),
      inst: e,
      continue: !t.abort
    });
  };
}), Cie = /* @__PURE__ */ Xe("$ZodCheckLowerCase", (e, t) => {
  t.pattern ?? (t.pattern = vie), uw.init(e, t);
}), kie = /* @__PURE__ */ Xe("$ZodCheckUpperCase", (e, t) => {
  t.pattern ?? (t.pattern = bie), uw.init(e, t);
}), Tie = /* @__PURE__ */ Xe("$ZodCheckIncludes", (e, t) => {
  ou.init(e, t);
  const n = aw(t.includes), r = new RegExp(typeof t.position == "number" ? `^.{${t.position}}${n}` : n);
  t.pattern = r, e._zod.onattach.push((i) => {
    const s = i._zod.bag;
    s.patterns ?? (s.patterns = /* @__PURE__ */ new Set()), s.patterns.add(r);
  }), e._zod.check = (i) => {
    i.value.includes(t.includes, t.position) || i.issues.push({
      origin: "string",
      code: "invalid_format",
      format: "includes",
      includes: t.includes,
      input: i.value,
      inst: e,
      continue: !t.abort
    });
  };
}), jie = /* @__PURE__ */ Xe("$ZodCheckStartsWith", (e, t) => {
  ou.init(e, t);
  const n = new RegExp(`^${aw(t.prefix)}.*`);
  t.pattern ?? (t.pattern = n), e._zod.onattach.push((r) => {
    const i = r._zod.bag;
    i.patterns ?? (i.patterns = /* @__PURE__ */ new Set()), i.patterns.add(n);
  }), e._zod.check = (r) => {
    r.value.startsWith(t.prefix) || r.issues.push({
      origin: "string",
      code: "invalid_format",
      format: "starts_with",
      prefix: t.prefix,
      input: r.value,
      inst: e,
      continue: !t.abort
    });
  };
}), Aie = /* @__PURE__ */ Xe("$ZodCheckEndsWith", (e, t) => {
  ou.init(e, t);
  const n = new RegExp(`.*${aw(t.suffix)}$`);
  t.pattern ?? (t.pattern = n), e._zod.onattach.push((r) => {
    const i = r._zod.bag;
    i.patterns ?? (i.patterns = /* @__PURE__ */ new Set()), i.patterns.add(n);
  }), e._zod.check = (r) => {
    r.value.endsWith(t.suffix) || r.issues.push({
      origin: "string",
      code: "invalid_format",
      format: "ends_with",
      suffix: t.suffix,
      input: r.value,
      inst: e,
      continue: !t.abort
    });
  };
}), Nie = /* @__PURE__ */ Xe("$ZodCheckOverwrite", (e, t) => {
  ou.init(e, t), e._zod.check = (n) => {
    n.value = t.tx(n.value);
  };
});
class Rie {
  constructor(t = []) {
    this.content = [], this.indent = 0, this && (this.args = t);
  }
  indented(t) {
    this.indent += 1, t(this), this.indent -= 1;
  }
  write(t) {
    if (typeof t == "function") {
      t(this, { execution: "sync" }), t(this, { execution: "async" });
      return;
    }
    const r = t.split(`
`).filter((a) => a), i = Math.min(...r.map((a) => a.length - a.trimStart().length)), s = r.map((a) => a.slice(i)).map((a) => " ".repeat(this.indent * 2) + a);
    for (const a of s)
      this.content.push(a);
  }
  compile() {
    const t = Function, n = this == null ? void 0 : this.args, i = [...((this == null ? void 0 : this.content) ?? [""]).map((s) => `  ${s}`)];
    return new t(...n, i.join(`
`));
  }
}
const Mie = {
  major: 4,
  minor: 3,
  patch: 5
}, Gr = /* @__PURE__ */ Xe("$ZodType", (e, t) => {
  var i;
  var n;
  e ?? (e = {}), e._zod.def = t, e._zod.bag = e._zod.bag || {}, e._zod.version = Mie;
  const r = [...e._zod.def.checks ?? []];
  e._zod.traits.has("$ZodCheck") && r.unshift(e);
  for (const s of r)
    for (const a of s._zod.onattach)
      a(e);
  if (r.length === 0)
    (n = e._zod).deferred ?? (n.deferred = []), (i = e._zod.deferred) == null || i.push(() => {
      e._zod.run = e._zod.parse;
    });
  else {
    const s = (u, d, f) => {
      let h = lm(u), m;
      for (const x of d) {
        if (x._zod.def.when) {
          if (!x._zod.def.when(u))
            continue;
        } else if (h)
          continue;
        const b = u.issues.length, w = x._zod.check(u);
        if (w instanceof Promise && (f == null ? void 0 : f.async) === !1)
          throw new bm();
        if (m || w instanceof Promise)
          m = (m ?? Promise.resolve()).then(async () => {
            await w, u.issues.length !== b && (h || (h = lm(u, b)));
          });
        else {
          if (u.issues.length === b)
            continue;
          h || (h = lm(u, b));
        }
      }
      return m ? m.then(() => u) : u;
    }, a = (u, d, f) => {
      if (lm(u))
        return u.aborted = !0, u;
      const h = s(d, r, f);
      if (h instanceof Promise) {
        if (f.async === !1)
          throw new bm();
        return h.then((m) => e._zod.parse(m, f));
      }
      return e._zod.parse(h, f);
    };
    e._zod.run = (u, d) => {
      if (d.skipChecks)
        return e._zod.parse(u, d);
      if (d.direction === "backward") {
        const h = e._zod.parse({ value: u.value, issues: [] }, { ...d, skipChecks: !0 });
        return h instanceof Promise ? h.then((m) => a(m, u, d)) : a(h, u, d);
      }
      const f = e._zod.parse(u, d);
      if (f instanceof Promise) {
        if (d.async === !1)
          throw new bm();
        return f.then((h) => s(h, r, d));
      }
      return s(f, r, d);
    };
  }
  Fn(e, "~standard", () => ({
    validate: (s) => {
      var a;
      try {
        const u = qre(e, s);
        return u.success ? { value: u.data } : { issues: (a = u.error) == null ? void 0 : a.issues };
      } catch {
        return Fre(e, s).then((d) => {
          var f;
          return d.success ? { value: d.data } : { issues: (f = d.error) == null ? void 0 : f.issues };
        });
      }
    },
    vendor: "zod",
    version: 1
  }));
}), zT = /* @__PURE__ */ Xe("$ZodString", (e, t) => {
  var n;
  Gr.init(e, t), e._zod.pattern = [...((n = e == null ? void 0 : e._zod.bag) == null ? void 0 : n.patterns) ?? []].pop() ?? yie(e._zod.bag), e._zod.parse = (r, i) => {
    if (t.coerce)
      try {
        r.value = String(r.value);
      } catch {
      }
    return typeof r.value == "string" || r.issues.push({
      expected: "string",
      code: "invalid_type",
      input: r.value,
      inst: e
    }), r;
  };
}), vr = /* @__PURE__ */ Xe("$ZodStringFormat", (e, t) => {
  uw.init(e, t), zT.init(e, t);
}), Oie = /* @__PURE__ */ Xe("$ZodGUID", (e, t) => {
  t.pattern ?? (t.pattern = iie), vr.init(e, t);
}), Die = /* @__PURE__ */ Xe("$ZodUUID", (e, t) => {
  if (t.version) {
    const r = {
      v1: 1,
      v2: 2,
      v3: 3,
      v4: 4,
      v5: 5,
      v6: 6,
      v7: 7,
      v8: 8
    }[t.version];
    if (r === void 0)
      throw new Error(`Invalid UUID version: "${t.version}"`);
    t.pattern ?? (t.pattern = n6(r));
  } else
    t.pattern ?? (t.pattern = n6());
  vr.init(e, t);
}), zie = /* @__PURE__ */ Xe("$ZodEmail", (e, t) => {
  t.pattern ?? (t.pattern = sie), vr.init(e, t);
}), Pie = /* @__PURE__ */ Xe("$ZodURL", (e, t) => {
  vr.init(e, t), e._zod.check = (n) => {
    try {
      const r = n.value.trim(), i = new URL(r);
      t.hostname && (t.hostname.lastIndex = 0, t.hostname.test(i.hostname) || n.issues.push({
        code: "invalid_format",
        format: "url",
        note: "Invalid hostname",
        pattern: t.hostname.source,
        input: n.value,
        inst: e,
        continue: !t.abort
      })), t.protocol && (t.protocol.lastIndex = 0, t.protocol.test(i.protocol.endsWith(":") ? i.protocol.slice(0, -1) : i.protocol) || n.issues.push({
        code: "invalid_format",
        format: "url",
        note: "Invalid protocol",
        pattern: t.protocol.source,
        input: n.value,
        inst: e,
        continue: !t.abort
      })), t.normalize ? n.value = i.href : n.value = r;
      return;
    } catch {
      n.issues.push({
        code: "invalid_format",
        format: "url",
        input: n.value,
        inst: e,
        continue: !t.abort
      });
    }
  };
}), Iie = /* @__PURE__ */ Xe("$ZodEmoji", (e, t) => {
  t.pattern ?? (t.pattern = oie()), vr.init(e, t);
}), Lie = /* @__PURE__ */ Xe("$ZodNanoID", (e, t) => {
  t.pattern ?? (t.pattern = nie), vr.init(e, t);
}), Bie = /* @__PURE__ */ Xe("$ZodCUID", (e, t) => {
  t.pattern ?? (t.pattern = Xre), vr.init(e, t);
}), $ie = /* @__PURE__ */ Xe("$ZodCUID2", (e, t) => {
  t.pattern ?? (t.pattern = Qre), vr.init(e, t);
}), qie = /* @__PURE__ */ Xe("$ZodULID", (e, t) => {
  t.pattern ?? (t.pattern = Jre), vr.init(e, t);
}), Fie = /* @__PURE__ */ Xe("$ZodXID", (e, t) => {
  t.pattern ?? (t.pattern = eie), vr.init(e, t);
}), Uie = /* @__PURE__ */ Xe("$ZodKSUID", (e, t) => {
  t.pattern ?? (t.pattern = tie), vr.init(e, t);
}), Hie = /* @__PURE__ */ Xe("$ZodISODateTime", (e, t) => {
  t.pattern ?? (t.pattern = gie(t)), vr.init(e, t);
}), Vie = /* @__PURE__ */ Xe("$ZodISODate", (e, t) => {
  t.pattern ?? (t.pattern = pie), vr.init(e, t);
}), Gie = /* @__PURE__ */ Xe("$ZodISOTime", (e, t) => {
  t.pattern ?? (t.pattern = mie(t)), vr.init(e, t);
}), Kie = /* @__PURE__ */ Xe("$ZodISODuration", (e, t) => {
  t.pattern ?? (t.pattern = rie), vr.init(e, t);
}), Yie = /* @__PURE__ */ Xe("$ZodIPv4", (e, t) => {
  t.pattern ?? (t.pattern = lie), vr.init(e, t), e._zod.bag.format = "ipv4";
}), Wie = /* @__PURE__ */ Xe("$ZodIPv6", (e, t) => {
  t.pattern ?? (t.pattern = uie), vr.init(e, t), e._zod.bag.format = "ipv6", e._zod.check = (n) => {
    try {
      new URL(`http://[${n.value}]`);
    } catch {
      n.issues.push({
        code: "invalid_format",
        format: "ipv6",
        input: n.value,
        inst: e,
        continue: !t.abort
      });
    }
  };
}), Zie = /* @__PURE__ */ Xe("$ZodCIDRv4", (e, t) => {
  t.pattern ?? (t.pattern = cie), vr.init(e, t);
}), Xie = /* @__PURE__ */ Xe("$ZodCIDRv6", (e, t) => {
  t.pattern ?? (t.pattern = die), vr.init(e, t), e._zod.check = (n) => {
    const r = n.value.split("/");
    try {
      if (r.length !== 2)
        throw new Error();
      const [i, s] = r;
      if (!s)
        throw new Error();
      const a = Number(s);
      if (`${a}` !== s)
        throw new Error();
      if (a < 0 || a > 128)
        throw new Error();
      new URL(`http://[${i}]`);
    } catch {
      n.issues.push({
        code: "invalid_format",
        format: "cidrv6",
        input: n.value,
        inst: e,
        continue: !t.abort
      });
    }
  };
});
function wL(e) {
  if (e === "")
    return !0;
  if (e.length % 4 !== 0)
    return !1;
  try {
    return atob(e), !0;
  } catch {
    return !1;
  }
}
const Qie = /* @__PURE__ */ Xe("$ZodBase64", (e, t) => {
  t.pattern ?? (t.pattern = fie), vr.init(e, t), e._zod.bag.contentEncoding = "base64", e._zod.check = (n) => {
    wL(n.value) || n.issues.push({
      code: "invalid_format",
      format: "base64",
      input: n.value,
      inst: e,
      continue: !t.abort
    });
  };
});
function Jie(e) {
  if (!xL.test(e))
    return !1;
  const t = e.replace(/[-_]/g, (r) => r === "-" ? "+" : "/"), n = t.padEnd(Math.ceil(t.length / 4) * 4, "=");
  return wL(n);
}
const ese = /* @__PURE__ */ Xe("$ZodBase64URL", (e, t) => {
  t.pattern ?? (t.pattern = xL), vr.init(e, t), e._zod.bag.contentEncoding = "base64url", e._zod.check = (n) => {
    Jie(n.value) || n.issues.push({
      code: "invalid_format",
      format: "base64url",
      input: n.value,
      inst: e,
      continue: !t.abort
    });
  };
}), tse = /* @__PURE__ */ Xe("$ZodE164", (e, t) => {
  t.pattern ?? (t.pattern = hie), vr.init(e, t);
});
function nse(e, t = null) {
  try {
    const n = e.split(".");
    if (n.length !== 3)
      return !1;
    const [r] = n;
    if (!r)
      return !1;
    const i = JSON.parse(atob(r));
    return !("typ" in i && (i == null ? void 0 : i.typ) !== "JWT" || !i.alg || t && (!("alg" in i) || i.alg !== t));
  } catch {
    return !1;
  }
}
const rse = /* @__PURE__ */ Xe("$ZodJWT", (e, t) => {
  vr.init(e, t), e._zod.check = (n) => {
    nse(n.value, t.alg) || n.issues.push({
      code: "invalid_format",
      format: "jwt",
      input: n.value,
      inst: e,
      continue: !t.abort
    });
  };
}), ise = /* @__PURE__ */ Xe("$ZodAny", (e, t) => {
  Gr.init(e, t), e._zod.parse = (n) => n;
}), sse = /* @__PURE__ */ Xe("$ZodUnknown", (e, t) => {
  Gr.init(e, t), e._zod.parse = (n) => n;
}), ase = /* @__PURE__ */ Xe("$ZodNever", (e, t) => {
  Gr.init(e, t), e._zod.parse = (n, r) => (n.issues.push({
    expected: "never",
    code: "invalid_type",
    input: n.value,
    inst: e
  }), n);
});
function r6(e, t, n) {
  e.issues.length && t.issues.push(...um(n, e.issues)), t.value[n] = e.value;
}
const ose = /* @__PURE__ */ Xe("$ZodArray", (e, t) => {
  Gr.init(e, t), e._zod.parse = (n, r) => {
    const i = n.value;
    if (!Array.isArray(i))
      return n.issues.push({
        expected: "array",
        code: "invalid_type",
        input: i,
        inst: e
      }), n;
    n.value = Array(i.length);
    const s = [];
    for (let a = 0; a < i.length; a++) {
      const u = i[a], d = t.element._zod.run({
        value: u,
        issues: []
      }, r);
      d instanceof Promise ? s.push(d.then((f) => r6(f, n, a))) : r6(d, n, a);
    }
    return s.length ? Promise.all(s).then(() => n) : n;
  };
});
function xb(e, t, n, r, i) {
  if (e.issues.length) {
    if (i && !(n in r))
      return;
    t.issues.push(...um(n, e.issues));
  }
  e.value === void 0 ? n in r && (t.value[n] = void 0) : t.value[n] = e.value;
}
function _L(e) {
  var r, i, s, a;
  const t = Object.keys(e.shape);
  for (const u of t)
    if (!((a = (s = (i = (r = e.shape) == null ? void 0 : r[u]) == null ? void 0 : i._zod) == null ? void 0 : s.traits) != null && a.has("$ZodType")))
      throw new Error(`Invalid element at key "${u}": expected a Zod schema`);
  const n = Rre(e.shape);
  return {
    ...e,
    keys: t,
    keySet: new Set(t),
    numKeys: t.length,
    optionalKeys: new Set(n)
  };
}
function SL(e, t, n, r, i, s) {
  const a = [], u = i.keySet, d = i.catchall._zod, f = d.def.type, h = d.optout === "optional";
  for (const m in t) {
    if (u.has(m))
      continue;
    if (f === "never") {
      a.push(m);
      continue;
    }
    const x = d.run({ value: t[m], issues: [] }, r);
    x instanceof Promise ? e.push(x.then((b) => xb(b, n, m, t, h))) : xb(x, n, m, t, h);
  }
  return a.length && n.issues.push({
    code: "unrecognized_keys",
    keys: a,
    input: t,
    inst: s
  }), e.length ? Promise.all(e).then(() => n) : n;
}
const lse = /* @__PURE__ */ Xe("$ZodObject", (e, t) => {
  Gr.init(e, t);
  const n = Object.getOwnPropertyDescriptor(t, "shape");
  if (!(n != null && n.get)) {
    const u = t.shape;
    Object.defineProperty(t, "shape", {
      get: () => {
        const d = { ...u };
        return Object.defineProperty(t, "shape", {
          value: d
        }), d;
      }
    });
  }
  const r = AT(() => _L(t));
  Fn(e._zod, "propValues", () => {
    const u = t.shape, d = {};
    for (const f in u) {
      const h = u[f]._zod;
      if (h.values) {
        d[f] ?? (d[f] = /* @__PURE__ */ new Set());
        for (const m of h.values)
          d[f].add(m);
      }
    }
    return d;
  });
  const i = yb, s = t.catchall;
  let a;
  e._zod.parse = (u, d) => {
    a ?? (a = r.value);
    const f = u.value;
    if (!i(f))
      return u.issues.push({
        expected: "object",
        code: "invalid_type",
        input: f,
        inst: e
      }), u;
    u.value = {};
    const h = [], m = a.shape;
    for (const x of a.keys) {
      const b = m[x], w = b._zod.optout === "optional", S = b._zod.run({ value: f[x], issues: [] }, d);
      S instanceof Promise ? h.push(S.then((C) => xb(C, u, x, f, w))) : xb(S, u, x, f, w);
    }
    return s ? SL(h, f, u, d, r.value, e) : h.length ? Promise.all(h).then(() => u) : u;
  };
}), use = /* @__PURE__ */ Xe("$ZodObjectJIT", (e, t) => {
  lse.init(e, t);
  const n = e._zod.parse, r = AT(() => _L(t)), i = (x) => {
    var N;
    const b = new Rie(["shape", "payload", "ctx"]), w = r.value, S = (M) => {
      const P = t6(M);
      return `shape[${P}]._zod.run({ value: input[${P}], issues: [] }, ctx)`;
    };
    b.write("const input = payload.value;");
    const C = /* @__PURE__ */ Object.create(null);
    let T = 0;
    for (const M of w.keys)
      C[M] = `key_${T++}`;
    b.write("const newResult = {};");
    for (const M of w.keys) {
      const P = C[M], D = t6(M), q = x[M], Y = ((N = q == null ? void 0 : q._zod) == null ? void 0 : N.optout) === "optional";
      b.write(`const ${P} = ${S(M)};`), Y ? b.write(`
        if (${P}.issues.length) {
          if (${D} in input) {
            payload.issues = payload.issues.concat(${P}.issues.map(iss => ({
              ...iss,
              path: iss.path ? [${D}, ...iss.path] : [${D}]
            })));
          }
        }
        
        if (${P}.value === undefined) {
          if (${D} in input) {
            newResult[${D}] = undefined;
          }
        } else {
          newResult[${D}] = ${P}.value;
        }
        
      `) : b.write(`
        if (${P}.issues.length) {
          payload.issues = payload.issues.concat(${P}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${D}, ...iss.path] : [${D}]
          })));
        }
        
        if (${P}.value === undefined) {
          if (${D} in input) {
            newResult[${D}] = undefined;
          }
        } else {
          newResult[${D}] = ${P}.value;
        }
        
      `);
    }
    b.write("payload.value = newResult;"), b.write("return payload;");
    const R = b.compile();
    return (M, P) => R(x, M, P);
  };
  let s;
  const a = yb, u = !dL.jitless, f = u && Are.value, h = t.catchall;
  let m;
  e._zod.parse = (x, b) => {
    m ?? (m = r.value);
    const w = x.value;
    return a(w) ? u && f && (b == null ? void 0 : b.async) === !1 && b.jitless !== !0 ? (s || (s = i(t.shape)), x = s(x, b), h ? SL([], w, x, b, m, e) : x) : n(x, b) : (x.issues.push({
      expected: "object",
      code: "invalid_type",
      input: w,
      inst: e
    }), x);
  };
});
function i6(e, t, n, r) {
  for (const s of e)
    if (s.issues.length === 0)
      return t.value = s.value, t;
  const i = e.filter((s) => !lm(s));
  return i.length === 1 ? (t.value = i[0].value, i[0]) : (t.issues.push({
    code: "invalid_union",
    input: t.value,
    inst: n,
    errors: e.map((s) => s.issues.map((a) => kd(a, r, Cd())))
  }), t);
}
const cse = /* @__PURE__ */ Xe("$ZodUnion", (e, t) => {
  Gr.init(e, t), Fn(e._zod, "optin", () => t.options.some((i) => i._zod.optin === "optional") ? "optional" : void 0), Fn(e._zod, "optout", () => t.options.some((i) => i._zod.optout === "optional") ? "optional" : void 0), Fn(e._zod, "values", () => {
    if (t.options.every((i) => i._zod.values))
      return new Set(t.options.flatMap((i) => Array.from(i._zod.values)));
  }), Fn(e._zod, "pattern", () => {
    if (t.options.every((i) => i._zod.pattern)) {
      const i = t.options.map((s) => s._zod.pattern);
      return new RegExp(`^(${i.map((s) => RT(s.source)).join("|")})$`);
    }
  });
  const n = t.options.length === 1, r = t.options[0]._zod.run;
  e._zod.parse = (i, s) => {
    if (n)
      return r(i, s);
    let a = !1;
    const u = [];
    for (const d of t.options) {
      const f = d._zod.run({
        value: i.value,
        issues: []
      }, s);
      if (f instanceof Promise)
        u.push(f), a = !0;
      else {
        if (f.issues.length === 0)
          return f;
        u.push(f);
      }
    }
    return a ? Promise.all(u).then((d) => i6(d, i, e, s)) : i6(u, i, e, s);
  };
}), dse = /* @__PURE__ */ Xe("$ZodIntersection", (e, t) => {
  Gr.init(e, t), e._zod.parse = (n, r) => {
    const i = n.value, s = t.left._zod.run({ value: i, issues: [] }, r), a = t.right._zod.run({ value: i, issues: [] }, r);
    return s instanceof Promise || a instanceof Promise ? Promise.all([s, a]).then(([d, f]) => s6(n, d, f)) : s6(n, s, a);
  };
});
function e5(e, t) {
  if (e === t)
    return { valid: !0, data: e };
  if (e instanceof Date && t instanceof Date && +e == +t)
    return { valid: !0, data: e };
  if (zm(e) && zm(t)) {
    const n = Object.keys(t), r = Object.keys(e).filter((s) => n.indexOf(s) !== -1), i = { ...e, ...t };
    for (const s of r) {
      const a = e5(e[s], t[s]);
      if (!a.valid)
        return {
          valid: !1,
          mergeErrorPath: [s, ...a.mergeErrorPath]
        };
      i[s] = a.data;
    }
    return { valid: !0, data: i };
  }
  if (Array.isArray(e) && Array.isArray(t)) {
    if (e.length !== t.length)
      return { valid: !1, mergeErrorPath: [] };
    const n = [];
    for (let r = 0; r < e.length; r++) {
      const i = e[r], s = t[r], a = e5(i, s);
      if (!a.valid)
        return {
          valid: !1,
          mergeErrorPath: [r, ...a.mergeErrorPath]
        };
      n.push(a.data);
    }
    return { valid: !0, data: n };
  }
  return { valid: !1, mergeErrorPath: [] };
}
function s6(e, t, n) {
  const r = /* @__PURE__ */ new Map();
  let i;
  for (const u of t.issues)
    if (u.code === "unrecognized_keys") {
      i ?? (i = u);
      for (const d of u.keys)
        r.has(d) || r.set(d, {}), r.get(d).l = !0;
    } else
      e.issues.push(u);
  for (const u of n.issues)
    if (u.code === "unrecognized_keys")
      for (const d of u.keys)
        r.has(d) || r.set(d, {}), r.get(d).r = !0;
    else
      e.issues.push(u);
  const s = [...r].filter(([, u]) => u.l && u.r).map(([u]) => u);
  if (s.length && i && e.issues.push({ ...i, keys: s }), lm(e))
    return e;
  const a = e5(t.value, n.value);
  if (!a.valid)
    throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(a.mergeErrorPath)}`);
  return e.value = a.data, e;
}
const fse = /* @__PURE__ */ Xe("$ZodRecord", (e, t) => {
  Gr.init(e, t), e._zod.parse = (n, r) => {
    const i = n.value;
    if (!zm(i))
      return n.issues.push({
        expected: "record",
        code: "invalid_type",
        input: i,
        inst: e
      }), n;
    const s = [], a = t.keyType._zod.values;
    if (a) {
      n.value = {};
      const u = /* @__PURE__ */ new Set();
      for (const f of a)
        if (typeof f == "string" || typeof f == "number" || typeof f == "symbol") {
          u.add(typeof f == "number" ? f.toString() : f);
          const h = t.valueType._zod.run({ value: i[f], issues: [] }, r);
          h instanceof Promise ? s.push(h.then((m) => {
            m.issues.length && n.issues.push(...um(f, m.issues)), n.value[f] = m.value;
          })) : (h.issues.length && n.issues.push(...um(f, h.issues)), n.value[f] = h.value);
        }
      let d;
      for (const f in i)
        u.has(f) || (d = d ?? [], d.push(f));
      d && d.length > 0 && n.issues.push({
        code: "unrecognized_keys",
        input: i,
        inst: e,
        keys: d
      });
    } else {
      n.value = {};
      for (const u of Reflect.ownKeys(i)) {
        if (u === "__proto__")
          continue;
        let d = t.keyType._zod.run({ value: u, issues: [] }, r);
        if (d instanceof Promise)
          throw new Error("Async schemas not supported in object keys currently");
        if (typeof u == "string" && xie.test(u) && d.issues.length && d.issues.some((m) => m.code === "invalid_type" && m.expected === "number")) {
          const m = t.keyType._zod.run({ value: Number(u), issues: [] }, r);
          if (m instanceof Promise)
            throw new Error("Async schemas not supported in object keys currently");
          m.issues.length === 0 && (d = m);
        }
        if (d.issues.length) {
          t.mode === "loose" ? n.value[u] = i[u] : n.issues.push({
            code: "invalid_key",
            origin: "record",
            issues: d.issues.map((m) => kd(m, r, Cd())),
            input: u,
            path: [u],
            inst: e
          });
          continue;
        }
        const h = t.valueType._zod.run({ value: i[u], issues: [] }, r);
        h instanceof Promise ? s.push(h.then((m) => {
          m.issues.length && n.issues.push(...um(u, m.issues)), n.value[d.value] = m.value;
        })) : (h.issues.length && n.issues.push(...um(u, h.issues)), n.value[d.value] = h.value);
      }
    }
    return s.length ? Promise.all(s).then(() => n) : n;
  };
}), hse = /* @__PURE__ */ Xe("$ZodEnum", (e, t) => {
  Gr.init(e, t);
  const n = fL(t.entries), r = new Set(n);
  e._zod.values = r, e._zod.pattern = new RegExp(`^(${n.filter((i) => Nre.has(typeof i)).map((i) => typeof i == "string" ? aw(i) : i.toString()).join("|")})$`), e._zod.parse = (i, s) => {
    const a = i.value;
    return r.has(a) || i.issues.push({
      code: "invalid_value",
      values: n,
      input: a,
      inst: e
    }), i;
  };
}), pse = /* @__PURE__ */ Xe("$ZodTransform", (e, t) => {
  Gr.init(e, t), e._zod.parse = (n, r) => {
    if (r.direction === "backward")
      throw new cL(e.constructor.name);
    const i = t.transform(n.value, n);
    if (r.async)
      return (i instanceof Promise ? i : Promise.resolve(i)).then((a) => (n.value = a, n));
    if (i instanceof Promise)
      throw new bm();
    return n.value = i, n;
  };
});
function a6(e, t) {
  return e.issues.length && t === void 0 ? { issues: [], value: void 0 } : e;
}
const EL = /* @__PURE__ */ Xe("$ZodOptional", (e, t) => {
  Gr.init(e, t), e._zod.optin = "optional", e._zod.optout = "optional", Fn(e._zod, "values", () => t.innerType._zod.values ? /* @__PURE__ */ new Set([...t.innerType._zod.values, void 0]) : void 0), Fn(e._zod, "pattern", () => {
    const n = t.innerType._zod.pattern;
    return n ? new RegExp(`^(${RT(n.source)})?$`) : void 0;
  }), e._zod.parse = (n, r) => {
    if (t.innerType._zod.optin === "optional") {
      const i = t.innerType._zod.run(n, r);
      return i instanceof Promise ? i.then((s) => a6(s, n.value)) : a6(i, n.value);
    }
    return n.value === void 0 ? n : t.innerType._zod.run(n, r);
  };
}), mse = /* @__PURE__ */ Xe("$ZodExactOptional", (e, t) => {
  EL.init(e, t), Fn(e._zod, "values", () => t.innerType._zod.values), Fn(e._zod, "pattern", () => t.innerType._zod.pattern), e._zod.parse = (n, r) => t.innerType._zod.run(n, r);
}), gse = /* @__PURE__ */ Xe("$ZodNullable", (e, t) => {
  Gr.init(e, t), Fn(e._zod, "optin", () => t.innerType._zod.optin), Fn(e._zod, "optout", () => t.innerType._zod.optout), Fn(e._zod, "pattern", () => {
    const n = t.innerType._zod.pattern;
    return n ? new RegExp(`^(${RT(n.source)}|null)$`) : void 0;
  }), Fn(e._zod, "values", () => t.innerType._zod.values ? /* @__PURE__ */ new Set([...t.innerType._zod.values, null]) : void 0), e._zod.parse = (n, r) => n.value === null ? n : t.innerType._zod.run(n, r);
}), yse = /* @__PURE__ */ Xe("$ZodDefault", (e, t) => {
  Gr.init(e, t), e._zod.optin = "optional", Fn(e._zod, "values", () => t.innerType._zod.values), e._zod.parse = (n, r) => {
    if (r.direction === "backward")
      return t.innerType._zod.run(n, r);
    if (n.value === void 0)
      return n.value = t.defaultValue, n;
    const i = t.innerType._zod.run(n, r);
    return i instanceof Promise ? i.then((s) => o6(s, t)) : o6(i, t);
  };
});
function o6(e, t) {
  return e.value === void 0 && (e.value = t.defaultValue), e;
}
const xse = /* @__PURE__ */ Xe("$ZodPrefault", (e, t) => {
  Gr.init(e, t), e._zod.optin = "optional", Fn(e._zod, "values", () => t.innerType._zod.values), e._zod.parse = (n, r) => (r.direction === "backward" || n.value === void 0 && (n.value = t.defaultValue), t.innerType._zod.run(n, r));
}), vse = /* @__PURE__ */ Xe("$ZodNonOptional", (e, t) => {
  Gr.init(e, t), Fn(e._zod, "values", () => {
    const n = t.innerType._zod.values;
    return n ? new Set([...n].filter((r) => r !== void 0)) : void 0;
  }), e._zod.parse = (n, r) => {
    const i = t.innerType._zod.run(n, r);
    return i instanceof Promise ? i.then((s) => l6(s, e)) : l6(i, e);
  };
});
function l6(e, t) {
  return !e.issues.length && e.value === void 0 && e.issues.push({
    code: "invalid_type",
    expected: "nonoptional",
    input: e.value,
    inst: t
  }), e;
}
const bse = /* @__PURE__ */ Xe("$ZodCatch", (e, t) => {
  Gr.init(e, t), Fn(e._zod, "optin", () => t.innerType._zod.optin), Fn(e._zod, "optout", () => t.innerType._zod.optout), Fn(e._zod, "values", () => t.innerType._zod.values), e._zod.parse = (n, r) => {
    if (r.direction === "backward")
      return t.innerType._zod.run(n, r);
    const i = t.innerType._zod.run(n, r);
    return i instanceof Promise ? i.then((s) => (n.value = s.value, s.issues.length && (n.value = t.catchValue({
      ...n,
      error: {
        issues: s.issues.map((a) => kd(a, r, Cd()))
      },
      input: n.value
    }), n.issues = []), n)) : (n.value = i.value, i.issues.length && (n.value = t.catchValue({
      ...n,
      error: {
        issues: i.issues.map((s) => kd(s, r, Cd()))
      },
      input: n.value
    }), n.issues = []), n);
  };
}), wse = /* @__PURE__ */ Xe("$ZodPipe", (e, t) => {
  Gr.init(e, t), Fn(e._zod, "values", () => t.in._zod.values), Fn(e._zod, "optin", () => t.in._zod.optin), Fn(e._zod, "optout", () => t.out._zod.optout), Fn(e._zod, "propValues", () => t.in._zod.propValues), e._zod.parse = (n, r) => {
    if (r.direction === "backward") {
      const s = t.out._zod.run(n, r);
      return s instanceof Promise ? s.then((a) => g1(a, t.in, r)) : g1(s, t.in, r);
    }
    const i = t.in._zod.run(n, r);
    return i instanceof Promise ? i.then((s) => g1(s, t.out, r)) : g1(i, t.out, r);
  };
});
function g1(e, t, n) {
  return e.issues.length ? (e.aborted = !0, e) : t._zod.run({ value: e.value, issues: e.issues }, n);
}
const _se = /* @__PURE__ */ Xe("$ZodReadonly", (e, t) => {
  Gr.init(e, t), Fn(e._zod, "propValues", () => t.innerType._zod.propValues), Fn(e._zod, "values", () => t.innerType._zod.values), Fn(e._zod, "optin", () => {
    var n, r;
    return (r = (n = t.innerType) == null ? void 0 : n._zod) == null ? void 0 : r.optin;
  }), Fn(e._zod, "optout", () => {
    var n, r;
    return (r = (n = t.innerType) == null ? void 0 : n._zod) == null ? void 0 : r.optout;
  }), e._zod.parse = (n, r) => {
    if (r.direction === "backward")
      return t.innerType._zod.run(n, r);
    const i = t.innerType._zod.run(n, r);
    return i instanceof Promise ? i.then(u6) : u6(i);
  };
});
function u6(e) {
  return e.value = Object.freeze(e.value), e;
}
const Sse = /* @__PURE__ */ Xe("$ZodCustom", (e, t) => {
  ou.init(e, t), Gr.init(e, t), e._zod.parse = (n, r) => n, e._zod.check = (n) => {
    const r = n.value, i = t.fn(r);
    if (i instanceof Promise)
      return i.then((s) => c6(s, n, r, e));
    c6(i, n, r, e);
  };
});
function c6(e, t, n, r) {
  if (!e) {
    const i = {
      code: "custom",
      input: n,
      inst: r,
      // incorporates params.error into issue reporting
      path: [...r._zod.def.path ?? []],
      // incorporates params.error into issue reporting
      continue: !r._zod.def.abort
      // params: inst._zod.def.params,
    };
    r._zod.def.params && (i.params = r._zod.def.params), t.issues.push(Ny(i));
  }
}
var d6;
class Ese {
  constructor() {
    this._map = /* @__PURE__ */ new WeakMap(), this._idmap = /* @__PURE__ */ new Map();
  }
  add(t, ...n) {
    const r = n[0];
    return this._map.set(t, r), r && typeof r == "object" && "id" in r && this._idmap.set(r.id, t), this;
  }
  clear() {
    return this._map = /* @__PURE__ */ new WeakMap(), this._idmap = /* @__PURE__ */ new Map(), this;
  }
  remove(t) {
    const n = this._map.get(t);
    return n && typeof n == "object" && "id" in n && this._idmap.delete(n.id), this._map.delete(t), this;
  }
  get(t) {
    const n = t._zod.parent;
    if (n) {
      const r = { ...this.get(n) ?? {} };
      delete r.id;
      const i = { ...r, ...this._map.get(t) };
      return Object.keys(i).length ? i : void 0;
    }
    return this._map.get(t);
  }
  has(t) {
    return this._map.has(t);
  }
}
function Cse() {
  return new Ese();
}
(d6 = globalThis).__zod_globalRegistry ?? (d6.__zod_globalRegistry = Cse());
const J0 = globalThis.__zod_globalRegistry;
// @__NO_SIDE_EFFECTS__
function kse(e, t) {
  return new e({
    type: "string",
    ...Ut(t)
  });
}
// @__NO_SIDE_EFFECTS__
function Tse(e, t) {
  return new e({
    type: "string",
    format: "email",
    check: "string_format",
    abort: !1,
    ...Ut(t)
  });
}
// @__NO_SIDE_EFFECTS__
function f6(e, t) {
  return new e({
    type: "string",
    format: "guid",
    check: "string_format",
    abort: !1,
    ...Ut(t)
  });
}
// @__NO_SIDE_EFFECTS__
function jse(e, t) {
  return new e({
    type: "string",
    format: "uuid",
    check: "string_format",
    abort: !1,
    ...Ut(t)
  });
}
// @__NO_SIDE_EFFECTS__
function Ase(e, t) {
  return new e({
    type: "string",
    format: "uuid",
    check: "string_format",
    abort: !1,
    version: "v4",
    ...Ut(t)
  });
}
// @__NO_SIDE_EFFECTS__
function Nse(e, t) {
  return new e({
    type: "string",
    format: "uuid",
    check: "string_format",
    abort: !1,
    version: "v6",
    ...Ut(t)
  });
}
// @__NO_SIDE_EFFECTS__
function Rse(e, t) {
  return new e({
    type: "string",
    format: "uuid",
    check: "string_format",
    abort: !1,
    version: "v7",
    ...Ut(t)
  });
}
// @__NO_SIDE_EFFECTS__
function Mse(e, t) {
  return new e({
    type: "string",
    format: "url",
    check: "string_format",
    abort: !1,
    ...Ut(t)
  });
}
// @__NO_SIDE_EFFECTS__
function Ose(e, t) {
  return new e({
    type: "string",
    format: "emoji",
    check: "string_format",
    abort: !1,
    ...Ut(t)
  });
}
// @__NO_SIDE_EFFECTS__
function Dse(e, t) {
  return new e({
    type: "string",
    format: "nanoid",
    check: "string_format",
    abort: !1,
    ...Ut(t)
  });
}
// @__NO_SIDE_EFFECTS__
function zse(e, t) {
  return new e({
    type: "string",
    format: "cuid",
    check: "string_format",
    abort: !1,
    ...Ut(t)
  });
}
// @__NO_SIDE_EFFECTS__
function Pse(e, t) {
  return new e({
    type: "string",
    format: "cuid2",
    check: "string_format",
    abort: !1,
    ...Ut(t)
  });
}
// @__NO_SIDE_EFFECTS__
function Ise(e, t) {
  return new e({
    type: "string",
    format: "ulid",
    check: "string_format",
    abort: !1,
    ...Ut(t)
  });
}
// @__NO_SIDE_EFFECTS__
function Lse(e, t) {
  return new e({
    type: "string",
    format: "xid",
    check: "string_format",
    abort: !1,
    ...Ut(t)
  });
}
// @__NO_SIDE_EFFECTS__
function Bse(e, t) {
  return new e({
    type: "string",
    format: "ksuid",
    check: "string_format",
    abort: !1,
    ...Ut(t)
  });
}
// @__NO_SIDE_EFFECTS__
function $se(e, t) {
  return new e({
    type: "string",
    format: "ipv4",
    check: "string_format",
    abort: !1,
    ...Ut(t)
  });
}
// @__NO_SIDE_EFFECTS__
function qse(e, t) {
  return new e({
    type: "string",
    format: "ipv6",
    check: "string_format",
    abort: !1,
    ...Ut(t)
  });
}
// @__NO_SIDE_EFFECTS__
function Fse(e, t) {
  return new e({
    type: "string",
    format: "cidrv4",
    check: "string_format",
    abort: !1,
    ...Ut(t)
  });
}
// @__NO_SIDE_EFFECTS__
function Use(e, t) {
  return new e({
    type: "string",
    format: "cidrv6",
    check: "string_format",
    abort: !1,
    ...Ut(t)
  });
}
// @__NO_SIDE_EFFECTS__
function Hse(e, t) {
  return new e({
    type: "string",
    format: "base64",
    check: "string_format",
    abort: !1,
    ...Ut(t)
  });
}
// @__NO_SIDE_EFFECTS__
function Vse(e, t) {
  return new e({
    type: "string",
    format: "base64url",
    check: "string_format",
    abort: !1,
    ...Ut(t)
  });
}
// @__NO_SIDE_EFFECTS__
function Gse(e, t) {
  return new e({
    type: "string",
    format: "e164",
    check: "string_format",
    abort: !1,
    ...Ut(t)
  });
}
// @__NO_SIDE_EFFECTS__
function Kse(e, t) {
  return new e({
    type: "string",
    format: "jwt",
    check: "string_format",
    abort: !1,
    ...Ut(t)
  });
}
// @__NO_SIDE_EFFECTS__
function Yse(e, t) {
  return new e({
    type: "string",
    format: "datetime",
    check: "string_format",
    offset: !1,
    local: !1,
    precision: null,
    ...Ut(t)
  });
}
// @__NO_SIDE_EFFECTS__
function Wse(e, t) {
  return new e({
    type: "string",
    format: "date",
    check: "string_format",
    ...Ut(t)
  });
}
// @__NO_SIDE_EFFECTS__
function Zse(e, t) {
  return new e({
    type: "string",
    format: "time",
    check: "string_format",
    precision: null,
    ...Ut(t)
  });
}
// @__NO_SIDE_EFFECTS__
function Xse(e, t) {
  return new e({
    type: "string",
    format: "duration",
    check: "string_format",
    ...Ut(t)
  });
}
// @__NO_SIDE_EFFECTS__
function Qse(e) {
  return new e({
    type: "any"
  });
}
// @__NO_SIDE_EFFECTS__
function Jse(e) {
  return new e({
    type: "unknown"
  });
}
// @__NO_SIDE_EFFECTS__
function eae(e, t) {
  return new e({
    type: "never",
    ...Ut(t)
  });
}
// @__NO_SIDE_EFFECTS__
function CL(e, t) {
  return new wie({
    check: "max_length",
    ...Ut(t),
    maximum: e
  });
}
// @__NO_SIDE_EFFECTS__
function vb(e, t) {
  return new _ie({
    check: "min_length",
    ...Ut(t),
    minimum: e
  });
}
// @__NO_SIDE_EFFECTS__
function kL(e, t) {
  return new Sie({
    check: "length_equals",
    ...Ut(t),
    length: e
  });
}
// @__NO_SIDE_EFFECTS__
function tae(e, t) {
  return new Eie({
    check: "string_format",
    format: "regex",
    ...Ut(t),
    pattern: e
  });
}
// @__NO_SIDE_EFFECTS__
function nae(e) {
  return new Cie({
    check: "string_format",
    format: "lowercase",
    ...Ut(e)
  });
}
// @__NO_SIDE_EFFECTS__
function rae(e) {
  return new kie({
    check: "string_format",
    format: "uppercase",
    ...Ut(e)
  });
}
// @__NO_SIDE_EFFECTS__
function iae(e, t) {
  return new Tie({
    check: "string_format",
    format: "includes",
    ...Ut(t),
    includes: e
  });
}
// @__NO_SIDE_EFFECTS__
function sae(e, t) {
  return new jie({
    check: "string_format",
    format: "starts_with",
    ...Ut(t),
    prefix: e
  });
}
// @__NO_SIDE_EFFECTS__
function aae(e, t) {
  return new Aie({
    check: "string_format",
    format: "ends_with",
    ...Ut(t),
    suffix: e
  });
}
// @__NO_SIDE_EFFECTS__
function Ym(e) {
  return new Nie({
    check: "overwrite",
    tx: e
  });
}
// @__NO_SIDE_EFFECTS__
function oae(e) {
  return /* @__PURE__ */ Ym((t) => t.normalize(e));
}
// @__NO_SIDE_EFFECTS__
function lae() {
  return /* @__PURE__ */ Ym((e) => e.trim());
}
// @__NO_SIDE_EFFECTS__
function uae() {
  return /* @__PURE__ */ Ym((e) => e.toLowerCase());
}
// @__NO_SIDE_EFFECTS__
function cae() {
  return /* @__PURE__ */ Ym((e) => e.toUpperCase());
}
// @__NO_SIDE_EFFECTS__
function dae() {
  return /* @__PURE__ */ Ym((e) => jre(e));
}
// @__NO_SIDE_EFFECTS__
function fae(e, t, n) {
  return new e({
    type: "array",
    element: t,
    // get element() {
    //   return element;
    // },
    ...Ut(n)
  });
}
// @__NO_SIDE_EFFECTS__
function hae(e, t, n) {
  return new e({
    type: "custom",
    check: "custom",
    fn: t,
    ...Ut(n)
  });
}
// @__NO_SIDE_EFFECTS__
function pae(e) {
  const t = /* @__PURE__ */ mae((n) => (n.addIssue = (r) => {
    if (typeof r == "string")
      n.issues.push(Ny(r, n.value, t._zod.def));
    else {
      const i = r;
      i.fatal && (i.continue = !1), i.code ?? (i.code = "custom"), i.input ?? (i.input = n.value), i.inst ?? (i.inst = t), i.continue ?? (i.continue = !t._zod.def.abort), n.issues.push(Ny(i));
    }
  }, e(n.value, n)));
  return t;
}
// @__NO_SIDE_EFFECTS__
function mae(e, t) {
  const n = new ou({
    check: "custom",
    ...Ut(t)
  });
  return n._zod.check = e, n;
}
function TL(e) {
  let t = (e == null ? void 0 : e.target) ?? "draft-2020-12";
  return t === "draft-4" && (t = "draft-04"), t === "draft-7" && (t = "draft-07"), {
    processors: e.processors ?? {},
    metadataRegistry: (e == null ? void 0 : e.metadata) ?? J0,
    target: t,
    unrepresentable: (e == null ? void 0 : e.unrepresentable) ?? "throw",
    override: (e == null ? void 0 : e.override) ?? (() => {
    }),
    io: (e == null ? void 0 : e.io) ?? "output",
    counter: 0,
    seen: /* @__PURE__ */ new Map(),
    cycles: (e == null ? void 0 : e.cycles) ?? "ref",
    reused: (e == null ? void 0 : e.reused) ?? "inline",
    external: (e == null ? void 0 : e.external) ?? void 0
  };
}
function ri(e, t, n = { path: [], schemaPath: [] }) {
  var h, m;
  var r;
  const i = e._zod.def, s = t.seen.get(e);
  if (s)
    return s.count++, n.schemaPath.includes(e) && (s.cycle = n.path), s.schema;
  const a = { schema: {}, count: 1, cycle: void 0, path: n.path };
  t.seen.set(e, a);
  const u = (m = (h = e._zod).toJSONSchema) == null ? void 0 : m.call(h);
  if (u)
    a.schema = u;
  else {
    const x = {
      ...n,
      schemaPath: [...n.schemaPath, e],
      path: n.path
    };
    if (e._zod.processJSONSchema)
      e._zod.processJSONSchema(t, a.schema, x);
    else {
      const w = a.schema, S = t.processors[i.type];
      if (!S)
        throw new Error(`[toJSONSchema]: Non-representable type encountered: ${i.type}`);
      S(e, t, w, x);
    }
    const b = e._zod.parent;
    b && (a.ref || (a.ref = b), ri(b, t, x), t.seen.get(b).isParent = !0);
  }
  const d = t.metadataRegistry.get(e);
  return d && Object.assign(a.schema, d), t.io === "input" && Rs(e) && (delete a.schema.examples, delete a.schema.default), t.io === "input" && a.schema._prefault && ((r = a.schema).default ?? (r.default = a.schema._prefault)), delete a.schema._prefault, t.seen.get(e).schema;
}
function jL(e, t) {
  var a, u, d, f;
  const n = e.seen.get(t);
  if (!n)
    throw new Error("Unprocessed schema. This is a bug in Zod.");
  const r = /* @__PURE__ */ new Map();
  for (const h of e.seen.entries()) {
    const m = (a = e.metadataRegistry.get(h[0])) == null ? void 0 : a.id;
    if (m) {
      const x = r.get(m);
      if (x && x !== h[0])
        throw new Error(`Duplicate schema id "${m}" detected during JSON Schema conversion. Two different schemas cannot share the same id when converted together.`);
      r.set(m, h[0]);
    }
  }
  const i = (h) => {
    var S;
    const m = e.target === "draft-2020-12" ? "$defs" : "definitions";
    if (e.external) {
      const C = (S = e.external.registry.get(h[0])) == null ? void 0 : S.id, T = e.external.uri ?? ((N) => N);
      if (C)
        return { ref: T(C) };
      const R = h[1].defId ?? h[1].schema.id ?? `schema${e.counter++}`;
      return h[1].defId = R, { defId: R, ref: `${T("__shared")}#/${m}/${R}` };
    }
    if (h[1] === n)
      return { ref: "#" };
    const b = `#/${m}/`, w = h[1].schema.id ?? `__schema${e.counter++}`;
    return { defId: w, ref: b + w };
  }, s = (h) => {
    if (h[1].schema.$ref)
      return;
    const m = h[1], { ref: x, defId: b } = i(h);
    m.def = { ...m.schema }, b && (m.defId = b);
    const w = m.schema;
    for (const S in w)
      delete w[S];
    w.$ref = x;
  };
  if (e.cycles === "throw")
    for (const h of e.seen.entries()) {
      const m = h[1];
      if (m.cycle)
        throw new Error(`Cycle detected: #/${(u = m.cycle) == null ? void 0 : u.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`);
    }
  for (const h of e.seen.entries()) {
    const m = h[1];
    if (t === h[0]) {
      s(h);
      continue;
    }
    if (e.external) {
      const b = (d = e.external.registry.get(h[0])) == null ? void 0 : d.id;
      if (t !== h[0] && b) {
        s(h);
        continue;
      }
    }
    if ((f = e.metadataRegistry.get(h[0])) == null ? void 0 : f.id) {
      s(h);
      continue;
    }
    if (m.cycle) {
      s(h);
      continue;
    }
    if (m.count > 1 && e.reused === "ref") {
      s(h);
      continue;
    }
  }
}
function AL(e, t) {
  var a, u, d;
  const n = e.seen.get(t);
  if (!n)
    throw new Error("Unprocessed schema. This is a bug in Zod.");
  const r = (f) => {
    const h = e.seen.get(f);
    if (h.ref === null)
      return;
    const m = h.def ?? h.schema, x = { ...m }, b = h.ref;
    if (h.ref = null, b) {
      r(b);
      const S = e.seen.get(b), C = S.schema;
      if (C.$ref && (e.target === "draft-07" || e.target === "draft-04" || e.target === "openapi-3.0") ? (m.allOf = m.allOf ?? [], m.allOf.push(C)) : Object.assign(m, C), Object.assign(m, x), f._zod.parent === b)
        for (const R in m)
          R === "$ref" || R === "allOf" || R in x || delete m[R];
      if (C.$ref)
        for (const R in m)
          R === "$ref" || R === "allOf" || R in S.def && JSON.stringify(m[R]) === JSON.stringify(S.def[R]) && delete m[R];
    }
    const w = f._zod.parent;
    if (w && w !== b) {
      r(w);
      const S = e.seen.get(w);
      if (S != null && S.schema.$ref && (m.$ref = S.schema.$ref, S.def))
        for (const C in m)
          C === "$ref" || C === "allOf" || C in S.def && JSON.stringify(m[C]) === JSON.stringify(S.def[C]) && delete m[C];
    }
    e.override({
      zodSchema: f,
      jsonSchema: m,
      path: h.path ?? []
    });
  };
  for (const f of [...e.seen.entries()].reverse())
    r(f[0]);
  const i = {};
  if (e.target === "draft-2020-12" ? i.$schema = "https://json-schema.org/draft/2020-12/schema" : e.target === "draft-07" ? i.$schema = "http://json-schema.org/draft-07/schema#" : e.target === "draft-04" && (i.$schema = "http://json-schema.org/draft-04/schema#"), (a = e.external) != null && a.uri) {
    const f = (u = e.external.registry.get(t)) == null ? void 0 : u.id;
    if (!f)
      throw new Error("Schema is missing an `id` property");
    i.$id = e.external.uri(f);
  }
  Object.assign(i, n.def ?? n.schema);
  const s = ((d = e.external) == null ? void 0 : d.defs) ?? {};
  for (const f of e.seen.entries()) {
    const h = f[1];
    h.def && h.defId && (s[h.defId] = h.def);
  }
  e.external || Object.keys(s).length > 0 && (e.target === "draft-2020-12" ? i.$defs = s : i.definitions = s);
  try {
    const f = JSON.parse(JSON.stringify(i));
    return Object.defineProperty(f, "~standard", {
      value: {
        ...t["~standard"],
        jsonSchema: {
          input: bb(t, "input", e.processors),
          output: bb(t, "output", e.processors)
        }
      },
      enumerable: !1,
      writable: !1
    }), f;
  } catch {
    throw new Error("Error converting schema to JSON.");
  }
}
function Rs(e, t) {
  const n = t ?? { seen: /* @__PURE__ */ new Set() };
  if (n.seen.has(e))
    return !1;
  n.seen.add(e);
  const r = e._zod.def;
  if (r.type === "transform")
    return !0;
  if (r.type === "array")
    return Rs(r.element, n);
  if (r.type === "set")
    return Rs(r.valueType, n);
  if (r.type === "lazy")
    return Rs(r.getter(), n);
  if (r.type === "promise" || r.type === "optional" || r.type === "nonoptional" || r.type === "nullable" || r.type === "readonly" || r.type === "default" || r.type === "prefault")
    return Rs(r.innerType, n);
  if (r.type === "intersection")
    return Rs(r.left, n) || Rs(r.right, n);
  if (r.type === "record" || r.type === "map")
    return Rs(r.keyType, n) || Rs(r.valueType, n);
  if (r.type === "pipe")
    return Rs(r.in, n) || Rs(r.out, n);
  if (r.type === "object") {
    for (const i in r.shape)
      if (Rs(r.shape[i], n))
        return !0;
    return !1;
  }
  if (r.type === "union") {
    for (const i of r.options)
      if (Rs(i, n))
        return !0;
    return !1;
  }
  if (r.type === "tuple") {
    for (const i of r.items)
      if (Rs(i, n))
        return !0;
    return !!(r.rest && Rs(r.rest, n));
  }
  return !1;
}
const gae = (e, t = {}) => (n) => {
  const r = TL({ ...n, processors: t });
  return ri(e, r), jL(r, e), AL(r, e);
}, bb = (e, t, n = {}) => (r) => {
  const { libraryOptions: i, target: s } = r ?? {}, a = TL({ ...i ?? {}, target: s, io: t, processors: n });
  return ri(e, a), jL(a, e), AL(a, e);
}, yae = {
  guid: "uuid",
  url: "uri",
  datetime: "date-time",
  json_string: "json-string",
  regex: ""
  // do not set
}, xae = (e, t, n, r) => {
  const i = n;
  i.type = "string";
  const { minimum: s, maximum: a, format: u, patterns: d, contentEncoding: f } = e._zod.bag;
  if (typeof s == "number" && (i.minLength = s), typeof a == "number" && (i.maxLength = a), u && (i.format = yae[u] ?? u, i.format === "" && delete i.format, u === "time" && delete i.format), f && (i.contentEncoding = f), d && d.size > 0) {
    const h = [...d];
    h.length === 1 ? i.pattern = h[0].source : h.length > 1 && (i.allOf = [
      ...h.map((m) => ({
        ...t.target === "draft-07" || t.target === "draft-04" || t.target === "openapi-3.0" ? { type: "string" } : {},
        pattern: m.source
      }))
    ]);
  }
}, vae = (e, t, n, r) => {
  n.not = {};
}, bae = (e, t, n, r) => {
}, wae = (e, t, n, r) => {
}, _ae = (e, t, n, r) => {
  const i = e._zod.def, s = fL(i.entries);
  s.every((a) => typeof a == "number") && (n.type = "number"), s.every((a) => typeof a == "string") && (n.type = "string"), n.enum = s;
}, Sae = (e, t, n, r) => {
  if (t.unrepresentable === "throw")
    throw new Error("Custom types cannot be represented in JSON Schema");
}, Eae = (e, t, n, r) => {
  if (t.unrepresentable === "throw")
    throw new Error("Transforms cannot be represented in JSON Schema");
}, Cae = (e, t, n, r) => {
  const i = n, s = e._zod.def, { minimum: a, maximum: u } = e._zod.bag;
  typeof a == "number" && (i.minItems = a), typeof u == "number" && (i.maxItems = u), i.type = "array", i.items = ri(s.element, t, { ...r, path: [...r.path, "items"] });
}, kae = (e, t, n, r) => {
  var f;
  const i = n, s = e._zod.def;
  i.type = "object", i.properties = {};
  const a = s.shape;
  for (const h in a)
    i.properties[h] = ri(a[h], t, {
      ...r,
      path: [...r.path, "properties", h]
    });
  const u = new Set(Object.keys(a)), d = new Set([...u].filter((h) => {
    const m = s.shape[h]._zod;
    return t.io === "input" ? m.optin === void 0 : m.optout === void 0;
  }));
  d.size > 0 && (i.required = Array.from(d)), ((f = s.catchall) == null ? void 0 : f._zod.def.type) === "never" ? i.additionalProperties = !1 : s.catchall ? s.catchall && (i.additionalProperties = ri(s.catchall, t, {
    ...r,
    path: [...r.path, "additionalProperties"]
  })) : t.io === "output" && (i.additionalProperties = !1);
}, Tae = (e, t, n, r) => {
  const i = e._zod.def, s = i.inclusive === !1, a = i.options.map((u, d) => ri(u, t, {
    ...r,
    path: [...r.path, s ? "oneOf" : "anyOf", d]
  }));
  s ? n.oneOf = a : n.anyOf = a;
}, jae = (e, t, n, r) => {
  const i = e._zod.def, s = ri(i.left, t, {
    ...r,
    path: [...r.path, "allOf", 0]
  }), a = ri(i.right, t, {
    ...r,
    path: [...r.path, "allOf", 1]
  }), u = (f) => "allOf" in f && Object.keys(f).length === 1, d = [
    ...u(s) ? s.allOf : [s],
    ...u(a) ? a.allOf : [a]
  ];
  n.allOf = d;
}, Aae = (e, t, n, r) => {
  const i = n, s = e._zod.def;
  i.type = "object";
  const a = s.keyType, u = a._zod.bag, d = u == null ? void 0 : u.patterns;
  if (s.mode === "loose" && d && d.size > 0) {
    const h = ri(s.valueType, t, {
      ...r,
      path: [...r.path, "patternProperties", "*"]
    });
    i.patternProperties = {};
    for (const m of d)
      i.patternProperties[m.source] = h;
  } else
    (t.target === "draft-07" || t.target === "draft-2020-12") && (i.propertyNames = ri(s.keyType, t, {
      ...r,
      path: [...r.path, "propertyNames"]
    })), i.additionalProperties = ri(s.valueType, t, {
      ...r,
      path: [...r.path, "additionalProperties"]
    });
  const f = a._zod.values;
  if (f) {
    const h = [...f].filter((m) => typeof m == "string" || typeof m == "number");
    h.length > 0 && (i.required = h);
  }
}, Nae = (e, t, n, r) => {
  const i = e._zod.def, s = ri(i.innerType, t, r), a = t.seen.get(e);
  t.target === "openapi-3.0" ? (a.ref = i.innerType, n.nullable = !0) : n.anyOf = [s, { type: "null" }];
}, Rae = (e, t, n, r) => {
  const i = e._zod.def;
  ri(i.innerType, t, r);
  const s = t.seen.get(e);
  s.ref = i.innerType;
}, Mae = (e, t, n, r) => {
  const i = e._zod.def;
  ri(i.innerType, t, r);
  const s = t.seen.get(e);
  s.ref = i.innerType, n.default = JSON.parse(JSON.stringify(i.defaultValue));
}, Oae = (e, t, n, r) => {
  const i = e._zod.def;
  ri(i.innerType, t, r);
  const s = t.seen.get(e);
  s.ref = i.innerType, t.io === "input" && (n._prefault = JSON.parse(JSON.stringify(i.defaultValue)));
}, Dae = (e, t, n, r) => {
  const i = e._zod.def;
  ri(i.innerType, t, r);
  const s = t.seen.get(e);
  s.ref = i.innerType;
  let a;
  try {
    a = i.catchValue(void 0);
  } catch {
    throw new Error("Dynamic catch values are not supported in JSON Schema");
  }
  n.default = a;
}, zae = (e, t, n, r) => {
  const i = e._zod.def, s = t.io === "input" ? i.in._zod.def.type === "transform" ? i.out : i.in : i.out;
  ri(s, t, r);
  const a = t.seen.get(e);
  a.ref = s;
}, Pae = (e, t, n, r) => {
  const i = e._zod.def;
  ri(i.innerType, t, r);
  const s = t.seen.get(e);
  s.ref = i.innerType, n.readOnly = !0;
}, NL = (e, t, n, r) => {
  const i = e._zod.def;
  ri(i.innerType, t, r);
  const s = t.seen.get(e);
  s.ref = i.innerType;
}, Iae = /* @__PURE__ */ Xe("ZodISODateTime", (e, t) => {
  Hie.init(e, t), Ar.init(e, t);
});
function Lae(e) {
  return /* @__PURE__ */ Yse(Iae, e);
}
const Bae = /* @__PURE__ */ Xe("ZodISODate", (e, t) => {
  Vie.init(e, t), Ar.init(e, t);
});
function $ae(e) {
  return /* @__PURE__ */ Wse(Bae, e);
}
const qae = /* @__PURE__ */ Xe("ZodISOTime", (e, t) => {
  Gie.init(e, t), Ar.init(e, t);
});
function Fae(e) {
  return /* @__PURE__ */ Zse(qae, e);
}
const Uae = /* @__PURE__ */ Xe("ZodISODuration", (e, t) => {
  Kie.init(e, t), Ar.init(e, t);
});
function Hae(e) {
  return /* @__PURE__ */ Xse(Uae, e);
}
const Vae = (e, t) => {
  gL.init(e, t), e.name = "ZodError", Object.defineProperties(e, {
    format: {
      value: (n) => $re(e, n)
      // enumerable: false,
    },
    flatten: {
      value: (n) => Bre(e, n)
      // enumerable: false,
    },
    addIssue: {
      value: (n) => {
        e.issues.push(n), e.message = JSON.stringify(e.issues, J3, 2);
      }
      // enumerable: false,
    },
    addIssues: {
      value: (n) => {
        e.issues.push(...n), e.message = JSON.stringify(e.issues, J3, 2);
      }
      // enumerable: false,
    },
    isEmpty: {
      get() {
        return e.issues.length === 0;
      }
      // enumerable: false,
    }
  });
}, uo = Xe("ZodError", Vae, {
  Parent: Error
}), Gae = /* @__PURE__ */ OT(uo), Kae = /* @__PURE__ */ DT(uo), Yae = /* @__PURE__ */ ow(uo), Wae = /* @__PURE__ */ lw(uo), Zae = /* @__PURE__ */ Ure(uo), Xae = /* @__PURE__ */ Hre(uo), Qae = /* @__PURE__ */ Vre(uo), Jae = /* @__PURE__ */ Gre(uo), eoe = /* @__PURE__ */ Kre(uo), toe = /* @__PURE__ */ Yre(uo), noe = /* @__PURE__ */ Wre(uo), roe = /* @__PURE__ */ Zre(uo), Kr = /* @__PURE__ */ Xe("ZodType", (e, t) => (Gr.init(e, t), Object.assign(e["~standard"], {
  jsonSchema: {
    input: bb(e, "input"),
    output: bb(e, "output")
  }
}), e.toJSONSchema = gae(e, {}), e.def = t, e.type = t.type, Object.defineProperty(e, "_def", { value: t }), e.check = (...n) => e.clone(Nd(t, {
  checks: [
    ...t.checks ?? [],
    ...n.map((r) => typeof r == "function" ? { _zod: { check: r, def: { check: "custom" }, onattach: [] } } : r)
  ]
}), {
  parent: !0
}), e.with = e.check, e.clone = (n, r) => Rd(e, n, r), e.brand = () => e, e.register = ((n, r) => (n.add(e, r), e)), e.parse = (n, r) => Gae(e, n, r, { callee: e.parse }), e.safeParse = (n, r) => Yae(e, n, r), e.parseAsync = async (n, r) => Kae(e, n, r, { callee: e.parseAsync }), e.safeParseAsync = async (n, r) => Wae(e, n, r), e.spa = e.safeParseAsync, e.encode = (n, r) => Zae(e, n, r), e.decode = (n, r) => Xae(e, n, r), e.encodeAsync = async (n, r) => Qae(e, n, r), e.decodeAsync = async (n, r) => Jae(e, n, r), e.safeEncode = (n, r) => eoe(e, n, r), e.safeDecode = (n, r) => toe(e, n, r), e.safeEncodeAsync = async (n, r) => noe(e, n, r), e.safeDecodeAsync = async (n, r) => roe(e, n, r), e.refine = (n, r) => e.check(Qoe(n, r)), e.superRefine = (n) => e.check(Joe(n)), e.overwrite = (n) => e.check(/* @__PURE__ */ Ym(n)), e.optional = () => p6(e), e.exactOptional = () => Boe(e), e.nullable = () => m6(e), e.nullish = () => p6(m6(e)), e.nonoptional = (n) => Voe(e, n), e.array = () => fy(e), e.or = (n) => Noe([e, n]), e.and = (n) => Moe(e, n), e.transform = (n) => g6(e, Ioe(n)), e.default = (n) => Foe(e, n), e.prefault = (n) => Hoe(e, n), e.catch = (n) => Koe(e, n), e.pipe = (n) => g6(e, n), e.readonly = () => Zoe(e), e.describe = (n) => {
  const r = e.clone();
  return J0.add(r, { description: n }), r;
}, Object.defineProperty(e, "description", {
  get() {
    var n;
    return (n = J0.get(e)) == null ? void 0 : n.description;
  },
  configurable: !0
}), e.meta = (...n) => {
  if (n.length === 0)
    return J0.get(e);
  const r = e.clone();
  return J0.add(r, n[0]), r;
}, e.isOptional = () => e.safeParse(void 0).success, e.isNullable = () => e.safeParse(null).success, e.apply = (n) => n(e), e)), RL = /* @__PURE__ */ Xe("_ZodString", (e, t) => {
  zT.init(e, t), Kr.init(e, t), e._zod.processJSONSchema = (r, i, s) => xae(e, r, i);
  const n = e._zod.bag;
  e.format = n.format ?? null, e.minLength = n.minimum ?? null, e.maxLength = n.maximum ?? null, e.regex = (...r) => e.check(/* @__PURE__ */ tae(...r)), e.includes = (...r) => e.check(/* @__PURE__ */ iae(...r)), e.startsWith = (...r) => e.check(/* @__PURE__ */ sae(...r)), e.endsWith = (...r) => e.check(/* @__PURE__ */ aae(...r)), e.min = (...r) => e.check(/* @__PURE__ */ vb(...r)), e.max = (...r) => e.check(/* @__PURE__ */ CL(...r)), e.length = (...r) => e.check(/* @__PURE__ */ kL(...r)), e.nonempty = (...r) => e.check(/* @__PURE__ */ vb(1, ...r)), e.lowercase = (r) => e.check(/* @__PURE__ */ nae(r)), e.uppercase = (r) => e.check(/* @__PURE__ */ rae(r)), e.trim = () => e.check(/* @__PURE__ */ lae()), e.normalize = (...r) => e.check(/* @__PURE__ */ oae(...r)), e.toLowerCase = () => e.check(/* @__PURE__ */ uae()), e.toUpperCase = () => e.check(/* @__PURE__ */ cae()), e.slugify = () => e.check(/* @__PURE__ */ dae());
}), ioe = /* @__PURE__ */ Xe("ZodString", (e, t) => {
  zT.init(e, t), RL.init(e, t), e.email = (n) => e.check(/* @__PURE__ */ Tse(soe, n)), e.url = (n) => e.check(/* @__PURE__ */ Mse(aoe, n)), e.jwt = (n) => e.check(/* @__PURE__ */ Kse(woe, n)), e.emoji = (n) => e.check(/* @__PURE__ */ Ose(ooe, n)), e.guid = (n) => e.check(/* @__PURE__ */ f6(h6, n)), e.uuid = (n) => e.check(/* @__PURE__ */ jse(y1, n)), e.uuidv4 = (n) => e.check(/* @__PURE__ */ Ase(y1, n)), e.uuidv6 = (n) => e.check(/* @__PURE__ */ Nse(y1, n)), e.uuidv7 = (n) => e.check(/* @__PURE__ */ Rse(y1, n)), e.nanoid = (n) => e.check(/* @__PURE__ */ Dse(loe, n)), e.guid = (n) => e.check(/* @__PURE__ */ f6(h6, n)), e.cuid = (n) => e.check(/* @__PURE__ */ zse(uoe, n)), e.cuid2 = (n) => e.check(/* @__PURE__ */ Pse(coe, n)), e.ulid = (n) => e.check(/* @__PURE__ */ Ise(doe, n)), e.base64 = (n) => e.check(/* @__PURE__ */ Hse(xoe, n)), e.base64url = (n) => e.check(/* @__PURE__ */ Vse(voe, n)), e.xid = (n) => e.check(/* @__PURE__ */ Lse(foe, n)), e.ksuid = (n) => e.check(/* @__PURE__ */ Bse(hoe, n)), e.ipv4 = (n) => e.check(/* @__PURE__ */ $se(poe, n)), e.ipv6 = (n) => e.check(/* @__PURE__ */ qse(moe, n)), e.cidrv4 = (n) => e.check(/* @__PURE__ */ Fse(goe, n)), e.cidrv6 = (n) => e.check(/* @__PURE__ */ Use(yoe, n)), e.e164 = (n) => e.check(/* @__PURE__ */ Gse(boe, n)), e.datetime = (n) => e.check(Lae(n)), e.date = (n) => e.check($ae(n)), e.time = (n) => e.check(Fae(n)), e.duration = (n) => e.check(Hae(n));
});
function ey(e) {
  return /* @__PURE__ */ kse(ioe, e);
}
const Ar = /* @__PURE__ */ Xe("ZodStringFormat", (e, t) => {
  vr.init(e, t), RL.init(e, t);
}), soe = /* @__PURE__ */ Xe("ZodEmail", (e, t) => {
  zie.init(e, t), Ar.init(e, t);
}), h6 = /* @__PURE__ */ Xe("ZodGUID", (e, t) => {
  Oie.init(e, t), Ar.init(e, t);
}), y1 = /* @__PURE__ */ Xe("ZodUUID", (e, t) => {
  Die.init(e, t), Ar.init(e, t);
}), aoe = /* @__PURE__ */ Xe("ZodURL", (e, t) => {
  Pie.init(e, t), Ar.init(e, t);
}), ooe = /* @__PURE__ */ Xe("ZodEmoji", (e, t) => {
  Iie.init(e, t), Ar.init(e, t);
}), loe = /* @__PURE__ */ Xe("ZodNanoID", (e, t) => {
  Lie.init(e, t), Ar.init(e, t);
}), uoe = /* @__PURE__ */ Xe("ZodCUID", (e, t) => {
  Bie.init(e, t), Ar.init(e, t);
}), coe = /* @__PURE__ */ Xe("ZodCUID2", (e, t) => {
  $ie.init(e, t), Ar.init(e, t);
}), doe = /* @__PURE__ */ Xe("ZodULID", (e, t) => {
  qie.init(e, t), Ar.init(e, t);
}), foe = /* @__PURE__ */ Xe("ZodXID", (e, t) => {
  Fie.init(e, t), Ar.init(e, t);
}), hoe = /* @__PURE__ */ Xe("ZodKSUID", (e, t) => {
  Uie.init(e, t), Ar.init(e, t);
}), poe = /* @__PURE__ */ Xe("ZodIPv4", (e, t) => {
  Yie.init(e, t), Ar.init(e, t);
}), moe = /* @__PURE__ */ Xe("ZodIPv6", (e, t) => {
  Wie.init(e, t), Ar.init(e, t);
}), goe = /* @__PURE__ */ Xe("ZodCIDRv4", (e, t) => {
  Zie.init(e, t), Ar.init(e, t);
}), yoe = /* @__PURE__ */ Xe("ZodCIDRv6", (e, t) => {
  Xie.init(e, t), Ar.init(e, t);
}), xoe = /* @__PURE__ */ Xe("ZodBase64", (e, t) => {
  Qie.init(e, t), Ar.init(e, t);
}), voe = /* @__PURE__ */ Xe("ZodBase64URL", (e, t) => {
  ese.init(e, t), Ar.init(e, t);
}), boe = /* @__PURE__ */ Xe("ZodE164", (e, t) => {
  tse.init(e, t), Ar.init(e, t);
}), woe = /* @__PURE__ */ Xe("ZodJWT", (e, t) => {
  rse.init(e, t), Ar.init(e, t);
}), _oe = /* @__PURE__ */ Xe("ZodAny", (e, t) => {
  ise.init(e, t), Kr.init(e, t), e._zod.processJSONSchema = (n, r, i) => bae();
});
function Soe() {
  return /* @__PURE__ */ Qse(_oe);
}
const Eoe = /* @__PURE__ */ Xe("ZodUnknown", (e, t) => {
  sse.init(e, t), Kr.init(e, t), e._zod.processJSONSchema = (n, r, i) => wae();
});
function t5() {
  return /* @__PURE__ */ Jse(Eoe);
}
const Coe = /* @__PURE__ */ Xe("ZodNever", (e, t) => {
  ase.init(e, t), Kr.init(e, t), e._zod.processJSONSchema = (n, r, i) => vae(e, n, r);
});
function koe(e) {
  return /* @__PURE__ */ eae(Coe, e);
}
const Toe = /* @__PURE__ */ Xe("ZodArray", (e, t) => {
  ose.init(e, t), Kr.init(e, t), e._zod.processJSONSchema = (n, r, i) => Cae(e, n, r, i), e.element = t.element, e.min = (n, r) => e.check(/* @__PURE__ */ vb(n, r)), e.nonempty = (n) => e.check(/* @__PURE__ */ vb(1, n)), e.max = (n, r) => e.check(/* @__PURE__ */ CL(n, r)), e.length = (n, r) => e.check(/* @__PURE__ */ kL(n, r)), e.unwrap = () => e.element;
});
function fy(e, t) {
  return /* @__PURE__ */ fae(Toe, e, t);
}
const joe = /* @__PURE__ */ Xe("ZodObject", (e, t) => {
  use.init(e, t), Kr.init(e, t), e._zod.processJSONSchema = (n, r, i) => kae(e, n, r, i), Fn(e, "shape", () => t.shape), e.keyof = () => zoe(Object.keys(e._zod.def.shape)), e.catchall = (n) => e.clone({ ...e._zod.def, catchall: n }), e.passthrough = () => e.clone({ ...e._zod.def, catchall: t5() }), e.loose = () => e.clone({ ...e._zod.def, catchall: t5() }), e.strict = () => e.clone({ ...e._zod.def, catchall: koe() }), e.strip = () => e.clone({ ...e._zod.def, catchall: void 0 }), e.extend = (n) => Dre(e, n), e.safeExtend = (n) => zre(e, n), e.merge = (n) => Pre(e, n), e.pick = (n) => Mre(e, n), e.omit = (n) => Ore(e, n), e.partial = (...n) => Ire(ML, e, n[0]), e.required = (...n) => Lre(OL, e, n[0]);
});
function n5(e, t) {
  const n = {
    type: "object",
    shape: e ?? {},
    ...Ut(t)
  };
  return new joe(n);
}
const Aoe = /* @__PURE__ */ Xe("ZodUnion", (e, t) => {
  cse.init(e, t), Kr.init(e, t), e._zod.processJSONSchema = (n, r, i) => Tae(e, n, r, i), e.options = t.options;
});
function Noe(e, t) {
  return new Aoe({
    type: "union",
    options: e,
    ...Ut(t)
  });
}
const Roe = /* @__PURE__ */ Xe("ZodIntersection", (e, t) => {
  dse.init(e, t), Kr.init(e, t), e._zod.processJSONSchema = (n, r, i) => jae(e, n, r, i);
});
function Moe(e, t) {
  return new Roe({
    type: "intersection",
    left: e,
    right: t
  });
}
const Ooe = /* @__PURE__ */ Xe("ZodRecord", (e, t) => {
  fse.init(e, t), Kr.init(e, t), e._zod.processJSONSchema = (n, r, i) => Aae(e, n, r, i), e.keyType = t.keyType, e.valueType = t.valueType;
});
function Doe(e, t, n) {
  return new Ooe({
    type: "record",
    keyType: e,
    valueType: t,
    ...Ut(n)
  });
}
const r5 = /* @__PURE__ */ Xe("ZodEnum", (e, t) => {
  hse.init(e, t), Kr.init(e, t), e._zod.processJSONSchema = (r, i, s) => _ae(e, r, i), e.enum = t.entries, e.options = Object.values(t.entries);
  const n = new Set(Object.keys(t.entries));
  e.extract = (r, i) => {
    const s = {};
    for (const a of r)
      if (n.has(a))
        s[a] = t.entries[a];
      else
        throw new Error(`Key ${a} not found in enum`);
    return new r5({
      ...t,
      checks: [],
      ...Ut(i),
      entries: s
    });
  }, e.exclude = (r, i) => {
    const s = { ...t.entries };
    for (const a of r)
      if (n.has(a))
        delete s[a];
      else
        throw new Error(`Key ${a} not found in enum`);
    return new r5({
      ...t,
      checks: [],
      ...Ut(i),
      entries: s
    });
  };
});
function zoe(e, t) {
  const n = Array.isArray(e) ? Object.fromEntries(e.map((r) => [r, r])) : e;
  return new r5({
    type: "enum",
    entries: n,
    ...Ut(t)
  });
}
const Poe = /* @__PURE__ */ Xe("ZodTransform", (e, t) => {
  pse.init(e, t), Kr.init(e, t), e._zod.processJSONSchema = (n, r, i) => Eae(e, n), e._zod.parse = (n, r) => {
    if (r.direction === "backward")
      throw new cL(e.constructor.name);
    n.addIssue = (s) => {
      if (typeof s == "string")
        n.issues.push(Ny(s, n.value, t));
      else {
        const a = s;
        a.fatal && (a.continue = !1), a.code ?? (a.code = "custom"), a.input ?? (a.input = n.value), a.inst ?? (a.inst = e), n.issues.push(Ny(a));
      }
    };
    const i = t.transform(n.value, n);
    return i instanceof Promise ? i.then((s) => (n.value = s, n)) : (n.value = i, n);
  };
});
function Ioe(e) {
  return new Poe({
    type: "transform",
    transform: e
  });
}
const ML = /* @__PURE__ */ Xe("ZodOptional", (e, t) => {
  EL.init(e, t), Kr.init(e, t), e._zod.processJSONSchema = (n, r, i) => NL(e, n, r, i), e.unwrap = () => e._zod.def.innerType;
});
function p6(e) {
  return new ML({
    type: "optional",
    innerType: e
  });
}
const Loe = /* @__PURE__ */ Xe("ZodExactOptional", (e, t) => {
  mse.init(e, t), Kr.init(e, t), e._zod.processJSONSchema = (n, r, i) => NL(e, n, r, i), e.unwrap = () => e._zod.def.innerType;
});
function Boe(e) {
  return new Loe({
    type: "optional",
    innerType: e
  });
}
const $oe = /* @__PURE__ */ Xe("ZodNullable", (e, t) => {
  gse.init(e, t), Kr.init(e, t), e._zod.processJSONSchema = (n, r, i) => Nae(e, n, r, i), e.unwrap = () => e._zod.def.innerType;
});
function m6(e) {
  return new $oe({
    type: "nullable",
    innerType: e
  });
}
const qoe = /* @__PURE__ */ Xe("ZodDefault", (e, t) => {
  yse.init(e, t), Kr.init(e, t), e._zod.processJSONSchema = (n, r, i) => Mae(e, n, r, i), e.unwrap = () => e._zod.def.innerType, e.removeDefault = e.unwrap;
});
function Foe(e, t) {
  return new qoe({
    type: "default",
    innerType: e,
    get defaultValue() {
      return typeof t == "function" ? t() : pL(t);
    }
  });
}
const Uoe = /* @__PURE__ */ Xe("ZodPrefault", (e, t) => {
  xse.init(e, t), Kr.init(e, t), e._zod.processJSONSchema = (n, r, i) => Oae(e, n, r, i), e.unwrap = () => e._zod.def.innerType;
});
function Hoe(e, t) {
  return new Uoe({
    type: "prefault",
    innerType: e,
    get defaultValue() {
      return typeof t == "function" ? t() : pL(t);
    }
  });
}
const OL = /* @__PURE__ */ Xe("ZodNonOptional", (e, t) => {
  vse.init(e, t), Kr.init(e, t), e._zod.processJSONSchema = (n, r, i) => Rae(e, n, r, i), e.unwrap = () => e._zod.def.innerType;
});
function Voe(e, t) {
  return new OL({
    type: "nonoptional",
    innerType: e,
    ...Ut(t)
  });
}
const Goe = /* @__PURE__ */ Xe("ZodCatch", (e, t) => {
  bse.init(e, t), Kr.init(e, t), e._zod.processJSONSchema = (n, r, i) => Dae(e, n, r, i), e.unwrap = () => e._zod.def.innerType, e.removeCatch = e.unwrap;
});
function Koe(e, t) {
  return new Goe({
    type: "catch",
    innerType: e,
    catchValue: typeof t == "function" ? t : () => t
  });
}
const Yoe = /* @__PURE__ */ Xe("ZodPipe", (e, t) => {
  wse.init(e, t), Kr.init(e, t), e._zod.processJSONSchema = (n, r, i) => zae(e, n, r, i), e.in = t.in, e.out = t.out;
});
function g6(e, t) {
  return new Yoe({
    type: "pipe",
    in: e,
    out: t
    // ...util.normalizeParams(params),
  });
}
const Woe = /* @__PURE__ */ Xe("ZodReadonly", (e, t) => {
  _se.init(e, t), Kr.init(e, t), e._zod.processJSONSchema = (n, r, i) => Pae(e, n, r, i), e.unwrap = () => e._zod.def.innerType;
});
function Zoe(e) {
  return new Woe({
    type: "readonly",
    innerType: e
  });
}
const Xoe = /* @__PURE__ */ Xe("ZodCustom", (e, t) => {
  Sse.init(e, t), Kr.init(e, t), e._zod.processJSONSchema = (n, r, i) => Sae(e, n);
});
function Qoe(e, t = {}) {
  return /* @__PURE__ */ hae(Xoe, e, t);
}
function Joe(e) {
  return /* @__PURE__ */ pae(e);
}
const ele = n5({
  name: ey(),
  type: ey(),
  // z.enum(['char', 'loc', ...]) but permissive for now
  aliases: fy(ey()).optional(),
  profile: Doe(ey(), t5()).optional()
}), tle = n5({
  entities: fy(ele).optional(),
  patches: fy(n5({
    name: ey(),
    ops: fy(Soe())
  })).optional()
});
class DL {
  constructor() {
    lt(this, "name", "SaveEntity");
  }
  async execute(t) {
    const n = vi.getState(), r = t.input._rawExistingEntities || await n.getAllEntities();
    let i, s = t.parsedData;
    if (typeof t.output == "string")
      try {
        s = JSON.parse(t.output);
      } catch (f) {
        throw new Error(`SaveEntity: Failed to re-parse user modified content - ${f}`);
      }
    else t.output && typeof t.output == "object" && (s = t.output);
    if (!s) return;
    try {
      i = tle.parse(s);
    } catch (f) {
      throw new Error(`SaveEntity: Zod Validation Failed - ${f}`);
    }
    const a = [], u = [], d = t.config.dryRun === !0;
    if (i.entities)
      for (const f of i.entities) {
        if (r.find((x) => {
          var b;
          return x.name === f.name || ((b = x.aliases) == null ? void 0 : b.includes(f.name));
        })) continue;
        const m = {
          name: f.name,
          type: f.type || WI.Unknown,
          aliases: f.aliases || [],
          profile: f.profile || {},
          description: this.profileToYaml(f.name, f.type, f.profile || {})
        };
        if (d)
          m.id = `temp-${Date.now()}`, a.push(m);
        else {
          const x = await n.saveEntity(m);
          a.push(x);
        }
      }
    if (i.patches)
      for (const f of i.patches) {
        const h = r.find((m) => m.name === f.name || m.id === f.name);
        if (h)
          try {
            const m = JSON.parse(JSON.stringify(h));
            if (uL(m, f.ops), d)
              u.push(m);
            else {
              const x = this.profileToYaml(m.name, m.type, m.profile || {});
              await n.updateEntity(h.id, {
                profile: m.profile,
                aliases: m.aliases,
                description: x,
                name: m.name,
                type: m.type
              }), u.push(m);
            }
          } catch (m) {
            ee.warn("SaveEntity", `Patch failed for ${f.name}`, m);
          }
      }
    t.output = {
      newEntities: a,
      updatedEntities: u
    }, ee.info("SaveEntity", `:  ${a.length},  ${u.length} (DryRun: ${d})`);
  }
  // Helper: Profile to YAML (Simplified version)
  profileToYaml(t, n, r) {
    return `${t} (${n})
${JSON.stringify(r, null, 2)}`;
  }
}
class zL {
  constructor() {
    lt(this, "name", "SaveEvent");
  }
  async execute(t) {
    const n = t.output || t.cleanedContent;
    if (!n)
      throw new Error("SaveEvent: ");
    const r = vi.getState();
    if (!await r.initChat()) throw new Error("No chat context");
    let s = [];
    if (t.parsedData && t.parsedData.events)
      s = t.parsedData.events;
    else
      try {
        const { RobustJsonParser: d } = await Promise.resolve().then(() => nle), f = d.parse(n);
        f && f.events && (s = f.events);
      } catch {
        throw new Error("SaveEvent:  JSON ");
      }
    if (s.length === 0)
      throw new Error("SaveEvent: ");
    const a = [], u = t.input.range || [0, 0];
    for (const d of s) {
      const f = d.meta || {}, h = [];
      f.time_anchor && h.push(f.time_anchor), f.location && !Array.isArray(f.location) && h.push(f.location), f.role && f.role.length > 0 && h.push(f.role.join(", "));
      const m = h.length > 0 ? `(${h.join(" | ")}) ` : "", x = f.event ? `${f.event}:
` : "", b = [];
      f.logic && f.logic.length > 0 && b.push(`[: ${f.logic.join(", ")}]`), f.causality && b.push(`[: ${f.causality}]`);
      const w = b.length > 0 ? `
${b.join(" ")}` : "";
      let S = d.summary || `[Summary Missing] ${f.event || ""}`;
      const C = `${x}${m}${S}${w}`, T = await r.saveEvent({
        summary: C,
        structured_kv: {
          time_anchor: f.time_anchor || "",
          role: f.role || [],
          location: Array.isArray(f.location) ? f.location : f.location ? [f.location] : [],
          event: f.event || "",
          logic: f.logic || [],
          causality: f.causality || ""
        },
        significance_score: d.significance_score || 0.5,
        level: 0,
        is_embedded: !1,
        is_archived: !1,
        source_range: {
          start_index: u[0],
          end_index: u[1]
        }
      });
      a.push(T);
    }
    if (t.output = a, u[1] > 0 && await r.setLastSummarizedFloor(u[1]), await Ds.refreshEngramCache(), t.config.autoHide && u[1] > 0) {
      const d = u[0] - 1, f = u[1] - 1;
      JI(d, f).catch((h) => {
        ee.error("SaveEvent", "", h);
      });
    }
    ee.success("SaveEvent", ` ${a.length} `), xn.success(` ${a.length} `, "Engram");
  }
}
const V0 = "RegexProcessor";
class PT {
  constructor(t) {
    lt(this, "rules", []);
    lt(this, "ruleRegexCache", /* @__PURE__ */ new Map());
    lt(this, "tagRegexCache", /* @__PURE__ */ new Map());
    this.setRules(t || [...jy]);
  }
  /**
   *  ()
   */
  getCachedRuleRegex(t) {
    const n = `${t.id}|${t.pattern}|${t.flags}`;
    if (this.ruleRegexCache.has(n))
      return this.ruleRegexCache.get(n);
    try {
      const r = new RegExp(t.pattern, t.flags);
      return this.ruleRegexCache.set(n, r), r;
    } catch (r) {
      return ee.warn(V0, `Invalid regex pattern for rule "${t.name}":`, r), null;
    }
  }
  /**
   * 
   * @param text 
   * @param scope 
   */
  process(t, n) {
    let r = t;
    for (const i of this.rules) {
      if (!i.enabled || n && i.scope !== n && i.scope !== "both")
        continue;
      const s = this.getCachedRuleRegex(i);
      if (s)
        try {
          r = r.replace(s, i.replacement);
        } catch (a) {
          ee.warn(V0, `Rule "${i.name}" execution failed:`, a);
        }
    }
    return r;
  }
  /**
   * 
   */
  processWithRule(t, n) {
    const r = this.getCachedRuleRegex(n);
    if (r)
      try {
        return t.replace(r, n.replacement);
      } catch (i) {
        ee.warn(V0, "Rule execution failed:", i);
      }
    return t;
  }
  /**
   * 
   */
  validatePattern(t, n) {
    try {
      return new RegExp(t, n), { valid: !0 };
    } catch (r) {
      return {
        valid: !1,
        error: r instanceof Error ? r.message : ""
      };
    }
  }
  /**
   * 
   */
  getRules() {
    return [...this.rules];
  }
  /**
   *  ()
   */
  setRules(t) {
    this.rules = [...t], this.ruleRegexCache.clear();
  }
  /**
   * 
   */
  addRule(t) {
    this.rules.push(t);
  }
  /**
   * 
   */
  updateRule(t, n) {
    const r = this.rules.findIndex((i) => i.id === t);
    r >= 0 && (this.rules[r] = { ...this.rules[r], ...n }, this.ruleRegexCache.clear());
  }
  /**
   * 
   */
  deleteRule(t) {
    this.rules = this.rules.filter((n) => n.id !== t), this.ruleRegexCache.clear();
  }
  /**
   * /
   */
  toggleRule(t) {
    const n = this.rules.find((r) => r.id === t);
    n && (n.enabled = !n.enabled);
  }
  /**
   * 
   */
  resetToDefaults() {
    this.setRules([...jy]);
  }
  /**
   * 
   */
  getEnabledCount() {
    return this.rules.filter((t) => t.enabled).length;
  }
  // ========== V0.8:  ==========
  getCachedTagRegex(t, n) {
    const r = `${n}:${t}`;
    if (this.tagRegexCache.has(r))
      return this.tagRegexCache.get(r);
    let i;
    return n === "capture" ? i = new RegExp(`<${t}(?:\\s+[^>]*)?>([\\s\\S]*?)<\\/${t}\\s*>`, "i") : i = new RegExp(`<${t}(?:\\s+[^>]*)?>[\\s\\S]*?<\\/${t}\\s*>`, "gi"), this.tagRegexCache.set(r, i), i;
  }
  /**
   * 
   * @param text 
   * @param tagName  ( 'output', 'query')
   * @returns  null
   */
  captureTag(t, n) {
    var r;
    try {
      const i = this.getCachedTagRegex(n, "capture"), s = t.match(i);
      return ((r = s == null ? void 0 : s[1]) == null ? void 0 : r.trim()) || null;
    } catch (i) {
      return ee.warn(V0, `Failed to capture tag: ${n}`, i), null;
    }
  }
  /**
   * 
   * @param text 
   * @param tagName 
   */
  removeTag(t, n) {
    try {
      const r = this.getCachedTagRegex(n, "remove");
      return t.replace(r, "").trim();
    } catch (r) {
      return ee.warn(V0, `Failed to remove tag: ${n}`, r), t;
    }
  }
  /**
   * 
   * @param text 
   * @param tagNames 
   * @returns 
   */
  captureTags(t, n) {
    const r = {};
    for (const i of n)
      r[i] = this.captureTag(t, i);
    return r;
  }
}
const Wm = new PT();
class IT {
  constructor(t = "output") {
    lt(this, "name", "CleanRegex");
    this.type = t;
  }
  async execute(t) {
    var i;
    const n = (i = t.llmResponse) == null ? void 0 : i.content;
    if (!n)
      return;
    const r = Wm.process(n, this.type);
    t.cleanedContent = r, ee.debug("CleanRegex", "");
  }
}
class PL {
  constructor(t = ["output", "query"]) {
    lt(this, "name", "ExtractTags");
    this.tagsToExtract = t;
  }
  async execute(t) {
    var s;
    const n = t.cleanedContent || ((s = t.llmResponse) == null ? void 0 : s.content);
    if (!n) return;
    const r = Wm.captureTags(n, this.tagsToExtract), i = {};
    for (const a of Object.keys(r))
      r[a] && (i[a] = r[a]);
    t.extractedTags = i, r.output && (t.output = r.output, t.cleanedContent = r.output), ee.debug("ExtractTags", `: ${Object.keys(r).join(", ")}`);
  }
}
class IL {
  constructor() {
    lt(this, "name", "FormatTrimInput");
  }
  async execute(t) {
    var i;
    if ((i = t.data) != null && i.skipTrimming)
      return;
    const n = t.input.eventsToMerge;
    if (!n || n.length === 0)
      throw new Error("FormatTrimInput: ");
    const r = n.map((s) => {
      const a = s.structured_kv, u = Array.isArray(a.location) ? a.location.join(", ") : a.location;
      return `${s.summary}
Role: [${a.role.join(", ")}]
Loc: [${u}]
Event: ${a.event}
Logic: [${a.logic.join(", ")}]
Causality: ${a.causality}
Significance: ${s.significance_score}`;
    }).join(`

---

`);
    t.input.eventsText = r, t.input.eventCount = n.length.toString(), ee.debug("FormatTrimInput", ` (${r.length} chars)`);
  }
}
class LT {
  /**
   *  JSON
   * @param input  LLM 
   * @returns  null
   */
  static parse(t) {
    const n = this.extractJsonBlock(t);
    if (!n)
      return console.warn("[RobustJsonParser]  JSON "), null;
    try {
      return JSON.parse(n);
    } catch {
      const i = this.simpleRepair(n);
      try {
        return JSON.parse(i);
      } catch (s) {
        return console.error("[RobustJsonParser] :", s), null;
      }
    }
  }
  /**
   *  JSON 
   *  Markdown 
   */
  static extractJsonBlock(t) {
    const n = t.match(/```(?:json)?\s*([\s\S]*?)```/i);
    if (n && n[1])
      return n[1].trim();
    const r = t.indexOf("{"), i = t.lastIndexOf("}");
    return r !== -1 && i !== -1 && i > r ? t.substring(r, i + 1) : null;
  }
  /**
   *  JSON 
   *  LLM JSON 
   * - 
   */
  static simpleRepair(t) {
    let n = t;
    return n = n.replace(/,\s*([}\]])/g, "$1"), n;
  }
}
const nle = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  RobustJsonParser: LT
}, Symbol.toStringTag, { value: "Module" }));
class BT {
  constructor() {
    lt(this, "name", "ParseJson");
  }
  async execute(t) {
    if (!t.llmResponse || !t.llmResponse.content)
      throw new Error("ParseJson:  LLM ");
    const n = LT.parse(t.llmResponse.content);
    if (!n)
      throw new Error("ParseJson: JSON ");
    t.parsedData = n, ee.debug("ParseJson", "JSON ");
  }
}
const $T = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  ApplyTrim: lL,
  BuildPrompt: tx,
  CleanRegex: IT,
  DEFAULT_REGEX_RULES: jy,
  ExtractTags: PL,
  FetchContext: iw,
  FetchEventsToTrim: rL,
  FetchExistingEntities: iL,
  FormatTrimInput: IL,
  LlmRequest: nx,
  ParseJson: BT,
  REGEX_SCOPE_OPTIONS: F3,
  RegexProcessor: PT,
  SaveEntity: DL,
  SaveEvent: zL,
  StopGeneration: Km,
  UserReview: sw,
  regexProcessor: Wm
}, Symbol.toStringTag, { value: "Module" })), Hr = class Hr {
  /**
   *  Engram 
   */
  static async init() {
    var t, n;
    if (!this.isInitialized)
      try {
        const r = (n = (t = window.SillyTavern) == null ? void 0 : t.getContext) == null ? void 0 : n.call(t);
        if (!(r != null && r.registerMacro)) {
          ee.warn("MacroService", "SillyTavern registerMacro API ");
          return;
        }
        r.registerMacro(
          "engramSummaries",
          () => Hr.cachedSummaries,
          "Engram:  ( IndexedDB)"
        ), r.registerMacro(
          "worldbookContext",
          () => Hr.cachedWorldbookContext,
          "Engram: "
        ), r.registerMacro(
          "userInput",
          () => Hr.cachedUserInput,
          "Engram: "
        ), r.registerMacro(
          "chatHistory",
          () => Hr.getChatHistory(),
          "Engram:  ()"
        ), r.registerMacro(
          "context",
          () => Hr.cachedCharDescription,
          "Engram: "
        ), r.registerMacro(
          "engramGraph",
          () => Hr.cachedGraphData,
          "Engram:  JSON ()"
        ), r.registerMacro(
          "engramArchivedSummaries",
          () => Hr.cachedArchivedSummaries,
          "Engram:  ()"
        ), r.registerMacro(
          "userPersona",
          () => Hr.cachedUserPersona,
          "Engram:  ( Persona Description)"
        ), r.registerMacro(
          "engramEntityStates",
          () => Hr.cachedEntityStates,
          "Engram:  (//)"
        ), this.isInitialized = !0, ee.success("MacroService", "", {
          macros: ["{{engramSummaries}}", "{{worldbookContext}}", "{{userInput}}", "{{chatHistory}}", "{{context}}", "{{engramGraph}}", "{{engramArchivedSummaries}}", "{{userPersona}}", "{{engramEntityStates}}"]
        }), await this.refreshCache();
        const i = r.eventSource;
        i && i.on("chat_id_changed", () => {
          ee.info("MacroService", ""), this.clearCache(), this.refreshCache().catch((s) => ee.warn("MacroService", "", s));
        });
      } catch (r) {
        ee.error("MacroService", "", r);
      }
  }
  /**
   *  (/)
   */
  static clearCache() {
    this.cachedSummaries = "", this.cachedWorldbookContext = "", this.cachedUserInput = "", this.cachedCharDescription = "", this.cachedGraphData = "", this.cachedArchivedSummaries = "", this.cachedUserPersona = "", this.cachedCustomMacros.clear(), this.cachedEntityStates = "";
  }
  /**
   * 
   */
  static getSummaries() {
    return this.cachedSummaries;
  }
  /**
   * 
   */
  static getEntityStates() {
    return this.cachedEntityStates;
  }
  /**
   * 
   */
  static getWorldbookContext() {
    return this.cachedWorldbookContext;
  }
  /**
   * 
   */
  static setUserInput(t) {
    this.cachedUserInput = t;
  }
  /**
   *  ()
   * @param recalledIds RAG  ID 
   */
  static async refreshCache(t) {
    await Promise.all([
      this.refreshEngramCache(t),
      this.refreshWorldbookCache()
    ]), this.refreshUserPersona(), this.refreshCustomMacros();
  }
  /**
   *  Engram  DB  ()
   *  Pipeline 
   *
   * V1.0.2:  recalledIds  BrainRecallCache 
   *  {{engramSummaries}} 
   */
  static async refreshEngramCache(t) {
    try {
      const n = vi.getState();
      let r = t;
      if (!r)
        try {
          const { brainRecallCache: i } = await Promise.resolve().then(() => oL), s = i.getShortTermSnapshot();
          s.length > 0 && (r = s.map((a) => a.id), ee.debug("MacroService", " BrainRecallCache  ID", {
            count: r.length
          }));
        } catch (i) {
          ee.debug("MacroService", "BrainRecallCache ", i);
        }
      this.cachedSummaries = await n.getEventSummaries(r), await this.refreshArchivedSummaries(), this.cachedEntityStates = await n.getEntityStates(), ee.debug("MacroService", "Engram DB ", {
        summariesLength: this.cachedSummaries.length,
        recalledCount: (r == null ? void 0 : r.length) ?? 0
      });
    } catch (n) {
      ee.warn("MacroService", " Engram DB ", n);
    }
  }
  /**
   *  ()
   * 
   */
  static async refreshWorldbookCache() {
    try {
      const t = await Ba.getActivatedWorldInfo(), n = await this.processEJSMacros([t]);
      this.cachedWorldbookContext = n[0] || "", this.refreshCharDescription(), ee.debug("MacroService", "", {
        worldbookLength: this.cachedWorldbookContext.length
      });
    } catch (t) {
      ee.debug("MacroService", "", t), this.cachedWorldbookContext = "";
    }
  }
  /**
   * V0.9: 
   *  EventNode JSON embedding 
   */
  static async refreshGraphCache() {
    try {
      const t = vi.getState(), n = await t.getAllEvents(), r = await t.getAllEntities(), i = n.map((a) => ({
        id: a.id,
        summary: a.summary,
        structured_kv: a.structured_kv,
        significance_score: a.significance_score,
        level: a.level,
        source_range: a.source_range
      })), s = r.map((a) => ({
        id: a.id,
        name: a.name,
        type: a.type,
        aliases: a.aliases || [],
        description: a.description
      }));
      this.cachedGraphData = JSON.stringify({
        events: i,
        existingEntities: s
      }, null, 2), ee.debug("MacroService", "", {
        eventCount: n.length,
        entityCount: r.length
      });
    } catch (t) {
      ee.warn("MacroService", "", t), this.cachedGraphData = JSON.stringify({ events: [], existingEntities: [] });
    }
  }
  /**
   * V0.8.5:  RAG 
   * 
   * @param nodes RAG 
   */
  static async refreshCacheWithNodes(t) {
    try {
      this.cachedSummaries = t.map((n) => n.summary).join(`

---

`);
      try {
        const n = await Ba.getActivatedWorldInfo(), r = await this.processEJSMacros([n]);
        this.cachedWorldbookContext = r[0] || "";
      } catch (n) {
        ee.debug("MacroService", "", n), this.cachedWorldbookContext = "";
      }
      this.refreshCharDescription(), ee.debug("MacroService", "RAG ", {
        summariesLength: this.cachedSummaries.length,
        nodeCount: t.length
      });
    } catch (n) {
      ee.warn("MacroService", " RAG ", n);
    }
  }
  /**
   *  ST-Prompt-Template ()  EJS 
   * V0.8.6:  window.EjsTemplate API ( test/.js)
   */
  static async processEJSMacros(t) {
    if (t.length === 0) return t;
    if (!window.EjsTemplate || typeof window.EjsTemplate.evalTemplate != "function")
      return ee.debug("MacroService", "ST-Prompt-Template  EJS "), t;
    try {
      const n = await window.EjsTemplate.prepareContext();
      if (typeof window.Mvu < "u" && window.Mvu.getMvuData)
        try {
          const i = window.Mvu.getMvuData({ type: "message", message_id: "latest" });
          i && i.stat_data && (n.mvu = i.stat_data);
        } catch (i) {
          ee.warn("MacroService", " MVU ", i);
        }
      return await Promise.all(t.map(async (i) => {
        try {
          return await window.EjsTemplate.evalTemplate(i, n);
        } catch (s) {
          return ee.warn("MacroService", "EJS ", s), i;
        }
      }));
    } catch (n) {
      return ee.warn("MacroService", "EJS ", n), t;
    }
  }
  /**
   * 
   * @param floorRange  [start, end] (1-based, inclusive)
   *  limit 
   */
  static getChatHistory(t) {
    var n, r, i, s;
    try {
      const a = (r = (n = window.SillyTavern) == null ? void 0 : n.getContext) == null ? void 0 : r.call(n), u = window.TavernHelper;
      if (a != null && a.chat && Array.isArray(a.chat)) {
        let d = [];
        if (t) {
          const [f, h] = t, m = f - 1, x = h;
          d = a.chat.slice(m, x), ee.info("MacroService", "getChatHistory ", {
            inputRange: t,
            calcSlice: [m, x],
            chatLen: a.chat.length,
            firstMsgSummary: ((s = (i = d[0]) == null ? void 0 : i.mes) == null ? void 0 : s.substring(0, 20)) || "undefined",
            firstMsgIndex: a.chat.indexOf(d[0])
          });
        } else {
          const f = this.getDynamicChatHistoryLimit();
          d = a.chat.slice(-f), ee.debug("MacroService", "getChatHistory (Recent)", { limit: f, count: d.length });
        }
        return d.length === 0 ? "" : d.map((f, h) => {
          let m = f.mes || f.content || f.message || "";
          const x = m, b = !!u, w = typeof (u == null ? void 0 : u.formatAsTavernRegexedString) == "function";
          if (h === 0 && ee.debug("MacroService", "TavernHelper ", {
            hasTavernHelper: b,
            hasFormatFunc: w,
            availableMethods: u ? Object.keys(u).slice(0, 10) : []
          }), b && w)
            try {
              const C = m;
              m = u.formatAsTavernRegexedString(m, "ai_output", { isPrompt: !0 });
              const T = C !== m;
              h === 0 && ee.debug("MacroService", "TavernHelper ", {
                didChange: T,
                prevLength: C.length,
                afterLength: m.length
              }), !m && C && (ee.warn("MacroService", "TavernHelper stripped content empty!", { prev: C, content: m }), m = C);
            } catch (C) {
              ee.warn("MacroService", "", C);
            }
          else h === 0 && ee.warn("MacroService", "TavernHelper.formatAsTavernRegexedString ", {
            hasTavernHelper: b,
            hasFormatFunc: w
          });
          const S = m;
          return m = Wm.process(m, "both"), !m && S && ee.warn("MacroService", "RegexProcessor !", { preRegex: S, content: m }), (h === 0 || h === d.length - 1) && ee.debug("MacroService", "", {
            index: h,
            original: x.substring(0, 50),
            step1_tavern: S.substring(0, 50),
            step2_regex: m.substring(0, 50)
          }), m;
        }).join(`

`);
      }
      return ee.warn("MacroService", "Context chat is empty or invalid"), "";
    } catch (a) {
      return ee.debug("MacroService", "", a), "";
    }
  }
  /**
   * V0.9.9:  ()
   */
  static getCurrentMessageCount() {
    var t, n;
    try {
      const r = (n = (t = window.SillyTavern) == null ? void 0 : t.getContext) == null ? void 0 : n.call(t);
      return r != null && r.chat && Array.isArray(r.chat) ? r.chat.length : 0;
    } catch {
      return 0;
    }
  }
  /**
   * 
   */
  static refreshCharDescription() {
    var t, n;
    try {
      const r = (n = (t = window.SillyTavern) == null ? void 0 : t.getContext) == null ? void 0 : n.call(t);
      if (r != null && r.characters && r.characterId >= 0) {
        const i = r.characters[r.characterId];
        this.cachedCharDescription = (i == null ? void 0 : i.description) || "";
      }
    } catch (r) {
      ee.debug("MacroService", "", r);
    }
  }
  /**
   * V0.9.2:  chatHistory 
   * : floorInterval - bufferSize
   *  {{chatHistory}} 
   */
  static getDynamicChatHistoryLimit() {
    try {
      const t = it.get("summarizerConfig"), n = (t == null ? void 0 : t.floorInterval) ?? 20, r = (t == null ? void 0 : t.bufferSize) ?? 3, i = Math.max(1, n - r);
      return ee.debug("MacroService", " chatHistory limit", { floorInterval: n, bufferSize: r, limit: i }), i;
    } catch (t) {
      return ee.warn("MacroService", " limit  17", t), 17;
    }
  }
  /**
   * V0.9.2: 
   *  is_archived=true 
   */
  static async refreshArchivedSummaries() {
    try {
      const t = vi.getState();
      this.cachedArchivedSummaries = await t.getArchivedEventSummaries(), ee.debug("MacroService", "", {
        length: this.cachedArchivedSummaries.length
      });
    } catch (t) {
      ee.warn("MacroService", "", t), this.cachedArchivedSummaries = "";
    }
  }
  /**
   * V0.9.2: 
   *  power_user.persona_description 
   */
  static refreshUserPersona() {
    try {
      const t = window.power_user;
      this.cachedUserPersona = (t == null ? void 0 : t.persona_description) || "", ee.debug("MacroService", "", {
        length: this.cachedUserPersona.length
      });
    } catch (t) {
      ee.debug("MacroService", "", t), this.cachedUserPersona = "";
    }
  }
  /**
   * V0.9.2: 
   *  apiSettings.customMacros 
   */
  static refreshCustomMacros() {
    var t, n;
    try {
      const r = (n = (t = window.SillyTavern) == null ? void 0 : t.getContext) == null ? void 0 : n.call(t);
      if (!(r != null && r.registerMacro)) {
        ee.debug("MacroService", " registerMacro ");
        return;
      }
      const i = it.get("apiSettings"), s = (i == null ? void 0 : i.customMacros) || [];
      this.cachedCustomMacros.clear();
      for (const a of s) {
        if (!a.enabled || !a.name) continue;
        this.cachedCustomMacros.set(a.name, a.content);
        const u = a.name;
        r.registerMacro(
          u,
          () => this.cachedCustomMacros.get(u) ?? "",
          `Engram : {{${u}}}`
        );
      }
      ee.debug("MacroService", "", {
        count: this.cachedCustomMacros.size,
        names: Array.from(this.cachedCustomMacros.keys())
      });
    } catch (r) {
      ee.warn("MacroService", "", r);
    }
  }
};
lt(Hr, "isInitialized", !1), // ---  ---
lt(Hr, "cachedSummaries", ""), lt(Hr, "cachedWorldbookContext", ""), lt(Hr, "cachedUserInput", ""), lt(Hr, "cachedCharDescription", ""), // V0.9: 
lt(Hr, "cachedGraphData", ""), // V0.9.2: 
lt(Hr, "cachedArchivedSummaries", ""), lt(Hr, "cachedUserPersona", ""), // V0.9.2: 
lt(Hr, "cachedCustomMacros", /* @__PURE__ */ new Map()), // V1.0.0: 
lt(Hr, "cachedEntityStates", "");
let Ds = Hr;
const qT = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  MacroService: Ds
}, Symbol.toStringTag, { value: "Module" }));
class LL {
  constructor(t) {
    lt(this, "config");
    lt(this, "isExtracting", !1);
    // V0.9.11: UI State Persistence (fix for component unmount issues)
    lt(this, "pendingReviewResult", null);
    var r;
    const n = (r = it.get("apiSettings")) == null ? void 0 : r.entityExtractConfig;
    this.config = { ...IP, ...n, ...t };
  }
  /** Clear pending review state */
  clearPendingReview() {
    this.pendingReviewResult = null;
  }
  /**
   * 
   */
  updateConfig(t) {
    this.config = { ...this.config, ...t };
  }
  /**
   * 
   */
  getConfig() {
    return { ...this.config };
  }
  /**
   * 
   * V0.9.1:  SummarizerService 
   */
  shouldTriggerOnFloor(t) {
    return !this.config.enabled || this.config.trigger !== "floor" ? !1 : t > 0 && t % this.config.floorInterval === 0;
  }
  /**
   * 
   * V0.9.1:  chatHistory  engramGraph
   *
   * @param chatHistory 
   * @param floor 
   * @param manual 
   */
  async extractFromChat(t, n, r = !1, i = !1) {
    var a, u, d, f, h, m, x;
    if (this.isExtracting)
      return ee.warn(Fe.MEMORY_ENTITY, ""), null;
    this.isExtracting = !0;
    const s = Date.now();
    ee.info(Fe.MEMORY_ENTITY, ` (Workflow) ( ${n}, DryRun: ${i})`), r && xn.info("...", "Engram");
    try {
      const { WorkflowEngine: b } = await Promise.resolve().then(() => cw), { createEntityWorkflow: w } = await Promise.resolve().then(() => W2e), C = (await b.run(w(), {
        trigger: r ? "manual" : "auto",
        config: {
          dryRun: i,
          logType: "entity_extraction",
          // For LlmRequest logging
          templateId: this.config.promptTemplateId
          // V0.9.10: Support custom prompt
        },
        input: {
          // Pass range if possible, otherwise FetchChatHistory logic needs to handle single floor or raw string
          // Ideally pass range: [floor, floor] or the actual range
          range: [n, n],
          // Placeholder range
          chatHistory: t
          // Pass raw string as optimization
        }
      })).output;
      if (i)
        ee.info(Fe.MEMORY_ENTITY, "", {
          newCount: ((h = C == null ? void 0 : C.newEntities) == null ? void 0 : h.length) || 0,
          updatedCount: ((m = C == null ? void 0 : C.updatedEntities) == null ? void 0 : m.length) || 0
        }), this.pendingReviewResult = {
          success: !0,
          newEntities: (C == null ? void 0 : C.newEntities) || [],
          updatedEntities: (C == null ? void 0 : C.updatedEntities) || []
        }, xn.success(
          `:  ${((x = C == null ? void 0 : C.newEntities) == null ? void 0 : x.length) || 0} `,
          "Engram"
        );
      else {
        const { chatManager: T } = await Promise.resolve().then(() => B3);
        await T.updateState({ last_extracted_floor: n }), ee.success(Fe.MEMORY_ENTITY, "", {
          floor: n,
          newCount: ((a = C == null ? void 0 : C.newEntities) == null ? void 0 : a.length) || 0,
          updatedCount: ((u = C == null ? void 0 : C.updatedEntities) == null ? void 0 : u.length) || 0,
          duration: Date.now() - s
        }), r && xn.success(
          `:  ${((d = C == null ? void 0 : C.newEntities) == null ? void 0 : d.length) || 0},  ${((f = C == null ? void 0 : C.updatedEntities) == null ? void 0 : f.length) || 0}`,
          "Engram"
        );
      }
      return {
        success: !0,
        newEntities: (C == null ? void 0 : C.newEntities) || [],
        updatedEntities: (C == null ? void 0 : C.updatedEntities) || []
      };
    } catch (b) {
      const w = b instanceof Error ? b.message : String(b);
      return ee.error(Fe.MEMORY_ENTITY, "", { error: w }), r && xn.error(`: ${w}`, "Engram "), { success: !1, newEntities: [], updatedEntities: [], error: w };
    } finally {
      this.isExtracting = !1;
    }
  }
  /**
   * 
   * V0.9.9:  MacroService 
   */
  async extractByRange(t, n = !1) {
    const r = Ds.getChatHistory(t);
    return r ? this.extractFromChat(r, t[1], n) : (ee.warn(Fe.MEMORY_ENTITY, "", { range: t }), null);
  }
  /**
   * 
   */
  async extractManual(t = !1) {
    const n = Ds.getChatHistory(), r = Ds.getCurrentMessageCount();
    return this.extractFromChat(n, r, !0, t);
  }
  /**
   *  ()
   */
  async saveRawEntities(t, n) {
    const r = vi.getState(), i = Ds.getCurrentMessageCount();
    ee.info(Fe.MEMORY_ENTITY, " (saveRawEntities)", {
      newCount: t.length,
      updatedCount: n.length
    });
    try {
      if (t.length > 0) {
        const s = t.map((a) => ({
          name: a.name,
          type: a.type,
          description: a.description,
          aliases: a.aliases || [],
          profile: a.profile || {}
        }));
        await r.saveEntities(s);
      }
      n.length > 0 && await Promise.all(n.map((s) => (ee.debug(Fe.MEMORY_ENTITY, "Updating entity", { id: s.id, name: s.name }), r.updateEntity(s.id, {
        profile: s.profile,
        aliases: s.aliases,
        description: s.description,
        name: s.name,
        type: s.type
      })))), await vm.updateState({ last_extracted_floor: i }), xn.success(
        ` ${t.length}  ${n.length} `,
        "Engram"
      ), ee.success(Fe.MEMORY_ENTITY, "");
    } catch (s) {
      throw ee.error(Fe.MEMORY_ENTITY, "", { error: s }), s;
    }
  }
  /**
   * 
   *  SaveEntity Step
   */
  // private resolveEntity(...) {}
  /**
   *  (UI )
   * V0.9.1: 
   */
  /**
   *  (UI )
   * V0.9.1: 
   */
  async getStatus() {
    const n = await vi.getState().getAllEntities(), r = await vm.getState();
    return {
      enabled: this.config.enabled,
      trigger: this.config.trigger,
      floorInterval: this.config.floorInterval,
      lastExtractedFloor: r.last_extracted_floor,
      entityCount: n.length,
      isExtracting: this.isExtracting
    };
  }
}
const Ia = new LL(), rle = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  EntityBuilder: LL,
  entityBuilder: Ia
}, Symbol.toStringTag, { value: "Module" }));
class ile {
  /**
   * 
   * @param workflow 
   * @param initialContext  ()
   */
  static async run(t, n) {
    const r = Date.now(), i = {
      id: n.id || Yo(),
      trigger: n.trigger || "manual",
      config: n.config || {},
      input: n.input || {},
      metadata: {
        startTime: r,
        stepsExecuted: [],
        ...n.metadata
      }
    };
    ee.info("Workflow", `: ${t.name}`, {
      jobId: i.id,
      trigger: i.trigger
    });
    try {
      const s = /* @__PURE__ */ new Map();
      for (let a = 0; a < t.steps.length; a++)
        s.set(t.steps[a].name, a);
      for (let a = 0; a < t.steps.length; a++) {
        const u = t.steps[a];
        ee.debug("Workflow", `: ${u.name}`, { jobId: i.id });
        const d = Date.now(), f = await u.execute(i), h = Date.now() - d;
        if (i.metadata.stepsExecuted.push(u.name), ee.debug("Workflow", `: ${u.name}`, { duration: h }), f) {
          if (f.action === "finish") {
            ee.info("Workflow", `: ${u.name}`, { reason: "Step requested finish" });
            break;
          }
          if (f.action === "abort")
            throw new Error(f.reason || "Step requested abort");
          if (f.action === "jump") {
            const m = s.get(f.targetStep);
            if (m === void 0)
              throw new Error(`Jump target not found: ${f.targetStep}`);
            ee.info("Workflow", `: ${u.name} -> ${f.targetStep}`, { reason: f.reason }), a = m - 1;
            continue;
          }
        }
      }
      ee.success("Workflow", `: ${t.name}`, {
        jobId: i.id,
        duration: Date.now() - r,
        steps: i.metadata.stepsExecuted.length
      });
    } catch (s) {
      throw i.metadata.error = s instanceof Error ? s : new Error(String(s)), ee.error("Workflow", `: ${t.name}`, {
        jobId: i.id,
        step: i.metadata.stepsExecuted[i.metadata.stepsExecuted.length - 1],
        // 
        error: i.metadata.error.message
      }), i.metadata.error;
    }
    return i;
  }
}
const cw = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  WorkflowEngine: ile
}, Symbol.toStringTag, { value: "Module" })), sle = () => ({
  name: "SummaryWorkflow",
  steps: [
    new Km(),
    new iw(),
    new tx({ category: "summary" }),
    new nx(),
    new IT("output"),
    new sw({
      title: ""
    }),
    new zL()
  ]
}), ale = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  createSummaryWorkflow: sle
}, Symbol.toStringTag, { value: "Module" }));
class BL {
  static init() {
    if (!this.isInitialized)
      try {
        const t = ma();
        if (!(t != null && t.eventSource) || !(t != null && t.event_types)) {
          ee.warn(Fe.DATA_CLEANUP, "");
          return;
        }
        t.event_types.CHARACTER_DELETED && (t.eventSource.on(t.event_types.CHARACTER_DELETED, this.onCharacterDeleted.bind(this)), ee.debug(Fe.DATA_CLEANUP, " CHARACTER_DELETED ")), t.event_types.CHAT_DELETED && (t.eventSource.on(t.event_types.CHAT_DELETED, this.onChatDeleted.bind(this)), ee.debug(Fe.DATA_CLEANUP, " CHAT_DELETED ")), t.event_types.GROUP_CHAT_DELETED && (t.eventSource.on(t.event_types.GROUP_CHAT_DELETED, this.onChatDeleted.bind(this)), ee.debug(Fe.DATA_CLEANUP, " GROUP_CHAT_DELETED ")), this.isInitialized = !0;
      } catch (t) {
        ee.error(Fe.DATA_CLEANUP, "", t);
      }
  }
  /**
   * 
   */
  static async onCharacterDeleted(t) {
    var s;
    const n = it.getSettings().linkedDeletion;
    if (!(n != null && n.enabled) || !(n != null && n.deleteWorldbook)) return;
    ee.debug(Fe.DATA_CLEANUP, "", t);
    const r = t.character, i = (r == null ? void 0 : r.name) || (r == null ? void 0 : r.avatar) || (r == null ? void 0 : r.ch_name) || ((s = r == null ? void 0 : r.data) == null ? void 0 : s.name);
    if (!i) {
      ee.warn(Fe.DATA_CLEANUP, "");
      return;
    }
    await this.deleteEngramWorldbooks(i, "", n.showConfirmation);
  }
  /**
   * 
   * @param chatId  ID "CharName - 2024-1-1@12h30m" 
   */
  static async onChatDeleted(t) {
    const n = it.getSettings().linkedDeletion;
    if (!(n != null && n.enabled)) return;
    ee.debug(Fe.DATA_CLEANUP, "", { chatId: t });
    try {
      const { deleteDatabase: i, hasDbForChat: s } = await Promise.resolve().then(() => UW);
      s(t) && (await i(t), ee.info(Fe.DATA_CLEANUP, ` IndexedDB: ${t}`), xn.info(" Engram ", "Engram"));
    } catch (i) {
      ee.error(Fe.DATA_CLEANUP, `: ${t}`, i);
    }
    if (!n.deleteChatWorldbook) return;
    const r = this.extractCharacterNameFromChatId(t);
    if (!r) {
      ee.debug(Fe.DATA_CLEANUP, " chatId ");
      return;
    }
    try {
      const { syncService: i } = await Promise.resolve().then(() => L1);
      await i.purge(t), ee.debug(Fe.DATA_CLEANUP, `: ${t}`);
    } catch (i) {
      ee.warn(Fe.DATA_CLEANUP, `: ${t}`, i);
    }
    await this.deleteEngramWorldbooks(r, "", n.showConfirmation);
  }
  /**
   *  chatId 
   */
  static extractCharacterNameFromChatId(t) {
    if (!t) return null;
    let n = t.match(/^(.+?)\s*-\s*\d{4}/);
    return n || (n = t.match(/^(.+?)_\d{4}/), n) ? n[1].trim() : null;
  }
  /**
   *  Engram 
   */
  static async deleteEngramWorldbooks(t, n, r) {
    const i = /* @__PURE__ */ new Set();
    i.add(`[Engram] ${t}`), i.add(`Engram_${t}`);
    const s = await Ba.getWorldbookNames(), a = new Set(s), u = Array.from(i).filter((h) => {
      if (!a.has(h)) return !1;
      const m = h.toLowerCase().includes("engram");
      return m || ee.debug(Fe.DATA_CLEANUP, ` Engram : ${h}`), m;
    });
    if (u.length === 0) {
      ee.debug(Fe.DATA_CLEANUP, ` "${t}"  Engram `);
      return;
    }
    if (ee.info(Fe.DATA_CLEANUP, "", { books: u }), r) {
      const h = `
                <div style="font-size: 0.9em;">
                    <h3> Engram </h3>
                    <p>${n} <b>${t}</b> </p>
                    <p> Engram </p>
                    <ul style="max-height: 100px; overflow-y: auto; background: var(--black50a); padding: 5px; border-radius: 4px; list-style: none; margin: 10px 0;">
                        ${u.map((x) => `<li style="padding: 2px 0;"> ${x}</li>`).join("")}
                    </ul>
                    <p></p>
                    <small style="opacity: 0.7;"></small>
                </div>
            `;
      if (!await eL(h, "confirm")) {
        ee.info(Fe.DATA_CLEANUP, "");
        return;
      }
    }
    let d = 0;
    const f = [];
    xn.info(" Engram ...", "Engram");
    for (const h of u)
      try {
        await Ba.deleteWorldbook(h) ? (d++, ee.debug(Fe.DATA_CLEANUP, `: ${h}`)) : f.push(h);
      } catch (m) {
        ee.error(Fe.DATA_CLEANUP, ` ${h} `, m), f.push(h);
      }
    d > 0 && xn.success(` ${d} `, "Engram"), f.length > 0 && xn.warning(`: ${f.join(", ")}`, "Engram");
  }
}
lt(BL, "isInitialized", !1);
const ole = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  CharacterDeleteService: BL
}, Symbol.toStringTag, { value: "Module" })), Pa = "KeyboardManager";
class lle {
  constructor() {
    lt(this, "shortcuts", /* @__PURE__ */ new Map());
    lt(this, "isEnabled", !1);
    lt(this, "boundKeydownHandler");
    this.boundKeydownHandler = this.handleKeydown.bind(this);
  }
  /**
   * 
   * Engram iframe
   */
  start() {
    var t;
    if (this.isEnabled) {
      ee.debug(Pa, "");
      return;
    }
    try {
      const n = (t = window.parent) == null ? void 0 : t.document;
      n && n !== document && (n.addEventListener("keydown", this.boundKeydownHandler, !0), ee.debug(Pa, ""));
    } catch (n) {
      ee.warn(Pa, "", n);
    }
    try {
      document.addEventListener("keydown", this.boundKeydownHandler, !0), ee.debug(Pa, "");
    } catch (n) {
      ee.warn(Pa, "", n);
    }
    this.isEnabled = !0, ee.info(Pa, "");
  }
  /**
   * 
   * 
   */
  stop() {
    var t;
    if (this.isEnabled) {
      try {
        const n = (t = window.parent) == null ? void 0 : t.document;
        n && n !== document && n.removeEventListener("keydown", this.boundKeydownHandler, !0);
      } catch {
      }
      try {
        document.removeEventListener("keydown", this.boundKeydownHandler, !0);
      } catch {
      }
      this.isEnabled = !1, ee.debug(Pa, "");
    }
  }
  /**
   * 
   */
  register(t) {
    const n = this.generateShortcutKey(t.key, {
      ctrl: t.ctrl,
      shift: t.shift,
      alt: t.alt
    });
    this.shortcuts.set(n, {
      key: t.key.toLowerCase(),
      ctrl: t.ctrl || !1,
      shift: t.shift || !1,
      alt: t.alt || !1,
      callback: t.callback,
      description: t.description
    }), ee.debug(Pa, `: ${n} (${t.description})`);
  }
  /**
   * 
   */
  unregister(t, n = {}) {
    const r = this.generateShortcutKey(t, n);
    this.shortcuts.has(r) && (this.shortcuts.delete(r), ee.debug(Pa, `: ${r}`));
  }
  /**
   * 
   */
  getRegisteredShortcuts() {
    return Array.from(this.shortcuts.entries()).map(([t, n]) => ({
      key: t,
      description: n.description
    }));
  }
  /**
   * 
   * ctrl -> shift -> alt -> key
   */
  generateShortcutKey(t, n) {
    const r = [];
    return n.ctrl && r.push("ctrl"), n.shift && r.push("shift"), n.alt && r.push("alt"), r.push(t.toLowerCase()), r.join("+");
  }
  /**
   * 
   */
  handleKeydown(t) {
    if (this.isTyping(t.target))
      return;
    const n = this.generateShortcutKey(t.key, {
      ctrl: t.ctrlKey || t.metaKey,
      // Mac: Command  Ctrl
      shift: t.shiftKey,
      alt: t.altKey
    }), r = this.shortcuts.get(n);
    if (r) {
      ee.debug(Pa, `: ${n}`), t.preventDefault(), t.stopPropagation();
      try {
        r.callback();
      } catch (i) {
        ee.error(Pa, `: ${n}`, i);
      }
    }
  }
  /**
   * 
   */
  isTyping(t) {
    if (!t) return !1;
    const n = t.tagName;
    if (n === "INPUT" || n === "TEXTAREA" || t.isContentEditable)
      return !0;
    const r = t.id;
    return r === "send_textarea" || r === "prompt-input";
  }
  /**
   * 
   */
  destroy() {
    this.stop(), this.shortcuts.clear(), ee.debug(Pa, "");
  }
}
const G0 = new lle();
function ule(e) {
  G0.register({
    key: "e",
    ctrl: !0,
    shift: !0,
    callback: e.toggleMainPanel,
    description: "Ctrl+Shift+E - "
  }), G0.register({
    key: "q",
    ctrl: !0,
    callback: e.toggleQuickPanel,
    description: "Ctrl+Q - "
  }), G0.register({
    key: "k",
    ctrl: !0,
    callback: e.openCommandPalette,
    description: "Ctrl+K - "
  }), G0.start(), ee.info(Pa, "", G0.getRegisteredShortcuts());
}
const cle = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  setupKeyboardShortcuts: ule
}, Symbol.toStringTag, { value: "Module" }));
function i5(e) {
  return new Date(e).toTimeString().slice(0, 8);
}
const $L = {
  [qn.DEBUG]: { text: "text-zinc-400", bg: "bg-zinc-500/15" },
  [qn.INFO]: { text: "text-blue-400", bg: "bg-blue-500/10" },
  [qn.SUCCESS]: { text: "text-emerald-400", bg: "bg-emerald-500/10" },
  [qn.WARN]: { text: "text-amber-400", bg: "bg-amber-500/10" },
  [qn.ERROR]: { text: "text-red-400", bg: "bg-red-500/10" }
}, x1 = {
  // 
  System: Wy,
  // 
  STBridge: VH,
  TavernAPI: o3,
  Tavern: o3,
  // 
  Summarizer: xh,
  Memory: xh,
  // RAG 
  RAG: Ai,
  // 
  SettingsManager: Cm,
  ThemeManager: a3,
  // 
  MacroService: bz,
  // 
  Data: kh,
  // 
  Preprocess: Yy,
  // 
  Batch: Zu,
  // LLM
  LLM: hH
};
function dle(e) {
  if (x1[e])
    return x1[e];
  const t = e.split("/")[0];
  return x1[t] ? x1[t] : Em;
}
const y6 = ({ entry: e, defaultExpanded: t = !1 }) => {
  const n = e.level === qn.WARN || e.level === qn.ERROR, [r, i] = I.useState(t || n), s = e.data !== void 0, a = rb[e.level], u = $L[e.level];
  return I.useEffect(() => {
    s && i(t || n);
  }, [t, n, s]), /* @__PURE__ */ c.jsxs("div", { className: "group", children: [
    /* @__PURE__ */ c.jsxs(
      "div",
      {
        className: `
                    flex items-start gap-3 px-2 py-1 rounded-sm transition-colors
                    hover:bg-white/[0.02]
                    ${s ? "cursor-pointer" : ""}
                `,
        onClick: () => s && i(!r),
        children: [
          /* @__PURE__ */ c.jsx("span", { className: "flex items-center text-zinc-600 shrink-0 mt-0.5 w-3", children: s ? r ? /* @__PURE__ */ c.jsx(Yu, { size: 12 }) : /* @__PURE__ */ c.jsx(nc, { size: 12 }) : null }),
          /* @__PURE__ */ c.jsx("span", { className: "text-zinc-500 shrink-0 tabular-nums text-[11px]", children: i5(e.timestamp) }),
          /* @__PURE__ */ c.jsx("span", { className: `
                    shrink-0 text-[10px] font-medium px-1.5 py-0.5 rounded
                    ${u.text} ${u.bg}
                `, children: a.label }),
          /* @__PURE__ */ c.jsx("span", { className: "text-zinc-400 shrink-0 text-[11px]", children: e.module }),
          /* @__PURE__ */ c.jsx("span", { className: "text-zinc-300 text-[11px] break-words flex-1 leading-relaxed", children: e.message })
        ]
      }
    ),
    r && s && /* @__PURE__ */ c.jsx("div", { className: "ml-10 mr-2 mb-1 px-3 py-2 bg-zinc-900/50 border-l-2 border-zinc-700 rounded-r text-[10px]", children: /* @__PURE__ */ c.jsx("pre", { className: "m-0 text-zinc-400 whitespace-pre-wrap break-words font-mono", children: JSON.stringify(e.data, null, 2) }) })
  ] });
}, fle = ({
  entries: e,
  defaultExpanded: t = !0,
  defaultDataExpanded: n = !1
}) => {
  var x;
  const [r, i] = I.useState(t);
  I.useEffect(() => {
    i(t);
  }, [t]);
  const s = ((x = e[0]) == null ? void 0 : x.module) || "Unknown", a = e.length, u = e[0], d = e[e.length - 1], f = I.useMemo(() => e.reduce((b, w) => Math.max(b, w.level), qn.DEBUG), [e]), h = $L[f], m = u && d ? `${i5(u.timestamp)} - ${i5(d.timestamp)}` : "";
  return a === 1 ? /* @__PURE__ */ c.jsx(y6, { entry: e[0], defaultExpanded: n }) : /* @__PURE__ */ c.jsxs("div", { className: "border-l-2 border-transparent hover:border-zinc-700 transition-colors", children: [
    /* @__PURE__ */ c.jsxs(
      "div",
      {
        className: "flex items-center gap-2 px-2 py-1.5 cursor-pointer text-[11px] hover:bg-white/[0.02] rounded-sm transition-colors",
        onClick: () => i(!r),
        children: [
          /* @__PURE__ */ c.jsx("span", { className: "text-zinc-500 shrink-0", children: r ? /* @__PURE__ */ c.jsx(Yu, { size: 12 }) : /* @__PURE__ */ c.jsx(nc, { size: 12 }) }),
          wd.createElement(dle(s), {
            size: 13,
            className: `shrink-0 ${h.text}`
          }),
          /* @__PURE__ */ c.jsx("span", { className: `font-medium ${h.text}`, children: s }),
          /* @__PURE__ */ c.jsxs("span", { className: `px-1.5 py-0.5 rounded text-[10px] font-medium ${h.bg} ${h.text}`, children: [
            a,
            " "
          ] }),
          /* @__PURE__ */ c.jsx("span", { className: "text-zinc-500 ml-auto tabular-nums", children: m })
        ]
      }
    ),
    r && /* @__PURE__ */ c.jsx("div", { className: "ml-4 border-l border-zinc-800 pl-2", children: e.map((b) => /* @__PURE__ */ c.jsx(
      y6,
      {
        entry: b,
        defaultExpanded: n
      },
      b.id
    )) })
  ] });
};
function hle(e) {
  if (e.length === 0) return [];
  const t = [];
  let n = [], r = null;
  for (const i of e)
    i.module === r ? n.push(i) : (n.length > 0 && t.push(n), n = [i], r = i.module);
  return n.length > 0 && t.push(n), t;
}
const ple = {
  summarize: { label: "", color: "bg-blue-500/20 text-blue-400" },
  trim: { label: "", color: "bg-yellow-500/20 text-yellow-500" },
  vectorize: { label: "", color: "bg-purple-500/20 text-purple-400" },
  query: { label: "", color: "bg-green-500/20 text-green-400" },
  entity_extraction: { label: "", color: "bg-cyan-500/20 text-cyan-400" },
  other: { label: "", color: "bg-gray-500/20 text-gray-400" }
}, mle = ({ status: e }) => {
  switch (e) {
    case "pending":
      return /* @__PURE__ */ c.jsx(rc, { size: 14, className: "animate-spin text-yellow-400" });
    case "success":
      return /* @__PURE__ */ c.jsx(U5, { size: 14, className: "text-green-400" });
    case "error":
      return /* @__PURE__ */ c.jsx(_d, { size: 14, className: "text-red-400" });
    case "cancelled":
      return /* @__PURE__ */ c.jsx(vz, { size: 14, className: "text-orange-400" });
  }
}, gle = (e) => new Date(e).toLocaleTimeString("zh-CN", {
  hour12: !1,
  hour: "2-digit",
  minute: "2-digit",
  second: "2-digit"
}), yle = (e) => e === void 0 ? "-" : e < 1e3 ? `${e}ms` : `${(e / 1e3).toFixed(1)}s`, xle = ({ sent: e, received: t }) => {
  const [n, r] = I.useState(!1), i = ple[e.type];
  return /* @__PURE__ */ c.jsxs("div", { className: "border border-border rounded-lg overflow-hidden bg-card", children: [
    /* @__PURE__ */ c.jsxs(
      "div",
      {
        className: "flex items-center gap-2 px-3 py-2 bg-muted-20 cursor-pointer hover:bg-muted-30",
        onClick: () => r(!n),
        children: [
          n ? /* @__PURE__ */ c.jsx(Yu, { size: 14 }) : /* @__PURE__ */ c.jsx(nc, { size: 14 }),
          /* @__PURE__ */ c.jsx("span", { className: `px-2 py-0.5 rounded text-xs font-medium ${i.color}`, children: i.label }),
          e.model && /* @__PURE__ */ c.jsx("span", { className: "px-1.5 py-0.5 rounded text-[10px] font-medium bg-indigo-500/10 text-indigo-400 border border-indigo-500/20 truncate max-w-[150px]", title: `: ${e.model}`, children: e.model }),
          e.character && /* @__PURE__ */ c.jsx("span", { className: "px-1.5 py-0.5 rounded text-[10px] font-medium bg-orange-500/10 text-orange-400 border border-orange-500/20 truncate max-w-[120px]", title: `: ${e.character}`, children: e.character }),
          /* @__PURE__ */ c.jsx("span", { className: "text-xs text-muted-foreground", children: gle(e.timestamp) }),
          /* @__PURE__ */ c.jsx(mle, { status: (t == null ? void 0 : t.status) || e.status }),
          e.floorRange && /* @__PURE__ */ c.jsxs("span", { className: "text-xs text-muted-foreground", children: [
            " #",
            e.floorRange[0],
            "-",
            e.floorRange[1]
          ] }),
          /* @__PURE__ */ c.jsxs("span", { className: "ml-auto text-xs text-muted-foreground flex items-center gap-1", children: [
            /* @__PURE__ */ c.jsx(eb, { size: 12 }),
            yle((t == null ? void 0 : t.duration) || e.duration)
          ] })
        ]
      }
    ),
    n && /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col md:flex-row", children: [
      /* @__PURE__ */ c.jsxs("div", { className: "flex-1 border-r border-border p-3", children: [
        /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2 mb-2 text-sm font-medium text-blue-400", children: [
          /* @__PURE__ */ c.jsx(kV, { size: 14 }),
          "",
          e.tokensSent && /* @__PURE__ */ c.jsxs("span", { className: "text-xs text-muted-foreground ml-auto", children: [
            "~",
            e.tokensSent,
            " tokens"
          ] })
        ] }),
        e.systemPrompt && /* @__PURE__ */ c.jsxs("div", { className: "mb-3", children: [
          /* @__PURE__ */ c.jsx("div", { className: "text-xs text-muted-foreground mb-1", children: "System" }),
          /* @__PURE__ */ c.jsx("div", { className: "text-sm p-2 bg-muted-20 rounded max-h-[500px] overflow-y-auto whitespace-pre-wrap", children: e.systemPrompt })
        ] }),
        e.userPrompt && /* @__PURE__ */ c.jsxs("div", { children: [
          /* @__PURE__ */ c.jsx("div", { className: "text-xs text-muted-foreground mb-1", children: "User" }),
          /* @__PURE__ */ c.jsx("div", { className: "text-sm p-2 bg-muted-20 rounded max-h-[500px] overflow-y-auto whitespace-pre-wrap", children: e.userPrompt })
        ] })
      ] }),
      /* @__PURE__ */ c.jsxs("div", { className: "flex-1 p-3", children: [
        /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2 mb-2 text-sm font-medium text-green-400", children: [
          /* @__PURE__ */ c.jsx(gz, { size: 14 }),
          "",
          (t == null ? void 0 : t.tokensReceived) && /* @__PURE__ */ c.jsxs("span", { className: "text-xs text-muted-foreground ml-auto", children: [
            "~",
            t.tokensReceived,
            " tokens"
          ] })
        ] }),
        (t == null ? void 0 : t.status) === "error" && t.error && /* @__PURE__ */ c.jsx("div", { className: "p-2 bg-red-500/10 border border-red-500/30 rounded text-sm text-red-400", children: t.error }),
        (t == null ? void 0 : t.response) && /* @__PURE__ */ c.jsx("div", { className: "text-sm p-2 bg-muted-20 rounded max-h-[500px] overflow-y-auto whitespace-pre-wrap", children: t.response }),
        !t && e.status === "pending" && /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2 text-sm text-muted-foreground", children: [
          /* @__PURE__ */ c.jsx(rc, { size: 14, className: "animate-spin" }),
          "..."
        ] })
      ] })
    ] })
  ] });
}, vle = () => {
  const [e, t] = I.useState(oh.getPaired());
  return I.useEffect(() => oh.subscribe(() => {
    t(oh.getPaired());
  }), []), /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col h-full", children: [
    /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between px-4 py-3 border-b border-border shrink-0", children: [
      /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2", children: [
        /* @__PURE__ */ c.jsx(Zu, { size: 16, className: "text-primary" }),
        /* @__PURE__ */ c.jsx("span", { className: "font-medium text-foreground", children: "" }),
        /* @__PURE__ */ c.jsxs("span", { className: "text-xs text-muted-foreground", children: [
          "(",
          e.length,
          ")"
        ] })
      ] }),
      /* @__PURE__ */ c.jsx(
        "button",
        {
          className: "p-1.5 rounded-md text-muted-foreground hover:text-destructive transition-colors",
          onClick: () => oh.clear(),
          title: "",
          children: /* @__PURE__ */ c.jsx(pa, { size: 14 })
        }
      )
    ] }),
    /* @__PURE__ */ c.jsx("div", { className: "flex-1 overflow-y-auto p-4", children: e.length === 0 ? /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col items-center justify-center h-full text-muted-foreground gap-3", children: [
      /* @__PURE__ */ c.jsx(gz, { size: 48, className: "opacity-30" }),
      /* @__PURE__ */ c.jsx("p", { className: "text-sm", children: "" }),
      /* @__PURE__ */ c.jsx("p", { className: "text-xs", children: "" })
    ] }) : /* @__PURE__ */ c.jsx("div", { className: "flex flex-col gap-3", children: e.map(({ sent: n, received: r }) => /* @__PURE__ */ c.jsx(xle, { sent: n, received: r }, n.id)) }) })
  ] });
}, x6 = 768, qL = (e) => new Date(e).toLocaleTimeString("zh-CN", {
  hour12: !1,
  hour: "2-digit",
  minute: "2-digit",
  second: "2-digit"
}), FL = (e) => e === void 0 ? "-" : e < 1e3 ? `${e}ms` : `${(e / 1e3).toFixed(1)}s`, ble = ({ entry: e, isSelected: t, onSelect: n }) => /* @__PURE__ */ c.jsxs(
  "div",
  {
    className: `
                px-3 py-2 cursor-pointer border-b border-border/30 transition-colors
                ${t ? "bg-primary/10 border-l-2 border-l-primary" : "hover:bg-muted/30"}
            `,
    onClick: n,
    children: [
      /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2 mb-1", children: [
        /* @__PURE__ */ c.jsx("span", { className: `px-1.5 py-0.5 rounded text-[10px] font-medium ${e.mode === "hybrid" ? "bg-purple-500/20 text-purple-400" : "bg-blue-500/20 text-blue-400"}`, children: e.mode === "hybrid" ? "" : "Embed" }),
        /* @__PURE__ */ c.jsxs("span", { className: "text-[10px] text-muted-foreground", children: [
          e.stats.rerankCount,
          "/",
          e.stats.topKCount,
          " "
        ] }),
        /* @__PURE__ */ c.jsxs("span", { className: "text-[10px] text-muted-foreground ml-auto flex items-center gap-1", children: [
          /* @__PURE__ */ c.jsx(eb, { size: 10 }),
          qL(e.timestamp)
        ] })
      ] }),
      /* @__PURE__ */ c.jsx("p", { className: "text-sm text-foreground line-clamp-2", children: e.query }),
      /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2 mt-1 text-[10px] text-muted-foreground", children: [
        /* @__PURE__ */ c.jsx(Zu, { size: 10 }),
        FL(e.stats.latencyMs)
      ] })
    ]
  }
), y_ = ({ label: e, score: t, color: n }) => {
  const r = Math.min(100, t * 100);
  return /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2 text-xs", children: [
    /* @__PURE__ */ c.jsx("span", { className: "text-muted-foreground w-16 shrink-0", children: e }),
    /* @__PURE__ */ c.jsx("div", { className: "flex-1 h-1.5 bg-muted/30 rounded-full overflow-hidden", children: /* @__PURE__ */ c.jsx(
      "div",
      {
        className: `h-full ${n} rounded-full transition-all duration-300`,
        style: { width: `${r}%` }
      }
    ) }),
    /* @__PURE__ */ c.jsx("span", { className: "text-muted-foreground w-14 text-right font-mono shrink-0", children: t.toFixed(3) })
  ] });
}, wle = ({ item: e }) => {
  const [t, n] = I.useState(!1);
  return /* @__PURE__ */ c.jsxs(
    "div",
    {
      className: `
                border-b border-border/30 py-3 px-4 cursor-pointer
                hover:bg-muted/10 transition-colors
                ${e.isReranked ? "bg-purple-500/5" : e.isTopK ? "bg-blue-500/5" : ""}
            `,
      onClick: () => n(!t),
      children: [
        /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2 mb-1.5", children: [
          e.isReranked && /* @__PURE__ */ c.jsx("span", { className: "px-1.5 py-0.5 text-[10px] bg-purple-500/20 text-purple-400 rounded", children: "Rerank" }),
          e.isTopK && !e.isReranked && /* @__PURE__ */ c.jsx("span", { className: "px-1.5 py-0.5 text-[10px] bg-blue-500/20 text-blue-400 rounded", children: "TopK" }),
          /* @__PURE__ */ c.jsx("span", { className: "text-[10px] text-muted-foreground truncate max-w-[150px]", children: e.category }),
          e.sourceFloor && /* @__PURE__ */ c.jsxs("span", { className: "text-[10px] text-muted-foreground", children: [
            " #",
            e.sourceFloor
          ] }),
          /* @__PURE__ */ c.jsx(nc, { size: 12, className: `ml-auto text-muted-foreground transition-transform ${t ? "rotate-90" : ""}` })
        ] }),
        /* @__PURE__ */ c.jsx("p", { className: `text-sm text-foreground ${t ? "" : "line-clamp-2"}`, children: e.summary }),
        t && /* @__PURE__ */ c.jsxs("div", { className: "mt-3 space-y-1.5 pt-2 border-t border-border/20", children: [
          /* @__PURE__ */ c.jsx(y_, { label: "Embedding", score: e.embeddingScore, color: "bg-blue-500" }),
          e.rerankScore != null && /* @__PURE__ */ c.jsx(y_, { label: "Rerank", score: e.rerankScore, color: "bg-orange-500" }),
          e.hybridScore != null && /* @__PURE__ */ c.jsx(y_, { label: "Hybrid", score: e.hybridScore, color: "bg-purple-500" })
        ] })
      ]
    }
  );
}, v6 = ({ entry: e, isFullScreen: t, onClose: n }) => {
  const [r, i] = I.useState("all"), [s, a] = I.useState("hybrid"), [u, d] = I.useState(""), f = I.useMemo(() => {
    if (!e) return [];
    let h = [...e.results];
    if (u.trim()) {
      const m = u.toLowerCase();
      h = h.filter((x) => x.summary.toLowerCase().includes(m));
    }
    return r === "topK" ? h = h.filter((m) => m.isTopK === !0) : r === "reranked" && (h = h.filter((m) => m.isReranked === !0)), h.sort((m, x) => {
      const b = (w) => {
        switch (s) {
          case "embedding":
            return w.embeddingScore;
          case "rerank":
            return w.rerankScore ?? 0;
          case "hybrid":
            return w.hybridScore ?? (w.rerankScore != null ? (w.embeddingScore + w.rerankScore) / 2 : w.embeddingScore);
        }
      };
      return b(x) - b(m);
    }), h;
  }, [e, r, s, u]);
  return e ? /* @__PURE__ */ c.jsxs("div", { className: `flex flex-col h-full ${t ? "p-4" : ""}`, children: [
    t && n && /* @__PURE__ */ c.jsxs(
      "button",
      {
        onClick: n,
        className: "flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground mb-4",
        children: [
          /* @__PURE__ */ c.jsx($b, { size: 16 }),
          ""
        ]
      }
    ),
    /* @__PURE__ */ c.jsxs("div", { className: "mb-4 pb-4 border-b border-border shrink-0", children: [
      /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2 mb-2", children: [
        /* @__PURE__ */ c.jsx("span", { className: `px-2 py-0.5 rounded text-xs font-medium ${e.mode === "hybrid" ? "bg-purple-500/20 text-purple-400" : "bg-blue-500/20 text-blue-400"}`, children: e.mode === "hybrid" ? "" : "" }),
        /* @__PURE__ */ c.jsx("span", { className: "text-xs text-muted-foreground", children: qL(e.timestamp) })
      ] }),
      /* @__PURE__ */ c.jsx("p", { className: "text-sm text-foreground mb-2", children: e.query }),
      e.preprocessedQuery && e.preprocessedQuery !== e.query && /* @__PURE__ */ c.jsxs("p", { className: "text-xs text-muted-foreground", children: [
        " : ",
        e.preprocessedQuery
      ] }),
      /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-4 mt-3 text-xs text-muted-foreground", children: [
        /* @__PURE__ */ c.jsxs("span", { children: [
          ": ",
          e.stats.totalCandidates
        ] }),
        /* @__PURE__ */ c.jsxs("span", { children: [
          "TopK: ",
          e.stats.topKCount
        ] }),
        /* @__PURE__ */ c.jsxs("span", { children: [
          "Rerank: ",
          e.stats.rerankCount
        ] }),
        /* @__PURE__ */ c.jsxs("span", { className: "flex items-center gap-1", children: [
          /* @__PURE__ */ c.jsx(Zu, { size: 10 }),
          FL(e.stats.latencyMs)
        ] })
      ] }),
      e.brainStats && /* @__PURE__ */ c.jsxs("div", { className: "mt-4 pt-3 border-t border-border/30", children: [
        /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2 mb-2", children: [
          /* @__PURE__ */ c.jsx("span", { className: "text-xs font-medium text-foreground", children: "" }),
          /* @__PURE__ */ c.jsxs("span", { className: "text-[10px] text-muted-foreground px-1.5 py-0.5 bg-muted rounded", children: [
            " ",
            e.brainStats.round,
            " "
          ] })
        ] }),
        /* @__PURE__ */ c.jsxs("div", { className: "bg-muted/20 rounded border border-border/30 overflow-hidden", children: [
          /* @__PURE__ */ c.jsxs("table", { className: "w-full text-[10px] text-left", children: [
            /* @__PURE__ */ c.jsx("thead", { className: "bg-muted/30 text-muted-foreground", children: /* @__PURE__ */ c.jsxs("tr", { children: [
              /* @__PURE__ */ c.jsx("th", { className: "p-1.5 font-medium", children: "Event" }),
              /* @__PURE__ */ c.jsx("th", { className: "p-1.5 font-medium", children: "Tier" }),
              /* @__PURE__ */ c.jsx("th", { className: "p-1.5 font-medium text-right", children: "Score" }),
              /* @__PURE__ */ c.jsx("th", { className: "p-1.5 font-medium text-right", children: "Count" })
            ] }) }),
            /* @__PURE__ */ c.jsx("tbody", { children: e.brainStats.snapshot.map((h) => /* @__PURE__ */ c.jsxs("tr", { className: "border-t border-border/10 hover:bg-muted/20 transition-colors", children: [
              /* @__PURE__ */ c.jsx("td", { className: "p-1.5 truncate max-w-[80px]", title: h.id, children: h.label || h.id.slice(0, 8) }),
              /* @__PURE__ */ c.jsx("td", { className: "p-1.5", children: /* @__PURE__ */ c.jsx("span", { className: `px-1 rounded ${h.tier === "working" ? "bg-green-500/10 text-green-500" : "text-muted-foreground"}`, children: h.tier === "working" ? "WM" : "STM" }) }),
              /* @__PURE__ */ c.jsx("td", { className: "p-1.5 text-right font-mono", children: h.finalScore.toFixed(3) }),
              /* @__PURE__ */ c.jsx("td", { className: "p-1.5 text-right font-mono", children: h.recallCount })
            ] }, h.id)) })
          ] }),
          e.brainStats.snapshot.length === 0 && /* @__PURE__ */ c.jsx("div", { className: "p-2 text-center text-[10px] text-muted-foreground italic", children: "" })
        ] })
      ] })
    ] }),
    /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-3 flex-wrap mb-3 shrink-0", children: [
      /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-1 text-xs", children: [
        /* @__PURE__ */ c.jsx(wz, { size: 12, className: "text-muted-foreground" }),
        ["all", "topK", "reranked"].map((h) => /* @__PURE__ */ c.jsx(
          "button",
          {
            className: `px-2 py-1 rounded transition-colors ${r === h ? "bg-primary/20 text-primary" : "text-muted-foreground hover:text-foreground"}`,
            onClick: () => i(h),
            children: h === "all" ? "" : h === "topK" ? "TopK" : "Reranked"
          },
          h
        ))
      ] }),
      /* @__PURE__ */ c.jsx("div", { className: "w-px h-4 bg-border" }),
      /* @__PURE__ */ c.jsx("div", { className: "flex items-center gap-1 text-xs", children: ["embedding", "rerank", "hybrid"].map((h) => /* @__PURE__ */ c.jsx(
        "button",
        {
          className: `px-2 py-1 rounded transition-colors ${s === h ? "bg-primary/20 text-primary" : "text-muted-foreground hover:text-foreground"}`,
          onClick: () => a(h),
          children: h.charAt(0).toUpperCase() + h.slice(1)
        },
        h
      )) }),
      /* @__PURE__ */ c.jsx("div", { className: "w-px h-4 bg-border" }),
      /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-1.5 text-muted-foreground", children: [
        /* @__PURE__ */ c.jsx(Ai, { size: 12 }),
        /* @__PURE__ */ c.jsx(
          "input",
          {
            type: "text",
            placeholder: "...",
            value: u,
            onChange: (h) => d(h.target.value),
            className: "bg-transparent border-none outline-none text-xs text-foreground placeholder:text-muted-foreground w-24"
          }
        )
      ] })
    ] }),
    /* @__PURE__ */ c.jsx("div", { className: "flex-1 overflow-y-auto -mx-4 md:mx-0", children: f.length === 0 ? /* @__PURE__ */ c.jsx("div", { className: "py-8 text-center text-muted-foreground text-sm", children: "" }) : f.map((h, m) => /* @__PURE__ */ c.jsx(wle, { item: h }, m)) }),
    /* @__PURE__ */ c.jsxs("div", { className: "text-[10px] text-muted-foreground py-2 border-t border-border mt-2 shrink-0", children: [
      " ",
      f.length,
      " / ",
      e.results.length,
      " "
    ] })
  ] }) : /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col items-center justify-center h-full text-muted-foreground gap-3", children: [
    /* @__PURE__ */ c.jsx(K5, { size: 32, className: "opacity-30" }),
    /* @__PURE__ */ c.jsx("p", { className: "text-sm font-light", children: "" })
  ] });
}, _le = () => {
  const [e, t] = I.useState(F1.getLogs()), [n, r] = I.useState(null), [i, s] = I.useState(window.innerWidth < x6), [a, u] = I.useState(!1);
  I.useEffect(() => {
    const m = () => {
      s(window.innerWidth < x6);
    };
    return window.addEventListener("resize", m), () => window.removeEventListener("resize", m);
  }, []), I.useEffect(() => F1.subscribe((x) => {
    t(x);
  }), []);
  const d = I.useMemo(() => e.find((m) => m.id === n) || null, [e, n]), f = (m) => {
    r(m), i && u(!0);
  }, h = () => {
    u(!1), i && r(null);
  };
  return i && a && d ? /* @__PURE__ */ c.jsx(
    v6,
    {
      entry: d,
      isFullScreen: !0,
      onClose: h
    }
  ) : /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col h-full", children: [
    /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between px-4 py-3 border-b border-border shrink-0", children: [
      /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2", children: [
        /* @__PURE__ */ c.jsx(K5, { size: 16, className: "text-primary" }),
        /* @__PURE__ */ c.jsx("span", { className: "font-medium text-foreground", children: "" }),
        /* @__PURE__ */ c.jsxs("span", { className: "text-xs text-muted-foreground", children: [
          "(",
          e.length,
          ")"
        ] })
      ] }),
      /* @__PURE__ */ c.jsx(
        "button",
        {
          className: "p-1.5 rounded-md text-muted-foreground hover:text-destructive transition-colors",
          onClick: () => F1.clear(),
          title: "",
          children: /* @__PURE__ */ c.jsx(pa, { size: 14 })
        }
      )
    ] }),
    /* @__PURE__ */ c.jsxs("div", { className: "flex-1 flex min-h-0", children: [
      /* @__PURE__ */ c.jsx("div", { className: `
                    ${i ? "w-full" : "w-[30%] min-w-[240px]"}
                    overflow-y-auto
                    ${i ? "" : "border-r border-border/50"}
                `, children: e.length === 0 ? /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col items-center justify-center h-full text-muted-foreground gap-3 p-4", children: [
        /* @__PURE__ */ c.jsx(kh, { size: 32, className: "opacity-30" }),
        /* @__PURE__ */ c.jsx("p", { className: "text-sm font-light", children: "" }),
        /* @__PURE__ */ c.jsx("p", { className: "text-xs opacity-70", children: " RAG " })
      ] }) : e.map((m) => /* @__PURE__ */ c.jsx(
        ble,
        {
          entry: m,
          isSelected: m.id === n,
          onSelect: () => f(m.id)
        },
        m.id
      )) }),
      !i && /* @__PURE__ */ c.jsx("div", { className: "flex-1 overflow-y-auto p-4", children: /* @__PURE__ */ c.jsx(v6, { entry: d }) })
    ] })
  ] });
}, UL = ({ tabs: e, activeTab: t, onChange: n, sticky: r = !0, top: i = 0, className: s = "", actions: a }) => /* @__PURE__ */ c.jsxs(
  "div",
  {
    className: `
            flex items-center justify-between gap-4 mb-6 border-b border-border
            ${r ? "glass-sticky sticky z-20 pt-4 pb-0 -mt-4 -mx-4 px-4 md:-mx-8 md:px-8 lg:-mx-12 lg:px-12" : "px-0"}
            ${s}
        `,
    style: r ? {
      top: i
    } : void 0,
    children: [
      /* @__PURE__ */ c.jsx("div", { className: "flex overflow-x-auto gap-2 pb-1 no-scrollbar", children: e.map((u) => /* @__PURE__ */ c.jsxs(
        "button",
        {
          onClick: () => n(u.id),
          className: `
                        group flex items-center gap-2 whitespace-nowrap px-4 py-1.5 text-sm relative
                        transition-colors duration-[var(--duration-fast)] ease-[var(--ease-out)]
                        ${t === u.id ? "text-foreground" : "text-muted-foreground hover:text-foreground"}
                    `,
          children: [
            u.icon && /* @__PURE__ */ c.jsx("span", { className: "w-4 h-4 transition-transform duration-[var(--duration-fast)] group-hover:scale-110", children: u.icon }),
            u.label,
            t === u.id && /* @__PURE__ */ c.jsx(
              "div",
              {
                className: "absolute -bottom-[1px] left-0 right-0 h-[2px] bg-primary shadow-[0_0_8px_var(--primary)] z-10",
                style: {
                  animation: "scale-in var(--duration-fast, 150ms) var(--ease-spring, cubic-bezier(0.34, 1.56, 0.64, 1))"
                }
              }
            )
          ]
        },
        u.id
      )) }),
      a && /* @__PURE__ */ c.jsx("div", { className: "flex items-center gap-2 pb-1 shrink-0", children: a })
    ]
  }
), rx = (e) => {
  const [t, n] = I.useState(!1);
  I.useEffect(() => (n(!0), () => n(!1)), []);
  const r = document.getElementById("engram-header-extension");
  if (!t || !r)
    return null;
  const i = {
    ...e,
    sticky: !1,
    className: `!mb-0 !border-0 !bg-transparent px-4 md:px-8 lg:px-12 ${e.className || ""}`
  };
  return Rz.createPortal(
    /* @__PURE__ */ c.jsx(UL, { ...i }),
    r
  );
}, Sle = [
  { id: "runtime", label: "", icon: /* @__PURE__ */ c.jsx(Wy, { size: 14 }) },
  { id: "model", label: "", icon: /* @__PURE__ */ c.jsx(Zu, { size: 14 }) },
  { id: "recall", label: "", icon: /* @__PURE__ */ c.jsx(K5, { size: 14 }) }
], Ele = {
  runtime: { title: "", subtitle: "" },
  model: { title: "", subtitle: " LLM " },
  recall: { title: "", subtitle: " RAG " }
}, Cle = ["ALL", ...Kz], kle = ({ initialTab: e }) => {
  const [t, n] = I.useState(e || "runtime"), r = Ele[t], [i, s] = I.useState([]), [a, u] = I.useState([]), [d, f] = I.useState(""), [h, m] = I.useState(-1), [x, b] = I.useState("ALL"), [w, S] = I.useState(!0), [C, T] = I.useState(!1), [R, N] = I.useState(!1), [M, P] = I.useState(!0), [D] = I.useState(!1), q = I.useRef(null);
  I.useEffect(() => {
    s(ee.getLogs());
    const $ = ee.subscribe((G) => {
      s((le) => [...le, G]);
    });
    return () => $();
  }, []), I.useEffect(() => {
    let $ = i;
    if (h !== -1 && ($ = $.filter((G) => G.level >= h)), x !== "ALL" && ($ = $.filter((G) => G.module.startsWith(x))), d.trim()) {
      const G = d.toLowerCase();
      $ = $.filter(
        (le) => le.message.toLowerCase().includes(G) || le.module.toLowerCase().includes(G)
      );
    }
    u($);
  }, [i, h, x, d]);
  const Y = I.useMemo(() => hle(a), [a]);
  I.useEffect(() => {
    w && q.current && q.current.scrollIntoView({ behavior: "smooth", block: "nearest" });
  }, [a, w]);
  const te = I.useCallback(async () => {
    await ee.clear(), s([]);
  }, []), V = I.useCallback(() => {
    const $ = ee.exportToMarkdown(), G = ee.getExportFilename(), le = new Blob([$], { type: "text/markdown" }), Z = URL.createObjectURL(le), oe = document.createElement("a");
    oe.href = Z, oe.download = G, oe.click(), URL.revokeObjectURL(Z), ee.success("DevLog", `: ${G}`);
  }, []);
  return /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col h-full", children: [
    /* @__PURE__ */ c.jsx(
      Gm,
      {
        breadcrumbs: [""],
        title: r.title,
        subtitle: r.subtitle,
        className: "mb-2"
      }
    ),
    /* @__PURE__ */ c.jsx(
      rx,
      {
        tabs: Sle,
        activeTab: t,
        onChange: ($) => n($)
      }
    ),
    t === "runtime" && /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col flex-1 min-h-0", children: [
      /* @__PURE__ */ c.jsx("div", { className: "sticky top-0 z-10 bg-background/95 backdrop-blur-sm py-3 -mx-4 px-4 md:-mx-8 md:px-8 lg:-mx-12 lg:px-12 border-b border-border", children: /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2 flex-wrap", children: [
        /* @__PURE__ */ c.jsxs("div", { className: "relative", children: [
          /* @__PURE__ */ c.jsxs(
            "button",
            {
              className: "inline-flex items-center gap-1.5 px-2.5 py-1.5 text-xs text-muted-foreground hover:text-foreground transition-colors",
              onClick: () => T(!C),
              children: [
                h === -1 ? "" : rb[h].label,
                /* @__PURE__ */ c.jsx(Yu, { size: 12 })
              ]
            }
          ),
          C && /* @__PURE__ */ c.jsxs("div", { className: "absolute top-full left-0 mt-1 bg-popover border border-border rounded-md shadow-lg z-20 min-w-[100px] py-1 flex flex-col", children: [
            /* @__PURE__ */ c.jsx(
              "button",
              {
                className: "block w-full text-left px-3 py-1.5 text-xs hover:bg-accent transition-colors",
                onClick: () => {
                  m(-1), T(!1);
                },
                children: ""
              }
            ),
            Object.entries(rb).map(([$, G]) => /* @__PURE__ */ c.jsxs(
              "button",
              {
                className: "block w-full text-left px-3 py-1.5 text-xs hover:bg-accent transition-colors",
                onClick: () => {
                  m(Number($)), T(!1);
                },
                children: [
                  G.icon,
                  " ",
                  G.label
                ]
              },
              $
            ))
          ] })
        ] }),
        /* @__PURE__ */ c.jsx("div", { className: "w-px h-4 bg-border" }),
        /* @__PURE__ */ c.jsxs("div", { className: "relative", children: [
          /* @__PURE__ */ c.jsxs(
            "button",
            {
              className: "inline-flex items-center gap-1.5 px-2.5 py-1.5 text-xs text-muted-foreground hover:text-foreground transition-colors",
              onClick: () => N(!R),
              children: [
                x,
                /* @__PURE__ */ c.jsx(Yu, { size: 12 })
              ]
            }
          ),
          R && /* @__PURE__ */ c.jsx("div", { className: "absolute top-full left-0 mt-1 bg-popover border border-border rounded-md shadow-lg z-20 min-w-[120px] py-1 max-h-48 overflow-y-auto flex flex-col", children: Cle.map(($) => /* @__PURE__ */ c.jsx(
            "button",
            {
              className: "block w-full text-left px-3 py-1.5 text-xs hover:bg-accent transition-colors",
              onClick: () => {
                b($), N(!1);
              },
              children: $
            },
            $
          )) })
        ] }),
        /* @__PURE__ */ c.jsx("div", { className: "w-px h-4 bg-border" }),
        /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-1.5 text-muted-foreground", children: [
          /* @__PURE__ */ c.jsx(Ai, { size: 12 }),
          /* @__PURE__ */ c.jsx(
            "input",
            {
              type: "text",
              placeholder: "...",
              value: d,
              onChange: ($) => f($.target.value),
              className: "bg-transparent border-none outline-none text-xs text-foreground placeholder:text-muted-foreground w-24 md:w-40"
            }
          )
        ] }),
        /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-1 ml-auto", children: [
          /* @__PURE__ */ c.jsx(
            "button",
            {
              className: `p-1.5 rounded transition-colors ${M ? "text-primary" : "text-muted-foreground hover:text-foreground"}`,
              onClick: () => P(!M),
              title: M ? "" : "",
              children: M ? /* @__PURE__ */ c.jsx(iV, { size: 14 }) : /* @__PURE__ */ c.jsx(QH, { size: 14 })
            }
          ),
          /* @__PURE__ */ c.jsx(
            "button",
            {
              className: `p-1.5 rounded transition-colors ${w ? "text-primary" : "text-muted-foreground hover:text-foreground"}`,
              onClick: () => S(!w),
              title: "",
              children: /* @__PURE__ */ c.jsx(qU, { size: 14 })
            }
          ),
          /* @__PURE__ */ c.jsx(
            "button",
            {
              className: "p-1.5 rounded text-muted-foreground hover:text-foreground transition-colors",
              onClick: te,
              title: "",
              children: /* @__PURE__ */ c.jsx(pa, { size: 14 })
            }
          ),
          /* @__PURE__ */ c.jsxs(
            "button",
            {
              className: "inline-flex items-center gap-1 px-2 py-1 text-xs text-muted-foreground hover:text-foreground transition-colors",
              onClick: V,
              children: [
                /* @__PURE__ */ c.jsx(sy, { size: 12 }),
                ""
              ]
            }
          )
        ] })
      ] }) }),
      /* @__PURE__ */ c.jsx("div", { className: "flex-1 overflow-y-auto font-mono text-xs leading-relaxed py-2", children: a.length === 0 ? /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col items-center justify-center h-full gap-3 text-muted-foreground", children: [
        /* @__PURE__ */ c.jsx(Wy, { size: 32, strokeWidth: 1, className: "opacity-30" }),
        /* @__PURE__ */ c.jsx("p", { className: "text-sm font-light", children: "" })
      ] }) : /* @__PURE__ */ c.jsxs(c.Fragment, { children: [
        Y.map(($, G) => /* @__PURE__ */ c.jsx(
          fle,
          {
            entries: $,
            defaultExpanded: M,
            defaultDataExpanded: D
          },
          `${$[0].module}-${$[0].id}`
        )),
        /* @__PURE__ */ c.jsx("div", { ref: q })
      ] }) }),
      /* @__PURE__ */ c.jsxs("div", { className: "text-[10px] text-muted-foreground py-2 border-t border-border", children: [
        i.length,
        " ",
        a.length !== i.length && `  ${a.length} `
      ] })
    ] }),
    t === "model" && /* @__PURE__ */ c.jsx("div", { className: "flex-1 overflow-hidden", children: /* @__PURE__ */ c.jsx(vle, {}) }),
    t === "recall" && /* @__PURE__ */ c.jsx("div", { className: "flex-1 overflow-hidden", children: /* @__PURE__ */ c.jsx(_le, {}) })
  ] });
}, Tle = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  DevLog: kle
}, Symbol.toStringTag, { value: "Module" })), jle = {
  default: "text-muted-foreground bg-muted/50",
  primary: "text-primary bg-primary/10",
  blue: "text-blue-500 bg-blue-500/10",
  purple: "text-purple-500 bg-purple-500/10",
  orange: "text-orange-500 bg-orange-500/10",
  emerald: "text-emerald-500 bg-emerald-500/10"
}, Ale = ({
  icon: e,
  title: t,
  subtitle: n,
  meta: r,
  badges: i = [],
  selected: s = !1,
  disabled: a = !1,
  toggle: u,
  onClick: d,
  actions: f = [],
  className: h = "",
  compact: m = !1
}) => {
  const x = f.filter((w) => !w.hidden), b = !!u;
  return /* @__PURE__ */ c.jsxs(
    "div",
    {
      className: `
                group relative flex items-center gap-3
                ${m ? "py-2 px-2" : "py-3 px-3"}
                rounded-lg cursor-pointer
                transition-all duration-[var(--duration-fast)] ease-[var(--ease-out)]
                hover:translate-y-[-1px] hover:shadow-sm
                ${s ? "bg-accent/60" : "hover:bg-muted/40"}
                ${a ? "opacity-50 pointer-events-none" : ""}
                ${h}
            `,
      onClick: d,
      children: [
        (e || b) && /* @__PURE__ */ c.jsx("div", { className: "flex-shrink-0", children: b ? /* @__PURE__ */ c.jsx(
          "button",
          {
            className: `
                                w-7 h-7 flex items-center justify-center rounded-md transition-colors
                                ${u.checked ? "text-primary" : "text-muted-foreground hover:text-foreground"}
                            `,
            onClick: (w) => {
              w.stopPropagation(), u.onChange(!u.checked);
            },
            children: /* @__PURE__ */ c.jsx(Hb, { size: 14 })
          }
        ) : /* @__PURE__ */ c.jsx("div", { className: `
                            w-7 h-7 flex items-center justify-center rounded-md transition-colors
                            ${s ? "text-primary" : "text-muted-foreground group-hover:text-foreground"}
                        `, children: e }) }),
        /* @__PURE__ */ c.jsxs("div", { className: "flex-1 min-w-0", children: [
          /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2", children: [
            /* @__PURE__ */ c.jsx("span", { className: `
                        text-sm font-medium truncate transition-colors
                        ${s ? "text-foreground" : "text-muted-foreground group-hover:text-foreground"}
                        ${u && !u.checked ? "line-through opacity-60" : ""}
                    `, children: t }),
            i.map((w, S) => /* @__PURE__ */ c.jsx(
              "span",
              {
                className: `
                                text-[10px] px-1.5 py-0.5 rounded-sm font-medium flex-shrink-0
                                ${jle[w.color || "default"]}
                            `,
                children: w.text
              },
              S
            ))
          ] }),
          (n || r) && /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between mt-0.5 text-[11px] text-muted-foreground/70", children: [
            n && /* @__PURE__ */ c.jsx("span", { className: "truncate", children: n }),
            r && /* @__PURE__ */ c.jsx("span", { className: "flex-shrink-0 font-mono", children: r })
          ] })
        ] }),
        s && !x.length && /* @__PURE__ */ c.jsx(vh, { size: 14, className: "text-primary flex-shrink-0" }),
        x.length > 0 && /* @__PURE__ */ c.jsx("div", { className: `
                    flex items-center gap-0.5 flex-shrink-0
                    ${s ? "opacity-100" : "opacity-0 group-hover:opacity-100"}
                    transition-opacity
                `, children: x.map((w, S) => /* @__PURE__ */ c.jsx(
          "button",
          {
            className: `
                                p-1.5 rounded transition-colors
                                ${w.danger ? "text-muted-foreground hover:text-destructive hover:bg-destructive/10" : "text-muted-foreground hover:text-foreground hover:bg-muted"}
                            `,
            onClick: (C) => {
              C.stopPropagation(), w.onClick(C);
            },
            title: w.title,
            children: w.icon
          },
          S
        )) })
      ]
    }
  );
}, Nle = ({
  preset: e,
  isSelected: t,
  onSelect: n,
  onEdit: r,
  onCopy: i,
  onDelete: s
}) => {
  var d;
  const a = e.source === "tavern" || e.source === "tavern_profile" ? o3 : mH, u = e.source === "custom" ? ((d = e.custom) == null ? void 0 : d.model) || "" : "";
  return /* @__PURE__ */ c.jsx(
    Ale,
    {
      icon: /* @__PURE__ */ c.jsx(a, { size: 14 }),
      title: e.name,
      subtitle: u,
      meta: `T:${e.parameters.temperature}`,
      badges: e.isDefault ? [{ text: "DEFAULT", color: "primary" }] : [],
      selected: t,
      onClick: n,
      actions: [
        { icon: /* @__PURE__ */ c.jsx(fV, { size: 12 }), onClick: () => r(), title: "" },
        { icon: /* @__PURE__ */ c.jsx(H5, { size: 12 }), onClick: () => i(), title: "" },
        { icon: /* @__PURE__ */ c.jsx(pa, { size: 12 }), onClick: () => s(), title: "", danger: !0, hidden: e.isDefault }
      ]
    }
  );
}, ls = ({
  title: e,
  description: t,
  children: n,
  className: r = "",
  collapsible: i = !1,
  defaultCollapsed: s = !1
}) => {
  const [a, u] = I.useState(i ? s : !1);
  return /* @__PURE__ */ c.jsxs("div", { className: `mb-8 ${r}`, children: [
    /* @__PURE__ */ c.jsxs(
      "div",
      {
        className: `mb-4 ${i ? "cursor-pointer select-none flex items-center justify-between group" : ""}`,
        onClick: () => i && u(!a),
        children: [
          /* @__PURE__ */ c.jsxs("div", { children: [
            /* @__PURE__ */ c.jsx("h3", { className: "text-sm font-medium text-primary flex items-center gap-2", children: e }),
            t && /* @__PURE__ */ c.jsx("p", { className: "text-xs text-muted-foreground mt-1 break-words", children: t })
          ] }),
          i && /* @__PURE__ */ c.jsx(
            Yu,
            {
              size: 16,
              className: `text-muted-foreground transition-transform duration-200 ${a ? "-rotate-90" : "rotate-0"}`
            }
          )
        ]
      }
    ),
    /* @__PURE__ */ c.jsx("div", { className: `space-y-4 transition-all duration-300 ${a ? "hidden" : "block"}`, children: n })
  ] });
}, us = ({
  label: e,
  description: t,
  error: n,
  required: r,
  className: i = "",
  value: s,
  onChange: a,
  placeholder: u,
  type: d = "text",
  disabled: f,
  readOnly: h,
  multiline: m,
  rows: x = 3
}) => {
  const b = {
    background: "transparent",
    backgroundColor: "transparent",
    border: "none",
    borderBottom: "1px solid var(--border)",
    borderRadius: 0,
    boxShadow: "none",
    outline: "none",
    padding: "8px 0",
    fontSize: "14px",
    width: "100%",
    color: "var(--foreground, inherit)"
  };
  return /* @__PURE__ */ c.jsxs("div", { className: `flex flex-col gap-1 ${i}`, children: [
    /* @__PURE__ */ c.jsxs("label", { className: "text-xs text-muted-foreground flex items-center gap-1", children: [
      e,
      r && /* @__PURE__ */ c.jsx("span", { className: "text-destructive", children: "*" })
    ] }),
    m ? /* @__PURE__ */ c.jsx(
      "textarea",
      {
        value: s,
        onChange: (w) => a(w.target.value),
        placeholder: u,
        disabled: f,
        readOnly: h,
        rows: x,
        style: b,
        className: "font-mono resize-y min-h-[80px] placeholder:text-muted-foreground/40 disabled:opacity-50 focus:border-primary transition-colors"
      }
    ) : /* @__PURE__ */ c.jsx(
      "input",
      {
        type: d,
        value: s,
        onChange: (w) => a(w.target.value),
        placeholder: u,
        disabled: f,
        readOnly: h,
        style: b,
        className: "placeholder:text-muted-foreground/40 disabled:opacity-50 focus:border-primary transition-colors"
      }
    ),
    t && /* @__PURE__ */ c.jsx("p", { className: "text-[10px] text-muted-foreground/70 break-words", children: t }),
    n && /* @__PURE__ */ c.jsx("p", { className: "text-[10px] text-destructive", children: n })
  ] });
}, Ir = ({
  label: e,
  description: t,
  error: n,
  required: r,
  className: i = "",
  value: s,
  onChange: a,
  min: u,
  max: d,
  step: f = 1,
  showSlider: h = !0,
  suffix: m
}) => {
  const x = {
    background: "transparent",
    backgroundColor: "transparent",
    border: "none",
    borderRadius: 0,
    boxShadow: "none",
    outline: "none",
    padding: "0",
    fontSize: "12px",
    width: "auto",
    minWidth: "40px",
    textAlign: "right",
    fontFamily: "monospace",
    color: "var(--foreground, inherit)"
  }, b = u !== void 0 && d !== void 0 ? Math.min(100, Math.max(0, (s - u) / (d - u) * 100)) : 0;
  return /* @__PURE__ */ c.jsxs("div", { className: `flex flex-col gap-2 ${i}`, children: [
    /* @__PURE__ */ c.jsxs("div", { className: "flex justify-between items-center", children: [
      /* @__PURE__ */ c.jsxs("label", { className: "text-xs text-muted-foreground flex items-center gap-1", children: [
        e,
        r && /* @__PURE__ */ c.jsx("span", { className: "text-destructive", children: "*" })
      ] }),
      /* @__PURE__ */ c.jsx(
        "input",
        {
          type: "number",
          min: u,
          max: d,
          step: f,
          value: s,
          onChange: (w) => a(Number(w.target.value)),
          style: x,
          className: "focus:text-primary transition-colors [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"
        }
      )
    ] }),
    /* @__PURE__ */ c.jsx("div", { className: "flex items-center gap-3 pt-1", children: h && u !== void 0 && d !== void 0 && /* @__PURE__ */ c.jsxs("div", { className: "flex-1 relative h-4 flex items-center group cursor-pointer", children: [
      /* @__PURE__ */ c.jsx(
        "div",
        {
          className: "absolute inset-x-0 h-[1px]",
          style: { backgroundColor: "var(--border)" }
        }
      ),
      /* @__PURE__ */ c.jsx(
        "div",
        {
          className: "absolute top-1/2 -translate-y-1/2 w-2.5 h-2.5 bg-muted-foreground/80 rounded-full shadow-sm pointer-events-none transition-transform duration-75 ease-out group-hover:scale-125 group-hover:bg-foreground",
          style: { left: `${b}%`, transform: "translate(-50%, -50%)" }
        }
      ),
      /* @__PURE__ */ c.jsx(
        "input",
        {
          type: "range",
          min: u,
          max: d,
          step: f,
          value: s,
          onChange: (w) => a(Number(w.target.value)),
          className: "absolute inset-x-0 w-full h-full opacity-0 cursor-pointer z-10 m-0",
          style: { appearance: "none", WebkitAppearance: "none" }
        }
      )
    ] }) }),
    t && /* @__PURE__ */ c.jsx("p", { className: "text-[10px] text-muted-foreground/70 break-words", children: t }),
    n && /* @__PURE__ */ c.jsx("p", { className: "text-[10px] text-destructive", children: n })
  ] });
}, el = ({
  label: e,
  description: t,
  error: n,
  required: r,
  className: i = "",
  value: s,
  onChange: a,
  options: u,
  placeholder: d = "...",
  disabled: f
}) => {
  const h = {
    background: "transparent",
    backgroundColor: "transparent",
    border: "none",
    borderBottom: "1px solid var(--border)",
    borderRadius: 0,
    boxShadow: "none",
    outline: "none",
    padding: "8px 24px 8px 0",
    fontSize: "14px",
    width: "100%",
    cursor: "pointer",
    color: "var(--foreground, inherit)",
    appearance: "none",
    WebkitAppearance: "none"
  };
  return /* @__PURE__ */ c.jsxs("div", { className: `flex flex-col gap-1 ${i}`, children: [
    /* @__PURE__ */ c.jsxs("label", { className: "text-xs text-muted-foreground flex items-center gap-1", children: [
      e,
      r && /* @__PURE__ */ c.jsx("span", { className: "text-destructive", children: "*" })
    ] }),
    /* @__PURE__ */ c.jsxs("div", { className: "relative", children: [
      /* @__PURE__ */ c.jsxs(
        "select",
        {
          value: s,
          onChange: (m) => a(m.target.value),
          disabled: f,
          style: h,
          className: "disabled:opacity-50 disabled:cursor-not-allowed focus:border-primary transition-colors",
          children: [
            /* @__PURE__ */ c.jsx("option", { value: "", disabled: !0, className: "bg-popover text-muted-foreground", children: d }),
            u.map((m) => /* @__PURE__ */ c.jsx("option", { value: m.value, className: "bg-popover text-foreground", children: m.label }, m.value))
          ]
        }
      ),
      /* @__PURE__ */ c.jsx(Yu, { size: 14, className: "absolute right-0 top-1/2 -translate-y-1/2 text-muted-foreground/50 pointer-events-none" })
    ] }),
    t && /* @__PURE__ */ c.jsx("p", { className: "text-[10px] text-muted-foreground/70 break-words", children: t }),
    n && /* @__PURE__ */ c.jsx("p", { className: "text-[10px] text-destructive", children: n })
  ] });
}, Zo = ({
  label: e,
  description: t,
  error: n,
  className: r = "",
  checked: i,
  onChange: s,
  disabled: a,
  compact: u
}) => /* @__PURE__ */ c.jsxs("div", { className: `flex items-start justify-between gap-4 ${u ? "py-0" : "py-1"} ${r} ${a ? "opacity-50 pointer-events-none" : ""}`, children: [
  e && /* @__PURE__ */ c.jsxs("div", { className: "flex-1 min-w-0", children: [
    /* @__PURE__ */ c.jsx(
      "label",
      {
        className: "text-xs text-foreground cursor-pointer block truncate",
        onClick: () => !a && s(!i),
        children: e
      }
    ),
    t && /* @__PURE__ */ c.jsx("p", { className: "text-[10px] text-muted-foreground/70 mt-0.5 break-words", children: t }),
    n && /* @__PURE__ */ c.jsx("p", { className: "text-[10px] text-destructive mt-0.5", children: n })
  ] }),
  /* @__PURE__ */ c.jsx(
    gi,
    {
      checked: i,
      onChange: s,
      disabled: a
    }
  )
] }), HL = ({
  label: e,
  description: t,
  error: n,
  required: r,
  className: i = "",
  value: s,
  onChange: a,
  options: u,
  placeholder: d = "...",
  disabled: f,
  emptyText: h = ""
}) => {
  var M;
  const [m, x] = I.useState(!1), [b, w] = I.useState(""), S = I.useRef(null), C = I.useRef(null), T = u.filter(
    (P) => P.label.toLowerCase().includes(b.toLowerCase()) || P.value.toLowerCase().includes(b.toLowerCase())
  ), R = ((M = u.find((P) => P.value === s)) == null ? void 0 : M.label) || s || d;
  I.useEffect(() => {
    const P = (D) => {
      S.current && !S.current.contains(D.target) && (x(!1), w(""));
    };
    return document.addEventListener("mousedown", P), () => document.removeEventListener("mousedown", P);
  }, []), I.useEffect(() => {
    m && C.current && C.current.focus();
  }, [m]);
  const N = (P) => {
    a(P), x(!1), w("");
  };
  return /* @__PURE__ */ c.jsxs("div", { className: `flex flex-col gap-1 ${i}`, ref: S, children: [
    /* @__PURE__ */ c.jsxs("label", { className: "text-xs text-muted-foreground flex items-center gap-1", children: [
      e,
      r && /* @__PURE__ */ c.jsx("span", { className: "text-destructive", children: "*" })
    ] }),
    /* @__PURE__ */ c.jsxs(
      "button",
      {
        type: "button",
        onClick: () => !f && x(!m),
        disabled: f,
        className: "relative w-full text-left py-2 pr-6 border-0 border-b border-border bg-transparent text-sm text-foreground cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed focus:border-primary transition-colors",
        children: [
          /* @__PURE__ */ c.jsx("span", { className: s ? "" : "text-muted-foreground", children: R }),
          /* @__PURE__ */ c.jsx(
            Yu,
            {
              size: 14,
              className: `absolute right-0 top-1/2 -translate-y-1/2 text-muted-foreground/50 transition-transform ${m ? "rotate-180" : ""}`
            }
          )
        ]
      }
    ),
    m && /* @__PURE__ */ c.jsxs(
      "div",
      {
        className: "glass-panel absolute z-50 mt-1 w-full max-h-64 border border-border rounded-lg shadow-xl overflow-hidden flex flex-col animate-in fade-in slide-in-from-top-1 duration-150",
        style: { top: "100%", left: 0, right: 0 },
        children: [
          /* @__PURE__ */ c.jsxs("div", { className: "p-2 border-b border-border flex items-center gap-2", children: [
            /* @__PURE__ */ c.jsx(Ai, { size: 14, className: "text-muted-foreground flex-shrink-0" }),
            /* @__PURE__ */ c.jsx(
              "input",
              {
                ref: C,
                type: "text",
                value: b,
                onChange: (P) => w(P.target.value),
                placeholder: "...",
                className: "flex-1 bg-transparent border-none outline-none text-sm text-foreground placeholder:text-muted-foreground/50"
              }
            ),
            b && /* @__PURE__ */ c.jsx(
              "button",
              {
                type: "button",
                onClick: () => w(""),
                className: "p-0.5 hover:bg-muted rounded",
                children: /* @__PURE__ */ c.jsx(Wu, { size: 12, className: "text-muted-foreground" })
              }
            )
          ] }),
          /* @__PURE__ */ c.jsx("div", { className: "overflow-y-auto max-h-48", children: T.length > 0 ? T.map((P) => /* @__PURE__ */ c.jsx(
            "div",
            {
              onClick: () => N(P.value),
              className: `px-3 py-2 cursor-pointer text-sm truncate transition-colors ${P.value === s ? "bg-primary/15 text-primary" : "hover:bg-muted text-foreground"}`,
              title: P.label,
              children: P.label
            },
            P.value
          )) : /* @__PURE__ */ c.jsx("div", { className: "px-3 py-4 text-center text-sm text-muted-foreground", children: b ? "" : h }) }),
          u.length > 10 && /* @__PURE__ */ c.jsxs("div", { className: "px-3 py-1 border-t border-border text-xs text-muted-foreground/70", children: [
            T.length,
            " / ",
            u.length,
            " "
          ] })
        ]
      }
    ),
    t && /* @__PURE__ */ c.jsx("p", { className: "text-[10px] text-muted-foreground/70 break-words", children: t }),
    n && /* @__PURE__ */ c.jsx("p", { className: "text-[10px] text-destructive", children: n })
  ] });
}, Fu = "ModelService";
class Xl {
  // 10
  /**
   *  API 
   */
  static async fetchModels(t, n) {
    switch (t) {
      case "openai":
        return this.fetchOpenAIModels(n);
      case "ollama":
        return this.fetchOllamaModels(n);
      case "vllm":
        return this.fetchVLLMModels(n);
      case "cohere":
        return this.fetchCohereModels(n);
      case "jina":
      case "voyage":
        return this.getPresetModels(t);
      default:
        return ee.warn(Fu, `Unknown API type: ${t}`), [];
    }
  }
  /**
   *  OpenAI  API 
   * : OpenAI, Azure,  OpenAI 
   */
  static async fetchOpenAIModels(t) {
    const { apiUrl: n, apiKey: r, timeout: i = this.DEFAULT_TIMEOUT } = t, a = `${n.replace(/\/+$/, "")}/models`;
    try {
      const u = new AbortController(), d = setTimeout(() => u.abort(), i), f = {
        "Content-Type": "application/json"
      };
      r && (f.Authorization = `Bearer ${r}`);
      const h = await fetch(a, {
        method: "GET",
        headers: f,
        signal: u.signal
      });
      if (clearTimeout(d), !h.ok)
        throw new Error(`HTTP ${h.status}: ${h.statusText}`);
      const m = await h.json(), x = (m.data || m || []).map((b) => ({
        id: b.id || b.model,
        name: b.name || b.id || b.model,
        owned_by: b.owned_by
      }));
      return ee.info(Fu, `Fetched ${x.length} models from OpenAI API`), x.sort((b, w) => b.id.localeCompare(w.id));
    } catch (u) {
      throw u.name === "AbortError" ? ee.error(Fu, "OpenAI API request timeout") : ee.error(Fu, `OpenAI API error: ${u.message}`), u;
    }
  }
  /**
   *  Ollama 
   */
  static async fetchOllamaModels(t) {
    const { apiUrl: n, timeout: r = this.DEFAULT_TIMEOUT } = t, s = `${n.replace(/\/+$/, "")}/api/tags`;
    try {
      const a = new AbortController(), u = setTimeout(() => a.abort(), r), d = await fetch(s, {
        method: "GET",
        signal: a.signal
      });
      if (clearTimeout(u), !d.ok)
        throw new Error(`HTTP ${d.status}: ${d.statusText}`);
      const h = ((await d.json()).models || []).map((m) => ({
        id: m.name || m.model,
        name: m.name || m.model
      }));
      return ee.info(Fu, `Fetched ${h.length} models from Ollama`), h;
    } catch (a) {
      throw ee.error(Fu, `Ollama API error: ${a.message}`), a;
    }
  }
  /**
   *  vLLM 
   * vLLM  OpenAI  API
   */
  static async fetchVLLMModels(t) {
    return this.fetchOpenAIModels(t);
  }
  /**
   *  Cohere 
   */
  static async fetchCohereModels(t) {
    const { apiKey: n, timeout: r = this.DEFAULT_TIMEOUT } = t;
    if (!n)
      return ee.warn(Fu, "Cohere API key required"), this.getPresetModels("cohere");
    try {
      const i = new AbortController(), s = setTimeout(() => i.abort(), r), a = await fetch("https://api.cohere.ai/v1/models", {
        method: "GET",
        headers: {
          Authorization: `Bearer ${n}`,
          "Content-Type": "application/json"
        },
        signal: i.signal
      });
      if (clearTimeout(s), !a.ok)
        throw new Error(`HTTP ${a.status}: ${a.statusText}`);
      const d = ((await a.json()).models || []).filter((f) => {
        var h;
        return (h = f.endpoints) == null ? void 0 : h.includes("embed");
      }).map((f) => ({
        id: f.name,
        name: f.name,
        contextLength: f.context_length
      }));
      return ee.info(Fu, `Fetched ${d.length} embed models from Cohere`), d;
    } catch (i) {
      return ee.error(Fu, `Cohere API error: ${i.message}`), this.getPresetModels("cohere");
    }
  }
  /**
   * 
   */
  static getPresetModels(t) {
    return {
      cohere: [
        { id: "embed-multilingual-v3.0", name: "Embed Multilingual v3.0" },
        { id: "embed-english-v3.0", name: "Embed English v3.0" },
        { id: "embed-multilingual-light-v3.0", name: "Embed Multilingual Light v3.0" },
        { id: "embed-english-light-v3.0", name: "Embed English Light v3.0" }
      ],
      jina: [
        { id: "jina-embeddings-v3", name: "Jina Embeddings v3" },
        { id: "jina-embeddings-v2-base-en", name: "Jina Embeddings v2 Base EN" },
        { id: "jina-embeddings-v2-base-zh", name: "Jina Embeddings v2 Base ZH" },
        { id: "jina-colbert-v2", name: "Jina ColBERT v2" }
      ],
      voyage: [
        { id: "voyage-3", name: "Voyage 3" },
        { id: "voyage-3-lite", name: "Voyage 3 Lite" },
        { id: "voyage-large-2", name: "Voyage Large 2" },
        { id: "voyage-code-2", name: "Voyage Code 2" },
        { id: "voyage-multilingual-2", name: "Voyage Multilingual 2" }
      ],
      openai: [
        { id: "text-embedding-3-large", name: "Text Embedding 3 Large" },
        { id: "text-embedding-3-small", name: "Text Embedding 3 Small" },
        { id: "text-embedding-ada-002", name: "Text Embedding Ada 002" }
      ]
    }[t] || [];
  }
  /**
   *  Rerank 
   */
  static getCommonRerankModels() {
    return [
      { id: "BAAI/bge-reranker-v2-m3", name: "BGE Reranker v2 m3" },
      { id: "BAAI/bge-reranker-large", name: "BGE Reranker Large" },
      { id: "BAAI/bge-reranker-base", name: "BGE Reranker Base" },
      { id: "cross-encoder/ms-marco-MiniLM-L-12-v2", name: "MS MARCO MiniLM L12" },
      { id: "Xenova/ms-marco-MiniLM-L-6-v2", name: "MS MARCO MiniLM L6 (ONNX)" },
      { id: "jinaai/jina-reranker-v2-base-multilingual", name: "Jina Reranker v2 Multilingual" }
    ];
  }
}
lt(Xl, "DEFAULT_TIMEOUT", 1e4);
const Rle = [
  { value: "openai", label: "OpenAI" },
  { value: "anthropic", label: "Anthropic" },
  { value: "ollama", label: "Ollama" },
  { value: "vllm", label: "vLLM" },
  { value: "azure", label: "Azure OpenAI" },
  { value: "custom", label: "" }
], Mle = [
  { value: "tavern", label: "" },
  { value: "tavern_profile", label: "" },
  { value: "custom", label: " API " }
];
function Ole() {
  var e, t, n, r;
  try {
    const i = (n = (t = (e = window.SillyTavern) == null ? void 0 : e.getContext) == null ? void 0 : t.call(e)) == null ? void 0 : n.extensionSettings;
    return ((r = i == null ? void 0 : i.connectionManager) == null ? void 0 : r.profiles) || [];
  } catch (i) {
    return console.warn("[Engram]  connection_profiles:", i), [];
  }
}
const b6 = ({
  preset: e,
  onChange: t,
  isNew: n = !1
}) => {
  var P, D, q, Y, te, V;
  const [r, i] = I.useState([]), [s, a] = I.useState(!1), [u, d] = I.useState([]), [f, h] = I.useState(!1), [m, x] = I.useState(null), b = () => {
    a(!0);
    try {
      const $ = Ole();
      i($);
    } finally {
      a(!1);
    }
  }, w = async () => {
    const { apiUrl: $, apiKey: G, apiSource: le } = e.custom || {};
    if (!$) {
      x(" API URL");
      return;
    }
    h(!0), x(null);
    try {
      let Z = [];
      le === "ollama" ? Z = await Xl.fetchOllamaModels({ apiUrl: $ }) : Z = await Xl.fetchOpenAIModels({ apiUrl: $, apiKey: G }), d(Z), Z.length === 0 && x("");
    } catch (Z) {
      x(Z.message || ""), d([]);
    } finally {
      h(!1);
    }
  };
  I.useEffect(() => {
    b();
  }, []);
  const S = ($) => {
    t({ ...e, ...$, updatedAt: Date.now() });
  }, C = ($, G) => {
    S({
      parameters: { ...e.parameters, [$]: G }
    });
  }, T = ($, G) => {
    var le, Z, oe, X;
    S({
      custom: {
        apiUrl: ((le = e.custom) == null ? void 0 : le.apiUrl) || "",
        apiKey: ((Z = e.custom) == null ? void 0 : Z.apiKey) || "",
        model: ((oe = e.custom) == null ? void 0 : oe.model) || "",
        apiSource: ((X = e.custom) == null ? void 0 : X.apiSource) || "openai",
        [$]: G
      }
    });
  }, R = ($) => {
    const G = $;
    S({
      source: G,
      tavernProfileId: G === "tavern_profile" ? e.tavernProfileId : void 0
    }), G === "tavern_profile" && b();
  }, N = r.map(($) => ({
    value: $.id,
    label: `${$.name} (${$.api || "Unknown"} - ${$.model || "Unknown"})`
  })), M = r.find(($) => $.id === e.tavernProfileId);
  return /* @__PURE__ */ c.jsxs("div", { className: "", children: [
    /* @__PURE__ */ c.jsxs(ls, { title: "", children: [
      /* @__PURE__ */ c.jsx(
        us,
        {
          label: "",
          value: e.name,
          onChange: ($) => S({ name: $ }),
          placeholder: "",
          required: !0
        }
      ),
      /* @__PURE__ */ c.jsx(
        el,
        {
          label: "",
          value: e.source,
          onChange: R,
          options: Mle,
          description: " API "
        }
      )
    ] }),
    e.source === "tavern_profile" && /* @__PURE__ */ c.jsxs(ls, { title: "", description: "", children: [
      /* @__PURE__ */ c.jsxs("div", { className: "flex items-end gap-2", children: [
        /* @__PURE__ */ c.jsx(
          el,
          {
            className: "flex-1 !mb-0",
            label: "",
            value: e.tavernProfileId || "",
            onChange: ($) => S({ tavernProfileId: $ }),
            options: N,
            placeholder: s ? "..." : "",
            disabled: s || N.length === 0
          }
        ),
        /* @__PURE__ */ c.jsx(
          "button",
          {
            type: "button",
            className: "h-[42px] w-[42px] min-w-[42px] flex items-center justify-center border-none rounded-md bg-muted text-muted-foreground cursor-pointer transition-all hover:bg-accent hover:text-foreground",
            onClick: b,
            disabled: s,
            title: "",
            children: /* @__PURE__ */ c.jsx(fr, { size: 16, className: s ? "animate-spin" : "" })
          }
        )
      ] }),
      N.length === 0 && !s && /* @__PURE__ */ c.jsx("div", { className: "p-3 bg-muted/30 border border-dashed border-border rounded-lg text-muted-foreground text-sm text-center mt-3", children: "" }),
      M && /* @__PURE__ */ c.jsxs("div", { className: "mt-4 p-3 bg-card rounded-lg border border-border", children: [
        /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2 py-1 text-sm border-b border-border last:border-0", children: [
          /* @__PURE__ */ c.jsx("span", { className: "text-muted-foreground min-w-[60px]", children: "API:" }),
          /* @__PURE__ */ c.jsx("span", { className: "text-foreground font-mono", children: M.api || "-" })
        ] }),
        /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2 py-1 text-sm border-b border-border last:border-0", children: [
          /* @__PURE__ */ c.jsx("span", { className: "text-muted-foreground min-w-[60px]", children: ":" }),
          /* @__PURE__ */ c.jsx("span", { className: "text-foreground font-mono", children: M.model || "-" })
        ] }),
        /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2 py-1 text-sm border-b border-border last:border-0", children: [
          /* @__PURE__ */ c.jsx("span", { className: "text-muted-foreground min-w-[60px]", children: ":" }),
          /* @__PURE__ */ c.jsx("span", { className: "text-foreground font-mono", children: M.preset || "-" })
        ] })
      ] })
    ] }),
    e.source === "custom" && /* @__PURE__ */ c.jsxs(ls, { title: "API ", description: " API ", children: [
      /* @__PURE__ */ c.jsx(
        el,
        {
          label: "API ",
          value: ((P = e.custom) == null ? void 0 : P.apiSource) || "openai",
          onChange: ($) => T("apiSource", $),
          options: Rle
        }
      ),
      /* @__PURE__ */ c.jsx(
        us,
        {
          label: "API URL",
          type: "url",
          value: ((D = e.custom) == null ? void 0 : D.apiUrl) || "",
          onChange: ($) => T("apiUrl", $),
          placeholder: "https://api.openai.com/v1",
          required: !0
        }
      ),
      /* @__PURE__ */ c.jsx(
        us,
        {
          label: "API Key",
          type: "password",
          value: ((q = e.custom) == null ? void 0 : q.apiKey) || "",
          onChange: ($) => T("apiKey", $),
          placeholder: "sk-..."
        }
      ),
      /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-2", children: [
        /* @__PURE__ */ c.jsxs("div", { className: "flex items-end gap-2", children: [
          u.length > 0 ? /* @__PURE__ */ c.jsx(
            el,
            {
              className: "flex-1 !mb-0",
              label: "",
              value: ((Y = e.custom) == null ? void 0 : Y.model) || "",
              onChange: ($) => T("model", $),
              options: u.map(($) => ({ value: $.id, label: $.name || $.id })),
              placeholder: ""
            }
          ) : /* @__PURE__ */ c.jsx(
            us,
            {
              className: "flex-1 !mb-0",
              label: "",
              value: ((te = e.custom) == null ? void 0 : te.model) || "",
              onChange: ($) => T("model", $),
              placeholder: "gpt-4o-mini",
              required: !0
            }
          ),
          /* @__PURE__ */ c.jsx(
            "button",
            {
              type: "button",
              className: "h-[42px] w-[42px] min-w-[42px] flex items-center justify-center border-none rounded-md bg-muted text-muted-foreground cursor-pointer transition-all hover:bg-accent hover:text-foreground disabled:opacity-50 disabled:cursor-not-allowed",
              onClick: w,
              disabled: f || !((V = e.custom) != null && V.apiUrl),
              title: "",
              children: f ? /* @__PURE__ */ c.jsx(rc, { size: 16, className: "animate-spin" }) : /* @__PURE__ */ c.jsx(fr, { size: 16 })
            }
          )
        ] }),
        m && /* @__PURE__ */ c.jsx("p", { className: "text-xs text-destructive", children: m }),
        u.length > 0 && /* @__PURE__ */ c.jsxs("p", { className: "text-xs text-muted-foreground", children: [
          " ",
          u.length,
          " "
        ] })
      ] })
    ] }),
    /* @__PURE__ */ c.jsxs(ls, { title: "", description: "", children: [
      /* @__PURE__ */ c.jsx(
        Ir,
        {
          label: " (Temperature)",
          value: e.parameters.temperature,
          onChange: ($) => C("temperature", $),
          min: 0,
          max: 2,
          step: 0.1,
          description: ""
        }
      ),
      /* @__PURE__ */ c.jsx(
        Ir,
        {
          label: "Top-P",
          value: e.parameters.topP,
          onChange: ($) => C("topP", $),
          min: 0,
          max: 1,
          step: 0.05,
          description: " token "
        }
      ),
      /* @__PURE__ */ c.jsx(
        Ir,
        {
          label: " Tokens",
          value: e.parameters.maxTokens,
          onChange: ($) => C("maxTokens", $),
          min: 64,
          max: 16384,
          step: 64,
          showSlider: !1
        }
      ),
      /* @__PURE__ */ c.jsx(
        Ir,
        {
          label: "",
          value: e.parameters.frequencyPenalty,
          onChange: ($) => C("frequencyPenalty", $),
          min: -2,
          max: 2,
          step: 0.1,
          description: " token "
        }
      ),
      /* @__PURE__ */ c.jsx(
        Ir,
        {
          label: "",
          value: e.parameters.presencePenalty,
          onChange: ($) => C("presencePenalty", $),
          min: -2,
          max: 2,
          step: 0.1,
          description: ""
        }
      )
    ] })
  ] });
}, Dle = [
  { value: "custom", label: " (OpenAI )" },
  { value: "transformers", label: "Transformers ()" },
  { value: "openai", label: "OpenAI Embeddings" },
  { value: "ollama", label: "Ollama" },
  { value: "vllm", label: "vLLM" },
  { value: "cohere", label: "Cohere" },
  { value: "jina", label: "Jina AI" },
  { value: "voyage", label: "Voyage AI" }
], w6 = {
  custom: "text-embedding-3-small",
  transformers: "Xenova/all-MiniLM-L6-v2",
  openai: "text-embedding-3-small",
  ollama: "nomic-embed-text",
  vllm: "BAAI/bge-m3",
  cohere: "embed-multilingual-v3.0",
  jina: "jina-embeddings-v3",
  voyage: "voyage-large-2"
}, _6 = ["custom", "ollama", "vllm"], S6 = ["custom", "openai", "cohere", "jina", "voyage"], zle = ({
  config: e,
  onChange: t
}) => {
  var b;
  const n = (w) => {
    t({ ...e, ...w });
  }, r = (w) => {
    n({
      source: w,
      model: w6[w],
      apiUrl: _6.includes(w) ? e.apiUrl : void 0,
      apiKey: S6.includes(w) ? e.apiKey : void 0
    });
  }, i = _6.includes(e.source), s = S6.includes(e.source), [a, u] = I.useState([]), [d, f] = I.useState(!1), [h, m] = I.useState(null), x = async () => {
    f(!0), m(null);
    try {
      let w = [];
      const S = { apiUrl: e.apiUrl || "", apiKey: e.apiKey };
      switch (e.source) {
        case "custom":
          if (!e.apiUrl) {
            m(" API URL");
            return;
          }
          w = await Xl.fetchOpenAIModels(S);
          break;
        case "ollama":
          if (!e.apiUrl) {
            m(" API URL");
            return;
          }
          w = await Xl.fetchOllamaModels(S);
          break;
        case "vllm":
          if (!e.apiUrl) {
            m(" API URL");
            return;
          }
          w = await Xl.fetchVLLMModels(S);
          break;
        case "openai":
        case "cohere":
        case "jina":
        case "voyage":
          w = Xl.getPresetModels(e.source);
          break;
        default:
          w = [];
      }
      u(w), w.length === 0 && m("");
    } catch (w) {
      m(w.message || ""), u([]);
    } finally {
      f(!1);
    }
  };
  return /* @__PURE__ */ c.jsxs("div", { className: "", children: [
    /* @__PURE__ */ c.jsxs(ls, { title: "", description: "", children: [
      /* @__PURE__ */ c.jsx(
        el,
        {
          label: "",
          value: e.source,
          onChange: (w) => r(w),
          options: Dle,
          description: ""
        }
      ),
      i && /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-1", children: [
        /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between", children: [
          /* @__PURE__ */ c.jsx("label", { className: "text-xs text-muted-foreground", children: e.source === "ollama" ? "API Endpoint" : "API Base URL" }),
          e.source !== "ollama" && /* @__PURE__ */ c.jsxs("label", { className: "flex items-center gap-1.5 text-[10px] text-muted-foreground cursor-pointer select-none", children: [
            /* @__PURE__ */ c.jsx(
              "input",
              {
                type: "checkbox",
                checked: e.autoSuffix !== !1,
                onChange: (w) => n({ autoSuffix: w.target.checked }),
                className: "w-3 h-3 rounded border-border accent-primary cursor-pointer"
              }
            ),
            ""
          ] })
        ] }),
        /* @__PURE__ */ c.jsx(
          "input",
          {
            type: "url",
            value: e.apiUrl || "",
            onChange: (w) => n({ apiUrl: w.target.value }),
            placeholder: e.source === "ollama" ? "http://localhost:11434/api/embeddings" : "http://localhost:8000",
            style: {
              background: "transparent",
              border: "none",
              borderBottom: "1px solid var(--border)",
              borderRadius: 0,
              padding: "8px 0",
              fontSize: "14px",
              width: "100%",
              color: "var(--foreground)",
              outline: "none"
            },
            className: "placeholder:text-muted-foreground/40 focus:border-primary transition-colors"
          }
        ),
        /* @__PURE__ */ c.jsx("p", { className: "text-[10px] text-muted-foreground/70 break-all", children: e.source === "ollama" ? " /api/embeddings" : e.autoSuffix !== !1 && e.apiUrl ? ` URL: ${e.apiUrl.replace(/\/+$/, "")}/embeddings` : " base URL ( http://xxx/v1) /embeddings " })
      ] }),
      s && /* @__PURE__ */ c.jsx(
        us,
        {
          label: "API Key",
          type: "password",
          value: e.apiKey || "",
          onChange: (w) => n({ apiKey: w }),
          placeholder: " API "
        }
      ),
      /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-2", children: [
        /* @__PURE__ */ c.jsxs("div", { className: "flex items-end gap-2", children: [
          a.length > 0 ? /* @__PURE__ */ c.jsx("div", { className: "flex-1 relative", children: /* @__PURE__ */ c.jsx(
            HL,
            {
              className: "!mb-0",
              label: "",
              value: e.model || "",
              onChange: (w) => n({ model: w }),
              options: a.map((w) => ({ value: w.id, label: w.name || w.id })),
              placeholder: "",
              emptyText: ""
            }
          ) }) : /* @__PURE__ */ c.jsx(
            us,
            {
              className: "flex-1 !mb-0",
              label: "",
              value: e.model || "",
              onChange: (w) => n({ model: w }),
              placeholder: w6[e.source],
              description: ""
            }
          ),
          (i || s) && /* @__PURE__ */ c.jsx(
            "button",
            {
              type: "button",
              className: "h-[42px] w-[42px] min-w-[42px] flex items-center justify-center border-none rounded-md bg-muted text-muted-foreground cursor-pointer transition-all hover:bg-accent hover:text-foreground disabled:opacity-50 disabled:cursor-not-allowed",
              onClick: x,
              disabled: d,
              title: "",
              children: d ? /* @__PURE__ */ c.jsx(rc, { size: 16, className: "animate-spin" }) : /* @__PURE__ */ c.jsx(fr, { size: 16 })
            }
          )
        ] }),
        h && /* @__PURE__ */ c.jsx("p", { className: "text-xs text-destructive", children: h }),
        a.length > 0 && /* @__PURE__ */ c.jsxs("p", { className: "text-xs text-muted-foreground", children: [
          " ",
          a.length,
          " "
        ] })
      ] })
    ] }),
    /* @__PURE__ */ c.jsx(ls, { title: "", collapsible: !0, defaultCollapsed: !0, children: /* @__PURE__ */ c.jsx(
      us,
      {
        label: "",
        value: ((b = e.dimensions) == null ? void 0 : b.toString()) || "",
        onChange: (w) => {
          const S = parseInt(w, 10);
          n({ dimensions: isNaN(S) ? void 0 : S });
        },
        placeholder: "",
        description: ""
      }
    ) })
  ] });
}, Ple = ({
  config: e,
  onChange: t
}) => {
  const n = (h) => {
    t({ ...e, ...h });
  }, [r, i] = I.useState([]), [s, a] = I.useState(!1), [u, d] = I.useState(null), f = async () => {
    if (!e.url) {
      d(" API URL");
      return;
    }
    a(!0), d(null);
    try {
      const h = await Xl.fetchOpenAIModels({
        apiUrl: e.url,
        apiKey: e.apiKey
      });
      h.length > 0 ? i(h) : i(Xl.getCommonRerankModels());
    } catch {
      i(Xl.getCommonRerankModels());
    } finally {
      a(!1);
    }
  };
  return /* @__PURE__ */ c.jsxs("div", { className: "", children: [
    /* @__PURE__ */ c.jsx(ls, { title: "Rerank ", description: "", children: /* @__PURE__ */ c.jsx(
      Zo,
      {
        label: " Rerank",
        checked: e.enabled,
        onChange: (h) => n({ enabled: h }),
        description: " Rerank "
      }
    ) }),
    e.enabled && /* @__PURE__ */ c.jsx(c.Fragment, { children: /* @__PURE__ */ c.jsxs(ls, { title: "API ", children: [
      /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-1", children: [
        /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between", children: [
          /* @__PURE__ */ c.jsx("label", { className: "text-xs text-muted-foreground", children: "API Base URL" }),
          /* @__PURE__ */ c.jsxs("label", { className: "flex items-center gap-1.5 text-[10px] text-muted-foreground cursor-pointer select-none", children: [
            /* @__PURE__ */ c.jsx(
              "input",
              {
                type: "checkbox",
                checked: e.autoSuffix !== !1,
                onChange: (h) => n({ autoSuffix: h.target.checked }),
                className: "w-3 h-3 rounded border-border accent-primary cursor-pointer"
              }
            ),
            ""
          ] })
        ] }),
        /* @__PURE__ */ c.jsx(
          "input",
          {
            type: "url",
            value: e.url,
            onChange: (h) => n({ url: h.target.value }),
            placeholder: "http://localhost:8000",
            style: {
              background: "transparent",
              border: "none",
              borderBottom: "1px solid var(--border)",
              borderRadius: 0,
              padding: "8px 0",
              fontSize: "14px",
              width: "100%",
              color: "var(--foreground)",
              outline: "none"
            },
            className: "placeholder:text-muted-foreground/40 focus:border-primary transition-colors"
          }
        ),
        /* @__PURE__ */ c.jsx("p", { className: "text-[10px] text-muted-foreground/70 break-all", children: e.autoSuffix !== !1 && e.url ? ` URL: ${e.url.replace(/\/+$/, "")}/rerank` : " URL /rerank " })
      ] }),
      /* @__PURE__ */ c.jsx(
        us,
        {
          label: "API Key",
          type: "password",
          value: e.apiKey,
          onChange: (h) => n({ apiKey: h }),
          placeholder: " API "
        }
      ),
      /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-2", children: [
        /* @__PURE__ */ c.jsxs("div", { className: "flex items-end gap-2", children: [
          r.length > 0 ? /* @__PURE__ */ c.jsx("div", { className: "flex-1 relative", children: /* @__PURE__ */ c.jsx(
            HL,
            {
              className: "!mb-0",
              label: "",
              value: e.model,
              onChange: (h) => n({ model: h }),
              options: r.map((h) => ({ value: h.id, label: h.name || h.id })),
              placeholder: "",
              emptyText: ""
            }
          ) }) : /* @__PURE__ */ c.jsx(
            us,
            {
              className: "flex-1 !mb-0",
              label: "",
              value: e.model,
              onChange: (h) => n({ model: h }),
              placeholder: "BAAI/bge-reranker-v2-m3",
              description: " Rerank ",
              required: !0
            }
          ),
          /* @__PURE__ */ c.jsx(
            "button",
            {
              type: "button",
              className: "h-[42px] w-[42px] min-w-[42px] flex items-center justify-center border-none rounded-md bg-muted text-muted-foreground cursor-pointer transition-all hover:bg-accent hover:text-foreground disabled:opacity-50 disabled:cursor-not-allowed",
              onClick: f,
              disabled: s,
              title: "",
              children: s ? /* @__PURE__ */ c.jsx(rc, { size: 16, className: "animate-spin" }) : /* @__PURE__ */ c.jsx(fr, { size: 16 })
            }
          )
        ] }),
        u && /* @__PURE__ */ c.jsx("p", { className: "text-xs text-destructive", children: u }),
        r.length > 0 && /* @__PURE__ */ c.jsxs("p", { className: "text-xs text-muted-foreground", children: [
          " ",
          r.length,
          " "
        ] })
      ] })
    ] }) })
  ] });
}, wb = [
  { value: "summary", label: "", description: " JSON " },
  { value: "trim", label: "/", description: "" },
  { value: "preprocessing", label: "", description: "Query //" },
  { value: "entity_extraction", label: "", description: "" }
];
function Ile(e) {
  switch (e) {
    case "summary":
      return "text-blue-500 bg-blue-500/10 border border-blue-500/20";
    case "trim":
      return "text-orange-500 bg-orange-500/10 border border-orange-500/20";
    case "preprocessing":
      return "text-emerald-500 bg-emerald-500/10 border border-emerald-500/20";
    default:
      return "text-muted-foreground bg-muted border border-border";
  }
}
function Lle(e) {
  var t;
  return ((t = wb.find((n) => n.value === e)) == null ? void 0 : t.label) || e;
}
const Ble = ({
  template: e,
  isSelected: t = !1,
  onSelect: n,
  onCopy: r,
  onDelete: i,
  onToggleEnabled: s,
  onImport: a,
  onResetToDefault: u
}) => {
  const d = I.useRef(null), f = (b) => {
    b.stopPropagation();
    const w = {
      version: "1.0",
      exportedAt: Date.now(),
      template: {
        name: e.name,
        category: e.category,
        boundPresetId: e.boundPresetId,
        systemPrompt: e.systemPrompt,
        userPromptTemplate: e.userPromptTemplate
      }
    }, S = new Blob([JSON.stringify(w, null, 2)], { type: "application/json" }), C = URL.createObjectURL(S), T = document.createElement("a");
    T.href = C, T.download = `engram_template_${e.name.replace(/\s+/g, "_")}.json`, T.click(), URL.revokeObjectURL(C);
  }, h = (b) => {
    var w;
    b.stopPropagation(), (w = d.current) == null || w.click();
  }, m = (b) => {
    var C;
    const w = (C = b.target.files) == null ? void 0 : C[0];
    if (!w || !a) return;
    const S = new FileReader();
    S.onload = (T) => {
      var R;
      try {
        const N = JSON.parse((R = T.target) == null ? void 0 : R.result);
        if (N.version && N.template) {
          const M = ub(
            N.template.name,
            N.template.category,
            {
              enabled: e.enabled,
              // 
              isBuiltIn: e.isBuiltIn,
              // 
              boundPresetId: N.template.boundPresetId,
              systemPrompt: N.template.systemPrompt,
              userPromptTemplate: N.template.userPromptTemplate
            }
          );
          M.id = e.id, a(M);
        }
      } catch (N) {
        console.error(":", N);
      }
    }, S.readAsText(w), d.current && (d.current.value = "");
  }, x = e.category === "preprocessing";
  return /* @__PURE__ */ c.jsxs(
    "div",
    {
      className: `
                group relative p-3 rounded-lg border cursor-pointer transition-all duration-200
                ${t ? "bg-accent/50 border-input" : "bg-transparent border-transparent hover:bg-muted/50 hover:border-border"}
                ${!e.enabled && !x && "opacity-50"}
            `,
      onClick: n,
      children: [
        /* @__PURE__ */ c.jsxs("div", { className: "flex items-start gap-3", children: [
          x ? (
            // ""
            /* @__PURE__ */ c.jsx(
              "div",
              {
                className: "w-8 h-8 flex items-center justify-center rounded-lg bg-emerald-500/10 text-emerald-500 flex-shrink-0",
                title: " ()",
                children: /* @__PURE__ */ c.jsx(vh, { size: 16 })
              }
            )
          ) : /* @__PURE__ */ c.jsx(
            "button",
            {
              className: `
                            w-8 h-8 flex items-center justify-center rounded-lg transition-colors flex-shrink-0
                            ${e.enabled ? "bg-primary/10 text-primary" : "bg-muted text-muted-foreground hover:bg-muted/80"}
                        `,
              onClick: (b) => {
                b.stopPropagation(), s == null || s(!e.enabled);
              },
              title: e.enabled ? "" : "",
              children: /* @__PURE__ */ c.jsx(Hb, { size: 16 })
            }
          ),
          /* @__PURE__ */ c.jsxs("div", { className: "flex-1 min-w-0", children: [
            /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between gap-2", children: [
              /* @__PURE__ */ c.jsx("h4", { className: `text-sm font-medium truncate ${t ? "text-foreground" : "text-muted-foreground group-hover:text-foreground"} ${!e.enabled && !x && "line-through"}`, children: e.name }),
              /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-1.5 flex-shrink-0", children: [
                /* @__PURE__ */ c.jsx("span", { className: `text-[10px] px-1.5 py-0.5 rounded-sm font-medium ${Ile(e.category)}`, children: Lle(e.category) }),
                e.isBuiltIn && /* @__PURE__ */ c.jsx("span", { className: "text-[10px] px-1.5 py-0.5 rounded-sm bg-muted text-muted-foreground", children: "BUILTIN" })
              ] })
            ] }),
            /* @__PURE__ */ c.jsx("div", { className: "mt-1 flex items-center justify-between text-[10px] text-muted-foreground/70 font-mono", children: /* @__PURE__ */ c.jsx("span", { className: "truncate max-w-[120px]", children: e.boundPresetId ? `BOUND: ${e.boundPresetId}` : "DEFAULT PRESET" }) })
          ] })
        ] }),
        /* @__PURE__ */ c.jsxs("div", { className: `mt-2 flex justify-end gap-1 ${t || "opacity-0 group-hover:opacity-100"} transition-opacity`, children: [
          /* @__PURE__ */ c.jsx("button", { className: "p-1.5 rounded text-muted-foreground hover:text-foreground transition-colors", onClick: h, title: "Import", children: /* @__PURE__ */ c.jsx(jz, { size: 12 }) }),
          /* @__PURE__ */ c.jsx("button", { className: "p-1.5 rounded text-muted-foreground hover:text-foreground transition-colors", onClick: f, title: "Export", children: /* @__PURE__ */ c.jsx(sy, { size: 12 }) }),
          /* @__PURE__ */ c.jsx("button", { className: "p-1.5 rounded text-muted-foreground hover:text-foreground transition-colors", onClick: (b) => {
            b.stopPropagation(), r == null || r();
          }, title: "Copy", children: /* @__PURE__ */ c.jsx(H5, { size: 12 }) }),
          e.isBuiltIn && /* @__PURE__ */ c.jsx(
            "button",
            {
              className: "p-1.5 hover:bg-amber-500/10 rounded text-muted-foreground hover:text-amber-500 transition-colors",
              onClick: (b) => {
                b.stopPropagation();
                let w = uT(e.id);
                w || (w = Zb(e.category)), w && u && u({
                  ...w,
                  id: e.id,
                  enabled: e.enabled
                });
              },
              title: "",
              children: /* @__PURE__ */ c.jsx(G5, { size: 12 })
            }
          ),
          !e.isBuiltIn && /* @__PURE__ */ c.jsx("button", { className: "p-1.5 hover:bg-destructive/10 rounded text-muted-foreground hover:text-destructive transition-colors", onClick: (b) => {
            b.stopPropagation(), i == null || i();
          }, title: "Delete", children: /* @__PURE__ */ c.jsx(pa, { size: 12 }) })
        ] }),
        /* @__PURE__ */ c.jsx(
          "input",
          {
            ref: d,
            type: "file",
            accept: ".json",
            onChange: m,
            className: "hidden"
          }
        )
      ]
    }
  );
}, $le = ({
  templates: e,
  selectedId: t,
  onSelect: n,
  onAdd: r,
  onUpdate: i,
  onDelete: s,
  onResetAll: a
}) => {
  const u = () => {
    const x = ub(
      ` ${e.length + 1}`,
      "summary"
    );
    r(x), n(x);
  }, d = (x) => {
    const b = ub(
      `${x.name} ()`,
      x.category,
      {
        enabled: !1,
        // 
        boundPresetId: x.boundPresetId,
        systemPrompt: x.systemPrompt,
        userPromptTemplate: x.userPromptTemplate
      }
    );
    r(b);
  }, f = (x, b) => {
    b && e.filter((w) => w.category === x.category && w.id !== x.id && w.enabled).forEach((w) => i({ ...w, enabled: !1 })), i({ ...x, enabled: b });
  }, h = (x) => {
    i(x);
  }, m = wb.map((x) => ({
    ...x,
    templates: e.filter((b) => b.category === x.value)
  })).filter((x) => x.templates.length > 0);
  return /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-4 h-full", children: [
    /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between gap-2", children: [
      /* @__PURE__ */ c.jsx("h3", { className: "text-xs font-bold text-muted-foreground uppercase tracking-wider", children: "" }),
      /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-1", children: [
        a && /* @__PURE__ */ c.jsx(
          "button",
          {
            className: "text-muted-foreground hover:text-foreground transition-colors p-1",
            onClick: () => {
              confirm(`

`) && a();
            },
            title: "",
            children: /* @__PURE__ */ c.jsx(G5, { size: 14 })
          }
        ),
        /* @__PURE__ */ c.jsx(
          "button",
          {
            className: "text-muted-foreground hover:text-foreground transition-colors p-1",
            onClick: u,
            title: "",
            children: /* @__PURE__ */ c.jsx(Ub, { size: 16 })
          }
        )
      ] })
    ] }),
    /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-6 overflow-y-auto flex-1 no-scrollbar", children: [
      m.map((x) => /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-2", children: [
        /* @__PURE__ */ c.jsxs("div", { className: "text-[10px] items-center gap-2 text-muted-foreground font-medium px-1 uppercase tracking-wider flex", children: [
          x.label,
          /* @__PURE__ */ c.jsx("div", { className: "h-px bg-border flex-1" })
        ] }),
        /* @__PURE__ */ c.jsx("div", { className: "flex flex-col gap-1", children: x.templates.map((b) => /* @__PURE__ */ c.jsx(
          Ble,
          {
            template: b,
            isSelected: t === b.id,
            onSelect: () => n(b),
            onCopy: () => d(b),
            onDelete: () => s(b),
            onToggleEnabled: (w) => f(b, w),
            onImport: h,
            onResetToDefault: (w) => i(w)
          },
          b.id
        )) })
      ] }, x.value)),
      e.length === 0 && /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col items-center justify-center py-12 text-muted-foreground gap-2 border border-dashed border-border rounded-lg", children: [
        /* @__PURE__ */ c.jsx(ru, { size: 24, className: "opacity-50" }),
        /* @__PURE__ */ c.jsx("p", { className: "text-xs", children: "" })
      ] })
    ] })
  ] });
}, qle = [
  // Context
  { name: "{{userInput}}", desc: "", category: "Context ()" },
  { name: "{{chatHistory}}", desc: "", category: "Context ()" },
  { name: "{{context}}", desc: " (Description/Persona...)", category: "Context ()" },
  { name: "{{worldbookContext}}", desc: "", category: "Context ()" },
  { name: "{{userPersona}}", desc: " (Persona Description)", category: "Context ()" },
  { name: "{{char}}", desc: "", category: "Context ()" },
  { name: "{{user}}", desc: "", category: "Context ()" },
  // Text Generation
  { name: "{{engramSummaries}}", desc: " (, /)", category: "Text Generation ()" },
  { name: "{{engramArchivedSummaries}}", desc: " ()", category: "Text Generation ()" },
  // Data Layer
  { name: "{{engramGraph}}", desc: " JSON (/)", category: "Data Layer ()" }
], Fle = ({ macro: e }) => {
  const [t, n] = I.useState(!1), r = () => {
    navigator.clipboard.writeText(e.name), n(!0), setTimeout(() => n(!1), 2e3);
  };
  return /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between gap-2 p-1.5 rounded hover:bg-muted/50 group transition-colors", children: [
    /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-0.5", children: [
      /* @__PURE__ */ c.jsx("code", { className: "text-[11px] text-primary font-mono font-medium", children: e.name }),
      /* @__PURE__ */ c.jsx("span", { className: "text-[10px] text-muted-foreground", children: e.desc })
    ] }),
    /* @__PURE__ */ c.jsx(
      "button",
      {
        onClick: r,
        className: "opacity-0 group-hover:opacity-100 transition-opacity p-1 hover:bg-muted rounded text-muted-foreground hover:text-foreground",
        title: "",
        children: t ? /* @__PURE__ */ c.jsx(vh, { size: 12, className: "text-green-500" }) : /* @__PURE__ */ c.jsx(H5, { size: 12 })
      }
    )
  ] });
}, E6 = ({
  template: e,
  llmPresets: t,
  worldbookProfiles: n,
  defaultPresetId: r,
  onChange: i
}) => {
  var d, f;
  const s = [
    { value: "", label: "" + (r ? ` (${((d = t.find((h) => h.id === r)) == null ? void 0 : d.name) || r})` : "") },
    ...t.map((h) => ({ value: h.id, label: h.name }))
  ], a = (h) => {
    i({ ...e, ...h, updatedAt: Date.now() });
  }, u = qle.reduce((h, m) => (h[m.category] || (h[m.category] = []), h[m.category].push(m), h), {});
  return /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-4", children: [
    /* @__PURE__ */ c.jsxs(ls, { title: "", children: [
      /* @__PURE__ */ c.jsx(
        us,
        {
          label: "",
          value: e.name,
          onChange: (h) => a({ name: h }),
          placeholder: "",
          required: !0,
          disabled: e.isBuiltIn
        }
      ),
      /* @__PURE__ */ c.jsx(
        el,
        {
          label: "",
          value: e.category,
          onChange: (h) => a({ category: h }),
          options: wb.map((h) => ({ value: h.value, label: h.label })),
          description: (f = wb.find((h) => h.value === e.category)) == null ? void 0 : f.description
        }
      ),
      /* @__PURE__ */ c.jsx(
        el,
        {
          label: "",
          value: e.boundPresetId || "",
          onChange: (h) => a({ boundPresetId: h || null }),
          options: s,
          description: " LLM "
        }
      ),
      e.category === "preprocessing" && /* @__PURE__ */ c.jsx(
        el,
        {
          label: "",
          value: e.injectionMode || "replace",
          onChange: (h) => a({ injectionMode: h }),
          options: [
            { value: "replace", label: " (Overwrite)" },
            { value: "append", label: " (Append)" },
            { value: "prepend", label: " (Prepend)" }
          ],
          description: ""
        }
      )
    ] }),
    /* @__PURE__ */ c.jsx(ls, { title: "", children: /* @__PURE__ */ c.jsx(
      us,
      {
        label: "",
        value: e.systemPrompt,
        onChange: (h) => a({ systemPrompt: h }),
        placeholder: "...",
        multiline: !0,
        rows: 4
      }
    ) }),
    /* @__PURE__ */ c.jsx(ls, { title: "", children: /* @__PURE__ */ c.jsx(
      el,
      {
        label: "",
        value: e.boundWorldbookProfileId || "",
        onChange: (h) => a({ boundWorldbookProfileId: h || null }),
        options: [
          { value: "", label: " (Inherit Global)" },
          ...n.map((h) => ({ value: h.id, label: h.name }))
        ],
        description: ""
      }
    ) }),
    /* @__PURE__ */ c.jsx(ls, { title: "", children: /* @__PURE__ */ c.jsx(
      us,
      {
        label: "",
        value: e.userPromptTemplate,
        onChange: (h) => a({ userPromptTemplate: h }),
        placeholder: "...",
        multiline: !0,
        rows: 6
      }
    ) }),
    /* @__PURE__ */ c.jsxs("div", { className: "px-3 py-3 bg-muted/20 rounded-md border border-border/50 space-y-3", children: [
      /* @__PURE__ */ c.jsxs("div", { className: "text-[11px] font-semibold text-muted-foreground uppercase tracking-wider flex items-center gap-2", children: [
        /* @__PURE__ */ c.jsx("span", { children: "" }),
        /* @__PURE__ */ c.jsx("div", { className: "h-px bg-border flex-1" })
      ] }),
      /* @__PURE__ */ c.jsx("div", { className: "flex flex-col gap-4", children: Object.entries(u).map(([h, m]) => /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-1", children: [
        /* @__PURE__ */ c.jsx("div", { className: "text-[10px] text-primary/70 font-medium px-1 mb-0.5", children: h }),
        /* @__PURE__ */ c.jsx("div", { className: "grid grid-cols-1 gap-px bg-border/20 rounded overflow-hidden", children: m.map((x) => /* @__PURE__ */ c.jsx("div", { className: "bg-background/50", children: /* @__PURE__ */ c.jsx(Fle, { macro: x }) }, x.name)) })
      ] }, h)) })
    ] })
  ] });
}, VL = I.createContext({});
function ix(e) {
  const t = I.useRef(null);
  return t.current === null && (t.current = e()), t.current;
}
const FT = typeof window < "u", GL = FT ? I.useLayoutEffect : I.useEffect, UT = /* @__PURE__ */ I.createContext(null);
function HT(e, t) {
  e.indexOf(t) === -1 && e.push(t);
}
function VT(e, t) {
  const n = e.indexOf(t);
  n > -1 && e.splice(n, 1);
}
function Ule([...e], t, n) {
  const r = t < 0 ? e.length + t : t;
  if (r >= 0 && r < e.length) {
    const i = n < 0 ? e.length + n : n, [s] = e.splice(t, 1);
    e.splice(i, 0, s);
  }
  return e;
}
const Qu = (e, t, n) => n > t ? t : n < e ? e : n, Ju = {}, KL = (e) => /^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);
function YL(e) {
  return typeof e == "object" && e !== null;
}
const WL = (e) => /^0[^.\s]+$/u.test(e);
// @__NO_SIDE_EFFECTS__
function GT(e) {
  let t;
  return () => (t === void 0 && (t = e()), t);
}
const lo = /* @__NO_SIDE_EFFECTS__ */ (e) => e, Hle = (e, t) => (n) => t(e(n)), sx = (...e) => e.reduce(Hle), Ry = /* @__NO_SIDE_EFFECTS__ */ (e, t, n) => {
  const r = t - e;
  return r === 0 ? 1 : (n - e) / r;
};
class KT {
  constructor() {
    this.subscriptions = [];
  }
  add(t) {
    return HT(this.subscriptions, t), () => VT(this.subscriptions, t);
  }
  notify(t, n, r) {
    const i = this.subscriptions.length;
    if (i)
      if (i === 1)
        this.subscriptions[0](t, n, r);
      else
        for (let s = 0; s < i; s++) {
          const a = this.subscriptions[s];
          a && a(t, n, r);
        }
  }
  getSize() {
    return this.subscriptions.length;
  }
  clear() {
    this.subscriptions.length = 0;
  }
}
const eu = /* @__NO_SIDE_EFFECTS__ */ (e) => e * 1e3, oo = /* @__NO_SIDE_EFFECTS__ */ (e) => e / 1e3;
function ZL(e, t) {
  return t ? e * (1e3 / t) : 0;
}
const XL = (e, t, n) => (((1 - 3 * n + 3 * t) * e + (3 * n - 6 * t)) * e + 3 * t) * e, Vle = 1e-7, Gle = 12;
function Kle(e, t, n, r, i) {
  let s, a, u = 0;
  do
    a = t + (n - t) / 2, s = XL(a, r, i) - e, s > 0 ? n = a : t = a;
  while (Math.abs(s) > Vle && ++u < Gle);
  return a;
}
function ax(e, t, n, r) {
  if (e === t && n === r)
    return lo;
  const i = (s) => Kle(s, 0, 1, e, n);
  return (s) => s === 0 || s === 1 ? s : XL(i(s), t, r);
}
const QL = (e) => (t) => t <= 0.5 ? e(2 * t) / 2 : (2 - e(2 * (1 - t))) / 2, JL = (e) => (t) => 1 - e(1 - t), eB = /* @__PURE__ */ ax(0.33, 1.53, 0.69, 0.99), YT = /* @__PURE__ */ JL(eB), tB = /* @__PURE__ */ QL(YT), nB = (e) => (e *= 2) < 1 ? 0.5 * YT(e) : 0.5 * (2 - Math.pow(2, -10 * (e - 1))), WT = (e) => 1 - Math.sin(Math.acos(e)), rB = JL(WT), iB = QL(WT), Yle = /* @__PURE__ */ ax(0.42, 0, 1, 1), Wle = /* @__PURE__ */ ax(0, 0, 0.58, 1), sB = /* @__PURE__ */ ax(0.42, 0, 0.58, 1), Zle = (e) => Array.isArray(e) && typeof e[0] != "number", aB = (e) => Array.isArray(e) && typeof e[0] == "number", Xle = {
  linear: lo,
  easeIn: Yle,
  easeInOut: sB,
  easeOut: Wle,
  circIn: WT,
  circInOut: iB,
  circOut: rB,
  backIn: YT,
  backInOut: tB,
  backOut: eB,
  anticipate: nB
}, Qle = (e) => typeof e == "string", C6 = (e) => {
  if (aB(e)) {
    const [t, n, r, i] = e;
    return ax(t, n, r, i);
  } else if (Qle(e))
    return Xle[e];
  return e;
}, v1 = [
  "setup",
  // Compute
  "read",
  // Read
  "resolveKeyframes",
  // Write/Read/Write/Read
  "preUpdate",
  // Compute
  "update",
  // Compute
  "preRender",
  // Compute
  "render",
  // Write
  "postRender"
  // Compute
];
function Jle(e, t) {
  let n = /* @__PURE__ */ new Set(), r = /* @__PURE__ */ new Set(), i = !1, s = !1;
  const a = /* @__PURE__ */ new WeakSet();
  let u = {
    delta: 0,
    timestamp: 0,
    isProcessing: !1
  };
  function d(h) {
    a.has(h) && (f.schedule(h), e()), h(u);
  }
  const f = {
    /**
     * Schedule a process to run on the next frame.
     */
    schedule: (h, m = !1, x = !1) => {
      const w = x && i ? n : r;
      return m && a.add(h), w.has(h) || w.add(h), h;
    },
    /**
     * Cancel the provided callback from running on the next frame.
     */
    cancel: (h) => {
      r.delete(h), a.delete(h);
    },
    /**
     * Execute all schedule callbacks.
     */
    process: (h) => {
      if (u = h, i) {
        s = !0;
        return;
      }
      i = !0, [n, r] = [r, n], n.forEach(d), n.clear(), i = !1, s && (s = !1, f.process(h));
    }
  };
  return f;
}
const eue = 40;
function oB(e, t) {
  let n = !1, r = !0;
  const i = {
    delta: 0,
    timestamp: 0,
    isProcessing: !1
  }, s = () => n = !0, a = v1.reduce((N, M) => (N[M] = Jle(s), N), {}), { setup: u, read: d, resolveKeyframes: f, preUpdate: h, update: m, preRender: x, render: b, postRender: w } = a, S = () => {
    const N = Ju.useManualTiming ? i.timestamp : performance.now();
    n = !1, Ju.useManualTiming || (i.delta = r ? 1e3 / 60 : Math.max(Math.min(N - i.timestamp, eue), 1)), i.timestamp = N, i.isProcessing = !0, u.process(i), d.process(i), f.process(i), h.process(i), m.process(i), x.process(i), b.process(i), w.process(i), i.isProcessing = !1, n && t && (r = !1, e(S));
  }, C = () => {
    n = !0, r = !0, i.isProcessing || e(S);
  };
  return { schedule: v1.reduce((N, M) => {
    const P = a[M];
    return N[M] = (D, q = !1, Y = !1) => (n || C(), P.schedule(D, q, Y)), N;
  }, {}), cancel: (N) => {
    for (let M = 0; M < v1.length; M++)
      a[v1[M]].cancel(N);
  }, state: i, steps: a };
}
const { schedule: dr, cancel: ec, state: $i, steps: x_ } = /* @__PURE__ */ oB(typeof requestAnimationFrame < "u" ? requestAnimationFrame : lo, !0);
let U1;
function tue() {
  U1 = void 0;
}
const da = {
  now: () => (U1 === void 0 && da.set($i.isProcessing || Ju.useManualTiming ? $i.timestamp : performance.now()), U1),
  set: (e) => {
    U1 = e, queueMicrotask(tue);
  }
}, lB = (e) => (t) => typeof t == "string" && t.startsWith(e), uB = /* @__PURE__ */ lB("--"), nue = /* @__PURE__ */ lB("var(--"), ZT = (e) => nue(e) ? rue.test(e.split("/*")[0].trim()) : !1, rue = /var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu, Zm = {
  test: (e) => typeof e == "number",
  parse: parseFloat,
  transform: (e) => e
}, My = {
  ...Zm,
  transform: (e) => Qu(0, 1, e)
}, b1 = {
  ...Zm,
  default: 1
}, hy = (e) => Math.round(e * 1e5) / 1e5, XT = /-?(?:\d+(?:\.\d+)?|\.\d+)/gu;
function iue(e) {
  return e == null;
}
const sue = /^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu, QT = (e, t) => (n) => !!(typeof n == "string" && sue.test(n) && n.startsWith(e) || t && !iue(n) && Object.prototype.hasOwnProperty.call(n, t)), cB = (e, t, n) => (r) => {
  if (typeof r != "string")
    return r;
  const [i, s, a, u] = r.match(XT);
  return {
    [e]: parseFloat(i),
    [t]: parseFloat(s),
    [n]: parseFloat(a),
    alpha: u !== void 0 ? parseFloat(u) : 1
  };
}, aue = (e) => Qu(0, 255, e), v_ = {
  ...Zm,
  transform: (e) => Math.round(aue(e))
}, lh = {
  test: /* @__PURE__ */ QT("rgb", "red"),
  parse: /* @__PURE__ */ cB("red", "green", "blue"),
  transform: ({ red: e, green: t, blue: n, alpha: r = 1 }) => "rgba(" + v_.transform(e) + ", " + v_.transform(t) + ", " + v_.transform(n) + ", " + hy(My.transform(r)) + ")"
};
function oue(e) {
  let t = "", n = "", r = "", i = "";
  return e.length > 5 ? (t = e.substring(1, 3), n = e.substring(3, 5), r = e.substring(5, 7), i = e.substring(7, 9)) : (t = e.substring(1, 2), n = e.substring(2, 3), r = e.substring(3, 4), i = e.substring(4, 5), t += t, n += n, r += r, i += i), {
    red: parseInt(t, 16),
    green: parseInt(n, 16),
    blue: parseInt(r, 16),
    alpha: i ? parseInt(i, 16) / 255 : 1
  };
}
const s5 = {
  test: /* @__PURE__ */ QT("#"),
  parse: oue,
  transform: lh.transform
}, ox = /* @__NO_SIDE_EFFECTS__ */ (e) => ({
  test: (t) => typeof t == "string" && t.endsWith(e) && t.split(" ").length === 1,
  parse: parseFloat,
  transform: (t) => `${t}${e}`
}), hd = /* @__PURE__ */ ox("deg"), tu = /* @__PURE__ */ ox("%"), Bt = /* @__PURE__ */ ox("px"), lue = /* @__PURE__ */ ox("vh"), uue = /* @__PURE__ */ ox("vw"), k6 = {
  ...tu,
  parse: (e) => tu.parse(e) / 100,
  transform: (e) => tu.transform(e * 100)
}, cm = {
  test: /* @__PURE__ */ QT("hsl", "hue"),
  parse: /* @__PURE__ */ cB("hue", "saturation", "lightness"),
  transform: ({ hue: e, saturation: t, lightness: n, alpha: r = 1 }) => "hsla(" + Math.round(e) + ", " + tu.transform(hy(t)) + ", " + tu.transform(hy(n)) + ", " + hy(My.transform(r)) + ")"
}, ei = {
  test: (e) => lh.test(e) || s5.test(e) || cm.test(e),
  parse: (e) => lh.test(e) ? lh.parse(e) : cm.test(e) ? cm.parse(e) : s5.parse(e),
  transform: (e) => typeof e == "string" ? e : e.hasOwnProperty("red") ? lh.transform(e) : cm.transform(e),
  getAnimatableNone: (e) => {
    const t = ei.parse(e);
    return t.alpha = 0, ei.transform(t);
  }
}, cue = /(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;
function due(e) {
  var t, n;
  return isNaN(e) && typeof e == "string" && (((t = e.match(XT)) == null ? void 0 : t.length) || 0) + (((n = e.match(cue)) == null ? void 0 : n.length) || 0) > 0;
}
const dB = "number", fB = "color", fue = "var", hue = "var(", T6 = "${}", pue = /var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;
function Oy(e) {
  const t = e.toString(), n = [], r = {
    color: [],
    number: [],
    var: []
  }, i = [];
  let s = 0;
  const u = t.replace(pue, (d) => (ei.test(d) ? (r.color.push(s), i.push(fB), n.push(ei.parse(d))) : d.startsWith(hue) ? (r.var.push(s), i.push(fue), n.push(d)) : (r.number.push(s), i.push(dB), n.push(parseFloat(d))), ++s, T6)).split(T6);
  return { values: n, split: u, indexes: r, types: i };
}
function hB(e) {
  return Oy(e).values;
}
function pB(e) {
  const { split: t, types: n } = Oy(e), r = t.length;
  return (i) => {
    let s = "";
    for (let a = 0; a < r; a++)
      if (s += t[a], i[a] !== void 0) {
        const u = n[a];
        u === dB ? s += hy(i[a]) : u === fB ? s += ei.transform(i[a]) : s += i[a];
      }
    return s;
  };
}
const mue = (e) => typeof e == "number" ? 0 : ei.test(e) ? ei.getAnimatableNone(e) : e;
function gue(e) {
  const t = hB(e);
  return pB(e)(t.map(mue));
}
const Td = {
  test: due,
  parse: hB,
  createTransformer: pB,
  getAnimatableNone: gue
};
function b_(e, t, n) {
  return n < 0 && (n += 1), n > 1 && (n -= 1), n < 1 / 6 ? e + (t - e) * 6 * n : n < 1 / 2 ? t : n < 2 / 3 ? e + (t - e) * (2 / 3 - n) * 6 : e;
}
function yue({ hue: e, saturation: t, lightness: n, alpha: r }) {
  e /= 360, t /= 100, n /= 100;
  let i = 0, s = 0, a = 0;
  if (!t)
    i = s = a = n;
  else {
    const u = n < 0.5 ? n * (1 + t) : n + t - n * t, d = 2 * n - u;
    i = b_(d, u, e + 1 / 3), s = b_(d, u, e), a = b_(d, u, e - 1 / 3);
  }
  return {
    red: Math.round(i * 255),
    green: Math.round(s * 255),
    blue: Math.round(a * 255),
    alpha: r
  };
}
function _b(e, t) {
  return (n) => n > 0 ? t : e;
}
const yr = (e, t, n) => e + (t - e) * n, w_ = (e, t, n) => {
  const r = e * e, i = n * (t * t - r) + r;
  return i < 0 ? 0 : Math.sqrt(i);
}, xue = [s5, lh, cm], vue = (e) => xue.find((t) => t.test(e));
function j6(e) {
  const t = vue(e);
  if (!t)
    return !1;
  let n = t.parse(e);
  return t === cm && (n = yue(n)), n;
}
const A6 = (e, t) => {
  const n = j6(e), r = j6(t);
  if (!n || !r)
    return _b(e, t);
  const i = { ...n };
  return (s) => (i.red = w_(n.red, r.red, s), i.green = w_(n.green, r.green, s), i.blue = w_(n.blue, r.blue, s), i.alpha = yr(n.alpha, r.alpha, s), lh.transform(i));
}, a5 = /* @__PURE__ */ new Set(["none", "hidden"]);
function bue(e, t) {
  return a5.has(e) ? (n) => n <= 0 ? e : t : (n) => n >= 1 ? t : e;
}
function wue(e, t) {
  return (n) => yr(e, t, n);
}
function JT(e) {
  return typeof e == "number" ? wue : typeof e == "string" ? ZT(e) ? _b : ei.test(e) ? A6 : Eue : Array.isArray(e) ? mB : typeof e == "object" ? ei.test(e) ? A6 : _ue : _b;
}
function mB(e, t) {
  const n = [...e], r = n.length, i = e.map((s, a) => JT(s)(s, t[a]));
  return (s) => {
    for (let a = 0; a < r; a++)
      n[a] = i[a](s);
    return n;
  };
}
function _ue(e, t) {
  const n = { ...e, ...t }, r = {};
  for (const i in n)
    e[i] !== void 0 && t[i] !== void 0 && (r[i] = JT(e[i])(e[i], t[i]));
  return (i) => {
    for (const s in r)
      n[s] = r[s](i);
    return n;
  };
}
function Sue(e, t) {
  const n = [], r = { color: 0, var: 0, number: 0 };
  for (let i = 0; i < t.values.length; i++) {
    const s = t.types[i], a = e.indexes[s][r[s]], u = e.values[a] ?? 0;
    n[i] = u, r[s]++;
  }
  return n;
}
const Eue = (e, t) => {
  const n = Td.createTransformer(t), r = Oy(e), i = Oy(t);
  return r.indexes.var.length === i.indexes.var.length && r.indexes.color.length === i.indexes.color.length && r.indexes.number.length >= i.indexes.number.length ? a5.has(e) && !i.values.length || a5.has(t) && !r.values.length ? bue(e, t) : sx(mB(Sue(r, i), i.values), n) : _b(e, t);
};
function gB(e, t, n) {
  return typeof e == "number" && typeof t == "number" && typeof n == "number" ? yr(e, t, n) : JT(e)(e, t);
}
const Cue = (e) => {
  const t = ({ timestamp: n }) => e(n);
  return {
    start: (n = !0) => dr.update(t, n),
    stop: () => ec(t),
    /**
     * If we're processing this frame we can use the
     * framelocked timestamp to keep things in sync.
     */
    now: () => $i.isProcessing ? $i.timestamp : da.now()
  };
}, yB = (e, t, n = 10) => {
  let r = "";
  const i = Math.max(Math.round(t / n), 2);
  for (let s = 0; s < i; s++)
    r += Math.round(e(s / (i - 1)) * 1e4) / 1e4 + ", ";
  return `linear(${r.substring(0, r.length - 2)})`;
}, Sb = 2e4;
function ej(e) {
  let t = 0;
  const n = 50;
  let r = e.next(t);
  for (; !r.done && t < Sb; )
    t += n, r = e.next(t);
  return t >= Sb ? 1 / 0 : t;
}
function kue(e, t = 100, n) {
  const r = n({ ...e, keyframes: [0, t] }), i = Math.min(ej(r), Sb);
  return {
    type: "keyframes",
    ease: (s) => r.next(i * s).value / t,
    duration: /* @__PURE__ */ oo(i)
  };
}
const Tue = 5;
function xB(e, t, n) {
  const r = Math.max(t - Tue, 0);
  return ZL(n - e(r), t - r);
}
const Lr = {
  // Default spring physics
  stiffness: 100,
  damping: 10,
  mass: 1,
  velocity: 0,
  // Default duration/bounce-based options
  duration: 800,
  // in ms
  bounce: 0.3,
  visualDuration: 0.3,
  // in seconds
  // Rest thresholds
  restSpeed: {
    granular: 0.01,
    default: 2
  },
  restDelta: {
    granular: 5e-3,
    default: 0.5
  },
  // Limits
  minDuration: 0.01,
  // in seconds
  maxDuration: 10,
  // in seconds
  minDamping: 0.05,
  maxDamping: 1
}, __ = 1e-3;
function jue({ duration: e = Lr.duration, bounce: t = Lr.bounce, velocity: n = Lr.velocity, mass: r = Lr.mass }) {
  let i, s, a = 1 - t;
  a = Qu(Lr.minDamping, Lr.maxDamping, a), e = Qu(Lr.minDuration, Lr.maxDuration, /* @__PURE__ */ oo(e)), a < 1 ? (i = (f) => {
    const h = f * a, m = h * e, x = h - n, b = o5(f, a), w = Math.exp(-m);
    return __ - x / b * w;
  }, s = (f) => {
    const m = f * a * e, x = m * n + n, b = Math.pow(a, 2) * Math.pow(f, 2) * e, w = Math.exp(-m), S = o5(Math.pow(f, 2), a);
    return (-i(f) + __ > 0 ? -1 : 1) * ((x - b) * w) / S;
  }) : (i = (f) => {
    const h = Math.exp(-f * e), m = (f - n) * e + 1;
    return -__ + h * m;
  }, s = (f) => {
    const h = Math.exp(-f * e), m = (n - f) * (e * e);
    return h * m;
  });
  const u = 5 / e, d = Nue(i, s, u);
  if (e = /* @__PURE__ */ eu(e), isNaN(d))
    return {
      stiffness: Lr.stiffness,
      damping: Lr.damping,
      duration: e
    };
  {
    const f = Math.pow(d, 2) * r;
    return {
      stiffness: f,
      damping: a * 2 * Math.sqrt(r * f),
      duration: e
    };
  }
}
const Aue = 12;
function Nue(e, t, n) {
  let r = n;
  for (let i = 1; i < Aue; i++)
    r = r - e(r) / t(r);
  return r;
}
function o5(e, t) {
  return e * Math.sqrt(1 - t * t);
}
const Rue = ["duration", "bounce"], Mue = ["stiffness", "damping", "mass"];
function N6(e, t) {
  return t.some((n) => e[n] !== void 0);
}
function Oue(e) {
  let t = {
    velocity: Lr.velocity,
    stiffness: Lr.stiffness,
    damping: Lr.damping,
    mass: Lr.mass,
    isResolvedFromDuration: !1,
    ...e
  };
  if (!N6(e, Mue) && N6(e, Rue))
    if (e.visualDuration) {
      const n = e.visualDuration, r = 2 * Math.PI / (n * 1.2), i = r * r, s = 2 * Qu(0.05, 1, 1 - (e.bounce || 0)) * Math.sqrt(i);
      t = {
        ...t,
        mass: Lr.mass,
        stiffness: i,
        damping: s
      };
    } else {
      const n = jue(e);
      t = {
        ...t,
        ...n,
        mass: Lr.mass
      }, t.isResolvedFromDuration = !0;
    }
  return t;
}
function Eb(e = Lr.visualDuration, t = Lr.bounce) {
  const n = typeof e != "object" ? {
    visualDuration: e,
    keyframes: [0, 1],
    bounce: t
  } : e;
  let { restSpeed: r, restDelta: i } = n;
  const s = n.keyframes[0], a = n.keyframes[n.keyframes.length - 1], u = { done: !1, value: s }, { stiffness: d, damping: f, mass: h, duration: m, velocity: x, isResolvedFromDuration: b } = Oue({
    ...n,
    velocity: -/* @__PURE__ */ oo(n.velocity || 0)
  }), w = x || 0, S = f / (2 * Math.sqrt(d * h)), C = a - s, T = /* @__PURE__ */ oo(Math.sqrt(d / h)), R = Math.abs(C) < 5;
  r || (r = R ? Lr.restSpeed.granular : Lr.restSpeed.default), i || (i = R ? Lr.restDelta.granular : Lr.restDelta.default);
  let N;
  if (S < 1) {
    const P = o5(T, S);
    N = (D) => {
      const q = Math.exp(-S * T * D);
      return a - q * ((w + S * T * C) / P * Math.sin(P * D) + C * Math.cos(P * D));
    };
  } else if (S === 1)
    N = (P) => a - Math.exp(-T * P) * (C + (w + T * C) * P);
  else {
    const P = T * Math.sqrt(S * S - 1);
    N = (D) => {
      const q = Math.exp(-S * T * D), Y = Math.min(P * D, 300);
      return a - q * ((w + S * T * C) * Math.sinh(Y) + P * C * Math.cosh(Y)) / P;
    };
  }
  const M = {
    calculatedDuration: b && m || null,
    next: (P) => {
      const D = N(P);
      if (b)
        u.done = P >= m;
      else {
        let q = P === 0 ? w : 0;
        S < 1 && (q = P === 0 ? /* @__PURE__ */ eu(w) : xB(N, P, D));
        const Y = Math.abs(q) <= r, te = Math.abs(a - D) <= i;
        u.done = Y && te;
      }
      return u.value = u.done ? a : D, u;
    },
    toString: () => {
      const P = Math.min(ej(M), Sb), D = yB((q) => M.next(P * q).value, P, 30);
      return P + "ms " + D;
    },
    toTransition: () => {
    }
  };
  return M;
}
Eb.applyToOptions = (e) => {
  const t = kue(e, 100, Eb);
  return e.ease = t.ease, e.duration = /* @__PURE__ */ eu(t.duration), e.type = "keyframes", e;
};
function l5({ keyframes: e, velocity: t = 0, power: n = 0.8, timeConstant: r = 325, bounceDamping: i = 10, bounceStiffness: s = 500, modifyTarget: a, min: u, max: d, restDelta: f = 0.5, restSpeed: h }) {
  const m = e[0], x = {
    done: !1,
    value: m
  }, b = (Y) => u !== void 0 && Y < u || d !== void 0 && Y > d, w = (Y) => u === void 0 ? d : d === void 0 || Math.abs(u - Y) < Math.abs(d - Y) ? u : d;
  let S = n * t;
  const C = m + S, T = a === void 0 ? C : a(C);
  T !== C && (S = T - m);
  const R = (Y) => -S * Math.exp(-Y / r), N = (Y) => T + R(Y), M = (Y) => {
    const te = R(Y), V = N(Y);
    x.done = Math.abs(te) <= f, x.value = x.done ? T : V;
  };
  let P, D;
  const q = (Y) => {
    b(x.value) && (P = Y, D = Eb({
      keyframes: [x.value, w(x.value)],
      velocity: xB(N, Y, x.value),
      // TODO: This should be passing * 1000
      damping: i,
      stiffness: s,
      restDelta: f,
      restSpeed: h
    }));
  };
  return q(0), {
    calculatedDuration: null,
    next: (Y) => {
      let te = !1;
      return !D && P === void 0 && (te = !0, M(Y), q(Y)), P !== void 0 && Y >= P ? D.next(Y - P) : (!te && M(Y), x);
    }
  };
}
function Due(e, t, n) {
  const r = [], i = n || Ju.mix || gB, s = e.length - 1;
  for (let a = 0; a < s; a++) {
    let u = i(e[a], e[a + 1]);
    if (t) {
      const d = Array.isArray(t) ? t[a] || lo : t;
      u = sx(d, u);
    }
    r.push(u);
  }
  return r;
}
function vB(e, t, { clamp: n = !0, ease: r, mixer: i } = {}) {
  const s = e.length;
  if (s === 1)
    return () => t[0];
  if (s === 2 && t[0] === t[1])
    return () => t[1];
  const a = e[0] === e[1];
  e[0] > e[s - 1] && (e = [...e].reverse(), t = [...t].reverse());
  const u = Due(t, r, i), d = u.length, f = (h) => {
    if (a && h < e[0])
      return t[0];
    let m = 0;
    if (d > 1)
      for (; m < e.length - 2 && !(h < e[m + 1]); m++)
        ;
    const x = /* @__PURE__ */ Ry(e[m], e[m + 1], h);
    return u[m](x);
  };
  return n ? (h) => f(Qu(e[0], e[s - 1], h)) : f;
}
function zue(e, t) {
  const n = e[e.length - 1];
  for (let r = 1; r <= t; r++) {
    const i = /* @__PURE__ */ Ry(0, t, r);
    e.push(yr(n, 1, i));
  }
}
function Pue(e) {
  const t = [0];
  return zue(t, e.length - 1), t;
}
function Iue(e, t) {
  return e.map((n) => n * t);
}
function Lue(e, t) {
  return e.map(() => t || sB).splice(0, e.length - 1);
}
function py({ duration: e = 300, keyframes: t, times: n, ease: r = "easeInOut" }) {
  const i = Zle(r) ? r.map(C6) : C6(r), s = {
    done: !1,
    value: t[0]
  }, a = Iue(
    // Only use the provided offsets if they're the correct length
    // TODO Maybe we should warn here if there's a length mismatch
    n && n.length === t.length ? n : Pue(t),
    e
  ), u = vB(a, t, {
    ease: Array.isArray(i) ? i : Lue(t, i)
  });
  return {
    calculatedDuration: e,
    next: (d) => (s.value = u(d), s.done = d >= e, s)
  };
}
const Bue = (e) => e !== null;
function tj(e, { repeat: t, repeatType: n = "loop" }, r, i = 1) {
  const s = e.filter(Bue), u = i < 0 || t && n !== "loop" && t % 2 === 1 ? 0 : s.length - 1;
  return !u || r === void 0 ? s[u] : r;
}
const $ue = {
  decay: l5,
  inertia: l5,
  tween: py,
  keyframes: py,
  spring: Eb
};
function bB(e) {
  typeof e.type == "string" && (e.type = $ue[e.type]);
}
class nj {
  constructor() {
    this.updateFinished();
  }
  get finished() {
    return this._finished;
  }
  updateFinished() {
    this._finished = new Promise((t) => {
      this.resolve = t;
    });
  }
  notifyFinished() {
    this.resolve();
  }
  /**
   * Allows the animation to be awaited.
   *
   * @deprecated Use `finished` instead.
   */
  then(t, n) {
    return this.finished.then(t, n);
  }
}
const que = (e) => e / 100;
class rj extends nj {
  constructor(t) {
    super(), this.state = "idle", this.startTime = null, this.isStopped = !1, this.currentTime = 0, this.holdTime = null, this.playbackSpeed = 1, this.stop = () => {
      var r, i;
      const { motionValue: n } = this.options;
      n && n.updatedAt !== da.now() && this.tick(da.now()), this.isStopped = !0, this.state !== "idle" && (this.teardown(), (i = (r = this.options).onStop) == null || i.call(r));
    }, this.options = t, this.initAnimation(), this.play(), t.autoplay === !1 && this.pause();
  }
  initAnimation() {
    const { options: t } = this;
    bB(t);
    const { type: n = py, repeat: r = 0, repeatDelay: i = 0, repeatType: s, velocity: a = 0 } = t;
    let { keyframes: u } = t;
    const d = n || py;
    d !== py && typeof u[0] != "number" && (this.mixKeyframes = sx(que, gB(u[0], u[1])), u = [0, 100]);
    const f = d({ ...t, keyframes: u });
    s === "mirror" && (this.mirroredGenerator = d({
      ...t,
      keyframes: [...u].reverse(),
      velocity: -a
    })), f.calculatedDuration === null && (f.calculatedDuration = ej(f));
    const { calculatedDuration: h } = f;
    this.calculatedDuration = h, this.resolvedDuration = h + i, this.totalDuration = this.resolvedDuration * (r + 1) - i, this.generator = f;
  }
  updateTime(t) {
    const n = Math.round(t - this.startTime) * this.playbackSpeed;
    this.holdTime !== null ? this.currentTime = this.holdTime : this.currentTime = n;
  }
  tick(t, n = !1) {
    const { generator: r, totalDuration: i, mixKeyframes: s, mirroredGenerator: a, resolvedDuration: u, calculatedDuration: d } = this;
    if (this.startTime === null)
      return r.next(0);
    const { delay: f = 0, keyframes: h, repeat: m, repeatType: x, repeatDelay: b, type: w, onUpdate: S, finalKeyframe: C } = this.options;
    this.speed > 0 ? this.startTime = Math.min(this.startTime, t) : this.speed < 0 && (this.startTime = Math.min(t - i / this.speed, this.startTime)), n ? this.currentTime = t : this.updateTime(t);
    const T = this.currentTime - f * (this.playbackSpeed >= 0 ? 1 : -1), R = this.playbackSpeed >= 0 ? T < 0 : T > i;
    this.currentTime = Math.max(T, 0), this.state === "finished" && this.holdTime === null && (this.currentTime = i);
    let N = this.currentTime, M = r;
    if (m) {
      const Y = Math.min(this.currentTime, i) / u;
      let te = Math.floor(Y), V = Y % 1;
      !V && Y >= 1 && (V = 1), V === 1 && te--, te = Math.min(te, m + 1), !!(te % 2) && (x === "reverse" ? (V = 1 - V, b && (V -= b / u)) : x === "mirror" && (M = a)), N = Qu(0, 1, V) * u;
    }
    const P = R ? { done: !1, value: h[0] } : M.next(N);
    s && (P.value = s(P.value));
    let { done: D } = P;
    !R && d !== null && (D = this.playbackSpeed >= 0 ? this.currentTime >= i : this.currentTime <= 0);
    const q = this.holdTime === null && (this.state === "finished" || this.state === "running" && D);
    return q && w !== l5 && (P.value = tj(h, this.options, C, this.speed)), S && S(P.value), q && this.finish(), P;
  }
  /**
   * Allows the returned animation to be awaited or promise-chained. Currently
   * resolves when the animation finishes at all but in a future update could/should
   * reject if its cancels.
   */
  then(t, n) {
    return this.finished.then(t, n);
  }
  get duration() {
    return /* @__PURE__ */ oo(this.calculatedDuration);
  }
  get iterationDuration() {
    const { delay: t = 0 } = this.options || {};
    return this.duration + /* @__PURE__ */ oo(t);
  }
  get time() {
    return /* @__PURE__ */ oo(this.currentTime);
  }
  set time(t) {
    var n;
    t = /* @__PURE__ */ eu(t), this.currentTime = t, this.startTime === null || this.holdTime !== null || this.playbackSpeed === 0 ? this.holdTime = t : this.driver && (this.startTime = this.driver.now() - t / this.playbackSpeed), (n = this.driver) == null || n.start(!1);
  }
  get speed() {
    return this.playbackSpeed;
  }
  set speed(t) {
    this.updateTime(da.now());
    const n = this.playbackSpeed !== t;
    this.playbackSpeed = t, n && (this.time = /* @__PURE__ */ oo(this.currentTime));
  }
  play() {
    var i, s;
    if (this.isStopped)
      return;
    const { driver: t = Cue, startTime: n } = this.options;
    this.driver || (this.driver = t((a) => this.tick(a))), (s = (i = this.options).onPlay) == null || s.call(i);
    const r = this.driver.now();
    this.state === "finished" ? (this.updateFinished(), this.startTime = r) : this.holdTime !== null ? this.startTime = r - this.holdTime : this.startTime || (this.startTime = n ?? r), this.state === "finished" && this.speed < 0 && (this.startTime += this.calculatedDuration), this.holdTime = null, this.state = "running", this.driver.start();
  }
  pause() {
    this.state = "paused", this.updateTime(da.now()), this.holdTime = this.currentTime;
  }
  complete() {
    this.state !== "running" && this.play(), this.state = "finished", this.holdTime = null;
  }
  finish() {
    var t, n;
    this.notifyFinished(), this.teardown(), this.state = "finished", (n = (t = this.options).onComplete) == null || n.call(t);
  }
  cancel() {
    var t, n;
    this.holdTime = null, this.startTime = 0, this.tick(0), this.teardown(), (n = (t = this.options).onCancel) == null || n.call(t);
  }
  teardown() {
    this.state = "idle", this.stopDriver(), this.startTime = this.holdTime = null;
  }
  stopDriver() {
    this.driver && (this.driver.stop(), this.driver = void 0);
  }
  sample(t) {
    return this.startTime = 0, this.tick(t, !0);
  }
  attachTimeline(t) {
    var n;
    return this.options.allowFlatten && (this.options.type = "keyframes", this.options.ease = "linear", this.initAnimation()), (n = this.driver) == null || n.stop(), t.observe(this);
  }
}
function Fue(e) {
  for (let t = 1; t < e.length; t++)
    e[t] ?? (e[t] = e[t - 1]);
}
const uh = (e) => e * 180 / Math.PI, u5 = (e) => {
  const t = uh(Math.atan2(e[1], e[0]));
  return c5(t);
}, Uue = {
  x: 4,
  y: 5,
  translateX: 4,
  translateY: 5,
  scaleX: 0,
  scaleY: 3,
  scale: (e) => (Math.abs(e[0]) + Math.abs(e[3])) / 2,
  rotate: u5,
  rotateZ: u5,
  skewX: (e) => uh(Math.atan(e[1])),
  skewY: (e) => uh(Math.atan(e[2])),
  skew: (e) => (Math.abs(e[1]) + Math.abs(e[2])) / 2
}, c5 = (e) => (e = e % 360, e < 0 && (e += 360), e), R6 = u5, M6 = (e) => Math.sqrt(e[0] * e[0] + e[1] * e[1]), O6 = (e) => Math.sqrt(e[4] * e[4] + e[5] * e[5]), Hue = {
  x: 12,
  y: 13,
  z: 14,
  translateX: 12,
  translateY: 13,
  translateZ: 14,
  scaleX: M6,
  scaleY: O6,
  scale: (e) => (M6(e) + O6(e)) / 2,
  rotateX: (e) => c5(uh(Math.atan2(e[6], e[5]))),
  rotateY: (e) => c5(uh(Math.atan2(-e[2], e[0]))),
  rotateZ: R6,
  rotate: R6,
  skewX: (e) => uh(Math.atan(e[4])),
  skewY: (e) => uh(Math.atan(e[1])),
  skew: (e) => (Math.abs(e[1]) + Math.abs(e[4])) / 2
};
function d5(e) {
  return e.includes("scale") ? 1 : 0;
}
function f5(e, t) {
  if (!e || e === "none")
    return d5(t);
  const n = e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);
  let r, i;
  if (n)
    r = Hue, i = n;
  else {
    const u = e.match(/^matrix\(([-\d.e\s,]+)\)$/u);
    r = Uue, i = u;
  }
  if (!i)
    return d5(t);
  const s = r[t], a = i[1].split(",").map(Gue);
  return typeof s == "function" ? s(a) : a[s];
}
const Vue = (e, t) => {
  const { transform: n = "none" } = getComputedStyle(e);
  return f5(n, t);
};
function Gue(e) {
  return parseFloat(e.trim());
}
const Xm = [
  "transformPerspective",
  "x",
  "y",
  "z",
  "translateX",
  "translateY",
  "translateZ",
  "scale",
  "scaleX",
  "scaleY",
  "rotate",
  "rotateX",
  "rotateY",
  "rotateZ",
  "skew",
  "skewX",
  "skewY"
], Qm = new Set(Xm), D6 = (e) => e === Zm || e === Bt, Kue = /* @__PURE__ */ new Set(["x", "y", "z"]), Yue = Xm.filter((e) => !Kue.has(e));
function Wue(e) {
  const t = [];
  return Yue.forEach((n) => {
    const r = e.getValue(n);
    r !== void 0 && (t.push([n, r.get()]), r.set(n.startsWith("scale") ? 1 : 0));
  }), t;
}
const ph = {
  // Dimensions
  width: ({ x: e }, { paddingLeft: t = "0", paddingRight: n = "0" }) => e.max - e.min - parseFloat(t) - parseFloat(n),
  height: ({ y: e }, { paddingTop: t = "0", paddingBottom: n = "0" }) => e.max - e.min - parseFloat(t) - parseFloat(n),
  top: (e, { top: t }) => parseFloat(t),
  left: (e, { left: t }) => parseFloat(t),
  bottom: ({ y: e }, { top: t }) => parseFloat(t) + (e.max - e.min),
  right: ({ x: e }, { left: t }) => parseFloat(t) + (e.max - e.min),
  // Transform
  x: (e, { transform: t }) => f5(t, "x"),
  y: (e, { transform: t }) => f5(t, "y")
};
ph.translateX = ph.x;
ph.translateY = ph.y;
const mh = /* @__PURE__ */ new Set();
let h5 = !1, p5 = !1, m5 = !1;
function wB() {
  if (p5) {
    const e = Array.from(mh).filter((r) => r.needsMeasurement), t = new Set(e.map((r) => r.element)), n = /* @__PURE__ */ new Map();
    t.forEach((r) => {
      const i = Wue(r);
      i.length && (n.set(r, i), r.render());
    }), e.forEach((r) => r.measureInitialState()), t.forEach((r) => {
      r.render();
      const i = n.get(r);
      i && i.forEach(([s, a]) => {
        var u;
        (u = r.getValue(s)) == null || u.set(a);
      });
    }), e.forEach((r) => r.measureEndState()), e.forEach((r) => {
      r.suspendedScrollY !== void 0 && window.scrollTo(0, r.suspendedScrollY);
    });
  }
  p5 = !1, h5 = !1, mh.forEach((e) => e.complete(m5)), mh.clear();
}
function _B() {
  mh.forEach((e) => {
    e.readKeyframes(), e.needsMeasurement && (p5 = !0);
  });
}
function Zue() {
  m5 = !0, _B(), wB(), m5 = !1;
}
class ij {
  constructor(t, n, r, i, s, a = !1) {
    this.state = "pending", this.isAsync = !1, this.needsMeasurement = !1, this.unresolvedKeyframes = [...t], this.onComplete = n, this.name = r, this.motionValue = i, this.element = s, this.isAsync = a;
  }
  scheduleResolve() {
    this.state = "scheduled", this.isAsync ? (mh.add(this), h5 || (h5 = !0, dr.read(_B), dr.resolveKeyframes(wB))) : (this.readKeyframes(), this.complete());
  }
  readKeyframes() {
    const { unresolvedKeyframes: t, name: n, element: r, motionValue: i } = this;
    if (t[0] === null) {
      const s = i == null ? void 0 : i.get(), a = t[t.length - 1];
      if (s !== void 0)
        t[0] = s;
      else if (r && n) {
        const u = r.readValue(n, a);
        u != null && (t[0] = u);
      }
      t[0] === void 0 && (t[0] = a), i && s === void 0 && i.set(t[0]);
    }
    Fue(t);
  }
  setFinalKeyframe() {
  }
  measureInitialState() {
  }
  renderEndStyles() {
  }
  measureEndState() {
  }
  complete(t = !1) {
    this.state = "complete", this.onComplete(this.unresolvedKeyframes, this.finalKeyframe, t), mh.delete(this);
  }
  cancel() {
    this.state === "scheduled" && (mh.delete(this), this.state = "pending");
  }
  resume() {
    this.state === "pending" && this.scheduleResolve();
  }
}
const Xue = (e) => e.startsWith("--");
function Que(e, t, n) {
  Xue(t) ? e.style.setProperty(t, n) : e.style[t] = n;
}
const Jue = /* @__PURE__ */ GT(() => window.ScrollTimeline !== void 0), ece = {};
function tce(e, t) {
  const n = /* @__PURE__ */ GT(e);
  return () => ece[t] ?? n();
}
const SB = /* @__PURE__ */ tce(() => {
  try {
    document.createElement("div").animate({ opacity: 0 }, { easing: "linear(0, 1)" });
  } catch {
    return !1;
  }
  return !0;
}, "linearEasing"), ty = ([e, t, n, r]) => `cubic-bezier(${e}, ${t}, ${n}, ${r})`, z6 = {
  linear: "linear",
  ease: "ease",
  easeIn: "ease-in",
  easeOut: "ease-out",
  easeInOut: "ease-in-out",
  circIn: /* @__PURE__ */ ty([0, 0.65, 0.55, 1]),
  circOut: /* @__PURE__ */ ty([0.55, 0, 1, 0.45]),
  backIn: /* @__PURE__ */ ty([0.31, 0.01, 0.66, -0.59]),
  backOut: /* @__PURE__ */ ty([0.33, 1.53, 0.69, 0.99])
};
function EB(e, t) {
  if (e)
    return typeof e == "function" ? SB() ? yB(e, t) : "ease-out" : aB(e) ? ty(e) : Array.isArray(e) ? e.map((n) => EB(n, t) || z6.easeOut) : z6[e];
}
function nce(e, t, n, { delay: r = 0, duration: i = 300, repeat: s = 0, repeatType: a = "loop", ease: u = "easeOut", times: d } = {}, f = void 0) {
  const h = {
    [t]: n
  };
  d && (h.offset = d);
  const m = EB(u, i);
  Array.isArray(m) && (h.easing = m);
  const x = {
    delay: r,
    duration: i,
    easing: Array.isArray(m) ? "linear" : m,
    fill: "both",
    iterations: s + 1,
    direction: a === "reverse" ? "alternate" : "normal"
  };
  return f && (x.pseudoElement = f), e.animate(h, x);
}
function CB(e) {
  return typeof e == "function" && "applyToOptions" in e;
}
function rce({ type: e, ...t }) {
  return CB(e) && SB() ? e.applyToOptions(t) : (t.duration ?? (t.duration = 300), t.ease ?? (t.ease = "easeOut"), t);
}
class ice extends nj {
  constructor(t) {
    if (super(), this.finishedTime = null, this.isStopped = !1, !t)
      return;
    const { element: n, name: r, keyframes: i, pseudoElement: s, allowFlatten: a = !1, finalKeyframe: u, onComplete: d } = t;
    this.isPseudoElement = !!s, this.allowFlatten = a, this.options = t;
    const f = rce(t);
    this.animation = nce(n, r, i, f, s), f.autoplay === !1 && this.animation.pause(), this.animation.onfinish = () => {
      if (this.finishedTime = this.time, !s) {
        const h = tj(i, this.options, u, this.speed);
        this.updateMotionValue ? this.updateMotionValue(h) : Que(n, r, h), this.animation.cancel();
      }
      d == null || d(), this.notifyFinished();
    };
  }
  play() {
    this.isStopped || (this.animation.play(), this.state === "finished" && this.updateFinished());
  }
  pause() {
    this.animation.pause();
  }
  complete() {
    var t, n;
    (n = (t = this.animation).finish) == null || n.call(t);
  }
  cancel() {
    try {
      this.animation.cancel();
    } catch {
    }
  }
  stop() {
    if (this.isStopped)
      return;
    this.isStopped = !0;
    const { state: t } = this;
    t === "idle" || t === "finished" || (this.updateMotionValue ? this.updateMotionValue() : this.commitStyles(), this.isPseudoElement || this.cancel());
  }
  /**
   * WAAPI doesn't natively have any interruption capabilities.
   *
   * In this method, we commit styles back to the DOM before cancelling
   * the animation.
   *
   * This is designed to be overridden by NativeAnimationExtended, which
   * will create a renderless JS animation and sample it twice to calculate
   * its current value, "previous" value, and therefore allow
   * Motion to also correctly calculate velocity for any subsequent animation
   * while deferring the commit until the next animation frame.
   */
  commitStyles() {
    var t, n;
    this.isPseudoElement || (n = (t = this.animation).commitStyles) == null || n.call(t);
  }
  get duration() {
    var n, r;
    const t = ((r = (n = this.animation.effect) == null ? void 0 : n.getComputedTiming) == null ? void 0 : r.call(n).duration) || 0;
    return /* @__PURE__ */ oo(Number(t));
  }
  get iterationDuration() {
    const { delay: t = 0 } = this.options || {};
    return this.duration + /* @__PURE__ */ oo(t);
  }
  get time() {
    return /* @__PURE__ */ oo(Number(this.animation.currentTime) || 0);
  }
  set time(t) {
    this.finishedTime = null, this.animation.currentTime = /* @__PURE__ */ eu(t);
  }
  /**
   * The playback speed of the animation.
   * 1 = normal speed, 2 = double speed, 0.5 = half speed.
   */
  get speed() {
    return this.animation.playbackRate;
  }
  set speed(t) {
    t < 0 && (this.finishedTime = null), this.animation.playbackRate = t;
  }
  get state() {
    return this.finishedTime !== null ? "finished" : this.animation.playState;
  }
  get startTime() {
    return Number(this.animation.startTime);
  }
  set startTime(t) {
    this.animation.startTime = t;
  }
  /**
   * Attaches a timeline to the animation, for instance the `ScrollTimeline`.
   */
  attachTimeline({ timeline: t, observe: n }) {
    var r;
    return this.allowFlatten && ((r = this.animation.effect) == null || r.updateTiming({ easing: "linear" })), this.animation.onfinish = null, t && Jue() ? (this.animation.timeline = t, lo) : n(this);
  }
}
const kB = {
  anticipate: nB,
  backInOut: tB,
  circInOut: iB
};
function sce(e) {
  return e in kB;
}
function ace(e) {
  typeof e.ease == "string" && sce(e.ease) && (e.ease = kB[e.ease]);
}
const P6 = 10;
class oce extends ice {
  constructor(t) {
    ace(t), bB(t), super(t), t.startTime && (this.startTime = t.startTime), this.options = t;
  }
  /**
   * WAAPI doesn't natively have any interruption capabilities.
   *
   * Rather than read commited styles back out of the DOM, we can
   * create a renderless JS animation and sample it twice to calculate
   * its current value, "previous" value, and therefore allow
   * Motion to calculate velocity for any subsequent animation.
   */
  updateMotionValue(t) {
    const { motionValue: n, onUpdate: r, onComplete: i, element: s, ...a } = this.options;
    if (!n)
      return;
    if (t !== void 0) {
      n.set(t);
      return;
    }
    const u = new rj({
      ...a,
      autoplay: !1
    }), d = /* @__PURE__ */ eu(this.finishedTime ?? this.time);
    n.setWithVelocity(u.sample(d - P6).value, u.sample(d).value, P6), u.stop();
  }
}
const I6 = (e, t) => t === "zIndex" ? !1 : !!(typeof e == "number" || Array.isArray(e) || typeof e == "string" && // It's animatable if we have a string
(Td.test(e) || e === "0") && // And it contains numbers and/or colors
!e.startsWith("url("));
function lce(e) {
  const t = e[0];
  if (e.length === 1)
    return !0;
  for (let n = 0; n < e.length; n++)
    if (e[n] !== t)
      return !0;
}
function uce(e, t, n, r) {
  const i = e[0];
  if (i === null)
    return !1;
  if (t === "display" || t === "visibility")
    return !0;
  const s = e[e.length - 1], a = I6(i, t), u = I6(s, t);
  return !a || !u ? !1 : lce(e) || (n === "spring" || CB(n)) && r;
}
function g5(e) {
  e.duration = 0, e.type = "keyframes";
}
const cce = /* @__PURE__ */ new Set([
  "opacity",
  "clipPath",
  "filter",
  "transform"
  // TODO: Could be re-enabled now we have support for linear() easing
  // "background-color"
]), dce = /* @__PURE__ */ GT(() => Object.hasOwnProperty.call(Element.prototype, "animate"));
function fce(e) {
  var h;
  const { motionValue: t, name: n, repeatDelay: r, repeatType: i, damping: s, type: a } = e;
  if (!(((h = t == null ? void 0 : t.owner) == null ? void 0 : h.current) instanceof HTMLElement))
    return !1;
  const { onUpdate: d, transformTemplate: f } = t.owner.getProps();
  return dce() && n && cce.has(n) && (n !== "transform" || !f) && /**
   * If we're outputting values to onUpdate then we can't use WAAPI as there's
   * no way to read the value from WAAPI every frame.
   */
  !d && !r && i !== "mirror" && s !== 0 && a !== "inertia";
}
const hce = 40;
class pce extends nj {
  constructor({ autoplay: t = !0, delay: n = 0, type: r = "keyframes", repeat: i = 0, repeatDelay: s = 0, repeatType: a = "loop", keyframes: u, name: d, motionValue: f, element: h, ...m }) {
    var w;
    super(), this.stop = () => {
      var S, C;
      this._animation && (this._animation.stop(), (S = this.stopTimeline) == null || S.call(this)), (C = this.keyframeResolver) == null || C.cancel();
    }, this.createdAt = da.now();
    const x = {
      autoplay: t,
      delay: n,
      type: r,
      repeat: i,
      repeatDelay: s,
      repeatType: a,
      name: d,
      motionValue: f,
      element: h,
      ...m
    }, b = (h == null ? void 0 : h.KeyframeResolver) || ij;
    this.keyframeResolver = new b(u, (S, C, T) => this.onKeyframesResolved(S, C, x, !T), d, f, h), (w = this.keyframeResolver) == null || w.scheduleResolve();
  }
  onKeyframesResolved(t, n, r, i) {
    this.keyframeResolver = void 0;
    const { name: s, type: a, velocity: u, delay: d, isHandoff: f, onUpdate: h } = r;
    this.resolvedAt = da.now(), uce(t, s, a, u) || ((Ju.instantAnimations || !d) && (h == null || h(tj(t, r, n))), t[0] = t[t.length - 1], g5(r), r.repeat = 0);
    const x = {
      startTime: i ? this.resolvedAt ? this.resolvedAt - this.createdAt > hce ? this.resolvedAt : this.createdAt : this.createdAt : void 0,
      finalKeyframe: n,
      ...r,
      keyframes: t
    }, b = !f && fce(x) ? new oce({
      ...x,
      element: x.motionValue.owner.current
    }) : new rj(x);
    b.finished.then(() => this.notifyFinished()).catch(lo), this.pendingTimeline && (this.stopTimeline = b.attachTimeline(this.pendingTimeline), this.pendingTimeline = void 0), this._animation = b;
  }
  get finished() {
    return this._animation ? this.animation.finished : this._finished;
  }
  then(t, n) {
    return this.finished.finally(t).then(() => {
    });
  }
  get animation() {
    var t;
    return this._animation || ((t = this.keyframeResolver) == null || t.resume(), Zue()), this._animation;
  }
  get duration() {
    return this.animation.duration;
  }
  get iterationDuration() {
    return this.animation.iterationDuration;
  }
  get time() {
    return this.animation.time;
  }
  set time(t) {
    this.animation.time = t;
  }
  get speed() {
    return this.animation.speed;
  }
  get state() {
    return this.animation.state;
  }
  set speed(t) {
    this.animation.speed = t;
  }
  get startTime() {
    return this.animation.startTime;
  }
  attachTimeline(t) {
    return this._animation ? this.stopTimeline = this.animation.attachTimeline(t) : this.pendingTimeline = t, () => this.stop();
  }
  play() {
    this.animation.play();
  }
  pause() {
    this.animation.pause();
  }
  complete() {
    this.animation.complete();
  }
  cancel() {
    var t;
    this._animation && this.animation.cancel(), (t = this.keyframeResolver) == null || t.cancel();
  }
}
const mce = (
  // eslint-disable-next-line redos-detector/no-unsafe-regex -- false positive, as it can match a lot of words
  /^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u
);
function gce(e) {
  const t = mce.exec(e);
  if (!t)
    return [,];
  const [, n, r, i] = t;
  return [`--${n ?? r}`, i];
}
function TB(e, t, n = 1) {
  const [r, i] = gce(e);
  if (!r)
    return;
  const s = window.getComputedStyle(t).getPropertyValue(r);
  if (s) {
    const a = s.trim();
    return KL(a) ? parseFloat(a) : a;
  }
  return ZT(i) ? TB(i, t, n + 1) : i;
}
function sj(e, t) {
  return (e == null ? void 0 : e[t]) ?? (e == null ? void 0 : e.default) ?? e;
}
const jB = /* @__PURE__ */ new Set([
  "width",
  "height",
  "top",
  "left",
  "right",
  "bottom",
  ...Xm
]), yce = {
  test: (e) => e === "auto",
  parse: (e) => e
}, AB = (e) => (t) => t.test(e), NB = [Zm, Bt, tu, hd, uue, lue, yce], L6 = (e) => NB.find(AB(e));
function xce(e) {
  return typeof e == "number" ? e === 0 : e !== null ? e === "none" || e === "0" || WL(e) : !0;
}
const vce = /* @__PURE__ */ new Set(["brightness", "contrast", "saturate", "opacity"]);
function bce(e) {
  const [t, n] = e.slice(0, -1).split("(");
  if (t === "drop-shadow")
    return e;
  const [r] = n.match(XT) || [];
  if (!r)
    return e;
  const i = n.replace(r, "");
  let s = vce.has(t) ? 1 : 0;
  return r !== n && (s *= 100), t + "(" + s + i + ")";
}
const wce = /\b([a-z-]*)\(.*?\)/gu, y5 = {
  ...Td,
  getAnimatableNone: (e) => {
    const t = e.match(wce);
    return t ? t.map(bce).join(" ") : e;
  }
}, B6 = {
  ...Zm,
  transform: Math.round
}, _ce = {
  rotate: hd,
  rotateX: hd,
  rotateY: hd,
  rotateZ: hd,
  scale: b1,
  scaleX: b1,
  scaleY: b1,
  scaleZ: b1,
  skew: hd,
  skewX: hd,
  skewY: hd,
  distance: Bt,
  translateX: Bt,
  translateY: Bt,
  translateZ: Bt,
  x: Bt,
  y: Bt,
  z: Bt,
  perspective: Bt,
  transformPerspective: Bt,
  opacity: My,
  originX: k6,
  originY: k6,
  originZ: Bt
}, aj = {
  // Border props
  borderWidth: Bt,
  borderTopWidth: Bt,
  borderRightWidth: Bt,
  borderBottomWidth: Bt,
  borderLeftWidth: Bt,
  borderRadius: Bt,
  radius: Bt,
  borderTopLeftRadius: Bt,
  borderTopRightRadius: Bt,
  borderBottomRightRadius: Bt,
  borderBottomLeftRadius: Bt,
  // Positioning props
  width: Bt,
  maxWidth: Bt,
  height: Bt,
  maxHeight: Bt,
  top: Bt,
  right: Bt,
  bottom: Bt,
  left: Bt,
  // Spacing props
  padding: Bt,
  paddingTop: Bt,
  paddingRight: Bt,
  paddingBottom: Bt,
  paddingLeft: Bt,
  margin: Bt,
  marginTop: Bt,
  marginRight: Bt,
  marginBottom: Bt,
  marginLeft: Bt,
  // Misc
  backgroundPositionX: Bt,
  backgroundPositionY: Bt,
  ..._ce,
  zIndex: B6,
  // SVG
  fillOpacity: My,
  strokeOpacity: My,
  numOctaves: B6
}, Sce = {
  ...aj,
  // Color props
  color: ei,
  backgroundColor: ei,
  outlineColor: ei,
  fill: ei,
  stroke: ei,
  // Border props
  borderColor: ei,
  borderTopColor: ei,
  borderRightColor: ei,
  borderBottomColor: ei,
  borderLeftColor: ei,
  filter: y5,
  WebkitFilter: y5
}, RB = (e) => Sce[e];
function MB(e, t) {
  let n = RB(e);
  return n !== y5 && (n = Td), n.getAnimatableNone ? n.getAnimatableNone(t) : void 0;
}
const Ece = /* @__PURE__ */ new Set(["auto", "none", "0"]);
function Cce(e, t, n) {
  let r = 0, i;
  for (; r < e.length && !i; ) {
    const s = e[r];
    typeof s == "string" && !Ece.has(s) && Oy(s).values.length && (i = e[r]), r++;
  }
  if (i && n)
    for (const s of t)
      e[s] = MB(n, i);
}
class kce extends ij {
  constructor(t, n, r, i, s) {
    super(t, n, r, i, s, !0);
  }
  readKeyframes() {
    const { unresolvedKeyframes: t, element: n, name: r } = this;
    if (!n || !n.current)
      return;
    super.readKeyframes();
    for (let d = 0; d < t.length; d++) {
      let f = t[d];
      if (typeof f == "string" && (f = f.trim(), ZT(f))) {
        const h = TB(f, n.current);
        h !== void 0 && (t[d] = h), d === t.length - 1 && (this.finalKeyframe = f);
      }
    }
    if (this.resolveNoneKeyframes(), !jB.has(r) || t.length !== 2)
      return;
    const [i, s] = t, a = L6(i), u = L6(s);
    if (a !== u)
      if (D6(a) && D6(u))
        for (let d = 0; d < t.length; d++) {
          const f = t[d];
          typeof f == "string" && (t[d] = parseFloat(f));
        }
      else ph[r] && (this.needsMeasurement = !0);
  }
  resolveNoneKeyframes() {
    const { unresolvedKeyframes: t, name: n } = this, r = [];
    for (let i = 0; i < t.length; i++)
      (t[i] === null || xce(t[i])) && r.push(i);
    r.length && Cce(t, r, n);
  }
  measureInitialState() {
    const { element: t, unresolvedKeyframes: n, name: r } = this;
    if (!t || !t.current)
      return;
    r === "height" && (this.suspendedScrollY = window.pageYOffset), this.measuredOrigin = ph[r](t.measureViewportBox(), window.getComputedStyle(t.current)), n[0] = this.measuredOrigin;
    const i = n[n.length - 1];
    i !== void 0 && t.getValue(r, i).jump(i, !1);
  }
  measureEndState() {
    var u;
    const { element: t, name: n, unresolvedKeyframes: r } = this;
    if (!t || !t.current)
      return;
    const i = t.getValue(n);
    i && i.jump(this.measuredOrigin, !1);
    const s = r.length - 1, a = r[s];
    r[s] = ph[n](t.measureViewportBox(), window.getComputedStyle(t.current)), a !== null && this.finalKeyframe === void 0 && (this.finalKeyframe = a), (u = this.removedTransforms) != null && u.length && this.removedTransforms.forEach(([d, f]) => {
      t.getValue(d).set(f);
    }), this.resolveNoneKeyframes();
  }
}
function Tce(e, t, n) {
  if (e instanceof EventTarget)
    return [e];
  if (typeof e == "string") {
    let r = document;
    const i = (n == null ? void 0 : n[e]) ?? r.querySelectorAll(e);
    return i ? Array.from(i) : [];
  }
  return Array.from(e);
}
const OB = (e, t) => t && typeof e == "number" ? t.transform(e) : e;
function jce(e) {
  return YL(e) && "offsetHeight" in e;
}
const $6 = 30, Ace = (e) => !isNaN(parseFloat(e)), my = {
  current: void 0
};
class Nce {
  /**
   * @param init - The initiating value
   * @param config - Optional configuration options
   *
   * -  `transformer`: A function to transform incoming values with.
   */
  constructor(t, n = {}) {
    this.canTrackVelocity = null, this.events = {}, this.updateAndNotify = (r) => {
      var s;
      const i = da.now();
      if (this.updatedAt !== i && this.setPrevFrameValue(), this.prev = this.current, this.setCurrent(r), this.current !== this.prev && ((s = this.events.change) == null || s.notify(this.current), this.dependents))
        for (const a of this.dependents)
          a.dirty();
    }, this.hasAnimated = !1, this.setCurrent(t), this.owner = n.owner;
  }
  setCurrent(t) {
    this.current = t, this.updatedAt = da.now(), this.canTrackVelocity === null && t !== void 0 && (this.canTrackVelocity = Ace(this.current));
  }
  setPrevFrameValue(t = this.current) {
    this.prevFrameValue = t, this.prevUpdatedAt = this.updatedAt;
  }
  /**
   * Adds a function that will be notified when the `MotionValue` is updated.
   *
   * It returns a function that, when called, will cancel the subscription.
   *
   * When calling `onChange` inside a React component, it should be wrapped with the
   * `useEffect` hook. As it returns an unsubscribe function, this should be returned
   * from the `useEffect` function to ensure you don't add duplicate subscribers..
   *
   * ```jsx
   * export const MyComponent = () => {
   *   const x = useMotionValue(0)
   *   const y = useMotionValue(0)
   *   const opacity = useMotionValue(1)
   *
   *   useEffect(() => {
   *     function updateOpacity() {
   *       const maxXY = Math.max(x.get(), y.get())
   *       const newOpacity = transform(maxXY, [0, 100], [1, 0])
   *       opacity.set(newOpacity)
   *     }
   *
   *     const unsubscribeX = x.on("change", updateOpacity)
   *     const unsubscribeY = y.on("change", updateOpacity)
   *
   *     return () => {
   *       unsubscribeX()
   *       unsubscribeY()
   *     }
   *   }, [])
   *
   *   return <motion.div style={{ x }} />
   * }
   * ```
   *
   * @param subscriber - A function that receives the latest value.
   * @returns A function that, when called, will cancel this subscription.
   *
   * @deprecated
   */
  onChange(t) {
    return this.on("change", t);
  }
  on(t, n) {
    this.events[t] || (this.events[t] = new KT());
    const r = this.events[t].add(n);
    return t === "change" ? () => {
      r(), dr.read(() => {
        this.events.change.getSize() || this.stop();
      });
    } : r;
  }
  clearListeners() {
    for (const t in this.events)
      this.events[t].clear();
  }
  /**
   * Attaches a passive effect to the `MotionValue`.
   */
  attach(t, n) {
    this.passiveEffect = t, this.stopPassiveEffect = n;
  }
  /**
   * Sets the state of the `MotionValue`.
   *
   * @remarks
   *
   * ```jsx
   * const x = useMotionValue(0)
   * x.set(10)
   * ```
   *
   * @param latest - Latest value to set.
   * @param render - Whether to notify render subscribers. Defaults to `true`
   *
   * @public
   */
  set(t) {
    this.passiveEffect ? this.passiveEffect(t, this.updateAndNotify) : this.updateAndNotify(t);
  }
  setWithVelocity(t, n, r) {
    this.set(n), this.prev = void 0, this.prevFrameValue = t, this.prevUpdatedAt = this.updatedAt - r;
  }
  /**
   * Set the state of the `MotionValue`, stopping any active animations,
   * effects, and resets velocity to `0`.
   */
  jump(t, n = !0) {
    this.updateAndNotify(t), this.prev = t, this.prevUpdatedAt = this.prevFrameValue = void 0, n && this.stop(), this.stopPassiveEffect && this.stopPassiveEffect();
  }
  dirty() {
    var t;
    (t = this.events.change) == null || t.notify(this.current);
  }
  addDependent(t) {
    this.dependents || (this.dependents = /* @__PURE__ */ new Set()), this.dependents.add(t);
  }
  removeDependent(t) {
    this.dependents && this.dependents.delete(t);
  }
  /**
   * Returns the latest state of `MotionValue`
   *
   * @returns - The latest state of `MotionValue`
   *
   * @public
   */
  get() {
    return my.current && my.current.push(this), this.current;
  }
  /**
   * @public
   */
  getPrevious() {
    return this.prev;
  }
  /**
   * Returns the latest velocity of `MotionValue`
   *
   * @returns - The latest velocity of `MotionValue`. Returns `0` if the state is non-numerical.
   *
   * @public
   */
  getVelocity() {
    const t = da.now();
    if (!this.canTrackVelocity || this.prevFrameValue === void 0 || t - this.updatedAt > $6)
      return 0;
    const n = Math.min(this.updatedAt - this.prevUpdatedAt, $6);
    return ZL(parseFloat(this.current) - parseFloat(this.prevFrameValue), n);
  }
  /**
   * Registers a new animation to control this `MotionValue`. Only one
   * animation can drive a `MotionValue` at one time.
   *
   * ```jsx
   * value.start()
   * ```
   *
   * @param animation - A function that starts the provided animation
   */
  start(t) {
    return this.stop(), new Promise((n) => {
      this.hasAnimated = !0, this.animation = t(n), this.events.animationStart && this.events.animationStart.notify();
    }).then(() => {
      this.events.animationComplete && this.events.animationComplete.notify(), this.clearAnimation();
    });
  }
  /**
   * Stop the currently active animation.
   *
   * @public
   */
  stop() {
    this.animation && (this.animation.stop(), this.events.animationCancel && this.events.animationCancel.notify()), this.clearAnimation();
  }
  /**
   * Returns `true` if this value is currently animating.
   *
   * @public
   */
  isAnimating() {
    return !!this.animation;
  }
  clearAnimation() {
    delete this.animation;
  }
  /**
   * Destroy and clean up subscribers to this `MotionValue`.
   *
   * The `MotionValue` hooks like `useMotionValue` and `useTransform` automatically
   * handle the lifecycle of the returned `MotionValue`, so this method is only necessary if you've manually
   * created a `MotionValue` via the `motionValue` function.
   *
   * @public
   */
  destroy() {
    var t, n;
    (t = this.dependents) == null || t.clear(), (n = this.events.destroy) == null || n.notify(), this.clearListeners(), this.stop(), this.stopPassiveEffect && this.stopPassiveEffect();
  }
}
function wh(e, t) {
  return new Nce(e, t);
}
const { schedule: oj } = /* @__PURE__ */ oB(queueMicrotask, !1), Go = {
  x: !1,
  y: !1
};
function DB() {
  return Go.x || Go.y;
}
function Rce(e) {
  return e === "x" || e === "y" ? Go[e] ? null : (Go[e] = !0, () => {
    Go[e] = !1;
  }) : Go.x || Go.y ? null : (Go.x = Go.y = !0, () => {
    Go.x = Go.y = !1;
  });
}
function zB(e, t) {
  const n = Tce(e), r = new AbortController(), i = {
    passive: !0,
    ...t,
    signal: r.signal
  };
  return [n, i, () => r.abort()];
}
function q6(e) {
  return !(e.pointerType === "touch" || DB());
}
function Mce(e, t, n = {}) {
  const [r, i, s] = zB(e, n), a = (u) => {
    if (!q6(u))
      return;
    const { target: d } = u, f = t(d, u);
    if (typeof f != "function" || !d)
      return;
    const h = (m) => {
      q6(m) && (f(m), d.removeEventListener("pointerleave", h));
    };
    d.addEventListener("pointerleave", h, i);
  };
  return r.forEach((u) => {
    u.addEventListener("pointerenter", a, i);
  }), s;
}
const PB = (e, t) => t ? e === t ? !0 : PB(e, t.parentElement) : !1, lj = (e) => e.pointerType === "mouse" ? typeof e.button != "number" || e.button <= 0 : e.isPrimary !== !1, Oce = /* @__PURE__ */ new Set([
  "BUTTON",
  "INPUT",
  "SELECT",
  "TEXTAREA",
  "A"
]);
function Dce(e) {
  return Oce.has(e.tagName) || e.tabIndex !== -1;
}
const H1 = /* @__PURE__ */ new WeakSet();
function F6(e) {
  return (t) => {
    t.key === "Enter" && e(t);
  };
}
function S_(e, t) {
  e.dispatchEvent(new PointerEvent("pointer" + t, { isPrimary: !0, bubbles: !0 }));
}
const zce = (e, t) => {
  const n = e.currentTarget;
  if (!n)
    return;
  const r = F6(() => {
    if (H1.has(n))
      return;
    S_(n, "down");
    const i = F6(() => {
      S_(n, "up");
    }), s = () => S_(n, "cancel");
    n.addEventListener("keyup", i, t), n.addEventListener("blur", s, t);
  });
  n.addEventListener("keydown", r, t), n.addEventListener("blur", () => n.removeEventListener("keydown", r), t);
};
function U6(e) {
  return lj(e) && !DB();
}
function Pce(e, t, n = {}) {
  const [r, i, s] = zB(e, n), a = (u) => {
    const d = u.currentTarget;
    if (!U6(u))
      return;
    H1.add(d);
    const f = t(d, u), h = (b, w) => {
      window.removeEventListener("pointerup", m), window.removeEventListener("pointercancel", x), H1.has(d) && H1.delete(d), U6(b) && typeof f == "function" && f(b, { success: w });
    }, m = (b) => {
      h(b, d === window || d === document || n.useGlobalTarget || PB(d, b.target));
    }, x = (b) => {
      h(b, !1);
    };
    window.addEventListener("pointerup", m, i), window.addEventListener("pointercancel", x, i);
  };
  return r.forEach((u) => {
    (n.useGlobalTarget ? window : u).addEventListener("pointerdown", a, i), jce(u) && (u.addEventListener("focus", (f) => zce(f, i)), !Dce(u) && !u.hasAttribute("tabindex") && (u.tabIndex = 0));
  }), s;
}
function IB(e) {
  return YL(e) && "ownerSVGElement" in e;
}
function Ice(e) {
  return IB(e) && e.tagName === "svg";
}
function Lce(...e) {
  const t = !Array.isArray(e[0]), n = t ? 0 : -1, r = e[0 + n], i = e[1 + n], s = e[2 + n], a = e[3 + n], u = vB(i, s, a);
  return t ? u(r) : u;
}
const qi = (e) => !!(e && e.getVelocity), Bce = [...NB, ei, Td], $ce = (e) => Bce.find(AB(e)), uj = I.createContext({
  transformPagePoint: (e) => e,
  isStatic: !1,
  reducedMotion: "never"
});
function qce(e = !0) {
  const t = I.useContext(UT);
  if (t === null)
    return [!0, null];
  const { isPresent: n, onExitComplete: r, register: i } = t, s = I.useId();
  I.useEffect(() => {
    if (e)
      return i(s);
  }, [e]);
  const a = I.useCallback(() => e && r && r(s), [s, r, e]);
  return !n && r ? [!1, a] : [!0];
}
const LB = I.createContext({ strict: !1 }), H6 = {
  animation: [
    "animate",
    "variants",
    "whileHover",
    "whileTap",
    "exit",
    "whileInView",
    "whileFocus",
    "whileDrag"
  ],
  exit: ["exit"],
  drag: ["drag", "dragControls"],
  focus: ["whileFocus"],
  hover: ["whileHover", "onHoverStart", "onHoverEnd"],
  tap: ["whileTap", "onTap", "onTapStart", "onTapCancel"],
  pan: ["onPan", "onPanStart", "onPanSessionStart", "onPanEnd"],
  inView: ["whileInView", "onViewportEnter", "onViewportLeave"],
  layout: ["layout", "layoutId"]
}, Pm = {};
for (const e in H6)
  Pm[e] = {
    isEnabled: (t) => H6[e].some((n) => !!t[n])
  };
function Fce(e) {
  for (const t in e)
    Pm[t] = {
      ...Pm[t],
      ...e[t]
    };
}
const Uce = /* @__PURE__ */ new Set([
  "animate",
  "exit",
  "variants",
  "initial",
  "style",
  "values",
  "variants",
  "transition",
  "transformTemplate",
  "custom",
  "inherit",
  "onBeforeLayoutMeasure",
  "onAnimationStart",
  "onAnimationComplete",
  "onUpdate",
  "onDragStart",
  "onDrag",
  "onDragEnd",
  "onMeasureDragConstraints",
  "onDirectionLock",
  "onDragTransitionEnd",
  "_dragX",
  "_dragY",
  "onHoverStart",
  "onHoverEnd",
  "onViewportEnter",
  "onViewportLeave",
  "globalTapTarget",
  "ignoreStrict",
  "viewport"
]);
function Cb(e) {
  return e.startsWith("while") || e.startsWith("drag") && e !== "draggable" || e.startsWith("layout") || e.startsWith("onTap") || e.startsWith("onPan") || e.startsWith("onLayout") || Uce.has(e);
}
let BB = (e) => !Cb(e);
function Hce(e) {
  typeof e == "function" && (BB = (t) => t.startsWith("on") ? !Cb(t) : e(t));
}
try {
  Hce(require("@emotion/is-prop-valid").default);
} catch {
}
function Vce(e, t, n) {
  const r = {};
  for (const i in e)
    i === "values" && typeof e.values == "object" || (BB(i) || n === !0 && Cb(i) || !t && !Cb(i) || // If trying to use native HTML drag events, forward drag listeners
    e.draggable && i.startsWith("onDrag")) && (r[i] = e[i]);
  return r;
}
const dw = /* @__PURE__ */ I.createContext({});
function fw(e) {
  return e !== null && typeof e == "object" && typeof e.start == "function";
}
function Dy(e) {
  return typeof e == "string" || Array.isArray(e);
}
const cj = [
  "animate",
  "whileInView",
  "whileFocus",
  "whileHover",
  "whileTap",
  "whileDrag",
  "exit"
], dj = ["initial", ...cj];
function hw(e) {
  return fw(e.animate) || dj.some((t) => Dy(e[t]));
}
function $B(e) {
  return !!(hw(e) || e.variants);
}
function Gce(e, t) {
  if (hw(e)) {
    const { initial: n, animate: r } = e;
    return {
      initial: n === !1 || Dy(n) ? n : void 0,
      animate: Dy(r) ? r : void 0
    };
  }
  return e.inherit !== !1 ? t : {};
}
function Kce(e) {
  const { initial: t, animate: n } = Gce(e, I.useContext(dw));
  return I.useMemo(() => ({ initial: t, animate: n }), [V6(t), V6(n)]);
}
function V6(e) {
  return Array.isArray(e) ? e.join(" ") : e;
}
function G6(e, t) {
  return t.max === t.min ? 0 : e / (t.max - t.min) * 100;
}
const K0 = {
  correct: (e, t) => {
    if (!t.target)
      return e;
    if (typeof e == "string")
      if (Bt.test(e))
        e = parseFloat(e);
      else
        return e;
    const n = G6(e, t.target.x), r = G6(e, t.target.y);
    return `${n}% ${r}%`;
  }
}, Yce = {
  correct: (e, { treeScale: t, projectionDelta: n }) => {
    const r = e, i = Td.parse(e);
    if (i.length > 5)
      return r;
    const s = Td.createTransformer(e), a = typeof i[0] != "number" ? 1 : 0, u = n.x.scale * t.x, d = n.y.scale * t.y;
    i[0 + a] /= u, i[1 + a] /= d;
    const f = yr(u, d, 0.5);
    return typeof i[2 + a] == "number" && (i[2 + a] /= f), typeof i[3 + a] == "number" && (i[3 + a] /= f), s(i);
  }
}, x5 = {
  borderRadius: {
    ...K0,
    applyTo: [
      "borderTopLeftRadius",
      "borderTopRightRadius",
      "borderBottomLeftRadius",
      "borderBottomRightRadius"
    ]
  },
  borderTopLeftRadius: K0,
  borderTopRightRadius: K0,
  borderBottomLeftRadius: K0,
  borderBottomRightRadius: K0,
  boxShadow: Yce
};
function qB(e, { layout: t, layoutId: n }) {
  return Qm.has(e) || e.startsWith("origin") || (t || n !== void 0) && (!!x5[e] || e === "opacity");
}
const Wce = {
  x: "translateX",
  y: "translateY",
  z: "translateZ",
  transformPerspective: "perspective"
}, Zce = Xm.length;
function Xce(e, t, n) {
  let r = "", i = !0;
  for (let s = 0; s < Zce; s++) {
    const a = Xm[s], u = e[a];
    if (u === void 0)
      continue;
    let d = !0;
    if (typeof u == "number" ? d = u === (a.startsWith("scale") ? 1 : 0) : d = parseFloat(u) === 0, !d || n) {
      const f = OB(u, aj[a]);
      if (!d) {
        i = !1;
        const h = Wce[a] || a;
        r += `${h}(${f}) `;
      }
      n && (t[a] = f);
    }
  }
  return r = r.trim(), n ? r = n(t, i ? "" : r) : i && (r = "none"), r;
}
function fj(e, t, n) {
  const { style: r, vars: i, transformOrigin: s } = e;
  let a = !1, u = !1;
  for (const d in t) {
    const f = t[d];
    if (Qm.has(d)) {
      a = !0;
      continue;
    } else if (uB(d)) {
      i[d] = f;
      continue;
    } else {
      const h = OB(f, aj[d]);
      d.startsWith("origin") ? (u = !0, s[d] = h) : r[d] = h;
    }
  }
  if (t.transform || (a || n ? r.transform = Xce(t, e.transform, n) : r.transform && (r.transform = "none")), u) {
    const { originX: d = "50%", originY: f = "50%", originZ: h = 0 } = s;
    r.transformOrigin = `${d} ${f} ${h}`;
  }
}
const hj = () => ({
  style: {},
  transform: {},
  transformOrigin: {},
  vars: {}
});
function FB(e, t, n) {
  for (const r in t)
    !qi(t[r]) && !qB(r, n) && (e[r] = t[r]);
}
function Qce({ transformTemplate: e }, t) {
  return I.useMemo(() => {
    const n = hj();
    return fj(n, t, e), Object.assign({}, n.vars, n.style);
  }, [t]);
}
function Jce(e, t) {
  const n = e.style || {}, r = {};
  return FB(r, n, e), Object.assign(r, Qce(e, t)), r;
}
function ede(e, t) {
  const n = {}, r = Jce(e, t);
  return e.drag && e.dragListener !== !1 && (n.draggable = !1, r.userSelect = r.WebkitUserSelect = r.WebkitTouchCallout = "none", r.touchAction = e.drag === !0 ? "none" : `pan-${e.drag === "x" ? "y" : "x"}`), e.tabIndex === void 0 && (e.onTap || e.onTapStart || e.whileTap) && (n.tabIndex = 0), n.style = r, n;
}
const tde = {
  offset: "stroke-dashoffset",
  array: "stroke-dasharray"
}, nde = {
  offset: "strokeDashoffset",
  array: "strokeDasharray"
};
function rde(e, t, n = 1, r = 0, i = !0) {
  e.pathLength = 1;
  const s = i ? tde : nde;
  e[s.offset] = Bt.transform(-r);
  const a = Bt.transform(t), u = Bt.transform(n);
  e[s.array] = `${a} ${u}`;
}
function UB(e, {
  attrX: t,
  attrY: n,
  attrScale: r,
  pathLength: i,
  pathSpacing: s = 1,
  pathOffset: a = 0,
  // This is object creation, which we try to avoid per-frame.
  ...u
}, d, f, h) {
  if (fj(e, u, f), d) {
    e.style.viewBox && (e.attrs.viewBox = e.style.viewBox);
    return;
  }
  e.attrs = e.style, e.style = {};
  const { attrs: m, style: x } = e;
  m.transform && (x.transform = m.transform, delete m.transform), (x.transform || m.transformOrigin) && (x.transformOrigin = m.transformOrigin ?? "50% 50%", delete m.transformOrigin), x.transform && (x.transformBox = (h == null ? void 0 : h.transformBox) ?? "fill-box", delete m.transformBox), t !== void 0 && (m.x = t), n !== void 0 && (m.y = n), r !== void 0 && (m.scale = r), i !== void 0 && rde(m, i, s, a, !1);
}
const HB = () => ({
  ...hj(),
  attrs: {}
}), VB = (e) => typeof e == "string" && e.toLowerCase() === "svg";
function ide(e, t, n, r) {
  const i = I.useMemo(() => {
    const s = HB();
    return UB(s, t, VB(r), e.transformTemplate, e.style), {
      ...s.attrs,
      style: { ...s.style }
    };
  }, [t]);
  if (e.style) {
    const s = {};
    FB(s, e.style, e), i.style = { ...s, ...i.style };
  }
  return i;
}
const sde = [
  "animate",
  "circle",
  "defs",
  "desc",
  "ellipse",
  "g",
  "image",
  "line",
  "filter",
  "marker",
  "mask",
  "metadata",
  "path",
  "pattern",
  "polygon",
  "polyline",
  "rect",
  "stop",
  "switch",
  "symbol",
  "svg",
  "text",
  "tspan",
  "use",
  "view"
];
function pj(e) {
  return (
    /**
     * If it's not a string, it's a custom React component. Currently we only support
     * HTML custom React components.
     */
    typeof e != "string" || /**
     * If it contains a dash, the element is a custom HTML webcomponent.
     */
    e.includes("-") ? !1 : (
      /**
       * If it's in our list of lowercase SVG tags, it's an SVG component
       */
      !!(sde.indexOf(e) > -1 || /**
       * If it contains a capital letter, it's an SVG component
       */
      /[A-Z]/u.test(e))
    )
  );
}
function ade(e, t, n, { latestValues: r }, i, s = !1) {
  const u = (pj(e) ? ide : ede)(t, r, i, e), d = Vce(t, typeof e == "string", s), f = e !== I.Fragment ? { ...d, ...u, ref: n } : {}, { children: h } = t, m = I.useMemo(() => qi(h) ? h.get() : h, [h]);
  return I.createElement(e, {
    ...f,
    children: m
  });
}
function K6(e) {
  const t = [{}, {}];
  return e == null || e.values.forEach((n, r) => {
    t[0][r] = n.get(), t[1][r] = n.getVelocity();
  }), t;
}
function mj(e, t, n, r) {
  if (typeof t == "function") {
    const [i, s] = K6(r);
    t = t(n !== void 0 ? n : e.custom, i, s);
  }
  if (typeof t == "string" && (t = e.variants && e.variants[t]), typeof t == "function") {
    const [i, s] = K6(r);
    t = t(n !== void 0 ? n : e.custom, i, s);
  }
  return t;
}
function V1(e) {
  return qi(e) ? e.get() : e;
}
function ode({ scrapeMotionValuesFromProps: e, createRenderState: t }, n, r, i) {
  return {
    latestValues: lde(n, r, i, e),
    renderState: t()
  };
}
function lde(e, t, n, r) {
  const i = {}, s = r(e, {});
  for (const x in s)
    i[x] = V1(s[x]);
  let { initial: a, animate: u } = e;
  const d = hw(e), f = $B(e);
  t && f && !d && e.inherit !== !1 && (a === void 0 && (a = t.initial), u === void 0 && (u = t.animate));
  let h = n ? n.initial === !1 : !1;
  h = h || a === !1;
  const m = h ? u : a;
  if (m && typeof m != "boolean" && !fw(m)) {
    const x = Array.isArray(m) ? m : [m];
    for (let b = 0; b < x.length; b++) {
      const w = mj(e, x[b]);
      if (w) {
        const { transitionEnd: S, transition: C, ...T } = w;
        for (const R in T) {
          let N = T[R];
          if (Array.isArray(N)) {
            const M = h ? N.length - 1 : 0;
            N = N[M];
          }
          N !== null && (i[R] = N);
        }
        for (const R in S)
          i[R] = S[R];
      }
    }
  }
  return i;
}
const GB = (e) => (t, n) => {
  const r = I.useContext(dw), i = I.useContext(UT), s = () => ode(e, t, r, i);
  return n ? s() : ix(s);
};
function gj(e, t, n) {
  var s;
  const { style: r } = e, i = {};
  for (const a in r)
    (qi(r[a]) || t.style && qi(t.style[a]) || qB(a, e) || ((s = n == null ? void 0 : n.getValue(a)) == null ? void 0 : s.liveStyle) !== void 0) && (i[a] = r[a]);
  return i;
}
const ude = /* @__PURE__ */ GB({
  scrapeMotionValuesFromProps: gj,
  createRenderState: hj
});
function KB(e, t, n) {
  const r = gj(e, t, n);
  for (const i in e)
    if (qi(e[i]) || qi(t[i])) {
      const s = Xm.indexOf(i) !== -1 ? "attr" + i.charAt(0).toUpperCase() + i.substring(1) : i;
      r[s] = e[i];
    }
  return r;
}
const cde = /* @__PURE__ */ GB({
  scrapeMotionValuesFromProps: KB,
  createRenderState: HB
}), dde = Symbol.for("motionComponentSymbol");
function dm(e) {
  return e && typeof e == "object" && Object.prototype.hasOwnProperty.call(e, "current");
}
function fde(e, t, n) {
  return I.useCallback(
    (r) => {
      r && e.onMount && e.onMount(r), t && (r ? t.mount(r) : t.unmount()), n && (typeof n == "function" ? n(r) : dm(n) && (n.current = r));
    },
    /**
     * Include externalRef in dependencies to ensure the callback updates
     * when the ref changes, allowing proper ref forwarding.
     */
    [t]
  );
}
const yj = (e) => e.replace(/([a-z])([A-Z])/gu, "$1-$2").toLowerCase(), hde = "framerAppearId", YB = "data-" + yj(hde), WB = I.createContext({});
function pde(e, t, n, r, i) {
  var S, C;
  const { visualElement: s } = I.useContext(dw), a = I.useContext(LB), u = I.useContext(UT), d = I.useContext(uj).reducedMotion, f = I.useRef(null);
  r = r || a.renderer, !f.current && r && (f.current = r(e, {
    visualState: t,
    parent: s,
    props: n,
    presenceContext: u,
    blockInitialAnimation: u ? u.initial === !1 : !1,
    reducedMotionConfig: d
  }));
  const h = f.current, m = I.useContext(WB);
  h && !h.projection && i && (h.type === "html" || h.type === "svg") && mde(f.current, n, i, m);
  const x = I.useRef(!1);
  I.useInsertionEffect(() => {
    h && x.current && h.update(n, u);
  });
  const b = n[YB], w = I.useRef(!!b && !((S = window.MotionHandoffIsComplete) != null && S.call(window, b)) && ((C = window.MotionHasOptimisedAnimation) == null ? void 0 : C.call(window, b)));
  return GL(() => {
    h && (x.current = !0, window.MotionIsMounted = !0, h.updateFeatures(), h.scheduleRenderMicrotask(), w.current && h.animationState && h.animationState.animateChanges());
  }), I.useEffect(() => {
    h && (!w.current && h.animationState && h.animationState.animateChanges(), w.current && (queueMicrotask(() => {
      var T;
      (T = window.MotionHandoffMarkAsComplete) == null || T.call(window, b);
    }), w.current = !1), h.enteringChildren = void 0);
  }), h;
}
function mde(e, t, n, r) {
  const { layoutId: i, layout: s, drag: a, dragConstraints: u, layoutScroll: d, layoutRoot: f, layoutCrossfade: h } = t;
  e.projection = new n(e.latestValues, t["data-framer-portal-id"] ? void 0 : ZB(e.parent)), e.projection.setOptions({
    layoutId: i,
    layout: s,
    alwaysMeasureLayout: !!a || u && dm(u),
    visualElement: e,
    /**
     * TODO: Update options in an effect. This could be tricky as it'll be too late
     * to update by the time layout animations run.
     * We also need to fix this safeToRemove by linking it up to the one returned by usePresence,
     * ensuring it gets called if there's no potential layout animations.
     *
     */
    animationType: typeof s == "string" ? s : "both",
    initialPromotionConfig: r,
    crossfade: h,
    layoutScroll: d,
    layoutRoot: f
  });
}
function ZB(e) {
  if (e)
    return e.options.allowProjection !== !1 ? e.projection : ZB(e.parent);
}
function E_(e, { forwardMotionProps: t = !1 } = {}, n, r) {
  n && Fce(n);
  const i = pj(e) ? cde : ude;
  function s(u, d) {
    let f;
    const h = {
      ...I.useContext(uj),
      ...u,
      layoutId: gde(u)
    }, { isStatic: m } = h, x = Kce(u), b = i(u, m);
    if (!m && FT) {
      yde();
      const w = xde(h);
      f = w.MeasureLayout, x.visualElement = pde(e, b, h, r, w.ProjectionNode);
    }
    return c.jsxs(dw.Provider, { value: x, children: [f && x.visualElement ? c.jsx(f, { visualElement: x.visualElement, ...h }) : null, ade(e, u, fde(b, x.visualElement, d), b, m, t)] });
  }
  s.displayName = `motion.${typeof e == "string" ? e : `create(${e.displayName ?? e.name ?? ""})`}`;
  const a = I.forwardRef(s);
  return a[dde] = e, a;
}
function gde({ layoutId: e }) {
  const t = I.useContext(VL).id;
  return t && e !== void 0 ? t + "-" + e : e;
}
function yde(e, t) {
  I.useContext(LB).strict;
}
function xde(e) {
  const { drag: t, layout: n } = Pm;
  if (!t && !n)
    return {};
  const r = { ...t, ...n };
  return {
    MeasureLayout: t != null && t.isEnabled(e) || n != null && n.isEnabled(e) ? r.MeasureLayout : void 0,
    ProjectionNode: r.ProjectionNode
  };
}
function vde(e, t) {
  if (typeof Proxy > "u")
    return E_;
  const n = /* @__PURE__ */ new Map(), r = (s, a) => E_(s, a, e, t), i = (s, a) => r(s, a);
  return new Proxy(i, {
    /**
     * Called when `motion` is referenced with a prop: `motion.div`, `motion.input` etc.
     * The prop name is passed through as `key` and we can use that to generate a `motion`
     * DOM component with that name.
     */
    get: (s, a) => a === "create" ? r : (n.has(a) || n.set(a, E_(a, void 0, e, t)), n.get(a))
  });
}
function XB({ top: e, left: t, right: n, bottom: r }) {
  return {
    x: { min: t, max: n },
    y: { min: e, max: r }
  };
}
function bde({ x: e, y: t }) {
  return { top: t.min, right: e.max, bottom: t.max, left: e.min };
}
function wde(e, t) {
  if (!t)
    return e;
  const n = t({ x: e.left, y: e.top }), r = t({ x: e.right, y: e.bottom });
  return {
    top: n.y,
    left: n.x,
    bottom: r.y,
    right: r.x
  };
}
function C_(e) {
  return e === void 0 || e === 1;
}
function v5({ scale: e, scaleX: t, scaleY: n }) {
  return !C_(e) || !C_(t) || !C_(n);
}
function Qf(e) {
  return v5(e) || QB(e) || e.z || e.rotate || e.rotateX || e.rotateY || e.skewX || e.skewY;
}
function QB(e) {
  return Y6(e.x) || Y6(e.y);
}
function Y6(e) {
  return e && e !== "0%";
}
function kb(e, t, n) {
  const r = e - n, i = t * r;
  return n + i;
}
function W6(e, t, n, r, i) {
  return i !== void 0 && (e = kb(e, i, r)), kb(e, n, r) + t;
}
function b5(e, t = 0, n = 1, r, i) {
  e.min = W6(e.min, t, n, r, i), e.max = W6(e.max, t, n, r, i);
}
function JB(e, { x: t, y: n }) {
  b5(e.x, t.translate, t.scale, t.originPoint), b5(e.y, n.translate, n.scale, n.originPoint);
}
const Z6 = 0.999999999999, X6 = 1.0000000000001;
function _de(e, t, n, r = !1) {
  const i = n.length;
  if (!i)
    return;
  t.x = t.y = 1;
  let s, a;
  for (let u = 0; u < i; u++) {
    s = n[u], a = s.projectionDelta;
    const { visualElement: d } = s.options;
    d && d.props.style && d.props.style.display === "contents" || (r && s.options.layoutScroll && s.scroll && s !== s.root && hm(e, {
      x: -s.scroll.offset.x,
      y: -s.scroll.offset.y
    }), a && (t.x *= a.x.scale, t.y *= a.y.scale, JB(e, a)), r && Qf(s.latestValues) && hm(e, s.latestValues));
  }
  t.x < X6 && t.x > Z6 && (t.x = 1), t.y < X6 && t.y > Z6 && (t.y = 1);
}
function fm(e, t) {
  e.min = e.min + t, e.max = e.max + t;
}
function Q6(e, t, n, r, i = 0.5) {
  const s = yr(e.min, e.max, i);
  b5(e, t, n, s, r);
}
function hm(e, t) {
  Q6(e.x, t.x, t.scaleX, t.scale, t.originX), Q6(e.y, t.y, t.scaleY, t.scale, t.originY);
}
function e$(e, t) {
  return XB(wde(e.getBoundingClientRect(), t));
}
function Sde(e, t, n) {
  const r = e$(e, n), { scroll: i } = t;
  return i && (fm(r.x, i.offset.x), fm(r.y, i.offset.y)), r;
}
const J6 = () => ({
  translate: 0,
  scale: 1,
  origin: 0,
  originPoint: 0
}), pm = () => ({
  x: J6(),
  y: J6()
}), e8 = () => ({ min: 0, max: 0 }), mi = () => ({
  x: e8(),
  y: e8()
}), w5 = { current: null }, t$ = { current: !1 };
function Ede() {
  if (t$.current = !0, !!FT)
    if (window.matchMedia) {
      const e = window.matchMedia("(prefers-reduced-motion)"), t = () => w5.current = e.matches;
      e.addEventListener("change", t), t();
    } else
      w5.current = !1;
}
const Cde = /* @__PURE__ */ new WeakMap();
function kde(e, t, n) {
  for (const r in t) {
    const i = t[r], s = n[r];
    if (qi(i))
      e.addValue(r, i);
    else if (qi(s))
      e.addValue(r, wh(i, { owner: e }));
    else if (s !== i)
      if (e.hasValue(r)) {
        const a = e.getValue(r);
        a.liveStyle === !0 ? a.jump(i) : a.hasAnimated || a.set(i);
      } else {
        const a = e.getStaticValue(r);
        e.addValue(r, wh(a !== void 0 ? a : i, { owner: e }));
      }
  }
  for (const r in n)
    t[r] === void 0 && e.removeValue(r);
  return t;
}
const t8 = [
  "AnimationStart",
  "AnimationComplete",
  "Update",
  "BeforeLayoutMeasure",
  "LayoutMeasure",
  "LayoutAnimationStart",
  "LayoutAnimationComplete"
];
class Tde {
  /**
   * This method takes React props and returns found MotionValues. For example, HTML
   * MotionValues will be found within the style prop, whereas for Three.js within attribute arrays.
   *
   * This isn't an abstract method as it needs calling in the constructor, but it is
   * intended to be one.
   */
  scrapeMotionValuesFromProps(t, n, r) {
    return {};
  }
  constructor({ parent: t, props: n, presenceContext: r, reducedMotionConfig: i, blockInitialAnimation: s, visualState: a }, u = {}) {
    this.current = null, this.children = /* @__PURE__ */ new Set(), this.isVariantNode = !1, this.isControllingVariants = !1, this.shouldReduceMotion = null, this.values = /* @__PURE__ */ new Map(), this.KeyframeResolver = ij, this.features = {}, this.valueSubscriptions = /* @__PURE__ */ new Map(), this.prevMotionValues = {}, this.events = {}, this.propEventSubscriptions = {}, this.notifyUpdate = () => this.notify("Update", this.latestValues), this.render = () => {
      this.current && (this.triggerBuild(), this.renderInstance(this.current, this.renderState, this.props.style, this.projection));
    }, this.renderScheduledAt = 0, this.scheduleRender = () => {
      const x = da.now();
      this.renderScheduledAt < x && (this.renderScheduledAt = x, dr.render(this.render, !1, !0));
    };
    const { latestValues: d, renderState: f } = a;
    this.latestValues = d, this.baseTarget = { ...d }, this.initialValues = n.initial ? { ...d } : {}, this.renderState = f, this.parent = t, this.props = n, this.presenceContext = r, this.depth = t ? t.depth + 1 : 0, this.reducedMotionConfig = i, this.options = u, this.blockInitialAnimation = !!s, this.isControllingVariants = hw(n), this.isVariantNode = $B(n), this.isVariantNode && (this.variantChildren = /* @__PURE__ */ new Set()), this.manuallyAnimateOnMount = !!(t && t.current);
    const { willChange: h, ...m } = this.scrapeMotionValuesFromProps(n, {}, this);
    for (const x in m) {
      const b = m[x];
      d[x] !== void 0 && qi(b) && b.set(d[x]);
    }
  }
  mount(t) {
    var n;
    this.current = t, Cde.set(t, this), this.projection && !this.projection.instance && this.projection.mount(t), this.parent && this.isVariantNode && !this.isControllingVariants && (this.removeFromVariantTree = this.parent.addVariantChild(this)), this.values.forEach((r, i) => this.bindToMotionValue(i, r)), t$.current || Ede(), this.shouldReduceMotion = this.reducedMotionConfig === "never" ? !1 : this.reducedMotionConfig === "always" ? !0 : w5.current, (n = this.parent) == null || n.addChild(this), this.update(this.props, this.presenceContext);
  }
  unmount() {
    var t;
    this.projection && this.projection.unmount(), ec(this.notifyUpdate), ec(this.render), this.valueSubscriptions.forEach((n) => n()), this.valueSubscriptions.clear(), this.removeFromVariantTree && this.removeFromVariantTree(), (t = this.parent) == null || t.removeChild(this);
    for (const n in this.events)
      this.events[n].clear();
    for (const n in this.features) {
      const r = this.features[n];
      r && (r.unmount(), r.isMounted = !1);
    }
    this.current = null;
  }
  addChild(t) {
    this.children.add(t), this.enteringChildren ?? (this.enteringChildren = /* @__PURE__ */ new Set()), this.enteringChildren.add(t);
  }
  removeChild(t) {
    this.children.delete(t), this.enteringChildren && this.enteringChildren.delete(t);
  }
  bindToMotionValue(t, n) {
    this.valueSubscriptions.has(t) && this.valueSubscriptions.get(t)();
    const r = Qm.has(t);
    r && this.onBindTransform && this.onBindTransform();
    const i = n.on("change", (a) => {
      this.latestValues[t] = a, this.props.onUpdate && dr.preRender(this.notifyUpdate), r && this.projection && (this.projection.isTransformDirty = !0), this.scheduleRender();
    });
    let s;
    window.MotionCheckAppearSync && (s = window.MotionCheckAppearSync(this, t, n)), this.valueSubscriptions.set(t, () => {
      i(), s && s(), n.owner && n.stop();
    });
  }
  sortNodePosition(t) {
    return !this.current || !this.sortInstanceNodePosition || this.type !== t.type ? 0 : this.sortInstanceNodePosition(this.current, t.current);
  }
  updateFeatures() {
    let t = "animation";
    for (t in Pm) {
      const n = Pm[t];
      if (!n)
        continue;
      const { isEnabled: r, Feature: i } = n;
      if (!this.features[t] && i && r(this.props) && (this.features[t] = new i(this)), this.features[t]) {
        const s = this.features[t];
        s.isMounted ? s.update() : (s.mount(), s.isMounted = !0);
      }
    }
  }
  triggerBuild() {
    this.build(this.renderState, this.latestValues, this.props);
  }
  /**
   * Measure the current viewport box with or without transforms.
   * Only measures axis-aligned boxes, rotate and skew must be manually
   * removed with a re-render to work.
   */
  measureViewportBox() {
    return this.current ? this.measureInstanceViewportBox(this.current, this.props) : mi();
  }
  getStaticValue(t) {
    return this.latestValues[t];
  }
  setStaticValue(t, n) {
    this.latestValues[t] = n;
  }
  /**
   * Update the provided props. Ensure any newly-added motion values are
   * added to our map, old ones removed, and listeners updated.
   */
  update(t, n) {
    (t.transformTemplate || this.props.transformTemplate) && this.scheduleRender(), this.prevProps = this.props, this.props = t, this.prevPresenceContext = this.presenceContext, this.presenceContext = n;
    for (let r = 0; r < t8.length; r++) {
      const i = t8[r];
      this.propEventSubscriptions[i] && (this.propEventSubscriptions[i](), delete this.propEventSubscriptions[i]);
      const s = "on" + i, a = t[s];
      a && (this.propEventSubscriptions[i] = this.on(i, a));
    }
    this.prevMotionValues = kde(this, this.scrapeMotionValuesFromProps(t, this.prevProps, this), this.prevMotionValues), this.handleChildMotionValue && this.handleChildMotionValue();
  }
  getProps() {
    return this.props;
  }
  /**
   * Returns the variant definition with a given name.
   */
  getVariant(t) {
    return this.props.variants ? this.props.variants[t] : void 0;
  }
  /**
   * Returns the defined default transition on this component.
   */
  getDefaultTransition() {
    return this.props.transition;
  }
  getTransformPagePoint() {
    return this.props.transformPagePoint;
  }
  getClosestVariantNode() {
    return this.isVariantNode ? this : this.parent ? this.parent.getClosestVariantNode() : void 0;
  }
  /**
   * Add a child visual element to our set of children.
   */
  addVariantChild(t) {
    const n = this.getClosestVariantNode();
    if (n)
      return n.variantChildren && n.variantChildren.add(t), () => n.variantChildren.delete(t);
  }
  /**
   * Add a motion value and bind it to this visual element.
   */
  addValue(t, n) {
    const r = this.values.get(t);
    n !== r && (r && this.removeValue(t), this.bindToMotionValue(t, n), this.values.set(t, n), this.latestValues[t] = n.get());
  }
  /**
   * Remove a motion value and unbind any active subscriptions.
   */
  removeValue(t) {
    this.values.delete(t);
    const n = this.valueSubscriptions.get(t);
    n && (n(), this.valueSubscriptions.delete(t)), delete this.latestValues[t], this.removeValueFromRenderState(t, this.renderState);
  }
  /**
   * Check whether we have a motion value for this key
   */
  hasValue(t) {
    return this.values.has(t);
  }
  getValue(t, n) {
    if (this.props.values && this.props.values[t])
      return this.props.values[t];
    let r = this.values.get(t);
    return r === void 0 && n !== void 0 && (r = wh(n === null ? void 0 : n, { owner: this }), this.addValue(t, r)), r;
  }
  /**
   * If we're trying to animate to a previously unencountered value,
   * we need to check for it in our state and as a last resort read it
   * directly from the instance (which might have performance implications).
   */
  readValue(t, n) {
    let r = this.latestValues[t] !== void 0 || !this.current ? this.latestValues[t] : this.getBaseTargetFromProps(this.props, t) ?? this.readValueFromInstance(this.current, t, this.options);
    return r != null && (typeof r == "string" && (KL(r) || WL(r)) ? r = parseFloat(r) : !$ce(r) && Td.test(n) && (r = MB(t, n)), this.setBaseTarget(t, qi(r) ? r.get() : r)), qi(r) ? r.get() : r;
  }
  /**
   * Set the base target to later animate back to. This is currently
   * only hydrated on creation and when we first read a value.
   */
  setBaseTarget(t, n) {
    this.baseTarget[t] = n;
  }
  /**
   * Find the base target for a value thats been removed from all animation
   * props.
   */
  getBaseTarget(t) {
    var s;
    const { initial: n } = this.props;
    let r;
    if (typeof n == "string" || typeof n == "object") {
      const a = mj(this.props, n, (s = this.presenceContext) == null ? void 0 : s.custom);
      a && (r = a[t]);
    }
    if (n && r !== void 0)
      return r;
    const i = this.getBaseTargetFromProps(this.props, t);
    return i !== void 0 && !qi(i) ? i : this.initialValues[t] !== void 0 && r === void 0 ? void 0 : this.baseTarget[t];
  }
  on(t, n) {
    return this.events[t] || (this.events[t] = new KT()), this.events[t].add(n);
  }
  notify(t, ...n) {
    this.events[t] && this.events[t].notify(...n);
  }
  scheduleRenderMicrotask() {
    oj.render(this.render);
  }
}
class n$ extends Tde {
  constructor() {
    super(...arguments), this.KeyframeResolver = kce;
  }
  sortInstanceNodePosition(t, n) {
    return t.compareDocumentPosition(n) & 2 ? 1 : -1;
  }
  getBaseTargetFromProps(t, n) {
    return t.style ? t.style[n] : void 0;
  }
  removeValueFromRenderState(t, { vars: n, style: r }) {
    delete n[t], delete r[t];
  }
  handleChildMotionValue() {
    this.childSubscription && (this.childSubscription(), delete this.childSubscription);
    const { children: t } = this.props;
    qi(t) && (this.childSubscription = t.on("change", (n) => {
      this.current && (this.current.textContent = `${n}`);
    }));
  }
}
function r$(e, { style: t, vars: n }, r, i) {
  const s = e.style;
  let a;
  for (a in t)
    s[a] = t[a];
  i == null || i.applyProjectionStyles(s, r);
  for (a in n)
    s.setProperty(a, n[a]);
}
function jde(e) {
  return window.getComputedStyle(e);
}
class Ade extends n$ {
  constructor() {
    super(...arguments), this.type = "html", this.renderInstance = r$;
  }
  readValueFromInstance(t, n) {
    var r;
    if (Qm.has(n))
      return (r = this.projection) != null && r.isProjecting ? d5(n) : Vue(t, n);
    {
      const i = jde(t), s = (uB(n) ? i.getPropertyValue(n) : i[n]) || 0;
      return typeof s == "string" ? s.trim() : s;
    }
  }
  measureInstanceViewportBox(t, { transformPagePoint: n }) {
    return e$(t, n);
  }
  build(t, n, r) {
    fj(t, n, r.transformTemplate);
  }
  scrapeMotionValuesFromProps(t, n, r) {
    return gj(t, n, r);
  }
}
const i$ = /* @__PURE__ */ new Set([
  "baseFrequency",
  "diffuseConstant",
  "kernelMatrix",
  "kernelUnitLength",
  "keySplines",
  "keyTimes",
  "limitingConeAngle",
  "markerHeight",
  "markerWidth",
  "numOctaves",
  "targetX",
  "targetY",
  "surfaceScale",
  "specularConstant",
  "specularExponent",
  "stdDeviation",
  "tableValues",
  "viewBox",
  "gradientTransform",
  "pathLength",
  "startOffset",
  "textLength",
  "lengthAdjust"
]);
function Nde(e, t, n, r) {
  r$(e, t, void 0, r);
  for (const i in t.attrs)
    e.setAttribute(i$.has(i) ? i : yj(i), t.attrs[i]);
}
class Rde extends n$ {
  constructor() {
    super(...arguments), this.type = "svg", this.isSVGTag = !1, this.measureInstanceViewportBox = mi;
  }
  getBaseTargetFromProps(t, n) {
    return t[n];
  }
  readValueFromInstance(t, n) {
    if (Qm.has(n)) {
      const r = RB(n);
      return r && r.default || 0;
    }
    return n = i$.has(n) ? n : yj(n), t.getAttribute(n);
  }
  scrapeMotionValuesFromProps(t, n, r) {
    return KB(t, n, r);
  }
  build(t, n, r) {
    UB(t, n, this.isSVGTag, r.transformTemplate, r.style);
  }
  renderInstance(t, n, r, i) {
    Nde(t, n, r, i);
  }
  mount(t) {
    this.isSVGTag = VB(t.tagName), super.mount(t);
  }
}
const Mde = (e, t) => pj(e) ? new Rde(t) : new Ade(t, {
  allowProjection: e !== I.Fragment
});
function wm(e, t, n) {
  const r = e.getProps();
  return mj(r, t, n !== void 0 ? n : r.custom, e);
}
const _5 = (e) => Array.isArray(e);
function Ode(e, t, n) {
  e.hasValue(t) ? e.getValue(t).set(n) : e.addValue(t, wh(n));
}
function Dde(e) {
  return _5(e) ? e[e.length - 1] || 0 : e;
}
function zde(e, t) {
  const n = wm(e, t);
  let { transitionEnd: r = {}, transition: i = {}, ...s } = n || {};
  s = { ...s, ...r };
  for (const a in s) {
    const u = Dde(s[a]);
    Ode(e, a, u);
  }
}
function Pde(e) {
  return !!(qi(e) && e.add);
}
function S5(e, t) {
  const n = e.getValue("willChange");
  if (Pde(n))
    return n.add(t);
  if (!n && Ju.WillChange) {
    const r = new Ju.WillChange("auto");
    e.addValue("willChange", r), r.add(t);
  }
}
function s$(e) {
  return e.props[YB];
}
const Ide = (e) => e !== null;
function Lde(e, { repeat: t, repeatType: n = "loop" }, r) {
  const i = e.filter(Ide), s = t && n !== "loop" && t % 2 === 1 ? 0 : i.length - 1;
  return i[s];
}
const Bde = {
  type: "spring",
  stiffness: 500,
  damping: 25,
  restSpeed: 10
}, $de = (e) => ({
  type: "spring",
  stiffness: 550,
  damping: e === 0 ? 2 * Math.sqrt(550) : 30,
  restSpeed: 10
}), qde = {
  type: "keyframes",
  duration: 0.8
}, Fde = {
  type: "keyframes",
  ease: [0.25, 0.1, 0.35, 1],
  duration: 0.3
}, Ude = (e, { keyframes: t }) => t.length > 2 ? qde : Qm.has(e) ? e.startsWith("scale") ? $de(t[1]) : Bde : Fde;
function Hde({ when: e, delay: t, delayChildren: n, staggerChildren: r, staggerDirection: i, repeat: s, repeatType: a, repeatDelay: u, from: d, elapsed: f, ...h }) {
  return !!Object.keys(h).length;
}
const xj = (e, t, n, r = {}, i, s) => (a) => {
  const u = sj(r, e) || {}, d = u.delay || r.delay || 0;
  let { elapsed: f = 0 } = r;
  f = f - /* @__PURE__ */ eu(d);
  const h = {
    keyframes: Array.isArray(n) ? n : [null, n],
    ease: "easeOut",
    velocity: t.getVelocity(),
    ...u,
    delay: -f,
    onUpdate: (x) => {
      t.set(x), u.onUpdate && u.onUpdate(x);
    },
    onComplete: () => {
      a(), u.onComplete && u.onComplete();
    },
    name: e,
    motionValue: t,
    element: s ? void 0 : i
  };
  Hde(u) || Object.assign(h, Ude(e, h)), h.duration && (h.duration = /* @__PURE__ */ eu(h.duration)), h.repeatDelay && (h.repeatDelay = /* @__PURE__ */ eu(h.repeatDelay)), h.from !== void 0 && (h.keyframes[0] = h.from);
  let m = !1;
  if ((h.type === !1 || h.duration === 0 && !h.repeatDelay) && (g5(h), h.delay === 0 && (m = !0)), (Ju.instantAnimations || Ju.skipAnimations) && (m = !0, g5(h), h.delay = 0), h.allowFlatten = !u.type && !u.ease, m && !s && t.get() !== void 0) {
    const x = Lde(h.keyframes, u);
    if (x !== void 0) {
      dr.update(() => {
        h.onUpdate(x), h.onComplete();
      });
      return;
    }
  }
  return u.isSync ? new rj(h) : new pce(h);
};
function Vde({ protectedKeys: e, needsAnimating: t }, n) {
  const r = e.hasOwnProperty(n) && t[n] !== !0;
  return t[n] = !1, r;
}
function a$(e, t, { delay: n = 0, transitionOverride: r, type: i } = {}) {
  let { transition: s = e.getDefaultTransition(), transitionEnd: a, ...u } = t;
  r && (s = r);
  const d = [], f = i && e.animationState && e.animationState.getState()[i];
  for (const h in u) {
    const m = e.getValue(h, e.latestValues[h] ?? null), x = u[h];
    if (x === void 0 || f && Vde(f, h))
      continue;
    const b = {
      delay: n,
      ...sj(s || {}, h)
    }, w = m.get();
    if (w !== void 0 && !m.isAnimating && !Array.isArray(x) && x === w && !b.velocity)
      continue;
    let S = !1;
    if (window.MotionHandoffAnimation) {
      const T = s$(e);
      if (T) {
        const R = window.MotionHandoffAnimation(T, h, dr);
        R !== null && (b.startTime = R, S = !0);
      }
    }
    S5(e, h), m.start(xj(h, m, x, e.shouldReduceMotion && jB.has(h) ? { type: !1 } : b, e, S));
    const C = m.animation;
    C && d.push(C);
  }
  return a && Promise.all(d).then(() => {
    dr.update(() => {
      a && zde(e, a);
    });
  }), d;
}
function o$(e, t, n, r = 0, i = 1) {
  const s = Array.from(e).sort((f, h) => f.sortNodePosition(h)).indexOf(t), a = e.size, u = (a - 1) * r;
  return typeof n == "function" ? n(s, a) : i === 1 ? s * r : u - s * r;
}
function E5(e, t, n = {}) {
  var d;
  const r = wm(e, t, n.type === "exit" ? (d = e.presenceContext) == null ? void 0 : d.custom : void 0);
  let { transition: i = e.getDefaultTransition() || {} } = r || {};
  n.transitionOverride && (i = n.transitionOverride);
  const s = r ? () => Promise.all(a$(e, r, n)) : () => Promise.resolve(), a = e.variantChildren && e.variantChildren.size ? (f = 0) => {
    const { delayChildren: h = 0, staggerChildren: m, staggerDirection: x } = i;
    return Gde(e, t, f, h, m, x, n);
  } : () => Promise.resolve(), { when: u } = i;
  if (u) {
    const [f, h] = u === "beforeChildren" ? [s, a] : [a, s];
    return f().then(() => h());
  } else
    return Promise.all([s(), a(n.delay)]);
}
function Gde(e, t, n = 0, r = 0, i = 0, s = 1, a) {
  const u = [];
  for (const d of e.variantChildren)
    d.notify("AnimationStart", t), u.push(E5(d, t, {
      ...a,
      delay: n + (typeof r == "function" ? 0 : r) + o$(e.variantChildren, d, r, i, s)
    }).then(() => d.notify("AnimationComplete", t)));
  return Promise.all(u);
}
function Kde(e, t, n = {}) {
  e.notify("AnimationStart", t);
  let r;
  if (Array.isArray(t)) {
    const i = t.map((s) => E5(e, s, n));
    r = Promise.all(i);
  } else if (typeof t == "string")
    r = E5(e, t, n);
  else {
    const i = typeof t == "function" ? wm(e, t, n.custom) : t;
    r = Promise.all(a$(e, i, n));
  }
  return r.then(() => {
    e.notify("AnimationComplete", t);
  });
}
function l$(e, t) {
  if (!Array.isArray(t))
    return !1;
  const n = t.length;
  if (n !== e.length)
    return !1;
  for (let r = 0; r < n; r++)
    if (t[r] !== e[r])
      return !1;
  return !0;
}
const Yde = dj.length;
function u$(e) {
  if (!e)
    return;
  if (!e.isControllingVariants) {
    const n = e.parent ? u$(e.parent) || {} : {};
    return e.props.initial !== void 0 && (n.initial = e.props.initial), n;
  }
  const t = {};
  for (let n = 0; n < Yde; n++) {
    const r = dj[n], i = e.props[r];
    (Dy(i) || i === !1) && (t[r] = i);
  }
  return t;
}
const Wde = [...cj].reverse(), Zde = cj.length;
function Xde(e) {
  return (t) => Promise.all(t.map(({ animation: n, options: r }) => Kde(e, n, r)));
}
function Qde(e) {
  let t = Xde(e), n = n8(), r = !0;
  const i = (d) => (f, h) => {
    var x;
    const m = wm(e, h, d === "exit" ? (x = e.presenceContext) == null ? void 0 : x.custom : void 0);
    if (m) {
      const { transition: b, transitionEnd: w, ...S } = m;
      f = { ...f, ...S, ...w };
    }
    return f;
  };
  function s(d) {
    t = d(e);
  }
  function a(d) {
    const { props: f } = e, h = u$(e.parent) || {}, m = [], x = /* @__PURE__ */ new Set();
    let b = {}, w = 1 / 0;
    for (let C = 0; C < Zde; C++) {
      const T = Wde[C], R = n[T], N = f[T] !== void 0 ? f[T] : h[T], M = Dy(N), P = T === d ? R.isActive : null;
      P === !1 && (w = C);
      let D = N === h[T] && N !== f[T] && M;
      if (D && r && e.manuallyAnimateOnMount && (D = !1), R.protectedKeys = { ...b }, // If it isn't active and hasn't *just* been set as inactive
      !R.isActive && P === null || // If we didn't and don't have any defined prop for this animation type
      !N && !R.prevProp || // Or if the prop doesn't define an animation
      fw(N) || typeof N == "boolean")
        continue;
      const q = Jde(R.prevProp, N);
      let Y = q || // If we're making this variant active, we want to always make it active
      T === d && R.isActive && !D && M || // If we removed a higher-priority variant (i is in reverse order)
      C > w && M, te = !1;
      const V = Array.isArray(N) ? N : [N];
      let $ = V.reduce(i(T), {});
      P === !1 && ($ = {});
      const { prevResolvedValues: G = {} } = R, le = {
        ...G,
        ...$
      }, Z = (ce) => {
        Y = !0, x.has(ce) && (te = !0, x.delete(ce)), R.needsAnimating[ce] = !0;
        const pe = e.getValue(ce);
        pe && (pe.liveStyle = !1);
      };
      for (const ce in le) {
        const pe = $[ce], de = G[ce];
        if (b.hasOwnProperty(ce))
          continue;
        let H = !1;
        _5(pe) && _5(de) ? H = !l$(pe, de) : H = pe !== de, H ? pe != null ? Z(ce) : x.add(ce) : pe !== void 0 && x.has(ce) ? Z(ce) : R.protectedKeys[ce] = !0;
      }
      R.prevProp = N, R.prevResolvedValues = $, R.isActive && (b = { ...b, ...$ }), r && e.blockInitialAnimation && (Y = !1);
      const oe = D && q;
      Y && (!oe || te) && m.push(...V.map((ce) => {
        const pe = { type: T };
        if (typeof ce == "string" && r && !oe && e.manuallyAnimateOnMount && e.parent) {
          const { parent: de } = e, H = wm(de, ce);
          if (de.enteringChildren && H) {
            const { delayChildren: J } = H.transition || {};
            pe.delay = o$(de.enteringChildren, e, J);
          }
        }
        return {
          animation: ce,
          options: pe
        };
      }));
    }
    if (x.size) {
      const C = {};
      if (typeof f.initial != "boolean") {
        const T = wm(e, Array.isArray(f.initial) ? f.initial[0] : f.initial);
        T && T.transition && (C.transition = T.transition);
      }
      x.forEach((T) => {
        const R = e.getBaseTarget(T), N = e.getValue(T);
        N && (N.liveStyle = !0), C[T] = R ?? null;
      }), m.push({ animation: C });
    }
    let S = !!m.length;
    return r && (f.initial === !1 || f.initial === f.animate) && !e.manuallyAnimateOnMount && (S = !1), r = !1, S ? t(m) : Promise.resolve();
  }
  function u(d, f) {
    var m;
    if (n[d].isActive === f)
      return Promise.resolve();
    (m = e.variantChildren) == null || m.forEach((x) => {
      var b;
      return (b = x.animationState) == null ? void 0 : b.setActive(d, f);
    }), n[d].isActive = f;
    const h = a(d);
    for (const x in n)
      n[x].protectedKeys = {};
    return h;
  }
  return {
    animateChanges: a,
    setActive: u,
    setAnimateFunction: s,
    getState: () => n,
    reset: () => {
      n = n8();
    }
  };
}
function Jde(e, t) {
  return typeof t == "string" ? t !== e : Array.isArray(t) ? !l$(t, e) : !1;
}
function Zf(e = !1) {
  return {
    isActive: e,
    protectedKeys: {},
    needsAnimating: {},
    prevResolvedValues: {}
  };
}
function n8() {
  return {
    animate: Zf(!0),
    whileInView: Zf(),
    whileHover: Zf(),
    whileTap: Zf(),
    whileDrag: Zf(),
    whileFocus: Zf(),
    exit: Zf()
  };
}
class Md {
  constructor(t) {
    this.isMounted = !1, this.node = t;
  }
  update() {
  }
}
class efe extends Md {
  /**
   * We dynamically generate the AnimationState manager as it contains a reference
   * to the underlying animation library. We only want to load that if we load this,
   * so people can optionally code split it out using the `m` component.
   */
  constructor(t) {
    super(t), t.animationState || (t.animationState = Qde(t));
  }
  updateAnimationControlsSubscription() {
    const { animate: t } = this.node.getProps();
    fw(t) && (this.unmountControls = t.subscribe(this.node));
  }
  /**
   * Subscribe any provided AnimationControls to the component's VisualElement
   */
  mount() {
    this.updateAnimationControlsSubscription();
  }
  update() {
    const { animate: t } = this.node.getProps(), { animate: n } = this.node.prevProps || {};
    t !== n && this.updateAnimationControlsSubscription();
  }
  unmount() {
    var t;
    this.node.animationState.reset(), (t = this.unmountControls) == null || t.call(this);
  }
}
let tfe = 0;
class nfe extends Md {
  constructor() {
    super(...arguments), this.id = tfe++;
  }
  update() {
    if (!this.node.presenceContext)
      return;
    const { isPresent: t, onExitComplete: n } = this.node.presenceContext, { isPresent: r } = this.node.prevPresenceContext || {};
    if (!this.node.animationState || t === r)
      return;
    const i = this.node.animationState.setActive("exit", !t);
    n && !t && i.then(() => {
      n(this.id);
    });
  }
  mount() {
    const { register: t, onExitComplete: n } = this.node.presenceContext || {};
    n && n(this.id), t && (this.unmount = t(this.id));
  }
  unmount() {
  }
}
const rfe = {
  animation: {
    Feature: efe
  },
  exit: {
    Feature: nfe
  }
};
function zy(e, t, n, r = { passive: !0 }) {
  return e.addEventListener(t, n, r), () => e.removeEventListener(t, n);
}
function lx(e) {
  return {
    point: {
      x: e.pageX,
      y: e.pageY
    }
  };
}
const ife = (e) => (t) => lj(t) && e(t, lx(t));
function gy(e, t, n, r) {
  return zy(e, t, ife(n), r);
}
const c$ = 1e-4, sfe = 1 - c$, afe = 1 + c$, d$ = 0.01, ofe = 0 - d$, lfe = 0 + d$;
function zs(e) {
  return e.max - e.min;
}
function ufe(e, t, n) {
  return Math.abs(e - t) <= n;
}
function r8(e, t, n, r = 0.5) {
  e.origin = r, e.originPoint = yr(t.min, t.max, e.origin), e.scale = zs(n) / zs(t), e.translate = yr(n.min, n.max, e.origin) - e.originPoint, (e.scale >= sfe && e.scale <= afe || isNaN(e.scale)) && (e.scale = 1), (e.translate >= ofe && e.translate <= lfe || isNaN(e.translate)) && (e.translate = 0);
}
function yy(e, t, n, r) {
  r8(e.x, t.x, n.x, r ? r.originX : void 0), r8(e.y, t.y, n.y, r ? r.originY : void 0);
}
function i8(e, t, n) {
  e.min = n.min + t.min, e.max = e.min + zs(t);
}
function cfe(e, t, n) {
  i8(e.x, t.x, n.x), i8(e.y, t.y, n.y);
}
function s8(e, t, n) {
  e.min = t.min - n.min, e.max = e.min + zs(t);
}
function Tb(e, t, n) {
  s8(e.x, t.x, n.x), s8(e.y, t.y, n.y);
}
function io(e) {
  return [e("x"), e("y")];
}
const f$ = ({ current: e }) => e ? e.ownerDocument.defaultView : null, a8 = (e, t) => Math.abs(e - t);
function dfe(e, t) {
  const n = a8(e.x, t.x), r = a8(e.y, t.y);
  return Math.sqrt(n ** 2 + r ** 2);
}
class h$ {
  constructor(t, n, { transformPagePoint: r, contextWindow: i = window, dragSnapToOrigin: s = !1, distanceThreshold: a = 3 } = {}) {
    if (this.startEvent = null, this.lastMoveEvent = null, this.lastMoveEventInfo = null, this.handlers = {}, this.contextWindow = window, this.updatePoint = () => {
      if (!(this.lastMoveEvent && this.lastMoveEventInfo))
        return;
      const x = T_(this.lastMoveEventInfo, this.history), b = this.startEvent !== null, w = dfe(x.offset, { x: 0, y: 0 }) >= this.distanceThreshold;
      if (!b && !w)
        return;
      const { point: S } = x, { timestamp: C } = $i;
      this.history.push({ ...S, timestamp: C });
      const { onStart: T, onMove: R } = this.handlers;
      b || (T && T(this.lastMoveEvent, x), this.startEvent = this.lastMoveEvent), R && R(this.lastMoveEvent, x);
    }, this.handlePointerMove = (x, b) => {
      this.lastMoveEvent = x, this.lastMoveEventInfo = k_(b, this.transformPagePoint), dr.update(this.updatePoint, !0);
    }, this.handlePointerUp = (x, b) => {
      this.end();
      const { onEnd: w, onSessionEnd: S, resumeAnimation: C } = this.handlers;
      if (this.dragSnapToOrigin && C && C(), !(this.lastMoveEvent && this.lastMoveEventInfo))
        return;
      const T = T_(x.type === "pointercancel" ? this.lastMoveEventInfo : k_(b, this.transformPagePoint), this.history);
      this.startEvent && w && w(x, T), S && S(x, T);
    }, !lj(t))
      return;
    this.dragSnapToOrigin = s, this.handlers = n, this.transformPagePoint = r, this.distanceThreshold = a, this.contextWindow = i || window;
    const u = lx(t), d = k_(u, this.transformPagePoint), { point: f } = d, { timestamp: h } = $i;
    this.history = [{ ...f, timestamp: h }];
    const { onSessionStart: m } = n;
    m && m(t, T_(d, this.history)), this.removeListeners = sx(gy(this.contextWindow, "pointermove", this.handlePointerMove), gy(this.contextWindow, "pointerup", this.handlePointerUp), gy(this.contextWindow, "pointercancel", this.handlePointerUp));
  }
  updateHandlers(t) {
    this.handlers = t;
  }
  end() {
    this.removeListeners && this.removeListeners(), ec(this.updatePoint);
  }
}
function k_(e, t) {
  return t ? { point: t(e.point) } : e;
}
function o8(e, t) {
  return { x: e.x - t.x, y: e.y - t.y };
}
function T_({ point: e }, t) {
  return {
    point: e,
    delta: o8(e, p$(t)),
    offset: o8(e, ffe(t)),
    velocity: hfe(t, 0.1)
  };
}
function ffe(e) {
  return e[0];
}
function p$(e) {
  return e[e.length - 1];
}
function hfe(e, t) {
  if (e.length < 2)
    return { x: 0, y: 0 };
  let n = e.length - 1, r = null;
  const i = p$(e);
  for (; n >= 0 && (r = e[n], !(i.timestamp - r.timestamp > /* @__PURE__ */ eu(t))); )
    n--;
  if (!r)
    return { x: 0, y: 0 };
  const s = /* @__PURE__ */ oo(i.timestamp - r.timestamp);
  if (s === 0)
    return { x: 0, y: 0 };
  const a = {
    x: (i.x - r.x) / s,
    y: (i.y - r.y) / s
  };
  return a.x === 1 / 0 && (a.x = 0), a.y === 1 / 0 && (a.y = 0), a;
}
function pfe(e, { min: t, max: n }, r) {
  return t !== void 0 && e < t ? e = r ? yr(t, e, r.min) : Math.max(e, t) : n !== void 0 && e > n && (e = r ? yr(n, e, r.max) : Math.min(e, n)), e;
}
function l8(e, t, n) {
  return {
    min: t !== void 0 ? e.min + t : void 0,
    max: n !== void 0 ? e.max + n - (e.max - e.min) : void 0
  };
}
function mfe(e, { top: t, left: n, bottom: r, right: i }) {
  return {
    x: l8(e.x, n, i),
    y: l8(e.y, t, r)
  };
}
function u8(e, t) {
  let n = t.min - e.min, r = t.max - e.max;
  return t.max - t.min < e.max - e.min && ([n, r] = [r, n]), { min: n, max: r };
}
function gfe(e, t) {
  return {
    x: u8(e.x, t.x),
    y: u8(e.y, t.y)
  };
}
function yfe(e, t) {
  let n = 0.5;
  const r = zs(e), i = zs(t);
  return i > r ? n = /* @__PURE__ */ Ry(t.min, t.max - r, e.min) : r > i && (n = /* @__PURE__ */ Ry(e.min, e.max - i, t.min)), Qu(0, 1, n);
}
function xfe(e, t) {
  const n = {};
  return t.min !== void 0 && (n.min = t.min - e.min), t.max !== void 0 && (n.max = t.max - e.min), n;
}
const C5 = 0.35;
function vfe(e = C5) {
  return e === !1 ? e = 0 : e === !0 && (e = C5), {
    x: c8(e, "left", "right"),
    y: c8(e, "top", "bottom")
  };
}
function c8(e, t, n) {
  return {
    min: d8(e, t),
    max: d8(e, n)
  };
}
function d8(e, t) {
  return typeof e == "number" ? e : e[t] || 0;
}
const bfe = /* @__PURE__ */ new WeakMap();
class wfe {
  constructor(t) {
    this.openDragLock = null, this.isDragging = !1, this.currentDirection = null, this.originPoint = { x: 0, y: 0 }, this.constraints = !1, this.hasMutatedConstraints = !1, this.elastic = mi(), this.latestPointerEvent = null, this.latestPanInfo = null, this.visualElement = t;
  }
  start(t, { snapToCursor: n = !1, distanceThreshold: r } = {}) {
    const { presenceContext: i } = this.visualElement;
    if (i && i.isPresent === !1)
      return;
    const s = (m) => {
      const { dragSnapToOrigin: x } = this.getProps();
      x ? this.pauseAnimation() : this.stopAnimation(), n && this.snapToCursor(lx(m).point);
    }, a = (m, x) => {
      const { drag: b, dragPropagation: w, onDragStart: S } = this.getProps();
      if (b && !w && (this.openDragLock && this.openDragLock(), this.openDragLock = Rce(b), !this.openDragLock))
        return;
      this.latestPointerEvent = m, this.latestPanInfo = x, this.isDragging = !0, this.currentDirection = null, this.resolveConstraints(), this.visualElement.projection && (this.visualElement.projection.isAnimationBlocked = !0, this.visualElement.projection.target = void 0), io((T) => {
        let R = this.getAxisMotionValue(T).get() || 0;
        if (tu.test(R)) {
          const { projection: N } = this.visualElement;
          if (N && N.layout) {
            const M = N.layout.layoutBox[T];
            M && (R = zs(M) * (parseFloat(R) / 100));
          }
        }
        this.originPoint[T] = R;
      }), S && dr.postRender(() => S(m, x)), S5(this.visualElement, "transform");
      const { animationState: C } = this.visualElement;
      C && C.setActive("whileDrag", !0);
    }, u = (m, x) => {
      this.latestPointerEvent = m, this.latestPanInfo = x;
      const { dragPropagation: b, dragDirectionLock: w, onDirectionLock: S, onDrag: C } = this.getProps();
      if (!b && !this.openDragLock)
        return;
      const { offset: T } = x;
      if (w && this.currentDirection === null) {
        this.currentDirection = _fe(T), this.currentDirection !== null && S && S(this.currentDirection);
        return;
      }
      this.updateAxis("x", x.point, T), this.updateAxis("y", x.point, T), this.visualElement.render(), C && C(m, x);
    }, d = (m, x) => {
      this.latestPointerEvent = m, this.latestPanInfo = x, this.stop(m, x), this.latestPointerEvent = null, this.latestPanInfo = null;
    }, f = () => io((m) => {
      var x;
      return this.getAnimationState(m) === "paused" && ((x = this.getAxisMotionValue(m).animation) == null ? void 0 : x.play());
    }), { dragSnapToOrigin: h } = this.getProps();
    this.panSession = new h$(t, {
      onSessionStart: s,
      onStart: a,
      onMove: u,
      onSessionEnd: d,
      resumeAnimation: f
    }, {
      transformPagePoint: this.visualElement.getTransformPagePoint(),
      dragSnapToOrigin: h,
      distanceThreshold: r,
      contextWindow: f$(this.visualElement)
    });
  }
  /**
   * @internal
   */
  stop(t, n) {
    const r = t || this.latestPointerEvent, i = n || this.latestPanInfo, s = this.isDragging;
    if (this.cancel(), !s || !i || !r)
      return;
    const { velocity: a } = i;
    this.startAnimation(a);
    const { onDragEnd: u } = this.getProps();
    u && dr.postRender(() => u(r, i));
  }
  /**
   * @internal
   */
  cancel() {
    this.isDragging = !1;
    const { projection: t, animationState: n } = this.visualElement;
    t && (t.isAnimationBlocked = !1), this.panSession && this.panSession.end(), this.panSession = void 0;
    const { dragPropagation: r } = this.getProps();
    !r && this.openDragLock && (this.openDragLock(), this.openDragLock = null), n && n.setActive("whileDrag", !1);
  }
  updateAxis(t, n, r) {
    const { drag: i } = this.getProps();
    if (!r || !w1(t, i, this.currentDirection))
      return;
    const s = this.getAxisMotionValue(t);
    let a = this.originPoint[t] + r[t];
    this.constraints && this.constraints[t] && (a = pfe(a, this.constraints[t], this.elastic[t])), s.set(a);
  }
  resolveConstraints() {
    var s;
    const { dragConstraints: t, dragElastic: n } = this.getProps(), r = this.visualElement.projection && !this.visualElement.projection.layout ? this.visualElement.projection.measure(!1) : (s = this.visualElement.projection) == null ? void 0 : s.layout, i = this.constraints;
    t && dm(t) ? this.constraints || (this.constraints = this.resolveRefConstraints()) : t && r ? this.constraints = mfe(r.layoutBox, t) : this.constraints = !1, this.elastic = vfe(n), i !== this.constraints && r && this.constraints && !this.hasMutatedConstraints && io((a) => {
      this.constraints !== !1 && this.getAxisMotionValue(a) && (this.constraints[a] = xfe(r.layoutBox[a], this.constraints[a]));
    });
  }
  resolveRefConstraints() {
    const { dragConstraints: t, onMeasureDragConstraints: n } = this.getProps();
    if (!t || !dm(t))
      return !1;
    const r = t.current, { projection: i } = this.visualElement;
    if (!i || !i.layout)
      return !1;
    const s = Sde(r, i.root, this.visualElement.getTransformPagePoint());
    let a = gfe(i.layout.layoutBox, s);
    if (n) {
      const u = n(bde(a));
      this.hasMutatedConstraints = !!u, u && (a = XB(u));
    }
    return a;
  }
  startAnimation(t) {
    const { drag: n, dragMomentum: r, dragElastic: i, dragTransition: s, dragSnapToOrigin: a, onDragTransitionEnd: u } = this.getProps(), d = this.constraints || {}, f = io((h) => {
      if (!w1(h, n, this.currentDirection))
        return;
      let m = d && d[h] || {};
      a && (m = { min: 0, max: 0 });
      const x = i ? 200 : 1e6, b = i ? 40 : 1e7, w = {
        type: "inertia",
        velocity: r ? t[h] : 0,
        bounceStiffness: x,
        bounceDamping: b,
        timeConstant: 750,
        restDelta: 1,
        restSpeed: 10,
        ...s,
        ...m
      };
      return this.startAxisValueAnimation(h, w);
    });
    return Promise.all(f).then(u);
  }
  startAxisValueAnimation(t, n) {
    const r = this.getAxisMotionValue(t);
    return S5(this.visualElement, t), r.start(xj(t, r, 0, n, this.visualElement, !1));
  }
  stopAnimation() {
    io((t) => this.getAxisMotionValue(t).stop());
  }
  pauseAnimation() {
    io((t) => {
      var n;
      return (n = this.getAxisMotionValue(t).animation) == null ? void 0 : n.pause();
    });
  }
  getAnimationState(t) {
    var n;
    return (n = this.getAxisMotionValue(t).animation) == null ? void 0 : n.state;
  }
  /**
   * Drag works differently depending on which props are provided.
   *
   * - If _dragX and _dragY are provided, we output the gesture delta directly to those motion values.
   * - Otherwise, we apply the delta to the x/y motion values.
   */
  getAxisMotionValue(t) {
    const n = `_drag${t.toUpperCase()}`, r = this.visualElement.getProps(), i = r[n];
    return i || this.visualElement.getValue(t, (r.initial ? r.initial[t] : void 0) || 0);
  }
  snapToCursor(t) {
    io((n) => {
      const { drag: r } = this.getProps();
      if (!w1(n, r, this.currentDirection))
        return;
      const { projection: i } = this.visualElement, s = this.getAxisMotionValue(n);
      if (i && i.layout) {
        const { min: a, max: u } = i.layout.layoutBox[n];
        s.set(t[n] - yr(a, u, 0.5));
      }
    });
  }
  /**
   * When the viewport resizes we want to check if the measured constraints
   * have changed and, if so, reposition the element within those new constraints
   * relative to where it was before the resize.
   */
  scalePositionWithinConstraints() {
    if (!this.visualElement.current)
      return;
    const { drag: t, dragConstraints: n } = this.getProps(), { projection: r } = this.visualElement;
    if (!dm(n) || !r || !this.constraints)
      return;
    this.stopAnimation();
    const i = { x: 0, y: 0 };
    io((a) => {
      const u = this.getAxisMotionValue(a);
      if (u && this.constraints !== !1) {
        const d = u.get();
        i[a] = yfe({ min: d, max: d }, this.constraints[a]);
      }
    });
    const { transformTemplate: s } = this.visualElement.getProps();
    this.visualElement.current.style.transform = s ? s({}, "") : "none", r.root && r.root.updateScroll(), r.updateLayout(), this.resolveConstraints(), io((a) => {
      if (!w1(a, t, null))
        return;
      const u = this.getAxisMotionValue(a), { min: d, max: f } = this.constraints[a];
      u.set(yr(d, f, i[a]));
    });
  }
  addListeners() {
    if (!this.visualElement.current)
      return;
    bfe.set(this.visualElement, this);
    const t = this.visualElement.current, n = gy(t, "pointerdown", (d) => {
      const { drag: f, dragListener: h = !0 } = this.getProps();
      f && h && this.start(d);
    }), r = () => {
      const { dragConstraints: d } = this.getProps();
      dm(d) && d.current && (this.constraints = this.resolveRefConstraints());
    }, { projection: i } = this.visualElement, s = i.addEventListener("measure", r);
    i && !i.layout && (i.root && i.root.updateScroll(), i.updateLayout()), dr.read(r);
    const a = zy(window, "resize", () => this.scalePositionWithinConstraints()), u = i.addEventListener("didUpdate", (({ delta: d, hasLayoutChanged: f }) => {
      this.isDragging && f && (io((h) => {
        const m = this.getAxisMotionValue(h);
        m && (this.originPoint[h] += d[h].translate, m.set(m.get() + d[h].translate));
      }), this.visualElement.render());
    }));
    return () => {
      a(), n(), s(), u && u();
    };
  }
  getProps() {
    const t = this.visualElement.getProps(), { drag: n = !1, dragDirectionLock: r = !1, dragPropagation: i = !1, dragConstraints: s = !1, dragElastic: a = C5, dragMomentum: u = !0 } = t;
    return {
      ...t,
      drag: n,
      dragDirectionLock: r,
      dragPropagation: i,
      dragConstraints: s,
      dragElastic: a,
      dragMomentum: u
    };
  }
}
function w1(e, t, n) {
  return (t === !0 || t === e) && (n === null || n === e);
}
function _fe(e, t = 10) {
  let n = null;
  return Math.abs(e.y) > t ? n = "y" : Math.abs(e.x) > t && (n = "x"), n;
}
class Sfe extends Md {
  constructor(t) {
    super(t), this.removeGroupControls = lo, this.removeListeners = lo, this.controls = new wfe(t);
  }
  mount() {
    const { dragControls: t } = this.node.getProps();
    t && (this.removeGroupControls = t.subscribe(this.controls)), this.removeListeners = this.controls.addListeners() || lo;
  }
  unmount() {
    this.removeGroupControls(), this.removeListeners();
  }
}
const f8 = (e) => (t, n) => {
  e && dr.postRender(() => e(t, n));
};
class Efe extends Md {
  constructor() {
    super(...arguments), this.removePointerDownListener = lo;
  }
  onPointerDown(t) {
    this.session = new h$(t, this.createPanHandlers(), {
      transformPagePoint: this.node.getTransformPagePoint(),
      contextWindow: f$(this.node)
    });
  }
  createPanHandlers() {
    const { onPanSessionStart: t, onPanStart: n, onPan: r, onPanEnd: i } = this.node.getProps();
    return {
      onSessionStart: f8(t),
      onStart: f8(n),
      onMove: r,
      onEnd: (s, a) => {
        delete this.session, i && dr.postRender(() => i(s, a));
      }
    };
  }
  mount() {
    this.removePointerDownListener = gy(this.node.current, "pointerdown", (t) => this.onPointerDown(t));
  }
  update() {
    this.session && this.session.updateHandlers(this.createPanHandlers());
  }
  unmount() {
    this.removePointerDownListener(), this.session && this.session.end();
  }
}
const G1 = {
  /**
   * Global flag as to whether the tree has animated since the last time
   * we resized the window
   */
  hasAnimatedSinceResize: !0,
  /**
   * We set this to true once, on the first update. Any nodes added to the tree beyond that
   * update will be given a `data-projection-id` attribute.
   */
  hasEverUpdated: !1
};
let j_ = !1;
class Cfe extends I.Component {
  /**
   * This only mounts projection nodes for components that
   * need measuring, we might want to do it for all components
   * in order to incorporate transforms
   */
  componentDidMount() {
    const { visualElement: t, layoutGroup: n, switchLayoutGroup: r, layoutId: i } = this.props, { projection: s } = t;
    s && (n.group && n.group.add(s), r && r.register && i && r.register(s), j_ && s.root.didUpdate(), s.addEventListener("animationComplete", () => {
      this.safeToRemove();
    }), s.setOptions({
      ...s.options,
      onExitComplete: () => this.safeToRemove()
    })), G1.hasEverUpdated = !0;
  }
  getSnapshotBeforeUpdate(t) {
    const { layoutDependency: n, visualElement: r, drag: i, isPresent: s } = this.props, { projection: a } = r;
    return a && (a.isPresent = s, j_ = !0, i || t.layoutDependency !== n || n === void 0 || t.isPresent !== s ? a.willUpdate() : this.safeToRemove(), t.isPresent !== s && (s ? a.promote() : a.relegate() || dr.postRender(() => {
      const u = a.getStack();
      (!u || !u.members.length) && this.safeToRemove();
    }))), null;
  }
  componentDidUpdate() {
    const { projection: t } = this.props.visualElement;
    t && (t.root.didUpdate(), oj.postRender(() => {
      !t.currentAnimation && t.isLead() && this.safeToRemove();
    }));
  }
  componentWillUnmount() {
    const { visualElement: t, layoutGroup: n, switchLayoutGroup: r } = this.props, { projection: i } = t;
    j_ = !0, i && (i.scheduleCheckAfterUnmount(), n && n.group && n.group.remove(i), r && r.deregister && r.deregister(i));
  }
  safeToRemove() {
    const { safeToRemove: t } = this.props;
    t && t();
  }
  render() {
    return null;
  }
}
function m$(e) {
  const [t, n] = qce(), r = I.useContext(VL);
  return c.jsx(Cfe, { ...e, layoutGroup: r, switchLayoutGroup: I.useContext(WB), isPresent: t, safeToRemove: n });
}
function kfe(e, t, n) {
  const r = qi(e) ? e : wh(e);
  return r.start(xj("", r, t, n)), r.animation;
}
const Tfe = (e, t) => e.depth - t.depth;
class jfe {
  constructor() {
    this.children = [], this.isDirty = !1;
  }
  add(t) {
    HT(this.children, t), this.isDirty = !0;
  }
  remove(t) {
    VT(this.children, t), this.isDirty = !0;
  }
  forEach(t) {
    this.isDirty && this.children.sort(Tfe), this.isDirty = !1, this.children.forEach(t);
  }
}
function Afe(e, t) {
  const n = da.now(), r = ({ timestamp: i }) => {
    const s = i - n;
    s >= t && (ec(r), e(s - t));
  };
  return dr.setup(r, !0), () => ec(r);
}
const g$ = ["TopLeft", "TopRight", "BottomLeft", "BottomRight"], Nfe = g$.length, h8 = (e) => typeof e == "string" ? parseFloat(e) : e, p8 = (e) => typeof e == "number" || Bt.test(e);
function Rfe(e, t, n, r, i, s) {
  i ? (e.opacity = yr(0, n.opacity ?? 1, Mfe(r)), e.opacityExit = yr(t.opacity ?? 1, 0, Ofe(r))) : s && (e.opacity = yr(t.opacity ?? 1, n.opacity ?? 1, r));
  for (let a = 0; a < Nfe; a++) {
    const u = `border${g$[a]}Radius`;
    let d = m8(t, u), f = m8(n, u);
    if (d === void 0 && f === void 0)
      continue;
    d || (d = 0), f || (f = 0), d === 0 || f === 0 || p8(d) === p8(f) ? (e[u] = Math.max(yr(h8(d), h8(f), r), 0), (tu.test(f) || tu.test(d)) && (e[u] += "%")) : e[u] = f;
  }
  (t.rotate || n.rotate) && (e.rotate = yr(t.rotate || 0, n.rotate || 0, r));
}
function m8(e, t) {
  return e[t] !== void 0 ? e[t] : e.borderRadius;
}
const Mfe = /* @__PURE__ */ y$(0, 0.5, rB), Ofe = /* @__PURE__ */ y$(0.5, 0.95, lo);
function y$(e, t, n) {
  return (r) => r < e ? 0 : r > t ? 1 : n(/* @__PURE__ */ Ry(e, t, r));
}
function g8(e, t) {
  e.min = t.min, e.max = t.max;
}
function Uo(e, t) {
  g8(e.x, t.x), g8(e.y, t.y);
}
function y8(e, t) {
  e.translate = t.translate, e.scale = t.scale, e.originPoint = t.originPoint, e.origin = t.origin;
}
function x8(e, t, n, r, i) {
  return e -= t, e = kb(e, 1 / n, r), i !== void 0 && (e = kb(e, 1 / i, r)), e;
}
function Dfe(e, t = 0, n = 1, r = 0.5, i, s = e, a = e) {
  if (tu.test(t) && (t = parseFloat(t), t = yr(a.min, a.max, t / 100) - a.min), typeof t != "number")
    return;
  let u = yr(s.min, s.max, r);
  e === s && (u -= t), e.min = x8(e.min, t, n, u, i), e.max = x8(e.max, t, n, u, i);
}
function v8(e, t, [n, r, i], s, a) {
  Dfe(e, t[n], t[r], t[i], t.scale, s, a);
}
const zfe = ["x", "scaleX", "originX"], Pfe = ["y", "scaleY", "originY"];
function b8(e, t, n, r) {
  v8(e.x, t, zfe, n ? n.x : void 0, r ? r.x : void 0), v8(e.y, t, Pfe, n ? n.y : void 0, r ? r.y : void 0);
}
function w8(e) {
  return e.translate === 0 && e.scale === 1;
}
function x$(e) {
  return w8(e.x) && w8(e.y);
}
function _8(e, t) {
  return e.min === t.min && e.max === t.max;
}
function Ife(e, t) {
  return _8(e.x, t.x) && _8(e.y, t.y);
}
function S8(e, t) {
  return Math.round(e.min) === Math.round(t.min) && Math.round(e.max) === Math.round(t.max);
}
function v$(e, t) {
  return S8(e.x, t.x) && S8(e.y, t.y);
}
function E8(e) {
  return zs(e.x) / zs(e.y);
}
function C8(e, t) {
  return e.translate === t.translate && e.scale === t.scale && e.originPoint === t.originPoint;
}
class Lfe {
  constructor() {
    this.members = [];
  }
  add(t) {
    HT(this.members, t), t.scheduleRender();
  }
  remove(t) {
    if (VT(this.members, t), t === this.prevLead && (this.prevLead = void 0), t === this.lead) {
      const n = this.members[this.members.length - 1];
      n && this.promote(n);
    }
  }
  relegate(t) {
    const n = this.members.findIndex((i) => t === i);
    if (n === 0)
      return !1;
    let r;
    for (let i = n; i >= 0; i--) {
      const s = this.members[i];
      if (s.isPresent !== !1) {
        r = s;
        break;
      }
    }
    return r ? (this.promote(r), !0) : !1;
  }
  promote(t, n) {
    const r = this.lead;
    if (t !== r && (this.prevLead = r, this.lead = t, t.show(), r)) {
      r.instance && r.scheduleRender(), t.scheduleRender(), t.resumeFrom = r, n && (t.resumeFrom.preserveOpacity = !0), r.snapshot && (t.snapshot = r.snapshot, t.snapshot.latestValues = r.animationValues || r.latestValues), t.root && t.root.isUpdating && (t.isLayoutDirty = !0);
      const { crossfade: i } = t.options;
      i === !1 && r.hide();
    }
  }
  exitAnimationComplete() {
    this.members.forEach((t) => {
      const { options: n, resumingFrom: r } = t;
      n.onExitComplete && n.onExitComplete(), r && r.options.onExitComplete && r.options.onExitComplete();
    });
  }
  scheduleRender() {
    this.members.forEach((t) => {
      t.instance && t.scheduleRender(!1);
    });
  }
  /**
   * Clear any leads that have been removed this render to prevent them from being
   * used in future animations and to prevent memory leaks
   */
  removeLeadSnapshot() {
    this.lead && this.lead.snapshot && (this.lead.snapshot = void 0);
  }
}
function Bfe(e, t, n) {
  let r = "";
  const i = e.x.translate / t.x, s = e.y.translate / t.y, a = (n == null ? void 0 : n.z) || 0;
  if ((i || s || a) && (r = `translate3d(${i}px, ${s}px, ${a}px) `), (t.x !== 1 || t.y !== 1) && (r += `scale(${1 / t.x}, ${1 / t.y}) `), n) {
    const { transformPerspective: f, rotate: h, rotateX: m, rotateY: x, skewX: b, skewY: w } = n;
    f && (r = `perspective(${f}px) ${r}`), h && (r += `rotate(${h}deg) `), m && (r += `rotateX(${m}deg) `), x && (r += `rotateY(${x}deg) `), b && (r += `skewX(${b}deg) `), w && (r += `skewY(${w}deg) `);
  }
  const u = e.x.scale * t.x, d = e.y.scale * t.y;
  return (u !== 1 || d !== 1) && (r += `scale(${u}, ${d})`), r || "none";
}
const A_ = ["", "X", "Y", "Z"], $fe = 1e3;
let qfe = 0;
function N_(e, t, n, r) {
  const { latestValues: i } = t;
  i[e] && (n[e] = i[e], t.setStaticValue(e, 0), r && (r[e] = 0));
}
function b$(e) {
  if (e.hasCheckedOptimisedAppear = !0, e.root === e)
    return;
  const { visualElement: t } = e.options;
  if (!t)
    return;
  const n = s$(t);
  if (window.MotionHasOptimisedAnimation(n, "transform")) {
    const { layout: i, layoutId: s } = e.options;
    window.MotionCancelOptimisedAnimation(n, "transform", dr, !(i || s));
  }
  const { parent: r } = e;
  r && !r.hasCheckedOptimisedAppear && b$(r);
}
function w$({ attachResizeListener: e, defaultParent: t, measureScroll: n, checkIsScrollRoot: r, resetTransform: i }) {
  return class {
    constructor(a = {}, u = t == null ? void 0 : t()) {
      this.id = qfe++, this.animationId = 0, this.animationCommitId = 0, this.children = /* @__PURE__ */ new Set(), this.options = {}, this.isTreeAnimating = !1, this.isAnimationBlocked = !1, this.isLayoutDirty = !1, this.isProjectionDirty = !1, this.isSharedProjectionDirty = !1, this.isTransformDirty = !1, this.updateManuallyBlocked = !1, this.updateBlockedByResize = !1, this.isUpdating = !1, this.isSVG = !1, this.needsReset = !1, this.shouldResetTransform = !1, this.hasCheckedOptimisedAppear = !1, this.treeScale = { x: 1, y: 1 }, this.eventHandlers = /* @__PURE__ */ new Map(), this.hasTreeAnimated = !1, this.layoutVersion = 0, this.updateScheduled = !1, this.scheduleUpdate = () => this.update(), this.projectionUpdateScheduled = !1, this.checkUpdateFailed = () => {
        this.isUpdating && (this.isUpdating = !1, this.clearAllSnapshots());
      }, this.updateProjection = () => {
        this.projectionUpdateScheduled = !1, this.nodes.forEach(Hfe), this.nodes.forEach(Yfe), this.nodes.forEach(Wfe), this.nodes.forEach(Vfe);
      }, this.resolvedRelativeTargetAt = 0, this.linkedParentVersion = 0, this.hasProjected = !1, this.isVisible = !0, this.animationProgress = 0, this.sharedNodes = /* @__PURE__ */ new Map(), this.latestValues = a, this.root = u ? u.root || u : this, this.path = u ? [...u.path, u] : [], this.parent = u, this.depth = u ? u.depth + 1 : 0;
      for (let d = 0; d < this.path.length; d++)
        this.path[d].shouldResetTransform = !0;
      this.root === this && (this.nodes = new jfe());
    }
    addEventListener(a, u) {
      return this.eventHandlers.has(a) || this.eventHandlers.set(a, new KT()), this.eventHandlers.get(a).add(u);
    }
    notifyListeners(a, ...u) {
      const d = this.eventHandlers.get(a);
      d && d.notify(...u);
    }
    hasListeners(a) {
      return this.eventHandlers.has(a);
    }
    /**
     * Lifecycles
     */
    mount(a) {
      if (this.instance)
        return;
      this.isSVG = IB(a) && !Ice(a), this.instance = a;
      const { layoutId: u, layout: d, visualElement: f } = this.options;
      if (f && !f.current && f.mount(a), this.root.nodes.add(this), this.parent && this.parent.children.add(this), this.root.hasTreeAnimated && (d || u) && (this.isLayoutDirty = !0), e) {
        let h, m = 0;
        const x = () => this.root.updateBlockedByResize = !1;
        dr.read(() => {
          m = window.innerWidth;
        }), e(a, () => {
          const b = window.innerWidth;
          b !== m && (m = b, this.root.updateBlockedByResize = !0, h && h(), h = Afe(x, 250), G1.hasAnimatedSinceResize && (G1.hasAnimatedSinceResize = !1, this.nodes.forEach(j8)));
        });
      }
      u && this.root.registerSharedNode(u, this), this.options.animate !== !1 && f && (u || d) && this.addEventListener("didUpdate", ({ delta: h, hasLayoutChanged: m, hasRelativeLayoutChanged: x, layout: b }) => {
        if (this.isTreeAnimationBlocked()) {
          this.target = void 0, this.relativeTarget = void 0;
          return;
        }
        const w = this.options.transition || f.getDefaultTransition() || ehe, { onLayoutAnimationStart: S, onLayoutAnimationComplete: C } = f.getProps(), T = !this.targetLayout || !v$(this.targetLayout, b), R = !m && x;
        if (this.options.layoutRoot || this.resumeFrom || R || m && (T || !this.currentAnimation)) {
          this.resumeFrom && (this.resumingFrom = this.resumeFrom, this.resumingFrom.resumingFrom = void 0);
          const N = {
            ...sj(w, "layout"),
            onPlay: S,
            onComplete: C
          };
          (f.shouldReduceMotion || this.options.layoutRoot) && (N.delay = 0, N.type = !1), this.startAnimation(N), this.setAnimationOrigin(h, R);
        } else
          m || j8(this), this.isLead() && this.options.onExitComplete && this.options.onExitComplete();
        this.targetLayout = b;
      });
    }
    unmount() {
      this.options.layoutId && this.willUpdate(), this.root.nodes.remove(this);
      const a = this.getStack();
      a && a.remove(this), this.parent && this.parent.children.delete(this), this.instance = void 0, this.eventHandlers.clear(), ec(this.updateProjection);
    }
    // only on the root
    blockUpdate() {
      this.updateManuallyBlocked = !0;
    }
    unblockUpdate() {
      this.updateManuallyBlocked = !1;
    }
    isUpdateBlocked() {
      return this.updateManuallyBlocked || this.updateBlockedByResize;
    }
    isTreeAnimationBlocked() {
      return this.isAnimationBlocked || this.parent && this.parent.isTreeAnimationBlocked() || !1;
    }
    // Note: currently only running on root node
    startUpdate() {
      this.isUpdateBlocked() || (this.isUpdating = !0, this.nodes && this.nodes.forEach(Zfe), this.animationId++);
    }
    getTransformTemplate() {
      const { visualElement: a } = this.options;
      return a && a.getProps().transformTemplate;
    }
    willUpdate(a = !0) {
      if (this.root.hasTreeAnimated = !0, this.root.isUpdateBlocked()) {
        this.options.onExitComplete && this.options.onExitComplete();
        return;
      }
      if (window.MotionCancelOptimisedAnimation && !this.hasCheckedOptimisedAppear && b$(this), !this.root.isUpdating && this.root.startUpdate(), this.isLayoutDirty)
        return;
      this.isLayoutDirty = !0;
      for (let h = 0; h < this.path.length; h++) {
        const m = this.path[h];
        m.shouldResetTransform = !0, m.updateScroll("snapshot"), m.options.layoutRoot && m.willUpdate(!1);
      }
      const { layoutId: u, layout: d } = this.options;
      if (u === void 0 && !d)
        return;
      const f = this.getTransformTemplate();
      this.prevTransformTemplateValue = f ? f(this.latestValues, "") : void 0, this.updateSnapshot(), a && this.notifyListeners("willUpdate");
    }
    update() {
      if (this.updateScheduled = !1, this.isUpdateBlocked()) {
        this.unblockUpdate(), this.clearAllSnapshots(), this.nodes.forEach(k8);
        return;
      }
      if (this.animationId <= this.animationCommitId) {
        this.nodes.forEach(T8);
        return;
      }
      this.animationCommitId = this.animationId, this.isUpdating ? (this.isUpdating = !1, this.nodes.forEach(Kfe), this.nodes.forEach(Ffe), this.nodes.forEach(Ufe)) : this.nodes.forEach(T8), this.clearAllSnapshots();
      const u = da.now();
      $i.delta = Qu(0, 1e3 / 60, u - $i.timestamp), $i.timestamp = u, $i.isProcessing = !0, x_.update.process($i), x_.preRender.process($i), x_.render.process($i), $i.isProcessing = !1;
    }
    didUpdate() {
      this.updateScheduled || (this.updateScheduled = !0, oj.read(this.scheduleUpdate));
    }
    clearAllSnapshots() {
      this.nodes.forEach(Gfe), this.sharedNodes.forEach(Xfe);
    }
    scheduleUpdateProjection() {
      this.projectionUpdateScheduled || (this.projectionUpdateScheduled = !0, dr.preRender(this.updateProjection, !1, !0));
    }
    scheduleCheckAfterUnmount() {
      dr.postRender(() => {
        this.isLayoutDirty ? this.root.didUpdate() : this.root.checkUpdateFailed();
      });
    }
    /**
     * Update measurements
     */
    updateSnapshot() {
      this.snapshot || !this.instance || (this.snapshot = this.measure(), this.snapshot && !zs(this.snapshot.measuredBox.x) && !zs(this.snapshot.measuredBox.y) && (this.snapshot = void 0));
    }
    updateLayout() {
      if (!this.instance || (this.updateScroll(), !(this.options.alwaysMeasureLayout && this.isLead()) && !this.isLayoutDirty))
        return;
      if (this.resumeFrom && !this.resumeFrom.instance)
        for (let d = 0; d < this.path.length; d++)
          this.path[d].updateScroll();
      const a = this.layout;
      this.layout = this.measure(!1), this.layoutVersion++, this.layoutCorrected = mi(), this.isLayoutDirty = !1, this.projectionDelta = void 0, this.notifyListeners("measure", this.layout.layoutBox);
      const { visualElement: u } = this.options;
      u && u.notify("LayoutMeasure", this.layout.layoutBox, a ? a.layoutBox : void 0);
    }
    updateScroll(a = "measure") {
      let u = !!(this.options.layoutScroll && this.instance);
      if (this.scroll && this.scroll.animationId === this.root.animationId && this.scroll.phase === a && (u = !1), u && this.instance) {
        const d = r(this.instance);
        this.scroll = {
          animationId: this.root.animationId,
          phase: a,
          isRoot: d,
          offset: n(this.instance),
          wasRoot: this.scroll ? this.scroll.isRoot : d
        };
      }
    }
    resetTransform() {
      if (!i)
        return;
      const a = this.isLayoutDirty || this.shouldResetTransform || this.options.alwaysMeasureLayout, u = this.projectionDelta && !x$(this.projectionDelta), d = this.getTransformTemplate(), f = d ? d(this.latestValues, "") : void 0, h = f !== this.prevTransformTemplateValue;
      a && this.instance && (u || Qf(this.latestValues) || h) && (i(this.instance, f), this.shouldResetTransform = !1, this.scheduleRender());
    }
    measure(a = !0) {
      const u = this.measurePageBox();
      let d = this.removeElementScroll(u);
      return a && (d = this.removeTransform(d)), the(d), {
        animationId: this.root.animationId,
        measuredBox: u,
        layoutBox: d,
        latestValues: {},
        source: this.id
      };
    }
    measurePageBox() {
      var f;
      const { visualElement: a } = this.options;
      if (!a)
        return mi();
      const u = a.measureViewportBox();
      if (!(((f = this.scroll) == null ? void 0 : f.wasRoot) || this.path.some(nhe))) {
        const { scroll: h } = this.root;
        h && (fm(u.x, h.offset.x), fm(u.y, h.offset.y));
      }
      return u;
    }
    removeElementScroll(a) {
      var d;
      const u = mi();
      if (Uo(u, a), (d = this.scroll) != null && d.wasRoot)
        return u;
      for (let f = 0; f < this.path.length; f++) {
        const h = this.path[f], { scroll: m, options: x } = h;
        h !== this.root && m && x.layoutScroll && (m.wasRoot && Uo(u, a), fm(u.x, m.offset.x), fm(u.y, m.offset.y));
      }
      return u;
    }
    applyTransform(a, u = !1) {
      const d = mi();
      Uo(d, a);
      for (let f = 0; f < this.path.length; f++) {
        const h = this.path[f];
        !u && h.options.layoutScroll && h.scroll && h !== h.root && hm(d, {
          x: -h.scroll.offset.x,
          y: -h.scroll.offset.y
        }), Qf(h.latestValues) && hm(d, h.latestValues);
      }
      return Qf(this.latestValues) && hm(d, this.latestValues), d;
    }
    removeTransform(a) {
      const u = mi();
      Uo(u, a);
      for (let d = 0; d < this.path.length; d++) {
        const f = this.path[d];
        if (!f.instance || !Qf(f.latestValues))
          continue;
        v5(f.latestValues) && f.updateSnapshot();
        const h = mi(), m = f.measurePageBox();
        Uo(h, m), b8(u, f.latestValues, f.snapshot ? f.snapshot.layoutBox : void 0, h);
      }
      return Qf(this.latestValues) && b8(u, this.latestValues), u;
    }
    setTargetDelta(a) {
      this.targetDelta = a, this.root.scheduleUpdateProjection(), this.isProjectionDirty = !0;
    }
    setOptions(a) {
      this.options = {
        ...this.options,
        ...a,
        crossfade: a.crossfade !== void 0 ? a.crossfade : !0
      };
    }
    clearMeasurements() {
      this.scroll = void 0, this.layout = void 0, this.snapshot = void 0, this.prevTransformTemplateValue = void 0, this.targetDelta = void 0, this.target = void 0, this.isLayoutDirty = !1;
    }
    forceRelativeParentToResolveTarget() {
      this.relativeParent && this.relativeParent.resolvedRelativeTargetAt !== $i.timestamp && this.relativeParent.resolveTargetDelta(!0);
    }
    resolveTargetDelta(a = !1) {
      var b;
      const u = this.getLead();
      this.isProjectionDirty || (this.isProjectionDirty = u.isProjectionDirty), this.isTransformDirty || (this.isTransformDirty = u.isTransformDirty), this.isSharedProjectionDirty || (this.isSharedProjectionDirty = u.isSharedProjectionDirty);
      const d = !!this.resumingFrom || this !== u;
      if (!(a || d && this.isSharedProjectionDirty || this.isProjectionDirty || (b = this.parent) != null && b.isProjectionDirty || this.attemptToResolveRelativeTarget || this.root.updateBlockedByResize))
        return;
      const { layout: h, layoutId: m } = this.options;
      if (!this.layout || !(h || m))
        return;
      this.resolvedRelativeTargetAt = $i.timestamp;
      const x = this.getClosestProjectingParent();
      x && this.linkedParentVersion !== x.layoutVersion && !x.options.layoutRoot && this.removeRelativeTarget(), !this.targetDelta && !this.relativeTarget && (x && x.layout ? this.createRelativeTarget(x, this.layout.layoutBox, x.layout.layoutBox) : this.removeRelativeTarget()), !(!this.relativeTarget && !this.targetDelta) && (this.target || (this.target = mi(), this.targetWithTransforms = mi()), this.relativeTarget && this.relativeTargetOrigin && this.relativeParent && this.relativeParent.target ? (this.forceRelativeParentToResolveTarget(), cfe(this.target, this.relativeTarget, this.relativeParent.target)) : this.targetDelta ? (this.resumingFrom ? this.target = this.applyTransform(this.layout.layoutBox) : Uo(this.target, this.layout.layoutBox), JB(this.target, this.targetDelta)) : Uo(this.target, this.layout.layoutBox), this.attemptToResolveRelativeTarget && (this.attemptToResolveRelativeTarget = !1, x && !!x.resumingFrom == !!this.resumingFrom && !x.options.layoutScroll && x.target && this.animationProgress !== 1 ? this.createRelativeTarget(x, this.target, x.target) : this.relativeParent = this.relativeTarget = void 0));
    }
    getClosestProjectingParent() {
      if (!(!this.parent || v5(this.parent.latestValues) || QB(this.parent.latestValues)))
        return this.parent.isProjecting() ? this.parent : this.parent.getClosestProjectingParent();
    }
    isProjecting() {
      return !!((this.relativeTarget || this.targetDelta || this.options.layoutRoot) && this.layout);
    }
    createRelativeTarget(a, u, d) {
      this.relativeParent = a, this.linkedParentVersion = a.layoutVersion, this.forceRelativeParentToResolveTarget(), this.relativeTarget = mi(), this.relativeTargetOrigin = mi(), Tb(this.relativeTargetOrigin, u, d), Uo(this.relativeTarget, this.relativeTargetOrigin);
    }
    removeRelativeTarget() {
      this.relativeParent = this.relativeTarget = void 0;
    }
    calcProjection() {
      var w;
      const a = this.getLead(), u = !!this.resumingFrom || this !== a;
      let d = !0;
      if ((this.isProjectionDirty || (w = this.parent) != null && w.isProjectionDirty) && (d = !1), u && (this.isSharedProjectionDirty || this.isTransformDirty) && (d = !1), this.resolvedRelativeTargetAt === $i.timestamp && (d = !1), d)
        return;
      const { layout: f, layoutId: h } = this.options;
      if (this.isTreeAnimating = !!(this.parent && this.parent.isTreeAnimating || this.currentAnimation || this.pendingAnimation), this.isTreeAnimating || (this.targetDelta = this.relativeTarget = void 0), !this.layout || !(f || h))
        return;
      Uo(this.layoutCorrected, this.layout.layoutBox);
      const m = this.treeScale.x, x = this.treeScale.y;
      _de(this.layoutCorrected, this.treeScale, this.path, u), a.layout && !a.target && (this.treeScale.x !== 1 || this.treeScale.y !== 1) && (a.target = a.layout.layoutBox, a.targetWithTransforms = mi());
      const { target: b } = a;
      if (!b) {
        this.prevProjectionDelta && (this.createProjectionDeltas(), this.scheduleRender());
        return;
      }
      !this.projectionDelta || !this.prevProjectionDelta ? this.createProjectionDeltas() : (y8(this.prevProjectionDelta.x, this.projectionDelta.x), y8(this.prevProjectionDelta.y, this.projectionDelta.y)), yy(this.projectionDelta, this.layoutCorrected, b, this.latestValues), (this.treeScale.x !== m || this.treeScale.y !== x || !C8(this.projectionDelta.x, this.prevProjectionDelta.x) || !C8(this.projectionDelta.y, this.prevProjectionDelta.y)) && (this.hasProjected = !0, this.scheduleRender(), this.notifyListeners("projectionUpdate", b));
    }
    hide() {
      this.isVisible = !1;
    }
    show() {
      this.isVisible = !0;
    }
    scheduleRender(a = !0) {
      var u;
      if ((u = this.options.visualElement) == null || u.scheduleRender(), a) {
        const d = this.getStack();
        d && d.scheduleRender();
      }
      this.resumingFrom && !this.resumingFrom.instance && (this.resumingFrom = void 0);
    }
    createProjectionDeltas() {
      this.prevProjectionDelta = pm(), this.projectionDelta = pm(), this.projectionDeltaWithTransform = pm();
    }
    setAnimationOrigin(a, u = !1) {
      const d = this.snapshot, f = d ? d.latestValues : {}, h = { ...this.latestValues }, m = pm();
      (!this.relativeParent || !this.relativeParent.options.layoutRoot) && (this.relativeTarget = this.relativeTargetOrigin = void 0), this.attemptToResolveRelativeTarget = !u;
      const x = mi(), b = d ? d.source : void 0, w = this.layout ? this.layout.source : void 0, S = b !== w, C = this.getStack(), T = !C || C.members.length <= 1, R = !!(S && !T && this.options.crossfade === !0 && !this.path.some(Jfe));
      this.animationProgress = 0;
      let N;
      this.mixTargetDelta = (M) => {
        const P = M / 1e3;
        A8(m.x, a.x, P), A8(m.y, a.y, P), this.setTargetDelta(m), this.relativeTarget && this.relativeTargetOrigin && this.layout && this.relativeParent && this.relativeParent.layout && (Tb(x, this.layout.layoutBox, this.relativeParent.layout.layoutBox), Qfe(this.relativeTarget, this.relativeTargetOrigin, x, P), N && Ife(this.relativeTarget, N) && (this.isProjectionDirty = !1), N || (N = mi()), Uo(N, this.relativeTarget)), S && (this.animationValues = h, Rfe(h, f, this.latestValues, P, R, T)), this.root.scheduleUpdateProjection(), this.scheduleRender(), this.animationProgress = P;
      }, this.mixTargetDelta(this.options.layoutRoot ? 1e3 : 0);
    }
    startAnimation(a) {
      var u, d, f;
      this.notifyListeners("animationStart"), (u = this.currentAnimation) == null || u.stop(), (f = (d = this.resumingFrom) == null ? void 0 : d.currentAnimation) == null || f.stop(), this.pendingAnimation && (ec(this.pendingAnimation), this.pendingAnimation = void 0), this.pendingAnimation = dr.update(() => {
        G1.hasAnimatedSinceResize = !0, this.motionValue || (this.motionValue = wh(0)), this.currentAnimation = kfe(this.motionValue, [0, 1e3], {
          ...a,
          velocity: 0,
          isSync: !0,
          onUpdate: (h) => {
            this.mixTargetDelta(h), a.onUpdate && a.onUpdate(h);
          },
          onStop: () => {
          },
          onComplete: () => {
            a.onComplete && a.onComplete(), this.completeAnimation();
          }
        }), this.resumingFrom && (this.resumingFrom.currentAnimation = this.currentAnimation), this.pendingAnimation = void 0;
      });
    }
    completeAnimation() {
      this.resumingFrom && (this.resumingFrom.currentAnimation = void 0, this.resumingFrom.preserveOpacity = void 0);
      const a = this.getStack();
      a && a.exitAnimationComplete(), this.resumingFrom = this.currentAnimation = this.animationValues = void 0, this.notifyListeners("animationComplete");
    }
    finishAnimation() {
      this.currentAnimation && (this.mixTargetDelta && this.mixTargetDelta($fe), this.currentAnimation.stop()), this.completeAnimation();
    }
    applyTransformsToTarget() {
      const a = this.getLead();
      let { targetWithTransforms: u, target: d, layout: f, latestValues: h } = a;
      if (!(!u || !d || !f)) {
        if (this !== a && this.layout && f && _$(this.options.animationType, this.layout.layoutBox, f.layoutBox)) {
          d = this.target || mi();
          const m = zs(this.layout.layoutBox.x);
          d.x.min = a.target.x.min, d.x.max = d.x.min + m;
          const x = zs(this.layout.layoutBox.y);
          d.y.min = a.target.y.min, d.y.max = d.y.min + x;
        }
        Uo(u, d), hm(u, h), yy(this.projectionDeltaWithTransform, this.layoutCorrected, u, h);
      }
    }
    registerSharedNode(a, u) {
      this.sharedNodes.has(a) || this.sharedNodes.set(a, new Lfe()), this.sharedNodes.get(a).add(u);
      const f = u.options.initialPromotionConfig;
      u.promote({
        transition: f ? f.transition : void 0,
        preserveFollowOpacity: f && f.shouldPreserveFollowOpacity ? f.shouldPreserveFollowOpacity(u) : void 0
      });
    }
    isLead() {
      const a = this.getStack();
      return a ? a.lead === this : !0;
    }
    getLead() {
      var u;
      const { layoutId: a } = this.options;
      return a ? ((u = this.getStack()) == null ? void 0 : u.lead) || this : this;
    }
    getPrevLead() {
      var u;
      const { layoutId: a } = this.options;
      return a ? (u = this.getStack()) == null ? void 0 : u.prevLead : void 0;
    }
    getStack() {
      const { layoutId: a } = this.options;
      if (a)
        return this.root.sharedNodes.get(a);
    }
    promote({ needsReset: a, transition: u, preserveFollowOpacity: d } = {}) {
      const f = this.getStack();
      f && f.promote(this, d), a && (this.projectionDelta = void 0, this.needsReset = !0), u && this.setOptions({ transition: u });
    }
    relegate() {
      const a = this.getStack();
      return a ? a.relegate(this) : !1;
    }
    resetSkewAndRotation() {
      const { visualElement: a } = this.options;
      if (!a)
        return;
      let u = !1;
      const { latestValues: d } = a;
      if ((d.z || d.rotate || d.rotateX || d.rotateY || d.rotateZ || d.skewX || d.skewY) && (u = !0), !u)
        return;
      const f = {};
      d.z && N_("z", a, f, this.animationValues);
      for (let h = 0; h < A_.length; h++)
        N_(`rotate${A_[h]}`, a, f, this.animationValues), N_(`skew${A_[h]}`, a, f, this.animationValues);
      a.render();
      for (const h in f)
        a.setStaticValue(h, f[h]), this.animationValues && (this.animationValues[h] = f[h]);
      a.scheduleRender();
    }
    applyProjectionStyles(a, u) {
      if (!this.instance || this.isSVG)
        return;
      if (!this.isVisible) {
        a.visibility = "hidden";
        return;
      }
      const d = this.getTransformTemplate();
      if (this.needsReset) {
        this.needsReset = !1, a.visibility = "", a.opacity = "", a.pointerEvents = V1(u == null ? void 0 : u.pointerEvents) || "", a.transform = d ? d(this.latestValues, "") : "none";
        return;
      }
      const f = this.getLead();
      if (!this.projectionDelta || !this.layout || !f.target) {
        this.options.layoutId && (a.opacity = this.latestValues.opacity !== void 0 ? this.latestValues.opacity : 1, a.pointerEvents = V1(u == null ? void 0 : u.pointerEvents) || ""), this.hasProjected && !Qf(this.latestValues) && (a.transform = d ? d({}, "") : "none", this.hasProjected = !1);
        return;
      }
      a.visibility = "";
      const h = f.animationValues || f.latestValues;
      this.applyTransformsToTarget();
      let m = Bfe(this.projectionDeltaWithTransform, this.treeScale, h);
      d && (m = d(h, m)), a.transform = m;
      const { x, y: b } = this.projectionDelta;
      a.transformOrigin = `${x.origin * 100}% ${b.origin * 100}% 0`, f.animationValues ? a.opacity = f === this ? h.opacity ?? this.latestValues.opacity ?? 1 : this.preserveOpacity ? this.latestValues.opacity : h.opacityExit : a.opacity = f === this ? h.opacity !== void 0 ? h.opacity : "" : h.opacityExit !== void 0 ? h.opacityExit : 0;
      for (const w in x5) {
        if (h[w] === void 0)
          continue;
        const { correct: S, applyTo: C, isCSSVariable: T } = x5[w], R = m === "none" ? h[w] : S(h[w], f);
        if (C) {
          const N = C.length;
          for (let M = 0; M < N; M++)
            a[C[M]] = R;
        } else
          T ? this.options.visualElement.renderState.vars[w] = R : a[w] = R;
      }
      this.options.layoutId && (a.pointerEvents = f === this ? V1(u == null ? void 0 : u.pointerEvents) || "" : "none");
    }
    clearSnapshot() {
      this.resumeFrom = this.snapshot = void 0;
    }
    // Only run on root
    resetTree() {
      this.root.nodes.forEach((a) => {
        var u;
        return (u = a.currentAnimation) == null ? void 0 : u.stop();
      }), this.root.nodes.forEach(k8), this.root.sharedNodes.clear();
    }
  };
}
function Ffe(e) {
  e.updateLayout();
}
function Ufe(e) {
  var n;
  const t = ((n = e.resumeFrom) == null ? void 0 : n.snapshot) || e.snapshot;
  if (e.isLead() && e.layout && t && e.hasListeners("didUpdate")) {
    const { layoutBox: r, measuredBox: i } = e.layout, { animationType: s } = e.options, a = t.source !== e.layout.source;
    s === "size" ? io((m) => {
      const x = a ? t.measuredBox[m] : t.layoutBox[m], b = zs(x);
      x.min = r[m].min, x.max = x.min + b;
    }) : _$(s, t.layoutBox, r) && io((m) => {
      const x = a ? t.measuredBox[m] : t.layoutBox[m], b = zs(r[m]);
      x.max = x.min + b, e.relativeTarget && !e.currentAnimation && (e.isProjectionDirty = !0, e.relativeTarget[m].max = e.relativeTarget[m].min + b);
    });
    const u = pm();
    yy(u, r, t.layoutBox);
    const d = pm();
    a ? yy(d, e.applyTransform(i, !0), t.measuredBox) : yy(d, r, t.layoutBox);
    const f = !x$(u);
    let h = !1;
    if (!e.resumeFrom) {
      const m = e.getClosestProjectingParent();
      if (m && !m.resumeFrom) {
        const { snapshot: x, layout: b } = m;
        if (x && b) {
          const w = mi();
          Tb(w, t.layoutBox, x.layoutBox);
          const S = mi();
          Tb(S, r, b.layoutBox), v$(w, S) || (h = !0), m.options.layoutRoot && (e.relativeTarget = S, e.relativeTargetOrigin = w, e.relativeParent = m);
        }
      }
    }
    e.notifyListeners("didUpdate", {
      layout: r,
      snapshot: t,
      delta: d,
      layoutDelta: u,
      hasLayoutChanged: f,
      hasRelativeLayoutChanged: h
    });
  } else if (e.isLead()) {
    const { onExitComplete: r } = e.options;
    r && r();
  }
  e.options.transition = void 0;
}
function Hfe(e) {
  e.parent && (e.isProjecting() || (e.isProjectionDirty = e.parent.isProjectionDirty), e.isSharedProjectionDirty || (e.isSharedProjectionDirty = !!(e.isProjectionDirty || e.parent.isProjectionDirty || e.parent.isSharedProjectionDirty)), e.isTransformDirty || (e.isTransformDirty = e.parent.isTransformDirty));
}
function Vfe(e) {
  e.isProjectionDirty = e.isSharedProjectionDirty = e.isTransformDirty = !1;
}
function Gfe(e) {
  e.clearSnapshot();
}
function k8(e) {
  e.clearMeasurements();
}
function T8(e) {
  e.isLayoutDirty = !1;
}
function Kfe(e) {
  const { visualElement: t } = e.options;
  t && t.getProps().onBeforeLayoutMeasure && t.notify("BeforeLayoutMeasure"), e.resetTransform();
}
function j8(e) {
  e.finishAnimation(), e.targetDelta = e.relativeTarget = e.target = void 0, e.isProjectionDirty = !0;
}
function Yfe(e) {
  e.resolveTargetDelta();
}
function Wfe(e) {
  e.calcProjection();
}
function Zfe(e) {
  e.resetSkewAndRotation();
}
function Xfe(e) {
  e.removeLeadSnapshot();
}
function A8(e, t, n) {
  e.translate = yr(t.translate, 0, n), e.scale = yr(t.scale, 1, n), e.origin = t.origin, e.originPoint = t.originPoint;
}
function N8(e, t, n, r) {
  e.min = yr(t.min, n.min, r), e.max = yr(t.max, n.max, r);
}
function Qfe(e, t, n, r) {
  N8(e.x, t.x, n.x, r), N8(e.y, t.y, n.y, r);
}
function Jfe(e) {
  return e.animationValues && e.animationValues.opacityExit !== void 0;
}
const ehe = {
  duration: 0.45,
  ease: [0.4, 0, 0.1, 1]
}, R8 = (e) => typeof navigator < "u" && navigator.userAgent && navigator.userAgent.toLowerCase().includes(e), M8 = R8("applewebkit/") && !R8("chrome/") ? Math.round : lo;
function O8(e) {
  e.min = M8(e.min), e.max = M8(e.max);
}
function the(e) {
  O8(e.x), O8(e.y);
}
function _$(e, t, n) {
  return e === "position" || e === "preserve-aspect" && !ufe(E8(t), E8(n), 0.2);
}
function nhe(e) {
  var t;
  return e !== e.root && ((t = e.scroll) == null ? void 0 : t.wasRoot);
}
const rhe = w$({
  attachResizeListener: (e, t) => zy(e, "resize", t),
  measureScroll: () => ({
    x: document.documentElement.scrollLeft || document.body.scrollLeft,
    y: document.documentElement.scrollTop || document.body.scrollTop
  }),
  checkIsScrollRoot: () => !0
}), R_ = {
  current: void 0
}, S$ = w$({
  measureScroll: (e) => ({
    x: e.scrollLeft,
    y: e.scrollTop
  }),
  defaultParent: () => {
    if (!R_.current) {
      const e = new rhe({});
      e.mount(window), e.setOptions({ layoutScroll: !0 }), R_.current = e;
    }
    return R_.current;
  },
  resetTransform: (e, t) => {
    e.style.transform = t !== void 0 ? t : "none";
  },
  checkIsScrollRoot: (e) => window.getComputedStyle(e).position === "fixed"
}), ihe = {
  pan: {
    Feature: Efe
  },
  drag: {
    Feature: Sfe,
    ProjectionNode: S$,
    MeasureLayout: m$
  }
};
function D8(e, t, n) {
  const { props: r } = e;
  e.animationState && r.whileHover && e.animationState.setActive("whileHover", n === "Start");
  const i = "onHover" + n, s = r[i];
  s && dr.postRender(() => s(t, lx(t)));
}
class she extends Md {
  mount() {
    const { current: t } = this.node;
    t && (this.unmount = Mce(t, (n, r) => (D8(this.node, r, "Start"), (i) => D8(this.node, i, "End"))));
  }
  unmount() {
  }
}
class ahe extends Md {
  constructor() {
    super(...arguments), this.isActive = !1;
  }
  onFocus() {
    let t = !1;
    try {
      t = this.node.current.matches(":focus-visible");
    } catch {
      t = !0;
    }
    !t || !this.node.animationState || (this.node.animationState.setActive("whileFocus", !0), this.isActive = !0);
  }
  onBlur() {
    !this.isActive || !this.node.animationState || (this.node.animationState.setActive("whileFocus", !1), this.isActive = !1);
  }
  mount() {
    this.unmount = sx(zy(this.node.current, "focus", () => this.onFocus()), zy(this.node.current, "blur", () => this.onBlur()));
  }
  unmount() {
  }
}
function z8(e, t, n) {
  const { props: r } = e;
  if (e.current instanceof HTMLButtonElement && e.current.disabled)
    return;
  e.animationState && r.whileTap && e.animationState.setActive("whileTap", n === "Start");
  const i = "onTap" + (n === "End" ? "" : n), s = r[i];
  s && dr.postRender(() => s(t, lx(t)));
}
class ohe extends Md {
  mount() {
    const { current: t } = this.node;
    t && (this.unmount = Pce(t, (n, r) => (z8(this.node, r, "Start"), (i, { success: s }) => z8(this.node, i, s ? "End" : "Cancel")), { useGlobalTarget: this.node.props.globalTapTarget }));
  }
  unmount() {
  }
}
const k5 = /* @__PURE__ */ new WeakMap(), M_ = /* @__PURE__ */ new WeakMap(), lhe = (e) => {
  const t = k5.get(e.target);
  t && t(e);
}, uhe = (e) => {
  e.forEach(lhe);
};
function che({ root: e, ...t }) {
  const n = e || document;
  M_.has(n) || M_.set(n, {});
  const r = M_.get(n), i = JSON.stringify(t);
  return r[i] || (r[i] = new IntersectionObserver(uhe, { root: e, ...t })), r[i];
}
function dhe(e, t, n) {
  const r = che(t);
  return k5.set(e, n), r.observe(e), () => {
    k5.delete(e), r.unobserve(e);
  };
}
const fhe = {
  some: 0,
  all: 1
};
class hhe extends Md {
  constructor() {
    super(...arguments), this.hasEnteredView = !1, this.isInView = !1;
  }
  startObserver() {
    this.unmount();
    const { viewport: t = {} } = this.node.getProps(), { root: n, margin: r, amount: i = "some", once: s } = t, a = {
      root: n ? n.current : void 0,
      rootMargin: r,
      threshold: typeof i == "number" ? i : fhe[i]
    }, u = (d) => {
      const { isIntersecting: f } = d;
      if (this.isInView === f || (this.isInView = f, s && !f && this.hasEnteredView))
        return;
      f && (this.hasEnteredView = !0), this.node.animationState && this.node.animationState.setActive("whileInView", f);
      const { onViewportEnter: h, onViewportLeave: m } = this.node.getProps(), x = f ? h : m;
      x && x(d);
    };
    return dhe(this.node.current, a, u);
  }
  mount() {
    this.startObserver();
  }
  update() {
    if (typeof IntersectionObserver > "u")
      return;
    const { props: t, prevProps: n } = this.node;
    ["amount", "margin", "root"].some(phe(t, n)) && this.startObserver();
  }
  unmount() {
  }
}
function phe({ viewport: e = {} }, { viewport: t = {} } = {}) {
  return (n) => e[n] !== t[n];
}
const mhe = {
  inView: {
    Feature: hhe
  },
  tap: {
    Feature: ohe
  },
  focus: {
    Feature: ahe
  },
  hover: {
    Feature: she
  }
}, ghe = {
  layout: {
    ProjectionNode: S$,
    MeasureLayout: m$
  }
}, yhe = {
  ...rfe,
  ...mhe,
  ...ihe,
  ...ghe
}, E$ = /* @__PURE__ */ vde(yhe, Mde);
function C$(e) {
  const t = ix(() => wh(e)), { isStatic: n } = I.useContext(uj);
  if (n) {
    const [, r] = I.useState(e);
    I.useEffect(() => t.on("change", r), []);
  }
  return t;
}
function k$(e, t) {
  const n = C$(t()), r = () => n.set(t());
  return r(), GL(() => {
    const i = () => dr.preRender(r, !1, !0), s = e.map((a) => a.on("change", i));
    return () => {
      s.forEach((a) => a()), ec(r);
    };
  }), n;
}
function xhe(e) {
  my.current = [], e();
  const t = k$(my.current, e);
  return my.current = void 0, t;
}
function vhe(e, t, n, r) {
  if (typeof e == "function")
    return xhe(e);
  const i = typeof t == "function" ? t : Lce(t, n, r);
  return Array.isArray(e) ? P8(e, i) : P8([e], ([s]) => i(s));
}
function P8(e, t) {
  const n = ix(() => []);
  return k$(e, () => {
    n.length = 0;
    const r = e.length;
    for (let i = 0; i < r; i++)
      n[i] = e[i].get();
    return t(n);
  });
}
const T$ = I.createContext(null);
function bhe(e, t, n, r) {
  if (!r)
    return e;
  const i = e.findIndex((h) => h.value === t);
  if (i === -1)
    return e;
  const s = r > 0 ? 1 : -1, a = e[i + s];
  if (!a)
    return e;
  const u = e[i], d = a.layout, f = yr(d.min, d.max, 0.5);
  return s === 1 && u.layout.max + n > f || s === -1 && u.layout.min + n < f ? Ule(e, i, i + s) : e;
}
function whe({ children: e, as: t = "ul", axis: n = "y", onReorder: r, values: i, ...s }, a) {
  const u = ix(() => E$[t]), d = [], f = I.useRef(!1), h = {
    axis: n,
    registerItem: (m, x) => {
      const b = d.findIndex((w) => m === w.value);
      b !== -1 ? d[b].layout = x[n] : d.push({ value: m, layout: x[n] }), d.sort(Ehe);
    },
    updateOrder: (m, x, b) => {
      if (f.current)
        return;
      const w = bhe(d, m, x, b);
      d !== w && (f.current = !0, r(w.map(She).filter((S) => i.indexOf(S) !== -1)));
    }
  };
  return I.useEffect(() => {
    f.current = !1;
  }), c.jsx(u, { ...s, ref: a, ignoreStrict: !0, children: c.jsx(T$.Provider, { value: h, children: e }) });
}
const _he = /* @__PURE__ */ I.forwardRef(whe);
function She(e) {
  return e.value;
}
function Ehe(e, t) {
  return e.layout.min - t.layout.min;
}
function I8(e, t = 0) {
  return qi(e) ? e : C$(t);
}
function Che({ children: e, style: t = {}, value: n, as: r = "li", onDrag: i, layout: s = !0, ...a }, u) {
  const d = ix(() => E$[r]), f = I.useContext(T$), h = {
    x: I8(t.x),
    y: I8(t.y)
  }, m = vhe([h.x, h.y], ([S, C]) => S || C ? 1 : "unset"), { axis: x, registerItem: b, updateOrder: w } = f;
  return c.jsx(d, { drag: x, ...a, dragSnapToOrigin: !0, style: { ...t, x: h.x, y: h.y, zIndex: m }, layout: s, onDrag: (S, C) => {
    const { velocity: T } = C;
    T[x] && w(n, h[x].get(), T[x]), i && i(S, C);
  }, onLayoutMeasure: (S) => b(n, S), ref: u, ignoreStrict: !0, children: e });
}
const khe = /* @__PURE__ */ I.forwardRef(Che), The = ({
  rules: e,
  selectedId: t,
  onSelect: n,
  onToggle: r,
  onDelete: i,
  onAdd: s,
  onReset: a,
  onReorder: u,
  enableNativeRegex: d,
  onToggleNativeRegex: f
}) => /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-4", children: [
  /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between", children: [
    /* @__PURE__ */ c.jsx("h3", { className: "text-xs font-bold text-muted-foreground uppercase tracking-wider", children: "" }),
    /* @__PURE__ */ c.jsxs("div", { className: "flex gap-2", children: [
      /* @__PURE__ */ c.jsx(
        "button",
        {
          className: "text-[10px] text-muted-foreground hover:text-destructive transition-colors",
          onClick: a,
          children: ""
        }
      ),
      /* @__PURE__ */ c.jsx(
        "button",
        {
          className: "text-muted-foreground hover:text-foreground transition-colors",
          onClick: s,
          children: /* @__PURE__ */ c.jsx(Cz, { size: 16 })
        }
      )
    ] })
  ] }),
  /* @__PURE__ */ c.jsx("div", { className: "bg-muted/10 border border-border/50 rounded-lg p-3 mb-2", children: /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4", children: [
    /* @__PURE__ */ c.jsxs("div", { className: "flex-1 min-w-0", children: [
      /* @__PURE__ */ c.jsx("h4", { className: "text-sm font-medium", children: " Regex " }),
      /* @__PURE__ */ c.jsx("p", { className: "text-xs text-muted-foreground mt-0.5 break-words", children: " SillyTavern  Regex " })
    ] }),
    /* @__PURE__ */ c.jsx(
      gi,
      {
        checked: d ?? !0,
        onChange: (h) => f == null ? void 0 : f(h)
      }
    )
  ] }) }),
  /* @__PURE__ */ c.jsx(_he, { axis: "y", values: e, onReorder: u, className: "flex flex-col gap-1", children: e.map((h) => /* @__PURE__ */ c.jsxs(
    khe,
    {
      value: h,
      className: `
                            group p-3 rounded-lg transition-all duration-200 cursor-pointer border flex items-center gap-3
                            ${t === h.id ? "bg-accent/50 border-input" : "bg-transparent border-transparent hover:bg-muted/50 hover:border-border"}
                            ${!h.enabled && "opacity-50"}
                        `,
      onClick: () => n(h.id),
      children: [
        /* @__PURE__ */ c.jsx("div", { className: "cursor-grab active:cursor-grabbing text-muted-foreground hover:text-foreground transition-colors", children: /* @__PURE__ */ c.jsx(_z, { size: 14 }) }),
        /* @__PURE__ */ c.jsx(
          "button",
          {
            className: `
                                w-8 h-8 flex items-center justify-center rounded-lg transition-colors
                                ${h.enabled ? t === h.id ? "bg-primary/20 text-primary" : "bg-muted text-primary" : "bg-muted text-muted-foreground"}
                            `,
            onClick: (m) => {
              m.stopPropagation(), r(h.id);
            },
            title: h.enabled ? "" : "",
            children: /* @__PURE__ */ c.jsx(Hb, { size: 14 })
          }
        ),
        /* @__PURE__ */ c.jsxs("div", { className: "flex-1 min-w-0", children: [
          /* @__PURE__ */ c.jsx("div", { className: "flex items-center justify-between", children: /* @__PURE__ */ c.jsx("h4", { className: `text-sm font-medium truncate ${t === h.id ? "text-foreground" : "text-muted-foreground group-hover:text-foreground"} ${!h.enabled && "opacity-50 line-through"}`, children: h.name }) }),
          /* @__PURE__ */ c.jsx("div", { className: "mt-0.5 flex items-center gap-2", children: /* @__PURE__ */ c.jsxs("code", { className: "text-[10px] bg-muted px-1 rounded text-muted-foreground font-mono truncate max-w-[120px]", children: [
            "/",
            h.pattern,
            "/",
            h.flags
          ] }) })
        ] }),
        /* @__PURE__ */ c.jsx("div", { className: `flex items-center ${t === h.id ? "opacity-100" : "opacity-0 group-hover:opacity-100"} transition-opacity`, children: /* @__PURE__ */ c.jsx(
          "button",
          {
            className: "p-1.5 hover:bg-destructive/10 rounded text-muted-foreground hover:text-destructive transition-colors",
            onClick: (m) => {
              m.stopPropagation(), i(h.id);
            },
            children: /* @__PURE__ */ c.jsx(pa, { size: 12 })
          }
        ) })
      ]
    },
    h.id
  )) }),
  e.length === 0 && /* @__PURE__ */ c.jsx("div", { className: "text-center p-8 border border-dashed border-border rounded-lg", children: /* @__PURE__ */ c.jsx("p", { className: "text-xs text-muted-foreground", children: "" }) })
] }), jhe = [
  { value: "g", label: "", description: "" },
  { value: "i", label: "", description: "" },
  { value: "m", label: "", description: "^$ " },
  { value: "s", label: "", description: ". " }
], L8 = ({ rule: e, onChange: t }) => {
  var h;
  const [n, r] = I.useState(""), [i, s] = I.useState(""), [a, u] = I.useState({ valid: !0 }), d = new PT();
  I.useEffect(() => {
    const m = d.validatePattern(e.pattern, e.flags);
    u(m);
  }, [e.pattern, e.flags]), I.useEffect(() => {
    if (n && a.valid) {
      const m = d.processWithRule(n, e);
      s(m);
    } else
      s("");
  }, [n, e, a.valid]);
  const f = (m) => {
    const x = e.flags.split(""), b = x.indexOf(m);
    b >= 0 ? x.splice(b, 1) : x.push(m), t({ flags: x.join("") });
  };
  return /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-4", children: [
    /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-3", children: [
      /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ c.jsx("label", { className: "text-sm font-medium text-foreground", children: "" }),
        /* @__PURE__ */ c.jsx(
          "input",
          {
            type: "text",
            className: "w-full px-3 py-2 rounded-md border border-input bg-background text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring",
            value: e.name,
            onChange: (m) => t({ name: m.target.value }),
            placeholder: ""
          }
        )
      ] }),
      /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ c.jsx("label", { className: "text-sm font-medium text-foreground", children: "" }),
        /* @__PURE__ */ c.jsx(
          "input",
          {
            type: "text",
            className: "w-full px-3 py-2 rounded-md border border-input bg-background text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring",
            value: e.description || "",
            onChange: (m) => t({ description: m.target.value }),
            placeholder: ""
          }
        )
      ] }),
      /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ c.jsx("label", { className: "text-sm font-medium text-foreground", children: "" }),
        /* @__PURE__ */ c.jsx("div", { className: "flex gap-2", children: F3.map((m) => /* @__PURE__ */ c.jsx(
          "button",
          {
            className: `flex-1 px-3 py-2 text-sm rounded-md border transition-colors ${e.scope === m.value ? "bg-primary-20 border-primary text-primary" : "bg-background border-border text-muted-foreground hover:bg-muted"}`,
            onClick: () => t({ scope: m.value }),
            title: m.description,
            children: m.label
          },
          m.value
        )) }),
        /* @__PURE__ */ c.jsx("p", { className: "text-xs text-muted-foreground", children: (h = F3.find((m) => m.value === e.scope)) == null ? void 0 : h.description })
      ] })
    ] }),
    /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-3 p-4 bg-card border border-border rounded-lg", children: [
      /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2", children: [
          /* @__PURE__ */ c.jsx("label", { className: "text-sm font-medium text-foreground", children: "" }),
          a.valid ? /* @__PURE__ */ c.jsx(U5, { size: 14, className: "text-green-500" }) : /* @__PURE__ */ c.jsx(_d, { size: 14, className: "text-red-500" })
        ] }),
        /* @__PURE__ */ c.jsx(
          "input",
          {
            type: "text",
            className: `w-full px-3 py-2 rounded-md border bg-background text-foreground font-mono text-sm placeholder:text-muted-foreground focus:outline-none focus:ring-2 ${a.valid ? "border-input focus:ring-ring" : "border-red-500 focus:ring-red-500"}`,
            value: e.pattern,
            onChange: (m) => t({ pattern: m.target.value }),
            placeholder: "<think>[\\s\\S]*?</think>"
          }
        ),
        !a.valid && a.error && /* @__PURE__ */ c.jsx("p", { className: "text-xs text-red-500", children: a.error })
      ] }),
      /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ c.jsx("label", { className: "text-sm font-medium text-foreground", children: "" }),
        /* @__PURE__ */ c.jsx(
          "input",
          {
            type: "text",
            className: "w-full px-3 py-2 rounded-md border border-input bg-background text-foreground font-mono text-sm placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring",
            value: e.replacement,
            onChange: (m) => t({ replacement: m.target.value }),
            placeholder: ""
          }
        )
      ] }),
      /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ c.jsx("label", { className: "text-sm font-medium text-foreground", children: "" }),
        /* @__PURE__ */ c.jsx("div", { className: "flex flex-wrap gap-2", children: jhe.map((m) => /* @__PURE__ */ c.jsxs(
          "button",
          {
            className: `px-2 py-1 text-xs rounded-md border transition-colors ${e.flags.includes(m.value) ? "bg-primary-20 border-primary text-primary" : "bg-background border-border text-muted-foreground hover:bg-muted"}`,
            onClick: () => f(m.value),
            title: m.description,
            children: [
              m.label,
              " (",
              m.value,
              ")"
            ]
          },
          m.value
        )) })
      ] })
    ] }),
    /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-3 p-4 bg-muted-20 border border-border rounded-lg", children: [
      /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2 text-sm font-medium text-foreground", children: [
        /* @__PURE__ */ c.jsx(Sd, { size: 14 }),
        ""
      ] }),
      /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ c.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
        /* @__PURE__ */ c.jsx(
          "textarea",
          {
            className: "w-full min-h-[80px] px-3 py-2 rounded-md border border-input bg-background text-foreground text-sm resize-y focus:outline-none focus:ring-2 focus:ring-ring",
            value: n,
            onChange: (m) => r(m.target.value),
            placeholder: `
<think></think>
`
          }
        )
      ] }),
      n && a.valid && /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-1.5", children: [
        /* @__PURE__ */ c.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
        /* @__PURE__ */ c.jsx("div", { className: "min-h-[60px] px-3 py-2 rounded-md border border-border bg-background text-sm whitespace-pre-wrap", children: i || /* @__PURE__ */ c.jsx("span", { className: "text-muted-foreground italic", children: "" }) })
      ] })
    ] }),
    /* @__PURE__ */ c.jsxs("div", { className: "flex items-start gap-2 p-3 bg-blue-500/10 border border-blue-500/30 rounded-lg text-sm text-blue-400", children: [
      /* @__PURE__ */ c.jsx(Sz, { size: 16, className: "shrink-0 mt-0.5" }),
      /* @__PURE__ */ c.jsxs("div", { children: [
        /* @__PURE__ */ c.jsx("strong", { children: "" }),
        " LLM ",
        /* @__PURE__ */ c.jsx("strong", { children: "" }),
        " LLM  ",
        /* @__PURE__ */ c.jsx("code", { className: "bg-blue-500/20 px-1 rounded", children: "<think>" }),
        ""
      ] })
    ] })
  ] });
}, Ahe = ({
  config: e,
  onChange: t,
  worldbookStructure: n = {},
  disabledEntries: r = {},
  onToggleWorldbook: i,
  onToggleEntry: s,
  onRefresh: a
}) => {
  const [u, d] = I.useState(/* @__PURE__ */ new Set()), [f, h] = I.useState(""), m = (T) => {
    t({
      ...e,
      [T]: !e[T]
    });
  }, x = (T) => {
    const R = new Set(u);
    R.has(T) ? R.delete(T) : R.add(T), d(R);
  }, b = (T) => {
    var R;
    return ((R = e.disabledWorldbooks) == null ? void 0 : R.includes(T)) || !1;
  }, w = (T, R) => {
    var N;
    return ((N = r[T]) == null ? void 0 : N.includes(R)) || !1;
  }, C = Object.keys(n).sort().filter(
    (T) => T.toLowerCase().includes(f.toLowerCase()) || n[T].some(
      (R) => {
        var N, M;
        return ((N = R.names) == null ? void 0 : N.join(" ").toLowerCase().includes(f.toLowerCase())) || ((M = R.comment) == null ? void 0 : M.toLowerCase().includes(f.toLowerCase()));
      }
    )
  );
  return /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-6", children: [
    /* @__PURE__ */ c.jsxs(ls, { title: "", description: "", children: [
      /* @__PURE__ */ c.jsx(
        Zo,
        {
          label: "",
          description: "",
          checked: e.enabled,
          onChange: () => m("enabled")
        }
      ),
      /* @__PURE__ */ c.jsx(
        Zo,
        {
          label: "",
          description: " / ",
          checked: e.includeGlobal,
          onChange: () => m("includeGlobal"),
          disabled: !e.enabled
        }
      ),
      /* @__PURE__ */ c.jsx(
        Zo,
        {
          label: " EJS  (ST-Prompt-Template)",
          description: "[]  WorldInfo  EJS  ST-Prompt-Template",
          checked: e.enableEJS ?? !0,
          onChange: () => m("enableEJS"),
          disabled: !e.enabled
        }
      )
    ] }),
    e.enabled && /* @__PURE__ */ c.jsxs(ls, { title: "", description: "", children: [
      /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between mb-4 gap-4", children: [
        /* @__PURE__ */ c.jsxs("div", { className: "relative flex-1", children: [
          /* @__PURE__ */ c.jsx(Ai, { className: "absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground w-4 h-4" }),
          /* @__PURE__ */ c.jsx(
            "input",
            {
              type: "text",
              placeholder: "...",
              className: "w-full h-9 pl-9 pr-3 rounded-md border border-input bg-transparent text-sm shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring",
              value: f,
              onChange: (T) => h(T.target.value)
            }
          )
        ] }),
        /* @__PURE__ */ c.jsx(
          "button",
          {
            onClick: a,
            className: "inline-flex items-center justify-center rounded-md w-9 h-9 hover:bg-accent hover:text-accent-foreground transition-colors",
            title: "",
            children: /* @__PURE__ */ c.jsx(fr, { size: 16 })
          }
        )
      ] }),
      /* @__PURE__ */ c.jsx("div", { className: "flex flex-col gap-2", children: C.length === 0 ? /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col items-center justify-center py-8 text-muted-foreground gap-2 border border-dashed rounded-lg", children: [
        /* @__PURE__ */ c.jsx(_d, { size: 24, className: "opacity-50" }),
        /* @__PURE__ */ c.jsx("span", { className: "text-sm", children: "" })
      ] }) : C.map((T) => {
        const R = b(T), N = n[T] || [], M = u.has(T), P = N.filter((D) => !w(T, D.uid)).length;
        return /* @__PURE__ */ c.jsxs("div", { className: `transition-all border-b border-border last:border-0 ${R ? "bg-muted/10 opacity-60 grayscale" : ""}`, children: [
          /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between p-3", children: [
            /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-3 flex-1 overflow-hidden", children: [
              /* @__PURE__ */ c.jsx(
                "button",
                {
                  onClick: () => x(T),
                  className: "p-1 hover:bg-accent rounded-sm transition-colors",
                  children: M ? /* @__PURE__ */ c.jsx(Yu, { size: 16 }) : /* @__PURE__ */ c.jsx(nc, { size: 16 })
                }
              ),
              /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2 min-w-0", children: [
                /* @__PURE__ */ c.jsx(Ky, { size: 16, className: R ? "text-muted-foreground" : "text-primary" }),
                /* @__PURE__ */ c.jsx("span", { className: `font-medium truncate ${R ? "text-muted-foreground line-through" : ""}`, children: T }),
                /* @__PURE__ */ c.jsxs("span", { className: "text-xs text-muted-foreground px-2 py-0.5 bg-muted rounded-full whitespace-nowrap", children: [
                  P,
                  " / ",
                  N.length,
                  " "
                ] })
              ] })
            ] }),
            /* @__PURE__ */ c.jsx("div", { className: "flex items-center gap-4", children: /* @__PURE__ */ c.jsx(
              Zo,
              {
                label: "",
                checked: !R,
                onChange: (D) => i == null ? void 0 : i(T, !D),
                compact: !0
              }
            ) })
          ] }),
          M && !R && /* @__PURE__ */ c.jsx("div", { className: "pl-4 pr-1 py-1 flex flex-col gap-0 animate-in slide-in-from-top-1 duration-200", children: N.length === 0 ? /* @__PURE__ */ c.jsx("div", { className: "text-xs text-muted-foreground text-center py-4", children: "" }) : N.map((D) => {
            const q = w(T, D.uid);
            return /* @__PURE__ */ c.jsxs("div", { className: `flex items-start justify-between py-2 -mx-2 px-2 rounded hover:bg-accent/40 transition-colors group ${q ? "bg-muted/10 opacity-60 grayscale" : ""}`, children: [
              /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-1 min-w-0 flex-1 pr-4", children: [
                /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2 flex-wrap min-w-0", children: [
                  /* @__PURE__ */ c.jsx(
                    "div",
                    {
                      className: `w-1.5 h-1.5 rounded-full flex-shrink-0 ${D.constant ? "bg-primary" : "bg-emerald-500"}`,
                      title: D.constant ? " (Constant)" : " (Selective)"
                    }
                  ),
                  /* @__PURE__ */ c.jsx("span", { className: `text-sm font-medium truncate max-w-full ${q ? "text-muted-foreground line-through" : "text-foreground"}`, children: D.name || ` #${D.uid}` }),
                  (D.keys || []).length > 0 && /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-1 ml-auto md:ml-2 overflow-hidden max-w-full", children: [
                    D.keys.slice(0, 3).map((Y, te) => /* @__PURE__ */ c.jsx("span", { className: "text-[10px] px-1 py-0.5 rounded border border-border bg-muted/20 text-muted-foreground whitespace-nowrap overflow-hidden text-ellipsis max-w-[80px]", children: Y }, te)),
                    D.keys.length > 3 && /* @__PURE__ */ c.jsxs("span", { className: "text-[10px] text-muted-foreground", children: [
                      "+",
                      D.keys.length - 3
                    ] })
                  ] })
                ] }),
                (D.comment || D.content) && /* @__PURE__ */ c.jsx("p", { className: "text-xs text-muted-foreground/80 pl-3.5 break-words line-clamp-2", children: D.comment || D.content })
              ] }),
              /* @__PURE__ */ c.jsx("div", { className: "flex-shrink-0", children: /* @__PURE__ */ c.jsx(
                Zo,
                {
                  label: "",
                  checked: !q,
                  onChange: (Y) => s == null ? void 0 : s(T, D.uid, !Y),
                  compact: !0
                }
              ) })
            ] }, D.uid);
          }) })
        ] }, T);
      }) })
    ] })
  ] });
}, Nhe = ({
  macros: e,
  selectedId: t,
  onSelect: n,
  onAdd: r,
  onToggle: i,
  onDelete: s
}) => /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-4 h-full", children: [
  /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between gap-2", children: [
    /* @__PURE__ */ c.jsx("h3", { className: "text-xs font-bold text-muted-foreground uppercase tracking-wider", children: "" }),
    /* @__PURE__ */ c.jsx(
      "button",
      {
        className: "text-muted-foreground hover:text-foreground transition-colors",
        onClick: r,
        title: "",
        children: /* @__PURE__ */ c.jsx(Ub, { size: 16 })
      }
    )
  ] }),
  /* @__PURE__ */ c.jsxs("div", { className: "text-xs text-muted-foreground bg-muted/30 rounded px-2 py-1.5 border border-border/50 leading-relaxed", children: [
    " ",
    /* @__PURE__ */ c.jsx("code", { className: "bg-muted px-1 rounded", children: "{{}}" }),
    " "
  ] }),
  /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-1 overflow-y-auto flex-1 no-scrollbar", children: [
    e.map((a) => /* @__PURE__ */ c.jsxs(
      "div",
      {
        className: `
                            group p-3 rounded-lg transition-all duration-200 cursor-pointer border flex items-center gap-3
                            ${t === a.id ? "bg-accent/50 border-input" : "bg-transparent border-transparent hover:bg-muted/50 hover:border-border"}
                            ${!a.enabled && "opacity-50"}
                        `,
        onClick: () => n(a),
        children: [
          /* @__PURE__ */ c.jsx(
            "button",
            {
              className: `
                                w-8 h-8 flex items-center justify-center rounded-lg transition-colors flex-shrink-0
                                ${a.enabled ? t === a.id ? "bg-primary/20 text-primary" : "bg-muted text-primary" : "bg-muted text-muted-foreground"}
                            `,
              onClick: (u) => {
                u.stopPropagation(), i(a.id);
              },
              title: a.enabled ? "" : "",
              children: /* @__PURE__ */ c.jsx(Hb, { size: 14 })
            }
          ),
          /* @__PURE__ */ c.jsxs("div", { className: "flex-1 min-w-0", children: [
            /* @__PURE__ */ c.jsx("div", { className: "flex items-center gap-2", children: /* @__PURE__ */ c.jsx("code", { className: `text-sm font-medium truncate ${t === a.id ? "text-primary" : "text-foreground"}`, children: `{{${a.name}}}` }) }),
            /* @__PURE__ */ c.jsx("p", { className: "mt-0.5 text-[10px] text-muted-foreground truncate", children: a.content ? a.content.slice(0, 50) + (a.content.length > 50 ? "..." : "") : "()" })
          ] }),
          /* @__PURE__ */ c.jsx(
            "button",
            {
              className: `p-1.5 hover:bg-destructive/10 rounded text-muted-foreground hover:text-destructive transition-colors ${t === a.id ? "opacity-100" : "opacity-0 group-hover:opacity-100"}`,
              onClick: (u) => {
                u.stopPropagation(), s(a.id);
              },
              title: "",
              children: /* @__PURE__ */ c.jsx(pa, { size: 12 })
            }
          )
        ]
      },
      a.id
    )),
    e.length === 0 && /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col items-center justify-center py-12 text-muted-foreground gap-2 border border-dashed border-border rounded-lg", children: [
      /* @__PURE__ */ c.jsx(yz, { size: 24, className: "opacity-50" }),
      /* @__PURE__ */ c.jsx("p", { className: "text-xs", children: "" }),
      /* @__PURE__ */ c.jsx(
        "button",
        {
          className: "text-xs text-primary hover:underline",
          onClick: r,
          children: ""
        }
      )
    ] })
  ] })
] }), B8 = ({
  macro: e,
  onChange: t
}) => /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-4", children: [
  /* @__PURE__ */ c.jsx(ls, { title: "", children: /* @__PURE__ */ c.jsx(
    us,
    {
      label: "",
      value: e.name,
      onChange: (n) => t({ name: n }),
      placeholder: "",
      required: !0,
      description: " {{}} "
    }
  ) }),
  /* @__PURE__ */ c.jsx(ls, { title: "", children: /* @__PURE__ */ c.jsx(
    us,
    {
      label: "",
      value: e.content,
      onChange: (n) => t({ content: n }),
      placeholder: "",
      multiline: !0,
      rows: 8
    }
  ) }),
  /* @__PURE__ */ c.jsxs("div", { className: "px-3 py-2 bg-muted/30 rounded border border-border", children: [
    /* @__PURE__ */ c.jsx("div", { className: "text-[10px] text-muted-foreground mb-2 font-medium uppercase tracking-wider", children: "" }),
    /* @__PURE__ */ c.jsxs("div", { className: "text-xs text-muted-foreground leading-relaxed", children: [
      /* @__PURE__ */ c.jsxs("p", { children: [
        " ",
        /* @__PURE__ */ c.jsx("code", { className: "px-1 py-0.5 bg-muted rounded text-primary font-mono", children: `{{${e.name || ""}}}` }),
        " "
      ] }),
      /* @__PURE__ */ c.jsx("p", { className: "mt-1", children: " SillyTavern " })
    ] })
  ] })
] }), Rhe = ({
  profiles: e,
  selectedId: t,
  onSelect: n,
  onAdd: r,
  onDelete: i
}) => /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col h-full", children: [
  /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between mb-4 px-1", children: [
    /* @__PURE__ */ c.jsx("h3", { className: "text-xs font-bold text-muted-foreground uppercase tracking-wider", children: "" }),
    /* @__PURE__ */ c.jsx(
      "button",
      {
        className: "text-muted-foreground hover:text-foreground transition-colors p-1 rounded-md hover:bg-muted",
        onClick: r,
        title: "",
        children: /* @__PURE__ */ c.jsx(Ub, { size: 16 })
      }
    )
  ] }),
  /* @__PURE__ */ c.jsxs("div", { className: "flex-1 overflow-y-auto space-y-2 pr-1 custom-scrollbar", children: [
    e.map((s) => /* @__PURE__ */ c.jsx(
      "div",
      {
        className: `
                            group relative p-3 rounded-lg border transition-all cursor-pointer
                            ${t === s.id ? "bg-primary/10 border-primary shadow-sm" : "bg-card border-border hover:border-primary/50 hover:bg-muted/50"}
                        `,
        onClick: () => n(s),
        children: /* @__PURE__ */ c.jsxs("div", { className: "flex items-start gap-3", children: [
          /* @__PURE__ */ c.jsx("div", { className: `
                                p-2 rounded-md flex-shrink-0 transition-colors
                                ${t === s.id ? "bg-primary text-primary-foreground" : "bg-muted text-muted-foreground group-hover:bg-primary/10 group-hover:text-primary"}
                            `, children: /* @__PURE__ */ c.jsx(Ky, { size: 18 }) }),
          /* @__PURE__ */ c.jsxs("div", { className: "min-w-0 flex-1", children: [
            /* @__PURE__ */ c.jsx("h4", { className: `font-medium text-sm truncate ${t === s.id ? "text-primary" : "text-foreground"}`, children: s.name }),
            /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2 mt-1", children: [
              /* @__PURE__ */ c.jsx("span", { className: "text-[10px] uppercase font-bold text-muted-foreground/70 bg-muted px-1.5 py-0.5 rounded", children: s.mode === "custom" ? "" : "" }),
              s.mode === "custom" && /* @__PURE__ */ c.jsxs("span", { className: "text-xs text-muted-foreground truncate", children: [
                s.selectedWorldbooks.length,
                " "
              ] })
            ] })
          ] }),
          /* @__PURE__ */ c.jsx(
            "button",
            {
              className: "opacity-0 group-hover:opacity-100 p-1.5 text-muted-foreground hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-950/30 rounded-md transition-all absolute right-2 top-2",
              onClick: (a) => {
                a.stopPropagation(), confirm("") && i(s.id);
              },
              children: /* @__PURE__ */ c.jsx(pa, { size: 14 })
            }
          )
        ] })
      },
      s.id
    )),
    e.length === 0 && /* @__PURE__ */ c.jsxs("div", { className: "text-center py-8 text-muted-foreground text-sm border-2 border-dashed border-muted rounded-lg", children: [
      /* @__PURE__ */ c.jsx("p", { children: "" }),
      /* @__PURE__ */ c.jsx(
        "button",
        {
          className: "mt-2 text-primary hover:underline text-xs",
          onClick: r,
          children: ""
        }
      )
    ] })
  ] })
] }), Mhe = ({
  profile: e,
  onChange: t,
  availableWorldbooks: n,
  charWorldbooks: r = []
}) => {
  const [i, s] = I.useState(""), a = n.filter(
    (d) => d.toLowerCase().includes(i.toLowerCase())
  ), u = (d) => {
    const f = e.selectedWorldbooks || [], h = f.includes(d);
    let m;
    h ? m = f.filter((x) => x !== d) : m = [...f, d], t(e.id, { selectedWorldbooks: m });
  };
  return /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col h-full bg-card rounded-lg border border-border overflow-hidden", children: [
    /* @__PURE__ */ c.jsxs("div", { className: "p-4 border-b border-border bg-muted/20", children: [
      /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-3 mb-4", children: [
        /* @__PURE__ */ c.jsx("div", { className: "p-2.5 bg-primary/10 text-primary rounded-lg", children: /* @__PURE__ */ c.jsx(Ky, { size: 24 }) }),
        /* @__PURE__ */ c.jsxs("div", { children: [
          /* @__PURE__ */ c.jsx("h2", { className: "text-lg font-semibold tracking-tight", children: "" }),
          /* @__PURE__ */ c.jsx("p", { className: "text-sm text-muted-foreground", children: "" })
        ] })
      ] }),
      /* @__PURE__ */ c.jsxs("div", { className: "grid grid-cols-1 md:grid-cols-2 gap-4", children: [
        /* @__PURE__ */ c.jsx(
          us,
          {
            label: "",
            value: e.name,
            onChange: (d) => t(e.id, { name: d }),
            placeholder: ""
          }
        ),
        /* @__PURE__ */ c.jsx(
          el,
          {
            label: "",
            value: e.mode,
            onChange: (d) => t(e.id, { mode: d }),
            options: [
              { value: "custom", label: " ()" },
              { value: "inherit_global", label: " ()" }
            ]
          }
        )
      ] }),
      /* @__PURE__ */ c.jsxs("div", { className: "mt-2 text-xs text-muted-foreground flex items-center gap-1.5 p-2 bg-blue-500/5 text-blue-600 dark:text-blue-400 rounded border border-blue-500/10", children: [
        /* @__PURE__ */ c.jsx(Sz, { size: 14, className: "flex-shrink-0" }),
        /* @__PURE__ */ c.jsx("span", { children: '""' })
      ] })
    ] }),
    e.mode === "custom" && /* @__PURE__ */ c.jsxs("div", { className: "flex-1 flex flex-col min-h-0", children: [
      /* @__PURE__ */ c.jsxs("div", { className: "p-3 border-b border-border flex items-center gap-2 bg-muted/10", children: [
        /* @__PURE__ */ c.jsx(Ai, { size: 16, className: "text-muted-foreground ml-2" }),
        /* @__PURE__ */ c.jsx(
          "input",
          {
            type: "text",
            value: i,
            onChange: (d) => s(d.target.value),
            placeholder: "...",
            className: "flex-1 bg-transparent border-none text-sm focus:outline-none placeholder:text-muted-foreground/50 h-8"
          }
        ),
        /* @__PURE__ */ c.jsx(
          "button",
          {
            onClick: () => {
              confirm("") && t(e.id, { selectedWorldbooks: r });
            },
            className: "text-xs text-primary hover:text-primary/80 px-2 py-1 rounded hover:bg-primary/5 transition-colors",
            title: "",
            children: ""
          }
        ),
        /* @__PURE__ */ c.jsxs("div", { className: "text-xs text-muted-foreground mr-2", children: [
          ": ",
          e.selectedWorldbooks.length,
          " / ",
          n.length
        ] })
      ] }),
      /* @__PURE__ */ c.jsx("div", { className: "flex-1 overflow-y-auto p-2 custom-scrollbar", children: /* @__PURE__ */ c.jsx("div", { className: "grid grid-cols-1 gap-1", children: a.length > 0 ? a.map((d) => {
        var m;
        const f = (m = e.selectedWorldbooks) == null ? void 0 : m.includes(d), h = r.includes(d);
        return /* @__PURE__ */ c.jsxs(
          "div",
          {
            onClick: () => u(d),
            className: `
                                                flex items-center gap-3 p-2.5 rounded-md cursor-pointer transition-colors border
                                                ${f ? "bg-primary/5 border-primary/30" : "bg-transparent border-transparent hover:bg-muted"}
                                            `,
            children: [
              /* @__PURE__ */ c.jsx("div", { className: `
                                                w-4 h-4 rounded border flex items-center justify-center transition-colors
                                                ${f ? "bg-primary border-primary text-primary-foreground" : "border-muted-foreground/50"}
                                            `, children: f && /* @__PURE__ */ c.jsx(vh, { size: 10, strokeWidth: 4 }) }),
              /* @__PURE__ */ c.jsxs("div", { className: "flex-1 min-w-0 flex items-center gap-2", children: [
                /* @__PURE__ */ c.jsx("span", { className: `text-sm truncate ${f ? "font-medium text-foreground" : "text-muted-foreground"}`, children: d }),
                h && /* @__PURE__ */ c.jsx("span", { className: "px-1.5 py-0.5 rounded text-[10px] font-medium bg-indigo-500/10 text-indigo-500 border border-indigo-500/20 whitespace-nowrap", children: "" })
              ] })
            ]
          },
          d
        );
      }) : /* @__PURE__ */ c.jsx("div", { className: "text-center py-8 text-muted-foreground text-sm", children: "" }) }) })
    ] })
  ] });
}, O_ = 768;
function j$() {
  const [e, t] = I.useState({
    isMobile: window.innerWidth < O_,
    isDesktop: window.innerWidth >= O_,
    windowWidth: window.innerWidth
  });
  return I.useEffect(() => {
    const n = () => {
      const r = window.innerWidth, i = r < O_;
      t({
        isMobile: i,
        isDesktop: !i,
        windowWidth: r
      });
    };
    return window.addEventListener("resize", n), n(), () => window.removeEventListener("resize", n);
  }, []), e;
}
const ny = ({
  title: e,
  onClose: t,
  children: n,
  actions: r
}) => /* @__PURE__ */ c.jsxs(
  "div",
  {
    className: "fixed inset-0 bg-background z-[200] flex flex-col animate-in slide-in-from-right-4 duration-200",
    style: { height: "100dvh", width: "100vw" },
    children: [
      /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-3 px-4 py-3 border-b border-border shrink-0", children: [
        /* @__PURE__ */ c.jsx(
          "button",
          {
            onClick: t,
            className: "p-1 hover:bg-accent rounded",
            children: /* @__PURE__ */ c.jsx($b, { size: 20 })
          }
        ),
        /* @__PURE__ */ c.jsx("h2", { className: "text-lg font-light flex-1", children: e }),
        r
      ] }),
      /* @__PURE__ */ c.jsx("div", { className: "flex-1 overflow-y-auto p-4 no-scrollbar", children: n })
    ]
  }
), mm = ({
  list: e,
  detail: t,
  header: n,
  listWidth: r = "30%",
  mobileDetailOpen: i = !1,
  onMobileDetailClose: s,
  mobileDetailTitle: a = "",
  mobileDetailActions: u,
  className: d = "",
  style: f
}) => {
  const { isMobile: h } = j$();
  return h && i ? /* @__PURE__ */ c.jsx(
    ny,
    {
      title: a,
      onClose: s || (() => {
      }),
      actions: u,
      children: t
    }
  ) : /* @__PURE__ */ c.jsxs("div", { className: `flex flex-col h-full overflow-hidden ${d}`, style: f, children: [
    n && /* @__PURE__ */ c.jsx("div", { className: "shrink-0 mb-4 px-1", children: n }),
    /* @__PURE__ */ c.jsxs("div", { className: "flex-1 flex gap-6 min-h-0 overflow-hidden", children: [
      /* @__PURE__ */ c.jsx(
        "div",
        {
          className: `
                        flex flex-col overflow-y-auto no-scrollbar
                        ${h ? "w-full" : "border-r border-border/50 pr-4"}
                    `,
          style: {
            width: h ? "100%" : r,
            minWidth: h ? "auto" : "240px"
          },
          children: e
        }
      ),
      !h && /* @__PURE__ */ c.jsx("div", { className: "flex-1 flex flex-col overflow-y-auto no-scrollbar", children: t })
    ] })
  ] });
}, th = ({
  icon: e = lV,
  title: t,
  description: n,
  action: r,
  className: i = ""
}) => /* @__PURE__ */ c.jsxs("div", { className: `flex flex-col items-center justify-center p-8 text-muted-foreground gap-4 h-full min-h-[200px] animate-in fade-in duration-300 ${i}`, children: [
  /* @__PURE__ */ c.jsx("div", { className: "p-4 bg-muted/30 rounded-full", children: /* @__PURE__ */ c.jsx(e, { size: 48, className: "opacity-20 text-foreground" }) }),
  /* @__PURE__ */ c.jsxs("div", { className: "text-center space-y-1 max-w-[280px]", children: [
    /* @__PURE__ */ c.jsx("h3", { className: "text-sm font-medium text-foreground", children: t }),
    n && /* @__PURE__ */ c.jsx("p", { className: "text-xs text-muted-foreground/80 leading-relaxed", children: n })
  ] }),
  r && /* @__PURE__ */ c.jsx("div", { className: "mt-2", children: r })
] });
function Ohe(e, t) {
  const n = [];
  for (const i of e.filter((s) => s.isBuiltIn)) {
    let s = t.find((a) => a.id === i.id);
    s || (s = t.find(
      (a) => a.isBuiltIn && a.category === i.category && a.name === i.name
    )), s ? n.push({ ...s, id: i.id }) : n.push(i);
  }
  const r = t.filter((i) => !i.isBuiltIn);
  return n.push(...r), n;
}
function Dhe() {
  const [e, t] = I.useState(Rm), [n, r] = I.useState(null), [i, s] = I.useState(null), [a, u] = I.useState(!1);
  I.useEffect(() => {
    var M;
    const N = it.get("apiSettings");
    if (N) {
      const P = Rm();
      t({
        ...P,
        ...N,
        llmPresets: ((M = N.llmPresets) == null ? void 0 : M.length) > 0 ? N.llmPresets : P.llmPresets,
        promptTemplates: Ohe(
          P.promptTemplates,
          N.promptTemplates || []
        )
      });
    }
  }, []);
  const d = I.useCallback((N) => {
    t((M) => ({ ...M, selectedPresetId: N.id })), r(N);
  }, []), f = I.useCallback(() => {
    const N = lT(` ${e.llmPresets.length + 1}`);
    N.isDefault = !1, t((M) => ({
      ...M,
      llmPresets: [...M.llmPresets, N],
      selectedPresetId: N.id
    })), r(N), u(!0);
  }, [e.llmPresets.length]), h = I.useCallback((N) => {
    t((M) => ({
      ...M,
      llmPresets: M.llmPresets.map((P) => P.id === N.id ? N : P)
    })), r(N), u(!0);
  }, []), m = I.useCallback((N) => {
    const M = {
      ...N,
      id: `preset_${Date.now()}`,
      name: `${N.name} ()`,
      isDefault: !1,
      createdAt: Date.now(),
      updatedAt: Date.now()
    };
    t((P) => ({ ...P, llmPresets: [...P.llmPresets, M] })), u(!0);
  }, []), x = I.useCallback((N) => {
    N.isDefault || (t((M) => ({
      ...M,
      llmPresets: M.llmPresets.filter((P) => P.id !== N.id),
      selectedPresetId: M.selectedPresetId === N.id ? null : M.selectedPresetId
    })), r((M) => (M == null ? void 0 : M.id) === N.id ? null : M), u(!0));
  }, []), b = I.useCallback((N) => {
    s(N);
  }, []), w = I.useCallback((N) => {
    t((M) => ({
      ...M,
      promptTemplates: [...M.promptTemplates, N]
    })), u(!0);
  }, []), S = I.useCallback((N) => {
    t((M) => ({
      ...M,
      promptTemplates: M.promptTemplates.map((P) => P.id === N.id ? N : P)
    })), s(N), u(!0);
  }, []), C = I.useCallback((N) => {
    N.isBuiltIn || (t((M) => ({
      ...M,
      promptTemplates: M.promptTemplates.filter((P) => P.id !== N.id)
    })), s((M) => (M == null ? void 0 : M.id) === N.id ? null : M), u(!0));
  }, []), T = I.useCallback(() => {
    const N = Xy();
    t((M) => {
      const P = M.promptTemplates.filter((D) => !D.isBuiltIn);
      return {
        ...M,
        promptTemplates: [...N, ...P]
      };
    }), s(null), u(!0);
  }, []), R = I.useCallback(() => {
    const N = it.get("apiSettings") || {};
    it.set("apiSettings", {
      ...N,
      llmPresets: e.llmPresets,
      selectedPresetId: e.selectedPresetId,
      promptTemplates: e.promptTemplates
    }), u(!1);
  }, [e]);
  return {
    llmPresets: e.llmPresets,
    selectedPresetId: e.selectedPresetId,
    promptTemplates: e.promptTemplates,
    editingPreset: n,
    editingTemplate: i,
    hasChanges: a,
    selectPreset: d,
    addPreset: f,
    updatePreset: h,
    copyPreset: m,
    deletePreset: x,
    selectTemplate: b,
    addTemplate: w,
    updateTemplate: S,
    deleteTemplate: C,
    resetAllTemplates: T,
    saveLLMSettings: R
  };
}
function A$() {
  const e = Rm(), [t, n] = I.useState(e.vectorConfig), [r, i] = I.useState(e.rerankConfig), [s, a] = I.useState(e.recallConfig), [u, d] = I.useState(e.regexConfig), [f, h] = I.useState(e.entityExtractConfig || { enabled: !1, trigger: "floor", floorInterval: 10, keepRecentCount: 5 }), [m, x] = I.useState(e.embeddingConfig || PP), [b, w] = I.useState(e.customMacros || []), [S, C] = I.useState(!1);
  I.useEffect(() => {
    const G = it.get("apiSettings");
    G && (G.vectorConfig && n(G.vectorConfig), G.rerankConfig && i(G.rerankConfig), G.recallConfig && a(G.recallConfig), G.regexConfig && d(G.regexConfig), G.entityExtractConfig && h(G.entityExtractConfig), G.embeddingConfig && x(G.embeddingConfig), G.customMacros && w(G.customMacros));
  }, []);
  const T = I.useCallback((G) => {
    n(G), C(!0);
  }, []), R = I.useCallback((G) => {
    i(G), C(!0);
  }, []), N = I.useCallback((G) => {
    a(G), C(!0);
  }, []), M = I.useCallback((G) => {
    d(G), C(!0);
  }, []), P = I.useCallback((G) => {
    h(G), C(!0);
  }, []), D = I.useCallback((G) => {
    x(G), C(!0);
  }, []), q = I.useCallback(() => {
    const G = {
      id: `custom_${Date.now()}`,
      name: "",
      content: "",
      enabled: !0,
      createdAt: Date.now()
    };
    w((le) => [...le, G]), C(!0);
  }, []), Y = I.useCallback((G, le) => {
    w((Z) => Z.map((oe) => oe.id === G ? { ...oe, ...le } : oe)), C(!0);
  }, []), te = I.useCallback((G) => {
    w((le) => le.filter((Z) => Z.id !== G)), C(!0);
  }, []), V = I.useCallback((G) => {
    w((le) => le.map((Z) => Z.id === G ? { ...Z, enabled: !Z.enabled } : Z)), C(!0);
  }, []), $ = I.useCallback(() => {
    const G = it.get("apiSettings") || {};
    it.set("apiSettings", {
      ...G,
      vectorConfig: t,
      rerankConfig: r,
      recallConfig: s,
      regexConfig: u,
      entityExtractConfig: f,
      embeddingConfig: m,
      // New
      customMacros: b
    }), C(!1);
  }, [t, r, s, u, f, m, b]);
  return {
    vectorConfig: t,
    rerankConfig: r,
    recallConfig: s,
    regexConfig: u,
    entityExtractConfig: f,
    embeddingConfig: m,
    customMacros: b,
    updateVectorConfig: T,
    updateRerankConfig: R,
    updateRecallConfig: N,
    updateRegexConfig: M,
    updateEntityExtractConfig: P,
    updateEmbeddingConfig: D,
    addCustomMacro: q,
    updateCustomMacro: Y,
    deleteCustomMacro: te,
    toggleCustomMacro: V,
    saveConfig: $,
    hasChanges: S
  };
}
function zhe() {
  const [e, t] = I.useState([...jy]), [n, r] = I.useState(null), [i, s] = I.useState(!1);
  I.useEffect(() => {
    const w = it.getRegexRules();
    w && w.length > 0 && t(w);
  }, []);
  const a = I.useCallback((w) => {
    const S = e.find((C) => C.id === w);
    r(S || null);
  }, [e]), u = I.useCallback(() => {
    const w = {
      id: `rule_${Date.now()}`,
      name: "",
      pattern: "",
      replacement: "",
      enabled: !0,
      flags: "gi",
      scope: "both",
      description: ""
    };
    t((S) => [...S, w]), r(w), s(!0);
  }, []), d = I.useCallback((w) => {
    if (!n) return;
    const S = { ...n, ...w };
    r(S), t((C) => C.map((T) => T.id === S.id ? S : T)), s(!0);
  }, [n]), f = I.useCallback((w) => {
    t((S) => S.map(
      (C) => C.id === w ? { ...C, enabled: !C.enabled } : C
    )), s(!0);
  }, []), h = I.useCallback((w) => {
    t((S) => S.filter((C) => C.id !== w)), r((S) => (S == null ? void 0 : S.id) === w ? null : S), s(!0);
  }, []), m = I.useCallback(() => {
    t([...jy]), r(null), s(!0);
  }, []), x = I.useCallback((w) => {
    t(w), s(!0);
  }, []), b = I.useCallback(async () => {
    it.setRegexRules(e);
    const { regexProcessor: w } = await Promise.resolve().then(() => $T);
    w.setRules(e), s(!1);
  }, [e]);
  return {
    regexRules: e,
    editingRule: n,
    hasChanges: i,
    selectRule: a,
    addRule: u,
    updateRule: d,
    toggleRule: f,
    deleteRule: h,
    resetRules: m,
    reorderRules: x,
    saveRegexRules: b
  };
}
function Phe() {
  var Y, te;
  const [e, t] = I.useState({}), [n, r] = I.useState({}), [i, s] = I.useState([]), [a, u] = I.useState(null), [d, f] = I.useState(((Y = it.get("apiSettings")) == null ? void 0 : Y.worldbookConfig) || Rm().worldbookConfig), [h, m] = I.useState(((te = it.get("apiSettings")) == null ? void 0 : te.worldbookProfiles) || []), [x, b] = I.useState({ global: [], chat: [], installed: [] }), [w, S] = I.useState(!1), C = I.useCallback(async () => {
    var X;
    const V = await Ba.getWorldbookStructure();
    t(V);
    const $ = Ba.getScopes();
    b($);
    const G = Ps(), le = (X = G == null ? void 0 : G.getCharWorldbookNames) == null ? void 0 : X.call(G, "current");
    if (le != null && le.primary) {
      u(le.primary);
      const ce = await nb.loadState(le.primary);
      ce.disabledEntries && r(ce.disabledEntries);
    }
    const Z = it.get("apiSettings"), oe = Z == null ? void 0 : Z.worldbookConfig;
    f(oe), oe != null && oe.disabledWorldbooks && s(oe.disabledWorldbooks), m((Z == null ? void 0 : Z.worldbookProfiles) || []);
  }, []);
  I.useEffect(() => {
    C();
  }, [C]);
  const T = I.useCallback((V, $) => {
    s((G) => {
      const le = $ ? [.../* @__PURE__ */ new Set([...G, V])] : G.filter((Z) => Z !== V);
      return f((Z) => Z ? { ...Z, disabledWorldbooks: le } : { ...Rm().worldbookConfig, disabledWorldbooks: le }), le;
    }), S(!0);
  }, []), R = I.useCallback((V, $, G) => {
    r((le) => {
      const Z = le[V] || [], oe = G ? [.../* @__PURE__ */ new Set([...Z, $])] : Z.filter((X) => X !== $);
      return { ...le, [V]: oe };
    }), S(!0);
  }, []), N = I.useCallback((V) => {
    f(V), V.disabledWorldbooks && s(V.disabledWorldbooks), S(!0);
  }, []), M = I.useCallback((V) => {
    m(($) => [...$, V]), S(!0);
  }, []), P = I.useCallback((V, $) => {
    m((G) => G.map((le) => le.id === V ? { ...le, ...$, updatedAt: Date.now() } : le)), S(!0);
  }, []), D = I.useCallback((V) => {
    m(($) => $.filter((G) => G.id !== V)), S(!0);
  }, []), q = I.useCallback(async () => {
    const V = it.get("apiSettings") || {}, $ = {
      ...V.worldbookConfig,
      ...d,
      disabledWorldbooks: i
    };
    it.set("apiSettings", {
      ...V,
      worldbookConfig: $,
      worldbookProfiles: h
    }), a && await nb.saveState(a, {
      disabledEntries: n
    }), S(!1);
  }, [i, n, a, d, h]);
  return {
    worldbookStructure: e,
    disabledEntries: n,
    disabledWorldbooks: i,
    currentCharWorldbook: a,
    worldbookConfig: d,
    worldbookProfiles: h,
    worldbookScopes: x,
    toggleWorldbook: T,
    toggleEntry: R,
    updateWorldbookConfig: N,
    addProfile: M,
    updateProfile: P,
    deleteProfile: D,
    refreshWorldbooks: C,
    saveWorldInfo: q,
    hasChanges: w
  };
}
const Ihe = [
  { id: "llm", label: "LLM ", icon: Fb },
  { id: "vector", label: "", icon: Yy },
  { id: "rerank", label: "Rerank", icon: Em }
], Lhe = {
  model: { title: "", subtitle: " LLM" },
  prompt: { title: "", subtitle: "" },
  regex: { title: "", subtitle: "" },
  worldbook: { title: "", subtitle: "" }
}, Bhe = ({ initialTab: e }) => {
  var bi;
  const [t, n] = I.useState(e || "model"), r = Lhe[t], [i, s] = I.useState("llm"), [a, u] = I.useState("templates"), [d, f] = I.useState("global"), [h, m] = I.useState(null), [x, b] = I.useState(null), { isMobile: w } = j$(), [S, C] = I.useState(!1);
  I.useEffect(() => {
    w || C(!1);
  }, [w]);
  const {
    llmPresets: T,
    selectedPresetId: R,
    promptTemplates: N,
    editingPreset: M,
    editingTemplate: P,
    hasChanges: D,
    selectPreset: q,
    addPreset: Y,
    updatePreset: te,
    copyPreset: V,
    deletePreset: $,
    selectTemplate: G,
    addTemplate: le,
    updateTemplate: Z,
    deleteTemplate: oe,
    resetAllTemplates: X,
    // V1.0.2
    saveLLMSettings: ce
  } = Dhe(), {
    vectorConfig: pe,
    rerankConfig: de,
    regexConfig: H,
    customMacros: J,
    updateVectorConfig: ge,
    updateRerankConfig: Q,
    updateRegexConfig: fe,
    addCustomMacro: ve,
    updateCustomMacro: Se,
    deleteCustomMacro: Me,
    toggleCustomMacro: Ie,
    saveConfig: Re,
    hasChanges: mt
  } = A$(), {
    regexRules: dt,
    editingRule: Je,
    hasChanges: ft,
    selectRule: yt,
    addRule: ht,
    updateRule: Le,
    toggleRule: Ye,
    deleteRule: gt,
    resetRules: Dt,
    reorderRules: pn,
    saveRegexRules: Ht
  } = zhe(), {
    worldbookConfig: zn,
    worldbookStructure: nn,
    disabledEntries: kn,
    worldbookProfiles: Nn,
    addProfile: $e,
    updateProfile: Qe,
    deleteProfile: bt,
    hasChanges: jt,
    updateWorldbookConfig: $t,
    toggleWorldbook: Un,
    toggleEntry: Hn,
    refreshWorldbooks: on,
    saveWorldInfo: Jt,
    worldbookScopes: fn
    // Added
  } = Phe(), nt = Object.keys(nn || {}), er = async () => {
    D && ce(), mt && Re(), ft && Ht(), jt && Jt();
  }, Pn = D || mt || ft || jt, sr = {
    llmPresets: T,
    selectedPresetId: R,
    vectorConfig: pe,
    rerankConfig: de,
    promptTemplates: N,
    regexConfig: H,
    customMacros: J
  }, st = (At) => {
    At(), w && C(!0);
  }, $r = () => {
    C(!1);
  }, Is = ["prompt", "regex"].includes(t) || t === "model" && i === "llm";
  if (w && S) {
    if (t === "model" && i === "llm" && M)
      return /* @__PURE__ */ c.jsx(
        ny,
        {
          title: " LLM ",
          onClose: $r,
          actions: Pn && /* @__PURE__ */ c.jsx("button", { className: "p-2 text-primary", onClick: er, children: /* @__PURE__ */ c.jsx(eh, { size: 18 }) }),
          children: /* @__PURE__ */ c.jsx(b6, { preset: M, onChange: te })
        }
      );
    if (t === "prompt") {
      if (a === "templates" && P)
        return /* @__PURE__ */ c.jsx(
          ny,
          {
            title: "",
            onClose: $r,
            actions: Pn && /* @__PURE__ */ c.jsx("button", { className: "p-2 text-primary", onClick: er, children: /* @__PURE__ */ c.jsx(eh, { size: 18 }) }),
            children: /* @__PURE__ */ c.jsx(
              E6,
              {
                template: P,
                llmPresets: sr.llmPresets,
                worldbookProfiles: Nn,
                defaultPresetId: sr.selectedPresetId,
                onChange: Z
              }
            )
          }
        );
      if (a === "macros") {
        const At = (sr.customMacros || []).find((tr) => tr.id === x);
        if (At)
          return /* @__PURE__ */ c.jsx(
            ny,
            {
              title: "",
              onClose: $r,
              actions: Pn && /* @__PURE__ */ c.jsx("button", { className: "p-2 text-primary", onClick: er, children: /* @__PURE__ */ c.jsx(eh, { size: 18 }) }),
              children: /* @__PURE__ */ c.jsx(
                B8,
                {
                  macro: At,
                  onChange: (tr) => Se(At.id, tr)
                }
              )
            }
          );
      }
    }
    if (t === "regex" && Je)
      return /* @__PURE__ */ c.jsx(
        ny,
        {
          title: "",
          onClose: $r,
          actions: Pn && /* @__PURE__ */ c.jsx("button", { className: "p-2 text-primary", onClick: er, children: /* @__PURE__ */ c.jsx(eh, { size: 18 }) }),
          children: /* @__PURE__ */ c.jsx(L8, { rule: Je, onChange: Le })
        }
      );
  }
  return /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col h-full animate-in fade-in", children: [
    /* @__PURE__ */ c.jsx(
      Gm,
      {
        breadcrumbs: ["API "],
        title: r.title,
        subtitle: r.subtitle,
        className: "mb-2"
      }
    ),
    /* @__PURE__ */ c.jsx(
      rx,
      {
        tabs: [
          { id: "model", label: "" },
          { id: "prompt", label: "" },
          { id: "regex", label: "" },
          { id: "worldbook", label: "" }
        ],
        activeTab: t,
        onChange: (At) => n(At),
        actions: Pn && /* @__PURE__ */ c.jsxs(
          "button",
          {
            className: "inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-primary hover:text-primary-foreground hover:bg-primary border border-primary/50 rounded transition-colors",
            onClick: er,
            children: [
              /* @__PURE__ */ c.jsx(eh, { size: 12 }),
              ""
            ]
          }
        )
      }
    ),
    /* @__PURE__ */ c.jsxs("div", { className: `flex-1 ${Is ? "overflow-hidden flex flex-col" : "overflow-y-auto no-scrollbar"}`, children: [
      t === "model" && /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-2", children: [
        /* @__PURE__ */ c.jsx(
          UL,
          {
            tabs: Ihe.map((At) => ({ ...At, icon: /* @__PURE__ */ c.jsx(At.icon, { size: 14 }) })),
            activeTab: i,
            onChange: (At) => s(At),
            sticky: !1,
            top: 0,
            className: "!mb-4"
          }
        ),
        i === "llm" && /* @__PURE__ */ c.jsx(
          mm,
          {
            className: "h-full",
            mobileDetailOpen: !1,
            onMobileDetailClose: $r,
            listWidth: "30%",
            list: /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-4", children: [
              /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between", children: [
                /* @__PURE__ */ c.jsx("h3", { className: "text-xs font-bold text-muted-foreground uppercase tracking-wider", children: "" }),
                /* @__PURE__ */ c.jsx("button", { className: "text-muted-foreground hover:text-foreground transition-colors", onClick: Y, children: /* @__PURE__ */ c.jsx(Ub, { size: 16 }) })
              ] }),
              /* @__PURE__ */ c.jsx("div", { className: "flex flex-col gap-1", children: sr.llmPresets.map((At) => /* @__PURE__ */ c.jsx(
                Nle,
                {
                  preset: At,
                  isSelected: sr.selectedPresetId === At.id,
                  onSelect: () => st(() => q(At)),
                  onEdit: () => st(() => q(At)),
                  onCopy: () => V(At),
                  onDelete: () => $(At)
                },
                At.id
              )) })
            ] }),
            detail: M ? /* @__PURE__ */ c.jsx("div", { className: "animate-in fade-in slide-in-from-right-2 duration-300", children: /* @__PURE__ */ c.jsx(b6, { preset: M, onChange: te }) }) : /* @__PURE__ */ c.jsx(
              th,
              {
                icon: Fb,
                title: "",
                description: ""
              }
            )
          }
        ),
        i === "vector" && /* @__PURE__ */ c.jsx(zle, { config: sr.vectorConfig, onChange: ge }),
        i === "rerank" && /* @__PURE__ */ c.jsx(Ple, { config: sr.rerankConfig, onChange: Q })
      ] }),
      t === "prompt" && /* @__PURE__ */ c.jsx(
        mm,
        {
          listWidth: "30%",
          list: /* @__PURE__ */ c.jsxs(c.Fragment, { children: [
            /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2 mb-4", children: [
              /* @__PURE__ */ c.jsx(
                "button",
                {
                  onClick: () => u("templates"),
                  className: `text-xs font-bold uppercase tracking-wider transition-colors ${a === "templates" ? "text-primary" : "text-muted-foreground hover:text-foreground"}`,
                  children: ""
                }
              ),
              /* @__PURE__ */ c.jsx("span", { className: "text-muted-foreground/30", children: "|" }),
              /* @__PURE__ */ c.jsx(
                "button",
                {
                  onClick: () => u("macros"),
                  className: `text-xs font-bold uppercase tracking-wider transition-colors ${a === "macros" ? "text-primary" : "text-muted-foreground hover:text-foreground"}`,
                  children: ""
                }
              )
            ] }),
            a === "templates" ? /* @__PURE__ */ c.jsx(
              $le,
              {
                templates: sr.promptTemplates,
                selectedId: (P == null ? void 0 : P.id) || null,
                onSelect: (At) => st(() => G(At)),
                onAdd: le,
                onUpdate: Z,
                onDelete: oe,
                onResetAll: X
              }
            ) : /* @__PURE__ */ c.jsx(
              Nhe,
              {
                macros: sr.customMacros || [],
                selectedId: x,
                onSelect: (At) => st(() => b(At.id)),
                onAdd: ve,
                onToggle: Ie,
                onDelete: Me
              }
            )
          ] }),
          detail: a === "templates" ? P ? /* @__PURE__ */ c.jsx("div", { className: "animate-in fade-in slide-in-from-right-2 duration-300", children: /* @__PURE__ */ c.jsx(
            E6,
            {
              template: P,
              llmPresets: sr.llmPresets,
              worldbookProfiles: Nn,
              defaultPresetId: sr.selectedPresetId,
              onChange: Z
            }
          ) }) : /* @__PURE__ */ c.jsx(
            th,
            {
              icon: ru,
              title: "",
              description: ""
            }
          ) : (() => {
            const At = (sr.customMacros || []).find((tr) => tr.id === x);
            return At ? /* @__PURE__ */ c.jsx("div", { className: "animate-in fade-in slide-in-from-right-2 duration-300", children: /* @__PURE__ */ c.jsx(
              B8,
              {
                macro: At,
                onChange: (tr) => Se(At.id, tr)
              }
            ) }) : /* @__PURE__ */ c.jsx(
              th,
              {
                icon: yz,
                title: "",
                description: ""
              }
            );
          })()
        }
      ),
      t === "regex" && /* @__PURE__ */ c.jsx(
        mm,
        {
          mobileDetailOpen: !1,
          onMobileDetailClose: $r,
          listWidth: "30%",
          list: /* @__PURE__ */ c.jsx(
            The,
            {
              rules: dt,
              selectedId: (Je == null ? void 0 : Je.id) || null,
              onSelect: (At) => st(() => yt(At)),
              onToggle: Ye,
              onDelete: gt,
              onAdd: ht,
              onReset: Dt,
              onReorder: pn,
              enableNativeRegex: ((bi = sr.regexConfig) == null ? void 0 : bi.enableNativeRegex) ?? !0,
              onToggleNativeRegex: (At) => fe({
                ...sr.regexConfig,
                enableNativeRegex: At
              })
            }
          ),
          detail: Je ? /* @__PURE__ */ c.jsx("div", { className: "animate-in fade-in slide-in-from-right-2 duration-300", children: /* @__PURE__ */ c.jsx(L8, { rule: Je, onChange: Le }) }) : /* @__PURE__ */ c.jsx(
            th,
            {
              icon: Cz,
              title: "",
              description: ""
            }
          )
        }
      ),
      t === "worldbook" && /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col h-full gap-2", children: [
        /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2 mb-2 px-1", children: [
          /* @__PURE__ */ c.jsx(
            "button",
            {
              onClick: () => f("global"),
              className: `text-xs font-bold uppercase tracking-wider transition-colors px-3 py-1.5 rounded-full ${d === "global" ? "bg-primary/10 text-primary" : "text-muted-foreground hover:text-foreground hover:bg-muted"}`,
              children: ""
            }
          ),
          /* @__PURE__ */ c.jsx(
            "button",
            {
              onClick: () => f("profiles"),
              className: `text-xs font-bold uppercase tracking-wider transition-colors px-3 py-1.5 rounded-full ${d === "profiles" ? "bg-primary/10 text-primary" : "text-muted-foreground hover:text-foreground hover:bg-muted"}`,
              children: ""
            }
          )
        ] }),
        d === "global" && /* @__PURE__ */ c.jsx("div", { className: "max-w-2xl py-4 flex-1 overflow-y-auto custom-scrollbar", children: /* @__PURE__ */ c.jsx(
          Ahe,
          {
            config: zn || { enabled: !1, includeGlobal: !1, disabledWorldbooks: [] },
            onChange: $t,
            worldbookStructure: Object.fromEntries(
              Object.entries(nn || {}).filter(([At]) => {
                const tr = fn || { global: [], chat: [] };
                return tr.global.includes(At) || tr.chat.includes(At);
              })
            ),
            disabledEntries: kn,
            onToggleWorldbook: Un,
            onToggleEntry: Hn,
            onRefresh: on
          }
        ) }),
        d === "profiles" && /* @__PURE__ */ c.jsx(
          mm,
          {
            listWidth: "30%",
            list: /* @__PURE__ */ c.jsx(
              Rhe,
              {
                profiles: Nn,
                selectedId: h,
                onSelect: (At) => st(() => m(At.id)),
                onAdd: () => {
                  const At = {
                    id: `wb_profile_${Date.now()}`,
                    name: "",
                    mode: "custom",
                    selectedWorldbooks: (fn == null ? void 0 : fn.chat) || [],
                    createdAt: Date.now(),
                    updatedAt: Date.now()
                  };
                  $e(At), st(() => m(At.id));
                },
                onDelete: bt
              }
            ),
            detail: (() => {
              const At = Nn.find((tr) => tr.id === h);
              return At ? /* @__PURE__ */ c.jsx("div", { className: "h-full animate-in fade-in slide-in-from-right-2 duration-300", children: /* @__PURE__ */ c.jsx(
                Mhe,
                {
                  profile: At,
                  onChange: Qe,
                  availableWorldbooks: nt,
                  charWorldbooks: (fn == null ? void 0 : fn.chat) || []
                }
              ) }) : /* @__PURE__ */ c.jsx(
                th,
                {
                  icon: Ky,
                  title: "",
                  description: ""
                }
              );
            })(),
            mobileDetailOpen: !1,
            onMobileDetailClose: $r
          }
        )
      ] })
    ] })
  ] });
}, $he = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  APIPresets: Bhe
}, Symbol.toStringTag, { value: "Module" })), qhe = () => {
  const [e, t] = I.useState("claudeDark");
  I.useEffect(() => {
    t(xd.getTheme());
  }, []);
  const n = (i) => {
    xd.setTheme(i), it.set("theme", i), t(i);
  }, r = Object.entries(D1).map(([i, s]) => {
    let a = s.colors.background, u = s.colors.primary;
    return {
      id: i,
      name: s.name,
      background: a,
      sidebar: s.colors.sidebar,
      // Add sidebar color
      primary: u
    };
  });
  return /* @__PURE__ */ c.jsxs("div", { className: "space-y-4", children: [
    /* @__PURE__ */ c.jsx("h3", { className: "text-lg font-medium", children: "" }),
    /* @__PURE__ */ c.jsx("div", { className: "grid grid-cols-2 sm:grid-cols-4 gap-4", children: r.map((i) => /* @__PURE__ */ c.jsxs(
      "button",
      {
        onClick: () => n(i.id),
        className: `
                            relative group flex flex-col items-center gap-2 p-3 rounded-xl border-2 transition-all
                            ${e === i.id ? "border-primary bg-accent/10" : "border-transparent hover:bg-accent/5"}
                        `,
        children: [
          /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-center -space-x-3 mb-2", children: [
            /* @__PURE__ */ c.jsx(
              "div",
              {
                className: "w-8 h-8 rounded-full border border-border shadow-sm z-10",
                style: { background: i.background },
                title: "Background"
              }
            ),
            /* @__PURE__ */ c.jsx(
              "div",
              {
                className: "w-8 h-8 rounded-full border border-border shadow-sm z-20",
                style: { background: i.sidebar },
                title: "Sidebar"
              }
            ),
            /* @__PURE__ */ c.jsx(
              "div",
              {
                className: "w-8 h-8 rounded-full border border-border shadow-sm z-30 ring-2 ring-background",
                style: { background: i.primary },
                title: "Primary"
              }
            )
          ] }),
          /* @__PURE__ */ c.jsx("span", { className: `text-sm font-medium ${e === i.id ? "text-primary" : "text-muted-foreground"}`, children: i.name }),
          e === i.id && /* @__PURE__ */ c.jsx("div", { className: "absolute top-2 right-2 w-2 h-2 rounded-full bg-primary" })
        ]
      },
      i.id
    )) })
  ] });
}, Fhe = () => {
  var u, d, f, h, m, x;
  const [e, t] = I.useState(((u = it.getSettings().summarizerConfig) == null ? void 0 : u.previewEnabled) ?? !0), [n, r] = I.useState(((d = it.getSettings().preprocessingConfig) == null ? void 0 : d.preview) ?? Ay.preview), [, i] = I.useState({});
  I.useEffect(() => {
    it.loadSettings();
  }, []);
  const [s, a] = I.useState(it.getSettings().linkedDeletion);
  return /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col h-full animate-in fade-in", children: [
    /* @__PURE__ */ c.jsx(
      Gm,
      {
        breadcrumbs: [""],
        title: "",
        subtitle: ""
      }
    ),
    /* @__PURE__ */ c.jsxs("div", { className: "p-6 space-y-8", children: [
      /* @__PURE__ */ c.jsxs("section", { children: [
        /* @__PURE__ */ c.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider mb-4", children: "" }),
        /* @__PURE__ */ c.jsx(qhe, {})
      ] }),
      /* @__PURE__ */ c.jsxs("section", { children: [
        /* @__PURE__ */ c.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider mb-4", children: " (Glass Effect)" }),
        /* @__PURE__ */ c.jsxs("div", { className: "bg-muted/30 border border-border rounded-lg p-4 space-y-6", children: [
          /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between gap-3", children: [
            /* @__PURE__ */ c.jsx("div", { className: "flex items-center gap-3 min-w-0 flex-1", children: /* @__PURE__ */ c.jsxs("div", { className: "min-w-0 flex-1", children: [
              /* @__PURE__ */ c.jsx("h4", { className: "font-medium text-foreground truncate", children: "" }),
              /* @__PURE__ */ c.jsx("p", { className: "text-sm text-muted-foreground line-clamp-2", children: "" })
            ] }) }),
            /* @__PURE__ */ c.jsx(
              gi,
              {
                checked: ((f = it.getSettings().glassSettings) == null ? void 0 : f.enabled) ?? !0,
                onChange: (b) => {
                  const S = {
                    ...it.getSettings().glassSettings,
                    enabled: b
                  };
                  it.set("glassSettings", S), Promise.resolve().then(() => P1).then(({ ThemeManager: C }) => {
                    C.setTheme(C.getTheme());
                  }), i({});
                }
              }
            )
          ] }),
          (((h = it.getSettings().glassSettings) == null ? void 0 : h.enabled) ?? !0) && /* @__PURE__ */ c.jsxs(c.Fragment, { children: [
            /* @__PURE__ */ c.jsx(
              Ir,
              {
                label: " (Opacity)",
                description: "",
                value: ((m = it.getSettings().glassSettings) == null ? void 0 : m.opacity) ?? 0.8,
                onChange: (b) => {
                  const S = {
                    ...it.getSettings().glassSettings,
                    opacity: b
                  };
                  it.set("glassSettings", S), Promise.resolve().then(() => P1).then(({ ThemeManager: C }) => {
                    C.setTheme(C.getTheme());
                  }), i({});
                },
                min: 0,
                max: 1,
                step: 0.05,
                showSlider: !0
              }
            ),
            /* @__PURE__ */ c.jsx(
              Ir,
              {
                label: " (Blur)",
                description: " (px)",
                value: ((x = it.getSettings().glassSettings) == null ? void 0 : x.blur) ?? 10,
                onChange: (b) => {
                  const S = {
                    ...it.getSettings().glassSettings,
                    blur: b
                  };
                  it.set("glassSettings", S), Promise.resolve().then(() => P1).then(({ ThemeManager: C }) => {
                    C.setTheme(C.getTheme());
                  }), i({});
                },
                min: 0,
                max: 50,
                step: 1,
                showSlider: !0
              }
            )
          ] })
        ] })
      ] }),
      /* @__PURE__ */ c.jsxs("section", { children: [
        /* @__PURE__ */ c.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider mb-4", children: "" }),
        /* @__PURE__ */ c.jsx("div", { className: "bg-muted/30 border border-border rounded-lg p-4", children: /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between gap-3", children: [
          /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-3 min-w-0 flex-1", children: [
            /* @__PURE__ */ c.jsx("div", { className: "p-2 rounded-lg bg-primary/10 text-primary flex-shrink-0", children: /* @__PURE__ */ c.jsx(mA, { size: 20 }) }),
            /* @__PURE__ */ c.jsxs("div", { className: "min-w-0 flex-1", children: [
              /* @__PURE__ */ c.jsx("h4", { className: "font-medium text-foreground truncate", children: "" }),
              /* @__PURE__ */ c.jsx("p", { className: "text-sm text-muted-foreground line-clamp-2", children: "" })
            ] })
          ] }),
          /* @__PURE__ */ c.jsx(
            gi,
            {
              checked: e,
              onChange: (b) => {
                t(b), Wo.updateConfig({ previewEnabled: b });
              }
            }
          )
        ] }) })
      ] }),
      /* @__PURE__ */ c.jsxs("section", { children: [
        /* @__PURE__ */ c.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider mb-4", children: "" }),
        /* @__PURE__ */ c.jsx("div", { className: "bg-muted/30 border border-border rounded-lg p-4", children: /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between gap-3", children: [
          /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-3 min-w-0 flex-1", children: [
            /* @__PURE__ */ c.jsx("div", { className: "p-2 rounded-lg bg-primary/10 text-primary flex-shrink-0", children: /* @__PURE__ */ c.jsx(mA, { size: 20 }) }),
            /* @__PURE__ */ c.jsxs("div", { className: "min-w-0 flex-1", children: [
              /* @__PURE__ */ c.jsx("h4", { className: "font-medium text-foreground truncate", children: "" }),
              /* @__PURE__ */ c.jsx("p", { className: "text-sm text-muted-foreground line-clamp-2", children: "" })
            ] })
          ] }),
          /* @__PURE__ */ c.jsx(
            gi,
            {
              checked: n,
              onChange: (b) => {
                r(b);
                const w = hh.getConfig();
                hh.saveConfig({ ...w, preview: b });
              }
            }
          )
        ] }) })
      ] }),
      /* @__PURE__ */ c.jsxs("section", { children: [
        /* @__PURE__ */ c.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider mb-4", children: "" }),
        /* @__PURE__ */ c.jsxs("div", { className: "bg-muted/30 border border-border rounded-lg p-4 space-y-4", children: [
          /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between gap-3", children: [
            /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-3 min-w-0 flex-1", children: [
              /* @__PURE__ */ c.jsx("div", { className: "p-2 rounded-lg bg-red-500/10 text-red-500 flex-shrink-0", children: /* @__PURE__ */ c.jsx(pa, { size: 20 }) }),
              /* @__PURE__ */ c.jsxs("div", { className: "min-w-0 flex-1", children: [
                /* @__PURE__ */ c.jsx("h4", { className: "font-medium text-foreground truncate", children: "" }),
                /* @__PURE__ */ c.jsx("p", { className: "text-sm text-muted-foreground line-clamp-2", children: "/" })
              ] })
            ] }),
            /* @__PURE__ */ c.jsx(
              gi,
              {
                checked: s.enabled,
                onChange: (b) => {
                  const w = { ...s, enabled: b };
                  a(w), it.set("linkedDeletion", w);
                }
              }
            )
          ] }),
          s.enabled && /* @__PURE__ */ c.jsxs("div", { className: "pl-14 space-y-3 border-t border-border pt-3", children: [
            /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between", children: [
              /* @__PURE__ */ c.jsx("span", { className: "text-sm text-muted-foreground", children: "" }),
              /* @__PURE__ */ c.jsx(
                gi,
                {
                  checked: s.showConfirmation,
                  onChange: (b) => {
                    const w = { ...s, showConfirmation: b };
                    a(w), it.set("linkedDeletion", w);
                  },
                  className: "scale-90"
                }
              )
            ] }),
            /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between gap-3", children: [
              /* @__PURE__ */ c.jsxs("div", { className: "min-w-0 flex-1", children: [
                /* @__PURE__ */ c.jsx("span", { className: "text-sm text-muted-foreground block truncate", children: " Worldbook" }),
                /* @__PURE__ */ c.jsx("p", { className: "text-xs text-muted-foreground/60 line-clamp-2", children: ":  Worldbook " })
              ] }),
              /* @__PURE__ */ c.jsx(
                gi,
                {
                  checked: s.deleteChatWorldbook ?? !1,
                  onChange: (b) => {
                    const w = { ...s, deleteChatWorldbook: b };
                    a(w), it.set("linkedDeletion", w);
                  },
                  className: "scale-90"
                }
              )
            ] })
          ] })
        ] }),
        /* @__PURE__ */ c.jsx(Hhe, {}),
        /* @__PURE__ */ c.jsx(Uhe, {})
      ] }),
      /* @__PURE__ */ c.jsx("div", { className: "mt-8 pt-8 border-t border-border", children: /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col items-center justify-center text-muted-foreground gap-2 py-8 opacity-50", children: [
        /* @__PURE__ */ c.jsx(Cm, { size: 32 }),
        /* @__PURE__ */ c.jsx("p", { className: "text-sm", children: "..." })
      ] }) })
    ] })
  ] });
}, Uhe = () => {
  const [e, t] = I.useState(it.getSettings().syncConfig || { enabled: !1, autoSync: !0 }), [n, r] = I.useState("idle"), [i, s] = I.useState(""), [a, u] = I.useState(0), d = xi(), f = (m) => (x) => {
    const b = { ...e, [m]: x };
    t(b), it.set("syncConfig", b);
  }, h = async () => {
    try {
      r("check"), s("...");
      const { getSTContext: m } = await Promise.resolve().then(() => oy), x = m();
      if (!(x != null && x.chatId)) {
        alert(""), r("idle"), s("");
        return;
      }
      const b = x.chatId;
      r("syncing"), s("...");
      const { syncService: w } = await Promise.resolve().then(() => L1), S = await w.autoSync(b);
      switch (u(Date.now()), S) {
        case "downloaded":
          r("success"), s("");
          break;
        case "uploaded":
          r("success"), s("");
          break;
        case "synced":
          r("success"), s("");
          break;
        case "ignored":
          r("idle"), s("");
          break;
        case "error":
        default:
          r("error"), s("");
          break;
      }
      S !== "error" && setTimeout(() => {
        r("idle"), s("");
      }, 3e3);
    } catch (m) {
      console.error(m), r("error"), s("");
    }
  };
  return /* @__PURE__ */ c.jsxs("div", { className: "bg-muted/30 border border-border rounded-lg p-4 mt-4", children: [
    /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between gap-3 mb-4", children: [
      /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-3 min-w-0 flex-1", children: [
        /* @__PURE__ */ c.jsx("div", { className: "p-2 rounded-lg bg-blue-500/10 text-blue-500 flex-shrink-0", children: /* @__PURE__ */ c.jsxs("svg", { width: "20", height: "20", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", children: [
          /* @__PURE__ */ c.jsx("path", { d: "M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8" }),
          /* @__PURE__ */ c.jsx("path", { d: "M3 3v5h5" }),
          /* @__PURE__ */ c.jsx("path", { d: "M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16" }),
          /* @__PURE__ */ c.jsx("path", { d: "M16 16h5v5" })
        ] }) }),
        /* @__PURE__ */ c.jsxs("div", { className: "min-w-0 flex-1", children: [
          /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2", children: [
            /* @__PURE__ */ c.jsx("h4", { className: "font-medium text-foreground truncate", children: " (Beta)" }),
            n !== "idle" && /* @__PURE__ */ c.jsx("span", { className: `text-xs ${n === "error" ? "text-red-500" : n === "success" ? "text-green-500" : "text-blue-500 animate-pulse"}`, children: i })
          ] }),
          /* @__PURE__ */ c.jsx("p", { className: "text-sm text-muted-foreground line-clamp-2", children: "" })
        ] })
      ] }),
      /* @__PURE__ */ c.jsx(
        gi,
        {
          checked: e.enabled,
          onChange: f("enabled")
        }
      )
    ] }),
    e.enabled && /* @__PURE__ */ c.jsxs("div", { className: "pl-14 space-y-3 border-t border-border pt-3", children: [
      /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between", children: [
        /* @__PURE__ */ c.jsxs("div", { className: "min-w-0 flex-1", children: [
          /* @__PURE__ */ c.jsx("span", { className: "text-sm text-muted-foreground", children: "" }),
          /* @__PURE__ */ c.jsx("p", { className: "text-xs text-muted-foreground/60", children: "3" })
        ] }),
        /* @__PURE__ */ c.jsx(
          gi,
          {
            checked: e.autoSync,
            onChange: f("autoSync"),
            className: "scale-90"
          }
        )
      ] }),
      /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between", children: [
        /* @__PURE__ */ c.jsxs("div", { className: "min-w-0 flex-1", children: [
          /* @__PURE__ */ c.jsx("span", { className: "text-sm text-muted-foreground", children: "" }),
          /* @__PURE__ */ c.jsx("p", { className: "text-xs text-muted-foreground/60", children: a > 0 ? new Date(a).toLocaleString() : "" })
        ] }),
        /* @__PURE__ */ c.jsx(
          "button",
          {
            onClick: h,
            disabled: n === "syncing",
            className: "px-3 py-1.5 text-xs font-medium rounded-md bg-background border border-border hover:bg-muted transition-colors disabled:opacity-50",
            children: ""
          }
        )
      ] }),
      /* @__PURE__ */ c.jsxs("ul", { className: "mt-2 text-xs text-muted-foreground/60 p-2 bg-background/50 rounded list-disc list-inside", children: [
        /* @__PURE__ */ c.jsxs("li", { children: [
          ": `data/default-user/files/Engram_sync_",
          d ?? "",
          ".json`"
        ] }),
        /* @__PURE__ */ c.jsx("li", { children: '""' }),
        /* @__PURE__ */ c.jsx("li", { children: "" })
      ] })
    ] }),
    /* @__PURE__ */ c.jsxs("div", { className: "flex gap-2 justify-end pt-2 border-t border-border/50", children: [
      /* @__PURE__ */ c.jsx(
        "button",
        {
          onClick: async () => {
            var m;
            try {
              r("syncing"), s("...");
              const { getSTContext: x } = await Promise.resolve().then(() => oy), b = (m = x()) == null ? void 0 : m.chatId;
              if (!b) throw new Error("");
              const { syncService: w } = await Promise.resolve().then(() => L1);
              if (await w.upload(b))
                r("success"), s(""), u(Date.now());
              else
                throw new Error("");
            } catch (x) {
              ee.error(Fe.DATA_SYNC, "Manual upload failed", x), r("error"), s(": " + String(x));
            }
          },
          className: "px-2 py-1 text-[10px] font-medium rounded bg-background border border-border hover:bg-blue-500/10 text-muted-foreground hover:text-blue-500 transition-colors",
          children: " ()"
        }
      ),
      /* @__PURE__ */ c.jsx(
        "button",
        {
          onClick: async () => {
            var m;
            try {
              r("syncing"), s("...");
              const { getSTContext: x } = await Promise.resolve().then(() => oy), b = (m = x()) == null ? void 0 : m.chatId;
              if (!b) throw new Error("");
              const { syncService: w } = await Promise.resolve().then(() => L1), S = await w.download(b);
              if (S === "success")
                r("success"), s(""), u(Date.now());
              else
                throw new Error(S === "no_data" ? "" : "");
            } catch (x) {
              ee.error(Fe.DATA_SYNC, "Manual download failed", x), r("error"), s(": " + String(x));
            }
          },
          className: "px-2 py-1 text-[10px] font-medium rounded bg-background border border-border hover:bg-orange-500/10 text-muted-foreground hover:text-orange-500 transition-colors",
          children: " ()"
        }
      )
    ] })
  ] });
}, Hhe = () => {
  const e = vi(), [, t] = I.useState({}), n = async () => {
    if (!xi()) {
      alert("");
      return;
    }
    if (confirm(` IndexedDB 
`) && confirm(""))
      try {
        await e.clearChatDatabase(), alert(""), t({});
      } catch (s) {
        alert(": " + s);
      }
  }, r = async () => {
    if (!xi()) {
      alert("");
      return;
    }
    if (confirm(`
 Engram `) && confirm(""))
      try {
        await e.deleteChatDatabase(), alert(""), t({});
      } catch (s) {
        alert(": " + s);
      }
  };
  return /* @__PURE__ */ c.jsxs("div", { className: "bg-muted/30 border border-border rounded-lg p-4 mt-4 space-y-4", children: [
    /* @__PURE__ */ c.jsx("div", { className: "flex items-center justify-between gap-3", children: /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-3 min-w-0 flex-1", children: [
      /* @__PURE__ */ c.jsx("div", { className: "p-2 rounded-lg bg-orange-500/10 text-orange-500 flex-shrink-0", children: /* @__PURE__ */ c.jsx(fr, { size: 20 }) }),
      /* @__PURE__ */ c.jsxs("div", { className: "min-w-0 flex-1", children: [
        /* @__PURE__ */ c.jsx("h4", { className: "font-medium text-foreground truncate", children: "" }),
        /* @__PURE__ */ c.jsx("p", { className: "text-sm text-muted-foreground line-clamp-2", children: "" })
      ] })
    ] }) }),
    /* @__PURE__ */ c.jsxs("div", { className: "pl-14 flex gap-4", children: [
      /* @__PURE__ */ c.jsx(
        "button",
        {
          onClick: n,
          className: "px-3 py-1.5 text-xs font-medium rounded-md bg-background border border-border hover:bg-muted text-yellow-600 transition-colors",
          children: " (DB)"
        }
      ),
      /* @__PURE__ */ c.jsx(
        "button",
        {
          onClick: r,
          className: "px-3 py-1.5 text-xs font-medium rounded-md bg-background border border-border hover:bg-red-500/10 text-red-600 transition-colors",
          children: " ()"
        }
      )
    ] })
  ] });
}, Vhe = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  Settings: Fhe
}, Symbol.toStringTag, { value: "Module" }));
function Ghe({ score: e }) {
  const t = Math.round(e * 5);
  return /* @__PURE__ */ c.jsx("div", { className: "flex gap-0.5", children: [0, 1, 2, 3, 4].map((n) => /* @__PURE__ */ c.jsx(
    "span",
    {
      className: `w-1.5 h-1.5 rounded-full ${n < t ? "bg-primary" : "bg-muted"}`
    },
    n
  )) });
}
function Khe({ isEmbedded: e }) {
  return e ? /* @__PURE__ */ c.jsxs(
    "span",
    {
      className: "inline-flex items-center gap-0.5 px-1.5 py-0.5 bg-primary/10 text-primary rounded text-[10px] font-medium",
      title: "",
      children: [
        /* @__PURE__ */ c.jsx(Zu, { size: 10 }),
        /* @__PURE__ */ c.jsx("span", { children: "" })
      ]
    }
  ) : null;
}
function Yhe({ event: e }) {
  const t = e.structured_kv, n = [];
  if (t.time_anchor && n.push(t.time_anchor), t.location) {
    const r = Array.isArray(t.location) ? t.location.join(", ") : String(t.location);
    r && n.push(r);
  }
  return t.role && t.role.length > 0 && n.push(t.role.join(", ")), n.length === 0 ? null : /* @__PURE__ */ c.jsxs("p", { className: "text-xs text-muted-foreground truncate", children: [
    "(",
    n.join(" | "),
    ")"
  ] });
}
const Whe = ({
  event: e,
  isSelected: t = !1,
  isActive: n = !1,
  // Default false
  isCompact: r = !1,
  onSelect: i,
  onCheck: s,
  checked: a = !1,
  hasChanges: u = !1,
  className: d = ""
}) => {
  var b;
  const f = e.structured_kv, h = e.summary.split(`
`), m = f.event || ((b = h[0]) == null ? void 0 : b.replace(/:\s*$/, "")) || "", x = h.length > 1 ? h.slice(1).join(" ").trim() : e.summary;
  return r ? /* @__PURE__ */ c.jsxs(
    "div",
    {
      className: `
                    flex items-center gap-3 p-3 cursor-pointer
                    border-b border-border
                    transition-colors duration-150
                    ${t ? "border-l-4 border-l-primary bg-transparent" : ""}
                    ${n ? "border-l-4 border-l-green-500 bg-green-500/5" : ""}
                    ${!t && !n ? "hover:border-border" : ""}
                    ${d}
                `,
      onClick: i,
      children: [
        /* @__PURE__ */ c.jsx(
          "input",
          {
            type: "checkbox",
            checked: a,
            onChange: (w) => {
              w.stopPropagation(), s == null || s(w.target.checked);
            },
            className: "w-4 h-4 rounded border-border accent-primary"
          }
        ),
        /* @__PURE__ */ c.jsxs("div", { className: "flex-1 min-w-0", children: [
          /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2", children: [
            /* @__PURE__ */ c.jsx("span", { className: "text-xs font-medium text-primary", children: m }),
            e.is_embedded && /* @__PURE__ */ c.jsx(Zu, { size: 10, className: "text-primary" }),
            /* @__PURE__ */ c.jsx("span", { className: "text-xs text-muted-foreground", children: e.significance_score.toFixed(1) })
          ] }),
          /* @__PURE__ */ c.jsxs("p", { className: "text-sm text-foreground truncate mt-1", children: [
            x.substring(0, 50),
            "..."
          ] })
        ] }),
        /* @__PURE__ */ c.jsx(nc, { size: 16, className: "text-muted-foreground" })
      ]
    }
  ) : /* @__PURE__ */ c.jsxs(
    "div",
    {
      className: `
                p-4 cursor-pointer rounded-lg
                transition-all duration-150 relative
                ${t ? "border border-primary bg-transparent" : n ? "border border-green-500/50 bg-green-500/5 hover:border-green-500" : "border border-transparent hover:border-border/50"}
                ${d}
            `,
      onClick: i,
      children: [
        n && /* @__PURE__ */ c.jsx("div", { className: "absolute top-2 right-2 text-[10px] text-green-500 font-medium px-1.5 py-0.5 bg-green-500/10 rounded", children: "Active" }),
        /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-3 mb-2", children: [
          /* @__PURE__ */ c.jsx(
            "input",
            {
              type: "checkbox",
              checked: a,
              onChange: (w) => {
                w.stopPropagation(), s == null || s(w.target.checked);
              },
              className: "w-4 h-4 rounded border-border accent-primary"
            }
          ),
          /* @__PURE__ */ c.jsx("span", { className: "text-xs font-medium text-primary", children: m }),
          /* @__PURE__ */ c.jsx(Khe, { isEmbedded: e.is_embedded }),
          u && /* @__PURE__ */ c.jsx("span", { className: "w-2 h-2 rounded-full bg-yellow-500", title: "" }),
          /* @__PURE__ */ c.jsx("div", { className: "flex-1" }),
          /* @__PURE__ */ c.jsx(Ghe, { score: e.significance_score })
        ] }),
        /* @__PURE__ */ c.jsx(Yhe, { event: e }),
        /* @__PURE__ */ c.jsx("p", { className: "text-sm text-foreground mt-1 line-clamp-2", children: x }),
        /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2 mt-2 text-xs text-muted-foreground", children: [
          /* @__PURE__ */ c.jsxs("span", { children: [
            "Level ",
            e.level
          ] }),
          e.source_range && /* @__PURE__ */ c.jsxs(c.Fragment, { children: [
            /* @__PURE__ */ c.jsx("span", { children: "" }),
            /* @__PURE__ */ c.jsxs("span", { children: [
              ": ",
              e.source_range.start_index,
              "-",
              e.source_range.end_index,
              ""
            ] })
          ] })
        ] })
      ]
    }
  );
}, Zhe = ({
  entity: e,
  isSelected: t = !1,
  isCompact: n = !1,
  onSelect: r,
  onCheck: i,
  checked: s = !1
}) => n ? /* @__PURE__ */ c.jsxs(
  "div",
  {
    className: `
                    flex items-center gap-3 p-3 cursor-pointer
                    border-b border-border
                    transition-colors duration-150
                    ${t ? "border-l-2 border-l-primary bg-transparent" : "hover:border-border"}
                `,
    onClick: r,
    children: [
      /* @__PURE__ */ c.jsx(
        "input",
        {
          type: "checkbox",
          checked: s,
          onChange: (a) => {
            a.stopPropagation(), i == null || i(a.target.checked);
          },
          className: "w-4 h-4 rounded border-border accent-primary"
        }
      ),
      /* @__PURE__ */ c.jsxs("div", { className: "flex-1 min-w-0", children: [
        /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2", children: [
          /* @__PURE__ */ c.jsx("span", { className: "text-xs font-medium text-foreground", children: e.name }),
          /* @__PURE__ */ c.jsx("span", { className: "text-[10px] px-1.5 py-0.5 rounded-full bg-primary/10 text-primary border border-primary/20 uppercase", children: e.type })
        ] }),
        /* @__PURE__ */ c.jsx("p", { className: "text-xs text-muted-foreground truncate mt-1", children: e.description })
      ] }),
      /* @__PURE__ */ c.jsx(nc, { size: 16, className: "text-muted-foreground" })
    ]
  }
) : /* @__PURE__ */ c.jsxs(
  "div",
  {
    className: `
                p-4 cursor-pointer rounded-lg
                transition-all duration-150
                ${t ? "border border-primary bg-transparent" : "border border-transparent hover:border-border/50"}
            `,
    onClick: r,
    children: [
      /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-3 mb-2", children: [
        /* @__PURE__ */ c.jsx(
          "input",
          {
            type: "checkbox",
            checked: s,
            onChange: (a) => {
              a.stopPropagation(), i == null || i(a.target.checked);
            },
            className: "w-4 h-4 rounded border-border accent-primary"
          }
        ),
        /* @__PURE__ */ c.jsx("span", { className: "text-sm font-medium text-foreground", children: e.name }),
        /* @__PURE__ */ c.jsx("span", { className: "text-[10px] px-1.5 py-0.5 rounded-full bg-primary/10 text-primary border border-primary/20 uppercase", children: e.type })
      ] }),
      /* @__PURE__ */ c.jsx("p", { className: "text-xs text-muted-foreground line-clamp-2 leading-relaxed", children: e.description }),
      e.aliases && e.aliases.length > 0 && /* @__PURE__ */ c.jsxs("div", { className: "mt-2 text-[10px] text-muted-foreground/60 truncate", children: [
        ": ",
        e.aliases.join(", ")
      ] })
    ]
  }
), Y0 = {
  background: "transparent",
  backgroundColor: "transparent",
  border: "none",
  borderBottom: "1px solid var(--border)",
  borderRadius: 0,
  boxShadow: "none",
  outline: "none",
  padding: "8px 0",
  fontSize: "14px",
  width: "100%",
  color: "var(--foreground, inherit)"
};
function $8(e) {
  const t = [], n = Array.isArray(e.location) ? e.location.join(", ") : e.location;
  return e.time_anchor && n ? t.push(`${e.time_anchor}${n}`) : e.time_anchor ? t.push(`${e.time_anchor}`) : n && t.push(`${n}`), e.role && e.role.length > 0 && t.push(e.role.join("")), e.event && t.push(e.event), e.logic && e.logic.length > 0 && t.push(`(${e.logic.join("/")})`), t.join(" ");
}
const T5 = I.forwardRef(({
  event: e,
  isFullScreen: t = !1,
  onSave: n,
  onDelete: r,
  onClose: i
}, s) => {
  const [a, u] = I.useState(""), [d, f] = I.useState(""), [h, m] = I.useState(""), [x, b] = I.useState(""), [w, S] = I.useState(""), [C, T] = I.useState(""), [R, N] = I.useState(0.5), [M, P] = I.useState(!1), [D, q] = I.useState(null), Y = I.useRef(!1), te = I.useRef(!0), V = I.useRef(null);
  I.useEffect(() => () => {
    te.current = !1, V.current && clearTimeout(V.current);
  }, []), I.useEffect(() => {
    var de, H;
    if (e && e.id !== D) {
      u(e.summary), f(e.structured_kv.event || ""), m(e.structured_kv.time_anchor || "");
      const J = e.structured_kv.location || [];
      b(Array.isArray(J) ? J.join(", ") : String(J || "")), S(((de = e.structured_kv.role) == null ? void 0 : de.join(", ")) || ""), T(((H = e.structured_kv.logic) == null ? void 0 : H.join(", ")) || ""), N(e.significance_score), P(!1), q(e.id);
    }
  }, [e, D]);
  const $ = () => {
    confirm("") && (r == null || r(e.id));
  }, G = I.useCallback((de = {}) => {
    var fe;
    if (!e) return;
    const H = {
      eventType: de.eventType ?? d,
      timeAnchor: de.timeAnchor ?? h,
      location: de.location ?? x,
      roleText: de.roleText ?? w,
      logicText: de.logicText ?? C,
      score: de.score ?? R
    }, J = (ve) => ve.split(",").map((Se) => Se.trim()).filter(Boolean), ge = {
      event: H.eventType,
      time_anchor: H.timeAnchor,
      location: J(H.location),
      // V1.0.2: 
      role: J(H.roleText),
      logic: J(H.logicText),
      causality: ((fe = e.structured_kv) == null ? void 0 : fe.causality) || ""
    }, Q = $8(ge);
    n == null || n(e.id, {
      summary: Q || a,
      structured_kv: { ...e.structured_kv, ...ge },
      significance_score: H.score
    });
  }, [e, d, h, x, w, C, R, a, n]);
  I.useImperativeHandle(s, () => ({
    save: () => G(),
    isDirty: () => M
  }), [G, M]);
  const le = () => {
    Y.current = !0;
  }, Z = (de, H, J) => {
    if (Y.current = !1, !te.current) return;
    const ge = de.currentTarget.value;
    H(ge), P(!0), G({ [J]: ge });
  }, oe = (de, H, J) => {
    de(H), P(!0), Y.current || G({ [J]: H });
  }, X = () => {
    V.current && clearTimeout(V.current), V.current = window.setTimeout(() => {
      te.current && M && G();
    }, 50);
  }, ce = (de) => {
    N(de), P(!0), G({ score: de });
  };
  if (!e)
    return /* @__PURE__ */ c.jsx("div", { className: "flex flex-col items-center justify-center h-full text-muted-foreground gap-2 p-8", children: /* @__PURE__ */ c.jsx("p", { className: "text-sm font-light", children: "" }) });
  const pe = /* @__PURE__ */ c.jsxs(c.Fragment, { children: [
    /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-1", children: [
      /* @__PURE__ */ c.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
      /* @__PURE__ */ c.jsx(
        "input",
        {
          type: "text",
          value: d,
          onChange: (de) => oe(f, de.target.value, "eventType"),
          onCompositionStart: le,
          onCompositionEnd: (de) => Z(de, f, "eventType"),
          onBlur: X,
          style: Y0,
          className: "placeholder:text-muted-foreground/40 focus:border-primary transition-colors",
          placeholder: ""
        }
      )
    ] }),
    /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-1", children: [
      /* @__PURE__ */ c.jsxs("div", { className: "flex justify-between items-center", children: [
        /* @__PURE__ */ c.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
        /* @__PURE__ */ c.jsx(
          "button",
          {
            onClick: () => {
              const de = $8({
                event: d,
                time_anchor: h,
                location: x.split(",").map((H) => H.trim()).filter(Boolean),
                // V1.0.2
                role: w.split(",").map((H) => H.trim()).filter(Boolean),
                logic: C.split(",").map((H) => H.trim()).filter(Boolean)
              });
              u(de), P(!0), G({ summary: de });
            },
            className: "text-[10px] text-primary hover:underline",
            children: " KV "
          }
        )
      ] }),
      /* @__PURE__ */ c.jsx(
        us,
        {
          label: "",
          value: a,
          onChange: (de) => {
            var H;
            u(de), P(!0), n == null || n(e.id, {
              summary: de,
              structured_kv: {
                event: d,
                time_anchor: h,
                location: x.split(",").map((J) => J.trim()).filter(Boolean),
                // V1.0.2
                role: w.split(",").map((J) => J.trim()).filter(Boolean),
                logic: C.split(",").map((J) => J.trim()).filter(Boolean),
                causality: ((H = e.structured_kv) == null ? void 0 : H.causality) || ""
              },
              significance_score: R
            });
          },
          multiline: !0,
          rows: 6,
          placeholder: "...",
          className: "font-mono text-sm"
        }
      )
    ] }),
    /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-1", children: [
      /* @__PURE__ */ c.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
      /* @__PURE__ */ c.jsx(
        "input",
        {
          type: "text",
          value: h,
          onChange: (de) => oe(m, de.target.value, "timeAnchor"),
          onCompositionStart: le,
          onCompositionEnd: (de) => Z(de, m, "timeAnchor"),
          onBlur: X,
          style: Y0,
          className: "placeholder:text-muted-foreground/40 focus:border-primary transition-colors",
          placeholder: "102344"
        }
      )
    ] }),
    /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-1", children: [
      /* @__PURE__ */ c.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
      /* @__PURE__ */ c.jsx(
        "input",
        {
          type: "text",
          value: x,
          onChange: (de) => oe(b, de.target.value, "location"),
          onCompositionStart: le,
          onCompositionEnd: (de) => Z(de, b, "location"),
          onBlur: X,
          style: Y0,
          className: "placeholder:text-muted-foreground/40 focus:border-primary transition-colors",
          placeholder: ", "
        }
      )
    ] }),
    /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-1", children: [
      /* @__PURE__ */ c.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
      /* @__PURE__ */ c.jsx(
        "input",
        {
          type: "text",
          value: w,
          onChange: (de) => oe(S, de.target.value, "roleText"),
          onCompositionStart: le,
          onCompositionEnd: (de) => Z(de, S, "roleText"),
          onBlur: X,
          style: Y0,
          className: "placeholder:text-muted-foreground/40 focus:border-primary transition-colors",
          placeholder: "{{user}}, "
        }
      )
    ] }),
    /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-1", children: [
      /* @__PURE__ */ c.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
      /* @__PURE__ */ c.jsx(
        "input",
        {
          type: "text",
          value: C,
          onChange: (de) => oe(T, de.target.value, "logicText"),
          onCompositionStart: le,
          onCompositionEnd: (de) => Z(de, T, "logicText"),
          onBlur: X,
          style: Y0,
          className: "placeholder:text-muted-foreground/40 focus:border-primary transition-colors",
          placeholder: ", "
        }
      )
    ] }),
    /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-2", children: [
      /* @__PURE__ */ c.jsxs("div", { className: "flex justify-between items-center", children: [
        /* @__PURE__ */ c.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
        /* @__PURE__ */ c.jsx("span", { className: "text-xs font-mono text-foreground", children: R.toFixed(2) })
      ] }),
      /* @__PURE__ */ c.jsxs("div", { className: "relative h-4 flex items-center group cursor-pointer", children: [
        /* @__PURE__ */ c.jsx(
          "div",
          {
            className: "absolute inset-x-0 h-[1px]",
            style: { backgroundColor: "var(--border)" }
          }
        ),
        /* @__PURE__ */ c.jsx(
          "div",
          {
            className: "absolute top-1/2 -translate-y-1/2 w-2.5 h-2.5 bg-muted-foreground/80 rounded-full shadow-sm pointer-events-none transition-transform duration-75 ease-out group-hover:scale-125 group-hover:bg-foreground",
            style: { left: `${R * 100}%`, transform: "translate(-50%, -50%)" }
          }
        ),
        /* @__PURE__ */ c.jsx(
          "input",
          {
            type: "range",
            min: "0",
            max: "1",
            step: "0.05",
            value: R,
            onChange: (de) => ce(parseFloat(de.target.value)),
            className: "absolute inset-x-0 w-full h-full opacity-0 cursor-pointer z-10 m-0",
            style: { appearance: "none", WebkitAppearance: "none" }
          }
        )
      ] })
    ] }),
    /* @__PURE__ */ c.jsx(Br, { spacing: "md" }),
    /* @__PURE__ */ c.jsxs("div", { className: "space-y-1 text-xs text-muted-foreground", children: [
      /* @__PURE__ */ c.jsxs("p", { children: [
        "ID: ",
        /* @__PURE__ */ c.jsxs("span", { className: "font-mono", children: [
          e.id.substring(0, 8),
          "..."
        ] })
      ] }),
      /* @__PURE__ */ c.jsxs("p", { children: [
        "Level: ",
        e.level
      ] }),
      e.source_range && /* @__PURE__ */ c.jsxs("p", { children: [
        ": ",
        e.source_range.start_index,
        "-",
        e.source_range.end_index,
        ""
      ] }),
      /* @__PURE__ */ c.jsxs("p", { children: [
        ": ",
        new Date(e.timestamp).toLocaleString()
      ] }),
      /* @__PURE__ */ c.jsxs("p", { children: [
        ":",
        e.is_archived && /* @__PURE__ */ c.jsx("span", { className: "ml-1 text-yellow-500", children: "" }),
        e.is_embedded && /* @__PURE__ */ c.jsx("span", { className: "ml-1 text-green-500", children: "" }),
        !e.is_archived && !e.is_embedded && /* @__PURE__ */ c.jsx("span", { className: "ml-1", children: "" })
      ] })
    ] })
  ] });
  return t ? /* @__PURE__ */ c.jsxs("div", { className: "fixed inset-0 bg-background z-50 flex flex-col", style: { height: "100dvh" }, children: [
    /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-3 px-4 py-3 border-b border-border shrink-0", children: [
      /* @__PURE__ */ c.jsx(
        "button",
        {
          onClick: i,
          className: "p-1 text-muted-foreground hover:text-foreground rounded transition-colors",
          children: /* @__PURE__ */ c.jsx($b, { size: 20 })
        }
      ),
      /* @__PURE__ */ c.jsx("h2", { className: "text-lg font-light flex-1", children: "" }),
      /* @__PURE__ */ c.jsx(
        "button",
        {
          onClick: $,
          className: "p-2 text-destructive hover:bg-destructive/10 rounded",
          children: /* @__PURE__ */ c.jsx(pa, { size: 18 })
        }
      )
    ] }),
    /* @__PURE__ */ c.jsx("div", { className: "flex-1 overflow-y-auto p-4 space-y-4", children: pe }),
    /* @__PURE__ */ c.jsx("div", { className: "p-4 border-t border-border shrink-0", children: /* @__PURE__ */ c.jsx(
      "button",
      {
        onClick: i,
        className: "w-full py-2 text-sm border border-border rounded-md text-muted-foreground hover:text-foreground hover:border-foreground/30 transition-colors",
        children: ""
      }
    ) })
  ] }) : /* @__PURE__ */ c.jsxs("div", { className: "h-full flex flex-col", children: [
    /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2 pb-4 border-b border-border shrink-0", children: [
      /* @__PURE__ */ c.jsx("h3", { className: "text-sm font-medium text-primary flex-1", children: "" }),
      /* @__PURE__ */ c.jsx(
        "button",
        {
          onClick: $,
          className: "p-1.5 text-destructive hover:bg-destructive/10 rounded",
          title: "",
          children: /* @__PURE__ */ c.jsx(pa, { size: 16 })
        }
      )
    ] }),
    /* @__PURE__ */ c.jsx("div", { className: "flex-1 overflow-y-auto py-4 space-y-4 no-scrollbar", children: pe })
  ] });
});
T5.displayName = "EventEditor";
const Xhe = [
  { value: "char", label: " (Character)" },
  { value: "loc", label: " (Location)" },
  { value: "item", label: " (Item)" },
  { value: "concept", label: " (Concept)" },
  { value: "unknown", label: " (Unknown)" }
], q8 = {
  background: "transparent",
  border: "none",
  borderBottom: "1px solid var(--border)",
  borderRadius: 0,
  outline: "none",
  padding: "8px 0",
  fontSize: "14px",
  width: "100%",
  color: "var(--foreground, inherit)"
}, N$ = I.forwardRef(({
  entity: e,
  isFullScreen: t = !1,
  onSave: n,
  onDelete: r,
  onClose: i
}, s) => {
  const [a, u] = I.useState(""), [d, f] = I.useState("unknown"), [h, m] = I.useState(""), [x, b] = I.useState(""), [w, S] = I.useState(""), [C, T] = I.useState(null), [R, N] = I.useState(!1), [M, P] = I.useState(null), D = I.useRef(!0), q = I.useRef(null);
  I.useEffect(() => () => {
    D.current = !1;
  }, []), I.useEffect(() => {
    e && e.id !== M && (u(e.name), f(e.type), m(e.aliases ? e.aliases.join(", ") : ""), b(e.description || ""), S(JSON.stringify(e.profile || {}, null, 2)), T(null), N(!1), P(e.id));
  }, [e, M]);
  const Y = I.useCallback(() => {
    if (!e || C) return;
    let le = {};
    try {
      le = JSON.parse(w);
    } catch (oe) {
      console.error("JSON Parse Error during sync", oe);
    }
    const Z = {
      name: a,
      type: d,
      aliases: h.split(/[,]/).map((oe) => oe.trim()).filter(Boolean),
      description: x,
      // Allow manual override, or auto-generated
      profile: le
    };
    n == null || n(e.id, Z);
  }, [e, a, d, h, x, w, C, n]);
  I.useImperativeHandle(s, () => ({
    save: Y,
    isDirty: () => R
  }), [Y, R]);
  const te = (le) => {
    S(le), N(!0);
    try {
      JSON.parse(le), T(null);
    } catch (Z) {
      T(Z.message);
    }
  }, V = () => {
    q.current && clearTimeout(q.current), q.current = window.setTimeout(() => {
      D.current && R && !C && Y();
    }, 200);
  }, $ = () => {
    if (!C)
      try {
        const le = JSON.parse(w), Z = JSON.stringify(le, null, 2).replace(/[{"},]/g, "").replace(/^\s*[\r\n]/gm, "");
        b(Z.trim()), N(!0), q.current && clearTimeout(q.current), q.current = window.setTimeout(() => {
          D.current && Y();
        }, 50);
      } catch {
        alert("Profile JSON ");
      }
  };
  if (!e)
    return /* @__PURE__ */ c.jsx("div", { className: "flex flex-col items-center justify-center h-full text-muted-foreground gap-2", children: /* @__PURE__ */ c.jsx("p", { className: "text-sm font-light", children: "" }) });
  const G = /* @__PURE__ */ c.jsxs(c.Fragment, { children: [
    /* @__PURE__ */ c.jsxs("div", { className: "space-y-4", children: [
      /* @__PURE__ */ c.jsxs("div", { children: [
        /* @__PURE__ */ c.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
        /* @__PURE__ */ c.jsx(
          "input",
          {
            type: "text",
            value: a,
            onChange: (le) => {
              u(le.target.value), N(!0);
            },
            onBlur: V,
            style: q8,
            className: "placeholder:text-muted-foreground/40 focus:border-primary transition-colors font-medium text-lg"
          }
        )
      ] }),
      /* @__PURE__ */ c.jsx("div", { className: "flex gap-4", children: /* @__PURE__ */ c.jsxs("div", { className: "flex-1", children: [
        /* @__PURE__ */ c.jsx("label", { className: "text-xs text-muted-foreground", children: "" }),
        /* @__PURE__ */ c.jsx(
          "select",
          {
            value: d,
            onChange: (le) => {
              f(le.target.value), N(!0), V();
            },
            className: "w-full py-2 bg-transparent border-b border-border outline-none text-sm appearance-none cursor-pointer hover:text-primary transition-colors",
            children: Xhe.map((le) => /* @__PURE__ */ c.jsx("option", { value: le.value, className: "bg-popover text-foreground", children: le.label }, le.value))
          }
        )
      ] }) }),
      /* @__PURE__ */ c.jsxs("div", { children: [
        /* @__PURE__ */ c.jsx("label", { className: "text-xs text-muted-foreground", children: " ()" }),
        /* @__PURE__ */ c.jsx(
          "input",
          {
            type: "text",
            value: h,
            onChange: (le) => {
              m(le.target.value), N(!0);
            },
            onBlur: V,
            style: q8,
            placeholder: ", Red, "
          }
        )
      ] })
    ] }),
    /* @__PURE__ */ c.jsx(Br, { spacing: "lg" }),
    /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-2 flex-1 min-h-[200px]", children: [
      /* @__PURE__ */ c.jsxs("div", { className: "flex justify-between items-center", children: [
        /* @__PURE__ */ c.jsx("label", { className: "text-xs text-muted-foreground font-medium uppercase tracking-wider", children: " Profile (JSON)" }),
        C && /* @__PURE__ */ c.jsxs("span", { className: "text-xs text-red-500 flex items-center gap-1", children: [
          /* @__PURE__ */ c.jsx(km, { size: 12 }),
          ""
        ] })
      ] }),
      /* @__PURE__ */ c.jsx(
        "textarea",
        {
          value: w,
          onChange: (le) => te(le.target.value),
          onBlur: V,
          className: `
                        flex-1 w-full p-4 font-mono text-xs leading-relaxed
                        bg-muted/50 border rounded-md resize-none outline-none
                        transition-colors
                        ${C ? "border-red-500 focus:border-red-500" : "border-border focus:border-primary"}
                    `,
          spellCheck: !1
        }
      )
    ] }),
    /* @__PURE__ */ c.jsx(Br, { spacing: "lg" }),
    /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-2", children: [
      /* @__PURE__ */ c.jsxs("div", { className: "flex justify-between items-center", children: [
        /* @__PURE__ */ c.jsx("label", { className: "text-xs text-muted-foreground", children: " (YAML/Text)" }),
        /* @__PURE__ */ c.jsxs(
          "button",
          {
            onClick: $,
            className: "flex items-center gap-1 text-[10px] text-primary hover:underline",
            title: " Profile ",
            children: [
              /* @__PURE__ */ c.jsx(fr, { size: 10 }),
              " Profile "
            ]
          }
        )
      ] }),
      /* @__PURE__ */ c.jsx(
        "textarea",
        {
          value: x,
          onChange: (le) => {
            b(le.target.value), N(!0);
          },
          onBlur: V,
          rows: 6,
          className: "w-full p-3 text-sm bg-transparent border border-border rounded-md outline-none focus:border-primary transition-colors resize-vertical",
          placeholder: " LLM ..."
        }
      ),
      /* @__PURE__ */ c.jsx("p", { className: "text-[10px] text-muted-foreground", children: "*RAG " })
    ] }),
    /* @__PURE__ */ c.jsx("div", { className: "h-4" }),
    " "
  ] });
  return t ? /* @__PURE__ */ c.jsxs("div", { className: "fixed inset-0 bg-background z-50 flex flex-col", style: { height: "100dvh" }, children: [
    /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-3 px-4 py-3 border-b border-border shrink-0", children: [
      /* @__PURE__ */ c.jsx("button", { onClick: i, className: "p-1 rounded hover:bg-muted", children: /* @__PURE__ */ c.jsx($b, { size: 20 }) }),
      /* @__PURE__ */ c.jsx("h2", { className: "text-lg font-light flex-1", children: "" }),
      /* @__PURE__ */ c.jsx("button", { onClick: () => t && (r == null ? void 0 : r(e.id)), className: "p-2 text-destructive", children: /* @__PURE__ */ c.jsx(pa, { size: 18 }) })
    ] }),
    /* @__PURE__ */ c.jsx("div", { className: "flex-1 overflow-y-auto p-4 space-y-4", children: G })
  ] }) : /* @__PURE__ */ c.jsxs("div", { className: "h-full flex flex-col", children: [
    /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2 pb-4 border-b border-border shrink-0", children: [
      /* @__PURE__ */ c.jsx("h3", { className: "text-sm font-medium text-primary flex-1", children: "" }),
      /* @__PURE__ */ c.jsx(
        "button",
        {
          onClick: () => r == null ? void 0 : r(e.id),
          className: "p-1.5 text-destructive hover:bg-destructive/10 rounded",
          children: /* @__PURE__ */ c.jsx(pa, { size: 16 })
        }
      )
    ] }),
    /* @__PURE__ */ c.jsx("div", { className: "flex-1 overflow-y-auto py-4 space-y-4 no-scrollbar", children: G })
  ] });
});
N$.displayName = "EntityEditor";
function ii(e) {
  if (typeof e == "string" || typeof e == "number") return "" + e;
  let t = "";
  if (Array.isArray(e))
    for (let n = 0, r; n < e.length; n++)
      (r = ii(e[n])) !== "" && (t += (t && " ") + r);
  else
    for (let n in e)
      e[n] && (t += (t && " ") + n);
  return t;
}
var Qhe = { value: () => {
} };
function pw() {
  for (var e = 0, t = arguments.length, n = {}, r; e < t; ++e) {
    if (!(r = arguments[e] + "") || r in n || /[\s.]/.test(r)) throw new Error("illegal type: " + r);
    n[r] = [];
  }
  return new K1(n);
}
function K1(e) {
  this._ = e;
}
function Jhe(e, t) {
  return e.trim().split(/^|\s+/).map(function(n) {
    var r = "", i = n.indexOf(".");
    if (i >= 0 && (r = n.slice(i + 1), n = n.slice(0, i)), n && !t.hasOwnProperty(n)) throw new Error("unknown type: " + n);
    return { type: n, name: r };
  });
}
K1.prototype = pw.prototype = {
  constructor: K1,
  on: function(e, t) {
    var n = this._, r = Jhe(e + "", n), i, s = -1, a = r.length;
    if (arguments.length < 2) {
      for (; ++s < a; ) if ((i = (e = r[s]).type) && (i = epe(n[i], e.name))) return i;
      return;
    }
    if (t != null && typeof t != "function") throw new Error("invalid callback: " + t);
    for (; ++s < a; )
      if (i = (e = r[s]).type) n[i] = F8(n[i], e.name, t);
      else if (t == null) for (i in n) n[i] = F8(n[i], e.name, null);
    return this;
  },
  copy: function() {
    var e = {}, t = this._;
    for (var n in t) e[n] = t[n].slice();
    return new K1(e);
  },
  call: function(e, t) {
    if ((i = arguments.length - 2) > 0) for (var n = new Array(i), r = 0, i, s; r < i; ++r) n[r] = arguments[r + 2];
    if (!this._.hasOwnProperty(e)) throw new Error("unknown type: " + e);
    for (s = this._[e], r = 0, i = s.length; r < i; ++r) s[r].value.apply(t, n);
  },
  apply: function(e, t, n) {
    if (!this._.hasOwnProperty(e)) throw new Error("unknown type: " + e);
    for (var r = this._[e], i = 0, s = r.length; i < s; ++i) r[i].value.apply(t, n);
  }
};
function epe(e, t) {
  for (var n = 0, r = e.length, i; n < r; ++n)
    if ((i = e[n]).name === t)
      return i.value;
}
function F8(e, t, n) {
  for (var r = 0, i = e.length; r < i; ++r)
    if (e[r].name === t) {
      e[r] = Qhe, e = e.slice(0, r).concat(e.slice(r + 1));
      break;
    }
  return n != null && e.push({ name: t, value: n }), e;
}
var j5 = "http://www.w3.org/1999/xhtml";
const U8 = {
  svg: "http://www.w3.org/2000/svg",
  xhtml: j5,
  xlink: "http://www.w3.org/1999/xlink",
  xml: "http://www.w3.org/XML/1998/namespace",
  xmlns: "http://www.w3.org/2000/xmlns/"
};
function mw(e) {
  var t = e += "", n = t.indexOf(":");
  return n >= 0 && (t = e.slice(0, n)) !== "xmlns" && (e = e.slice(n + 1)), U8.hasOwnProperty(t) ? { space: U8[t], local: e } : e;
}
function tpe(e) {
  return function() {
    var t = this.ownerDocument, n = this.namespaceURI;
    return n === j5 && t.documentElement.namespaceURI === j5 ? t.createElement(e) : t.createElementNS(n, e);
  };
}
function npe(e) {
  return function() {
    return this.ownerDocument.createElementNS(e.space, e.local);
  };
}
function R$(e) {
  var t = mw(e);
  return (t.local ? npe : tpe)(t);
}
function rpe() {
}
function vj(e) {
  return e == null ? rpe : function() {
    return this.querySelector(e);
  };
}
function ipe(e) {
  typeof e != "function" && (e = vj(e));
  for (var t = this._groups, n = t.length, r = new Array(n), i = 0; i < n; ++i)
    for (var s = t[i], a = s.length, u = r[i] = new Array(a), d, f, h = 0; h < a; ++h)
      (d = s[h]) && (f = e.call(d, d.__data__, h, s)) && ("__data__" in d && (f.__data__ = d.__data__), u[h] = f);
  return new qa(r, this._parents);
}
function spe(e) {
  return e == null ? [] : Array.isArray(e) ? e : Array.from(e);
}
function ape() {
  return [];
}
function M$(e) {
  return e == null ? ape : function() {
    return this.querySelectorAll(e);
  };
}
function ope(e) {
  return function() {
    return spe(e.apply(this, arguments));
  };
}
function lpe(e) {
  typeof e == "function" ? e = ope(e) : e = M$(e);
  for (var t = this._groups, n = t.length, r = [], i = [], s = 0; s < n; ++s)
    for (var a = t[s], u = a.length, d, f = 0; f < u; ++f)
      (d = a[f]) && (r.push(e.call(d, d.__data__, f, a)), i.push(d));
  return new qa(r, i);
}
function O$(e) {
  return function() {
    return this.matches(e);
  };
}
function D$(e) {
  return function(t) {
    return t.matches(e);
  };
}
var upe = Array.prototype.find;
function cpe(e) {
  return function() {
    return upe.call(this.children, e);
  };
}
function dpe() {
  return this.firstElementChild;
}
function fpe(e) {
  return this.select(e == null ? dpe : cpe(typeof e == "function" ? e : D$(e)));
}
var hpe = Array.prototype.filter;
function ppe() {
  return Array.from(this.children);
}
function mpe(e) {
  return function() {
    return hpe.call(this.children, e);
  };
}
function gpe(e) {
  return this.selectAll(e == null ? ppe : mpe(typeof e == "function" ? e : D$(e)));
}
function ype(e) {
  typeof e != "function" && (e = O$(e));
  for (var t = this._groups, n = t.length, r = new Array(n), i = 0; i < n; ++i)
    for (var s = t[i], a = s.length, u = r[i] = [], d, f = 0; f < a; ++f)
      (d = s[f]) && e.call(d, d.__data__, f, s) && u.push(d);
  return new qa(r, this._parents);
}
function z$(e) {
  return new Array(e.length);
}
function xpe() {
  return new qa(this._enter || this._groups.map(z$), this._parents);
}
function jb(e, t) {
  this.ownerDocument = e.ownerDocument, this.namespaceURI = e.namespaceURI, this._next = null, this._parent = e, this.__data__ = t;
}
jb.prototype = {
  constructor: jb,
  appendChild: function(e) {
    return this._parent.insertBefore(e, this._next);
  },
  insertBefore: function(e, t) {
    return this._parent.insertBefore(e, t);
  },
  querySelector: function(e) {
    return this._parent.querySelector(e);
  },
  querySelectorAll: function(e) {
    return this._parent.querySelectorAll(e);
  }
};
function vpe(e) {
  return function() {
    return e;
  };
}
function bpe(e, t, n, r, i, s) {
  for (var a = 0, u, d = t.length, f = s.length; a < f; ++a)
    (u = t[a]) ? (u.__data__ = s[a], r[a] = u) : n[a] = new jb(e, s[a]);
  for (; a < d; ++a)
    (u = t[a]) && (i[a] = u);
}
function wpe(e, t, n, r, i, s, a) {
  var u, d, f = /* @__PURE__ */ new Map(), h = t.length, m = s.length, x = new Array(h), b;
  for (u = 0; u < h; ++u)
    (d = t[u]) && (x[u] = b = a.call(d, d.__data__, u, t) + "", f.has(b) ? i[u] = d : f.set(b, d));
  for (u = 0; u < m; ++u)
    b = a.call(e, s[u], u, s) + "", (d = f.get(b)) ? (r[u] = d, d.__data__ = s[u], f.delete(b)) : n[u] = new jb(e, s[u]);
  for (u = 0; u < h; ++u)
    (d = t[u]) && f.get(x[u]) === d && (i[u] = d);
}
function _pe(e) {
  return e.__data__;
}
function Spe(e, t) {
  if (!arguments.length) return Array.from(this, _pe);
  var n = t ? wpe : bpe, r = this._parents, i = this._groups;
  typeof e != "function" && (e = vpe(e));
  for (var s = i.length, a = new Array(s), u = new Array(s), d = new Array(s), f = 0; f < s; ++f) {
    var h = r[f], m = i[f], x = m.length, b = Epe(e.call(h, h && h.__data__, f, r)), w = b.length, S = u[f] = new Array(w), C = a[f] = new Array(w), T = d[f] = new Array(x);
    n(h, m, S, C, T, b, t);
    for (var R = 0, N = 0, M, P; R < w; ++R)
      if (M = S[R]) {
        for (R >= N && (N = R + 1); !(P = C[N]) && ++N < w; ) ;
        M._next = P || null;
      }
  }
  return a = new qa(a, r), a._enter = u, a._exit = d, a;
}
function Epe(e) {
  return typeof e == "object" && "length" in e ? e : Array.from(e);
}
function Cpe() {
  return new qa(this._exit || this._groups.map(z$), this._parents);
}
function kpe(e, t, n) {
  var r = this.enter(), i = this, s = this.exit();
  return typeof e == "function" ? (r = e(r), r && (r = r.selection())) : r = r.append(e + ""), t != null && (i = t(i), i && (i = i.selection())), n == null ? s.remove() : n(s), r && i ? r.merge(i).order() : i;
}
function Tpe(e) {
  for (var t = e.selection ? e.selection() : e, n = this._groups, r = t._groups, i = n.length, s = r.length, a = Math.min(i, s), u = new Array(i), d = 0; d < a; ++d)
    for (var f = n[d], h = r[d], m = f.length, x = u[d] = new Array(m), b, w = 0; w < m; ++w)
      (b = f[w] || h[w]) && (x[w] = b);
  for (; d < i; ++d)
    u[d] = n[d];
  return new qa(u, this._parents);
}
function jpe() {
  for (var e = this._groups, t = -1, n = e.length; ++t < n; )
    for (var r = e[t], i = r.length - 1, s = r[i], a; --i >= 0; )
      (a = r[i]) && (s && a.compareDocumentPosition(s) ^ 4 && s.parentNode.insertBefore(a, s), s = a);
  return this;
}
function Ape(e) {
  e || (e = Npe);
  function t(m, x) {
    return m && x ? e(m.__data__, x.__data__) : !m - !x;
  }
  for (var n = this._groups, r = n.length, i = new Array(r), s = 0; s < r; ++s) {
    for (var a = n[s], u = a.length, d = i[s] = new Array(u), f, h = 0; h < u; ++h)
      (f = a[h]) && (d[h] = f);
    d.sort(t);
  }
  return new qa(i, this._parents).order();
}
function Npe(e, t) {
  return e < t ? -1 : e > t ? 1 : e >= t ? 0 : NaN;
}
function Rpe() {
  var e = arguments[0];
  return arguments[0] = this, e.apply(null, arguments), this;
}
function Mpe() {
  return Array.from(this);
}
function Ope() {
  for (var e = this._groups, t = 0, n = e.length; t < n; ++t)
    for (var r = e[t], i = 0, s = r.length; i < s; ++i) {
      var a = r[i];
      if (a) return a;
    }
  return null;
}
function Dpe() {
  let e = 0;
  for (const t of this) ++e;
  return e;
}
function zpe() {
  return !this.node();
}
function Ppe(e) {
  for (var t = this._groups, n = 0, r = t.length; n < r; ++n)
    for (var i = t[n], s = 0, a = i.length, u; s < a; ++s)
      (u = i[s]) && e.call(u, u.__data__, s, i);
  return this;
}
function Ipe(e) {
  return function() {
    this.removeAttribute(e);
  };
}
function Lpe(e) {
  return function() {
    this.removeAttributeNS(e.space, e.local);
  };
}
function Bpe(e, t) {
  return function() {
    this.setAttribute(e, t);
  };
}
function $pe(e, t) {
  return function() {
    this.setAttributeNS(e.space, e.local, t);
  };
}
function qpe(e, t) {
  return function() {
    var n = t.apply(this, arguments);
    n == null ? this.removeAttribute(e) : this.setAttribute(e, n);
  };
}
function Fpe(e, t) {
  return function() {
    var n = t.apply(this, arguments);
    n == null ? this.removeAttributeNS(e.space, e.local) : this.setAttributeNS(e.space, e.local, n);
  };
}
function Upe(e, t) {
  var n = mw(e);
  if (arguments.length < 2) {
    var r = this.node();
    return n.local ? r.getAttributeNS(n.space, n.local) : r.getAttribute(n);
  }
  return this.each((t == null ? n.local ? Lpe : Ipe : typeof t == "function" ? n.local ? Fpe : qpe : n.local ? $pe : Bpe)(n, t));
}
function P$(e) {
  return e.ownerDocument && e.ownerDocument.defaultView || e.document && e || e.defaultView;
}
function Hpe(e) {
  return function() {
    this.style.removeProperty(e);
  };
}
function Vpe(e, t, n) {
  return function() {
    this.style.setProperty(e, t, n);
  };
}
function Gpe(e, t, n) {
  return function() {
    var r = t.apply(this, arguments);
    r == null ? this.style.removeProperty(e) : this.style.setProperty(e, r, n);
  };
}
function Kpe(e, t, n) {
  return arguments.length > 1 ? this.each((t == null ? Hpe : typeof t == "function" ? Gpe : Vpe)(e, t, n ?? "")) : Im(this.node(), e);
}
function Im(e, t) {
  return e.style.getPropertyValue(t) || P$(e).getComputedStyle(e, null).getPropertyValue(t);
}
function Ype(e) {
  return function() {
    delete this[e];
  };
}
function Wpe(e, t) {
  return function() {
    this[e] = t;
  };
}
function Zpe(e, t) {
  return function() {
    var n = t.apply(this, arguments);
    n == null ? delete this[e] : this[e] = n;
  };
}
function Xpe(e, t) {
  return arguments.length > 1 ? this.each((t == null ? Ype : typeof t == "function" ? Zpe : Wpe)(e, t)) : this.node()[e];
}
function I$(e) {
  return e.trim().split(/^|\s+/);
}
function bj(e) {
  return e.classList || new L$(e);
}
function L$(e) {
  this._node = e, this._names = I$(e.getAttribute("class") || "");
}
L$.prototype = {
  add: function(e) {
    var t = this._names.indexOf(e);
    t < 0 && (this._names.push(e), this._node.setAttribute("class", this._names.join(" ")));
  },
  remove: function(e) {
    var t = this._names.indexOf(e);
    t >= 0 && (this._names.splice(t, 1), this._node.setAttribute("class", this._names.join(" ")));
  },
  contains: function(e) {
    return this._names.indexOf(e) >= 0;
  }
};
function B$(e, t) {
  for (var n = bj(e), r = -1, i = t.length; ++r < i; ) n.add(t[r]);
}
function $$(e, t) {
  for (var n = bj(e), r = -1, i = t.length; ++r < i; ) n.remove(t[r]);
}
function Qpe(e) {
  return function() {
    B$(this, e);
  };
}
function Jpe(e) {
  return function() {
    $$(this, e);
  };
}
function eme(e, t) {
  return function() {
    (t.apply(this, arguments) ? B$ : $$)(this, e);
  };
}
function tme(e, t) {
  var n = I$(e + "");
  if (arguments.length < 2) {
    for (var r = bj(this.node()), i = -1, s = n.length; ++i < s; ) if (!r.contains(n[i])) return !1;
    return !0;
  }
  return this.each((typeof t == "function" ? eme : t ? Qpe : Jpe)(n, t));
}
function nme() {
  this.textContent = "";
}
function rme(e) {
  return function() {
    this.textContent = e;
  };
}
function ime(e) {
  return function() {
    var t = e.apply(this, arguments);
    this.textContent = t ?? "";
  };
}
function sme(e) {
  return arguments.length ? this.each(e == null ? nme : (typeof e == "function" ? ime : rme)(e)) : this.node().textContent;
}
function ame() {
  this.innerHTML = "";
}
function ome(e) {
  return function() {
    this.innerHTML = e;
  };
}
function lme(e) {
  return function() {
    var t = e.apply(this, arguments);
    this.innerHTML = t ?? "";
  };
}
function ume(e) {
  return arguments.length ? this.each(e == null ? ame : (typeof e == "function" ? lme : ome)(e)) : this.node().innerHTML;
}
function cme() {
  this.nextSibling && this.parentNode.appendChild(this);
}
function dme() {
  return this.each(cme);
}
function fme() {
  this.previousSibling && this.parentNode.insertBefore(this, this.parentNode.firstChild);
}
function hme() {
  return this.each(fme);
}
function pme(e) {
  var t = typeof e == "function" ? e : R$(e);
  return this.select(function() {
    return this.appendChild(t.apply(this, arguments));
  });
}
function mme() {
  return null;
}
function gme(e, t) {
  var n = typeof e == "function" ? e : R$(e), r = t == null ? mme : typeof t == "function" ? t : vj(t);
  return this.select(function() {
    return this.insertBefore(n.apply(this, arguments), r.apply(this, arguments) || null);
  });
}
function yme() {
  var e = this.parentNode;
  e && e.removeChild(this);
}
function xme() {
  return this.each(yme);
}
function vme() {
  var e = this.cloneNode(!1), t = this.parentNode;
  return t ? t.insertBefore(e, this.nextSibling) : e;
}
function bme() {
  var e = this.cloneNode(!0), t = this.parentNode;
  return t ? t.insertBefore(e, this.nextSibling) : e;
}
function wme(e) {
  return this.select(e ? bme : vme);
}
function _me(e) {
  return arguments.length ? this.property("__data__", e) : this.node().__data__;
}
function Sme(e) {
  return function(t) {
    e.call(this, t, this.__data__);
  };
}
function Eme(e) {
  return e.trim().split(/^|\s+/).map(function(t) {
    var n = "", r = t.indexOf(".");
    return r >= 0 && (n = t.slice(r + 1), t = t.slice(0, r)), { type: t, name: n };
  });
}
function Cme(e) {
  return function() {
    var t = this.__on;
    if (t) {
      for (var n = 0, r = -1, i = t.length, s; n < i; ++n)
        s = t[n], (!e.type || s.type === e.type) && s.name === e.name ? this.removeEventListener(s.type, s.listener, s.options) : t[++r] = s;
      ++r ? t.length = r : delete this.__on;
    }
  };
}
function kme(e, t, n) {
  return function() {
    var r = this.__on, i, s = Sme(t);
    if (r) {
      for (var a = 0, u = r.length; a < u; ++a)
        if ((i = r[a]).type === e.type && i.name === e.name) {
          this.removeEventListener(i.type, i.listener, i.options), this.addEventListener(i.type, i.listener = s, i.options = n), i.value = t;
          return;
        }
    }
    this.addEventListener(e.type, s, n), i = { type: e.type, name: e.name, value: t, listener: s, options: n }, r ? r.push(i) : this.__on = [i];
  };
}
function Tme(e, t, n) {
  var r = Eme(e + ""), i, s = r.length, a;
  if (arguments.length < 2) {
    var u = this.node().__on;
    if (u) {
      for (var d = 0, f = u.length, h; d < f; ++d)
        for (i = 0, h = u[d]; i < s; ++i)
          if ((a = r[i]).type === h.type && a.name === h.name)
            return h.value;
    }
    return;
  }
  for (u = t ? kme : Cme, i = 0; i < s; ++i) this.each(u(r[i], t, n));
  return this;
}
function q$(e, t, n) {
  var r = P$(e), i = r.CustomEvent;
  typeof i == "function" ? i = new i(t, n) : (i = r.document.createEvent("Event"), n ? (i.initEvent(t, n.bubbles, n.cancelable), i.detail = n.detail) : i.initEvent(t, !1, !1)), e.dispatchEvent(i);
}
function jme(e, t) {
  return function() {
    return q$(this, e, t);
  };
}
function Ame(e, t) {
  return function() {
    return q$(this, e, t.apply(this, arguments));
  };
}
function Nme(e, t) {
  return this.each((typeof t == "function" ? Ame : jme)(e, t));
}
function* Rme() {
  for (var e = this._groups, t = 0, n = e.length; t < n; ++t)
    for (var r = e[t], i = 0, s = r.length, a; i < s; ++i)
      (a = r[i]) && (yield a);
}
var F$ = [null];
function qa(e, t) {
  this._groups = e, this._parents = t;
}
function ux() {
  return new qa([[document.documentElement]], F$);
}
function Mme() {
  return this;
}
qa.prototype = ux.prototype = {
  constructor: qa,
  select: ipe,
  selectAll: lpe,
  selectChild: fpe,
  selectChildren: gpe,
  filter: ype,
  data: Spe,
  enter: xpe,
  exit: Cpe,
  join: kpe,
  merge: Tpe,
  selection: Mme,
  order: jpe,
  sort: Ape,
  call: Rpe,
  nodes: Mpe,
  node: Ope,
  size: Dpe,
  empty: zpe,
  each: Ppe,
  attr: Upe,
  style: Kpe,
  property: Xpe,
  classed: tme,
  text: sme,
  html: ume,
  raise: dme,
  lower: hme,
  append: pme,
  insert: gme,
  remove: xme,
  clone: wme,
  datum: _me,
  on: Tme,
  dispatch: Nme,
  [Symbol.iterator]: Rme
};
function La(e) {
  return typeof e == "string" ? new qa([[document.querySelector(e)]], [document.documentElement]) : new qa([[e]], F$);
}
function Ome(e) {
  let t;
  for (; t = e.sourceEvent; ) e = t;
  return e;
}
function Ko(e, t) {
  if (e = Ome(e), t === void 0 && (t = e.currentTarget), t) {
    var n = t.ownerSVGElement || t;
    if (n.createSVGPoint) {
      var r = n.createSVGPoint();
      return r.x = e.clientX, r.y = e.clientY, r = r.matrixTransform(t.getScreenCTM().inverse()), [r.x, r.y];
    }
    if (t.getBoundingClientRect) {
      var i = t.getBoundingClientRect();
      return [e.clientX - i.left - t.clientLeft, e.clientY - i.top - t.clientTop];
    }
  }
  return [e.pageX, e.pageY];
}
const Dme = { passive: !1 }, Py = { capture: !0, passive: !1 };
function D_(e) {
  e.stopImmediatePropagation();
}
function _m(e) {
  e.preventDefault(), e.stopImmediatePropagation();
}
function U$(e) {
  var t = e.document.documentElement, n = La(e).on("dragstart.drag", _m, Py);
  "onselectstart" in t ? n.on("selectstart.drag", _m, Py) : (t.__noselect = t.style.MozUserSelect, t.style.MozUserSelect = "none");
}
function H$(e, t) {
  var n = e.document.documentElement, r = La(e).on("dragstart.drag", null);
  t && (r.on("click.drag", _m, Py), setTimeout(function() {
    r.on("click.drag", null);
  }, 0)), "onselectstart" in n ? r.on("selectstart.drag", null) : (n.style.MozUserSelect = n.__noselect, delete n.__noselect);
}
const _1 = (e) => () => e;
function A5(e, {
  sourceEvent: t,
  subject: n,
  target: r,
  identifier: i,
  active: s,
  x: a,
  y: u,
  dx: d,
  dy: f,
  dispatch: h
}) {
  Object.defineProperties(this, {
    type: { value: e, enumerable: !0, configurable: !0 },
    sourceEvent: { value: t, enumerable: !0, configurable: !0 },
    subject: { value: n, enumerable: !0, configurable: !0 },
    target: { value: r, enumerable: !0, configurable: !0 },
    identifier: { value: i, enumerable: !0, configurable: !0 },
    active: { value: s, enumerable: !0, configurable: !0 },
    x: { value: a, enumerable: !0, configurable: !0 },
    y: { value: u, enumerable: !0, configurable: !0 },
    dx: { value: d, enumerable: !0, configurable: !0 },
    dy: { value: f, enumerable: !0, configurable: !0 },
    _: { value: h }
  });
}
A5.prototype.on = function() {
  var e = this._.on.apply(this._, arguments);
  return e === this._ ? this : e;
};
function zme(e) {
  return !e.ctrlKey && !e.button;
}
function Pme() {
  return this.parentNode;
}
function Ime(e, t) {
  return t ?? { x: e.x, y: e.y };
}
function Lme() {
  return navigator.maxTouchPoints || "ontouchstart" in this;
}
function V$() {
  var e = zme, t = Pme, n = Ime, r = Lme, i = {}, s = pw("start", "drag", "end"), a = 0, u, d, f, h, m = 0;
  function x(M) {
    M.on("mousedown.drag", b).filter(r).on("touchstart.drag", C).on("touchmove.drag", T, Dme).on("touchend.drag touchcancel.drag", R).style("touch-action", "none").style("-webkit-tap-highlight-color", "rgba(0,0,0,0)");
  }
  function b(M, P) {
    if (!(h || !e.call(this, M, P))) {
      var D = N(this, t.call(this, M, P), M, P, "mouse");
      D && (La(M.view).on("mousemove.drag", w, Py).on("mouseup.drag", S, Py), U$(M.view), D_(M), f = !1, u = M.clientX, d = M.clientY, D("start", M));
    }
  }
  function w(M) {
    if (_m(M), !f) {
      var P = M.clientX - u, D = M.clientY - d;
      f = P * P + D * D > m;
    }
    i.mouse("drag", M);
  }
  function S(M) {
    La(M.view).on("mousemove.drag mouseup.drag", null), H$(M.view, f), _m(M), i.mouse("end", M);
  }
  function C(M, P) {
    if (e.call(this, M, P)) {
      var D = M.changedTouches, q = t.call(this, M, P), Y = D.length, te, V;
      for (te = 0; te < Y; ++te)
        (V = N(this, q, M, P, D[te].identifier, D[te])) && (D_(M), V("start", M, D[te]));
    }
  }
  function T(M) {
    var P = M.changedTouches, D = P.length, q, Y;
    for (q = 0; q < D; ++q)
      (Y = i[P[q].identifier]) && (_m(M), Y("drag", M, P[q]));
  }
  function R(M) {
    var P = M.changedTouches, D = P.length, q, Y;
    for (h && clearTimeout(h), h = setTimeout(function() {
      h = null;
    }, 500), q = 0; q < D; ++q)
      (Y = i[P[q].identifier]) && (D_(M), Y("end", M, P[q]));
  }
  function N(M, P, D, q, Y, te) {
    var V = s.copy(), $ = Ko(te || D, P), G, le, Z;
    if ((Z = n.call(M, new A5("beforestart", {
      sourceEvent: D,
      target: x,
      identifier: Y,
      active: a,
      x: $[0],
      y: $[1],
      dx: 0,
      dy: 0,
      dispatch: V
    }), q)) != null)
      return G = Z.x - $[0] || 0, le = Z.y - $[1] || 0, function oe(X, ce, pe) {
        var de = $, H;
        switch (X) {
          case "start":
            i[Y] = oe, H = a++;
            break;
          case "end":
            delete i[Y], --a;
          // falls through
          case "drag":
            $ = Ko(pe || ce, P), H = a;
            break;
        }
        V.call(
          X,
          M,
          new A5(X, {
            sourceEvent: ce,
            subject: Z,
            target: x,
            identifier: Y,
            active: H,
            x: $[0] + G,
            y: $[1] + le,
            dx: $[0] - de[0],
            dy: $[1] - de[1],
            dispatch: V
          }),
          q
        );
      };
  }
  return x.filter = function(M) {
    return arguments.length ? (e = typeof M == "function" ? M : _1(!!M), x) : e;
  }, x.container = function(M) {
    return arguments.length ? (t = typeof M == "function" ? M : _1(M), x) : t;
  }, x.subject = function(M) {
    return arguments.length ? (n = typeof M == "function" ? M : _1(M), x) : n;
  }, x.touchable = function(M) {
    return arguments.length ? (r = typeof M == "function" ? M : _1(!!M), x) : r;
  }, x.on = function() {
    var M = s.on.apply(s, arguments);
    return M === s ? x : M;
  }, x.clickDistance = function(M) {
    return arguments.length ? (m = (M = +M) * M, x) : Math.sqrt(m);
  }, x;
}
function wj(e, t, n) {
  e.prototype = t.prototype = n, n.constructor = e;
}
function G$(e, t) {
  var n = Object.create(e.prototype);
  for (var r in t) n[r] = t[r];
  return n;
}
function cx() {
}
var Iy = 0.7, Ab = 1 / Iy, Sm = "\\s*([+-]?\\d+)\\s*", Ly = "\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*", nu = "\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*", Bme = /^#([0-9a-f]{3,8})$/, $me = new RegExp(`^rgb\\(${Sm},${Sm},${Sm}\\)$`), qme = new RegExp(`^rgb\\(${nu},${nu},${nu}\\)$`), Fme = new RegExp(`^rgba\\(${Sm},${Sm},${Sm},${Ly}\\)$`), Ume = new RegExp(`^rgba\\(${nu},${nu},${nu},${Ly}\\)$`), Hme = new RegExp(`^hsl\\(${Ly},${nu},${nu}\\)$`), Vme = new RegExp(`^hsla\\(${Ly},${nu},${nu},${Ly}\\)$`), H8 = {
  aliceblue: 15792383,
  antiquewhite: 16444375,
  aqua: 65535,
  aquamarine: 8388564,
  azure: 15794175,
  beige: 16119260,
  bisque: 16770244,
  black: 0,
  blanchedalmond: 16772045,
  blue: 255,
  blueviolet: 9055202,
  brown: 10824234,
  burlywood: 14596231,
  cadetblue: 6266528,
  chartreuse: 8388352,
  chocolate: 13789470,
  coral: 16744272,
  cornflowerblue: 6591981,
  cornsilk: 16775388,
  crimson: 14423100,
  cyan: 65535,
  darkblue: 139,
  darkcyan: 35723,
  darkgoldenrod: 12092939,
  darkgray: 11119017,
  darkgreen: 25600,
  darkgrey: 11119017,
  darkkhaki: 12433259,
  darkmagenta: 9109643,
  darkolivegreen: 5597999,
  darkorange: 16747520,
  darkorchid: 10040012,
  darkred: 9109504,
  darksalmon: 15308410,
  darkseagreen: 9419919,
  darkslateblue: 4734347,
  darkslategray: 3100495,
  darkslategrey: 3100495,
  darkturquoise: 52945,
  darkviolet: 9699539,
  deeppink: 16716947,
  deepskyblue: 49151,
  dimgray: 6908265,
  dimgrey: 6908265,
  dodgerblue: 2003199,
  firebrick: 11674146,
  floralwhite: 16775920,
  forestgreen: 2263842,
  fuchsia: 16711935,
  gainsboro: 14474460,
  ghostwhite: 16316671,
  gold: 16766720,
  goldenrod: 14329120,
  gray: 8421504,
  green: 32768,
  greenyellow: 11403055,
  grey: 8421504,
  honeydew: 15794160,
  hotpink: 16738740,
  indianred: 13458524,
  indigo: 4915330,
  ivory: 16777200,
  khaki: 15787660,
  lavender: 15132410,
  lavenderblush: 16773365,
  lawngreen: 8190976,
  lemonchiffon: 16775885,
  lightblue: 11393254,
  lightcoral: 15761536,
  lightcyan: 14745599,
  lightgoldenrodyellow: 16448210,
  lightgray: 13882323,
  lightgreen: 9498256,
  lightgrey: 13882323,
  lightpink: 16758465,
  lightsalmon: 16752762,
  lightseagreen: 2142890,
  lightskyblue: 8900346,
  lightslategray: 7833753,
  lightslategrey: 7833753,
  lightsteelblue: 11584734,
  lightyellow: 16777184,
  lime: 65280,
  limegreen: 3329330,
  linen: 16445670,
  magenta: 16711935,
  maroon: 8388608,
  mediumaquamarine: 6737322,
  mediumblue: 205,
  mediumorchid: 12211667,
  mediumpurple: 9662683,
  mediumseagreen: 3978097,
  mediumslateblue: 8087790,
  mediumspringgreen: 64154,
  mediumturquoise: 4772300,
  mediumvioletred: 13047173,
  midnightblue: 1644912,
  mintcream: 16121850,
  mistyrose: 16770273,
  moccasin: 16770229,
  navajowhite: 16768685,
  navy: 128,
  oldlace: 16643558,
  olive: 8421376,
  olivedrab: 7048739,
  orange: 16753920,
  orangered: 16729344,
  orchid: 14315734,
  palegoldenrod: 15657130,
  palegreen: 10025880,
  paleturquoise: 11529966,
  palevioletred: 14381203,
  papayawhip: 16773077,
  peachpuff: 16767673,
  peru: 13468991,
  pink: 16761035,
  plum: 14524637,
  powderblue: 11591910,
  purple: 8388736,
  rebeccapurple: 6697881,
  red: 16711680,
  rosybrown: 12357519,
  royalblue: 4286945,
  saddlebrown: 9127187,
  salmon: 16416882,
  sandybrown: 16032864,
  seagreen: 3050327,
  seashell: 16774638,
  sienna: 10506797,
  silver: 12632256,
  skyblue: 8900331,
  slateblue: 6970061,
  slategray: 7372944,
  slategrey: 7372944,
  snow: 16775930,
  springgreen: 65407,
  steelblue: 4620980,
  tan: 13808780,
  teal: 32896,
  thistle: 14204888,
  tomato: 16737095,
  turquoise: 4251856,
  violet: 15631086,
  wheat: 16113331,
  white: 16777215,
  whitesmoke: 16119285,
  yellow: 16776960,
  yellowgreen: 10145074
};
wj(cx, _h, {
  copy(e) {
    return Object.assign(new this.constructor(), this, e);
  },
  displayable() {
    return this.rgb().displayable();
  },
  hex: V8,
  // Deprecated! Use color.formatHex.
  formatHex: V8,
  formatHex8: Gme,
  formatHsl: Kme,
  formatRgb: G8,
  toString: G8
});
function V8() {
  return this.rgb().formatHex();
}
function Gme() {
  return this.rgb().formatHex8();
}
function Kme() {
  return K$(this).formatHsl();
}
function G8() {
  return this.rgb().formatRgb();
}
function _h(e) {
  var t, n;
  return e = (e + "").trim().toLowerCase(), (t = Bme.exec(e)) ? (n = t[1].length, t = parseInt(t[1], 16), n === 6 ? K8(t) : n === 3 ? new fa(t >> 8 & 15 | t >> 4 & 240, t >> 4 & 15 | t & 240, (t & 15) << 4 | t & 15, 1) : n === 8 ? S1(t >> 24 & 255, t >> 16 & 255, t >> 8 & 255, (t & 255) / 255) : n === 4 ? S1(t >> 12 & 15 | t >> 8 & 240, t >> 8 & 15 | t >> 4 & 240, t >> 4 & 15 | t & 240, ((t & 15) << 4 | t & 15) / 255) : null) : (t = $me.exec(e)) ? new fa(t[1], t[2], t[3], 1) : (t = qme.exec(e)) ? new fa(t[1] * 255 / 100, t[2] * 255 / 100, t[3] * 255 / 100, 1) : (t = Fme.exec(e)) ? S1(t[1], t[2], t[3], t[4]) : (t = Ume.exec(e)) ? S1(t[1] * 255 / 100, t[2] * 255 / 100, t[3] * 255 / 100, t[4]) : (t = Hme.exec(e)) ? Z8(t[1], t[2] / 100, t[3] / 100, 1) : (t = Vme.exec(e)) ? Z8(t[1], t[2] / 100, t[3] / 100, t[4]) : H8.hasOwnProperty(e) ? K8(H8[e]) : e === "transparent" ? new fa(NaN, NaN, NaN, 0) : null;
}
function K8(e) {
  return new fa(e >> 16 & 255, e >> 8 & 255, e & 255, 1);
}
function S1(e, t, n, r) {
  return r <= 0 && (e = t = n = NaN), new fa(e, t, n, r);
}
function Yme(e) {
  return e instanceof cx || (e = _h(e)), e ? (e = e.rgb(), new fa(e.r, e.g, e.b, e.opacity)) : new fa();
}
function N5(e, t, n, r) {
  return arguments.length === 1 ? Yme(e) : new fa(e, t, n, r ?? 1);
}
function fa(e, t, n, r) {
  this.r = +e, this.g = +t, this.b = +n, this.opacity = +r;
}
wj(fa, N5, G$(cx, {
  brighter(e) {
    return e = e == null ? Ab : Math.pow(Ab, e), new fa(this.r * e, this.g * e, this.b * e, this.opacity);
  },
  darker(e) {
    return e = e == null ? Iy : Math.pow(Iy, e), new fa(this.r * e, this.g * e, this.b * e, this.opacity);
  },
  rgb() {
    return this;
  },
  clamp() {
    return new fa(gh(this.r), gh(this.g), gh(this.b), Nb(this.opacity));
  },
  displayable() {
    return -0.5 <= this.r && this.r < 255.5 && -0.5 <= this.g && this.g < 255.5 && -0.5 <= this.b && this.b < 255.5 && 0 <= this.opacity && this.opacity <= 1;
  },
  hex: Y8,
  // Deprecated! Use color.formatHex.
  formatHex: Y8,
  formatHex8: Wme,
  formatRgb: W8,
  toString: W8
}));
function Y8() {
  return `#${ch(this.r)}${ch(this.g)}${ch(this.b)}`;
}
function Wme() {
  return `#${ch(this.r)}${ch(this.g)}${ch(this.b)}${ch((isNaN(this.opacity) ? 1 : this.opacity) * 255)}`;
}
function W8() {
  const e = Nb(this.opacity);
  return `${e === 1 ? "rgb(" : "rgba("}${gh(this.r)}, ${gh(this.g)}, ${gh(this.b)}${e === 1 ? ")" : `, ${e})`}`;
}
function Nb(e) {
  return isNaN(e) ? 1 : Math.max(0, Math.min(1, e));
}
function gh(e) {
  return Math.max(0, Math.min(255, Math.round(e) || 0));
}
function ch(e) {
  return e = gh(e), (e < 16 ? "0" : "") + e.toString(16);
}
function Z8(e, t, n, r) {
  return r <= 0 ? e = t = n = NaN : n <= 0 || n >= 1 ? e = t = NaN : t <= 0 && (e = NaN), new Xo(e, t, n, r);
}
function K$(e) {
  if (e instanceof Xo) return new Xo(e.h, e.s, e.l, e.opacity);
  if (e instanceof cx || (e = _h(e)), !e) return new Xo();
  if (e instanceof Xo) return e;
  e = e.rgb();
  var t = e.r / 255, n = e.g / 255, r = e.b / 255, i = Math.min(t, n, r), s = Math.max(t, n, r), a = NaN, u = s - i, d = (s + i) / 2;
  return u ? (t === s ? a = (n - r) / u + (n < r) * 6 : n === s ? a = (r - t) / u + 2 : a = (t - n) / u + 4, u /= d < 0.5 ? s + i : 2 - s - i, a *= 60) : u = d > 0 && d < 1 ? 0 : a, new Xo(a, u, d, e.opacity);
}
function Zme(e, t, n, r) {
  return arguments.length === 1 ? K$(e) : new Xo(e, t, n, r ?? 1);
}
function Xo(e, t, n, r) {
  this.h = +e, this.s = +t, this.l = +n, this.opacity = +r;
}
wj(Xo, Zme, G$(cx, {
  brighter(e) {
    return e = e == null ? Ab : Math.pow(Ab, e), new Xo(this.h, this.s, this.l * e, this.opacity);
  },
  darker(e) {
    return e = e == null ? Iy : Math.pow(Iy, e), new Xo(this.h, this.s, this.l * e, this.opacity);
  },
  rgb() {
    var e = this.h % 360 + (this.h < 0) * 360, t = isNaN(e) || isNaN(this.s) ? 0 : this.s, n = this.l, r = n + (n < 0.5 ? n : 1 - n) * t, i = 2 * n - r;
    return new fa(
      z_(e >= 240 ? e - 240 : e + 120, i, r),
      z_(e, i, r),
      z_(e < 120 ? e + 240 : e - 120, i, r),
      this.opacity
    );
  },
  clamp() {
    return new Xo(X8(this.h), E1(this.s), E1(this.l), Nb(this.opacity));
  },
  displayable() {
    return (0 <= this.s && this.s <= 1 || isNaN(this.s)) && 0 <= this.l && this.l <= 1 && 0 <= this.opacity && this.opacity <= 1;
  },
  formatHsl() {
    const e = Nb(this.opacity);
    return `${e === 1 ? "hsl(" : "hsla("}${X8(this.h)}, ${E1(this.s) * 100}%, ${E1(this.l) * 100}%${e === 1 ? ")" : `, ${e})`}`;
  }
}));
function X8(e) {
  return e = (e || 0) % 360, e < 0 ? e + 360 : e;
}
function E1(e) {
  return Math.max(0, Math.min(1, e || 0));
}
function z_(e, t, n) {
  return (e < 60 ? t + (n - t) * e / 60 : e < 180 ? n : e < 240 ? t + (n - t) * (240 - e) / 60 : t) * 255;
}
const _j = (e) => () => e;
function Xme(e, t) {
  return function(n) {
    return e + n * t;
  };
}
function Qme(e, t, n) {
  return e = Math.pow(e, n), t = Math.pow(t, n) - e, n = 1 / n, function(r) {
    return Math.pow(e + r * t, n);
  };
}
function Jme(e) {
  return (e = +e) == 1 ? Y$ : function(t, n) {
    return n - t ? Qme(t, n, e) : _j(isNaN(t) ? n : t);
  };
}
function Y$(e, t) {
  var n = t - e;
  return n ? Xme(e, n) : _j(isNaN(e) ? t : e);
}
const Rb = (function e(t) {
  var n = Jme(t);
  function r(i, s) {
    var a = n((i = N5(i)).r, (s = N5(s)).r), u = n(i.g, s.g), d = n(i.b, s.b), f = Y$(i.opacity, s.opacity);
    return function(h) {
      return i.r = a(h), i.g = u(h), i.b = d(h), i.opacity = f(h), i + "";
    };
  }
  return r.gamma = e, r;
})(1);
function ege(e, t) {
  t || (t = []);
  var n = e ? Math.min(t.length, e.length) : 0, r = t.slice(), i;
  return function(s) {
    for (i = 0; i < n; ++i) r[i] = e[i] * (1 - s) + t[i] * s;
    return r;
  };
}
function tge(e) {
  return ArrayBuffer.isView(e) && !(e instanceof DataView);
}
function nge(e, t) {
  var n = t ? t.length : 0, r = e ? Math.min(n, e.length) : 0, i = new Array(r), s = new Array(n), a;
  for (a = 0; a < r; ++a) i[a] = xy(e[a], t[a]);
  for (; a < n; ++a) s[a] = t[a];
  return function(u) {
    for (a = 0; a < r; ++a) s[a] = i[a](u);
    return s;
  };
}
function rge(e, t) {
  var n = /* @__PURE__ */ new Date();
  return e = +e, t = +t, function(r) {
    return n.setTime(e * (1 - r) + t * r), n;
  };
}
function Zl(e, t) {
  return e = +e, t = +t, function(n) {
    return e * (1 - n) + t * n;
  };
}
function ige(e, t) {
  var n = {}, r = {}, i;
  (e === null || typeof e != "object") && (e = {}), (t === null || typeof t != "object") && (t = {});
  for (i in t)
    i in e ? n[i] = xy(e[i], t[i]) : r[i] = t[i];
  return function(s) {
    for (i in n) r[i] = n[i](s);
    return r;
  };
}
var R5 = /[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g, P_ = new RegExp(R5.source, "g");
function sge(e) {
  return function() {
    return e;
  };
}
function age(e) {
  return function(t) {
    return e(t) + "";
  };
}
function W$(e, t) {
  var n = R5.lastIndex = P_.lastIndex = 0, r, i, s, a = -1, u = [], d = [];
  for (e = e + "", t = t + ""; (r = R5.exec(e)) && (i = P_.exec(t)); )
    (s = i.index) > n && (s = t.slice(n, s), u[a] ? u[a] += s : u[++a] = s), (r = r[0]) === (i = i[0]) ? u[a] ? u[a] += i : u[++a] = i : (u[++a] = null, d.push({ i: a, x: Zl(r, i) })), n = P_.lastIndex;
  return n < t.length && (s = t.slice(n), u[a] ? u[a] += s : u[++a] = s), u.length < 2 ? d[0] ? age(d[0].x) : sge(t) : (t = d.length, function(f) {
    for (var h = 0, m; h < t; ++h) u[(m = d[h]).i] = m.x(f);
    return u.join("");
  });
}
function xy(e, t) {
  var n = typeof t, r;
  return t == null || n === "boolean" ? _j(t) : (n === "number" ? Zl : n === "string" ? (r = _h(t)) ? (t = r, Rb) : W$ : t instanceof _h ? Rb : t instanceof Date ? rge : tge(t) ? ege : Array.isArray(t) ? nge : typeof t.valueOf != "function" && typeof t.toString != "function" || isNaN(t) ? ige : Zl)(e, t);
}
var Q8 = 180 / Math.PI, M5 = {
  translateX: 0,
  translateY: 0,
  rotate: 0,
  skewX: 0,
  scaleX: 1,
  scaleY: 1
};
function Z$(e, t, n, r, i, s) {
  var a, u, d;
  return (a = Math.sqrt(e * e + t * t)) && (e /= a, t /= a), (d = e * n + t * r) && (n -= e * d, r -= t * d), (u = Math.sqrt(n * n + r * r)) && (n /= u, r /= u, d /= u), e * r < t * n && (e = -e, t = -t, d = -d, a = -a), {
    translateX: i,
    translateY: s,
    rotate: Math.atan2(t, e) * Q8,
    skewX: Math.atan(d) * Q8,
    scaleX: a,
    scaleY: u
  };
}
var C1;
function oge(e) {
  const t = new (typeof DOMMatrix == "function" ? DOMMatrix : WebKitCSSMatrix)(e + "");
  return t.isIdentity ? M5 : Z$(t.a, t.b, t.c, t.d, t.e, t.f);
}
function lge(e) {
  return e == null || (C1 || (C1 = document.createElementNS("http://www.w3.org/2000/svg", "g")), C1.setAttribute("transform", e), !(e = C1.transform.baseVal.consolidate())) ? M5 : (e = e.matrix, Z$(e.a, e.b, e.c, e.d, e.e, e.f));
}
function X$(e, t, n, r) {
  function i(f) {
    return f.length ? f.pop() + " " : "";
  }
  function s(f, h, m, x, b, w) {
    if (f !== m || h !== x) {
      var S = b.push("translate(", null, t, null, n);
      w.push({ i: S - 4, x: Zl(f, m) }, { i: S - 2, x: Zl(h, x) });
    } else (m || x) && b.push("translate(" + m + t + x + n);
  }
  function a(f, h, m, x) {
    f !== h ? (f - h > 180 ? h += 360 : h - f > 180 && (f += 360), x.push({ i: m.push(i(m) + "rotate(", null, r) - 2, x: Zl(f, h) })) : h && m.push(i(m) + "rotate(" + h + r);
  }
  function u(f, h, m, x) {
    f !== h ? x.push({ i: m.push(i(m) + "skewX(", null, r) - 2, x: Zl(f, h) }) : h && m.push(i(m) + "skewX(" + h + r);
  }
  function d(f, h, m, x, b, w) {
    if (f !== m || h !== x) {
      var S = b.push(i(b) + "scale(", null, ",", null, ")");
      w.push({ i: S - 4, x: Zl(f, m) }, { i: S - 2, x: Zl(h, x) });
    } else (m !== 1 || x !== 1) && b.push(i(b) + "scale(" + m + "," + x + ")");
  }
  return function(f, h) {
    var m = [], x = [];
    return f = e(f), h = e(h), s(f.translateX, f.translateY, h.translateX, h.translateY, m, x), a(f.rotate, h.rotate, m, x), u(f.skewX, h.skewX, m, x), d(f.scaleX, f.scaleY, h.scaleX, h.scaleY, m, x), f = h = null, function(b) {
      for (var w = -1, S = x.length, C; ++w < S; ) m[(C = x[w]).i] = C.x(b);
      return m.join("");
    };
  };
}
var uge = X$(oge, "px, ", "px)", "deg)"), cge = X$(lge, ", ", ")", ")"), dge = 1e-12;
function J8(e) {
  return ((e = Math.exp(e)) + 1 / e) / 2;
}
function fge(e) {
  return ((e = Math.exp(e)) - 1 / e) / 2;
}
function hge(e) {
  return ((e = Math.exp(2 * e)) - 1) / (e + 1);
}
const Y1 = (function e(t, n, r) {
  function i(s, a) {
    var u = s[0], d = s[1], f = s[2], h = a[0], m = a[1], x = a[2], b = h - u, w = m - d, S = b * b + w * w, C, T;
    if (S < dge)
      T = Math.log(x / f) / t, C = function(q) {
        return [
          u + q * b,
          d + q * w,
          f * Math.exp(t * q * T)
        ];
      };
    else {
      var R = Math.sqrt(S), N = (x * x - f * f + r * S) / (2 * f * n * R), M = (x * x - f * f - r * S) / (2 * x * n * R), P = Math.log(Math.sqrt(N * N + 1) - N), D = Math.log(Math.sqrt(M * M + 1) - M);
      T = (D - P) / t, C = function(q) {
        var Y = q * T, te = J8(P), V = f / (n * R) * (te * hge(t * Y + P) - fge(P));
        return [
          u + V * b,
          d + V * w,
          f * te / J8(t * Y + P)
        ];
      };
    }
    return C.duration = T * 1e3 * t / Math.SQRT2, C;
  }
  return i.rho = function(s) {
    var a = Math.max(1e-3, +s), u = a * a, d = u * u;
    return e(a, u, d);
  }, i;
})(Math.SQRT2, 2, 4);
var Lm = 0, ry = 0, W0 = 0, Q$ = 1e3, Mb, iy, Ob = 0, Sh = 0, gw = 0, By = typeof performance == "object" && performance.now ? performance : Date, J$ = typeof window == "object" && window.requestAnimationFrame ? window.requestAnimationFrame.bind(window) : function(e) {
  setTimeout(e, 17);
};
function Sj() {
  return Sh || (J$(pge), Sh = By.now() + gw);
}
function pge() {
  Sh = 0;
}
function Db() {
  this._call = this._time = this._next = null;
}
Db.prototype = eq.prototype = {
  constructor: Db,
  restart: function(e, t, n) {
    if (typeof e != "function") throw new TypeError("callback is not a function");
    n = (n == null ? Sj() : +n) + (t == null ? 0 : +t), !this._next && iy !== this && (iy ? iy._next = this : Mb = this, iy = this), this._call = e, this._time = n, O5();
  },
  stop: function() {
    this._call && (this._call = null, this._time = 1 / 0, O5());
  }
};
function eq(e, t, n) {
  var r = new Db();
  return r.restart(e, t, n), r;
}
function mge() {
  Sj(), ++Lm;
  for (var e = Mb, t; e; )
    (t = Sh - e._time) >= 0 && e._call.call(void 0, t), e = e._next;
  --Lm;
}
function eR() {
  Sh = (Ob = By.now()) + gw, Lm = ry = 0;
  try {
    mge();
  } finally {
    Lm = 0, yge(), Sh = 0;
  }
}
function gge() {
  var e = By.now(), t = e - Ob;
  t > Q$ && (gw -= t, Ob = e);
}
function yge() {
  for (var e, t = Mb, n, r = 1 / 0; t; )
    t._call ? (r > t._time && (r = t._time), e = t, t = t._next) : (n = t._next, t._next = null, t = e ? e._next = n : Mb = n);
  iy = e, O5(r);
}
function O5(e) {
  if (!Lm) {
    ry && (ry = clearTimeout(ry));
    var t = e - Sh;
    t > 24 ? (e < 1 / 0 && (ry = setTimeout(eR, e - By.now() - gw)), W0 && (W0 = clearInterval(W0))) : (W0 || (Ob = By.now(), W0 = setInterval(gge, Q$)), Lm = 1, J$(eR));
  }
}
function tR(e, t, n) {
  var r = new Db();
  return t = t == null ? 0 : +t, r.restart((i) => {
    r.stop(), e(i + t);
  }, t, n), r;
}
var xge = pw("start", "end", "cancel", "interrupt"), vge = [], tq = 0, nR = 1, D5 = 2, W1 = 3, rR = 4, z5 = 5, Z1 = 6;
function yw(e, t, n, r, i, s) {
  var a = e.__transition;
  if (!a) e.__transition = {};
  else if (n in a) return;
  bge(e, n, {
    name: t,
    index: r,
    // For context during callback.
    group: i,
    // For context during callback.
    on: xge,
    tween: vge,
    time: s.time,
    delay: s.delay,
    duration: s.duration,
    ease: s.ease,
    timer: null,
    state: tq
  });
}
function Ej(e, t) {
  var n = sl(e, t);
  if (n.state > tq) throw new Error("too late; already scheduled");
  return n;
}
function lu(e, t) {
  var n = sl(e, t);
  if (n.state > W1) throw new Error("too late; already running");
  return n;
}
function sl(e, t) {
  var n = e.__transition;
  if (!n || !(n = n[t])) throw new Error("transition not found");
  return n;
}
function bge(e, t, n) {
  var r = e.__transition, i;
  r[t] = n, n.timer = eq(s, 0, n.time);
  function s(f) {
    n.state = nR, n.timer.restart(a, n.delay, n.time), n.delay <= f && a(f - n.delay);
  }
  function a(f) {
    var h, m, x, b;
    if (n.state !== nR) return d();
    for (h in r)
      if (b = r[h], b.name === n.name) {
        if (b.state === W1) return tR(a);
        b.state === rR ? (b.state = Z1, b.timer.stop(), b.on.call("interrupt", e, e.__data__, b.index, b.group), delete r[h]) : +h < t && (b.state = Z1, b.timer.stop(), b.on.call("cancel", e, e.__data__, b.index, b.group), delete r[h]);
      }
    if (tR(function() {
      n.state === W1 && (n.state = rR, n.timer.restart(u, n.delay, n.time), u(f));
    }), n.state = D5, n.on.call("start", e, e.__data__, n.index, n.group), n.state === D5) {
      for (n.state = W1, i = new Array(x = n.tween.length), h = 0, m = -1; h < x; ++h)
        (b = n.tween[h].value.call(e, e.__data__, n.index, n.group)) && (i[++m] = b);
      i.length = m + 1;
    }
  }
  function u(f) {
    for (var h = f < n.duration ? n.ease.call(null, f / n.duration) : (n.timer.restart(d), n.state = z5, 1), m = -1, x = i.length; ++m < x; )
      i[m].call(e, h);
    n.state === z5 && (n.on.call("end", e, e.__data__, n.index, n.group), d());
  }
  function d() {
    n.state = Z1, n.timer.stop(), delete r[t];
    for (var f in r) return;
    delete e.__transition;
  }
}
function X1(e, t) {
  var n = e.__transition, r, i, s = !0, a;
  if (n) {
    t = t == null ? null : t + "";
    for (a in n) {
      if ((r = n[a]).name !== t) {
        s = !1;
        continue;
      }
      i = r.state > D5 && r.state < z5, r.state = Z1, r.timer.stop(), r.on.call(i ? "interrupt" : "cancel", e, e.__data__, r.index, r.group), delete n[a];
    }
    s && delete e.__transition;
  }
}
function wge(e) {
  return this.each(function() {
    X1(this, e);
  });
}
function _ge(e, t) {
  var n, r;
  return function() {
    var i = lu(this, e), s = i.tween;
    if (s !== n) {
      r = n = s;
      for (var a = 0, u = r.length; a < u; ++a)
        if (r[a].name === t) {
          r = r.slice(), r.splice(a, 1);
          break;
        }
    }
    i.tween = r;
  };
}
function Sge(e, t, n) {
  var r, i;
  if (typeof n != "function") throw new Error();
  return function() {
    var s = lu(this, e), a = s.tween;
    if (a !== r) {
      i = (r = a).slice();
      for (var u = { name: t, value: n }, d = 0, f = i.length; d < f; ++d)
        if (i[d].name === t) {
          i[d] = u;
          break;
        }
      d === f && i.push(u);
    }
    s.tween = i;
  };
}
function Ege(e, t) {
  var n = this._id;
  if (e += "", arguments.length < 2) {
    for (var r = sl(this.node(), n).tween, i = 0, s = r.length, a; i < s; ++i)
      if ((a = r[i]).name === e)
        return a.value;
    return null;
  }
  return this.each((t == null ? _ge : Sge)(n, e, t));
}
function Cj(e, t, n) {
  var r = e._id;
  return e.each(function() {
    var i = lu(this, r);
    (i.value || (i.value = {}))[t] = n.apply(this, arguments);
  }), function(i) {
    return sl(i, r).value[t];
  };
}
function nq(e, t) {
  var n;
  return (typeof t == "number" ? Zl : t instanceof _h ? Rb : (n = _h(t)) ? (t = n, Rb) : W$)(e, t);
}
function Cge(e) {
  return function() {
    this.removeAttribute(e);
  };
}
function kge(e) {
  return function() {
    this.removeAttributeNS(e.space, e.local);
  };
}
function Tge(e, t, n) {
  var r, i = n + "", s;
  return function() {
    var a = this.getAttribute(e);
    return a === i ? null : a === r ? s : s = t(r = a, n);
  };
}
function jge(e, t, n) {
  var r, i = n + "", s;
  return function() {
    var a = this.getAttributeNS(e.space, e.local);
    return a === i ? null : a === r ? s : s = t(r = a, n);
  };
}
function Age(e, t, n) {
  var r, i, s;
  return function() {
    var a, u = n(this), d;
    return u == null ? void this.removeAttribute(e) : (a = this.getAttribute(e), d = u + "", a === d ? null : a === r && d === i ? s : (i = d, s = t(r = a, u)));
  };
}
function Nge(e, t, n) {
  var r, i, s;
  return function() {
    var a, u = n(this), d;
    return u == null ? void this.removeAttributeNS(e.space, e.local) : (a = this.getAttributeNS(e.space, e.local), d = u + "", a === d ? null : a === r && d === i ? s : (i = d, s = t(r = a, u)));
  };
}
function Rge(e, t) {
  var n = mw(e), r = n === "transform" ? cge : nq;
  return this.attrTween(e, typeof t == "function" ? (n.local ? Nge : Age)(n, r, Cj(this, "attr." + e, t)) : t == null ? (n.local ? kge : Cge)(n) : (n.local ? jge : Tge)(n, r, t));
}
function Mge(e, t) {
  return function(n) {
    this.setAttribute(e, t.call(this, n));
  };
}
function Oge(e, t) {
  return function(n) {
    this.setAttributeNS(e.space, e.local, t.call(this, n));
  };
}
function Dge(e, t) {
  var n, r;
  function i() {
    var s = t.apply(this, arguments);
    return s !== r && (n = (r = s) && Oge(e, s)), n;
  }
  return i._value = t, i;
}
function zge(e, t) {
  var n, r;
  function i() {
    var s = t.apply(this, arguments);
    return s !== r && (n = (r = s) && Mge(e, s)), n;
  }
  return i._value = t, i;
}
function Pge(e, t) {
  var n = "attr." + e;
  if (arguments.length < 2) return (n = this.tween(n)) && n._value;
  if (t == null) return this.tween(n, null);
  if (typeof t != "function") throw new Error();
  var r = mw(e);
  return this.tween(n, (r.local ? Dge : zge)(r, t));
}
function Ige(e, t) {
  return function() {
    Ej(this, e).delay = +t.apply(this, arguments);
  };
}
function Lge(e, t) {
  return t = +t, function() {
    Ej(this, e).delay = t;
  };
}
function Bge(e) {
  var t = this._id;
  return arguments.length ? this.each((typeof e == "function" ? Ige : Lge)(t, e)) : sl(this.node(), t).delay;
}
function $ge(e, t) {
  return function() {
    lu(this, e).duration = +t.apply(this, arguments);
  };
}
function qge(e, t) {
  return t = +t, function() {
    lu(this, e).duration = t;
  };
}
function Fge(e) {
  var t = this._id;
  return arguments.length ? this.each((typeof e == "function" ? $ge : qge)(t, e)) : sl(this.node(), t).duration;
}
function Uge(e, t) {
  if (typeof t != "function") throw new Error();
  return function() {
    lu(this, e).ease = t;
  };
}
function Hge(e) {
  var t = this._id;
  return arguments.length ? this.each(Uge(t, e)) : sl(this.node(), t).ease;
}
function Vge(e, t) {
  return function() {
    var n = t.apply(this, arguments);
    if (typeof n != "function") throw new Error();
    lu(this, e).ease = n;
  };
}
function Gge(e) {
  if (typeof e != "function") throw new Error();
  return this.each(Vge(this._id, e));
}
function Kge(e) {
  typeof e != "function" && (e = O$(e));
  for (var t = this._groups, n = t.length, r = new Array(n), i = 0; i < n; ++i)
    for (var s = t[i], a = s.length, u = r[i] = [], d, f = 0; f < a; ++f)
      (d = s[f]) && e.call(d, d.__data__, f, s) && u.push(d);
  return new tc(r, this._parents, this._name, this._id);
}
function Yge(e) {
  if (e._id !== this._id) throw new Error();
  for (var t = this._groups, n = e._groups, r = t.length, i = n.length, s = Math.min(r, i), a = new Array(r), u = 0; u < s; ++u)
    for (var d = t[u], f = n[u], h = d.length, m = a[u] = new Array(h), x, b = 0; b < h; ++b)
      (x = d[b] || f[b]) && (m[b] = x);
  for (; u < r; ++u)
    a[u] = t[u];
  return new tc(a, this._parents, this._name, this._id);
}
function Wge(e) {
  return (e + "").trim().split(/^|\s+/).every(function(t) {
    var n = t.indexOf(".");
    return n >= 0 && (t = t.slice(0, n)), !t || t === "start";
  });
}
function Zge(e, t, n) {
  var r, i, s = Wge(t) ? Ej : lu;
  return function() {
    var a = s(this, e), u = a.on;
    u !== r && (i = (r = u).copy()).on(t, n), a.on = i;
  };
}
function Xge(e, t) {
  var n = this._id;
  return arguments.length < 2 ? sl(this.node(), n).on.on(e) : this.each(Zge(n, e, t));
}
function Qge(e) {
  return function() {
    var t = this.parentNode;
    for (var n in this.__transition) if (+n !== e) return;
    t && t.removeChild(this);
  };
}
function Jge() {
  return this.on("end.remove", Qge(this._id));
}
function e0e(e) {
  var t = this._name, n = this._id;
  typeof e != "function" && (e = vj(e));
  for (var r = this._groups, i = r.length, s = new Array(i), a = 0; a < i; ++a)
    for (var u = r[a], d = u.length, f = s[a] = new Array(d), h, m, x = 0; x < d; ++x)
      (h = u[x]) && (m = e.call(h, h.__data__, x, u)) && ("__data__" in h && (m.__data__ = h.__data__), f[x] = m, yw(f[x], t, n, x, f, sl(h, n)));
  return new tc(s, this._parents, t, n);
}
function t0e(e) {
  var t = this._name, n = this._id;
  typeof e != "function" && (e = M$(e));
  for (var r = this._groups, i = r.length, s = [], a = [], u = 0; u < i; ++u)
    for (var d = r[u], f = d.length, h, m = 0; m < f; ++m)
      if (h = d[m]) {
        for (var x = e.call(h, h.__data__, m, d), b, w = sl(h, n), S = 0, C = x.length; S < C; ++S)
          (b = x[S]) && yw(b, t, n, S, x, w);
        s.push(x), a.push(h);
      }
  return new tc(s, a, t, n);
}
var n0e = ux.prototype.constructor;
function r0e() {
  return new n0e(this._groups, this._parents);
}
function i0e(e, t) {
  var n, r, i;
  return function() {
    var s = Im(this, e), a = (this.style.removeProperty(e), Im(this, e));
    return s === a ? null : s === n && a === r ? i : i = t(n = s, r = a);
  };
}
function rq(e) {
  return function() {
    this.style.removeProperty(e);
  };
}
function s0e(e, t, n) {
  var r, i = n + "", s;
  return function() {
    var a = Im(this, e);
    return a === i ? null : a === r ? s : s = t(r = a, n);
  };
}
function a0e(e, t, n) {
  var r, i, s;
  return function() {
    var a = Im(this, e), u = n(this), d = u + "";
    return u == null && (d = u = (this.style.removeProperty(e), Im(this, e))), a === d ? null : a === r && d === i ? s : (i = d, s = t(r = a, u));
  };
}
function o0e(e, t) {
  var n, r, i, s = "style." + t, a = "end." + s, u;
  return function() {
    var d = lu(this, e), f = d.on, h = d.value[s] == null ? u || (u = rq(t)) : void 0;
    (f !== n || i !== h) && (r = (n = f).copy()).on(a, i = h), d.on = r;
  };
}
function l0e(e, t, n) {
  var r = (e += "") == "transform" ? uge : nq;
  return t == null ? this.styleTween(e, i0e(e, r)).on("end.style." + e, rq(e)) : typeof t == "function" ? this.styleTween(e, a0e(e, r, Cj(this, "style." + e, t))).each(o0e(this._id, e)) : this.styleTween(e, s0e(e, r, t), n).on("end.style." + e, null);
}
function u0e(e, t, n) {
  return function(r) {
    this.style.setProperty(e, t.call(this, r), n);
  };
}
function c0e(e, t, n) {
  var r, i;
  function s() {
    var a = t.apply(this, arguments);
    return a !== i && (r = (i = a) && u0e(e, a, n)), r;
  }
  return s._value = t, s;
}
function d0e(e, t, n) {
  var r = "style." + (e += "");
  if (arguments.length < 2) return (r = this.tween(r)) && r._value;
  if (t == null) return this.tween(r, null);
  if (typeof t != "function") throw new Error();
  return this.tween(r, c0e(e, t, n ?? ""));
}
function f0e(e) {
  return function() {
    this.textContent = e;
  };
}
function h0e(e) {
  return function() {
    var t = e(this);
    this.textContent = t ?? "";
  };
}
function p0e(e) {
  return this.tween("text", typeof e == "function" ? h0e(Cj(this, "text", e)) : f0e(e == null ? "" : e + ""));
}
function m0e(e) {
  return function(t) {
    this.textContent = e.call(this, t);
  };
}
function g0e(e) {
  var t, n;
  function r() {
    var i = e.apply(this, arguments);
    return i !== n && (t = (n = i) && m0e(i)), t;
  }
  return r._value = e, r;
}
function y0e(e) {
  var t = "text";
  if (arguments.length < 1) return (t = this.tween(t)) && t._value;
  if (e == null) return this.tween(t, null);
  if (typeof e != "function") throw new Error();
  return this.tween(t, g0e(e));
}
function x0e() {
  for (var e = this._name, t = this._id, n = iq(), r = this._groups, i = r.length, s = 0; s < i; ++s)
    for (var a = r[s], u = a.length, d, f = 0; f < u; ++f)
      if (d = a[f]) {
        var h = sl(d, t);
        yw(d, e, n, f, a, {
          time: h.time + h.delay + h.duration,
          delay: 0,
          duration: h.duration,
          ease: h.ease
        });
      }
  return new tc(r, this._parents, e, n);
}
function v0e() {
  var e, t, n = this, r = n._id, i = n.size();
  return new Promise(function(s, a) {
    var u = { value: a }, d = { value: function() {
      --i === 0 && s();
    } };
    n.each(function() {
      var f = lu(this, r), h = f.on;
      h !== e && (t = (e = h).copy(), t._.cancel.push(u), t._.interrupt.push(u), t._.end.push(d)), f.on = t;
    }), i === 0 && s();
  });
}
var b0e = 0;
function tc(e, t, n, r) {
  this._groups = e, this._parents = t, this._name = n, this._id = r;
}
function iq() {
  return ++b0e;
}
var Uu = ux.prototype;
tc.prototype = {
  constructor: tc,
  select: e0e,
  selectAll: t0e,
  selectChild: Uu.selectChild,
  selectChildren: Uu.selectChildren,
  filter: Kge,
  merge: Yge,
  selection: r0e,
  transition: x0e,
  call: Uu.call,
  nodes: Uu.nodes,
  node: Uu.node,
  size: Uu.size,
  empty: Uu.empty,
  each: Uu.each,
  on: Xge,
  attr: Rge,
  attrTween: Pge,
  style: l0e,
  styleTween: d0e,
  text: p0e,
  textTween: y0e,
  remove: Jge,
  tween: Ege,
  delay: Bge,
  duration: Fge,
  ease: Hge,
  easeVarying: Gge,
  end: v0e,
  [Symbol.iterator]: Uu[Symbol.iterator]
};
function w0e(e) {
  return ((e *= 2) <= 1 ? e * e * e : (e -= 2) * e * e + 2) / 2;
}
var _0e = {
  time: null,
  // Set on use.
  delay: 0,
  duration: 250,
  ease: w0e
};
function S0e(e, t) {
  for (var n; !(n = e.__transition) || !(n = n[t]); )
    if (!(e = e.parentNode))
      throw new Error(`transition ${t} not found`);
  return n;
}
function E0e(e) {
  var t, n;
  e instanceof tc ? (t = e._id, e = e._name) : (t = iq(), (n = _0e).time = Sj(), e = e == null ? null : e + "");
  for (var r = this._groups, i = r.length, s = 0; s < i; ++s)
    for (var a = r[s], u = a.length, d, f = 0; f < u; ++f)
      (d = a[f]) && yw(d, e, t, f, a, n || S0e(d, t));
  return new tc(r, this._parents, e, t);
}
ux.prototype.interrupt = wge;
ux.prototype.transition = E0e;
const k1 = (e) => () => e;
function C0e(e, {
  sourceEvent: t,
  target: n,
  transform: r,
  dispatch: i
}) {
  Object.defineProperties(this, {
    type: { value: e, enumerable: !0, configurable: !0 },
    sourceEvent: { value: t, enumerable: !0, configurable: !0 },
    target: { value: n, enumerable: !0, configurable: !0 },
    transform: { value: r, enumerable: !0, configurable: !0 },
    _: { value: i }
  });
}
function Ku(e, t, n) {
  this.k = e, this.x = t, this.y = n;
}
Ku.prototype = {
  constructor: Ku,
  scale: function(e) {
    return e === 1 ? this : new Ku(this.k * e, this.x, this.y);
  },
  translate: function(e, t) {
    return e === 0 & t === 0 ? this : new Ku(this.k, this.x + this.k * e, this.y + this.k * t);
  },
  apply: function(e) {
    return [e[0] * this.k + this.x, e[1] * this.k + this.y];
  },
  applyX: function(e) {
    return e * this.k + this.x;
  },
  applyY: function(e) {
    return e * this.k + this.y;
  },
  invert: function(e) {
    return [(e[0] - this.x) / this.k, (e[1] - this.y) / this.k];
  },
  invertX: function(e) {
    return (e - this.x) / this.k;
  },
  invertY: function(e) {
    return (e - this.y) / this.k;
  },
  rescaleX: function(e) {
    return e.copy().domain(e.range().map(this.invertX, this).map(e.invert, e));
  },
  rescaleY: function(e) {
    return e.copy().domain(e.range().map(this.invertY, this).map(e.invert, e));
  },
  toString: function() {
    return "translate(" + this.x + "," + this.y + ") scale(" + this.k + ")";
  }
};
var xw = new Ku(1, 0, 0);
sq.prototype = Ku.prototype;
function sq(e) {
  for (; !e.__zoom; ) if (!(e = e.parentNode)) return xw;
  return e.__zoom;
}
function I_(e) {
  e.stopImmediatePropagation();
}
function Z0(e) {
  e.preventDefault(), e.stopImmediatePropagation();
}
function k0e(e) {
  return (!e.ctrlKey || e.type === "wheel") && !e.button;
}
function T0e() {
  var e = this;
  return e instanceof SVGElement ? (e = e.ownerSVGElement || e, e.hasAttribute("viewBox") ? (e = e.viewBox.baseVal, [[e.x, e.y], [e.x + e.width, e.y + e.height]]) : [[0, 0], [e.width.baseVal.value, e.height.baseVal.value]]) : [[0, 0], [e.clientWidth, e.clientHeight]];
}
function iR() {
  return this.__zoom || xw;
}
function j0e(e) {
  return -e.deltaY * (e.deltaMode === 1 ? 0.05 : e.deltaMode ? 1 : 2e-3) * (e.ctrlKey ? 10 : 1);
}
function A0e() {
  return navigator.maxTouchPoints || "ontouchstart" in this;
}
function N0e(e, t, n) {
  var r = e.invertX(t[0][0]) - n[0][0], i = e.invertX(t[1][0]) - n[1][0], s = e.invertY(t[0][1]) - n[0][1], a = e.invertY(t[1][1]) - n[1][1];
  return e.translate(
    i > r ? (r + i) / 2 : Math.min(0, r) || Math.max(0, i),
    a > s ? (s + a) / 2 : Math.min(0, s) || Math.max(0, a)
  );
}
function aq() {
  var e = k0e, t = T0e, n = N0e, r = j0e, i = A0e, s = [0, 1 / 0], a = [[-1 / 0, -1 / 0], [1 / 0, 1 / 0]], u = 250, d = Y1, f = pw("start", "zoom", "end"), h, m, x, b = 500, w = 150, S = 0, C = 10;
  function T(Z) {
    Z.property("__zoom", iR).on("wheel.zoom", Y, { passive: !1 }).on("mousedown.zoom", te).on("dblclick.zoom", V).filter(i).on("touchstart.zoom", $).on("touchmove.zoom", G).on("touchend.zoom touchcancel.zoom", le).style("-webkit-tap-highlight-color", "rgba(0,0,0,0)");
  }
  T.transform = function(Z, oe, X, ce) {
    var pe = Z.selection ? Z.selection() : Z;
    pe.property("__zoom", iR), Z !== pe ? P(Z, oe, X, ce) : pe.interrupt().each(function() {
      D(this, arguments).event(ce).start().zoom(null, typeof oe == "function" ? oe.apply(this, arguments) : oe).end();
    });
  }, T.scaleBy = function(Z, oe, X, ce) {
    T.scaleTo(Z, function() {
      var pe = this.__zoom.k, de = typeof oe == "function" ? oe.apply(this, arguments) : oe;
      return pe * de;
    }, X, ce);
  }, T.scaleTo = function(Z, oe, X, ce) {
    T.transform(Z, function() {
      var pe = t.apply(this, arguments), de = this.__zoom, H = X == null ? M(pe) : typeof X == "function" ? X.apply(this, arguments) : X, J = de.invert(H), ge = typeof oe == "function" ? oe.apply(this, arguments) : oe;
      return n(N(R(de, ge), H, J), pe, a);
    }, X, ce);
  }, T.translateBy = function(Z, oe, X, ce) {
    T.transform(Z, function() {
      return n(this.__zoom.translate(
        typeof oe == "function" ? oe.apply(this, arguments) : oe,
        typeof X == "function" ? X.apply(this, arguments) : X
      ), t.apply(this, arguments), a);
    }, null, ce);
  }, T.translateTo = function(Z, oe, X, ce, pe) {
    T.transform(Z, function() {
      var de = t.apply(this, arguments), H = this.__zoom, J = ce == null ? M(de) : typeof ce == "function" ? ce.apply(this, arguments) : ce;
      return n(xw.translate(J[0], J[1]).scale(H.k).translate(
        typeof oe == "function" ? -oe.apply(this, arguments) : -oe,
        typeof X == "function" ? -X.apply(this, arguments) : -X
      ), de, a);
    }, ce, pe);
  };
  function R(Z, oe) {
    return oe = Math.max(s[0], Math.min(s[1], oe)), oe === Z.k ? Z : new Ku(oe, Z.x, Z.y);
  }
  function N(Z, oe, X) {
    var ce = oe[0] - X[0] * Z.k, pe = oe[1] - X[1] * Z.k;
    return ce === Z.x && pe === Z.y ? Z : new Ku(Z.k, ce, pe);
  }
  function M(Z) {
    return [(+Z[0][0] + +Z[1][0]) / 2, (+Z[0][1] + +Z[1][1]) / 2];
  }
  function P(Z, oe, X, ce) {
    Z.on("start.zoom", function() {
      D(this, arguments).event(ce).start();
    }).on("interrupt.zoom end.zoom", function() {
      D(this, arguments).event(ce).end();
    }).tween("zoom", function() {
      var pe = this, de = arguments, H = D(pe, de).event(ce), J = t.apply(pe, de), ge = X == null ? M(J) : typeof X == "function" ? X.apply(pe, de) : X, Q = Math.max(J[1][0] - J[0][0], J[1][1] - J[0][1]), fe = pe.__zoom, ve = typeof oe == "function" ? oe.apply(pe, de) : oe, Se = d(fe.invert(ge).concat(Q / fe.k), ve.invert(ge).concat(Q / ve.k));
      return function(Me) {
        if (Me === 1) Me = ve;
        else {
          var Ie = Se(Me), Re = Q / Ie[2];
          Me = new Ku(Re, ge[0] - Ie[0] * Re, ge[1] - Ie[1] * Re);
        }
        H.zoom(null, Me);
      };
    });
  }
  function D(Z, oe, X) {
    return !X && Z.__zooming || new q(Z, oe);
  }
  function q(Z, oe) {
    this.that = Z, this.args = oe, this.active = 0, this.sourceEvent = null, this.extent = t.apply(Z, oe), this.taps = 0;
  }
  q.prototype = {
    event: function(Z) {
      return Z && (this.sourceEvent = Z), this;
    },
    start: function() {
      return ++this.active === 1 && (this.that.__zooming = this, this.emit("start")), this;
    },
    zoom: function(Z, oe) {
      return this.mouse && Z !== "mouse" && (this.mouse[1] = oe.invert(this.mouse[0])), this.touch0 && Z !== "touch" && (this.touch0[1] = oe.invert(this.touch0[0])), this.touch1 && Z !== "touch" && (this.touch1[1] = oe.invert(this.touch1[0])), this.that.__zoom = oe, this.emit("zoom"), this;
    },
    end: function() {
      return --this.active === 0 && (delete this.that.__zooming, this.emit("end")), this;
    },
    emit: function(Z) {
      var oe = La(this.that).datum();
      f.call(
        Z,
        this.that,
        new C0e(Z, {
          sourceEvent: this.sourceEvent,
          target: T,
          transform: this.that.__zoom,
          dispatch: f
        }),
        oe
      );
    }
  };
  function Y(Z, ...oe) {
    if (!e.apply(this, arguments)) return;
    var X = D(this, oe).event(Z), ce = this.__zoom, pe = Math.max(s[0], Math.min(s[1], ce.k * Math.pow(2, r.apply(this, arguments)))), de = Ko(Z);
    if (X.wheel)
      (X.mouse[0][0] !== de[0] || X.mouse[0][1] !== de[1]) && (X.mouse[1] = ce.invert(X.mouse[0] = de)), clearTimeout(X.wheel);
    else {
      if (ce.k === pe) return;
      X.mouse = [de, ce.invert(de)], X1(this), X.start();
    }
    Z0(Z), X.wheel = setTimeout(H, w), X.zoom("mouse", n(N(R(ce, pe), X.mouse[0], X.mouse[1]), X.extent, a));
    function H() {
      X.wheel = null, X.end();
    }
  }
  function te(Z, ...oe) {
    if (x || !e.apply(this, arguments)) return;
    var X = Z.currentTarget, ce = D(this, oe, !0).event(Z), pe = La(Z.view).on("mousemove.zoom", ge, !0).on("mouseup.zoom", Q, !0), de = Ko(Z, X), H = Z.clientX, J = Z.clientY;
    U$(Z.view), I_(Z), ce.mouse = [de, this.__zoom.invert(de)], X1(this), ce.start();
    function ge(fe) {
      if (Z0(fe), !ce.moved) {
        var ve = fe.clientX - H, Se = fe.clientY - J;
        ce.moved = ve * ve + Se * Se > S;
      }
      ce.event(fe).zoom("mouse", n(N(ce.that.__zoom, ce.mouse[0] = Ko(fe, X), ce.mouse[1]), ce.extent, a));
    }
    function Q(fe) {
      pe.on("mousemove.zoom mouseup.zoom", null), H$(fe.view, ce.moved), Z0(fe), ce.event(fe).end();
    }
  }
  function V(Z, ...oe) {
    if (e.apply(this, arguments)) {
      var X = this.__zoom, ce = Ko(Z.changedTouches ? Z.changedTouches[0] : Z, this), pe = X.invert(ce), de = X.k * (Z.shiftKey ? 0.5 : 2), H = n(N(R(X, de), ce, pe), t.apply(this, oe), a);
      Z0(Z), u > 0 ? La(this).transition().duration(u).call(P, H, ce, Z) : La(this).call(T.transform, H, ce, Z);
    }
  }
  function $(Z, ...oe) {
    if (e.apply(this, arguments)) {
      var X = Z.touches, ce = X.length, pe = D(this, oe, Z.changedTouches.length === ce).event(Z), de, H, J, ge;
      for (I_(Z), H = 0; H < ce; ++H)
        J = X[H], ge = Ko(J, this), ge = [ge, this.__zoom.invert(ge), J.identifier], pe.touch0 ? !pe.touch1 && pe.touch0[2] !== ge[2] && (pe.touch1 = ge, pe.taps = 0) : (pe.touch0 = ge, de = !0, pe.taps = 1 + !!h);
      h && (h = clearTimeout(h)), de && (pe.taps < 2 && (m = ge[0], h = setTimeout(function() {
        h = null;
      }, b)), X1(this), pe.start());
    }
  }
  function G(Z, ...oe) {
    if (this.__zooming) {
      var X = D(this, oe).event(Z), ce = Z.changedTouches, pe = ce.length, de, H, J, ge;
      for (Z0(Z), de = 0; de < pe; ++de)
        H = ce[de], J = Ko(H, this), X.touch0 && X.touch0[2] === H.identifier ? X.touch0[0] = J : X.touch1 && X.touch1[2] === H.identifier && (X.touch1[0] = J);
      if (H = X.that.__zoom, X.touch1) {
        var Q = X.touch0[0], fe = X.touch0[1], ve = X.touch1[0], Se = X.touch1[1], Me = (Me = ve[0] - Q[0]) * Me + (Me = ve[1] - Q[1]) * Me, Ie = (Ie = Se[0] - fe[0]) * Ie + (Ie = Se[1] - fe[1]) * Ie;
        H = R(H, Math.sqrt(Me / Ie)), J = [(Q[0] + ve[0]) / 2, (Q[1] + ve[1]) / 2], ge = [(fe[0] + Se[0]) / 2, (fe[1] + Se[1]) / 2];
      } else if (X.touch0) J = X.touch0[0], ge = X.touch0[1];
      else return;
      X.zoom("touch", n(N(H, J, ge), X.extent, a));
    }
  }
  function le(Z, ...oe) {
    if (this.__zooming) {
      var X = D(this, oe).event(Z), ce = Z.changedTouches, pe = ce.length, de, H;
      for (I_(Z), x && clearTimeout(x), x = setTimeout(function() {
        x = null;
      }, b), de = 0; de < pe; ++de)
        H = ce[de], X.touch0 && X.touch0[2] === H.identifier ? delete X.touch0 : X.touch1 && X.touch1[2] === H.identifier && delete X.touch1;
      if (X.touch1 && !X.touch0 && (X.touch0 = X.touch1, delete X.touch1), X.touch0) X.touch0[1] = this.__zoom.invert(X.touch0[0]);
      else if (X.end(), X.taps === 2 && (H = Ko(H, this), Math.hypot(m[0] - H[0], m[1] - H[1]) < C)) {
        var J = La(this).on("dblclick.zoom");
        J && J.apply(this, arguments);
      }
    }
  }
  return T.wheelDelta = function(Z) {
    return arguments.length ? (r = typeof Z == "function" ? Z : k1(+Z), T) : r;
  }, T.filter = function(Z) {
    return arguments.length ? (e = typeof Z == "function" ? Z : k1(!!Z), T) : e;
  }, T.touchable = function(Z) {
    return arguments.length ? (i = typeof Z == "function" ? Z : k1(!!Z), T) : i;
  }, T.extent = function(Z) {
    return arguments.length ? (t = typeof Z == "function" ? Z : k1([[+Z[0][0], +Z[0][1]], [+Z[1][0], +Z[1][1]]]), T) : t;
  }, T.scaleExtent = function(Z) {
    return arguments.length ? (s[0] = +Z[0], s[1] = +Z[1], T) : [s[0], s[1]];
  }, T.translateExtent = function(Z) {
    return arguments.length ? (a[0][0] = +Z[0][0], a[1][0] = +Z[1][0], a[0][1] = +Z[0][1], a[1][1] = +Z[1][1], T) : [[a[0][0], a[0][1]], [a[1][0], a[1][1]]];
  }, T.constrain = function(Z) {
    return arguments.length ? (n = Z, T) : n;
  }, T.duration = function(Z) {
    return arguments.length ? (u = +Z, T) : u;
  }, T.interpolate = function(Z) {
    return arguments.length ? (d = Z, T) : d;
  }, T.on = function() {
    var Z = f.on.apply(f, arguments);
    return Z === f ? T : Z;
  }, T.clickDistance = function(Z) {
    return arguments.length ? (S = (Z = +Z) * Z, T) : Math.sqrt(S);
  }, T.tapDistance = function(Z) {
    return arguments.length ? (C = +Z, T) : C;
  }, T;
}
const su = {
  error001: () => "[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",
  error002: () => "It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",
  error003: (e) => `Node type "${e}" not found. Using fallback type "default".`,
  error004: () => "The React Flow parent container needs a width and a height to render the graph.",
  error005: () => "Only child nodes can use a parent extent.",
  error006: () => "Can't create edge. An edge needs a source and a target.",
  error007: (e) => `The old edge with id=${e} does not exist.`,
  error009: (e) => `Marker type "${e}" doesn't exist.`,
  error008: (e, { id: t, sourceHandle: n, targetHandle: r }) => `Couldn't create edge for ${e} handle id: "${e === "source" ? n : r}", edge id: ${t}.`,
  error010: () => "Handle: No node id found. Make sure to only use a Handle inside a custom Node.",
  error011: (e) => `Edge type "${e}" not found. Using fallback type "default".`,
  error012: (e) => `Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,
  error013: (e = "react") => `It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,
  error014: () => "useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",
  error015: () => "It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."
}, $y = [
  [Number.NEGATIVE_INFINITY, Number.NEGATIVE_INFINITY],
  [Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY]
], oq = ["Enter", " ", "Escape"], lq = {
  "node.a11yDescription.default": "Press enter or space to select a node. Press delete to remove it and escape to cancel.",
  "node.a11yDescription.keyboardDisabled": "Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.",
  "node.a11yDescription.ariaLiveMessage": ({ direction: e, x: t, y: n }) => `Moved selected node ${e}. New position, x: ${t}, y: ${n}`,
  "edge.a11yDescription.default": "Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.",
  // Control elements
  "controls.ariaLabel": "Control Panel",
  "controls.zoomIn.ariaLabel": "Zoom In",
  "controls.zoomOut.ariaLabel": "Zoom Out",
  "controls.fitView.ariaLabel": "Fit View",
  "controls.interactive.ariaLabel": "Toggle Interactivity",
  // Mini map
  "minimap.ariaLabel": "Mini Map",
  // Handle
  "handle.ariaLabel": "Handle"
};
var Bm;
(function(e) {
  e.Strict = "strict", e.Loose = "loose";
})(Bm || (Bm = {}));
var yh;
(function(e) {
  e.Free = "free", e.Vertical = "vertical", e.Horizontal = "horizontal";
})(yh || (yh = {}));
var qy;
(function(e) {
  e.Partial = "partial", e.Full = "full";
})(qy || (qy = {}));
const uq = {
  inProgress: !1,
  isValid: null,
  from: null,
  fromHandle: null,
  fromPosition: null,
  fromNode: null,
  to: null,
  toHandle: null,
  toPosition: null,
  toNode: null,
  pointer: null
};
var gd;
(function(e) {
  e.Bezier = "default", e.Straight = "straight", e.Step = "step", e.SmoothStep = "smoothstep", e.SimpleBezier = "simplebezier";
})(gd || (gd = {}));
var Fy;
(function(e) {
  e.Arrow = "arrow", e.ArrowClosed = "arrowclosed";
})(Fy || (Fy = {}));
var wt;
(function(e) {
  e.Left = "left", e.Top = "top", e.Right = "right", e.Bottom = "bottom";
})(wt || (wt = {}));
const sR = {
  [wt.Left]: wt.Right,
  [wt.Right]: wt.Left,
  [wt.Top]: wt.Bottom,
  [wt.Bottom]: wt.Top
};
function cq(e) {
  return e === null ? null : e ? "valid" : "invalid";
}
const dq = (e) => "id" in e && "source" in e && "target" in e, R0e = (e) => "id" in e && "position" in e && !("source" in e) && !("target" in e), kj = (e) => "id" in e && "internals" in e && !("source" in e) && !("target" in e), dx = (e, t = [0, 0]) => {
  const { width: n, height: r } = sc(e), i = e.origin ?? t, s = n * i[0], a = r * i[1];
  return {
    x: e.position.x - s,
    y: e.position.y - a
  };
}, M0e = (e, t = { nodeOrigin: [0, 0] }) => {
  if (e.length === 0)
    return { x: 0, y: 0, width: 0, height: 0 };
  const n = e.reduce((r, i) => {
    const s = typeof i == "string";
    let a = !t.nodeLookup && !s ? i : void 0;
    t.nodeLookup && (a = s ? t.nodeLookup.get(i) : kj(i) ? i : t.nodeLookup.get(i.id));
    const u = a ? zb(a, t.nodeOrigin) : { x: 0, y: 0, x2: 0, y2: 0 };
    return vw(r, u);
  }, { x: 1 / 0, y: 1 / 0, x2: -1 / 0, y2: -1 / 0 });
  return bw(n);
}, fx = (e, t = {}) => {
  let n = { x: 1 / 0, y: 1 / 0, x2: -1 / 0, y2: -1 / 0 }, r = !1;
  return e.forEach((i) => {
    (t.filter === void 0 || t.filter(i)) && (n = vw(n, zb(i)), r = !0);
  }), r ? bw(n) : { x: 0, y: 0, width: 0, height: 0 };
}, Tj = (e, t, [n, r, i] = [0, 0, 1], s = !1, a = !1) => {
  const u = {
    ...px(t, [n, r, i]),
    width: t.width / i,
    height: t.height / i
  }, d = [];
  for (const f of e.values()) {
    const { measured: h, selectable: m = !0, hidden: x = !1 } = f;
    if (a && !m || x)
      continue;
    const b = h.width ?? f.width ?? f.initialWidth ?? null, w = h.height ?? f.height ?? f.initialHeight ?? null, S = Uy(u, qm(f)), C = (b ?? 0) * (w ?? 0), T = s && S > 0;
    (!f.internals.handleBounds || T || S >= C || f.dragging) && d.push(f);
  }
  return d;
}, O0e = (e, t) => {
  const n = /* @__PURE__ */ new Set();
  return e.forEach((r) => {
    n.add(r.id);
  }), t.filter((r) => n.has(r.source) || n.has(r.target));
};
function D0e(e, t) {
  const n = /* @__PURE__ */ new Map(), r = t != null && t.nodes ? new Set(t.nodes.map((i) => i.id)) : null;
  return e.forEach((i) => {
    i.measured.width && i.measured.height && ((t == null ? void 0 : t.includeHiddenNodes) || !i.hidden) && (!r || r.has(i.id)) && n.set(i.id, i);
  }), n;
}
async function z0e({ nodes: e, width: t, height: n, panZoom: r, minZoom: i, maxZoom: s }, a) {
  if (e.size === 0)
    return Promise.resolve(!0);
  const u = D0e(e, a), d = fx(u), f = jj(d, t, n, (a == null ? void 0 : a.minZoom) ?? i, (a == null ? void 0 : a.maxZoom) ?? s, (a == null ? void 0 : a.padding) ?? 0.1);
  return await r.setViewport(f, {
    duration: a == null ? void 0 : a.duration,
    ease: a == null ? void 0 : a.ease,
    interpolate: a == null ? void 0 : a.interpolate
  }), Promise.resolve(!0);
}
function fq({ nodeId: e, nextPosition: t, nodeLookup: n, nodeOrigin: r = [0, 0], nodeExtent: i, onError: s }) {
  const a = n.get(e), u = a.parentId ? n.get(a.parentId) : void 0, { x: d, y: f } = u ? u.internals.positionAbsolute : { x: 0, y: 0 }, h = a.origin ?? r;
  let m = a.extent || i;
  if (a.extent === "parent" && !a.expandParent)
    if (!u)
      s == null || s("005", su.error005());
    else {
      const b = u.measured.width, w = u.measured.height;
      b && w && (m = [
        [d, f],
        [d + b, f + w]
      ]);
    }
  else u && Fm(a.extent) && (m = [
    [a.extent[0][0] + d, a.extent[0][1] + f],
    [a.extent[1][0] + d, a.extent[1][1] + f]
  ]);
  const x = Fm(m) ? Eh(t, m, a.measured) : t;
  return (a.measured.width === void 0 || a.measured.height === void 0) && (s == null || s("015", su.error015())), {
    position: {
      x: x.x - d + (a.measured.width ?? 0) * h[0],
      y: x.y - f + (a.measured.height ?? 0) * h[1]
    },
    positionAbsolute: x
  };
}
async function P0e({ nodesToRemove: e = [], edgesToRemove: t = [], nodes: n, edges: r, onBeforeDelete: i }) {
  const s = new Set(e.map((x) => x.id)), a = [];
  for (const x of n) {
    if (x.deletable === !1)
      continue;
    const b = s.has(x.id), w = !b && x.parentId && a.find((S) => S.id === x.parentId);
    (b || w) && a.push(x);
  }
  const u = new Set(t.map((x) => x.id)), d = r.filter((x) => x.deletable !== !1), h = O0e(a, d);
  for (const x of d)
    u.has(x.id) && !h.find((w) => w.id === x.id) && h.push(x);
  if (!i)
    return {
      edges: h,
      nodes: a
    };
  const m = await i({
    nodes: a,
    edges: h
  });
  return typeof m == "boolean" ? m ? { edges: h, nodes: a } : { edges: [], nodes: [] } : m;
}
const $m = (e, t = 0, n = 1) => Math.min(Math.max(e, t), n), Eh = (e = { x: 0, y: 0 }, t, n) => ({
  x: $m(e.x, t[0][0], t[1][0] - ((n == null ? void 0 : n.width) ?? 0)),
  y: $m(e.y, t[0][1], t[1][1] - ((n == null ? void 0 : n.height) ?? 0))
});
function hq(e, t, n) {
  const { width: r, height: i } = sc(n), { x: s, y: a } = n.internals.positionAbsolute;
  return Eh(e, [
    [s, a],
    [s + r, a + i]
  ], t);
}
const aR = (e, t, n) => e < t ? $m(Math.abs(e - t), 1, t) / t : e > n ? -$m(Math.abs(e - n), 1, t) / t : 0, pq = (e, t, n = 15, r = 40) => {
  const i = aR(e.x, r, t.width - r) * n, s = aR(e.y, r, t.height - r) * n;
  return [i, s];
}, vw = (e, t) => ({
  x: Math.min(e.x, t.x),
  y: Math.min(e.y, t.y),
  x2: Math.max(e.x2, t.x2),
  y2: Math.max(e.y2, t.y2)
}), P5 = ({ x: e, y: t, width: n, height: r }) => ({
  x: e,
  y: t,
  x2: e + n,
  y2: t + r
}), bw = ({ x: e, y: t, x2: n, y2: r }) => ({
  x: e,
  y: t,
  width: n - e,
  height: r - t
}), qm = (e, t = [0, 0]) => {
  var i, s;
  const { x: n, y: r } = kj(e) ? e.internals.positionAbsolute : dx(e, t);
  return {
    x: n,
    y: r,
    width: ((i = e.measured) == null ? void 0 : i.width) ?? e.width ?? e.initialWidth ?? 0,
    height: ((s = e.measured) == null ? void 0 : s.height) ?? e.height ?? e.initialHeight ?? 0
  };
}, zb = (e, t = [0, 0]) => {
  var i, s;
  const { x: n, y: r } = kj(e) ? e.internals.positionAbsolute : dx(e, t);
  return {
    x: n,
    y: r,
    x2: n + (((i = e.measured) == null ? void 0 : i.width) ?? e.width ?? e.initialWidth ?? 0),
    y2: r + (((s = e.measured) == null ? void 0 : s.height) ?? e.height ?? e.initialHeight ?? 0)
  };
}, mq = (e, t) => bw(vw(P5(e), P5(t))), Uy = (e, t) => {
  const n = Math.max(0, Math.min(e.x + e.width, t.x + t.width) - Math.max(e.x, t.x)), r = Math.max(0, Math.min(e.y + e.height, t.y + t.height) - Math.max(e.y, t.y));
  return Math.ceil(n * r);
}, oR = (e) => tl(e.width) && tl(e.height) && tl(e.x) && tl(e.y), tl = (e) => !isNaN(e) && isFinite(e), I0e = (e, t) => {
}, hx = (e, t = [1, 1]) => ({
  x: t[0] * Math.round(e.x / t[0]),
  y: t[1] * Math.round(e.y / t[1])
}), px = ({ x: e, y: t }, [n, r, i], s = !1, a = [1, 1]) => {
  const u = {
    x: (e - n) / i,
    y: (t - r) / i
  };
  return s ? hx(u, a) : u;
}, Pb = ({ x: e, y: t }, [n, r, i]) => ({
  x: e * i + n,
  y: t * i + r
});
function Qp(e, t) {
  if (typeof e == "number")
    return Math.floor((t - t / (1 + e)) * 0.5);
  if (typeof e == "string" && e.endsWith("px")) {
    const n = parseFloat(e);
    if (!Number.isNaN(n))
      return Math.floor(n);
  }
  if (typeof e == "string" && e.endsWith("%")) {
    const n = parseFloat(e);
    if (!Number.isNaN(n))
      return Math.floor(t * n * 0.01);
  }
  return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`), 0;
}
function L0e(e, t, n) {
  if (typeof e == "string" || typeof e == "number") {
    const r = Qp(e, n), i = Qp(e, t);
    return {
      top: r,
      right: i,
      bottom: r,
      left: i,
      x: i * 2,
      y: r * 2
    };
  }
  if (typeof e == "object") {
    const r = Qp(e.top ?? e.y ?? 0, n), i = Qp(e.bottom ?? e.y ?? 0, n), s = Qp(e.left ?? e.x ?? 0, t), a = Qp(e.right ?? e.x ?? 0, t);
    return { top: r, right: a, bottom: i, left: s, x: s + a, y: r + i };
  }
  return { top: 0, right: 0, bottom: 0, left: 0, x: 0, y: 0 };
}
function B0e(e, t, n, r, i, s) {
  const { x: a, y: u } = Pb(e, [t, n, r]), { x: d, y: f } = Pb({ x: e.x + e.width, y: e.y + e.height }, [t, n, r]), h = i - d, m = s - f;
  return {
    left: Math.floor(a),
    top: Math.floor(u),
    right: Math.floor(h),
    bottom: Math.floor(m)
  };
}
const jj = (e, t, n, r, i, s) => {
  const a = L0e(s, t, n), u = (t - a.x) / e.width, d = (n - a.y) / e.height, f = Math.min(u, d), h = $m(f, r, i), m = e.x + e.width / 2, x = e.y + e.height / 2, b = t / 2 - m * h, w = n / 2 - x * h, S = B0e(e, b, w, h, t, n), C = {
    left: Math.min(S.left - a.left, 0),
    top: Math.min(S.top - a.top, 0),
    right: Math.min(S.right - a.right, 0),
    bottom: Math.min(S.bottom - a.bottom, 0)
  };
  return {
    x: b - C.left + C.right,
    y: w - C.top + C.bottom,
    zoom: h
  };
}, Hy = () => {
  var e;
  return typeof navigator < "u" && ((e = navigator == null ? void 0 : navigator.userAgent) == null ? void 0 : e.indexOf("Mac")) >= 0;
};
function Fm(e) {
  return e != null && e !== "parent";
}
function sc(e) {
  var t, n;
  return {
    width: ((t = e.measured) == null ? void 0 : t.width) ?? e.width ?? e.initialWidth ?? 0,
    height: ((n = e.measured) == null ? void 0 : n.height) ?? e.height ?? e.initialHeight ?? 0
  };
}
function gq(e) {
  var t, n;
  return (((t = e.measured) == null ? void 0 : t.width) ?? e.width ?? e.initialWidth) !== void 0 && (((n = e.measured) == null ? void 0 : n.height) ?? e.height ?? e.initialHeight) !== void 0;
}
function yq(e, t = { width: 0, height: 0 }, n, r, i) {
  const s = { ...e }, a = r.get(n);
  if (a) {
    const u = a.origin || i;
    s.x += a.internals.positionAbsolute.x - (t.width ?? 0) * u[0], s.y += a.internals.positionAbsolute.y - (t.height ?? 0) * u[1];
  }
  return s;
}
function lR(e, t) {
  if (e.size !== t.size)
    return !1;
  for (const n of e)
    if (!t.has(n))
      return !1;
  return !0;
}
function $0e() {
  let e, t;
  return { promise: new Promise((r, i) => {
    e = r, t = i;
  }), resolve: e, reject: t };
}
function q0e(e) {
  return { ...lq, ...e || {} };
}
function vy(e, { snapGrid: t = [0, 0], snapToGrid: n = !1, transform: r, containerBounds: i }) {
  const { x: s, y: a } = nl(e), u = px({ x: s - ((i == null ? void 0 : i.left) ?? 0), y: a - ((i == null ? void 0 : i.top) ?? 0) }, r), { x: d, y: f } = n ? hx(u, t) : u;
  return {
    xSnapped: d,
    ySnapped: f,
    ...u
  };
}
const Aj = (e) => ({
  width: e.offsetWidth,
  height: e.offsetHeight
}), xq = (e) => {
  var t;
  return ((t = e == null ? void 0 : e.getRootNode) == null ? void 0 : t.call(e)) || (window == null ? void 0 : window.document);
}, F0e = ["INPUT", "SELECT", "TEXTAREA"];
function vq(e) {
  var r, i;
  const t = ((i = (r = e.composedPath) == null ? void 0 : r.call(e)) == null ? void 0 : i[0]) || e.target;
  return (t == null ? void 0 : t.nodeType) !== 1 ? !1 : F0e.includes(t.nodeName) || t.hasAttribute("contenteditable") || !!t.closest(".nokey");
}
const bq = (e) => "clientX" in e, nl = (e, t) => {
  var s, a;
  const n = bq(e), r = n ? e.clientX : (s = e.touches) == null ? void 0 : s[0].clientX, i = n ? e.clientY : (a = e.touches) == null ? void 0 : a[0].clientY;
  return {
    x: r - ((t == null ? void 0 : t.left) ?? 0),
    y: i - ((t == null ? void 0 : t.top) ?? 0)
  };
}, uR = (e, t, n, r, i) => {
  const s = t.querySelectorAll(`.${e}`);
  return !s || !s.length ? null : Array.from(s).map((a) => {
    const u = a.getBoundingClientRect();
    return {
      id: a.getAttribute("data-handleid"),
      type: e,
      nodeId: i,
      position: a.getAttribute("data-handlepos"),
      x: (u.left - n.left) / r,
      y: (u.top - n.top) / r,
      ...Aj(a)
    };
  });
};
function wq({ sourceX: e, sourceY: t, targetX: n, targetY: r, sourceControlX: i, sourceControlY: s, targetControlX: a, targetControlY: u }) {
  const d = e * 0.125 + i * 0.375 + a * 0.375 + n * 0.125, f = t * 0.125 + s * 0.375 + u * 0.375 + r * 0.125, h = Math.abs(d - e), m = Math.abs(f - t);
  return [d, f, h, m];
}
function T1(e, t) {
  return e >= 0 ? 0.5 * e : t * 25 * Math.sqrt(-e);
}
function cR({ pos: e, x1: t, y1: n, x2: r, y2: i, c: s }) {
  switch (e) {
    case wt.Left:
      return [t - T1(t - r, s), n];
    case wt.Right:
      return [t + T1(r - t, s), n];
    case wt.Top:
      return [t, n - T1(n - i, s)];
    case wt.Bottom:
      return [t, n + T1(i - n, s)];
  }
}
function _q({ sourceX: e, sourceY: t, sourcePosition: n = wt.Bottom, targetX: r, targetY: i, targetPosition: s = wt.Top, curvature: a = 0.25 }) {
  const [u, d] = cR({
    pos: n,
    x1: e,
    y1: t,
    x2: r,
    y2: i,
    c: a
  }), [f, h] = cR({
    pos: s,
    x1: r,
    y1: i,
    x2: e,
    y2: t,
    c: a
  }), [m, x, b, w] = wq({
    sourceX: e,
    sourceY: t,
    targetX: r,
    targetY: i,
    sourceControlX: u,
    sourceControlY: d,
    targetControlX: f,
    targetControlY: h
  });
  return [
    `M${e},${t} C${u},${d} ${f},${h} ${r},${i}`,
    m,
    x,
    b,
    w
  ];
}
function Sq({ sourceX: e, sourceY: t, targetX: n, targetY: r }) {
  const i = Math.abs(n - e) / 2, s = n < e ? n + i : n - i, a = Math.abs(r - t) / 2, u = r < t ? r + a : r - a;
  return [s, u, i, a];
}
function U0e({ sourceNode: e, targetNode: t, selected: n = !1, zIndex: r = 0, elevateOnSelect: i = !1, zIndexMode: s = "basic" }) {
  if (s === "manual")
    return r;
  const a = i && n ? r + 1e3 : r, u = Math.max(e.parentId || i && e.selected ? e.internals.z : 0, t.parentId || i && t.selected ? t.internals.z : 0);
  return a + u;
}
function H0e({ sourceNode: e, targetNode: t, width: n, height: r, transform: i }) {
  const s = vw(zb(e), zb(t));
  s.x === s.x2 && (s.x2 += 1), s.y === s.y2 && (s.y2 += 1);
  const a = {
    x: -i[0] / i[2],
    y: -i[1] / i[2],
    width: n / i[2],
    height: r / i[2]
  };
  return Uy(a, bw(s)) > 0;
}
const V0e = ({ source: e, sourceHandle: t, target: n, targetHandle: r }) => `xy-edge__${e}${t || ""}-${n}${r || ""}`, G0e = (e, t) => t.some((n) => n.source === e.source && n.target === e.target && (n.sourceHandle === e.sourceHandle || !n.sourceHandle && !e.sourceHandle) && (n.targetHandle === e.targetHandle || !n.targetHandle && !e.targetHandle)), K0e = (e, t, n = {}) => {
  if (!e.source || !e.target)
    return t;
  const r = n.getEdgeId || V0e;
  let i;
  return dq(e) ? i = { ...e } : i = {
    ...e,
    id: r(e)
  }, G0e(i, t) ? t : (i.sourceHandle === null && delete i.sourceHandle, i.targetHandle === null && delete i.targetHandle, t.concat(i));
};
function Eq({ sourceX: e, sourceY: t, targetX: n, targetY: r }) {
  const [i, s, a, u] = Sq({
    sourceX: e,
    sourceY: t,
    targetX: n,
    targetY: r
  });
  return [`M ${e},${t}L ${n},${r}`, i, s, a, u];
}
const dR = {
  [wt.Left]: { x: -1, y: 0 },
  [wt.Right]: { x: 1, y: 0 },
  [wt.Top]: { x: 0, y: -1 },
  [wt.Bottom]: { x: 0, y: 1 }
}, Y0e = ({ source: e, sourcePosition: t = wt.Bottom, target: n }) => t === wt.Left || t === wt.Right ? e.x < n.x ? { x: 1, y: 0 } : { x: -1, y: 0 } : e.y < n.y ? { x: 0, y: 1 } : { x: 0, y: -1 }, fR = (e, t) => Math.sqrt(Math.pow(t.x - e.x, 2) + Math.pow(t.y - e.y, 2));
function W0e({ source: e, sourcePosition: t = wt.Bottom, target: n, targetPosition: r = wt.Top, center: i, offset: s, stepPosition: a }) {
  const u = dR[t], d = dR[r], f = { x: e.x + u.x * s, y: e.y + u.y * s }, h = { x: n.x + d.x * s, y: n.y + d.y * s }, m = Y0e({
    source: f,
    sourcePosition: t,
    target: h
  }), x = m.x !== 0 ? "x" : "y", b = m[x];
  let w = [], S, C;
  const T = { x: 0, y: 0 }, R = { x: 0, y: 0 }, [, , N, M] = Sq({
    sourceX: e.x,
    sourceY: e.y,
    targetX: n.x,
    targetY: n.y
  });
  if (u[x] * d[x] === -1) {
    x === "x" ? (S = i.x ?? f.x + (h.x - f.x) * a, C = i.y ?? (f.y + h.y) / 2) : (S = i.x ?? (f.x + h.x) / 2, C = i.y ?? f.y + (h.y - f.y) * a);
    const D = [
      { x: S, y: f.y },
      { x: S, y: h.y }
    ], q = [
      { x: f.x, y: C },
      { x: h.x, y: C }
    ];
    u[x] === b ? w = x === "x" ? D : q : w = x === "x" ? q : D;
  } else {
    const D = [{ x: f.x, y: h.y }], q = [{ x: h.x, y: f.y }];
    if (x === "x" ? w = u.x === b ? q : D : w = u.y === b ? D : q, t === r) {
      const G = Math.abs(e[x] - n[x]);
      if (G <= s) {
        const le = Math.min(s - 1, s - G);
        u[x] === b ? T[x] = (f[x] > e[x] ? -1 : 1) * le : R[x] = (h[x] > n[x] ? -1 : 1) * le;
      }
    }
    if (t !== r) {
      const G = x === "x" ? "y" : "x", le = u[x] === d[G], Z = f[G] > h[G], oe = f[G] < h[G];
      (u[x] === 1 && (!le && Z || le && oe) || u[x] !== 1 && (!le && oe || le && Z)) && (w = x === "x" ? D : q);
    }
    const Y = { x: f.x + T.x, y: f.y + T.y }, te = { x: h.x + R.x, y: h.y + R.y }, V = Math.max(Math.abs(Y.x - w[0].x), Math.abs(te.x - w[0].x)), $ = Math.max(Math.abs(Y.y - w[0].y), Math.abs(te.y - w[0].y));
    V >= $ ? (S = (Y.x + te.x) / 2, C = w[0].y) : (S = w[0].x, C = (Y.y + te.y) / 2);
  }
  return [[
    e,
    { x: f.x + T.x, y: f.y + T.y },
    ...w,
    { x: h.x + R.x, y: h.y + R.y },
    n
  ], S, C, N, M];
}
function Z0e(e, t, n, r) {
  const i = Math.min(fR(e, t) / 2, fR(t, n) / 2, r), { x: s, y: a } = t;
  if (e.x === s && s === n.x || e.y === a && a === n.y)
    return `L${s} ${a}`;
  if (e.y === a) {
    const f = e.x < n.x ? -1 : 1, h = e.y < n.y ? 1 : -1;
    return `L ${s + i * f},${a}Q ${s},${a} ${s},${a + i * h}`;
  }
  const u = e.x < n.x ? 1 : -1, d = e.y < n.y ? -1 : 1;
  return `L ${s},${a + i * d}Q ${s},${a} ${s + i * u},${a}`;
}
function I5({ sourceX: e, sourceY: t, sourcePosition: n = wt.Bottom, targetX: r, targetY: i, targetPosition: s = wt.Top, borderRadius: a = 5, centerX: u, centerY: d, offset: f = 20, stepPosition: h = 0.5 }) {
  const [m, x, b, w, S] = W0e({
    source: { x: e, y: t },
    sourcePosition: n,
    target: { x: r, y: i },
    targetPosition: s,
    center: { x: u, y: d },
    offset: f,
    stepPosition: h
  });
  return [m.reduce((T, R, N) => {
    let M = "";
    return N > 0 && N < m.length - 1 ? M = Z0e(m[N - 1], R, m[N + 1], a) : M = `${N === 0 ? "M" : "L"}${R.x} ${R.y}`, T += M, T;
  }, ""), x, b, w, S];
}
function hR(e) {
  var t;
  return e && !!(e.internals.handleBounds || (t = e.handles) != null && t.length) && !!(e.measured.width || e.width || e.initialWidth);
}
function X0e(e) {
  var m;
  const { sourceNode: t, targetNode: n } = e;
  if (!hR(t) || !hR(n))
    return null;
  const r = t.internals.handleBounds || pR(t.handles), i = n.internals.handleBounds || pR(n.handles), s = mR((r == null ? void 0 : r.source) ?? [], e.sourceHandle), a = mR(
    // when connection type is loose we can define all handles as sources and connect source -> source
    e.connectionMode === Bm.Strict ? (i == null ? void 0 : i.target) ?? [] : ((i == null ? void 0 : i.target) ?? []).concat((i == null ? void 0 : i.source) ?? []),
    e.targetHandle
  );
  if (!s || !a)
    return (m = e.onError) == null || m.call(e, "008", su.error008(s ? "target" : "source", {
      id: e.id,
      sourceHandle: e.sourceHandle,
      targetHandle: e.targetHandle
    })), null;
  const u = (s == null ? void 0 : s.position) || wt.Bottom, d = (a == null ? void 0 : a.position) || wt.Top, f = Ch(t, s, u), h = Ch(n, a, d);
  return {
    sourceX: f.x,
    sourceY: f.y,
    targetX: h.x,
    targetY: h.y,
    sourcePosition: u,
    targetPosition: d
  };
}
function pR(e) {
  if (!e)
    return null;
  const t = [], n = [];
  for (const r of e)
    r.width = r.width ?? 1, r.height = r.height ?? 1, r.type === "source" ? t.push(r) : r.type === "target" && n.push(r);
  return {
    source: t,
    target: n
  };
}
function Ch(e, t, n = wt.Left, r = !1) {
  const i = ((t == null ? void 0 : t.x) ?? 0) + e.internals.positionAbsolute.x, s = ((t == null ? void 0 : t.y) ?? 0) + e.internals.positionAbsolute.y, { width: a, height: u } = t ?? sc(e);
  if (r)
    return { x: i + a / 2, y: s + u / 2 };
  switch ((t == null ? void 0 : t.position) ?? n) {
    case wt.Top:
      return { x: i + a / 2, y: s };
    case wt.Right:
      return { x: i + a, y: s + u / 2 };
    case wt.Bottom:
      return { x: i + a / 2, y: s + u };
    case wt.Left:
      return { x: i, y: s + u / 2 };
  }
}
function mR(e, t) {
  return e && (t ? e.find((n) => n.id === t) : e[0]) || null;
}
function L5(e, t) {
  return e ? typeof e == "string" ? e : `${t ? `${t}__` : ""}${Object.keys(e).sort().map((r) => `${r}=${e[r]}`).join("&")}` : "";
}
function Q0e(e, { id: t, defaultColor: n, defaultMarkerStart: r, defaultMarkerEnd: i }) {
  const s = /* @__PURE__ */ new Set();
  return e.reduce((a, u) => ([u.markerStart || r, u.markerEnd || i].forEach((d) => {
    if (d && typeof d == "object") {
      const f = L5(d, t);
      s.has(f) || (a.push({ id: f, color: d.color || n, ...d }), s.add(f));
    }
  }), a), []).sort((a, u) => a.id.localeCompare(u.id));
}
const Cq = 1e3, J0e = 10, Nj = {
  nodeOrigin: [0, 0],
  nodeExtent: $y,
  elevateNodesOnSelect: !0,
  zIndexMode: "basic",
  defaults: {}
}, eye = {
  ...Nj,
  checkEquality: !0
};
function Rj(e, t) {
  const n = { ...e };
  for (const r in t)
    t[r] !== void 0 && (n[r] = t[r]);
  return n;
}
function tye(e, t, n) {
  const r = Rj(Nj, n);
  for (const i of e.values())
    if (i.parentId)
      Oj(i, e, t, r);
    else {
      const s = dx(i, r.nodeOrigin), a = Fm(i.extent) ? i.extent : r.nodeExtent, u = Eh(s, a, sc(i));
      i.internals.positionAbsolute = u;
    }
}
function nye(e, t) {
  if (!e.handles)
    return e.measured ? t == null ? void 0 : t.internals.handleBounds : void 0;
  const n = [], r = [];
  for (const i of e.handles) {
    const s = {
      id: i.id,
      width: i.width ?? 1,
      height: i.height ?? 1,
      nodeId: e.id,
      x: i.x,
      y: i.y,
      position: i.position,
      type: i.type
    };
    i.type === "source" ? n.push(s) : i.type === "target" && r.push(s);
  }
  return {
    source: n,
    target: r
  };
}
function Mj(e) {
  return e === "manual";
}
function B5(e, t, n, r = {}) {
  var f, h;
  const i = Rj(eye, r), s = { i: 0 }, a = new Map(t), u = i != null && i.elevateNodesOnSelect && !Mj(i.zIndexMode) ? Cq : 0;
  let d = e.length > 0;
  t.clear(), n.clear();
  for (const m of e) {
    let x = a.get(m.id);
    if (i.checkEquality && m === (x == null ? void 0 : x.internals.userNode))
      t.set(m.id, x);
    else {
      const b = dx(m, i.nodeOrigin), w = Fm(m.extent) ? m.extent : i.nodeExtent, S = Eh(b, w, sc(m));
      x = {
        ...i.defaults,
        ...m,
        measured: {
          width: (f = m.measured) == null ? void 0 : f.width,
          height: (h = m.measured) == null ? void 0 : h.height
        },
        internals: {
          positionAbsolute: S,
          // if user re-initializes the node or removes `measured` for whatever reason, we reset the handleBounds so that the node gets re-measured
          handleBounds: nye(m, x),
          z: kq(m, u, i.zIndexMode),
          userNode: m
        }
      }, t.set(m.id, x);
    }
    (x.measured === void 0 || x.measured.width === void 0 || x.measured.height === void 0) && !x.hidden && (d = !1), m.parentId && Oj(x, t, n, r, s);
  }
  return d;
}
function rye(e, t) {
  if (!e.parentId)
    return;
  const n = t.get(e.parentId);
  n ? n.set(e.id, e) : t.set(e.parentId, /* @__PURE__ */ new Map([[e.id, e]]));
}
function Oj(e, t, n, r, i) {
  const { elevateNodesOnSelect: s, nodeOrigin: a, nodeExtent: u, zIndexMode: d } = Rj(Nj, r), f = e.parentId, h = t.get(f);
  if (!h) {
    console.warn(`Parent node ${f} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);
    return;
  }
  rye(e, n), i && !h.parentId && h.internals.rootParentIndex === void 0 && d === "auto" && (h.internals.rootParentIndex = ++i.i, h.internals.z = h.internals.z + i.i * J0e), i && h.internals.rootParentIndex !== void 0 && (i.i = h.internals.rootParentIndex);
  const m = s && !Mj(d) ? Cq : 0, { x, y: b, z: w } = iye(e, h, a, u, m, d), { positionAbsolute: S } = e.internals, C = x !== S.x || b !== S.y;
  (C || w !== e.internals.z) && t.set(e.id, {
    ...e,
    internals: {
      ...e.internals,
      positionAbsolute: C ? { x, y: b } : S,
      z: w
    }
  });
}
function kq(e, t, n) {
  const r = tl(e.zIndex) ? e.zIndex : 0;
  return Mj(n) ? r : r + (e.selected ? t : 0);
}
function iye(e, t, n, r, i, s) {
  const { x: a, y: u } = t.internals.positionAbsolute, d = sc(e), f = dx(e, n), h = Fm(e.extent) ? Eh(f, e.extent, d) : f;
  let m = Eh({ x: a + h.x, y: u + h.y }, r, d);
  e.extent === "parent" && (m = hq(m, d, t));
  const x = kq(e, i, s), b = t.internals.z ?? 0;
  return {
    x: m.x,
    y: m.y,
    z: b >= x ? b + 1 : x
  };
}
function Dj(e, t, n, r = [0, 0]) {
  var a;
  const i = [], s = /* @__PURE__ */ new Map();
  for (const u of e) {
    const d = t.get(u.parentId);
    if (!d)
      continue;
    const f = ((a = s.get(u.parentId)) == null ? void 0 : a.expandedRect) ?? qm(d), h = mq(f, u.rect);
    s.set(u.parentId, { expandedRect: h, parent: d });
  }
  return s.size > 0 && s.forEach(({ expandedRect: u, parent: d }, f) => {
    var N;
    const h = d.internals.positionAbsolute, m = sc(d), x = d.origin ?? r, b = u.x < h.x ? Math.round(Math.abs(h.x - u.x)) : 0, w = u.y < h.y ? Math.round(Math.abs(h.y - u.y)) : 0, S = Math.max(m.width, Math.round(u.width)), C = Math.max(m.height, Math.round(u.height)), T = (S - m.width) * x[0], R = (C - m.height) * x[1];
    (b > 0 || w > 0 || T || R) && (i.push({
      id: f,
      type: "position",
      position: {
        x: d.position.x - b + T,
        y: d.position.y - w + R
      }
    }), (N = n.get(f)) == null || N.forEach((M) => {
      e.some((P) => P.id === M.id) || i.push({
        id: M.id,
        type: "position",
        position: {
          x: M.position.x + b,
          y: M.position.y + w
        }
      });
    })), (m.width < u.width || m.height < u.height || b || w) && i.push({
      id: f,
      type: "dimensions",
      setAttributes: !0,
      dimensions: {
        width: S + (b ? x[0] * b - T : 0),
        height: C + (w ? x[1] * w - R : 0)
      }
    });
  }), i;
}
function sye(e, t, n, r, i, s, a) {
  const u = r == null ? void 0 : r.querySelector(".xyflow__viewport");
  let d = !1;
  if (!u)
    return { changes: [], updatedInternals: d };
  const f = [], h = window.getComputedStyle(u), { m22: m } = new window.DOMMatrixReadOnly(h.transform), x = [];
  for (const b of e.values()) {
    const w = t.get(b.id);
    if (!w)
      continue;
    if (w.hidden) {
      t.set(w.id, {
        ...w,
        internals: {
          ...w.internals,
          handleBounds: void 0
        }
      }), d = !0;
      continue;
    }
    const S = Aj(b.nodeElement), C = w.measured.width !== S.width || w.measured.height !== S.height;
    if (!!(S.width && S.height && (C || !w.internals.handleBounds || b.force))) {
      const R = b.nodeElement.getBoundingClientRect(), N = Fm(w.extent) ? w.extent : s;
      let { positionAbsolute: M } = w.internals;
      w.parentId && w.extent === "parent" ? M = hq(M, S, t.get(w.parentId)) : N && (M = Eh(M, N, S));
      const P = {
        ...w,
        measured: S,
        internals: {
          ...w.internals,
          positionAbsolute: M,
          handleBounds: {
            source: uR("source", b.nodeElement, R, m, w.id),
            target: uR("target", b.nodeElement, R, m, w.id)
          }
        }
      };
      t.set(w.id, P), w.parentId && Oj(P, t, n, { nodeOrigin: i, zIndexMode: a }), d = !0, C && (f.push({
        id: w.id,
        type: "dimensions",
        dimensions: S
      }), w.expandParent && w.parentId && x.push({
        id: w.id,
        parentId: w.parentId,
        rect: qm(P, i)
      }));
    }
  }
  if (x.length > 0) {
    const b = Dj(x, t, n, i);
    f.push(...b);
  }
  return { changes: f, updatedInternals: d };
}
async function aye({ delta: e, panZoom: t, transform: n, translateExtent: r, width: i, height: s }) {
  if (!t || !e.x && !e.y)
    return Promise.resolve(!1);
  const a = await t.setViewportConstrained({
    x: n[0] + e.x,
    y: n[1] + e.y,
    zoom: n[2]
  }, [
    [0, 0],
    [i, s]
  ], r), u = !!a && (a.x !== n[0] || a.y !== n[1] || a.k !== n[2]);
  return Promise.resolve(u);
}
function gR(e, t, n, r, i, s) {
  let a = i;
  const u = r.get(a) || /* @__PURE__ */ new Map();
  r.set(a, u.set(n, t)), a = `${i}-${e}`;
  const d = r.get(a) || /* @__PURE__ */ new Map();
  if (r.set(a, d.set(n, t)), s) {
    a = `${i}-${e}-${s}`;
    const f = r.get(a) || /* @__PURE__ */ new Map();
    r.set(a, f.set(n, t));
  }
}
function Tq(e, t, n) {
  e.clear(), t.clear();
  for (const r of n) {
    const { source: i, target: s, sourceHandle: a = null, targetHandle: u = null } = r, d = { edgeId: r.id, source: i, target: s, sourceHandle: a, targetHandle: u }, f = `${i}-${a}--${s}-${u}`, h = `${s}-${u}--${i}-${a}`;
    gR("source", d, h, e, i, a), gR("target", d, f, e, s, u), t.set(r.id, r);
  }
}
function jq(e, t) {
  if (!e.parentId)
    return !1;
  const n = t.get(e.parentId);
  return n ? n.selected ? !0 : jq(n, t) : !1;
}
function yR(e, t, n) {
  var i;
  let r = e;
  do {
    if ((i = r == null ? void 0 : r.matches) != null && i.call(r, t))
      return !0;
    if (r === n)
      return !1;
    r = r == null ? void 0 : r.parentElement;
  } while (r);
  return !1;
}
function oye(e, t, n, r) {
  const i = /* @__PURE__ */ new Map();
  for (const [s, a] of e)
    if ((a.selected || a.id === r) && (!a.parentId || !jq(a, e)) && (a.draggable || t && typeof a.draggable > "u")) {
      const u = e.get(s);
      u && i.set(s, {
        id: s,
        position: u.position || { x: 0, y: 0 },
        distance: {
          x: n.x - u.internals.positionAbsolute.x,
          y: n.y - u.internals.positionAbsolute.y
        },
        extent: u.extent,
        parentId: u.parentId,
        origin: u.origin,
        expandParent: u.expandParent,
        internals: {
          positionAbsolute: u.internals.positionAbsolute || { x: 0, y: 0 }
        },
        measured: {
          width: u.measured.width ?? 0,
          height: u.measured.height ?? 0
        }
      });
    }
  return i;
}
function L_({ nodeId: e, dragItems: t, nodeLookup: n, dragging: r = !0 }) {
  var a, u, d;
  const i = [];
  for (const [f, h] of t) {
    const m = (a = n.get(f)) == null ? void 0 : a.internals.userNode;
    m && i.push({
      ...m,
      position: h.position,
      dragging: r
    });
  }
  if (!e)
    return [i[0], i];
  const s = (u = n.get(e)) == null ? void 0 : u.internals.userNode;
  return [
    s ? {
      ...s,
      position: ((d = t.get(e)) == null ? void 0 : d.position) || s.position,
      dragging: r
    } : i[0],
    i
  ];
}
function lye({ dragItems: e, snapGrid: t, x: n, y: r }) {
  const i = e.values().next().value;
  if (!i)
    return null;
  const s = {
    x: n - i.distance.x,
    y: r - i.distance.y
  }, a = hx(s, t);
  return {
    x: a.x - s.x,
    y: a.y - s.y
  };
}
function uye({ onNodeMouseDown: e, getStoreItems: t, onDragStart: n, onDrag: r, onDragStop: i }) {
  let s = { x: null, y: null }, a = 0, u = /* @__PURE__ */ new Map(), d = !1, f = { x: 0, y: 0 }, h = null, m = !1, x = null, b = !1, w = !1, S = null;
  function C({ noDragClassName: R, handleSelector: N, domNode: M, isSelectable: P, nodeId: D, nodeClickDistance: q = 0 }) {
    x = La(M);
    function Y({ x: G, y: le }) {
      const { nodeLookup: Z, nodeExtent: oe, snapGrid: X, snapToGrid: ce, nodeOrigin: pe, onNodeDrag: de, onSelectionDrag: H, onError: J, updateNodePositions: ge } = t();
      s = { x: G, y: le };
      let Q = !1;
      const fe = u.size > 1, ve = fe && oe ? P5(fx(u)) : null, Se = fe && ce ? lye({
        dragItems: u,
        snapGrid: X,
        x: G,
        y: le
      }) : null;
      for (const [Me, Ie] of u) {
        if (!Z.has(Me))
          continue;
        let Re = { x: G - Ie.distance.x, y: le - Ie.distance.y };
        ce && (Re = Se ? {
          x: Math.round(Re.x + Se.x),
          y: Math.round(Re.y + Se.y)
        } : hx(Re, X));
        let mt = null;
        if (fe && oe && !Ie.extent && ve) {
          const { positionAbsolute: ft } = Ie.internals, yt = ft.x - ve.x + oe[0][0], ht = ft.x + Ie.measured.width - ve.x2 + oe[1][0], Le = ft.y - ve.y + oe[0][1], Ye = ft.y + Ie.measured.height - ve.y2 + oe[1][1];
          mt = [
            [yt, Le],
            [ht, Ye]
          ];
        }
        const { position: dt, positionAbsolute: Je } = fq({
          nodeId: Me,
          nextPosition: Re,
          nodeLookup: Z,
          nodeExtent: mt || oe,
          nodeOrigin: pe,
          onError: J
        });
        Q = Q || Ie.position.x !== dt.x || Ie.position.y !== dt.y, Ie.position = dt, Ie.internals.positionAbsolute = Je;
      }
      if (w = w || Q, !!Q && (ge(u, !0), S && (r || de || !D && H))) {
        const [Me, Ie] = L_({
          nodeId: D,
          dragItems: u,
          nodeLookup: Z
        });
        r == null || r(S, u, Me, Ie), de == null || de(S, Me, Ie), D || H == null || H(S, Ie);
      }
    }
    async function te() {
      if (!h)
        return;
      const { transform: G, panBy: le, autoPanSpeed: Z, autoPanOnNodeDrag: oe } = t();
      if (!oe) {
        d = !1, cancelAnimationFrame(a);
        return;
      }
      const [X, ce] = pq(f, h, Z);
      (X !== 0 || ce !== 0) && (s.x = (s.x ?? 0) - X / G[2], s.y = (s.y ?? 0) - ce / G[2], await le({ x: X, y: ce }) && Y(s)), a = requestAnimationFrame(te);
    }
    function V(G) {
      var fe;
      const { nodeLookup: le, multiSelectionActive: Z, nodesDraggable: oe, transform: X, snapGrid: ce, snapToGrid: pe, selectNodesOnDrag: de, onNodeDragStart: H, onSelectionDragStart: J, unselectNodesAndEdges: ge } = t();
      m = !0, (!de || !P) && !Z && D && ((fe = le.get(D)) != null && fe.selected || ge()), P && de && D && (e == null || e(D));
      const Q = vy(G.sourceEvent, { transform: X, snapGrid: ce, snapToGrid: pe, containerBounds: h });
      if (s = Q, u = oye(le, oe, Q, D), u.size > 0 && (n || H || !D && J)) {
        const [ve, Se] = L_({
          nodeId: D,
          dragItems: u,
          nodeLookup: le
        });
        n == null || n(G.sourceEvent, u, ve, Se), H == null || H(G.sourceEvent, ve, Se), D || J == null || J(G.sourceEvent, Se);
      }
    }
    const $ = V$().clickDistance(q).on("start", (G) => {
      const { domNode: le, nodeDragThreshold: Z, transform: oe, snapGrid: X, snapToGrid: ce } = t();
      h = (le == null ? void 0 : le.getBoundingClientRect()) || null, b = !1, w = !1, S = G.sourceEvent, Z === 0 && V(G), s = vy(G.sourceEvent, { transform: oe, snapGrid: X, snapToGrid: ce, containerBounds: h }), f = nl(G.sourceEvent, h);
    }).on("drag", (G) => {
      const { autoPanOnNodeDrag: le, transform: Z, snapGrid: oe, snapToGrid: X, nodeDragThreshold: ce, nodeLookup: pe } = t(), de = vy(G.sourceEvent, { transform: Z, snapGrid: oe, snapToGrid: X, containerBounds: h });
      if (S = G.sourceEvent, (G.sourceEvent.type === "touchmove" && G.sourceEvent.touches.length > 1 || // if user deletes a node while dragging, we need to abort the drag to prevent errors
      D && !pe.has(D)) && (b = !0), !b) {
        if (!d && le && m && (d = !0, te()), !m) {
          const H = nl(G.sourceEvent, h), J = H.x - f.x, ge = H.y - f.y;
          Math.sqrt(J * J + ge * ge) > ce && V(G);
        }
        (s.x !== de.xSnapped || s.y !== de.ySnapped) && u && m && (f = nl(G.sourceEvent, h), Y(de));
      }
    }).on("end", (G) => {
      if (!(!m || b) && (d = !1, m = !1, cancelAnimationFrame(a), u.size > 0)) {
        const { nodeLookup: le, updateNodePositions: Z, onNodeDragStop: oe, onSelectionDragStop: X } = t();
        if (w && (Z(u, !1), w = !1), i || oe || !D && X) {
          const [ce, pe] = L_({
            nodeId: D,
            dragItems: u,
            nodeLookup: le,
            dragging: !1
          });
          i == null || i(G.sourceEvent, u, ce, pe), oe == null || oe(G.sourceEvent, ce, pe), D || X == null || X(G.sourceEvent, pe);
        }
      }
    }).filter((G) => {
      const le = G.target;
      return !G.button && (!R || !yR(le, `.${R}`, M)) && (!N || yR(le, N, M));
    });
    x.call($);
  }
  function T() {
    x == null || x.on(".drag", null);
  }
  return {
    update: C,
    destroy: T
  };
}
function cye(e, t, n) {
  const r = [], i = {
    x: e.x - n,
    y: e.y - n,
    width: n * 2,
    height: n * 2
  };
  for (const s of t.values())
    Uy(i, qm(s)) > 0 && r.push(s);
  return r;
}
const dye = 250;
function fye(e, t, n, r) {
  var u, d;
  let i = [], s = 1 / 0;
  const a = cye(e, n, t + dye);
  for (const f of a) {
    const h = [...((u = f.internals.handleBounds) == null ? void 0 : u.source) ?? [], ...((d = f.internals.handleBounds) == null ? void 0 : d.target) ?? []];
    for (const m of h) {
      if (r.nodeId === m.nodeId && r.type === m.type && r.id === m.id)
        continue;
      const { x, y: b } = Ch(f, m, m.position, !0), w = Math.sqrt(Math.pow(x - e.x, 2) + Math.pow(b - e.y, 2));
      w > t || (w < s ? (i = [{ ...m, x, y: b }], s = w) : w === s && i.push({ ...m, x, y: b }));
    }
  }
  if (!i.length)
    return null;
  if (i.length > 1) {
    const f = r.type === "source" ? "target" : "source";
    return i.find((h) => h.type === f) ?? i[0];
  }
  return i[0];
}
function Aq(e, t, n, r, i, s = !1) {
  var f, h, m;
  const a = r.get(e);
  if (!a)
    return null;
  const u = i === "strict" ? (f = a.internals.handleBounds) == null ? void 0 : f[t] : [...((h = a.internals.handleBounds) == null ? void 0 : h.source) ?? [], ...((m = a.internals.handleBounds) == null ? void 0 : m.target) ?? []], d = (n ? u == null ? void 0 : u.find((x) => x.id === n) : u == null ? void 0 : u[0]) ?? null;
  return d && s ? { ...d, ...Ch(a, d, d.position, !0) } : d;
}
function Nq(e, t) {
  return e || (t != null && t.classList.contains("target") ? "target" : t != null && t.classList.contains("source") ? "source" : null);
}
function hye(e, t) {
  let n = null;
  return t ? n = !0 : e && !t && (n = !1), n;
}
const Rq = () => !0;
function pye(e, { connectionMode: t, connectionRadius: n, handleId: r, nodeId: i, edgeUpdaterType: s, isTarget: a, domNode: u, nodeLookup: d, lib: f, autoPanOnConnect: h, flowId: m, panBy: x, cancelConnection: b, onConnectStart: w, onConnect: S, onConnectEnd: C, isValidConnection: T = Rq, onReconnectEnd: R, updateConnection: N, getTransform: M, getFromHandle: P, autoPanSpeed: D, dragThreshold: q = 1, handleDomNode: Y }) {
  const te = xq(e.target);
  let V = 0, $;
  const { x: G, y: le } = nl(e), Z = Nq(s, Y), oe = u == null ? void 0 : u.getBoundingClientRect();
  let X = !1;
  if (!oe || !Z)
    return;
  const ce = Aq(i, Z, r, d, t);
  if (!ce)
    return;
  let pe = nl(e, oe), de = !1, H = null, J = !1, ge = null;
  function Q() {
    if (!h || !oe)
      return;
    const [dt, Je] = pq(pe, oe, D);
    x({ x: dt, y: Je }), V = requestAnimationFrame(Q);
  }
  const fe = {
    ...ce,
    nodeId: i,
    type: Z,
    position: ce.position
  }, ve = d.get(i);
  let Me = {
    inProgress: !0,
    isValid: null,
    from: Ch(ve, fe, wt.Left, !0),
    fromHandle: fe,
    fromPosition: fe.position,
    fromNode: ve,
    to: pe,
    toHandle: null,
    toPosition: sR[fe.position],
    toNode: null,
    pointer: pe
  };
  function Ie() {
    X = !0, N(Me), w == null || w(e, { nodeId: i, handleId: r, handleType: Z });
  }
  q === 0 && Ie();
  function Re(dt) {
    if (!X) {
      const { x: Ye, y: gt } = nl(dt), Dt = Ye - G, pn = gt - le;
      if (!(Dt * Dt + pn * pn > q * q))
        return;
      Ie();
    }
    if (!P() || !fe) {
      mt(dt);
      return;
    }
    const Je = M();
    pe = nl(dt, oe), $ = fye(px(pe, Je, !1, [1, 1]), n, d, fe), de || (Q(), de = !0);
    const ft = Mq(dt, {
      handle: $,
      connectionMode: t,
      fromNodeId: i,
      fromHandleId: r,
      fromType: a ? "target" : "source",
      isValidConnection: T,
      doc: te,
      lib: f,
      flowId: m,
      nodeLookup: d
    });
    ge = ft.handleDomNode, H = ft.connection, J = hye(!!$, ft.isValid);
    const yt = d.get(i), ht = yt ? Ch(yt, fe, wt.Left, !0) : Me.from, Le = {
      ...Me,
      from: ht,
      isValid: J,
      to: ft.toHandle && J ? Pb({ x: ft.toHandle.x, y: ft.toHandle.y }, Je) : pe,
      toHandle: ft.toHandle,
      toPosition: J && ft.toHandle ? ft.toHandle.position : sR[fe.position],
      toNode: ft.toHandle ? d.get(ft.toHandle.nodeId) : null,
      pointer: pe
    };
    N(Le), Me = Le;
  }
  function mt(dt) {
    if (!("touches" in dt && dt.touches.length > 0)) {
      if (X) {
        ($ || ge) && H && J && (S == null || S(H));
        const { inProgress: Je, ...ft } = Me, yt = {
          ...ft,
          toPosition: Me.toHandle ? Me.toPosition : null
        };
        C == null || C(dt, yt), s && (R == null || R(dt, yt));
      }
      b(), cancelAnimationFrame(V), de = !1, J = !1, H = null, ge = null, te.removeEventListener("mousemove", Re), te.removeEventListener("mouseup", mt), te.removeEventListener("touchmove", Re), te.removeEventListener("touchend", mt);
    }
  }
  te.addEventListener("mousemove", Re), te.addEventListener("mouseup", mt), te.addEventListener("touchmove", Re), te.addEventListener("touchend", mt);
}
function Mq(e, { handle: t, connectionMode: n, fromNodeId: r, fromHandleId: i, fromType: s, doc: a, lib: u, flowId: d, isValidConnection: f = Rq, nodeLookup: h }) {
  const m = s === "target", x = t ? a.querySelector(`.${u}-flow__handle[data-id="${d}-${t == null ? void 0 : t.nodeId}-${t == null ? void 0 : t.id}-${t == null ? void 0 : t.type}"]`) : null, { x: b, y: w } = nl(e), S = a.elementFromPoint(b, w), C = S != null && S.classList.contains(`${u}-flow__handle`) ? S : x, T = {
    handleDomNode: C,
    isValid: !1,
    connection: null,
    toHandle: null
  };
  if (C) {
    const R = Nq(void 0, C), N = C.getAttribute("data-nodeid"), M = C.getAttribute("data-handleid"), P = C.classList.contains("connectable"), D = C.classList.contains("connectableend");
    if (!N || !R)
      return T;
    const q = {
      source: m ? N : r,
      sourceHandle: m ? M : i,
      target: m ? r : N,
      targetHandle: m ? i : M
    };
    T.connection = q;
    const te = P && D && (n === Bm.Strict ? m && R === "source" || !m && R === "target" : N !== r || M !== i);
    T.isValid = te && f(q), T.toHandle = Aq(N, R, M, h, n, !0);
  }
  return T;
}
const $5 = {
  onPointerDown: pye,
  isValid: Mq
};
function mye({ domNode: e, panZoom: t, getTransform: n, getViewScale: r }) {
  const i = La(e);
  function s({ translateExtent: u, width: d, height: f, zoomStep: h = 1, pannable: m = !0, zoomable: x = !0, inversePan: b = !1 }) {
    const w = (N) => {
      if (N.sourceEvent.type !== "wheel" || !t)
        return;
      const M = n(), P = N.sourceEvent.ctrlKey && Hy() ? 10 : 1, D = -N.sourceEvent.deltaY * (N.sourceEvent.deltaMode === 1 ? 0.05 : N.sourceEvent.deltaMode ? 1 : 2e-3) * h, q = M[2] * Math.pow(2, D * P);
      t.scaleTo(q);
    };
    let S = [0, 0];
    const C = (N) => {
      (N.sourceEvent.type === "mousedown" || N.sourceEvent.type === "touchstart") && (S = [
        N.sourceEvent.clientX ?? N.sourceEvent.touches[0].clientX,
        N.sourceEvent.clientY ?? N.sourceEvent.touches[0].clientY
      ]);
    }, T = (N) => {
      const M = n();
      if (N.sourceEvent.type !== "mousemove" && N.sourceEvent.type !== "touchmove" || !t)
        return;
      const P = [
        N.sourceEvent.clientX ?? N.sourceEvent.touches[0].clientX,
        N.sourceEvent.clientY ?? N.sourceEvent.touches[0].clientY
      ], D = [P[0] - S[0], P[1] - S[1]];
      S = P;
      const q = r() * Math.max(M[2], Math.log(M[2])) * (b ? -1 : 1), Y = {
        x: M[0] - D[0] * q,
        y: M[1] - D[1] * q
      }, te = [
        [0, 0],
        [d, f]
      ];
      t.setViewportConstrained({
        x: Y.x,
        y: Y.y,
        zoom: M[2]
      }, te, u);
    }, R = aq().on("start", C).on("zoom", m ? T : null).on("zoom.wheel", x ? w : null);
    i.call(R, {});
  }
  function a() {
    i.on("zoom", null);
  }
  return {
    update: s,
    destroy: a,
    pointer: Ko
  };
}
const ww = (e) => ({
  x: e.x,
  y: e.y,
  zoom: e.k
}), B_ = ({ x: e, y: t, zoom: n }) => xw.translate(e, t).scale(n), gm = (e, t) => e.target.closest(`.${t}`), Oq = (e, t) => t === 2 && Array.isArray(e) && e.includes(2), gye = (e) => ((e *= 2) <= 1 ? e * e * e : (e -= 2) * e * e + 2) / 2, $_ = (e, t = 0, n = gye, r = () => {
}) => {
  const i = typeof t == "number" && t > 0;
  return i || r(), i ? e.transition().duration(t).ease(n).on("end", r) : e;
}, Dq = (e) => {
  const t = e.ctrlKey && Hy() ? 10 : 1;
  return -e.deltaY * (e.deltaMode === 1 ? 0.05 : e.deltaMode ? 1 : 2e-3) * t;
};
function yye({ zoomPanValues: e, noWheelClassName: t, d3Selection: n, d3Zoom: r, panOnScrollMode: i, panOnScrollSpeed: s, zoomOnPinch: a, onPanZoomStart: u, onPanZoom: d, onPanZoomEnd: f }) {
  return (h) => {
    if (gm(h, t))
      return h.ctrlKey && h.preventDefault(), !1;
    h.preventDefault(), h.stopImmediatePropagation();
    const m = n.property("__zoom").k || 1;
    if (h.ctrlKey && a) {
      const C = Ko(h), T = Dq(h), R = m * Math.pow(2, T);
      r.scaleTo(n, R, C, h);
      return;
    }
    const x = h.deltaMode === 1 ? 20 : 1;
    let b = i === yh.Vertical ? 0 : h.deltaX * x, w = i === yh.Horizontal ? 0 : h.deltaY * x;
    !Hy() && h.shiftKey && i !== yh.Vertical && (b = h.deltaY * x, w = 0), r.translateBy(
      n,
      -(b / m) * s,
      -(w / m) * s,
      // @ts-ignore
      { internal: !0 }
    );
    const S = ww(n.property("__zoom"));
    clearTimeout(e.panScrollTimeout), e.isPanScrolling ? (d == null || d(h, S), e.panScrollTimeout = setTimeout(() => {
      f == null || f(h, S), e.isPanScrolling = !1;
    }, 150)) : (e.isPanScrolling = !0, u == null || u(h, S));
  };
}
function xye({ noWheelClassName: e, preventScrolling: t, d3ZoomHandler: n }) {
  return function(r, i) {
    const s = r.type === "wheel", a = !t && s && !r.ctrlKey, u = gm(r, e);
    if (r.ctrlKey && s && u && r.preventDefault(), a || u)
      return null;
    r.preventDefault(), n.call(this, r, i);
  };
}
function vye({ zoomPanValues: e, onDraggingChange: t, onPanZoomStart: n }) {
  return (r) => {
    var s, a, u;
    if ((s = r.sourceEvent) != null && s.internal)
      return;
    const i = ww(r.transform);
    e.mouseButton = ((a = r.sourceEvent) == null ? void 0 : a.button) || 0, e.isZoomingOrPanning = !0, e.prevViewport = i, ((u = r.sourceEvent) == null ? void 0 : u.type) === "mousedown" && t(!0), n && (n == null || n(r.sourceEvent, i));
  };
}
function bye({ zoomPanValues: e, panOnDrag: t, onPaneContextMenu: n, onTransformChange: r, onPanZoom: i }) {
  return (s) => {
    var a, u;
    e.usedRightMouseButton = !!(n && Oq(t, e.mouseButton ?? 0)), (a = s.sourceEvent) != null && a.sync || r([s.transform.x, s.transform.y, s.transform.k]), i && !((u = s.sourceEvent) != null && u.internal) && (i == null || i(s.sourceEvent, ww(s.transform)));
  };
}
function wye({ zoomPanValues: e, panOnDrag: t, panOnScroll: n, onDraggingChange: r, onPanZoomEnd: i, onPaneContextMenu: s }) {
  return (a) => {
    var u;
    if (!((u = a.sourceEvent) != null && u.internal) && (e.isZoomingOrPanning = !1, s && Oq(t, e.mouseButton ?? 0) && !e.usedRightMouseButton && a.sourceEvent && s(a.sourceEvent), e.usedRightMouseButton = !1, r(!1), i)) {
      const d = ww(a.transform);
      e.prevViewport = d, clearTimeout(e.timerId), e.timerId = setTimeout(
        () => {
          i == null || i(a.sourceEvent, d);
        },
        // we need a setTimeout for panOnScroll to supress multiple end events fired during scroll
        n ? 150 : 0
      );
    }
  };
}
function _ye({ zoomActivationKeyPressed: e, zoomOnScroll: t, zoomOnPinch: n, panOnDrag: r, panOnScroll: i, zoomOnDoubleClick: s, userSelectionActive: a, noWheelClassName: u, noPanClassName: d, lib: f, connectionInProgress: h }) {
  return (m) => {
    var C;
    const x = e || t, b = n && m.ctrlKey, w = m.type === "wheel";
    if (m.button === 1 && m.type === "mousedown" && (gm(m, `${f}-flow__node`) || gm(m, `${f}-flow__edge`)))
      return !0;
    if (!r && !x && !i && !s && !n || a || h && !w || gm(m, u) && w || gm(m, d) && (!w || i && w && !e) || !n && m.ctrlKey && w)
      return !1;
    if (!n && m.type === "touchstart" && ((C = m.touches) == null ? void 0 : C.length) > 1)
      return m.preventDefault(), !1;
    if (!x && !i && !b && w || !r && (m.type === "mousedown" || m.type === "touchstart") || Array.isArray(r) && !r.includes(m.button) && m.type === "mousedown")
      return !1;
    const S = Array.isArray(r) && r.includes(m.button) || !m.button || m.button <= 1;
    return (!m.ctrlKey || w) && S;
  };
}
function Sye({ domNode: e, minZoom: t, maxZoom: n, translateExtent: r, viewport: i, onPanZoom: s, onPanZoomStart: a, onPanZoomEnd: u, onDraggingChange: d }) {
  const f = {
    isZoomingOrPanning: !1,
    usedRightMouseButton: !1,
    prevViewport: {},
    mouseButton: 0,
    timerId: void 0,
    panScrollTimeout: void 0,
    isPanScrolling: !1
  }, h = e.getBoundingClientRect(), m = aq().scaleExtent([t, n]).translateExtent(r), x = La(e).call(m);
  R({
    x: i.x,
    y: i.y,
    zoom: $m(i.zoom, t, n)
  }, [
    [0, 0],
    [h.width, h.height]
  ], r);
  const b = x.on("wheel.zoom"), w = x.on("dblclick.zoom");
  m.wheelDelta(Dq);
  function S($, G) {
    return x ? new Promise((le) => {
      m == null || m.interpolate((G == null ? void 0 : G.interpolate) === "linear" ? xy : Y1).transform($_(x, G == null ? void 0 : G.duration, G == null ? void 0 : G.ease, () => le(!0)), $);
    }) : Promise.resolve(!1);
  }
  function C({ noWheelClassName: $, noPanClassName: G, onPaneContextMenu: le, userSelectionActive: Z, panOnScroll: oe, panOnDrag: X, panOnScrollMode: ce, panOnScrollSpeed: pe, preventScrolling: de, zoomOnPinch: H, zoomOnScroll: J, zoomOnDoubleClick: ge, zoomActivationKeyPressed: Q, lib: fe, onTransformChange: ve, connectionInProgress: Se, paneClickDistance: Me, selectionOnDrag: Ie }) {
    Z && !f.isZoomingOrPanning && T();
    const Re = oe && !Q && !Z;
    m.clickDistance(Ie ? 1 / 0 : !tl(Me) || Me < 0 ? 0 : Me);
    const mt = Re ? yye({
      zoomPanValues: f,
      noWheelClassName: $,
      d3Selection: x,
      d3Zoom: m,
      panOnScrollMode: ce,
      panOnScrollSpeed: pe,
      zoomOnPinch: H,
      onPanZoomStart: a,
      onPanZoom: s,
      onPanZoomEnd: u
    }) : xye({
      noWheelClassName: $,
      preventScrolling: de,
      d3ZoomHandler: b
    });
    if (x.on("wheel.zoom", mt, { passive: !1 }), !Z) {
      const Je = vye({
        zoomPanValues: f,
        onDraggingChange: d,
        onPanZoomStart: a
      });
      m.on("start", Je);
      const ft = bye({
        zoomPanValues: f,
        panOnDrag: X,
        onPaneContextMenu: !!le,
        onPanZoom: s,
        onTransformChange: ve
      });
      m.on("zoom", ft);
      const yt = wye({
        zoomPanValues: f,
        panOnDrag: X,
        panOnScroll: oe,
        onPaneContextMenu: le,
        onPanZoomEnd: u,
        onDraggingChange: d
      });
      m.on("end", yt);
    }
    const dt = _ye({
      zoomActivationKeyPressed: Q,
      panOnDrag: X,
      zoomOnScroll: J,
      panOnScroll: oe,
      zoomOnDoubleClick: ge,
      zoomOnPinch: H,
      userSelectionActive: Z,
      noPanClassName: G,
      noWheelClassName: $,
      lib: fe,
      connectionInProgress: Se
    });
    m.filter(dt), ge ? x.on("dblclick.zoom", w) : x.on("dblclick.zoom", null);
  }
  function T() {
    m.on("zoom", null);
  }
  async function R($, G, le) {
    const Z = B_($), oe = m == null ? void 0 : m.constrain()(Z, G, le);
    return oe && await S(oe), new Promise((X) => X(oe));
  }
  async function N($, G) {
    const le = B_($);
    return await S(le, G), new Promise((Z) => Z(le));
  }
  function M($) {
    if (x) {
      const G = B_($), le = x.property("__zoom");
      (le.k !== $.zoom || le.x !== $.x || le.y !== $.y) && (m == null || m.transform(x, G, null, { sync: !0 }));
    }
  }
  function P() {
    const $ = x ? sq(x.node()) : { x: 0, y: 0, k: 1 };
    return { x: $.x, y: $.y, zoom: $.k };
  }
  function D($, G) {
    return x ? new Promise((le) => {
      m == null || m.interpolate((G == null ? void 0 : G.interpolate) === "linear" ? xy : Y1).scaleTo($_(x, G == null ? void 0 : G.duration, G == null ? void 0 : G.ease, () => le(!0)), $);
    }) : Promise.resolve(!1);
  }
  function q($, G) {
    return x ? new Promise((le) => {
      m == null || m.interpolate((G == null ? void 0 : G.interpolate) === "linear" ? xy : Y1).scaleBy($_(x, G == null ? void 0 : G.duration, G == null ? void 0 : G.ease, () => le(!0)), $);
    }) : Promise.resolve(!1);
  }
  function Y($) {
    m == null || m.scaleExtent($);
  }
  function te($) {
    m == null || m.translateExtent($);
  }
  function V($) {
    const G = !tl($) || $ < 0 ? 0 : $;
    m == null || m.clickDistance(G);
  }
  return {
    update: C,
    destroy: T,
    setViewport: N,
    setViewportConstrained: R,
    getViewport: P,
    scaleTo: D,
    scaleBy: q,
    setScaleExtent: Y,
    setTranslateExtent: te,
    syncViewport: M,
    setClickDistance: V
  };
}
var Um;
(function(e) {
  e.Line = "line", e.Handle = "handle";
})(Um || (Um = {}));
function Eye({ width: e, prevWidth: t, height: n, prevHeight: r, affectsX: i, affectsY: s }) {
  const a = e - t, u = n - r, d = [a > 0 ? 1 : a < 0 ? -1 : 0, u > 0 ? 1 : u < 0 ? -1 : 0];
  return a && i && (d[0] = d[0] * -1), u && s && (d[1] = d[1] * -1), d;
}
function xR(e) {
  const t = e.includes("right") || e.includes("left"), n = e.includes("bottom") || e.includes("top"), r = e.includes("left"), i = e.includes("top");
  return {
    isHorizontal: t,
    isVertical: n,
    affectsX: r,
    affectsY: i
  };
}
function cd(e, t) {
  return Math.max(0, t - e);
}
function dd(e, t) {
  return Math.max(0, e - t);
}
function j1(e, t, n) {
  return Math.max(0, t - e, e - n);
}
function vR(e, t) {
  return e ? !t : t;
}
function Cye(e, t, n, r, i, s, a, u) {
  let { affectsX: d, affectsY: f } = t;
  const { isHorizontal: h, isVertical: m } = t, x = h && m, { xSnapped: b, ySnapped: w } = n, { minWidth: S, maxWidth: C, minHeight: T, maxHeight: R } = r, { x: N, y: M, width: P, height: D, aspectRatio: q } = e;
  let Y = Math.floor(h ? b - e.pointerX : 0), te = Math.floor(m ? w - e.pointerY : 0);
  const V = P + (d ? -Y : Y), $ = D + (f ? -te : te), G = -s[0] * P, le = -s[1] * D;
  let Z = j1(V, S, C), oe = j1($, T, R);
  if (a) {
    let pe = 0, de = 0;
    d && Y < 0 ? pe = cd(N + Y + G, a[0][0]) : !d && Y > 0 && (pe = dd(N + V + G, a[1][0])), f && te < 0 ? de = cd(M + te + le, a[0][1]) : !f && te > 0 && (de = dd(M + $ + le, a[1][1])), Z = Math.max(Z, pe), oe = Math.max(oe, de);
  }
  if (u) {
    let pe = 0, de = 0;
    d && Y > 0 ? pe = dd(N + Y, u[0][0]) : !d && Y < 0 && (pe = cd(N + V, u[1][0])), f && te > 0 ? de = dd(M + te, u[0][1]) : !f && te < 0 && (de = cd(M + $, u[1][1])), Z = Math.max(Z, pe), oe = Math.max(oe, de);
  }
  if (i) {
    if (h) {
      const pe = j1(V / q, T, R) * q;
      if (Z = Math.max(Z, pe), a) {
        let de = 0;
        !d && !f || d && !f && x ? de = dd(M + le + V / q, a[1][1]) * q : de = cd(M + le + (d ? Y : -Y) / q, a[0][1]) * q, Z = Math.max(Z, de);
      }
      if (u) {
        let de = 0;
        !d && !f || d && !f && x ? de = cd(M + V / q, u[1][1]) * q : de = dd(M + (d ? Y : -Y) / q, u[0][1]) * q, Z = Math.max(Z, de);
      }
    }
    if (m) {
      const pe = j1($ * q, S, C) / q;
      if (oe = Math.max(oe, pe), a) {
        let de = 0;
        !d && !f || f && !d && x ? de = dd(N + $ * q + G, a[1][0]) / q : de = cd(N + (f ? te : -te) * q + G, a[0][0]) / q, oe = Math.max(oe, de);
      }
      if (u) {
        let de = 0;
        !d && !f || f && !d && x ? de = cd(N + $ * q, u[1][0]) / q : de = dd(N + (f ? te : -te) * q, u[0][0]) / q, oe = Math.max(oe, de);
      }
    }
  }
  te = te + (te < 0 ? oe : -oe), Y = Y + (Y < 0 ? Z : -Z), i && (x ? V > $ * q ? te = (vR(d, f) ? -Y : Y) / q : Y = (vR(d, f) ? -te : te) * q : h ? (te = Y / q, f = d) : (Y = te * q, d = f));
  const X = d ? N + Y : N, ce = f ? M + te : M;
  return {
    width: P + (d ? -Y : Y),
    height: D + (f ? -te : te),
    x: s[0] * Y * (d ? -1 : 1) + X,
    y: s[1] * te * (f ? -1 : 1) + ce
  };
}
const zq = { width: 0, height: 0, x: 0, y: 0 }, kye = {
  ...zq,
  pointerX: 0,
  pointerY: 0,
  aspectRatio: 1
};
function Tye(e) {
  return [
    [0, 0],
    [e.measured.width, e.measured.height]
  ];
}
function jye(e, t, n) {
  const r = t.position.x + e.position.x, i = t.position.y + e.position.y, s = e.measured.width ?? 0, a = e.measured.height ?? 0, u = n[0] * s, d = n[1] * a;
  return [
    [r - u, i - d],
    [r + s - u, i + a - d]
  ];
}
function Aye({ domNode: e, nodeId: t, getStoreItems: n, onChange: r, onEnd: i }) {
  const s = La(e);
  let a = {
    controlDirection: xR("bottom-right"),
    boundaries: {
      minWidth: 0,
      minHeight: 0,
      maxWidth: Number.MAX_VALUE,
      maxHeight: Number.MAX_VALUE
    },
    resizeDirection: void 0,
    keepAspectRatio: !1
  };
  function u({ controlPosition: f, boundaries: h, keepAspectRatio: m, resizeDirection: x, onResizeStart: b, onResize: w, onResizeEnd: S, shouldResize: C }) {
    let T = { ...zq }, R = { ...kye };
    a = {
      boundaries: h,
      resizeDirection: x,
      keepAspectRatio: m,
      controlDirection: xR(f)
    };
    let N, M = null, P = [], D, q, Y, te = !1;
    const V = V$().on("start", ($) => {
      const { nodeLookup: G, transform: le, snapGrid: Z, snapToGrid: oe, nodeOrigin: X, paneDomNode: ce } = n();
      if (N = G.get(t), !N)
        return;
      M = (ce == null ? void 0 : ce.getBoundingClientRect()) ?? null;
      const { xSnapped: pe, ySnapped: de } = vy($.sourceEvent, {
        transform: le,
        snapGrid: Z,
        snapToGrid: oe,
        containerBounds: M
      });
      T = {
        width: N.measured.width ?? 0,
        height: N.measured.height ?? 0,
        x: N.position.x ?? 0,
        y: N.position.y ?? 0
      }, R = {
        ...T,
        pointerX: pe,
        pointerY: de,
        aspectRatio: T.width / T.height
      }, D = void 0, N.parentId && (N.extent === "parent" || N.expandParent) && (D = G.get(N.parentId), q = D && N.extent === "parent" ? Tye(D) : void 0), P = [], Y = void 0;
      for (const [H, J] of G)
        if (J.parentId === t && (P.push({
          id: H,
          position: { ...J.position },
          extent: J.extent
        }), J.extent === "parent" || J.expandParent)) {
          const ge = jye(J, N, J.origin ?? X);
          Y ? Y = [
            [Math.min(ge[0][0], Y[0][0]), Math.min(ge[0][1], Y[0][1])],
            [Math.max(ge[1][0], Y[1][0]), Math.max(ge[1][1], Y[1][1])]
          ] : Y = ge;
        }
      b == null || b($, { ...T });
    }).on("drag", ($) => {
      const { transform: G, snapGrid: le, snapToGrid: Z, nodeOrigin: oe } = n(), X = vy($.sourceEvent, {
        transform: G,
        snapGrid: le,
        snapToGrid: Z,
        containerBounds: M
      }), ce = [];
      if (!N)
        return;
      const { x: pe, y: de, width: H, height: J } = T, ge = {}, Q = N.origin ?? oe, { width: fe, height: ve, x: Se, y: Me } = Cye(R, a.controlDirection, X, a.boundaries, a.keepAspectRatio, Q, q, Y), Ie = fe !== H, Re = ve !== J, mt = Se !== pe && Ie, dt = Me !== de && Re;
      if (!mt && !dt && !Ie && !Re)
        return;
      if ((mt || dt || Q[0] === 1 || Q[1] === 1) && (ge.x = mt ? Se : T.x, ge.y = dt ? Me : T.y, T.x = ge.x, T.y = ge.y, P.length > 0)) {
        const ht = Se - pe, Le = Me - de;
        for (const Ye of P)
          Ye.position = {
            x: Ye.position.x - ht + Q[0] * (fe - H),
            y: Ye.position.y - Le + Q[1] * (ve - J)
          }, ce.push(Ye);
      }
      if ((Ie || Re) && (ge.width = Ie && (!a.resizeDirection || a.resizeDirection === "horizontal") ? fe : T.width, ge.height = Re && (!a.resizeDirection || a.resizeDirection === "vertical") ? ve : T.height, T.width = ge.width, T.height = ge.height), D && N.expandParent) {
        const ht = Q[0] * (ge.width ?? 0);
        ge.x && ge.x < ht && (T.x = ht, R.x = R.x - (ge.x - ht));
        const Le = Q[1] * (ge.height ?? 0);
        ge.y && ge.y < Le && (T.y = Le, R.y = R.y - (ge.y - Le));
      }
      const Je = Eye({
        width: T.width,
        prevWidth: H,
        height: T.height,
        prevHeight: J,
        affectsX: a.controlDirection.affectsX,
        affectsY: a.controlDirection.affectsY
      }), ft = { ...T, direction: Je };
      (C == null ? void 0 : C($, ft)) !== !1 && (te = !0, w == null || w($, ft), r(ge, ce));
    }).on("end", ($) => {
      te && (S == null || S($, { ...T }), i == null || i({ ...T }), te = !1);
    });
    s.call(V);
  }
  function d() {
    s.on(".drag", null);
  }
  return {
    update: u,
    destroy: d
  };
}
const { useDebugValue: Nye } = wd, { useSyncExternalStoreWithSelector: Rye } = Oz, Mye = (e) => e;
function Pq(e, t = Mye, n) {
  const r = Rye(
    e.subscribe,
    e.getState,
    e.getServerState || e.getInitialState,
    t,
    n
  );
  return Nye(r), r;
}
const bR = (e, t) => {
  const n = Mz(e), r = (i, s = t) => Pq(n, i, s);
  return Object.assign(r, n), r;
}, Oye = (e, t) => e ? bR(e, t) : bR;
function xr(e, t) {
  if (Object.is(e, t))
    return !0;
  if (typeof e != "object" || e === null || typeof t != "object" || t === null)
    return !1;
  if (e instanceof Map && t instanceof Map) {
    if (e.size !== t.size) return !1;
    for (const [r, i] of e)
      if (!Object.is(i, t.get(r)))
        return !1;
    return !0;
  }
  if (e instanceof Set && t instanceof Set) {
    if (e.size !== t.size) return !1;
    for (const r of e)
      if (!t.has(r))
        return !1;
    return !0;
  }
  const n = Object.keys(e);
  if (n.length !== Object.keys(t).length)
    return !1;
  for (const r of n)
    if (!Object.prototype.hasOwnProperty.call(t, r) || !Object.is(e[r], t[r]))
      return !1;
  return !0;
}
const _w = I.createContext(null), Dye = _w.Provider, Iq = su.error001();
function hn(e, t) {
  const n = I.useContext(_w);
  if (n === null)
    throw new Error(Iq);
  return Pq(n, e, t);
}
function br() {
  const e = I.useContext(_w);
  if (e === null)
    throw new Error(Iq);
  return I.useMemo(() => ({
    getState: e.getState,
    setState: e.setState,
    subscribe: e.subscribe
  }), [e]);
}
const wR = { display: "none" }, zye = {
  position: "absolute",
  width: 1,
  height: 1,
  margin: -1,
  border: 0,
  padding: 0,
  overflow: "hidden",
  clip: "rect(0px, 0px, 0px, 0px)",
  clipPath: "inset(100%)"
}, Lq = "react-flow__node-desc", Bq = "react-flow__edge-desc", Pye = "react-flow__aria-live", Iye = (e) => e.ariaLiveMessage, Lye = (e) => e.ariaLabelConfig;
function Bye({ rfId: e }) {
  const t = hn(Iye);
  return c.jsx("div", { id: `${Pye}-${e}`, "aria-live": "assertive", "aria-atomic": "true", style: zye, children: t });
}
function $ye({ rfId: e, disableKeyboardA11y: t }) {
  const n = hn(Lye);
  return c.jsxs(c.Fragment, { children: [c.jsx("div", { id: `${Lq}-${e}`, style: wR, children: t ? n["node.a11yDescription.default"] : n["node.a11yDescription.keyboardDisabled"] }), c.jsx("div", { id: `${Bq}-${e}`, style: wR, children: n["edge.a11yDescription.default"] }), !t && c.jsx(Bye, { rfId: e })] });
}
const Sw = I.forwardRef(({ position: e = "top-left", children: t, className: n, style: r, ...i }, s) => {
  const a = `${e}`.split("-");
  return c.jsx("div", { className: ii(["react-flow__panel", n, ...a]), style: r, ref: s, ...i, children: t });
});
Sw.displayName = "Panel";
function qye({ proOptions: e, position: t = "bottom-right" }) {
  return e != null && e.hideAttribution ? null : c.jsx(Sw, { position: t, className: "react-flow__attribution", "data-message": "Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev", children: c.jsx("a", { href: "https://reactflow.dev", target: "_blank", rel: "noopener noreferrer", "aria-label": "React Flow attribution", children: "React Flow" }) });
}
const Fye = (e) => {
  const t = [], n = [];
  for (const [, r] of e.nodeLookup)
    r.selected && t.push(r.internals.userNode);
  for (const [, r] of e.edgeLookup)
    r.selected && n.push(r);
  return { selectedNodes: t, selectedEdges: n };
}, A1 = (e) => e.id;
function Uye(e, t) {
  return xr(e.selectedNodes.map(A1), t.selectedNodes.map(A1)) && xr(e.selectedEdges.map(A1), t.selectedEdges.map(A1));
}
function Hye({ onSelectionChange: e }) {
  const t = br(), { selectedNodes: n, selectedEdges: r } = hn(Fye, Uye);
  return I.useEffect(() => {
    const i = { nodes: n, edges: r };
    e == null || e(i), t.getState().onSelectionChangeHandlers.forEach((s) => s(i));
  }, [n, r, e]), null;
}
const Vye = (e) => !!e.onSelectionChangeHandlers;
function Gye({ onSelectionChange: e }) {
  const t = hn(Vye);
  return e || t ? c.jsx(Hye, { onSelectionChange: e }) : null;
}
const $q = [0, 0], Kye = { x: 0, y: 0, zoom: 1 }, Yye = [
  "nodes",
  "edges",
  "defaultNodes",
  "defaultEdges",
  "onConnect",
  "onConnectStart",
  "onConnectEnd",
  "onClickConnectStart",
  "onClickConnectEnd",
  "nodesDraggable",
  "autoPanOnNodeFocus",
  "nodesConnectable",
  "nodesFocusable",
  "edgesFocusable",
  "edgesReconnectable",
  "elevateNodesOnSelect",
  "elevateEdgesOnSelect",
  "minZoom",
  "maxZoom",
  "nodeExtent",
  "onNodesChange",
  "onEdgesChange",
  "elementsSelectable",
  "connectionMode",
  "snapGrid",
  "snapToGrid",
  "translateExtent",
  "connectOnClick",
  "defaultEdgeOptions",
  "fitView",
  "fitViewOptions",
  "onNodesDelete",
  "onEdgesDelete",
  "onDelete",
  "onNodeDrag",
  "onNodeDragStart",
  "onNodeDragStop",
  "onSelectionDrag",
  "onSelectionDragStart",
  "onSelectionDragStop",
  "onMoveStart",
  "onMove",
  "onMoveEnd",
  "noPanClassName",
  "nodeOrigin",
  "autoPanOnConnect",
  "autoPanOnNodeDrag",
  "onError",
  "connectionRadius",
  "isValidConnection",
  "selectNodesOnDrag",
  "nodeDragThreshold",
  "connectionDragThreshold",
  "onBeforeDelete",
  "debug",
  "autoPanSpeed",
  "ariaLabelConfig",
  "zIndexMode"
], _R = [...Yye, "rfId"], Wye = (e) => ({
  setNodes: e.setNodes,
  setEdges: e.setEdges,
  setMinZoom: e.setMinZoom,
  setMaxZoom: e.setMaxZoom,
  setTranslateExtent: e.setTranslateExtent,
  setNodeExtent: e.setNodeExtent,
  reset: e.reset,
  setDefaultNodesAndEdges: e.setDefaultNodesAndEdges
}), SR = {
  /*
   * these are values that are also passed directly to other components
   * than the StoreUpdater. We can reduce the number of setStore calls
   * by setting the same values here as prev fields.
   */
  translateExtent: $y,
  nodeOrigin: $q,
  minZoom: 0.5,
  maxZoom: 2,
  elementsSelectable: !0,
  noPanClassName: "nopan",
  rfId: "1"
};
function Zye(e) {
  const { setNodes: t, setEdges: n, setMinZoom: r, setMaxZoom: i, setTranslateExtent: s, setNodeExtent: a, reset: u, setDefaultNodesAndEdges: d } = hn(Wye, xr), f = br();
  I.useEffect(() => (d(e.defaultNodes, e.defaultEdges), () => {
    h.current = SR, u();
  }), []);
  const h = I.useRef(SR);
  return I.useEffect(
    () => {
      for (const m of _R) {
        const x = e[m], b = h.current[m];
        x !== b && (typeof e[m] > "u" || (m === "nodes" ? t(x) : m === "edges" ? n(x) : m === "minZoom" ? r(x) : m === "maxZoom" ? i(x) : m === "translateExtent" ? s(x) : m === "nodeExtent" ? a(x) : m === "ariaLabelConfig" ? f.setState({ ariaLabelConfig: q0e(x) }) : m === "fitView" ? f.setState({ fitViewQueued: x }) : m === "fitViewOptions" ? f.setState({ fitViewOptions: x }) : f.setState({ [m]: x })));
      }
      h.current = e;
    },
    // Only re-run the effect if one of the fields we track changes
    _R.map((m) => e[m])
  ), null;
}
function ER() {
  return typeof window > "u" || !window.matchMedia ? null : window.matchMedia("(prefers-color-scheme: dark)");
}
function Xye(e) {
  var r;
  const [t, n] = I.useState(e === "system" ? null : e);
  return I.useEffect(() => {
    if (e !== "system") {
      n(e);
      return;
    }
    const i = ER(), s = () => n(i != null && i.matches ? "dark" : "light");
    return s(), i == null || i.addEventListener("change", s), () => {
      i == null || i.removeEventListener("change", s);
    };
  }, [e]), t !== null ? t : (r = ER()) != null && r.matches ? "dark" : "light";
}
const CR = typeof document < "u" ? document : null;
function Vy(e = null, t = { target: CR, actInsideInputWithModifier: !0 }) {
  const [n, r] = I.useState(!1), i = I.useRef(!1), s = I.useRef(/* @__PURE__ */ new Set([])), [a, u] = I.useMemo(() => {
    if (e !== null) {
      const f = (Array.isArray(e) ? e : [e]).filter((m) => typeof m == "string").map((m) => m.replace("+", `
`).replace(`

`, `
+`).split(`
`)), h = f.reduce((m, x) => m.concat(...x), []);
      return [f, h];
    }
    return [[], []];
  }, [e]);
  return I.useEffect(() => {
    const d = (t == null ? void 0 : t.target) ?? CR, f = (t == null ? void 0 : t.actInsideInputWithModifier) ?? !0;
    if (e !== null) {
      const h = (b) => {
        var C, T;
        if (i.current = b.ctrlKey || b.metaKey || b.shiftKey || b.altKey, (!i.current || i.current && !f) && vq(b))
          return !1;
        const S = TR(b.code, u);
        if (s.current.add(b[S]), kR(a, s.current, !1)) {
          const R = ((T = (C = b.composedPath) == null ? void 0 : C.call(b)) == null ? void 0 : T[0]) || b.target, N = (R == null ? void 0 : R.nodeName) === "BUTTON" || (R == null ? void 0 : R.nodeName) === "A";
          t.preventDefault !== !1 && (i.current || !N) && b.preventDefault(), r(!0);
        }
      }, m = (b) => {
        const w = TR(b.code, u);
        kR(a, s.current, !0) ? (r(!1), s.current.clear()) : s.current.delete(b[w]), b.key === "Meta" && s.current.clear(), i.current = !1;
      }, x = () => {
        s.current.clear(), r(!1);
      };
      return d == null || d.addEventListener("keydown", h), d == null || d.addEventListener("keyup", m), window.addEventListener("blur", x), window.addEventListener("contextmenu", x), () => {
        d == null || d.removeEventListener("keydown", h), d == null || d.removeEventListener("keyup", m), window.removeEventListener("blur", x), window.removeEventListener("contextmenu", x);
      };
    }
  }, [e, r]), n;
}
function kR(e, t, n) {
  return e.filter((r) => n || r.length === t.size).some((r) => r.every((i) => t.has(i)));
}
function TR(e, t) {
  return t.includes(e) ? "code" : "key";
}
const Qye = () => {
  const e = br();
  return I.useMemo(() => ({
    zoomIn: (t) => {
      const { panZoom: n } = e.getState();
      return n ? n.scaleBy(1.2, { duration: t == null ? void 0 : t.duration }) : Promise.resolve(!1);
    },
    zoomOut: (t) => {
      const { panZoom: n } = e.getState();
      return n ? n.scaleBy(1 / 1.2, { duration: t == null ? void 0 : t.duration }) : Promise.resolve(!1);
    },
    zoomTo: (t, n) => {
      const { panZoom: r } = e.getState();
      return r ? r.scaleTo(t, { duration: n == null ? void 0 : n.duration }) : Promise.resolve(!1);
    },
    getZoom: () => e.getState().transform[2],
    setViewport: async (t, n) => {
      const { transform: [r, i, s], panZoom: a } = e.getState();
      return a ? (await a.setViewport({
        x: t.x ?? r,
        y: t.y ?? i,
        zoom: t.zoom ?? s
      }, n), Promise.resolve(!0)) : Promise.resolve(!1);
    },
    getViewport: () => {
      const [t, n, r] = e.getState().transform;
      return { x: t, y: n, zoom: r };
    },
    setCenter: async (t, n, r) => e.getState().setCenter(t, n, r),
    fitBounds: async (t, n) => {
      const { width: r, height: i, minZoom: s, maxZoom: a, panZoom: u } = e.getState(), d = jj(t, r, i, s, a, (n == null ? void 0 : n.padding) ?? 0.1);
      return u ? (await u.setViewport(d, {
        duration: n == null ? void 0 : n.duration,
        ease: n == null ? void 0 : n.ease,
        interpolate: n == null ? void 0 : n.interpolate
      }), Promise.resolve(!0)) : Promise.resolve(!1);
    },
    screenToFlowPosition: (t, n = {}) => {
      const { transform: r, snapGrid: i, snapToGrid: s, domNode: a } = e.getState();
      if (!a)
        return t;
      const { x: u, y: d } = a.getBoundingClientRect(), f = {
        x: t.x - u,
        y: t.y - d
      }, h = n.snapGrid ?? i, m = n.snapToGrid ?? s;
      return px(f, r, m, h);
    },
    flowToScreenPosition: (t) => {
      const { transform: n, domNode: r } = e.getState();
      if (!r)
        return t;
      const { x: i, y: s } = r.getBoundingClientRect(), a = Pb(t, n);
      return {
        x: a.x + i,
        y: a.y + s
      };
    }
  }), []);
};
function qq(e, t) {
  const n = [], r = /* @__PURE__ */ new Map(), i = [];
  for (const s of e)
    if (s.type === "add") {
      i.push(s);
      continue;
    } else if (s.type === "remove" || s.type === "replace")
      r.set(s.id, [s]);
    else {
      const a = r.get(s.id);
      a ? a.push(s) : r.set(s.id, [s]);
    }
  for (const s of t) {
    const a = r.get(s.id);
    if (!a) {
      n.push(s);
      continue;
    }
    if (a[0].type === "remove")
      continue;
    if (a[0].type === "replace") {
      n.push({ ...a[0].item });
      continue;
    }
    const u = { ...s };
    for (const d of a)
      Jye(d, u);
    n.push(u);
  }
  return i.length && i.forEach((s) => {
    s.index !== void 0 ? n.splice(s.index, 0, { ...s.item }) : n.push({ ...s.item });
  }), n;
}
function Jye(e, t) {
  switch (e.type) {
    case "select": {
      t.selected = e.selected;
      break;
    }
    case "position": {
      typeof e.position < "u" && (t.position = e.position), typeof e.dragging < "u" && (t.dragging = e.dragging);
      break;
    }
    case "dimensions": {
      typeof e.dimensions < "u" && (t.measured = {
        ...e.dimensions
      }, e.setAttributes && ((e.setAttributes === !0 || e.setAttributes === "width") && (t.width = e.dimensions.width), (e.setAttributes === !0 || e.setAttributes === "height") && (t.height = e.dimensions.height))), typeof e.resizing == "boolean" && (t.resizing = e.resizing);
      break;
    }
  }
}
function Fq(e, t) {
  return qq(e, t);
}
function Uq(e, t) {
  return qq(e, t);
}
function Jf(e, t) {
  return {
    id: e,
    type: "select",
    selected: t
  };
}
function ym(e, t = /* @__PURE__ */ new Set(), n = !1) {
  const r = [];
  for (const [i, s] of e) {
    const a = t.has(i);
    !(s.selected === void 0 && !a) && s.selected !== a && (n && (s.selected = a), r.push(Jf(s.id, a)));
  }
  return r;
}
function jR({ items: e = [], lookup: t }) {
  var i;
  const n = [], r = new Map(e.map((s) => [s.id, s]));
  for (const [s, a] of e.entries()) {
    const u = t.get(a.id), d = ((i = u == null ? void 0 : u.internals) == null ? void 0 : i.userNode) ?? u;
    d !== void 0 && d !== a && n.push({ id: a.id, item: a, type: "replace" }), d === void 0 && n.push({ item: a, type: "add", index: s });
  }
  for (const [s] of t)
    r.get(s) === void 0 && n.push({ id: s, type: "remove" });
  return n;
}
function AR(e) {
  return {
    id: e.id,
    type: "remove"
  };
}
const NR = (e) => R0e(e), exe = (e) => dq(e);
function Hq(e) {
  return I.forwardRef(e);
}
const txe = typeof window < "u" ? I.useLayoutEffect : I.useEffect;
function RR(e) {
  const [t, n] = I.useState(BigInt(0)), [r] = I.useState(() => nxe(() => n((i) => i + BigInt(1))));
  return txe(() => {
    const i = r.get();
    i.length && (e(i), r.reset());
  }, [t]), r;
}
function nxe(e) {
  let t = [];
  return {
    get: () => t,
    reset: () => {
      t = [];
    },
    push: (n) => {
      t.push(n), e();
    }
  };
}
const Vq = I.createContext(null);
function rxe({ children: e }) {
  const t = br(), n = I.useCallback((u) => {
    const { nodes: d = [], setNodes: f, hasDefaultNodes: h, onNodesChange: m, nodeLookup: x, fitViewQueued: b, onNodesChangeMiddlewareMap: w } = t.getState();
    let S = d;
    for (const T of u)
      S = typeof T == "function" ? T(S) : T;
    let C = jR({
      items: S,
      lookup: x
    });
    for (const T of w.values())
      C = T(C);
    h && f(S), C.length > 0 ? m == null || m(C) : b && window.requestAnimationFrame(() => {
      const { fitViewQueued: T, nodes: R, setNodes: N } = t.getState();
      T && N(R);
    });
  }, []), r = RR(n), i = I.useCallback((u) => {
    const { edges: d = [], setEdges: f, hasDefaultEdges: h, onEdgesChange: m, edgeLookup: x } = t.getState();
    let b = d;
    for (const w of u)
      b = typeof w == "function" ? w(b) : w;
    h ? f(b) : m && m(jR({
      items: b,
      lookup: x
    }));
  }, []), s = RR(i), a = I.useMemo(() => ({ nodeQueue: r, edgeQueue: s }), []);
  return c.jsx(Vq.Provider, { value: a, children: e });
}
function ixe() {
  const e = I.useContext(Vq);
  if (!e)
    throw new Error("useBatchContext must be used within a BatchProvider");
  return e;
}
const sxe = (e) => !!e.panZoom;
function zj() {
  const e = Qye(), t = br(), n = ixe(), r = hn(sxe), i = I.useMemo(() => {
    const s = (m) => t.getState().nodeLookup.get(m), a = (m) => {
      n.nodeQueue.push(m);
    }, u = (m) => {
      n.edgeQueue.push(m);
    }, d = (m) => {
      var T, R;
      const { nodeLookup: x, nodeOrigin: b } = t.getState(), w = NR(m) ? m : x.get(m.id), S = w.parentId ? yq(w.position, w.measured, w.parentId, x, b) : w.position, C = {
        ...w,
        position: S,
        width: ((T = w.measured) == null ? void 0 : T.width) ?? w.width,
        height: ((R = w.measured) == null ? void 0 : R.height) ?? w.height
      };
      return qm(C);
    }, f = (m, x, b = { replace: !1 }) => {
      a((w) => w.map((S) => {
        if (S.id === m) {
          const C = typeof x == "function" ? x(S) : x;
          return b.replace && NR(C) ? C : { ...S, ...C };
        }
        return S;
      }));
    }, h = (m, x, b = { replace: !1 }) => {
      u((w) => w.map((S) => {
        if (S.id === m) {
          const C = typeof x == "function" ? x(S) : x;
          return b.replace && exe(C) ? C : { ...S, ...C };
        }
        return S;
      }));
    };
    return {
      getNodes: () => t.getState().nodes.map((m) => ({ ...m })),
      getNode: (m) => {
        var x;
        return (x = s(m)) == null ? void 0 : x.internals.userNode;
      },
      getInternalNode: s,
      getEdges: () => {
        const { edges: m = [] } = t.getState();
        return m.map((x) => ({ ...x }));
      },
      getEdge: (m) => t.getState().edgeLookup.get(m),
      setNodes: a,
      setEdges: u,
      addNodes: (m) => {
        const x = Array.isArray(m) ? m : [m];
        n.nodeQueue.push((b) => [...b, ...x]);
      },
      addEdges: (m) => {
        const x = Array.isArray(m) ? m : [m];
        n.edgeQueue.push((b) => [...b, ...x]);
      },
      toObject: () => {
        const { nodes: m = [], edges: x = [], transform: b } = t.getState(), [w, S, C] = b;
        return {
          nodes: m.map((T) => ({ ...T })),
          edges: x.map((T) => ({ ...T })),
          viewport: {
            x: w,
            y: S,
            zoom: C
          }
        };
      },
      deleteElements: async ({ nodes: m = [], edges: x = [] }) => {
        const { nodes: b, edges: w, onNodesDelete: S, onEdgesDelete: C, triggerNodeChanges: T, triggerEdgeChanges: R, onDelete: N, onBeforeDelete: M } = t.getState(), { nodes: P, edges: D } = await P0e({
          nodesToRemove: m,
          edgesToRemove: x,
          nodes: b,
          edges: w,
          onBeforeDelete: M
        }), q = D.length > 0, Y = P.length > 0;
        if (q) {
          const te = D.map(AR);
          C == null || C(D), R(te);
        }
        if (Y) {
          const te = P.map(AR);
          S == null || S(P), T(te);
        }
        return (Y || q) && (N == null || N({ nodes: P, edges: D })), { deletedNodes: P, deletedEdges: D };
      },
      /**
       * Partial is defined as "the 2 nodes/areas are intersecting partially".
       * If a is contained in b or b is contained in a, they are both
       * considered fully intersecting.
       */
      getIntersectingNodes: (m, x = !0, b) => {
        const w = oR(m), S = w ? m : d(m), C = b !== void 0;
        return S ? (b || t.getState().nodes).filter((T) => {
          const R = t.getState().nodeLookup.get(T.id);
          if (R && !w && (T.id === m.id || !R.internals.positionAbsolute))
            return !1;
          const N = qm(C ? T : R), M = Uy(N, S);
          return x && M > 0 || M >= N.width * N.height || M >= S.width * S.height;
        }) : [];
      },
      isNodeIntersecting: (m, x, b = !0) => {
        const S = oR(m) ? m : d(m);
        if (!S)
          return !1;
        const C = Uy(S, x);
        return b && C > 0 || C >= x.width * x.height || C >= S.width * S.height;
      },
      updateNode: f,
      updateNodeData: (m, x, b = { replace: !1 }) => {
        f(m, (w) => {
          const S = typeof x == "function" ? x(w) : x;
          return b.replace ? { ...w, data: S } : { ...w, data: { ...w.data, ...S } };
        }, b);
      },
      updateEdge: h,
      updateEdgeData: (m, x, b = { replace: !1 }) => {
        h(m, (w) => {
          const S = typeof x == "function" ? x(w) : x;
          return b.replace ? { ...w, data: S } : { ...w, data: { ...w.data, ...S } };
        }, b);
      },
      getNodesBounds: (m) => {
        const { nodeLookup: x, nodeOrigin: b } = t.getState();
        return M0e(m, { nodeLookup: x, nodeOrigin: b });
      },
      getHandleConnections: ({ type: m, id: x, nodeId: b }) => {
        var w;
        return Array.from(((w = t.getState().connectionLookup.get(`${b}-${m}${x ? `-${x}` : ""}`)) == null ? void 0 : w.values()) ?? []);
      },
      getNodeConnections: ({ type: m, handleId: x, nodeId: b }) => {
        var w;
        return Array.from(((w = t.getState().connectionLookup.get(`${b}${m ? x ? `-${m}-${x}` : `-${m}` : ""}`)) == null ? void 0 : w.values()) ?? []);
      },
      fitView: async (m) => {
        const x = t.getState().fitViewResolver ?? $0e();
        return t.setState({ fitViewQueued: !0, fitViewOptions: m, fitViewResolver: x }), n.nodeQueue.push((b) => [...b]), x.promise;
      }
    };
  }, []);
  return I.useMemo(() => ({
    ...i,
    ...e,
    viewportInitialized: r
  }), [r]);
}
const MR = (e) => e.selected, axe = typeof window < "u" ? window : void 0;
function oxe({ deleteKeyCode: e, multiSelectionKeyCode: t }) {
  const n = br(), { deleteElements: r } = zj(), i = Vy(e, { actInsideInputWithModifier: !1 }), s = Vy(t, { target: axe });
  I.useEffect(() => {
    if (i) {
      const { edges: a, nodes: u } = n.getState();
      r({ nodes: u.filter(MR), edges: a.filter(MR) }), n.setState({ nodesSelectionActive: !1 });
    }
  }, [i]), I.useEffect(() => {
    n.setState({ multiSelectionActive: s });
  }, [s]);
}
function lxe(e) {
  const t = br();
  I.useEffect(() => {
    const n = () => {
      var i, s, a, u;
      if (!e.current || !(((s = (i = e.current).checkVisibility) == null ? void 0 : s.call(i)) ?? !0))
        return !1;
      const r = Aj(e.current);
      (r.height === 0 || r.width === 0) && ((u = (a = t.getState()).onError) == null || u.call(a, "004", su.error004())), t.setState({ width: r.width || 500, height: r.height || 500 });
    };
    if (e.current) {
      n(), window.addEventListener("resize", n);
      const r = new ResizeObserver(() => n());
      return r.observe(e.current), () => {
        window.removeEventListener("resize", n), r && e.current && r.unobserve(e.current);
      };
    }
  }, []);
}
const Ew = {
  position: "absolute",
  width: "100%",
  height: "100%",
  top: 0,
  left: 0
}, uxe = (e) => ({
  userSelectionActive: e.userSelectionActive,
  lib: e.lib,
  connectionInProgress: e.connection.inProgress
});
function cxe({ onPaneContextMenu: e, zoomOnScroll: t = !0, zoomOnPinch: n = !0, panOnScroll: r = !1, panOnScrollSpeed: i = 0.5, panOnScrollMode: s = yh.Free, zoomOnDoubleClick: a = !0, panOnDrag: u = !0, defaultViewport: d, translateExtent: f, minZoom: h, maxZoom: m, zoomActivationKeyCode: x, preventScrolling: b = !0, children: w, noWheelClassName: S, noPanClassName: C, onViewportChange: T, isControlledViewport: R, paneClickDistance: N, selectionOnDrag: M }) {
  const P = br(), D = I.useRef(null), { userSelectionActive: q, lib: Y, connectionInProgress: te } = hn(uxe, xr), V = Vy(x), $ = I.useRef();
  lxe(D);
  const G = I.useCallback((le) => {
    T == null || T({ x: le[0], y: le[1], zoom: le[2] }), R || P.setState({ transform: le });
  }, [T, R]);
  return I.useEffect(() => {
    if (D.current) {
      $.current = Sye({
        domNode: D.current,
        minZoom: h,
        maxZoom: m,
        translateExtent: f,
        viewport: d,
        onDraggingChange: (X) => P.setState({ paneDragging: X }),
        onPanZoomStart: (X, ce) => {
          const { onViewportChangeStart: pe, onMoveStart: de } = P.getState();
          de == null || de(X, ce), pe == null || pe(ce);
        },
        onPanZoom: (X, ce) => {
          const { onViewportChange: pe, onMove: de } = P.getState();
          de == null || de(X, ce), pe == null || pe(ce);
        },
        onPanZoomEnd: (X, ce) => {
          const { onViewportChangeEnd: pe, onMoveEnd: de } = P.getState();
          de == null || de(X, ce), pe == null || pe(ce);
        }
      });
      const { x: le, y: Z, zoom: oe } = $.current.getViewport();
      return P.setState({
        panZoom: $.current,
        transform: [le, Z, oe],
        domNode: D.current.closest(".react-flow")
      }), () => {
        var X;
        (X = $.current) == null || X.destroy();
      };
    }
  }, []), I.useEffect(() => {
    var le;
    (le = $.current) == null || le.update({
      onPaneContextMenu: e,
      zoomOnScroll: t,
      zoomOnPinch: n,
      panOnScroll: r,
      panOnScrollSpeed: i,
      panOnScrollMode: s,
      zoomOnDoubleClick: a,
      panOnDrag: u,
      zoomActivationKeyPressed: V,
      preventScrolling: b,
      noPanClassName: C,
      userSelectionActive: q,
      noWheelClassName: S,
      lib: Y,
      onTransformChange: G,
      connectionInProgress: te,
      selectionOnDrag: M,
      paneClickDistance: N
    });
  }, [
    e,
    t,
    n,
    r,
    i,
    s,
    a,
    u,
    V,
    b,
    C,
    q,
    S,
    Y,
    G,
    te,
    M,
    N
  ]), c.jsx("div", { className: "react-flow__renderer", ref: D, style: Ew, children: w });
}
const dxe = (e) => ({
  userSelectionActive: e.userSelectionActive,
  userSelectionRect: e.userSelectionRect
});
function fxe() {
  const { userSelectionActive: e, userSelectionRect: t } = hn(dxe, xr);
  return e && t ? c.jsx("div", { className: "react-flow__selection react-flow__container", style: {
    width: t.width,
    height: t.height,
    transform: `translate(${t.x}px, ${t.y}px)`
  } }) : null;
}
const q_ = (e, t) => (n) => {
  n.target === t.current && (e == null || e(n));
}, hxe = (e) => ({
  userSelectionActive: e.userSelectionActive,
  elementsSelectable: e.elementsSelectable,
  connectionInProgress: e.connection.inProgress,
  dragging: e.paneDragging
});
function pxe({ isSelecting: e, selectionKeyPressed: t, selectionMode: n = qy.Full, panOnDrag: r, paneClickDistance: i, selectionOnDrag: s, onSelectionStart: a, onSelectionEnd: u, onPaneClick: d, onPaneContextMenu: f, onPaneScroll: h, onPaneMouseEnter: m, onPaneMouseMove: x, onPaneMouseLeave: b, children: w }) {
  const S = br(), { userSelectionActive: C, elementsSelectable: T, dragging: R, connectionInProgress: N } = hn(hxe, xr), M = T && (e || C), P = I.useRef(null), D = I.useRef(), q = I.useRef(/* @__PURE__ */ new Set()), Y = I.useRef(/* @__PURE__ */ new Set()), te = I.useRef(!1), V = (pe) => {
    if (te.current || N) {
      te.current = !1;
      return;
    }
    d == null || d(pe), S.getState().resetSelectedElements(), S.setState({ nodesSelectionActive: !1 });
  }, $ = (pe) => {
    if (Array.isArray(r) && (r != null && r.includes(2))) {
      pe.preventDefault();
      return;
    }
    f == null || f(pe);
  }, G = h ? (pe) => h(pe) : void 0, le = (pe) => {
    te.current && (pe.stopPropagation(), te.current = !1);
  }, Z = (pe) => {
    var ve, Se;
    const { domNode: de } = S.getState();
    if (D.current = de == null ? void 0 : de.getBoundingClientRect(), !D.current)
      return;
    const H = pe.target === P.current;
    if (!H && !!pe.target.closest(".nokey") || !e || !(s && H || t) || pe.button !== 0 || !pe.isPrimary)
      return;
    (Se = (ve = pe.target) == null ? void 0 : ve.setPointerCapture) == null || Se.call(ve, pe.pointerId), te.current = !1;
    const { x: Q, y: fe } = nl(pe.nativeEvent, D.current);
    S.setState({
      userSelectionRect: {
        width: 0,
        height: 0,
        startX: Q,
        startY: fe,
        x: Q,
        y: fe
      }
    }), H || (pe.stopPropagation(), pe.preventDefault());
  }, oe = (pe) => {
    const { userSelectionRect: de, transform: H, nodeLookup: J, edgeLookup: ge, connectionLookup: Q, triggerNodeChanges: fe, triggerEdgeChanges: ve, defaultEdgeOptions: Se, resetSelectedElements: Me } = S.getState();
    if (!D.current || !de)
      return;
    const { x: Ie, y: Re } = nl(pe.nativeEvent, D.current), { startX: mt, startY: dt } = de;
    if (!te.current) {
      const Le = t ? 0 : i;
      if (Math.hypot(Ie - mt, Re - dt) <= Le)
        return;
      Me(), a == null || a(pe);
    }
    te.current = !0;
    const Je = {
      startX: mt,
      startY: dt,
      x: Ie < mt ? Ie : mt,
      y: Re < dt ? Re : dt,
      width: Math.abs(Ie - mt),
      height: Math.abs(Re - dt)
    }, ft = q.current, yt = Y.current;
    q.current = new Set(Tj(J, Je, H, n === qy.Partial, !0).map((Le) => Le.id)), Y.current = /* @__PURE__ */ new Set();
    const ht = (Se == null ? void 0 : Se.selectable) ?? !0;
    for (const Le of q.current) {
      const Ye = Q.get(Le);
      if (Ye)
        for (const { edgeId: gt } of Ye.values()) {
          const Dt = ge.get(gt);
          Dt && (Dt.selectable ?? ht) && Y.current.add(gt);
        }
    }
    if (!lR(ft, q.current)) {
      const Le = ym(J, q.current, !0);
      fe(Le);
    }
    if (!lR(yt, Y.current)) {
      const Le = ym(ge, Y.current);
      ve(Le);
    }
    S.setState({
      userSelectionRect: Je,
      userSelectionActive: !0,
      nodesSelectionActive: !1
    });
  }, X = (pe) => {
    var de, H;
    pe.button === 0 && ((H = (de = pe.target) == null ? void 0 : de.releasePointerCapture) == null || H.call(de, pe.pointerId), !C && pe.target === P.current && S.getState().userSelectionRect && (V == null || V(pe)), S.setState({
      userSelectionActive: !1,
      userSelectionRect: null
    }), te.current && (u == null || u(pe), S.setState({
      nodesSelectionActive: q.current.size > 0
    })));
  }, ce = r === !0 || Array.isArray(r) && r.includes(0);
  return c.jsxs("div", { className: ii(["react-flow__pane", { draggable: ce, dragging: R, selection: e }]), onClick: M ? void 0 : q_(V, P), onContextMenu: q_($, P), onWheel: q_(G, P), onPointerEnter: M ? void 0 : m, onPointerMove: M ? oe : x, onPointerUp: M ? X : void 0, onPointerDownCapture: M ? Z : void 0, onClickCapture: M ? le : void 0, onPointerLeave: b, ref: P, style: Ew, children: [w, c.jsx(fxe, {})] });
}
function q5({ id: e, store: t, unselect: n = !1, nodeRef: r }) {
  const { addSelectedNodes: i, unselectNodesAndEdges: s, multiSelectionActive: a, nodeLookup: u, onError: d } = t.getState(), f = u.get(e);
  if (!f) {
    d == null || d("012", su.error012(e));
    return;
  }
  t.setState({ nodesSelectionActive: !1 }), f.selected ? (n || f.selected && a) && (s({ nodes: [f], edges: [] }), requestAnimationFrame(() => {
    var h;
    return (h = r == null ? void 0 : r.current) == null ? void 0 : h.blur();
  })) : i([e]);
}
function Gq({ nodeRef: e, disabled: t = !1, noDragClassName: n, handleSelector: r, nodeId: i, isSelectable: s, nodeClickDistance: a }) {
  const u = br(), [d, f] = I.useState(!1), h = I.useRef();
  return I.useEffect(() => {
    h.current = uye({
      getStoreItems: () => u.getState(),
      onNodeMouseDown: (m) => {
        q5({
          id: m,
          store: u,
          nodeRef: e
        });
      },
      onDragStart: () => {
        f(!0);
      },
      onDragStop: () => {
        f(!1);
      }
    });
  }, []), I.useEffect(() => {
    var m, x;
    if (t)
      (m = h.current) == null || m.destroy();
    else if (e.current)
      return (x = h.current) == null || x.update({
        noDragClassName: n,
        handleSelector: r,
        domNode: e.current,
        isSelectable: s,
        nodeId: i,
        nodeClickDistance: a
      }), () => {
        var b;
        (b = h.current) == null || b.destroy();
      };
  }, [n, r, t, s, e, i]), d;
}
const mxe = (e) => (t) => t.selected && (t.draggable || e && typeof t.draggable > "u");
function Kq() {
  const e = br();
  return I.useCallback((n) => {
    const { nodeExtent: r, snapToGrid: i, snapGrid: s, nodesDraggable: a, onError: u, updateNodePositions: d, nodeLookup: f, nodeOrigin: h } = e.getState(), m = /* @__PURE__ */ new Map(), x = mxe(a), b = i ? s[0] : 5, w = i ? s[1] : 5, S = n.direction.x * b * n.factor, C = n.direction.y * w * n.factor;
    for (const [, T] of f) {
      if (!x(T))
        continue;
      let R = {
        x: T.internals.positionAbsolute.x + S,
        y: T.internals.positionAbsolute.y + C
      };
      i && (R = hx(R, s));
      const { position: N, positionAbsolute: M } = fq({
        nodeId: T.id,
        nextPosition: R,
        nodeLookup: f,
        nodeExtent: r,
        nodeOrigin: h,
        onError: u
      });
      T.position = N, T.internals.positionAbsolute = M, m.set(T.id, T);
    }
    d(m);
  }, []);
}
const Yq = I.createContext(null), gxe = Yq.Provider, Wq = () => I.useContext(Yq), yxe = (e) => ({
  connectOnClick: e.connectOnClick,
  noPanClassName: e.noPanClassName,
  rfId: e.rfId
}), xxe = (e, t, n) => (r) => {
  const { connectionClickStartHandle: i, connectionMode: s, connection: a } = r, { fromHandle: u, toHandle: d, isValid: f } = a, h = (d == null ? void 0 : d.nodeId) === e && (d == null ? void 0 : d.id) === t && (d == null ? void 0 : d.type) === n;
  return {
    connectingFrom: (u == null ? void 0 : u.nodeId) === e && (u == null ? void 0 : u.id) === t && (u == null ? void 0 : u.type) === n,
    connectingTo: h,
    clickConnecting: (i == null ? void 0 : i.nodeId) === e && (i == null ? void 0 : i.id) === t && (i == null ? void 0 : i.type) === n,
    isPossibleEndHandle: s === Bm.Strict ? (u == null ? void 0 : u.type) !== n : e !== (u == null ? void 0 : u.nodeId) || t !== (u == null ? void 0 : u.id),
    connectionInProcess: !!u,
    clickConnectionInProcess: !!i,
    valid: h && f
  };
};
function vxe({ type: e = "source", position: t = wt.Top, isValidConnection: n, isConnectable: r = !0, isConnectableStart: i = !0, isConnectableEnd: s = !0, id: a, onConnect: u, children: d, className: f, onMouseDown: h, onTouchStart: m, ...x }, b) {
  var oe, X;
  const w = a || null, S = e === "target", C = br(), T = Wq(), { connectOnClick: R, noPanClassName: N, rfId: M } = hn(yxe, xr), { connectingFrom: P, connectingTo: D, clickConnecting: q, isPossibleEndHandle: Y, connectionInProcess: te, clickConnectionInProcess: V, valid: $ } = hn(xxe(T, w, e), xr);
  T || (X = (oe = C.getState()).onError) == null || X.call(oe, "010", su.error010());
  const G = (ce) => {
    const { defaultEdgeOptions: pe, onConnect: de, hasDefaultEdges: H } = C.getState(), J = {
      ...pe,
      ...ce
    };
    if (H) {
      const { edges: ge, setEdges: Q } = C.getState();
      Q(K0e(J, ge));
    }
    de == null || de(J), u == null || u(J);
  }, le = (ce) => {
    if (!T)
      return;
    const pe = bq(ce.nativeEvent);
    if (i && (pe && ce.button === 0 || !pe)) {
      const de = C.getState();
      $5.onPointerDown(ce.nativeEvent, {
        handleDomNode: ce.currentTarget,
        autoPanOnConnect: de.autoPanOnConnect,
        connectionMode: de.connectionMode,
        connectionRadius: de.connectionRadius,
        domNode: de.domNode,
        nodeLookup: de.nodeLookup,
        lib: de.lib,
        isTarget: S,
        handleId: w,
        nodeId: T,
        flowId: de.rfId,
        panBy: de.panBy,
        cancelConnection: de.cancelConnection,
        onConnectStart: de.onConnectStart,
        onConnectEnd: de.onConnectEnd,
        updateConnection: de.updateConnection,
        onConnect: G,
        isValidConnection: n || de.isValidConnection,
        getTransform: () => C.getState().transform,
        getFromHandle: () => C.getState().connection.fromHandle,
        autoPanSpeed: de.autoPanSpeed,
        dragThreshold: de.connectionDragThreshold
      });
    }
    pe ? h == null || h(ce) : m == null || m(ce);
  }, Z = (ce) => {
    const { onClickConnectStart: pe, onClickConnectEnd: de, connectionClickStartHandle: H, connectionMode: J, isValidConnection: ge, lib: Q, rfId: fe, nodeLookup: ve, connection: Se } = C.getState();
    if (!T || !H && !i)
      return;
    if (!H) {
      pe == null || pe(ce.nativeEvent, { nodeId: T, handleId: w, handleType: e }), C.setState({ connectionClickStartHandle: { nodeId: T, type: e, id: w } });
      return;
    }
    const Me = xq(ce.target), Ie = n || ge, { connection: Re, isValid: mt } = $5.isValid(ce.nativeEvent, {
      handle: {
        nodeId: T,
        id: w,
        type: e
      },
      connectionMode: J,
      fromNodeId: H.nodeId,
      fromHandleId: H.id || null,
      fromType: H.type,
      isValidConnection: Ie,
      flowId: fe,
      doc: Me,
      lib: Q,
      nodeLookup: ve
    });
    mt && Re && G(Re);
    const dt = structuredClone(Se);
    delete dt.inProgress, dt.toPosition = dt.toHandle ? dt.toHandle.position : null, de == null || de(ce, dt), C.setState({ connectionClickStartHandle: null });
  };
  return c.jsx("div", { "data-handleid": w, "data-nodeid": T, "data-handlepos": t, "data-id": `${M}-${T}-${w}-${e}`, className: ii([
    "react-flow__handle",
    `react-flow__handle-${t}`,
    "nodrag",
    N,
    f,
    {
      source: !S,
      target: S,
      connectable: r,
      connectablestart: i,
      connectableend: s,
      clickconnecting: q,
      connectingfrom: P,
      connectingto: D,
      valid: $,
      /*
       * shows where you can start a connection from
       * and where you can end it while connecting
       */
      connectionindicator: r && (!te || Y) && (te || V ? s : i)
    }
  ]), onMouseDown: le, onTouchStart: le, onClick: R ? Z : void 0, ref: b, ...x, children: d });
}
const as = I.memo(Hq(vxe));
function bxe({ data: e, isConnectable: t, sourcePosition: n = wt.Bottom }) {
  return c.jsxs(c.Fragment, { children: [e == null ? void 0 : e.label, c.jsx(as, { type: "source", position: n, isConnectable: t })] });
}
function wxe({ data: e, isConnectable: t, targetPosition: n = wt.Top, sourcePosition: r = wt.Bottom }) {
  return c.jsxs(c.Fragment, { children: [c.jsx(as, { type: "target", position: n, isConnectable: t }), e == null ? void 0 : e.label, c.jsx(as, { type: "source", position: r, isConnectable: t })] });
}
function _xe() {
  return null;
}
function Sxe({ data: e, isConnectable: t, targetPosition: n = wt.Top }) {
  return c.jsxs(c.Fragment, { children: [c.jsx(as, { type: "target", position: n, isConnectable: t }), e == null ? void 0 : e.label] });
}
const Ib = {
  ArrowUp: { x: 0, y: -1 },
  ArrowDown: { x: 0, y: 1 },
  ArrowLeft: { x: -1, y: 0 },
  ArrowRight: { x: 1, y: 0 }
}, OR = {
  input: bxe,
  default: wxe,
  output: Sxe,
  group: _xe
};
function Exe(e) {
  var t, n, r, i;
  return e.internals.handleBounds === void 0 ? {
    width: e.width ?? e.initialWidth ?? ((t = e.style) == null ? void 0 : t.width),
    height: e.height ?? e.initialHeight ?? ((n = e.style) == null ? void 0 : n.height)
  } : {
    width: e.width ?? ((r = e.style) == null ? void 0 : r.width),
    height: e.height ?? ((i = e.style) == null ? void 0 : i.height)
  };
}
const Cxe = (e) => {
  const { width: t, height: n, x: r, y: i } = fx(e.nodeLookup, {
    filter: (s) => !!s.selected
  });
  return {
    width: tl(t) ? t : null,
    height: tl(n) ? n : null,
    userSelectionActive: e.userSelectionActive,
    transformString: `translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${r}px,${i}px)`
  };
};
function kxe({ onSelectionContextMenu: e, noPanClassName: t, disableKeyboardA11y: n }) {
  const r = br(), { width: i, height: s, transformString: a, userSelectionActive: u } = hn(Cxe, xr), d = Kq(), f = I.useRef(null);
  if (I.useEffect(() => {
    var x;
    n || (x = f.current) == null || x.focus({
      preventScroll: !0
    });
  }, [n]), Gq({
    nodeRef: f
  }), u || !i || !s)
    return null;
  const h = e ? (x) => {
    const b = r.getState().nodes.filter((w) => w.selected);
    e(x, b);
  } : void 0, m = (x) => {
    Object.prototype.hasOwnProperty.call(Ib, x.key) && (x.preventDefault(), d({
      direction: Ib[x.key],
      factor: x.shiftKey ? 4 : 1
    }));
  };
  return c.jsx("div", { className: ii(["react-flow__nodesselection", "react-flow__container", t]), style: {
    transform: a
  }, children: c.jsx("div", { ref: f, className: "react-flow__nodesselection-rect", onContextMenu: h, tabIndex: n ? void 0 : -1, onKeyDown: n ? void 0 : m, style: {
    width: i,
    height: s
  } }) });
}
const DR = typeof window < "u" ? window : void 0, Txe = (e) => ({ nodesSelectionActive: e.nodesSelectionActive, userSelectionActive: e.userSelectionActive });
function Zq({ children: e, onPaneClick: t, onPaneMouseEnter: n, onPaneMouseMove: r, onPaneMouseLeave: i, onPaneContextMenu: s, onPaneScroll: a, paneClickDistance: u, deleteKeyCode: d, selectionKeyCode: f, selectionOnDrag: h, selectionMode: m, onSelectionStart: x, onSelectionEnd: b, multiSelectionKeyCode: w, panActivationKeyCode: S, zoomActivationKeyCode: C, elementsSelectable: T, zoomOnScroll: R, zoomOnPinch: N, panOnScroll: M, panOnScrollSpeed: P, panOnScrollMode: D, zoomOnDoubleClick: q, panOnDrag: Y, defaultViewport: te, translateExtent: V, minZoom: $, maxZoom: G, preventScrolling: le, onSelectionContextMenu: Z, noWheelClassName: oe, noPanClassName: X, disableKeyboardA11y: ce, onViewportChange: pe, isControlledViewport: de }) {
  const { nodesSelectionActive: H, userSelectionActive: J } = hn(Txe, xr), ge = Vy(f, { target: DR }), Q = Vy(S, { target: DR }), fe = Q || Y, ve = Q || M, Se = h && fe !== !0, Me = ge || J || Se;
  return oxe({ deleteKeyCode: d, multiSelectionKeyCode: w }), c.jsx(cxe, { onPaneContextMenu: s, elementsSelectable: T, zoomOnScroll: R, zoomOnPinch: N, panOnScroll: ve, panOnScrollSpeed: P, panOnScrollMode: D, zoomOnDoubleClick: q, panOnDrag: !ge && fe, defaultViewport: te, translateExtent: V, minZoom: $, maxZoom: G, zoomActivationKeyCode: C, preventScrolling: le, noWheelClassName: oe, noPanClassName: X, onViewportChange: pe, isControlledViewport: de, paneClickDistance: u, selectionOnDrag: Se, children: c.jsxs(pxe, { onSelectionStart: x, onSelectionEnd: b, onPaneClick: t, onPaneMouseEnter: n, onPaneMouseMove: r, onPaneMouseLeave: i, onPaneContextMenu: s, onPaneScroll: a, panOnDrag: fe, isSelecting: !!Me, selectionMode: m, selectionKeyPressed: ge, paneClickDistance: u, selectionOnDrag: Se, children: [e, H && c.jsx(kxe, { onSelectionContextMenu: Z, noPanClassName: X, disableKeyboardA11y: ce })] }) });
}
Zq.displayName = "FlowRenderer";
const jxe = I.memo(Zq), Axe = (e) => (t) => e ? Tj(t.nodeLookup, { x: 0, y: 0, width: t.width, height: t.height }, t.transform, !0).map((n) => n.id) : Array.from(t.nodeLookup.keys());
function Nxe(e) {
  return hn(I.useCallback(Axe(e), [e]), xr);
}
const Rxe = (e) => e.updateNodeInternals;
function Mxe() {
  const e = hn(Rxe), [t] = I.useState(() => typeof ResizeObserver > "u" ? null : new ResizeObserver((n) => {
    const r = /* @__PURE__ */ new Map();
    n.forEach((i) => {
      const s = i.target.getAttribute("data-id");
      r.set(s, {
        id: s,
        nodeElement: i.target,
        force: !0
      });
    }), e(r);
  }));
  return I.useEffect(() => () => {
    t == null || t.disconnect();
  }, [t]), t;
}
function Oxe({ node: e, nodeType: t, hasDimensions: n, resizeObserver: r }) {
  const i = br(), s = I.useRef(null), a = I.useRef(null), u = I.useRef(e.sourcePosition), d = I.useRef(e.targetPosition), f = I.useRef(t), h = n && !!e.internals.handleBounds;
  return I.useEffect(() => {
    s.current && !e.hidden && (!h || a.current !== s.current) && (a.current && (r == null || r.unobserve(a.current)), r == null || r.observe(s.current), a.current = s.current);
  }, [h, e.hidden]), I.useEffect(() => () => {
    a.current && (r == null || r.unobserve(a.current), a.current = null);
  }, []), I.useEffect(() => {
    if (s.current) {
      const m = f.current !== t, x = u.current !== e.sourcePosition, b = d.current !== e.targetPosition;
      (m || x || b) && (f.current = t, u.current = e.sourcePosition, d.current = e.targetPosition, i.getState().updateNodeInternals(/* @__PURE__ */ new Map([[e.id, { id: e.id, nodeElement: s.current, force: !0 }]])));
    }
  }, [e.id, t, e.sourcePosition, e.targetPosition]), s;
}
function Dxe({ id: e, onClick: t, onMouseEnter: n, onMouseMove: r, onMouseLeave: i, onContextMenu: s, onDoubleClick: a, nodesDraggable: u, elementsSelectable: d, nodesConnectable: f, nodesFocusable: h, resizeObserver: m, noDragClassName: x, noPanClassName: b, disableKeyboardA11y: w, rfId: S, nodeTypes: C, nodeClickDistance: T, onError: R }) {
  const { node: N, internals: M, isParent: P } = hn((Ie) => {
    const Re = Ie.nodeLookup.get(e), mt = Ie.parentLookup.has(e);
    return {
      node: Re,
      internals: Re.internals,
      isParent: mt
    };
  }, xr);
  let D = N.type || "default", q = (C == null ? void 0 : C[D]) || OR[D];
  q === void 0 && (R == null || R("003", su.error003(D)), D = "default", q = (C == null ? void 0 : C.default) || OR.default);
  const Y = !!(N.draggable || u && typeof N.draggable > "u"), te = !!(N.selectable || d && typeof N.selectable > "u"), V = !!(N.connectable || f && typeof N.connectable > "u"), $ = !!(N.focusable || h && typeof N.focusable > "u"), G = br(), le = gq(N), Z = Oxe({ node: N, nodeType: D, hasDimensions: le, resizeObserver: m }), oe = Gq({
    nodeRef: Z,
    disabled: N.hidden || !Y,
    noDragClassName: x,
    handleSelector: N.dragHandle,
    nodeId: e,
    isSelectable: te,
    nodeClickDistance: T
  }), X = Kq();
  if (N.hidden)
    return null;
  const ce = sc(N), pe = Exe(N), de = te || Y || t || n || r || i, H = n ? (Ie) => n(Ie, { ...M.userNode }) : void 0, J = r ? (Ie) => r(Ie, { ...M.userNode }) : void 0, ge = i ? (Ie) => i(Ie, { ...M.userNode }) : void 0, Q = s ? (Ie) => s(Ie, { ...M.userNode }) : void 0, fe = a ? (Ie) => a(Ie, { ...M.userNode }) : void 0, ve = (Ie) => {
    const { selectNodesOnDrag: Re, nodeDragThreshold: mt } = G.getState();
    te && (!Re || !Y || mt > 0) && q5({
      id: e,
      store: G,
      nodeRef: Z
    }), t && t(Ie, { ...M.userNode });
  }, Se = (Ie) => {
    if (!(vq(Ie.nativeEvent) || w)) {
      if (oq.includes(Ie.key) && te) {
        const Re = Ie.key === "Escape";
        q5({
          id: e,
          store: G,
          unselect: Re,
          nodeRef: Z
        });
      } else if (Y && N.selected && Object.prototype.hasOwnProperty.call(Ib, Ie.key)) {
        Ie.preventDefault();
        const { ariaLabelConfig: Re } = G.getState();
        G.setState({
          ariaLiveMessage: Re["node.a11yDescription.ariaLiveMessage"]({
            direction: Ie.key.replace("Arrow", "").toLowerCase(),
            x: ~~M.positionAbsolute.x,
            y: ~~M.positionAbsolute.y
          })
        }), X({
          direction: Ib[Ie.key],
          factor: Ie.shiftKey ? 4 : 1
        });
      }
    }
  }, Me = () => {
    var yt;
    if (w || !((yt = Z.current) != null && yt.matches(":focus-visible")))
      return;
    const { transform: Ie, width: Re, height: mt, autoPanOnNodeFocus: dt, setCenter: Je } = G.getState();
    if (!dt)
      return;
    Tj(/* @__PURE__ */ new Map([[e, N]]), { x: 0, y: 0, width: Re, height: mt }, Ie, !0).length > 0 || Je(N.position.x + ce.width / 2, N.position.y + ce.height / 2, {
      zoom: Ie[2]
    });
  };
  return c.jsx("div", { className: ii([
    "react-flow__node",
    `react-flow__node-${D}`,
    {
      // this is overwritable by passing `nopan` as a class name
      [b]: Y
    },
    N.className,
    {
      selected: N.selected,
      selectable: te,
      parent: P,
      draggable: Y,
      dragging: oe
    }
  ]), ref: Z, style: {
    zIndex: M.z,
    transform: `translate(${M.positionAbsolute.x}px,${M.positionAbsolute.y}px)`,
    pointerEvents: de ? "all" : "none",
    visibility: le ? "visible" : "hidden",
    ...N.style,
    ...pe
  }, "data-id": e, "data-testid": `rf__node-${e}`, onMouseEnter: H, onMouseMove: J, onMouseLeave: ge, onContextMenu: Q, onClick: ve, onDoubleClick: fe, onKeyDown: $ ? Se : void 0, tabIndex: $ ? 0 : void 0, onFocus: $ ? Me : void 0, role: N.ariaRole ?? ($ ? "group" : void 0), "aria-roledescription": "node", "aria-describedby": w ? void 0 : `${Lq}-${S}`, "aria-label": N.ariaLabel, ...N.domAttributes, children: c.jsx(gxe, { value: e, children: c.jsx(q, { id: e, data: N.data, type: D, positionAbsoluteX: M.positionAbsolute.x, positionAbsoluteY: M.positionAbsolute.y, selected: N.selected ?? !1, selectable: te, draggable: Y, deletable: N.deletable ?? !0, isConnectable: V, sourcePosition: N.sourcePosition, targetPosition: N.targetPosition, dragging: oe, dragHandle: N.dragHandle, zIndex: M.z, parentId: N.parentId, ...ce }) }) });
}
var zxe = I.memo(Dxe);
const Pxe = (e) => ({
  nodesDraggable: e.nodesDraggable,
  nodesConnectable: e.nodesConnectable,
  nodesFocusable: e.nodesFocusable,
  elementsSelectable: e.elementsSelectable,
  onError: e.onError
});
function Xq(e) {
  const { nodesDraggable: t, nodesConnectable: n, nodesFocusable: r, elementsSelectable: i, onError: s } = hn(Pxe, xr), a = Nxe(e.onlyRenderVisibleElements), u = Mxe();
  return c.jsx("div", { className: "react-flow__nodes", style: Ew, children: a.map((d) => (
    /*
     * The split of responsibilities between NodeRenderer and
     * NodeComponentWrapper may appear weird. However, its designed to
     * minimize the cost of updates when individual nodes change.
     *
     * For example, when youre dragging a single node, that node gets
     * updated multiple times per second. If `NodeRenderer` were to update
     * every time, it would have to re-run the `nodes.map()` loop every
     * time. This gets pricey with hundreds of nodes, especially if every
     * loop cycle does more than just rendering a JSX element!
     *
     * As a result of this choice, we took the following implementation
     * decisions:
     * - NodeRenderer subscribes *only* to node IDs  and therefore
     *   rerender *only* when visible nodes are added or removed.
     * - NodeRenderer performs all operations the result of which can be
     *   shared between nodes (such as creating the `ResizeObserver`
     *   instance, or subscribing to `selector`). This means extra prop
     *   drilling into `NodeComponentWrapper`, but it means we need to run
     *   these operations only once  instead of once per node.
     * - Any operations that youd normally write inside `nodes.map` are
     *   moved into `NodeComponentWrapper`. This ensures they are
     *   memorized  so if `NodeRenderer` *has* to rerender, it only
     *   needs to regenerate the list of nodes, nothing else.
     */
    c.jsx(zxe, { id: d, nodeTypes: e.nodeTypes, nodeExtent: e.nodeExtent, onClick: e.onNodeClick, onMouseEnter: e.onNodeMouseEnter, onMouseMove: e.onNodeMouseMove, onMouseLeave: e.onNodeMouseLeave, onContextMenu: e.onNodeContextMenu, onDoubleClick: e.onNodeDoubleClick, noDragClassName: e.noDragClassName, noPanClassName: e.noPanClassName, rfId: e.rfId, disableKeyboardA11y: e.disableKeyboardA11y, resizeObserver: u, nodesDraggable: t, nodesConnectable: n, nodesFocusable: r, elementsSelectable: i, nodeClickDistance: e.nodeClickDistance, onError: s }, d)
  )) });
}
Xq.displayName = "NodeRenderer";
const Ixe = I.memo(Xq);
function Lxe(e) {
  return hn(I.useCallback((n) => {
    if (!e)
      return n.edges.map((i) => i.id);
    const r = [];
    if (n.width && n.height)
      for (const i of n.edges) {
        const s = n.nodeLookup.get(i.source), a = n.nodeLookup.get(i.target);
        s && a && H0e({
          sourceNode: s,
          targetNode: a,
          width: n.width,
          height: n.height,
          transform: n.transform
        }) && r.push(i.id);
      }
    return r;
  }, [e]), xr);
}
const Bxe = ({ color: e = "none", strokeWidth: t = 1 }) => {
  const n = {
    strokeWidth: t,
    ...e && { stroke: e }
  };
  return c.jsx("polyline", { className: "arrow", style: n, strokeLinecap: "round", fill: "none", strokeLinejoin: "round", points: "-5,-4 0,0 -5,4" });
}, $xe = ({ color: e = "none", strokeWidth: t = 1 }) => {
  const n = {
    strokeWidth: t,
    ...e && { stroke: e, fill: e }
  };
  return c.jsx("polyline", { className: "arrowclosed", style: n, strokeLinecap: "round", strokeLinejoin: "round", points: "-5,-4 0,0 -5,4 -5,-4" });
}, zR = {
  [Fy.Arrow]: Bxe,
  [Fy.ArrowClosed]: $xe
};
function qxe(e) {
  const t = br();
  return I.useMemo(() => {
    var i, s;
    return Object.prototype.hasOwnProperty.call(zR, e) ? zR[e] : ((s = (i = t.getState()).onError) == null || s.call(i, "009", su.error009(e)), null);
  }, [e]);
}
const Fxe = ({ id: e, type: t, color: n, width: r = 12.5, height: i = 12.5, markerUnits: s = "strokeWidth", strokeWidth: a, orient: u = "auto-start-reverse" }) => {
  const d = qxe(t);
  return d ? c.jsx("marker", { className: "react-flow__arrowhead", id: e, markerWidth: `${r}`, markerHeight: `${i}`, viewBox: "-10 -10 20 20", markerUnits: s, orient: u, refX: "0", refY: "0", children: c.jsx(d, { color: n, strokeWidth: a }) }) : null;
}, Qq = ({ defaultColor: e, rfId: t }) => {
  const n = hn((s) => s.edges), r = hn((s) => s.defaultEdgeOptions), i = I.useMemo(() => Q0e(n, {
    id: t,
    defaultColor: e,
    defaultMarkerStart: r == null ? void 0 : r.markerStart,
    defaultMarkerEnd: r == null ? void 0 : r.markerEnd
  }), [n, r, t, e]);
  return i.length ? c.jsx("svg", { className: "react-flow__marker", "aria-hidden": "true", children: c.jsx("defs", { children: i.map((s) => c.jsx(Fxe, { id: s.id, type: s.type, color: s.color, width: s.width, height: s.height, markerUnits: s.markerUnits, strokeWidth: s.strokeWidth, orient: s.orient }, s.id)) }) }) : null;
};
Qq.displayName = "MarkerDefinitions";
var Uxe = I.memo(Qq);
function Jq({ x: e, y: t, label: n, labelStyle: r, labelShowBg: i = !0, labelBgStyle: s, labelBgPadding: a = [2, 4], labelBgBorderRadius: u = 2, children: d, className: f, ...h }) {
  const [m, x] = I.useState({ x: 1, y: 0, width: 0, height: 0 }), b = ii(["react-flow__edge-textwrapper", f]), w = I.useRef(null);
  return I.useEffect(() => {
    if (w.current) {
      const S = w.current.getBBox();
      x({
        x: S.x,
        y: S.y,
        width: S.width,
        height: S.height
      });
    }
  }, [n]), n ? c.jsxs("g", { transform: `translate(${e - m.width / 2} ${t - m.height / 2})`, className: b, visibility: m.width ? "visible" : "hidden", ...h, children: [i && c.jsx("rect", { width: m.width + 2 * a[0], x: -a[0], y: -a[1], height: m.height + 2 * a[1], className: "react-flow__edge-textbg", style: s, rx: u, ry: u }), c.jsx("text", { className: "react-flow__edge-text", y: m.height / 2, dy: "0.3em", ref: w, style: r, children: n }), d] }) : null;
}
Jq.displayName = "EdgeText";
const Hxe = I.memo(Jq);
function Cw({ path: e, labelX: t, labelY: n, label: r, labelStyle: i, labelShowBg: s, labelBgStyle: a, labelBgPadding: u, labelBgBorderRadius: d, interactionWidth: f = 20, ...h }) {
  return c.jsxs(c.Fragment, { children: [c.jsx("path", { ...h, d: e, fill: "none", className: ii(["react-flow__edge-path", h.className]) }), f ? c.jsx("path", { d: e, fill: "none", strokeOpacity: 0, strokeWidth: f, className: "react-flow__edge-interaction" }) : null, r && tl(t) && tl(n) ? c.jsx(Hxe, { x: t, y: n, label: r, labelStyle: i, labelShowBg: s, labelBgStyle: a, labelBgPadding: u, labelBgBorderRadius: d }) : null] });
}
function PR({ pos: e, x1: t, y1: n, x2: r, y2: i }) {
  return e === wt.Left || e === wt.Right ? [0.5 * (t + r), n] : [t, 0.5 * (n + i)];
}
function eF({ sourceX: e, sourceY: t, sourcePosition: n = wt.Bottom, targetX: r, targetY: i, targetPosition: s = wt.Top }) {
  const [a, u] = PR({
    pos: n,
    x1: e,
    y1: t,
    x2: r,
    y2: i
  }), [d, f] = PR({
    pos: s,
    x1: r,
    y1: i,
    x2: e,
    y2: t
  }), [h, m, x, b] = wq({
    sourceX: e,
    sourceY: t,
    targetX: r,
    targetY: i,
    sourceControlX: a,
    sourceControlY: u,
    targetControlX: d,
    targetControlY: f
  });
  return [
    `M${e},${t} C${a},${u} ${d},${f} ${r},${i}`,
    h,
    m,
    x,
    b
  ];
}
function tF(e) {
  return I.memo(({ id: t, sourceX: n, sourceY: r, targetX: i, targetY: s, sourcePosition: a, targetPosition: u, label: d, labelStyle: f, labelShowBg: h, labelBgStyle: m, labelBgPadding: x, labelBgBorderRadius: b, style: w, markerEnd: S, markerStart: C, interactionWidth: T }) => {
    const [R, N, M] = eF({
      sourceX: n,
      sourceY: r,
      sourcePosition: a,
      targetX: i,
      targetY: s,
      targetPosition: u
    }), P = e.isInternal ? void 0 : t;
    return c.jsx(Cw, { id: P, path: R, labelX: N, labelY: M, label: d, labelStyle: f, labelShowBg: h, labelBgStyle: m, labelBgPadding: x, labelBgBorderRadius: b, style: w, markerEnd: S, markerStart: C, interactionWidth: T });
  });
}
const Vxe = tF({ isInternal: !1 }), nF = tF({ isInternal: !0 });
Vxe.displayName = "SimpleBezierEdge";
nF.displayName = "SimpleBezierEdgeInternal";
function rF(e) {
  return I.memo(({ id: t, sourceX: n, sourceY: r, targetX: i, targetY: s, label: a, labelStyle: u, labelShowBg: d, labelBgStyle: f, labelBgPadding: h, labelBgBorderRadius: m, style: x, sourcePosition: b = wt.Bottom, targetPosition: w = wt.Top, markerEnd: S, markerStart: C, pathOptions: T, interactionWidth: R }) => {
    const [N, M, P] = I5({
      sourceX: n,
      sourceY: r,
      sourcePosition: b,
      targetX: i,
      targetY: s,
      targetPosition: w,
      borderRadius: T == null ? void 0 : T.borderRadius,
      offset: T == null ? void 0 : T.offset,
      stepPosition: T == null ? void 0 : T.stepPosition
    }), D = e.isInternal ? void 0 : t;
    return c.jsx(Cw, { id: D, path: N, labelX: M, labelY: P, label: a, labelStyle: u, labelShowBg: d, labelBgStyle: f, labelBgPadding: h, labelBgBorderRadius: m, style: x, markerEnd: S, markerStart: C, interactionWidth: R });
  });
}
const iF = rF({ isInternal: !1 }), sF = rF({ isInternal: !0 });
iF.displayName = "SmoothStepEdge";
sF.displayName = "SmoothStepEdgeInternal";
function aF(e) {
  return I.memo(({ id: t, ...n }) => {
    var i;
    const r = e.isInternal ? void 0 : t;
    return c.jsx(iF, { ...n, id: r, pathOptions: I.useMemo(() => {
      var s;
      return { borderRadius: 0, offset: (s = n.pathOptions) == null ? void 0 : s.offset };
    }, [(i = n.pathOptions) == null ? void 0 : i.offset]) });
  });
}
const Gxe = aF({ isInternal: !1 }), oF = aF({ isInternal: !0 });
Gxe.displayName = "StepEdge";
oF.displayName = "StepEdgeInternal";
function lF(e) {
  return I.memo(({ id: t, sourceX: n, sourceY: r, targetX: i, targetY: s, label: a, labelStyle: u, labelShowBg: d, labelBgStyle: f, labelBgPadding: h, labelBgBorderRadius: m, style: x, markerEnd: b, markerStart: w, interactionWidth: S }) => {
    const [C, T, R] = Eq({ sourceX: n, sourceY: r, targetX: i, targetY: s }), N = e.isInternal ? void 0 : t;
    return c.jsx(Cw, { id: N, path: C, labelX: T, labelY: R, label: a, labelStyle: u, labelShowBg: d, labelBgStyle: f, labelBgPadding: h, labelBgBorderRadius: m, style: x, markerEnd: b, markerStart: w, interactionWidth: S });
  });
}
const Kxe = lF({ isInternal: !1 }), uF = lF({ isInternal: !0 });
Kxe.displayName = "StraightEdge";
uF.displayName = "StraightEdgeInternal";
function cF(e) {
  return I.memo(({ id: t, sourceX: n, sourceY: r, targetX: i, targetY: s, sourcePosition: a = wt.Bottom, targetPosition: u = wt.Top, label: d, labelStyle: f, labelShowBg: h, labelBgStyle: m, labelBgPadding: x, labelBgBorderRadius: b, style: w, markerEnd: S, markerStart: C, pathOptions: T, interactionWidth: R }) => {
    const [N, M, P] = _q({
      sourceX: n,
      sourceY: r,
      sourcePosition: a,
      targetX: i,
      targetY: s,
      targetPosition: u,
      curvature: T == null ? void 0 : T.curvature
    }), D = e.isInternal ? void 0 : t;
    return c.jsx(Cw, { id: D, path: N, labelX: M, labelY: P, label: d, labelStyle: f, labelShowBg: h, labelBgStyle: m, labelBgPadding: x, labelBgBorderRadius: b, style: w, markerEnd: S, markerStart: C, interactionWidth: R });
  });
}
const Yxe = cF({ isInternal: !1 }), dF = cF({ isInternal: !0 });
Yxe.displayName = "BezierEdge";
dF.displayName = "BezierEdgeInternal";
const IR = {
  default: dF,
  straight: uF,
  step: oF,
  smoothstep: sF,
  simplebezier: nF
}, LR = {
  sourceX: null,
  sourceY: null,
  targetX: null,
  targetY: null,
  sourcePosition: null,
  targetPosition: null
}, Wxe = (e, t, n) => n === wt.Left ? e - t : n === wt.Right ? e + t : e, Zxe = (e, t, n) => n === wt.Top ? e - t : n === wt.Bottom ? e + t : e, BR = "react-flow__edgeupdater";
function $R({ position: e, centerX: t, centerY: n, radius: r = 10, onMouseDown: i, onMouseEnter: s, onMouseOut: a, type: u }) {
  return c.jsx("circle", { onMouseDown: i, onMouseEnter: s, onMouseOut: a, className: ii([BR, `${BR}-${u}`]), cx: Wxe(t, r, e), cy: Zxe(n, r, e), r, stroke: "transparent", fill: "transparent" });
}
function Xxe({ isReconnectable: e, reconnectRadius: t, edge: n, sourceX: r, sourceY: i, targetX: s, targetY: a, sourcePosition: u, targetPosition: d, onReconnect: f, onReconnectStart: h, onReconnectEnd: m, setReconnecting: x, setUpdateHover: b }) {
  const w = br(), S = (M, P) => {
    if (M.button !== 0)
      return;
    const { autoPanOnConnect: D, domNode: q, isValidConnection: Y, connectionMode: te, connectionRadius: V, lib: $, onConnectStart: G, onConnectEnd: le, cancelConnection: Z, nodeLookup: oe, rfId: X, panBy: ce, updateConnection: pe } = w.getState(), de = P.type === "target", H = (Q, fe) => {
      x(!1), m == null || m(Q, n, P.type, fe);
    }, J = (Q) => f == null ? void 0 : f(n, Q), ge = (Q, fe) => {
      x(!0), h == null || h(M, n, P.type), G == null || G(Q, fe);
    };
    $5.onPointerDown(M.nativeEvent, {
      autoPanOnConnect: D,
      connectionMode: te,
      connectionRadius: V,
      domNode: q,
      handleId: P.id,
      nodeId: P.nodeId,
      nodeLookup: oe,
      isTarget: de,
      edgeUpdaterType: P.type,
      lib: $,
      flowId: X,
      cancelConnection: Z,
      panBy: ce,
      isValidConnection: Y,
      onConnect: J,
      onConnectStart: ge,
      onConnectEnd: le,
      onReconnectEnd: H,
      updateConnection: pe,
      getTransform: () => w.getState().transform,
      getFromHandle: () => w.getState().connection.fromHandle,
      dragThreshold: w.getState().connectionDragThreshold,
      handleDomNode: M.currentTarget
    });
  }, C = (M) => S(M, { nodeId: n.target, id: n.targetHandle ?? null, type: "target" }), T = (M) => S(M, { nodeId: n.source, id: n.sourceHandle ?? null, type: "source" }), R = () => b(!0), N = () => b(!1);
  return c.jsxs(c.Fragment, { children: [(e === !0 || e === "source") && c.jsx($R, { position: u, centerX: r, centerY: i, radius: t, onMouseDown: C, onMouseEnter: R, onMouseOut: N, type: "source" }), (e === !0 || e === "target") && c.jsx($R, { position: d, centerX: s, centerY: a, radius: t, onMouseDown: T, onMouseEnter: R, onMouseOut: N, type: "target" })] });
}
function Qxe({ id: e, edgesFocusable: t, edgesReconnectable: n, elementsSelectable: r, onClick: i, onDoubleClick: s, onContextMenu: a, onMouseEnter: u, onMouseMove: d, onMouseLeave: f, reconnectRadius: h, onReconnect: m, onReconnectStart: x, onReconnectEnd: b, rfId: w, edgeTypes: S, noPanClassName: C, onError: T, disableKeyboardA11y: R }) {
  let N = hn((Je) => Je.edgeLookup.get(e));
  const M = hn((Je) => Je.defaultEdgeOptions);
  N = M ? { ...M, ...N } : N;
  let P = N.type || "default", D = (S == null ? void 0 : S[P]) || IR[P];
  D === void 0 && (T == null || T("011", su.error011(P)), P = "default", D = (S == null ? void 0 : S.default) || IR.default);
  const q = !!(N.focusable || t && typeof N.focusable > "u"), Y = typeof m < "u" && (N.reconnectable || n && typeof N.reconnectable > "u"), te = !!(N.selectable || r && typeof N.selectable > "u"), V = I.useRef(null), [$, G] = I.useState(!1), [le, Z] = I.useState(!1), oe = br(), { zIndex: X, sourceX: ce, sourceY: pe, targetX: de, targetY: H, sourcePosition: J, targetPosition: ge } = hn(I.useCallback((Je) => {
    const ft = Je.nodeLookup.get(N.source), yt = Je.nodeLookup.get(N.target);
    if (!ft || !yt)
      return {
        zIndex: N.zIndex,
        ...LR
      };
    const ht = X0e({
      id: e,
      sourceNode: ft,
      targetNode: yt,
      sourceHandle: N.sourceHandle || null,
      targetHandle: N.targetHandle || null,
      connectionMode: Je.connectionMode,
      onError: T
    });
    return {
      zIndex: U0e({
        selected: N.selected,
        zIndex: N.zIndex,
        sourceNode: ft,
        targetNode: yt,
        elevateOnSelect: Je.elevateEdgesOnSelect,
        zIndexMode: Je.zIndexMode
      }),
      ...ht || LR
    };
  }, [N.source, N.target, N.sourceHandle, N.targetHandle, N.selected, N.zIndex]), xr), Q = I.useMemo(() => N.markerStart ? `url('#${L5(N.markerStart, w)}')` : void 0, [N.markerStart, w]), fe = I.useMemo(() => N.markerEnd ? `url('#${L5(N.markerEnd, w)}')` : void 0, [N.markerEnd, w]);
  if (N.hidden || ce === null || pe === null || de === null || H === null)
    return null;
  const ve = (Je) => {
    var Le;
    const { addSelectedEdges: ft, unselectNodesAndEdges: yt, multiSelectionActive: ht } = oe.getState();
    te && (oe.setState({ nodesSelectionActive: !1 }), N.selected && ht ? (yt({ nodes: [], edges: [N] }), (Le = V.current) == null || Le.blur()) : ft([e])), i && i(Je, N);
  }, Se = s ? (Je) => {
    s(Je, { ...N });
  } : void 0, Me = a ? (Je) => {
    a(Je, { ...N });
  } : void 0, Ie = u ? (Je) => {
    u(Je, { ...N });
  } : void 0, Re = d ? (Je) => {
    d(Je, { ...N });
  } : void 0, mt = f ? (Je) => {
    f(Je, { ...N });
  } : void 0, dt = (Je) => {
    var ft;
    if (!R && oq.includes(Je.key) && te) {
      const { unselectNodesAndEdges: yt, addSelectedEdges: ht } = oe.getState();
      Je.key === "Escape" ? ((ft = V.current) == null || ft.blur(), yt({ edges: [N] })) : ht([e]);
    }
  };
  return c.jsx("svg", { style: { zIndex: X }, children: c.jsxs("g", { className: ii([
    "react-flow__edge",
    `react-flow__edge-${P}`,
    N.className,
    C,
    {
      selected: N.selected,
      animated: N.animated,
      inactive: !te && !i,
      updating: $,
      selectable: te
    }
  ]), onClick: ve, onDoubleClick: Se, onContextMenu: Me, onMouseEnter: Ie, onMouseMove: Re, onMouseLeave: mt, onKeyDown: q ? dt : void 0, tabIndex: q ? 0 : void 0, role: N.ariaRole ?? (q ? "group" : "img"), "aria-roledescription": "edge", "data-id": e, "data-testid": `rf__edge-${e}`, "aria-label": N.ariaLabel === null ? void 0 : N.ariaLabel || `Edge from ${N.source} to ${N.target}`, "aria-describedby": q ? `${Bq}-${w}` : void 0, ref: V, ...N.domAttributes, children: [!le && c.jsx(D, { id: e, source: N.source, target: N.target, type: N.type, selected: N.selected, animated: N.animated, selectable: te, deletable: N.deletable ?? !0, label: N.label, labelStyle: N.labelStyle, labelShowBg: N.labelShowBg, labelBgStyle: N.labelBgStyle, labelBgPadding: N.labelBgPadding, labelBgBorderRadius: N.labelBgBorderRadius, sourceX: ce, sourceY: pe, targetX: de, targetY: H, sourcePosition: J, targetPosition: ge, data: N.data, style: N.style, sourceHandleId: N.sourceHandle, targetHandleId: N.targetHandle, markerStart: Q, markerEnd: fe, pathOptions: "pathOptions" in N ? N.pathOptions : void 0, interactionWidth: N.interactionWidth }), Y && c.jsx(Xxe, { edge: N, isReconnectable: Y, reconnectRadius: h, onReconnect: m, onReconnectStart: x, onReconnectEnd: b, sourceX: ce, sourceY: pe, targetX: de, targetY: H, sourcePosition: J, targetPosition: ge, setUpdateHover: G, setReconnecting: Z })] }) });
}
var Jxe = I.memo(Qxe);
const eve = (e) => ({
  edgesFocusable: e.edgesFocusable,
  edgesReconnectable: e.edgesReconnectable,
  elementsSelectable: e.elementsSelectable,
  connectionMode: e.connectionMode,
  onError: e.onError
});
function fF({ defaultMarkerColor: e, onlyRenderVisibleElements: t, rfId: n, edgeTypes: r, noPanClassName: i, onReconnect: s, onEdgeContextMenu: a, onEdgeMouseEnter: u, onEdgeMouseMove: d, onEdgeMouseLeave: f, onEdgeClick: h, reconnectRadius: m, onEdgeDoubleClick: x, onReconnectStart: b, onReconnectEnd: w, disableKeyboardA11y: S }) {
  const { edgesFocusable: C, edgesReconnectable: T, elementsSelectable: R, onError: N } = hn(eve, xr), M = Lxe(t);
  return c.jsxs("div", { className: "react-flow__edges", children: [c.jsx(Uxe, { defaultColor: e, rfId: n }), M.map((P) => c.jsx(Jxe, { id: P, edgesFocusable: C, edgesReconnectable: T, elementsSelectable: R, noPanClassName: i, onReconnect: s, onContextMenu: a, onMouseEnter: u, onMouseMove: d, onMouseLeave: f, onClick: h, reconnectRadius: m, onDoubleClick: x, onReconnectStart: b, onReconnectEnd: w, rfId: n, onError: N, edgeTypes: r, disableKeyboardA11y: S }, P))] });
}
fF.displayName = "EdgeRenderer";
const tve = I.memo(fF), nve = (e) => `translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;
function rve({ children: e }) {
  const t = hn(nve);
  return c.jsx("div", { className: "react-flow__viewport xyflow__viewport react-flow__container", style: { transform: t }, children: e });
}
function ive(e) {
  const t = zj(), n = I.useRef(!1);
  I.useEffect(() => {
    !n.current && t.viewportInitialized && e && (setTimeout(() => e(t), 1), n.current = !0);
  }, [e, t.viewportInitialized]);
}
const sve = (e) => {
  var t;
  return (t = e.panZoom) == null ? void 0 : t.syncViewport;
};
function ave(e) {
  const t = hn(sve), n = br();
  return I.useEffect(() => {
    e && (t == null || t(e), n.setState({ transform: [e.x, e.y, e.zoom] }));
  }, [e, t]), null;
}
function ove(e) {
  return e.connection.inProgress ? { ...e.connection, to: px(e.connection.to, e.transform) } : { ...e.connection };
}
function lve(e) {
  return ove;
}
function uve(e) {
  const t = lve();
  return hn(t, xr);
}
const cve = (e) => ({
  nodesConnectable: e.nodesConnectable,
  isValid: e.connection.isValid,
  inProgress: e.connection.inProgress,
  width: e.width,
  height: e.height
});
function dve({ containerStyle: e, style: t, type: n, component: r }) {
  const { nodesConnectable: i, width: s, height: a, isValid: u, inProgress: d } = hn(cve, xr);
  return !(s && i && d) ? null : c.jsx("svg", { style: e, width: s, height: a, className: "react-flow__connectionline react-flow__container", children: c.jsx("g", { className: ii(["react-flow__connection", cq(u)]), children: c.jsx(hF, { style: t, type: n, CustomComponent: r, isValid: u }) }) });
}
const hF = ({ style: e, type: t = gd.Bezier, CustomComponent: n, isValid: r }) => {
  const { inProgress: i, from: s, fromNode: a, fromHandle: u, fromPosition: d, to: f, toNode: h, toHandle: m, toPosition: x, pointer: b } = uve();
  if (!i)
    return;
  if (n)
    return c.jsx(n, { connectionLineType: t, connectionLineStyle: e, fromNode: a, fromHandle: u, fromX: s.x, fromY: s.y, toX: f.x, toY: f.y, fromPosition: d, toPosition: x, connectionStatus: cq(r), toNode: h, toHandle: m, pointer: b });
  let w = "";
  const S = {
    sourceX: s.x,
    sourceY: s.y,
    sourcePosition: d,
    targetX: f.x,
    targetY: f.y,
    targetPosition: x
  };
  switch (t) {
    case gd.Bezier:
      [w] = _q(S);
      break;
    case gd.SimpleBezier:
      [w] = eF(S);
      break;
    case gd.Step:
      [w] = I5({
        ...S,
        borderRadius: 0
      });
      break;
    case gd.SmoothStep:
      [w] = I5(S);
      break;
    default:
      [w] = Eq(S);
  }
  return c.jsx("path", { d: w, fill: "none", className: "react-flow__connection-path", style: e });
};
hF.displayName = "ConnectionLine";
const fve = {};
function qR(e = fve) {
  I.useRef(e), br(), I.useEffect(() => {
  }, [e]);
}
function hve() {
  br(), I.useRef(!1), I.useEffect(() => {
  }, []);
}
function pF({ nodeTypes: e, edgeTypes: t, onInit: n, onNodeClick: r, onEdgeClick: i, onNodeDoubleClick: s, onEdgeDoubleClick: a, onNodeMouseEnter: u, onNodeMouseMove: d, onNodeMouseLeave: f, onNodeContextMenu: h, onSelectionContextMenu: m, onSelectionStart: x, onSelectionEnd: b, connectionLineType: w, connectionLineStyle: S, connectionLineComponent: C, connectionLineContainerStyle: T, selectionKeyCode: R, selectionOnDrag: N, selectionMode: M, multiSelectionKeyCode: P, panActivationKeyCode: D, zoomActivationKeyCode: q, deleteKeyCode: Y, onlyRenderVisibleElements: te, elementsSelectable: V, defaultViewport: $, translateExtent: G, minZoom: le, maxZoom: Z, preventScrolling: oe, defaultMarkerColor: X, zoomOnScroll: ce, zoomOnPinch: pe, panOnScroll: de, panOnScrollSpeed: H, panOnScrollMode: J, zoomOnDoubleClick: ge, panOnDrag: Q, onPaneClick: fe, onPaneMouseEnter: ve, onPaneMouseMove: Se, onPaneMouseLeave: Me, onPaneScroll: Ie, onPaneContextMenu: Re, paneClickDistance: mt, nodeClickDistance: dt, onEdgeContextMenu: Je, onEdgeMouseEnter: ft, onEdgeMouseMove: yt, onEdgeMouseLeave: ht, reconnectRadius: Le, onReconnect: Ye, onReconnectStart: gt, onReconnectEnd: Dt, noDragClassName: pn, noWheelClassName: Ht, noPanClassName: zn, disableKeyboardA11y: nn, nodeExtent: kn, rfId: Nn, viewport: $e, onViewportChange: Qe }) {
  return qR(e), qR(t), hve(), ive(n), ave($e), c.jsx(jxe, { onPaneClick: fe, onPaneMouseEnter: ve, onPaneMouseMove: Se, onPaneMouseLeave: Me, onPaneContextMenu: Re, onPaneScroll: Ie, paneClickDistance: mt, deleteKeyCode: Y, selectionKeyCode: R, selectionOnDrag: N, selectionMode: M, onSelectionStart: x, onSelectionEnd: b, multiSelectionKeyCode: P, panActivationKeyCode: D, zoomActivationKeyCode: q, elementsSelectable: V, zoomOnScroll: ce, zoomOnPinch: pe, zoomOnDoubleClick: ge, panOnScroll: de, panOnScrollSpeed: H, panOnScrollMode: J, panOnDrag: Q, defaultViewport: $, translateExtent: G, minZoom: le, maxZoom: Z, onSelectionContextMenu: m, preventScrolling: oe, noDragClassName: pn, noWheelClassName: Ht, noPanClassName: zn, disableKeyboardA11y: nn, onViewportChange: Qe, isControlledViewport: !!$e, children: c.jsxs(rve, { children: [c.jsx(tve, { edgeTypes: t, onEdgeClick: i, onEdgeDoubleClick: a, onReconnect: Ye, onReconnectStart: gt, onReconnectEnd: Dt, onlyRenderVisibleElements: te, onEdgeContextMenu: Je, onEdgeMouseEnter: ft, onEdgeMouseMove: yt, onEdgeMouseLeave: ht, reconnectRadius: Le, defaultMarkerColor: X, noPanClassName: zn, disableKeyboardA11y: nn, rfId: Nn }), c.jsx(dve, { style: S, type: w, component: C, containerStyle: T }), c.jsx("div", { className: "react-flow__edgelabel-renderer" }), c.jsx(Ixe, { nodeTypes: e, onNodeClick: r, onNodeDoubleClick: s, onNodeMouseEnter: u, onNodeMouseMove: d, onNodeMouseLeave: f, onNodeContextMenu: h, nodeClickDistance: dt, onlyRenderVisibleElements: te, noPanClassName: zn, noDragClassName: pn, disableKeyboardA11y: nn, nodeExtent: kn, rfId: Nn }), c.jsx("div", { className: "react-flow__viewport-portal" })] }) });
}
pF.displayName = "GraphView";
const pve = I.memo(pF), FR = ({ nodes: e, edges: t, defaultNodes: n, defaultEdges: r, width: i, height: s, fitView: a, fitViewOptions: u, minZoom: d = 0.5, maxZoom: f = 2, nodeOrigin: h, nodeExtent: m, zIndexMode: x = "basic" } = {}) => {
  const b = /* @__PURE__ */ new Map(), w = /* @__PURE__ */ new Map(), S = /* @__PURE__ */ new Map(), C = /* @__PURE__ */ new Map(), T = r ?? t ?? [], R = n ?? e ?? [], N = h ?? [0, 0], M = m ?? $y;
  Tq(S, C, T);
  const P = B5(R, b, w, {
    nodeOrigin: N,
    nodeExtent: M,
    zIndexMode: x
  });
  let D = [0, 0, 1];
  if (a && i && s) {
    const q = fx(b, {
      filter: ($) => !!(($.width || $.initialWidth) && ($.height || $.initialHeight))
    }), { x: Y, y: te, zoom: V } = jj(q, i, s, d, f, (u == null ? void 0 : u.padding) ?? 0.1);
    D = [Y, te, V];
  }
  return {
    rfId: "1",
    width: i ?? 0,
    height: s ?? 0,
    transform: D,
    nodes: R,
    nodesInitialized: P,
    nodeLookup: b,
    parentLookup: w,
    edges: T,
    edgeLookup: C,
    connectionLookup: S,
    onNodesChange: null,
    onEdgesChange: null,
    hasDefaultNodes: n !== void 0,
    hasDefaultEdges: r !== void 0,
    panZoom: null,
    minZoom: d,
    maxZoom: f,
    translateExtent: $y,
    nodeExtent: M,
    nodesSelectionActive: !1,
    userSelectionActive: !1,
    userSelectionRect: null,
    connectionMode: Bm.Strict,
    domNode: null,
    paneDragging: !1,
    noPanClassName: "nopan",
    nodeOrigin: N,
    nodeDragThreshold: 1,
    connectionDragThreshold: 1,
    snapGrid: [15, 15],
    snapToGrid: !1,
    nodesDraggable: !0,
    nodesConnectable: !0,
    nodesFocusable: !0,
    edgesFocusable: !0,
    edgesReconnectable: !0,
    elementsSelectable: !0,
    elevateNodesOnSelect: !0,
    elevateEdgesOnSelect: !0,
    selectNodesOnDrag: !0,
    multiSelectionActive: !1,
    fitViewQueued: a ?? !1,
    fitViewOptions: u,
    fitViewResolver: null,
    connection: { ...uq },
    connectionClickStartHandle: null,
    connectOnClick: !0,
    ariaLiveMessage: "",
    autoPanOnConnect: !0,
    autoPanOnNodeDrag: !0,
    autoPanOnNodeFocus: !0,
    autoPanSpeed: 15,
    connectionRadius: 20,
    onError: I0e,
    isValidConnection: void 0,
    onSelectionChangeHandlers: [],
    lib: "react",
    debug: !1,
    ariaLabelConfig: lq,
    zIndexMode: x,
    onNodesChangeMiddlewareMap: /* @__PURE__ */ new Map(),
    onEdgesChangeMiddlewareMap: /* @__PURE__ */ new Map()
  };
}, mve = ({ nodes: e, edges: t, defaultNodes: n, defaultEdges: r, width: i, height: s, fitView: a, fitViewOptions: u, minZoom: d, maxZoom: f, nodeOrigin: h, nodeExtent: m, zIndexMode: x }) => Oye((b, w) => {
  async function S() {
    const { nodeLookup: C, panZoom: T, fitViewOptions: R, fitViewResolver: N, width: M, height: P, minZoom: D, maxZoom: q } = w();
    T && (await z0e({
      nodes: C,
      width: M,
      height: P,
      panZoom: T,
      minZoom: D,
      maxZoom: q
    }, R), N == null || N.resolve(!0), b({ fitViewResolver: null }));
  }
  return {
    ...FR({
      nodes: e,
      edges: t,
      width: i,
      height: s,
      fitView: a,
      fitViewOptions: u,
      minZoom: d,
      maxZoom: f,
      nodeOrigin: h,
      nodeExtent: m,
      defaultNodes: n,
      defaultEdges: r,
      zIndexMode: x
    }),
    setNodes: (C) => {
      const { nodeLookup: T, parentLookup: R, nodeOrigin: N, elevateNodesOnSelect: M, fitViewQueued: P, zIndexMode: D } = w(), q = B5(C, T, R, {
        nodeOrigin: N,
        nodeExtent: m,
        elevateNodesOnSelect: M,
        checkEquality: !0,
        zIndexMode: D
      });
      P && q ? (S(), b({ nodes: C, nodesInitialized: q, fitViewQueued: !1, fitViewOptions: void 0 })) : b({ nodes: C, nodesInitialized: q });
    },
    setEdges: (C) => {
      const { connectionLookup: T, edgeLookup: R } = w();
      Tq(T, R, C), b({ edges: C });
    },
    setDefaultNodesAndEdges: (C, T) => {
      if (C) {
        const { setNodes: R } = w();
        R(C), b({ hasDefaultNodes: !0 });
      }
      if (T) {
        const { setEdges: R } = w();
        R(T), b({ hasDefaultEdges: !0 });
      }
    },
    /*
     * Every node gets registerd at a ResizeObserver. Whenever a node
     * changes its dimensions, this function is called to measure the
     * new dimensions and update the nodes.
     */
    updateNodeInternals: (C) => {
      const { triggerNodeChanges: T, nodeLookup: R, parentLookup: N, domNode: M, nodeOrigin: P, nodeExtent: D, debug: q, fitViewQueued: Y, zIndexMode: te } = w(), { changes: V, updatedInternals: $ } = sye(C, R, N, M, P, D, te);
      $ && (tye(R, N, { nodeOrigin: P, nodeExtent: D, zIndexMode: te }), Y ? (S(), b({ fitViewQueued: !1, fitViewOptions: void 0 })) : b({}), (V == null ? void 0 : V.length) > 0 && (q && console.log("React Flow: trigger node changes", V), T == null || T(V)));
    },
    updateNodePositions: (C, T = !1) => {
      const R = [];
      let N = [];
      const { nodeLookup: M, triggerNodeChanges: P, connection: D, updateConnection: q, onNodesChangeMiddlewareMap: Y } = w();
      for (const [te, V] of C) {
        const $ = M.get(te), G = !!($ != null && $.expandParent && ($ != null && $.parentId) && (V != null && V.position)), le = {
          id: te,
          type: "position",
          position: G ? {
            x: Math.max(0, V.position.x),
            y: Math.max(0, V.position.y)
          } : V.position,
          dragging: T
        };
        if ($ && D.inProgress && D.fromNode.id === $.id) {
          const Z = Ch($, D.fromHandle, wt.Left, !0);
          q({ ...D, from: Z });
        }
        G && $.parentId && R.push({
          id: te,
          parentId: $.parentId,
          rect: {
            ...V.internals.positionAbsolute,
            width: V.measured.width ?? 0,
            height: V.measured.height ?? 0
          }
        }), N.push(le);
      }
      if (R.length > 0) {
        const { parentLookup: te, nodeOrigin: V } = w(), $ = Dj(R, M, te, V);
        N.push(...$);
      }
      for (const te of Y.values())
        N = te(N);
      P(N);
    },
    triggerNodeChanges: (C) => {
      const { onNodesChange: T, setNodes: R, nodes: N, hasDefaultNodes: M, debug: P } = w();
      if (C != null && C.length) {
        if (M) {
          const D = Fq(C, N);
          R(D);
        }
        P && console.log("React Flow: trigger node changes", C), T == null || T(C);
      }
    },
    triggerEdgeChanges: (C) => {
      const { onEdgesChange: T, setEdges: R, edges: N, hasDefaultEdges: M, debug: P } = w();
      if (C != null && C.length) {
        if (M) {
          const D = Uq(C, N);
          R(D);
        }
        P && console.log("React Flow: trigger edge changes", C), T == null || T(C);
      }
    },
    addSelectedNodes: (C) => {
      const { multiSelectionActive: T, edgeLookup: R, nodeLookup: N, triggerNodeChanges: M, triggerEdgeChanges: P } = w();
      if (T) {
        const D = C.map((q) => Jf(q, !0));
        M(D);
        return;
      }
      M(ym(N, /* @__PURE__ */ new Set([...C]), !0)), P(ym(R));
    },
    addSelectedEdges: (C) => {
      const { multiSelectionActive: T, edgeLookup: R, nodeLookup: N, triggerNodeChanges: M, triggerEdgeChanges: P } = w();
      if (T) {
        const D = C.map((q) => Jf(q, !0));
        P(D);
        return;
      }
      P(ym(R, /* @__PURE__ */ new Set([...C]))), M(ym(N, /* @__PURE__ */ new Set(), !0));
    },
    unselectNodesAndEdges: ({ nodes: C, edges: T } = {}) => {
      const { edges: R, nodes: N, nodeLookup: M, triggerNodeChanges: P, triggerEdgeChanges: D } = w(), q = C || N, Y = T || R, te = q.map(($) => {
        const G = M.get($.id);
        return G && (G.selected = !1), Jf($.id, !1);
      }), V = Y.map(($) => Jf($.id, !1));
      P(te), D(V);
    },
    setMinZoom: (C) => {
      const { panZoom: T, maxZoom: R } = w();
      T == null || T.setScaleExtent([C, R]), b({ minZoom: C });
    },
    setMaxZoom: (C) => {
      const { panZoom: T, minZoom: R } = w();
      T == null || T.setScaleExtent([R, C]), b({ maxZoom: C });
    },
    setTranslateExtent: (C) => {
      var T;
      (T = w().panZoom) == null || T.setTranslateExtent(C), b({ translateExtent: C });
    },
    resetSelectedElements: () => {
      const { edges: C, nodes: T, triggerNodeChanges: R, triggerEdgeChanges: N, elementsSelectable: M } = w();
      if (!M)
        return;
      const P = T.reduce((q, Y) => Y.selected ? [...q, Jf(Y.id, !1)] : q, []), D = C.reduce((q, Y) => Y.selected ? [...q, Jf(Y.id, !1)] : q, []);
      R(P), N(D);
    },
    setNodeExtent: (C) => {
      const { nodes: T, nodeLookup: R, parentLookup: N, nodeOrigin: M, elevateNodesOnSelect: P, nodeExtent: D, zIndexMode: q } = w();
      C[0][0] === D[0][0] && C[0][1] === D[0][1] && C[1][0] === D[1][0] && C[1][1] === D[1][1] || (B5(T, R, N, {
        nodeOrigin: M,
        nodeExtent: C,
        elevateNodesOnSelect: P,
        checkEquality: !1,
        zIndexMode: q
      }), b({ nodeExtent: C }));
    },
    panBy: (C) => {
      const { transform: T, width: R, height: N, panZoom: M, translateExtent: P } = w();
      return aye({ delta: C, panZoom: M, transform: T, translateExtent: P, width: R, height: N });
    },
    setCenter: async (C, T, R) => {
      const { width: N, height: M, maxZoom: P, panZoom: D } = w();
      if (!D)
        return Promise.resolve(!1);
      const q = typeof (R == null ? void 0 : R.zoom) < "u" ? R.zoom : P;
      return await D.setViewport({
        x: N / 2 - C * q,
        y: M / 2 - T * q,
        zoom: q
      }, { duration: R == null ? void 0 : R.duration, ease: R == null ? void 0 : R.ease, interpolate: R == null ? void 0 : R.interpolate }), Promise.resolve(!0);
    },
    cancelConnection: () => {
      b({
        connection: { ...uq }
      });
    },
    updateConnection: (C) => {
      b({ connection: C });
    },
    reset: () => b({ ...FR() })
  };
}, Object.is);
function gve({ initialNodes: e, initialEdges: t, defaultNodes: n, defaultEdges: r, initialWidth: i, initialHeight: s, initialMinZoom: a, initialMaxZoom: u, initialFitViewOptions: d, fitView: f, nodeOrigin: h, nodeExtent: m, zIndexMode: x, children: b }) {
  const [w] = I.useState(() => mve({
    nodes: e,
    edges: t,
    defaultNodes: n,
    defaultEdges: r,
    width: i,
    height: s,
    fitView: f,
    minZoom: a,
    maxZoom: u,
    fitViewOptions: d,
    nodeOrigin: h,
    nodeExtent: m,
    zIndexMode: x
  }));
  return c.jsx(Dye, { value: w, children: c.jsx(rxe, { children: b }) });
}
function yve({ children: e, nodes: t, edges: n, defaultNodes: r, defaultEdges: i, width: s, height: a, fitView: u, fitViewOptions: d, minZoom: f, maxZoom: h, nodeOrigin: m, nodeExtent: x, zIndexMode: b }) {
  return I.useContext(_w) ? c.jsx(c.Fragment, { children: e }) : c.jsx(gve, { initialNodes: t, initialEdges: n, defaultNodes: r, defaultEdges: i, initialWidth: s, initialHeight: a, fitView: u, initialFitViewOptions: d, initialMinZoom: f, initialMaxZoom: h, nodeOrigin: m, nodeExtent: x, zIndexMode: b, children: e });
}
const xve = {
  width: "100%",
  height: "100%",
  overflow: "hidden",
  position: "relative",
  zIndex: 0
};
function vve({ nodes: e, edges: t, defaultNodes: n, defaultEdges: r, className: i, nodeTypes: s, edgeTypes: a, onNodeClick: u, onEdgeClick: d, onInit: f, onMove: h, onMoveStart: m, onMoveEnd: x, onConnect: b, onConnectStart: w, onConnectEnd: S, onClickConnectStart: C, onClickConnectEnd: T, onNodeMouseEnter: R, onNodeMouseMove: N, onNodeMouseLeave: M, onNodeContextMenu: P, onNodeDoubleClick: D, onNodeDragStart: q, onNodeDrag: Y, onNodeDragStop: te, onNodesDelete: V, onEdgesDelete: $, onDelete: G, onSelectionChange: le, onSelectionDragStart: Z, onSelectionDrag: oe, onSelectionDragStop: X, onSelectionContextMenu: ce, onSelectionStart: pe, onSelectionEnd: de, onBeforeDelete: H, connectionMode: J, connectionLineType: ge = gd.Bezier, connectionLineStyle: Q, connectionLineComponent: fe, connectionLineContainerStyle: ve, deleteKeyCode: Se = "Backspace", selectionKeyCode: Me = "Shift", selectionOnDrag: Ie = !1, selectionMode: Re = qy.Full, panActivationKeyCode: mt = "Space", multiSelectionKeyCode: dt = Hy() ? "Meta" : "Control", zoomActivationKeyCode: Je = Hy() ? "Meta" : "Control", snapToGrid: ft, snapGrid: yt, onlyRenderVisibleElements: ht = !1, selectNodesOnDrag: Le, nodesDraggable: Ye, autoPanOnNodeFocus: gt, nodesConnectable: Dt, nodesFocusable: pn, nodeOrigin: Ht = $q, edgesFocusable: zn, edgesReconnectable: nn, elementsSelectable: kn = !0, defaultViewport: Nn = Kye, minZoom: $e = 0.5, maxZoom: Qe = 2, translateExtent: bt = $y, preventScrolling: jt = !0, nodeExtent: $t, defaultMarkerColor: Un = "#b1b1b7", zoomOnScroll: Hn = !0, zoomOnPinch: on = !0, panOnScroll: Jt = !1, panOnScrollSpeed: fn = 0.5, panOnScrollMode: nt = yh.Free, zoomOnDoubleClick: er = !0, panOnDrag: Pn = !0, onPaneClick: sr, onPaneMouseEnter: st, onPaneMouseMove: $r, onPaneMouseLeave: Is, onPaneScroll: bi, onPaneContextMenu: At, paneClickDistance: tr = 1, nodeClickDistance: Dd = 0, children: cu, onReconnect: Ls, onReconnectStart: Ui, onReconnectEnd: du, onEdgeContextMenu: ya, onEdgeDoubleClick: Tn, onEdgeMouseEnter: Gn, onEdgeMouseMove: fu, onEdgeMouseLeave: Fa, reconnectRadius: ho = 10, onNodesChange: po, onEdgesChange: Bs, noDragClassName: Rn = "nodrag", noWheelClassName: ar = "nowheel", noPanClassName: Yr = "nopan", fitView: $s, fitViewOptions: lc, connectOnClick: qs, attributionPosition: hu, proOptions: Ni, defaultEdgeOptions: ol, elevateNodesOnSelect: Fs = !0, elevateEdgesOnSelect: mn = !1, disableKeyboardA11y: wi = !1, autoPanOnConnect: _r, autoPanOnNodeDrag: or, autoPanSpeed: xa, connectionRadius: mo, isValidConnection: Hi, onError: fs, style: Us, id: ll, nodeDragThreshold: go, connectionDragThreshold: uc, viewport: Vt, onViewportChange: Ua, width: Ri, height: Nr, colorMode: Hs = "light", debug: cc, onScroll: Vs, ariaLabelConfig: Ha, zIndexMode: ln = "basic", ...yo }, Sr) {
  const Mi = ll || "1", Va = Xye(Hs), xo = I.useCallback((Oi) => {
    Oi.currentTarget.scrollTo({ top: 0, left: 0, behavior: "instant" }), Vs == null || Vs(Oi);
  }, [Vs]);
  return c.jsx("div", { "data-testid": "rf__wrapper", ...yo, onScroll: xo, style: { ...Us, ...xve }, ref: Sr, className: ii(["react-flow", i, Va]), id: ll, role: "application", children: c.jsxs(yve, { nodes: e, edges: t, width: Ri, height: Nr, fitView: $s, fitViewOptions: lc, minZoom: $e, maxZoom: Qe, nodeOrigin: Ht, nodeExtent: $t, zIndexMode: ln, children: [c.jsx(pve, { onInit: f, onNodeClick: u, onEdgeClick: d, onNodeMouseEnter: R, onNodeMouseMove: N, onNodeMouseLeave: M, onNodeContextMenu: P, onNodeDoubleClick: D, nodeTypes: s, edgeTypes: a, connectionLineType: ge, connectionLineStyle: Q, connectionLineComponent: fe, connectionLineContainerStyle: ve, selectionKeyCode: Me, selectionOnDrag: Ie, selectionMode: Re, deleteKeyCode: Se, multiSelectionKeyCode: dt, panActivationKeyCode: mt, zoomActivationKeyCode: Je, onlyRenderVisibleElements: ht, defaultViewport: Nn, translateExtent: bt, minZoom: $e, maxZoom: Qe, preventScrolling: jt, zoomOnScroll: Hn, zoomOnPinch: on, zoomOnDoubleClick: er, panOnScroll: Jt, panOnScrollSpeed: fn, panOnScrollMode: nt, panOnDrag: Pn, onPaneClick: sr, onPaneMouseEnter: st, onPaneMouseMove: $r, onPaneMouseLeave: Is, onPaneScroll: bi, onPaneContextMenu: At, paneClickDistance: tr, nodeClickDistance: Dd, onSelectionContextMenu: ce, onSelectionStart: pe, onSelectionEnd: de, onReconnect: Ls, onReconnectStart: Ui, onReconnectEnd: du, onEdgeContextMenu: ya, onEdgeDoubleClick: Tn, onEdgeMouseEnter: Gn, onEdgeMouseMove: fu, onEdgeMouseLeave: Fa, reconnectRadius: ho, defaultMarkerColor: Un, noDragClassName: Rn, noWheelClassName: ar, noPanClassName: Yr, rfId: Mi, disableKeyboardA11y: wi, nodeExtent: $t, viewport: Vt, onViewportChange: Ua }), c.jsx(Zye, { nodes: e, edges: t, defaultNodes: n, defaultEdges: r, onConnect: b, onConnectStart: w, onConnectEnd: S, onClickConnectStart: C, onClickConnectEnd: T, nodesDraggable: Ye, autoPanOnNodeFocus: gt, nodesConnectable: Dt, nodesFocusable: pn, edgesFocusable: zn, edgesReconnectable: nn, elementsSelectable: kn, elevateNodesOnSelect: Fs, elevateEdgesOnSelect: mn, minZoom: $e, maxZoom: Qe, nodeExtent: $t, onNodesChange: po, onEdgesChange: Bs, snapToGrid: ft, snapGrid: yt, connectionMode: J, translateExtent: bt, connectOnClick: qs, defaultEdgeOptions: ol, fitView: $s, fitViewOptions: lc, onNodesDelete: V, onEdgesDelete: $, onDelete: G, onNodeDragStart: q, onNodeDrag: Y, onNodeDragStop: te, onSelectionDrag: oe, onSelectionDragStart: Z, onSelectionDragStop: X, onMove: h, onMoveStart: m, onMoveEnd: x, noPanClassName: Yr, nodeOrigin: Ht, rfId: Mi, autoPanOnConnect: _r, autoPanOnNodeDrag: or, autoPanSpeed: xa, onError: fs, connectionRadius: mo, isValidConnection: Hi, selectNodesOnDrag: Le, nodeDragThreshold: go, connectionDragThreshold: uc, onBeforeDelete: H, debug: cc, ariaLabelConfig: Ha, zIndexMode: ln }), c.jsx(Gye, { onSelectionChange: le }), cu, c.jsx(qye, { proOptions: Ni, position: hu }), c.jsx($ye, { rfId: Mi, disableKeyboardA11y: wi })] }) });
}
var bve = Hq(vve);
function wve(e) {
  const [t, n] = I.useState(e), r = I.useCallback((i) => n((s) => Fq(i, s)), []);
  return [t, n, r];
}
function _ve(e) {
  const [t, n] = I.useState(e), r = I.useCallback((i) => n((s) => Uq(i, s)), []);
  return [t, n, r];
}
function Sve({ dimensions: e, lineWidth: t, variant: n, className: r }) {
  return c.jsx("path", { strokeWidth: t, d: `M${e[0] / 2} 0 V${e[1]} M0 ${e[1] / 2} H${e[0]}`, className: ii(["react-flow__background-pattern", n, r]) });
}
function Eve({ radius: e, className: t }) {
  return c.jsx("circle", { cx: e, cy: e, r: e, className: ii(["react-flow__background-pattern", "dots", t]) });
}
var bd;
(function(e) {
  e.Lines = "lines", e.Dots = "dots", e.Cross = "cross";
})(bd || (bd = {}));
const Cve = {
  [bd.Dots]: 1,
  [bd.Lines]: 1,
  [bd.Cross]: 6
}, kve = (e) => ({ transform: e.transform, patternId: `pattern-${e.rfId}` });
function mF({
  id: e,
  variant: t = bd.Dots,
  // only used for dots and cross
  gap: n = 20,
  // only used for lines and cross
  size: r,
  lineWidth: i = 1,
  offset: s = 0,
  color: a,
  bgColor: u,
  style: d,
  className: f,
  patternClassName: h
}) {
  const m = I.useRef(null), { transform: x, patternId: b } = hn(kve, xr), w = r || Cve[t], S = t === bd.Dots, C = t === bd.Cross, T = Array.isArray(n) ? n : [n, n], R = [T[0] * x[2] || 1, T[1] * x[2] || 1], N = w * x[2], M = Array.isArray(s) ? s : [s, s], P = C ? [N, N] : R, D = [
    M[0] * x[2] || 1 + P[0] / 2,
    M[1] * x[2] || 1 + P[1] / 2
  ], q = `${b}${e || ""}`;
  return c.jsxs("svg", { className: ii(["react-flow__background", f]), style: {
    ...d,
    ...Ew,
    "--xy-background-color-props": u,
    "--xy-background-pattern-color-props": a
  }, ref: m, "data-testid": "rf__background", children: [c.jsx("pattern", { id: q, x: x[0] % R[0], y: x[1] % R[1], width: R[0], height: R[1], patternUnits: "userSpaceOnUse", patternTransform: `translate(-${D[0]},-${D[1]})`, children: S ? c.jsx(Eve, { radius: N / 2, className: h }) : c.jsx(Sve, { dimensions: P, lineWidth: i, variant: t, className: h }) }), c.jsx("rect", { x: "0", y: "0", width: "100%", height: "100%", fill: `url(#${q})` })] });
}
mF.displayName = "Background";
const Tve = I.memo(mF);
function jve() {
  return c.jsx("svg", { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 32 32", children: c.jsx("path", { d: "M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z" }) });
}
function Ave() {
  return c.jsx("svg", { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 32 5", children: c.jsx("path", { d: "M0 0h32v4.2H0z" }) });
}
function Nve() {
  return c.jsx("svg", { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 32 30", children: c.jsx("path", { d: "M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z" }) });
}
function Rve() {
  return c.jsx("svg", { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 25 32", children: c.jsx("path", { d: "M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z" }) });
}
function Mve() {
  return c.jsx("svg", { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 25 32", children: c.jsx("path", { d: "M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z" }) });
}
function N1({ children: e, className: t, ...n }) {
  return c.jsx("button", { type: "button", className: ii(["react-flow__controls-button", t]), ...n, children: e });
}
const Ove = (e) => ({
  isInteractive: e.nodesDraggable || e.nodesConnectable || e.elementsSelectable,
  minZoomReached: e.transform[2] <= e.minZoom,
  maxZoomReached: e.transform[2] >= e.maxZoom,
  ariaLabelConfig: e.ariaLabelConfig
});
function gF({ style: e, showZoom: t = !0, showFitView: n = !0, showInteractive: r = !0, fitViewOptions: i, onZoomIn: s, onZoomOut: a, onFitView: u, onInteractiveChange: d, className: f, children: h, position: m = "bottom-left", orientation: x = "vertical", "aria-label": b }) {
  const w = br(), { isInteractive: S, minZoomReached: C, maxZoomReached: T, ariaLabelConfig: R } = hn(Ove, xr), { zoomIn: N, zoomOut: M, fitView: P } = zj(), D = () => {
    N(), s == null || s();
  }, q = () => {
    M(), a == null || a();
  }, Y = () => {
    P(i), u == null || u();
  }, te = () => {
    w.setState({
      nodesDraggable: !S,
      nodesConnectable: !S,
      elementsSelectable: !S
    }), d == null || d(!S);
  }, V = x === "horizontal" ? "horizontal" : "vertical";
  return c.jsxs(Sw, { className: ii(["react-flow__controls", V, f]), position: m, style: e, "data-testid": "rf__controls", "aria-label": b ?? R["controls.ariaLabel"], children: [t && c.jsxs(c.Fragment, { children: [c.jsx(N1, { onClick: D, className: "react-flow__controls-zoomin", title: R["controls.zoomIn.ariaLabel"], "aria-label": R["controls.zoomIn.ariaLabel"], disabled: T, children: c.jsx(jve, {}) }), c.jsx(N1, { onClick: q, className: "react-flow__controls-zoomout", title: R["controls.zoomOut.ariaLabel"], "aria-label": R["controls.zoomOut.ariaLabel"], disabled: C, children: c.jsx(Ave, {}) })] }), n && c.jsx(N1, { className: "react-flow__controls-fitview", onClick: Y, title: R["controls.fitView.ariaLabel"], "aria-label": R["controls.fitView.ariaLabel"], children: c.jsx(Nve, {}) }), r && c.jsx(N1, { className: "react-flow__controls-interactive", onClick: te, title: R["controls.interactive.ariaLabel"], "aria-label": R["controls.interactive.ariaLabel"], children: S ? c.jsx(Mve, {}) : c.jsx(Rve, {}) }), h] });
}
gF.displayName = "Controls";
const Dve = I.memo(gF);
function zve({ id: e, x: t, y: n, width: r, height: i, style: s, color: a, strokeColor: u, strokeWidth: d, className: f, borderRadius: h, shapeRendering: m, selected: x, onClick: b }) {
  const { background: w, backgroundColor: S } = s || {}, C = a || w || S;
  return c.jsx("rect", { className: ii(["react-flow__minimap-node", { selected: x }, f]), x: t, y: n, rx: h, ry: h, width: r, height: i, style: {
    fill: C,
    stroke: u,
    strokeWidth: d
  }, shapeRendering: m, onClick: b ? (T) => b(T, e) : void 0 });
}
const Pve = I.memo(zve), Ive = (e) => e.nodes.map((t) => t.id), F_ = (e) => e instanceof Function ? e : () => e;
function Lve({
  nodeStrokeColor: e,
  nodeColor: t,
  nodeClassName: n = "",
  nodeBorderRadius: r = 5,
  nodeStrokeWidth: i,
  /*
   * We need to rename the prop to be `CapitalCase` so that JSX will render it as
   * a component properly.
   */
  nodeComponent: s = Pve,
  onClick: a
}) {
  const u = hn(Ive, xr), d = F_(t), f = F_(e), h = F_(n), m = typeof window > "u" || window.chrome ? "crispEdges" : "geometricPrecision";
  return c.jsx(c.Fragment, { children: u.map((x) => (
    /*
     * The split of responsibilities between MiniMapNodes and
     * NodeComponentWrapper may appear weird. However, its designed to
     * minimize the cost of updates when individual nodes change.
     *
     * For more details, see a similar commit in `NodeRenderer/index.tsx`.
     */
    c.jsx($ve, { id: x, nodeColorFunc: d, nodeStrokeColorFunc: f, nodeClassNameFunc: h, nodeBorderRadius: r, nodeStrokeWidth: i, NodeComponent: s, onClick: a, shapeRendering: m }, x)
  )) });
}
function Bve({ id: e, nodeColorFunc: t, nodeStrokeColorFunc: n, nodeClassNameFunc: r, nodeBorderRadius: i, nodeStrokeWidth: s, shapeRendering: a, NodeComponent: u, onClick: d }) {
  const { node: f, x: h, y: m, width: x, height: b } = hn((w) => {
    const { internals: S } = w.nodeLookup.get(e), C = S.userNode, { x: T, y: R } = S.positionAbsolute, { width: N, height: M } = sc(C);
    return {
      node: C,
      x: T,
      y: R,
      width: N,
      height: M
    };
  }, xr);
  return !f || f.hidden || !gq(f) ? null : c.jsx(u, { x: h, y: m, width: x, height: b, style: f.style, selected: !!f.selected, className: r(f), color: t(f), borderRadius: i, strokeColor: n(f), strokeWidth: s, shapeRendering: a, onClick: d, id: f.id });
}
const $ve = I.memo(Bve);
var qve = I.memo(Lve);
const Fve = 200, Uve = 150, Hve = (e) => !e.hidden, Vve = (e) => {
  const t = {
    x: -e.transform[0] / e.transform[2],
    y: -e.transform[1] / e.transform[2],
    width: e.width / e.transform[2],
    height: e.height / e.transform[2]
  };
  return {
    viewBB: t,
    boundingRect: e.nodeLookup.size > 0 ? mq(fx(e.nodeLookup, { filter: Hve }), t) : t,
    rfId: e.rfId,
    panZoom: e.panZoom,
    translateExtent: e.translateExtent,
    flowWidth: e.width,
    flowHeight: e.height,
    ariaLabelConfig: e.ariaLabelConfig
  };
}, Gve = "react-flow__minimap-desc";
function yF({
  style: e,
  className: t,
  nodeStrokeColor: n,
  nodeColor: r,
  nodeClassName: i = "",
  nodeBorderRadius: s = 5,
  nodeStrokeWidth: a,
  /*
   * We need to rename the prop to be `CapitalCase` so that JSX will render it as
   * a component properly.
   */
  nodeComponent: u,
  bgColor: d,
  maskColor: f,
  maskStrokeColor: h,
  maskStrokeWidth: m,
  position: x = "bottom-right",
  onClick: b,
  onNodeClick: w,
  pannable: S = !1,
  zoomable: C = !1,
  ariaLabel: T,
  inversePan: R,
  zoomStep: N = 1,
  offsetScale: M = 5
}) {
  const P = br(), D = I.useRef(null), { boundingRect: q, viewBB: Y, rfId: te, panZoom: V, translateExtent: $, flowWidth: G, flowHeight: le, ariaLabelConfig: Z } = hn(Vve, xr), oe = (e == null ? void 0 : e.width) ?? Fve, X = (e == null ? void 0 : e.height) ?? Uve, ce = q.width / oe, pe = q.height / X, de = Math.max(ce, pe), H = de * oe, J = de * X, ge = M * de, Q = q.x - (H - q.width) / 2 - ge, fe = q.y - (J - q.height) / 2 - ge, ve = H + ge * 2, Se = J + ge * 2, Me = `${Gve}-${te}`, Ie = I.useRef(0), Re = I.useRef();
  Ie.current = de, I.useEffect(() => {
    if (D.current && V)
      return Re.current = mye({
        domNode: D.current,
        panZoom: V,
        getTransform: () => P.getState().transform,
        getViewScale: () => Ie.current
      }), () => {
        var ft;
        (ft = Re.current) == null || ft.destroy();
      };
  }, [V]), I.useEffect(() => {
    var ft;
    (ft = Re.current) == null || ft.update({
      translateExtent: $,
      width: G,
      height: le,
      inversePan: R,
      pannable: S,
      zoomStep: N,
      zoomable: C
    });
  }, [S, C, R, N, $, G, le]);
  const mt = b ? (ft) => {
    var Le;
    const [yt, ht] = ((Le = Re.current) == null ? void 0 : Le.pointer(ft)) || [0, 0];
    b(ft, { x: yt, y: ht });
  } : void 0, dt = w ? I.useCallback((ft, yt) => {
    const ht = P.getState().nodeLookup.get(yt).internals.userNode;
    w(ft, ht);
  }, []) : void 0, Je = T ?? Z["minimap.ariaLabel"];
  return c.jsx(Sw, { position: x, style: {
    ...e,
    "--xy-minimap-background-color-props": typeof d == "string" ? d : void 0,
    "--xy-minimap-mask-background-color-props": typeof f == "string" ? f : void 0,
    "--xy-minimap-mask-stroke-color-props": typeof h == "string" ? h : void 0,
    "--xy-minimap-mask-stroke-width-props": typeof m == "number" ? m * de : void 0,
    "--xy-minimap-node-background-color-props": typeof r == "string" ? r : void 0,
    "--xy-minimap-node-stroke-color-props": typeof n == "string" ? n : void 0,
    "--xy-minimap-node-stroke-width-props": typeof a == "number" ? a : void 0
  }, className: ii(["react-flow__minimap", t]), "data-testid": "rf__minimap", children: c.jsxs("svg", { width: oe, height: X, viewBox: `${Q} ${fe} ${ve} ${Se}`, className: "react-flow__minimap-svg", role: "img", "aria-labelledby": Me, ref: D, onClick: mt, children: [Je && c.jsx("title", { id: Me, children: Je }), c.jsx(qve, { onClick: dt, nodeColor: r, nodeStrokeColor: n, nodeBorderRadius: s, nodeClassName: i, nodeStrokeWidth: a, nodeComponent: u }), c.jsx("path", { className: "react-flow__minimap-mask", d: `M${Q - ge},${fe - ge}h${ve + ge * 2}v${Se + ge * 2}h${-ve - ge * 2}z
        M${Y.x},${Y.y}h${Y.width}v${Y.height}h${-Y.width}z`, fillRule: "evenodd", pointerEvents: "none" })] }) });
}
yF.displayName = "MiniMap";
const Kve = I.memo(yF), Yve = (e) => (t) => e ? `${Math.max(1 / t.transform[2], 1)}` : void 0, Wve = {
  [Um.Line]: "right",
  [Um.Handle]: "bottom-right"
};
function Zve({ nodeId: e, position: t, variant: n = Um.Handle, className: r, style: i = void 0, children: s, color: a, minWidth: u = 10, minHeight: d = 10, maxWidth: f = Number.MAX_VALUE, maxHeight: h = Number.MAX_VALUE, keepAspectRatio: m = !1, resizeDirection: x, autoScale: b = !0, shouldResize: w, onResizeStart: S, onResize: C, onResizeEnd: T }) {
  const R = Wq(), N = typeof e == "string" ? e : R, M = br(), P = I.useRef(null), D = n === Um.Handle, q = hn(I.useCallback(Yve(D && b), [D, b]), xr), Y = I.useRef(null), te = t ?? Wve[n];
  I.useEffect(() => {
    if (!(!P.current || !N))
      return Y.current || (Y.current = Aye({
        domNode: P.current,
        nodeId: N,
        getStoreItems: () => {
          const { nodeLookup: $, transform: G, snapGrid: le, snapToGrid: Z, nodeOrigin: oe, domNode: X } = M.getState();
          return {
            nodeLookup: $,
            transform: G,
            snapGrid: le,
            snapToGrid: Z,
            nodeOrigin: oe,
            paneDomNode: X
          };
        },
        onChange: ($, G) => {
          const { triggerNodeChanges: le, nodeLookup: Z, parentLookup: oe, nodeOrigin: X } = M.getState(), ce = [], pe = { x: $.x, y: $.y }, de = Z.get(N);
          if (de && de.expandParent && de.parentId) {
            const H = de.origin ?? X, J = $.width ?? de.measured.width ?? 0, ge = $.height ?? de.measured.height ?? 0, Q = {
              id: de.id,
              parentId: de.parentId,
              rect: {
                width: J,
                height: ge,
                ...yq({
                  x: $.x ?? de.position.x,
                  y: $.y ?? de.position.y
                }, { width: J, height: ge }, de.parentId, Z, H)
              }
            }, fe = Dj([Q], Z, oe, X);
            ce.push(...fe), pe.x = $.x ? Math.max(H[0] * J, $.x) : void 0, pe.y = $.y ? Math.max(H[1] * ge, $.y) : void 0;
          }
          if (pe.x !== void 0 && pe.y !== void 0) {
            const H = {
              id: N,
              type: "position",
              position: { ...pe }
            };
            ce.push(H);
          }
          if ($.width !== void 0 && $.height !== void 0) {
            const J = {
              id: N,
              type: "dimensions",
              resizing: !0,
              setAttributes: x ? x === "horizontal" ? "width" : "height" : !0,
              dimensions: {
                width: $.width,
                height: $.height
              }
            };
            ce.push(J);
          }
          for (const H of G) {
            const J = {
              ...H,
              type: "position"
            };
            ce.push(J);
          }
          le(ce);
        },
        onEnd: ({ width: $, height: G }) => {
          const le = {
            id: N,
            type: "dimensions",
            resizing: !1,
            dimensions: {
              width: $,
              height: G
            }
          };
          M.getState().triggerNodeChanges([le]);
        }
      })), Y.current.update({
        controlPosition: te,
        boundaries: {
          minWidth: u,
          minHeight: d,
          maxWidth: f,
          maxHeight: h
        },
        keepAspectRatio: m,
        resizeDirection: x,
        onResizeStart: S,
        onResize: C,
        onResizeEnd: T,
        shouldResize: w
      }), () => {
        var $;
        ($ = Y.current) == null || $.destroy();
      };
  }, [
    te,
    u,
    d,
    f,
    h,
    m,
    S,
    C,
    T,
    w
  ]);
  const V = te.split("-");
  return c.jsx("div", { className: ii(["react-flow__resize-control", "nodrag", ...V, n, r]), ref: P, style: {
    ...i,
    scale: q,
    ...a && { [D ? "backgroundColor" : "borderColor"]: a }
  }, children: s });
}
I.memo(Zve);
function Pj(e) {
  throw new Error('Could not dynamically require "' + e + '". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.');
}
var U_, UR;
function Xve() {
  if (UR) return U_;
  UR = 1;
  function e() {
    this.__data__ = [], this.size = 0;
  }
  return U_ = e, U_;
}
var H_, HR;
function Jm() {
  if (HR) return H_;
  HR = 1;
  function e(t, n) {
    return t === n || t !== t && n !== n;
  }
  return H_ = e, H_;
}
var V_, VR;
function kw() {
  if (VR) return V_;
  VR = 1;
  var e = /* @__PURE__ */ Jm();
  function t(n, r) {
    for (var i = n.length; i--; )
      if (e(n[i][0], r))
        return i;
    return -1;
  }
  return V_ = t, V_;
}
var G_, GR;
function Qve() {
  if (GR) return G_;
  GR = 1;
  var e = /* @__PURE__ */ kw(), t = Array.prototype, n = t.splice;
  function r(i) {
    var s = this.__data__, a = e(s, i);
    if (a < 0)
      return !1;
    var u = s.length - 1;
    return a == u ? s.pop() : n.call(s, a, 1), --this.size, !0;
  }
  return G_ = r, G_;
}
var K_, KR;
function Jve() {
  if (KR) return K_;
  KR = 1;
  var e = /* @__PURE__ */ kw();
  function t(n) {
    var r = this.__data__, i = e(r, n);
    return i < 0 ? void 0 : r[i][1];
  }
  return K_ = t, K_;
}
var Y_, YR;
function e1e() {
  if (YR) return Y_;
  YR = 1;
  var e = /* @__PURE__ */ kw();
  function t(n) {
    return e(this.__data__, n) > -1;
  }
  return Y_ = t, Y_;
}
var W_, WR;
function t1e() {
  if (WR) return W_;
  WR = 1;
  var e = /* @__PURE__ */ kw();
  function t(n, r) {
    var i = this.__data__, s = e(i, n);
    return s < 0 ? (++this.size, i.push([n, r])) : i[s][1] = r, this;
  }
  return W_ = t, W_;
}
var Z_, ZR;
function Tw() {
  if (ZR) return Z_;
  ZR = 1;
  var e = /* @__PURE__ */ Xve(), t = /* @__PURE__ */ Qve(), n = /* @__PURE__ */ Jve(), r = /* @__PURE__ */ e1e(), i = /* @__PURE__ */ t1e();
  function s(a) {
    var u = -1, d = a == null ? 0 : a.length;
    for (this.clear(); ++u < d; ) {
      var f = a[u];
      this.set(f[0], f[1]);
    }
  }
  return s.prototype.clear = e, s.prototype.delete = t, s.prototype.get = n, s.prototype.has = r, s.prototype.set = i, Z_ = s, Z_;
}
var X_, XR;
function n1e() {
  if (XR) return X_;
  XR = 1;
  var e = /* @__PURE__ */ Tw();
  function t() {
    this.__data__ = new e(), this.size = 0;
  }
  return X_ = t, X_;
}
var Q_, QR;
function r1e() {
  if (QR) return Q_;
  QR = 1;
  function e(t) {
    var n = this.__data__, r = n.delete(t);
    return this.size = n.size, r;
  }
  return Q_ = e, Q_;
}
var J_, JR;
function i1e() {
  if (JR) return J_;
  JR = 1;
  function e(t) {
    return this.__data__.get(t);
  }
  return J_ = e, J_;
}
var eS, eM;
function s1e() {
  if (eM) return eS;
  eM = 1;
  function e(t) {
    return this.__data__.has(t);
  }
  return eS = e, eS;
}
var tS, tM;
function xF() {
  if (tM) return tS;
  tM = 1;
  var e = typeof Gu == "object" && Gu && Gu.Object === Object && Gu;
  return tS = e, tS;
}
var nS, nM;
function al() {
  if (nM) return nS;
  nM = 1;
  var e = /* @__PURE__ */ xF(), t = typeof self == "object" && self && self.Object === Object && self, n = e || t || Function("return this")();
  return nS = n, nS;
}
var rS, rM;
function eg() {
  if (rM) return rS;
  rM = 1;
  var e = /* @__PURE__ */ al(), t = e.Symbol;
  return rS = t, rS;
}
var iS, iM;
function a1e() {
  if (iM) return iS;
  iM = 1;
  var e = /* @__PURE__ */ eg(), t = Object.prototype, n = t.hasOwnProperty, r = t.toString, i = e ? e.toStringTag : void 0;
  function s(a) {
    var u = n.call(a, i), d = a[i];
    try {
      a[i] = void 0;
      var f = !0;
    } catch {
    }
    var h = r.call(a);
    return f && (u ? a[i] = d : delete a[i]), h;
  }
  return iS = s, iS;
}
var sS, sM;
function o1e() {
  if (sM) return sS;
  sM = 1;
  var e = Object.prototype, t = e.toString;
  function n(r) {
    return t.call(r);
  }
  return sS = n, sS;
}
var aS, aM;
function Ah() {
  if (aM) return aS;
  aM = 1;
  var e = /* @__PURE__ */ eg(), t = /* @__PURE__ */ a1e(), n = /* @__PURE__ */ o1e(), r = "[object Null]", i = "[object Undefined]", s = e ? e.toStringTag : void 0;
  function a(u) {
    return u == null ? u === void 0 ? i : r : s && s in Object(u) ? t(u) : n(u);
  }
  return aS = a, aS;
}
var oS, oM;
function co() {
  if (oM) return oS;
  oM = 1;
  function e(t) {
    var n = typeof t;
    return t != null && (n == "object" || n == "function");
  }
  return oS = e, oS;
}
var lS, lM;
function mx() {
  if (lM) return lS;
  lM = 1;
  var e = /* @__PURE__ */ Ah(), t = /* @__PURE__ */ co(), n = "[object AsyncFunction]", r = "[object Function]", i = "[object GeneratorFunction]", s = "[object Proxy]";
  function a(u) {
    if (!t(u))
      return !1;
    var d = e(u);
    return d == r || d == i || d == n || d == s;
  }
  return lS = a, lS;
}
var uS, uM;
function l1e() {
  if (uM) return uS;
  uM = 1;
  var e = /* @__PURE__ */ al(), t = e["__core-js_shared__"];
  return uS = t, uS;
}
var cS, cM;
function u1e() {
  if (cM) return cS;
  cM = 1;
  var e = /* @__PURE__ */ l1e(), t = (function() {
    var r = /[^.]+$/.exec(e && e.keys && e.keys.IE_PROTO || "");
    return r ? "Symbol(src)_1." + r : "";
  })();
  function n(r) {
    return !!t && t in r;
  }
  return cS = n, cS;
}
var dS, dM;
function vF() {
  if (dM) return dS;
  dM = 1;
  var e = Function.prototype, t = e.toString;
  function n(r) {
    if (r != null) {
      try {
        return t.call(r);
      } catch {
      }
      try {
        return r + "";
      } catch {
      }
    }
    return "";
  }
  return dS = n, dS;
}
var fS, fM;
function c1e() {
  if (fM) return fS;
  fM = 1;
  var e = /* @__PURE__ */ mx(), t = /* @__PURE__ */ u1e(), n = /* @__PURE__ */ co(), r = /* @__PURE__ */ vF(), i = /[\\^$.*+?()[\]{}|]/g, s = /^\[object .+?Constructor\]$/, a = Function.prototype, u = Object.prototype, d = a.toString, f = u.hasOwnProperty, h = RegExp(
    "^" + d.call(f).replace(i, "\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g, "$1.*?") + "$"
  );
  function m(x) {
    if (!n(x) || t(x))
      return !1;
    var b = e(x) ? h : s;
    return b.test(r(x));
  }
  return fS = m, fS;
}
var hS, hM;
function d1e() {
  if (hM) return hS;
  hM = 1;
  function e(t, n) {
    return t == null ? void 0 : t[n];
  }
  return hS = e, hS;
}
var pS, pM;
function Nh() {
  if (pM) return pS;
  pM = 1;
  var e = /* @__PURE__ */ c1e(), t = /* @__PURE__ */ d1e();
  function n(r, i) {
    var s = t(r, i);
    return e(s) ? s : void 0;
  }
  return pS = n, pS;
}
var mS, mM;
function Ij() {
  if (mM) return mS;
  mM = 1;
  var e = /* @__PURE__ */ Nh(), t = /* @__PURE__ */ al(), n = e(t, "Map");
  return mS = n, mS;
}
var gS, gM;
function jw() {
  if (gM) return gS;
  gM = 1;
  var e = /* @__PURE__ */ Nh(), t = e(Object, "create");
  return gS = t, gS;
}
var yS, yM;
function f1e() {
  if (yM) return yS;
  yM = 1;
  var e = /* @__PURE__ */ jw();
  function t() {
    this.__data__ = e ? e(null) : {}, this.size = 0;
  }
  return yS = t, yS;
}
var xS, xM;
function h1e() {
  if (xM) return xS;
  xM = 1;
  function e(t) {
    var n = this.has(t) && delete this.__data__[t];
    return this.size -= n ? 1 : 0, n;
  }
  return xS = e, xS;
}
var vS, vM;
function p1e() {
  if (vM) return vS;
  vM = 1;
  var e = /* @__PURE__ */ jw(), t = "__lodash_hash_undefined__", n = Object.prototype, r = n.hasOwnProperty;
  function i(s) {
    var a = this.__data__;
    if (e) {
      var u = a[s];
      return u === t ? void 0 : u;
    }
    return r.call(a, s) ? a[s] : void 0;
  }
  return vS = i, vS;
}
var bS, bM;
function m1e() {
  if (bM) return bS;
  bM = 1;
  var e = /* @__PURE__ */ jw(), t = Object.prototype, n = t.hasOwnProperty;
  function r(i) {
    var s = this.__data__;
    return e ? s[i] !== void 0 : n.call(s, i);
  }
  return bS = r, bS;
}
var wS, wM;
function g1e() {
  if (wM) return wS;
  wM = 1;
  var e = /* @__PURE__ */ jw(), t = "__lodash_hash_undefined__";
  function n(r, i) {
    var s = this.__data__;
    return this.size += this.has(r) ? 0 : 1, s[r] = e && i === void 0 ? t : i, this;
  }
  return wS = n, wS;
}
var _S, _M;
function y1e() {
  if (_M) return _S;
  _M = 1;
  var e = /* @__PURE__ */ f1e(), t = /* @__PURE__ */ h1e(), n = /* @__PURE__ */ p1e(), r = /* @__PURE__ */ m1e(), i = /* @__PURE__ */ g1e();
  function s(a) {
    var u = -1, d = a == null ? 0 : a.length;
    for (this.clear(); ++u < d; ) {
      var f = a[u];
      this.set(f[0], f[1]);
    }
  }
  return s.prototype.clear = e, s.prototype.delete = t, s.prototype.get = n, s.prototype.has = r, s.prototype.set = i, _S = s, _S;
}
var SS, SM;
function x1e() {
  if (SM) return SS;
  SM = 1;
  var e = /* @__PURE__ */ y1e(), t = /* @__PURE__ */ Tw(), n = /* @__PURE__ */ Ij();
  function r() {
    this.size = 0, this.__data__ = {
      hash: new e(),
      map: new (n || t)(),
      string: new e()
    };
  }
  return SS = r, SS;
}
var ES, EM;
function v1e() {
  if (EM) return ES;
  EM = 1;
  function e(t) {
    var n = typeof t;
    return n == "string" || n == "number" || n == "symbol" || n == "boolean" ? t !== "__proto__" : t === null;
  }
  return ES = e, ES;
}
var CS, CM;
function Aw() {
  if (CM) return CS;
  CM = 1;
  var e = /* @__PURE__ */ v1e();
  function t(n, r) {
    var i = n.__data__;
    return e(r) ? i[typeof r == "string" ? "string" : "hash"] : i.map;
  }
  return CS = t, CS;
}
var kS, kM;
function b1e() {
  if (kM) return kS;
  kM = 1;
  var e = /* @__PURE__ */ Aw();
  function t(n) {
    var r = e(this, n).delete(n);
    return this.size -= r ? 1 : 0, r;
  }
  return kS = t, kS;
}
var TS, TM;
function w1e() {
  if (TM) return TS;
  TM = 1;
  var e = /* @__PURE__ */ Aw();
  function t(n) {
    return e(this, n).get(n);
  }
  return TS = t, TS;
}
var jS, jM;
function _1e() {
  if (jM) return jS;
  jM = 1;
  var e = /* @__PURE__ */ Aw();
  function t(n) {
    return e(this, n).has(n);
  }
  return jS = t, jS;
}
var AS, AM;
function S1e() {
  if (AM) return AS;
  AM = 1;
  var e = /* @__PURE__ */ Aw();
  function t(n, r) {
    var i = e(this, n), s = i.size;
    return i.set(n, r), this.size += i.size == s ? 0 : 1, this;
  }
  return AS = t, AS;
}
var NS, NM;
function Lj() {
  if (NM) return NS;
  NM = 1;
  var e = /* @__PURE__ */ x1e(), t = /* @__PURE__ */ b1e(), n = /* @__PURE__ */ w1e(), r = /* @__PURE__ */ _1e(), i = /* @__PURE__ */ S1e();
  function s(a) {
    var u = -1, d = a == null ? 0 : a.length;
    for (this.clear(); ++u < d; ) {
      var f = a[u];
      this.set(f[0], f[1]);
    }
  }
  return s.prototype.clear = e, s.prototype.delete = t, s.prototype.get = n, s.prototype.has = r, s.prototype.set = i, NS = s, NS;
}
var RS, RM;
function E1e() {
  if (RM) return RS;
  RM = 1;
  var e = /* @__PURE__ */ Tw(), t = /* @__PURE__ */ Ij(), n = /* @__PURE__ */ Lj(), r = 200;
  function i(s, a) {
    var u = this.__data__;
    if (u instanceof e) {
      var d = u.__data__;
      if (!t || d.length < r - 1)
        return d.push([s, a]), this.size = ++u.size, this;
      u = this.__data__ = new n(d);
    }
    return u.set(s, a), this.size = u.size, this;
  }
  return RS = i, RS;
}
var MS, MM;
function Nw() {
  if (MM) return MS;
  MM = 1;
  var e = /* @__PURE__ */ Tw(), t = /* @__PURE__ */ n1e(), n = /* @__PURE__ */ r1e(), r = /* @__PURE__ */ i1e(), i = /* @__PURE__ */ s1e(), s = /* @__PURE__ */ E1e();
  function a(u) {
    var d = this.__data__ = new e(u);
    this.size = d.size;
  }
  return a.prototype.clear = t, a.prototype.delete = n, a.prototype.get = r, a.prototype.has = i, a.prototype.set = s, MS = a, MS;
}
var OS, OM;
function Bj() {
  if (OM) return OS;
  OM = 1;
  function e(t, n) {
    for (var r = -1, i = t == null ? 0 : t.length; ++r < i && n(t[r], r, t) !== !1; )
      ;
    return t;
  }
  return OS = e, OS;
}
var DS, DM;
function bF() {
  if (DM) return DS;
  DM = 1;
  var e = /* @__PURE__ */ Nh(), t = (function() {
    try {
      var n = e(Object, "defineProperty");
      return n({}, "", {}), n;
    } catch {
    }
  })();
  return DS = t, DS;
}
var zS, zM;
function Rw() {
  if (zM) return zS;
  zM = 1;
  var e = /* @__PURE__ */ bF();
  function t(n, r, i) {
    r == "__proto__" && e ? e(n, r, {
      configurable: !0,
      enumerable: !0,
      value: i,
      writable: !0
    }) : n[r] = i;
  }
  return zS = t, zS;
}
var PS, PM;
function Mw() {
  if (PM) return PS;
  PM = 1;
  var e = /* @__PURE__ */ Rw(), t = /* @__PURE__ */ Jm(), n = Object.prototype, r = n.hasOwnProperty;
  function i(s, a, u) {
    var d = s[a];
    (!(r.call(s, a) && t(d, u)) || u === void 0 && !(a in s)) && e(s, a, u);
  }
  return PS = i, PS;
}
var IS, IM;
function gx() {
  if (IM) return IS;
  IM = 1;
  var e = /* @__PURE__ */ Mw(), t = /* @__PURE__ */ Rw();
  function n(r, i, s, a) {
    var u = !s;
    s || (s = {});
    for (var d = -1, f = i.length; ++d < f; ) {
      var h = i[d], m = a ? a(s[h], r[h], h, s, r) : void 0;
      m === void 0 && (m = r[h]), u ? t(s, h, m) : e(s, h, m);
    }
    return s;
  }
  return IS = n, IS;
}
var LS, LM;
function C1e() {
  if (LM) return LS;
  LM = 1;
  function e(t, n) {
    for (var r = -1, i = Array(t); ++r < t; )
      i[r] = n(r);
    return i;
  }
  return LS = e, LS;
}
var BS, BM;
function uu() {
  if (BM) return BS;
  BM = 1;
  function e(t) {
    return t != null && typeof t == "object";
  }
  return BS = e, BS;
}
var $S, $M;
function k1e() {
  if ($M) return $S;
  $M = 1;
  var e = /* @__PURE__ */ Ah(), t = /* @__PURE__ */ uu(), n = "[object Arguments]";
  function r(i) {
    return t(i) && e(i) == n;
  }
  return $S = r, $S;
}
var qS, qM;
function yx() {
  if (qM) return qS;
  qM = 1;
  var e = /* @__PURE__ */ k1e(), t = /* @__PURE__ */ uu(), n = Object.prototype, r = n.hasOwnProperty, i = n.propertyIsEnumerable, s = e(/* @__PURE__ */ (function() {
    return arguments;
  })()) ? e : function(a) {
    return t(a) && r.call(a, "callee") && !i.call(a, "callee");
  };
  return qS = s, qS;
}
var FS, FM;
function si() {
  if (FM) return FS;
  FM = 1;
  var e = Array.isArray;
  return FS = e, FS;
}
var R1 = { exports: {} }, US, UM;
function T1e() {
  if (UM) return US;
  UM = 1;
  function e() {
    return !1;
  }
  return US = e, US;
}
var HM;
function tg() {
  return HM || (HM = 1, (function(e, t) {
    var n = /* @__PURE__ */ al(), r = /* @__PURE__ */ T1e(), i = t && !t.nodeType && t, s = i && !0 && e && !e.nodeType && e, a = s && s.exports === i, u = a ? n.Buffer : void 0, d = u ? u.isBuffer : void 0, f = d || r;
    e.exports = f;
  })(R1, R1.exports)), R1.exports;
}
var HS, VM;
function Ow() {
  if (VM) return HS;
  VM = 1;
  var e = 9007199254740991, t = /^(?:0|[1-9]\d*)$/;
  function n(r, i) {
    var s = typeof r;
    return i = i ?? e, !!i && (s == "number" || s != "symbol" && t.test(r)) && r > -1 && r % 1 == 0 && r < i;
  }
  return HS = n, HS;
}
var VS, GM;
function $j() {
  if (GM) return VS;
  GM = 1;
  var e = 9007199254740991;
  function t(n) {
    return typeof n == "number" && n > -1 && n % 1 == 0 && n <= e;
  }
  return VS = t, VS;
}
var GS, KM;
function j1e() {
  if (KM) return GS;
  KM = 1;
  var e = /* @__PURE__ */ Ah(), t = /* @__PURE__ */ $j(), n = /* @__PURE__ */ uu(), r = "[object Arguments]", i = "[object Array]", s = "[object Boolean]", a = "[object Date]", u = "[object Error]", d = "[object Function]", f = "[object Map]", h = "[object Number]", m = "[object Object]", x = "[object RegExp]", b = "[object Set]", w = "[object String]", S = "[object WeakMap]", C = "[object ArrayBuffer]", T = "[object DataView]", R = "[object Float32Array]", N = "[object Float64Array]", M = "[object Int8Array]", P = "[object Int16Array]", D = "[object Int32Array]", q = "[object Uint8Array]", Y = "[object Uint8ClampedArray]", te = "[object Uint16Array]", V = "[object Uint32Array]", $ = {};
  $[R] = $[N] = $[M] = $[P] = $[D] = $[q] = $[Y] = $[te] = $[V] = !0, $[r] = $[i] = $[C] = $[s] = $[T] = $[a] = $[u] = $[d] = $[f] = $[h] = $[m] = $[x] = $[b] = $[w] = $[S] = !1;
  function G(le) {
    return n(le) && t(le.length) && !!$[e(le)];
  }
  return GS = G, GS;
}
var KS, YM;
function Dw() {
  if (YM) return KS;
  YM = 1;
  function e(t) {
    return function(n) {
      return t(n);
    };
  }
  return KS = e, KS;
}
var M1 = { exports: {} }, WM;
function qj() {
  return WM || (WM = 1, (function(e, t) {
    var n = /* @__PURE__ */ xF(), r = t && !t.nodeType && t, i = r && !0 && e && !e.nodeType && e, s = i && i.exports === r, a = s && n.process, u = (function() {
      try {
        var d = i && i.require && i.require("util").types;
        return d || a && a.binding && a.binding("util");
      } catch {
      }
    })();
    e.exports = u;
  })(M1, M1.exports)), M1.exports;
}
var YS, ZM;
function xx() {
  if (ZM) return YS;
  ZM = 1;
  var e = /* @__PURE__ */ j1e(), t = /* @__PURE__ */ Dw(), n = /* @__PURE__ */ qj(), r = n && n.isTypedArray, i = r ? t(r) : e;
  return YS = i, YS;
}
var WS, XM;
function wF() {
  if (XM) return WS;
  XM = 1;
  var e = /* @__PURE__ */ C1e(), t = /* @__PURE__ */ yx(), n = /* @__PURE__ */ si(), r = /* @__PURE__ */ tg(), i = /* @__PURE__ */ Ow(), s = /* @__PURE__ */ xx(), a = Object.prototype, u = a.hasOwnProperty;
  function d(f, h) {
    var m = n(f), x = !m && t(f), b = !m && !x && r(f), w = !m && !x && !b && s(f), S = m || x || b || w, C = S ? e(f.length, String) : [], T = C.length;
    for (var R in f)
      (h || u.call(f, R)) && !(S && // Safari 9 has enumerable `arguments.length` in strict mode.
      (R == "length" || // Node.js 0.10 has enumerable non-index properties on buffers.
      b && (R == "offset" || R == "parent") || // PhantomJS 2 has enumerable non-index properties on typed arrays.
      w && (R == "buffer" || R == "byteLength" || R == "byteOffset") || // Skip index properties.
      i(R, T))) && C.push(R);
    return C;
  }
  return WS = d, WS;
}
var ZS, QM;
function zw() {
  if (QM) return ZS;
  QM = 1;
  var e = Object.prototype;
  function t(n) {
    var r = n && n.constructor, i = typeof r == "function" && r.prototype || e;
    return n === i;
  }
  return ZS = t, ZS;
}
var XS, JM;
function _F() {
  if (JM) return XS;
  JM = 1;
  function e(t, n) {
    return function(r) {
      return t(n(r));
    };
  }
  return XS = e, XS;
}
var QS, e9;
function A1e() {
  if (e9) return QS;
  e9 = 1;
  var e = /* @__PURE__ */ _F(), t = e(Object.keys, Object);
  return QS = t, QS;
}
var JS, t9;
function Fj() {
  if (t9) return JS;
  t9 = 1;
  var e = /* @__PURE__ */ zw(), t = /* @__PURE__ */ A1e(), n = Object.prototype, r = n.hasOwnProperty;
  function i(s) {
    if (!e(s))
      return t(s);
    var a = [];
    for (var u in Object(s))
      r.call(s, u) && u != "constructor" && a.push(u);
    return a;
  }
  return JS = i, JS;
}
var eE, n9;
function ac() {
  if (n9) return eE;
  n9 = 1;
  var e = /* @__PURE__ */ mx(), t = /* @__PURE__ */ $j();
  function n(r) {
    return r != null && t(r.length) && !e(r);
  }
  return eE = n, eE;
}
var tE, r9;
function Od() {
  if (r9) return tE;
  r9 = 1;
  var e = /* @__PURE__ */ wF(), t = /* @__PURE__ */ Fj(), n = /* @__PURE__ */ ac();
  function r(i) {
    return n(i) ? e(i) : t(i);
  }
  return tE = r, tE;
}
var nE, i9;
function N1e() {
  if (i9) return nE;
  i9 = 1;
  var e = /* @__PURE__ */ gx(), t = /* @__PURE__ */ Od();
  function n(r, i) {
    return r && e(i, t(i), r);
  }
  return nE = n, nE;
}
var rE, s9;
function R1e() {
  if (s9) return rE;
  s9 = 1;
  function e(t) {
    var n = [];
    if (t != null)
      for (var r in Object(t))
        n.push(r);
    return n;
  }
  return rE = e, rE;
}
var iE, a9;
function M1e() {
  if (a9) return iE;
  a9 = 1;
  var e = /* @__PURE__ */ co(), t = /* @__PURE__ */ zw(), n = /* @__PURE__ */ R1e(), r = Object.prototype, i = r.hasOwnProperty;
  function s(a) {
    if (!e(a))
      return n(a);
    var u = t(a), d = [];
    for (var f in a)
      f == "constructor" && (u || !i.call(a, f)) || d.push(f);
    return d;
  }
  return iE = s, iE;
}
var sE, o9;
function Rh() {
  if (o9) return sE;
  o9 = 1;
  var e = /* @__PURE__ */ wF(), t = /* @__PURE__ */ M1e(), n = /* @__PURE__ */ ac();
  function r(i) {
    return n(i) ? e(i, !0) : t(i);
  }
  return sE = r, sE;
}
var aE, l9;
function O1e() {
  if (l9) return aE;
  l9 = 1;
  var e = /* @__PURE__ */ gx(), t = /* @__PURE__ */ Rh();
  function n(r, i) {
    return r && e(i, t(i), r);
  }
  return aE = n, aE;
}
var O1 = { exports: {} }, u9;
function SF() {
  return u9 || (u9 = 1, (function(e, t) {
    var n = /* @__PURE__ */ al(), r = t && !t.nodeType && t, i = r && !0 && e && !e.nodeType && e, s = i && i.exports === r, a = s ? n.Buffer : void 0, u = a ? a.allocUnsafe : void 0;
    function d(f, h) {
      if (h)
        return f.slice();
      var m = f.length, x = u ? u(m) : new f.constructor(m);
      return f.copy(x), x;
    }
    e.exports = d;
  })(O1, O1.exports)), O1.exports;
}
var oE, c9;
function EF() {
  if (c9) return oE;
  c9 = 1;
  function e(t, n) {
    var r = -1, i = t.length;
    for (n || (n = Array(i)); ++r < i; )
      n[r] = t[r];
    return n;
  }
  return oE = e, oE;
}
var lE, d9;
function CF() {
  if (d9) return lE;
  d9 = 1;
  function e(t, n) {
    for (var r = -1, i = t == null ? 0 : t.length, s = 0, a = []; ++r < i; ) {
      var u = t[r];
      n(u, r, t) && (a[s++] = u);
    }
    return a;
  }
  return lE = e, lE;
}
var uE, f9;
function kF() {
  if (f9) return uE;
  f9 = 1;
  function e() {
    return [];
  }
  return uE = e, uE;
}
var cE, h9;
function Uj() {
  if (h9) return cE;
  h9 = 1;
  var e = /* @__PURE__ */ CF(), t = /* @__PURE__ */ kF(), n = Object.prototype, r = n.propertyIsEnumerable, i = Object.getOwnPropertySymbols, s = i ? function(a) {
    return a == null ? [] : (a = Object(a), e(i(a), function(u) {
      return r.call(a, u);
    }));
  } : t;
  return cE = s, cE;
}
var dE, p9;
function D1e() {
  if (p9) return dE;
  p9 = 1;
  var e = /* @__PURE__ */ gx(), t = /* @__PURE__ */ Uj();
  function n(r, i) {
    return e(r, t(r), i);
  }
  return dE = n, dE;
}
var fE, m9;
function Hj() {
  if (m9) return fE;
  m9 = 1;
  function e(t, n) {
    for (var r = -1, i = n.length, s = t.length; ++r < i; )
      t[s + r] = n[r];
    return t;
  }
  return fE = e, fE;
}
var hE, g9;
function Pw() {
  if (g9) return hE;
  g9 = 1;
  var e = /* @__PURE__ */ _F(), t = e(Object.getPrototypeOf, Object);
  return hE = t, hE;
}
var pE, y9;
function TF() {
  if (y9) return pE;
  y9 = 1;
  var e = /* @__PURE__ */ Hj(), t = /* @__PURE__ */ Pw(), n = /* @__PURE__ */ Uj(), r = /* @__PURE__ */ kF(), i = Object.getOwnPropertySymbols, s = i ? function(a) {
    for (var u = []; a; )
      e(u, n(a)), a = t(a);
    return u;
  } : r;
  return pE = s, pE;
}
var mE, x9;
function z1e() {
  if (x9) return mE;
  x9 = 1;
  var e = /* @__PURE__ */ gx(), t = /* @__PURE__ */ TF();
  function n(r, i) {
    return e(r, t(r), i);
  }
  return mE = n, mE;
}
var gE, v9;
function jF() {
  if (v9) return gE;
  v9 = 1;
  var e = /* @__PURE__ */ Hj(), t = /* @__PURE__ */ si();
  function n(r, i, s) {
    var a = i(r);
    return t(r) ? a : e(a, s(r));
  }
  return gE = n, gE;
}
var yE, b9;
function AF() {
  if (b9) return yE;
  b9 = 1;
  var e = /* @__PURE__ */ jF(), t = /* @__PURE__ */ Uj(), n = /* @__PURE__ */ Od();
  function r(i) {
    return e(i, n, t);
  }
  return yE = r, yE;
}
var xE, w9;
function P1e() {
  if (w9) return xE;
  w9 = 1;
  var e = /* @__PURE__ */ jF(), t = /* @__PURE__ */ TF(), n = /* @__PURE__ */ Rh();
  function r(i) {
    return e(i, n, t);
  }
  return xE = r, xE;
}
var vE, _9;
function I1e() {
  if (_9) return vE;
  _9 = 1;
  var e = /* @__PURE__ */ Nh(), t = /* @__PURE__ */ al(), n = e(t, "DataView");
  return vE = n, vE;
}
var bE, S9;
function L1e() {
  if (S9) return bE;
  S9 = 1;
  var e = /* @__PURE__ */ Nh(), t = /* @__PURE__ */ al(), n = e(t, "Promise");
  return bE = n, bE;
}
var wE, E9;
function NF() {
  if (E9) return wE;
  E9 = 1;
  var e = /* @__PURE__ */ Nh(), t = /* @__PURE__ */ al(), n = e(t, "Set");
  return wE = n, wE;
}
var _E, C9;
function B1e() {
  if (C9) return _E;
  C9 = 1;
  var e = /* @__PURE__ */ Nh(), t = /* @__PURE__ */ al(), n = e(t, "WeakMap");
  return _E = n, _E;
}
var SE, k9;
function ng() {
  if (k9) return SE;
  k9 = 1;
  var e = /* @__PURE__ */ I1e(), t = /* @__PURE__ */ Ij(), n = /* @__PURE__ */ L1e(), r = /* @__PURE__ */ NF(), i = /* @__PURE__ */ B1e(), s = /* @__PURE__ */ Ah(), a = /* @__PURE__ */ vF(), u = "[object Map]", d = "[object Object]", f = "[object Promise]", h = "[object Set]", m = "[object WeakMap]", x = "[object DataView]", b = a(e), w = a(t), S = a(n), C = a(r), T = a(i), R = s;
  return (e && R(new e(new ArrayBuffer(1))) != x || t && R(new t()) != u || n && R(n.resolve()) != f || r && R(new r()) != h || i && R(new i()) != m) && (R = function(N) {
    var M = s(N), P = M == d ? N.constructor : void 0, D = P ? a(P) : "";
    if (D)
      switch (D) {
        case b:
          return x;
        case w:
          return u;
        case S:
          return f;
        case C:
          return h;
        case T:
          return m;
      }
    return M;
  }), SE = R, SE;
}
var EE, T9;
function $1e() {
  if (T9) return EE;
  T9 = 1;
  var e = Object.prototype, t = e.hasOwnProperty;
  function n(r) {
    var i = r.length, s = new r.constructor(i);
    return i && typeof r[0] == "string" && t.call(r, "index") && (s.index = r.index, s.input = r.input), s;
  }
  return EE = n, EE;
}
var CE, j9;
function RF() {
  if (j9) return CE;
  j9 = 1;
  var e = /* @__PURE__ */ al(), t = e.Uint8Array;
  return CE = t, CE;
}
var kE, A9;
function Vj() {
  if (A9) return kE;
  A9 = 1;
  var e = /* @__PURE__ */ RF();
  function t(n) {
    var r = new n.constructor(n.byteLength);
    return new e(r).set(new e(n)), r;
  }
  return kE = t, kE;
}
var TE, N9;
function q1e() {
  if (N9) return TE;
  N9 = 1;
  var e = /* @__PURE__ */ Vj();
  function t(n, r) {
    var i = r ? e(n.buffer) : n.buffer;
    return new n.constructor(i, n.byteOffset, n.byteLength);
  }
  return TE = t, TE;
}
var jE, R9;
function F1e() {
  if (R9) return jE;
  R9 = 1;
  var e = /\w*$/;
  function t(n) {
    var r = new n.constructor(n.source, e.exec(n));
    return r.lastIndex = n.lastIndex, r;
  }
  return jE = t, jE;
}
var AE, M9;
function U1e() {
  if (M9) return AE;
  M9 = 1;
  var e = /* @__PURE__ */ eg(), t = e ? e.prototype : void 0, n = t ? t.valueOf : void 0;
  function r(i) {
    return n ? Object(n.call(i)) : {};
  }
  return AE = r, AE;
}
var NE, O9;
function MF() {
  if (O9) return NE;
  O9 = 1;
  var e = /* @__PURE__ */ Vj();
  function t(n, r) {
    var i = r ? e(n.buffer) : n.buffer;
    return new n.constructor(i, n.byteOffset, n.length);
  }
  return NE = t, NE;
}
var RE, D9;
function H1e() {
  if (D9) return RE;
  D9 = 1;
  var e = /* @__PURE__ */ Vj(), t = /* @__PURE__ */ q1e(), n = /* @__PURE__ */ F1e(), r = /* @__PURE__ */ U1e(), i = /* @__PURE__ */ MF(), s = "[object Boolean]", a = "[object Date]", u = "[object Map]", d = "[object Number]", f = "[object RegExp]", h = "[object Set]", m = "[object String]", x = "[object Symbol]", b = "[object ArrayBuffer]", w = "[object DataView]", S = "[object Float32Array]", C = "[object Float64Array]", T = "[object Int8Array]", R = "[object Int16Array]", N = "[object Int32Array]", M = "[object Uint8Array]", P = "[object Uint8ClampedArray]", D = "[object Uint16Array]", q = "[object Uint32Array]";
  function Y(te, V, $) {
    var G = te.constructor;
    switch (V) {
      case b:
        return e(te);
      case s:
      case a:
        return new G(+te);
      case w:
        return t(te, $);
      case S:
      case C:
      case T:
      case R:
      case N:
      case M:
      case P:
      case D:
      case q:
        return i(te, $);
      case u:
        return new G();
      case d:
      case m:
        return new G(te);
      case f:
        return n(te);
      case h:
        return new G();
      case x:
        return r(te);
    }
  }
  return RE = Y, RE;
}
var ME, z9;
function OF() {
  if (z9) return ME;
  z9 = 1;
  var e = /* @__PURE__ */ co(), t = Object.create, n = /* @__PURE__ */ (function() {
    function r() {
    }
    return function(i) {
      if (!e(i))
        return {};
      if (t)
        return t(i);
      r.prototype = i;
      var s = new r();
      return r.prototype = void 0, s;
    };
  })();
  return ME = n, ME;
}
var OE, P9;
function DF() {
  if (P9) return OE;
  P9 = 1;
  var e = /* @__PURE__ */ OF(), t = /* @__PURE__ */ Pw(), n = /* @__PURE__ */ zw();
  function r(i) {
    return typeof i.constructor == "function" && !n(i) ? e(t(i)) : {};
  }
  return OE = r, OE;
}
var DE, I9;
function V1e() {
  if (I9) return DE;
  I9 = 1;
  var e = /* @__PURE__ */ ng(), t = /* @__PURE__ */ uu(), n = "[object Map]";
  function r(i) {
    return t(i) && e(i) == n;
  }
  return DE = r, DE;
}
var zE, L9;
function G1e() {
  if (L9) return zE;
  L9 = 1;
  var e = /* @__PURE__ */ V1e(), t = /* @__PURE__ */ Dw(), n = /* @__PURE__ */ qj(), r = n && n.isMap, i = r ? t(r) : e;
  return zE = i, zE;
}
var PE, B9;
function K1e() {
  if (B9) return PE;
  B9 = 1;
  var e = /* @__PURE__ */ ng(), t = /* @__PURE__ */ uu(), n = "[object Set]";
  function r(i) {
    return t(i) && e(i) == n;
  }
  return PE = r, PE;
}
var IE, $9;
function Y1e() {
  if ($9) return IE;
  $9 = 1;
  var e = /* @__PURE__ */ K1e(), t = /* @__PURE__ */ Dw(), n = /* @__PURE__ */ qj(), r = n && n.isSet, i = r ? t(r) : e;
  return IE = i, IE;
}
var LE, q9;
function zF() {
  if (q9) return LE;
  q9 = 1;
  var e = /* @__PURE__ */ Nw(), t = /* @__PURE__ */ Bj(), n = /* @__PURE__ */ Mw(), r = /* @__PURE__ */ N1e(), i = /* @__PURE__ */ O1e(), s = /* @__PURE__ */ SF(), a = /* @__PURE__ */ EF(), u = /* @__PURE__ */ D1e(), d = /* @__PURE__ */ z1e(), f = /* @__PURE__ */ AF(), h = /* @__PURE__ */ P1e(), m = /* @__PURE__ */ ng(), x = /* @__PURE__ */ $1e(), b = /* @__PURE__ */ H1e(), w = /* @__PURE__ */ DF(), S = /* @__PURE__ */ si(), C = /* @__PURE__ */ tg(), T = /* @__PURE__ */ G1e(), R = /* @__PURE__ */ co(), N = /* @__PURE__ */ Y1e(), M = /* @__PURE__ */ Od(), P = /* @__PURE__ */ Rh(), D = 1, q = 2, Y = 4, te = "[object Arguments]", V = "[object Array]", $ = "[object Boolean]", G = "[object Date]", le = "[object Error]", Z = "[object Function]", oe = "[object GeneratorFunction]", X = "[object Map]", ce = "[object Number]", pe = "[object Object]", de = "[object RegExp]", H = "[object Set]", J = "[object String]", ge = "[object Symbol]", Q = "[object WeakMap]", fe = "[object ArrayBuffer]", ve = "[object DataView]", Se = "[object Float32Array]", Me = "[object Float64Array]", Ie = "[object Int8Array]", Re = "[object Int16Array]", mt = "[object Int32Array]", dt = "[object Uint8Array]", Je = "[object Uint8ClampedArray]", ft = "[object Uint16Array]", yt = "[object Uint32Array]", ht = {};
  ht[te] = ht[V] = ht[fe] = ht[ve] = ht[$] = ht[G] = ht[Se] = ht[Me] = ht[Ie] = ht[Re] = ht[mt] = ht[X] = ht[ce] = ht[pe] = ht[de] = ht[H] = ht[J] = ht[ge] = ht[dt] = ht[Je] = ht[ft] = ht[yt] = !0, ht[le] = ht[Z] = ht[Q] = !1;
  function Le(Ye, gt, Dt, pn, Ht, zn) {
    var nn, kn = gt & D, Nn = gt & q, $e = gt & Y;
    if (Dt && (nn = Ht ? Dt(Ye, pn, Ht, zn) : Dt(Ye)), nn !== void 0)
      return nn;
    if (!R(Ye))
      return Ye;
    var Qe = S(Ye);
    if (Qe) {
      if (nn = x(Ye), !kn)
        return a(Ye, nn);
    } else {
      var bt = m(Ye), jt = bt == Z || bt == oe;
      if (C(Ye))
        return s(Ye, kn);
      if (bt == pe || bt == te || jt && !Ht) {
        if (nn = Nn || jt ? {} : w(Ye), !kn)
          return Nn ? d(Ye, i(nn, Ye)) : u(Ye, r(nn, Ye));
      } else {
        if (!ht[bt])
          return Ht ? Ye : {};
        nn = b(Ye, bt, kn);
      }
    }
    zn || (zn = new e());
    var $t = zn.get(Ye);
    if ($t)
      return $t;
    zn.set(Ye, nn), N(Ye) ? Ye.forEach(function(on) {
      nn.add(Le(on, gt, Dt, on, Ye, zn));
    }) : T(Ye) && Ye.forEach(function(on, Jt) {
      nn.set(Jt, Le(on, gt, Dt, Jt, Ye, zn));
    });
    var Un = $e ? Nn ? h : f : Nn ? P : M, Hn = Qe ? void 0 : Un(Ye);
    return t(Hn || Ye, function(on, Jt) {
      Hn && (Jt = on, on = Ye[Jt]), n(nn, Jt, Le(on, gt, Dt, Jt, Ye, zn));
    }), nn;
  }
  return LE = Le, LE;
}
var BE, F9;
function W1e() {
  if (F9) return BE;
  F9 = 1;
  var e = /* @__PURE__ */ zF(), t = 4;
  function n(r) {
    return e(r, t);
  }
  return BE = n, BE;
}
var $E, U9;
function Gj() {
  if (U9) return $E;
  U9 = 1;
  function e(t) {
    return function() {
      return t;
    };
  }
  return $E = e, $E;
}
var qE, H9;
function Z1e() {
  if (H9) return qE;
  H9 = 1;
  function e(t) {
    return function(n, r, i) {
      for (var s = -1, a = Object(n), u = i(n), d = u.length; d--; ) {
        var f = u[t ? d : ++s];
        if (r(a[f], f, a) === !1)
          break;
      }
      return n;
    };
  }
  return qE = e, qE;
}
var FE, V9;
function Kj() {
  if (V9) return FE;
  V9 = 1;
  var e = /* @__PURE__ */ Z1e(), t = e();
  return FE = t, FE;
}
var UE, G9;
function Yj() {
  if (G9) return UE;
  G9 = 1;
  var e = /* @__PURE__ */ Kj(), t = /* @__PURE__ */ Od();
  function n(r, i) {
    return r && e(r, i, t);
  }
  return UE = n, UE;
}
var HE, K9;
function X1e() {
  if (K9) return HE;
  K9 = 1;
  var e = /* @__PURE__ */ ac();
  function t(n, r) {
    return function(i, s) {
      if (i == null)
        return i;
      if (!e(i))
        return n(i, s);
      for (var a = i.length, u = r ? a : -1, d = Object(i); (r ? u-- : ++u < a) && s(d[u], u, d) !== !1; )
        ;
      return i;
    };
  }
  return HE = t, HE;
}
var VE, Y9;
function Iw() {
  if (Y9) return VE;
  Y9 = 1;
  var e = /* @__PURE__ */ Yj(), t = /* @__PURE__ */ X1e(), n = t(e);
  return VE = n, VE;
}
var GE, W9;
function Mh() {
  if (W9) return GE;
  W9 = 1;
  function e(t) {
    return t;
  }
  return GE = e, GE;
}
var KE, Z9;
function PF() {
  if (Z9) return KE;
  Z9 = 1;
  var e = /* @__PURE__ */ Mh();
  function t(n) {
    return typeof n == "function" ? n : e;
  }
  return KE = t, KE;
}
var YE, X9;
function IF() {
  if (X9) return YE;
  X9 = 1;
  var e = /* @__PURE__ */ Bj(), t = /* @__PURE__ */ Iw(), n = /* @__PURE__ */ PF(), r = /* @__PURE__ */ si();
  function i(s, a) {
    var u = r(s) ? e : t;
    return u(s, n(a));
  }
  return YE = i, YE;
}
var WE, Q9;
function LF() {
  return Q9 || (Q9 = 1, WE = /* @__PURE__ */ IF()), WE;
}
var ZE, J9;
function Q1e() {
  if (J9) return ZE;
  J9 = 1;
  var e = /* @__PURE__ */ Iw();
  function t(n, r) {
    var i = [];
    return e(n, function(s, a, u) {
      r(s, a, u) && i.push(s);
    }), i;
  }
  return ZE = t, ZE;
}
var XE, eO;
function J1e() {
  if (eO) return XE;
  eO = 1;
  var e = "__lodash_hash_undefined__";
  function t(n) {
    return this.__data__.set(n, e), this;
  }
  return XE = t, XE;
}
var QE, tO;
function ebe() {
  if (tO) return QE;
  tO = 1;
  function e(t) {
    return this.__data__.has(t);
  }
  return QE = e, QE;
}
var JE, nO;
function BF() {
  if (nO) return JE;
  nO = 1;
  var e = /* @__PURE__ */ Lj(), t = /* @__PURE__ */ J1e(), n = /* @__PURE__ */ ebe();
  function r(i) {
    var s = -1, a = i == null ? 0 : i.length;
    for (this.__data__ = new e(); ++s < a; )
      this.add(i[s]);
  }
  return r.prototype.add = r.prototype.push = t, r.prototype.has = n, JE = r, JE;
}
var eC, rO;
function tbe() {
  if (rO) return eC;
  rO = 1;
  function e(t, n) {
    for (var r = -1, i = t == null ? 0 : t.length; ++r < i; )
      if (n(t[r], r, t))
        return !0;
    return !1;
  }
  return eC = e, eC;
}
var tC, iO;
function $F() {
  if (iO) return tC;
  iO = 1;
  function e(t, n) {
    return t.has(n);
  }
  return tC = e, tC;
}
var nC, sO;
function qF() {
  if (sO) return nC;
  sO = 1;
  var e = /* @__PURE__ */ BF(), t = /* @__PURE__ */ tbe(), n = /* @__PURE__ */ $F(), r = 1, i = 2;
  function s(a, u, d, f, h, m) {
    var x = d & r, b = a.length, w = u.length;
    if (b != w && !(x && w > b))
      return !1;
    var S = m.get(a), C = m.get(u);
    if (S && C)
      return S == u && C == a;
    var T = -1, R = !0, N = d & i ? new e() : void 0;
    for (m.set(a, u), m.set(u, a); ++T < b; ) {
      var M = a[T], P = u[T];
      if (f)
        var D = x ? f(P, M, T, u, a, m) : f(M, P, T, a, u, m);
      if (D !== void 0) {
        if (D)
          continue;
        R = !1;
        break;
      }
      if (N) {
        if (!t(u, function(q, Y) {
          if (!n(N, Y) && (M === q || h(M, q, d, f, m)))
            return N.push(Y);
        })) {
          R = !1;
          break;
        }
      } else if (!(M === P || h(M, P, d, f, m))) {
        R = !1;
        break;
      }
    }
    return m.delete(a), m.delete(u), R;
  }
  return nC = s, nC;
}
var rC, aO;
function nbe() {
  if (aO) return rC;
  aO = 1;
  function e(t) {
    var n = -1, r = Array(t.size);
    return t.forEach(function(i, s) {
      r[++n] = [s, i];
    }), r;
  }
  return rC = e, rC;
}
var iC, oO;
function Wj() {
  if (oO) return iC;
  oO = 1;
  function e(t) {
    var n = -1, r = Array(t.size);
    return t.forEach(function(i) {
      r[++n] = i;
    }), r;
  }
  return iC = e, iC;
}
var sC, lO;
function rbe() {
  if (lO) return sC;
  lO = 1;
  var e = /* @__PURE__ */ eg(), t = /* @__PURE__ */ RF(), n = /* @__PURE__ */ Jm(), r = /* @__PURE__ */ qF(), i = /* @__PURE__ */ nbe(), s = /* @__PURE__ */ Wj(), a = 1, u = 2, d = "[object Boolean]", f = "[object Date]", h = "[object Error]", m = "[object Map]", x = "[object Number]", b = "[object RegExp]", w = "[object Set]", S = "[object String]", C = "[object Symbol]", T = "[object ArrayBuffer]", R = "[object DataView]", N = e ? e.prototype : void 0, M = N ? N.valueOf : void 0;
  function P(D, q, Y, te, V, $, G) {
    switch (Y) {
      case R:
        if (D.byteLength != q.byteLength || D.byteOffset != q.byteOffset)
          return !1;
        D = D.buffer, q = q.buffer;
      case T:
        return !(D.byteLength != q.byteLength || !$(new t(D), new t(q)));
      case d:
      case f:
      case x:
        return n(+D, +q);
      case h:
        return D.name == q.name && D.message == q.message;
      case b:
      case S:
        return D == q + "";
      case m:
        var le = i;
      case w:
        var Z = te & a;
        if (le || (le = s), D.size != q.size && !Z)
          return !1;
        var oe = G.get(D);
        if (oe)
          return oe == q;
        te |= u, G.set(D, q);
        var X = r(le(D), le(q), te, V, $, G);
        return G.delete(D), X;
      case C:
        if (M)
          return M.call(D) == M.call(q);
    }
    return !1;
  }
  return sC = P, sC;
}
var aC, uO;
function ibe() {
  if (uO) return aC;
  uO = 1;
  var e = /* @__PURE__ */ AF(), t = 1, n = Object.prototype, r = n.hasOwnProperty;
  function i(s, a, u, d, f, h) {
    var m = u & t, x = e(s), b = x.length, w = e(a), S = w.length;
    if (b != S && !m)
      return !1;
    for (var C = b; C--; ) {
      var T = x[C];
      if (!(m ? T in a : r.call(a, T)))
        return !1;
    }
    var R = h.get(s), N = h.get(a);
    if (R && N)
      return R == a && N == s;
    var M = !0;
    h.set(s, a), h.set(a, s);
    for (var P = m; ++C < b; ) {
      T = x[C];
      var D = s[T], q = a[T];
      if (d)
        var Y = m ? d(q, D, T, a, s, h) : d(D, q, T, s, a, h);
      if (!(Y === void 0 ? D === q || f(D, q, u, d, h) : Y)) {
        M = !1;
        break;
      }
      P || (P = T == "constructor");
    }
    if (M && !P) {
      var te = s.constructor, V = a.constructor;
      te != V && "constructor" in s && "constructor" in a && !(typeof te == "function" && te instanceof te && typeof V == "function" && V instanceof V) && (M = !1);
    }
    return h.delete(s), h.delete(a), M;
  }
  return aC = i, aC;
}
var oC, cO;
function sbe() {
  if (cO) return oC;
  cO = 1;
  var e = /* @__PURE__ */ Nw(), t = /* @__PURE__ */ qF(), n = /* @__PURE__ */ rbe(), r = /* @__PURE__ */ ibe(), i = /* @__PURE__ */ ng(), s = /* @__PURE__ */ si(), a = /* @__PURE__ */ tg(), u = /* @__PURE__ */ xx(), d = 1, f = "[object Arguments]", h = "[object Array]", m = "[object Object]", x = Object.prototype, b = x.hasOwnProperty;
  function w(S, C, T, R, N, M) {
    var P = s(S), D = s(C), q = P ? h : i(S), Y = D ? h : i(C);
    q = q == f ? m : q, Y = Y == f ? m : Y;
    var te = q == m, V = Y == m, $ = q == Y;
    if ($ && a(S)) {
      if (!a(C))
        return !1;
      P = !0, te = !1;
    }
    if ($ && !te)
      return M || (M = new e()), P || u(S) ? t(S, C, T, R, N, M) : n(S, C, q, T, R, N, M);
    if (!(T & d)) {
      var G = te && b.call(S, "__wrapped__"), le = V && b.call(C, "__wrapped__");
      if (G || le) {
        var Z = G ? S.value() : S, oe = le ? C.value() : C;
        return M || (M = new e()), N(Z, oe, T, R, M);
      }
    }
    return $ ? (M || (M = new e()), r(S, C, T, R, N, M)) : !1;
  }
  return oC = w, oC;
}
var lC, dO;
function FF() {
  if (dO) return lC;
  dO = 1;
  var e = /* @__PURE__ */ sbe(), t = /* @__PURE__ */ uu();
  function n(r, i, s, a, u) {
    return r === i ? !0 : r == null || i == null || !t(r) && !t(i) ? r !== r && i !== i : e(r, i, s, a, n, u);
  }
  return lC = n, lC;
}
var uC, fO;
function abe() {
  if (fO) return uC;
  fO = 1;
  var e = /* @__PURE__ */ Nw(), t = /* @__PURE__ */ FF(), n = 1, r = 2;
  function i(s, a, u, d) {
    var f = u.length, h = f, m = !d;
    if (s == null)
      return !h;
    for (s = Object(s); f--; ) {
      var x = u[f];
      if (m && x[2] ? x[1] !== s[x[0]] : !(x[0] in s))
        return !1;
    }
    for (; ++f < h; ) {
      x = u[f];
      var b = x[0], w = s[b], S = x[1];
      if (m && x[2]) {
        if (w === void 0 && !(b in s))
          return !1;
      } else {
        var C = new e();
        if (d)
          var T = d(w, S, b, s, a, C);
        if (!(T === void 0 ? t(S, w, n | r, d, C) : T))
          return !1;
      }
    }
    return !0;
  }
  return uC = i, uC;
}
var cC, hO;
function UF() {
  if (hO) return cC;
  hO = 1;
  var e = /* @__PURE__ */ co();
  function t(n) {
    return n === n && !e(n);
  }
  return cC = t, cC;
}
var dC, pO;
function obe() {
  if (pO) return dC;
  pO = 1;
  var e = /* @__PURE__ */ UF(), t = /* @__PURE__ */ Od();
  function n(r) {
    for (var i = t(r), s = i.length; s--; ) {
      var a = i[s], u = r[a];
      i[s] = [a, u, e(u)];
    }
    return i;
  }
  return dC = n, dC;
}
var fC, mO;
function HF() {
  if (mO) return fC;
  mO = 1;
  function e(t, n) {
    return function(r) {
      return r == null ? !1 : r[t] === n && (n !== void 0 || t in Object(r));
    };
  }
  return fC = e, fC;
}
var hC, gO;
function lbe() {
  if (gO) return hC;
  gO = 1;
  var e = /* @__PURE__ */ abe(), t = /* @__PURE__ */ obe(), n = /* @__PURE__ */ HF();
  function r(i) {
    var s = t(i);
    return s.length == 1 && s[0][2] ? n(s[0][0], s[0][1]) : function(a) {
      return a === i || e(a, i, s);
    };
  }
  return hC = r, hC;
}
var pC, yO;
function rg() {
  if (yO) return pC;
  yO = 1;
  var e = /* @__PURE__ */ Ah(), t = /* @__PURE__ */ uu(), n = "[object Symbol]";
  function r(i) {
    return typeof i == "symbol" || t(i) && e(i) == n;
  }
  return pC = r, pC;
}
var mC, xO;
function Zj() {
  if (xO) return mC;
  xO = 1;
  var e = /* @__PURE__ */ si(), t = /* @__PURE__ */ rg(), n = /\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/, r = /^\w*$/;
  function i(s, a) {
    if (e(s))
      return !1;
    var u = typeof s;
    return u == "number" || u == "symbol" || u == "boolean" || s == null || t(s) ? !0 : r.test(s) || !n.test(s) || a != null && s in Object(a);
  }
  return mC = i, mC;
}
var gC, vO;
function ube() {
  if (vO) return gC;
  vO = 1;
  var e = /* @__PURE__ */ Lj(), t = "Expected a function";
  function n(r, i) {
    if (typeof r != "function" || i != null && typeof i != "function")
      throw new TypeError(t);
    var s = function() {
      var a = arguments, u = i ? i.apply(this, a) : a[0], d = s.cache;
      if (d.has(u))
        return d.get(u);
      var f = r.apply(this, a);
      return s.cache = d.set(u, f) || d, f;
    };
    return s.cache = new (n.Cache || e)(), s;
  }
  return n.Cache = e, gC = n, gC;
}
var yC, bO;
function cbe() {
  if (bO) return yC;
  bO = 1;
  var e = /* @__PURE__ */ ube(), t = 500;
  function n(r) {
    var i = e(r, function(a) {
      return s.size === t && s.clear(), a;
    }), s = i.cache;
    return i;
  }
  return yC = n, yC;
}
var xC, wO;
function dbe() {
  if (wO) return xC;
  wO = 1;
  var e = /* @__PURE__ */ cbe(), t = /[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g, n = /\\(\\)?/g, r = e(function(i) {
    var s = [];
    return i.charCodeAt(0) === 46 && s.push(""), i.replace(t, function(a, u, d, f) {
      s.push(d ? f.replace(n, "$1") : u || a);
    }), s;
  });
  return xC = r, xC;
}
var vC, _O;
function Lw() {
  if (_O) return vC;
  _O = 1;
  function e(t, n) {
    for (var r = -1, i = t == null ? 0 : t.length, s = Array(i); ++r < i; )
      s[r] = n(t[r], r, t);
    return s;
  }
  return vC = e, vC;
}
var bC, SO;
function fbe() {
  if (SO) return bC;
  SO = 1;
  var e = /* @__PURE__ */ eg(), t = /* @__PURE__ */ Lw(), n = /* @__PURE__ */ si(), r = /* @__PURE__ */ rg(), i = e ? e.prototype : void 0, s = i ? i.toString : void 0;
  function a(u) {
    if (typeof u == "string")
      return u;
    if (n(u))
      return t(u, a) + "";
    if (r(u))
      return s ? s.call(u) : "";
    var d = u + "";
    return d == "0" && 1 / u == -1 / 0 ? "-0" : d;
  }
  return bC = a, bC;
}
var wC, EO;
function VF() {
  if (EO) return wC;
  EO = 1;
  var e = /* @__PURE__ */ fbe();
  function t(n) {
    return n == null ? "" : e(n);
  }
  return wC = t, wC;
}
var _C, CO;
function Bw() {
  if (CO) return _C;
  CO = 1;
  var e = /* @__PURE__ */ si(), t = /* @__PURE__ */ Zj(), n = /* @__PURE__ */ dbe(), r = /* @__PURE__ */ VF();
  function i(s, a) {
    return e(s) ? s : t(s, a) ? [s] : n(r(s));
  }
  return _C = i, _C;
}
var SC, kO;
function vx() {
  if (kO) return SC;
  kO = 1;
  var e = /* @__PURE__ */ rg();
  function t(n) {
    if (typeof n == "string" || e(n))
      return n;
    var r = n + "";
    return r == "0" && 1 / n == -1 / 0 ? "-0" : r;
  }
  return SC = t, SC;
}
var EC, TO;
function $w() {
  if (TO) return EC;
  TO = 1;
  var e = /* @__PURE__ */ Bw(), t = /* @__PURE__ */ vx();
  function n(r, i) {
    i = e(i, r);
    for (var s = 0, a = i.length; r != null && s < a; )
      r = r[t(i[s++])];
    return s && s == a ? r : void 0;
  }
  return EC = n, EC;
}
var CC, jO;
function hbe() {
  if (jO) return CC;
  jO = 1;
  var e = /* @__PURE__ */ $w();
  function t(n, r, i) {
    var s = n == null ? void 0 : e(n, r);
    return s === void 0 ? i : s;
  }
  return CC = t, CC;
}
var kC, AO;
function pbe() {
  if (AO) return kC;
  AO = 1;
  function e(t, n) {
    return t != null && n in Object(t);
  }
  return kC = e, kC;
}
var TC, NO;
function GF() {
  if (NO) return TC;
  NO = 1;
  var e = /* @__PURE__ */ Bw(), t = /* @__PURE__ */ yx(), n = /* @__PURE__ */ si(), r = /* @__PURE__ */ Ow(), i = /* @__PURE__ */ $j(), s = /* @__PURE__ */ vx();
  function a(u, d, f) {
    d = e(d, u);
    for (var h = -1, m = d.length, x = !1; ++h < m; ) {
      var b = s(d[h]);
      if (!(x = u != null && f(u, b)))
        break;
      u = u[b];
    }
    return x || ++h != m ? x : (m = u == null ? 0 : u.length, !!m && i(m) && r(b, m) && (n(u) || t(u)));
  }
  return TC = a, TC;
}
var jC, RO;
function KF() {
  if (RO) return jC;
  RO = 1;
  var e = /* @__PURE__ */ pbe(), t = /* @__PURE__ */ GF();
  function n(r, i) {
    return r != null && t(r, i, e);
  }
  return jC = n, jC;
}
var AC, MO;
function mbe() {
  if (MO) return AC;
  MO = 1;
  var e = /* @__PURE__ */ FF(), t = /* @__PURE__ */ hbe(), n = /* @__PURE__ */ KF(), r = /* @__PURE__ */ Zj(), i = /* @__PURE__ */ UF(), s = /* @__PURE__ */ HF(), a = /* @__PURE__ */ vx(), u = 1, d = 2;
  function f(h, m) {
    return r(h) && i(m) ? s(a(h), m) : function(x) {
      var b = t(x, h);
      return b === void 0 && b === m ? n(x, h) : e(m, b, u | d);
    };
  }
  return AC = f, AC;
}
var NC, OO;
function YF() {
  if (OO) return NC;
  OO = 1;
  function e(t) {
    return function(n) {
      return n == null ? void 0 : n[t];
    };
  }
  return NC = e, NC;
}
var RC, DO;
function gbe() {
  if (DO) return RC;
  DO = 1;
  var e = /* @__PURE__ */ $w();
  function t(n) {
    return function(r) {
      return e(r, n);
    };
  }
  return RC = t, RC;
}
var MC, zO;
function ybe() {
  if (zO) return MC;
  zO = 1;
  var e = /* @__PURE__ */ YF(), t = /* @__PURE__ */ gbe(), n = /* @__PURE__ */ Zj(), r = /* @__PURE__ */ vx();
  function i(s) {
    return n(s) ? e(r(s)) : t(s);
  }
  return MC = i, MC;
}
var OC, PO;
function oc() {
  if (PO) return OC;
  PO = 1;
  var e = /* @__PURE__ */ lbe(), t = /* @__PURE__ */ mbe(), n = /* @__PURE__ */ Mh(), r = /* @__PURE__ */ si(), i = /* @__PURE__ */ ybe();
  function s(a) {
    return typeof a == "function" ? a : a == null ? n : typeof a == "object" ? r(a) ? t(a[0], a[1]) : e(a) : i(a);
  }
  return OC = s, OC;
}
var DC, IO;
function WF() {
  if (IO) return DC;
  IO = 1;
  var e = /* @__PURE__ */ CF(), t = /* @__PURE__ */ Q1e(), n = /* @__PURE__ */ oc(), r = /* @__PURE__ */ si();
  function i(s, a) {
    var u = r(s) ? e : t;
    return u(s, n(a, 3));
  }
  return DC = i, DC;
}
var zC, LO;
function xbe() {
  if (LO) return zC;
  LO = 1;
  var e = Object.prototype, t = e.hasOwnProperty;
  function n(r, i) {
    return r != null && t.call(r, i);
  }
  return zC = n, zC;
}
var PC, BO;
function ZF() {
  if (BO) return PC;
  BO = 1;
  var e = /* @__PURE__ */ xbe(), t = /* @__PURE__ */ GF();
  function n(r, i) {
    return r != null && t(r, i, e);
  }
  return PC = n, PC;
}
var IC, $O;
function vbe() {
  if ($O) return IC;
  $O = 1;
  var e = /* @__PURE__ */ Fj(), t = /* @__PURE__ */ ng(), n = /* @__PURE__ */ yx(), r = /* @__PURE__ */ si(), i = /* @__PURE__ */ ac(), s = /* @__PURE__ */ tg(), a = /* @__PURE__ */ zw(), u = /* @__PURE__ */ xx(), d = "[object Map]", f = "[object Set]", h = Object.prototype, m = h.hasOwnProperty;
  function x(b) {
    if (b == null)
      return !0;
    if (i(b) && (r(b) || typeof b == "string" || typeof b.splice == "function" || s(b) || u(b) || n(b)))
      return !b.length;
    var w = t(b);
    if (w == d || w == f)
      return !b.size;
    if (a(b))
      return !e(b).length;
    for (var S in b)
      if (m.call(b, S))
        return !1;
    return !0;
  }
  return IC = x, IC;
}
var LC, qO;
function XF() {
  if (qO) return LC;
  qO = 1;
  function e(t) {
    return t === void 0;
  }
  return LC = e, LC;
}
var BC, FO;
function QF() {
  if (FO) return BC;
  FO = 1;
  var e = /* @__PURE__ */ Iw(), t = /* @__PURE__ */ ac();
  function n(r, i) {
    var s = -1, a = t(r) ? Array(r.length) : [];
    return e(r, function(u, d, f) {
      a[++s] = i(u, d, f);
    }), a;
  }
  return BC = n, BC;
}
var $C, UO;
function JF() {
  if (UO) return $C;
  UO = 1;
  var e = /* @__PURE__ */ Lw(), t = /* @__PURE__ */ oc(), n = /* @__PURE__ */ QF(), r = /* @__PURE__ */ si();
  function i(s, a) {
    var u = r(s) ? e : n;
    return u(s, t(a, 3));
  }
  return $C = i, $C;
}
var qC, HO;
function bbe() {
  if (HO) return qC;
  HO = 1;
  function e(t, n, r, i) {
    var s = -1, a = t == null ? 0 : t.length;
    for (i && a && (r = t[++s]); ++s < a; )
      r = n(r, t[s], s, t);
    return r;
  }
  return qC = e, qC;
}
var FC, VO;
function wbe() {
  if (VO) return FC;
  VO = 1;
  function e(t, n, r, i, s) {
    return s(t, function(a, u, d) {
      r = i ? (i = !1, a) : n(r, a, u, d);
    }), r;
  }
  return FC = e, FC;
}
var UC, GO;
function eU() {
  if (GO) return UC;
  GO = 1;
  var e = /* @__PURE__ */ bbe(), t = /* @__PURE__ */ Iw(), n = /* @__PURE__ */ oc(), r = /* @__PURE__ */ wbe(), i = /* @__PURE__ */ si();
  function s(a, u, d) {
    var f = i(a) ? e : r, h = arguments.length < 3;
    return f(a, n(u, 4), d, h, t);
  }
  return UC = s, UC;
}
var HC, KO;
function _be() {
  if (KO) return HC;
  KO = 1;
  var e = /* @__PURE__ */ Ah(), t = /* @__PURE__ */ si(), n = /* @__PURE__ */ uu(), r = "[object String]";
  function i(s) {
    return typeof s == "string" || !t(s) && n(s) && e(s) == r;
  }
  return HC = i, HC;
}
var VC, YO;
function Sbe() {
  if (YO) return VC;
  YO = 1;
  var e = /* @__PURE__ */ YF(), t = e("length");
  return VC = t, VC;
}
var GC, WO;
function Ebe() {
  if (WO) return GC;
  WO = 1;
  var e = "\\ud800-\\udfff", t = "\\u0300-\\u036f", n = "\\ufe20-\\ufe2f", r = "\\u20d0-\\u20ff", i = t + n + r, s = "\\ufe0e\\ufe0f", a = "\\u200d", u = RegExp("[" + a + e + i + s + "]");
  function d(f) {
    return u.test(f);
  }
  return GC = d, GC;
}
var KC, ZO;
function Cbe() {
  if (ZO) return KC;
  ZO = 1;
  var e = "\\ud800-\\udfff", t = "\\u0300-\\u036f", n = "\\ufe20-\\ufe2f", r = "\\u20d0-\\u20ff", i = t + n + r, s = "\\ufe0e\\ufe0f", a = "[" + e + "]", u = "[" + i + "]", d = "\\ud83c[\\udffb-\\udfff]", f = "(?:" + u + "|" + d + ")", h = "[^" + e + "]", m = "(?:\\ud83c[\\udde6-\\uddff]){2}", x = "[\\ud800-\\udbff][\\udc00-\\udfff]", b = "\\u200d", w = f + "?", S = "[" + s + "]?", C = "(?:" + b + "(?:" + [h, m, x].join("|") + ")" + S + w + ")*", T = S + w + C, R = "(?:" + [h + u + "?", u, m, x, a].join("|") + ")", N = RegExp(d + "(?=" + d + ")|" + R + T, "g");
  function M(P) {
    for (var D = N.lastIndex = 0; N.test(P); )
      ++D;
    return D;
  }
  return KC = M, KC;
}
var YC, XO;
function kbe() {
  if (XO) return YC;
  XO = 1;
  var e = /* @__PURE__ */ Sbe(), t = /* @__PURE__ */ Ebe(), n = /* @__PURE__ */ Cbe();
  function r(i) {
    return t(i) ? n(i) : e(i);
  }
  return YC = r, YC;
}
var WC, QO;
function Tbe() {
  if (QO) return WC;
  QO = 1;
  var e = /* @__PURE__ */ Fj(), t = /* @__PURE__ */ ng(), n = /* @__PURE__ */ ac(), r = /* @__PURE__ */ _be(), i = /* @__PURE__ */ kbe(), s = "[object Map]", a = "[object Set]";
  function u(d) {
    if (d == null)
      return 0;
    if (n(d))
      return r(d) ? i(d) : d.length;
    var f = t(d);
    return f == s || f == a ? d.size : e(d).length;
  }
  return WC = u, WC;
}
var ZC, JO;
function jbe() {
  if (JO) return ZC;
  JO = 1;
  var e = /* @__PURE__ */ Bj(), t = /* @__PURE__ */ OF(), n = /* @__PURE__ */ Yj(), r = /* @__PURE__ */ oc(), i = /* @__PURE__ */ Pw(), s = /* @__PURE__ */ si(), a = /* @__PURE__ */ tg(), u = /* @__PURE__ */ mx(), d = /* @__PURE__ */ co(), f = /* @__PURE__ */ xx();
  function h(m, x, b) {
    var w = s(m), S = w || a(m) || f(m);
    if (x = r(x, 4), b == null) {
      var C = m && m.constructor;
      S ? b = w ? new C() : [] : d(m) ? b = u(C) ? t(i(m)) : {} : b = {};
    }
    return (S ? e : n)(m, function(T, R, N) {
      return x(b, T, R, N);
    }), b;
  }
  return ZC = h, ZC;
}
var XC, e7;
function Abe() {
  if (e7) return XC;
  e7 = 1;
  var e = /* @__PURE__ */ eg(), t = /* @__PURE__ */ yx(), n = /* @__PURE__ */ si(), r = e ? e.isConcatSpreadable : void 0;
  function i(s) {
    return n(s) || t(s) || !!(r && s && s[r]);
  }
  return XC = i, XC;
}
var QC, t7;
function Xj() {
  if (t7) return QC;
  t7 = 1;
  var e = /* @__PURE__ */ Hj(), t = /* @__PURE__ */ Abe();
  function n(r, i, s, a, u) {
    var d = -1, f = r.length;
    for (s || (s = t), u || (u = []); ++d < f; ) {
      var h = r[d];
      i > 0 && s(h) ? i > 1 ? n(h, i - 1, s, a, u) : e(u, h) : a || (u[u.length] = h);
    }
    return u;
  }
  return QC = n, QC;
}
var JC, n7;
function Nbe() {
  if (n7) return JC;
  n7 = 1;
  function e(t, n, r) {
    switch (r.length) {
      case 0:
        return t.call(n);
      case 1:
        return t.call(n, r[0]);
      case 2:
        return t.call(n, r[0], r[1]);
      case 3:
        return t.call(n, r[0], r[1], r[2]);
    }
    return t.apply(n, r);
  }
  return JC = e, JC;
}
var e4, r7;
function tU() {
  if (r7) return e4;
  r7 = 1;
  var e = /* @__PURE__ */ Nbe(), t = Math.max;
  function n(r, i, s) {
    return i = t(i === void 0 ? r.length - 1 : i, 0), function() {
      for (var a = arguments, u = -1, d = t(a.length - i, 0), f = Array(d); ++u < d; )
        f[u] = a[i + u];
      u = -1;
      for (var h = Array(i + 1); ++u < i; )
        h[u] = a[u];
      return h[i] = s(f), e(r, this, h);
    };
  }
  return e4 = n, e4;
}
var t4, i7;
function Rbe() {
  if (i7) return t4;
  i7 = 1;
  var e = /* @__PURE__ */ Gj(), t = /* @__PURE__ */ bF(), n = /* @__PURE__ */ Mh(), r = t ? function(i, s) {
    return t(i, "toString", {
      configurable: !0,
      enumerable: !1,
      value: e(s),
      writable: !0
    });
  } : n;
  return t4 = r, t4;
}
var n4, s7;
function Mbe() {
  if (s7) return n4;
  s7 = 1;
  var e = 800, t = 16, n = Date.now;
  function r(i) {
    var s = 0, a = 0;
    return function() {
      var u = n(), d = t - (u - a);
      if (a = u, d > 0) {
        if (++s >= e)
          return arguments[0];
      } else
        s = 0;
      return i.apply(void 0, arguments);
    };
  }
  return n4 = r, n4;
}
var r4, a7;
function nU() {
  if (a7) return r4;
  a7 = 1;
  var e = /* @__PURE__ */ Rbe(), t = /* @__PURE__ */ Mbe(), n = t(e);
  return r4 = n, r4;
}
var i4, o7;
function qw() {
  if (o7) return i4;
  o7 = 1;
  var e = /* @__PURE__ */ Mh(), t = /* @__PURE__ */ tU(), n = /* @__PURE__ */ nU();
  function r(i, s) {
    return n(t(i, s, e), i + "");
  }
  return i4 = r, i4;
}
var s4, l7;
function rU() {
  if (l7) return s4;
  l7 = 1;
  function e(t, n, r, i) {
    for (var s = t.length, a = r + (i ? 1 : -1); i ? a-- : ++a < s; )
      if (n(t[a], a, t))
        return a;
    return -1;
  }
  return s4 = e, s4;
}
var a4, u7;
function Obe() {
  if (u7) return a4;
  u7 = 1;
  function e(t) {
    return t !== t;
  }
  return a4 = e, a4;
}
var o4, c7;
function Dbe() {
  if (c7) return o4;
  c7 = 1;
  function e(t, n, r) {
    for (var i = r - 1, s = t.length; ++i < s; )
      if (t[i] === n)
        return i;
    return -1;
  }
  return o4 = e, o4;
}
var l4, d7;
function zbe() {
  if (d7) return l4;
  d7 = 1;
  var e = /* @__PURE__ */ rU(), t = /* @__PURE__ */ Obe(), n = /* @__PURE__ */ Dbe();
  function r(i, s, a) {
    return s === s ? n(i, s, a) : e(i, t, a);
  }
  return l4 = r, l4;
}
var u4, f7;
function Pbe() {
  if (f7) return u4;
  f7 = 1;
  var e = /* @__PURE__ */ zbe();
  function t(n, r) {
    var i = n == null ? 0 : n.length;
    return !!i && e(n, r, 0) > -1;
  }
  return u4 = t, u4;
}
var c4, h7;
function Ibe() {
  if (h7) return c4;
  h7 = 1;
  function e(t, n, r) {
    for (var i = -1, s = t == null ? 0 : t.length; ++i < s; )
      if (r(n, t[i]))
        return !0;
    return !1;
  }
  return c4 = e, c4;
}
var d4, p7;
function Lbe() {
  if (p7) return d4;
  p7 = 1;
  function e() {
  }
  return d4 = e, d4;
}
var f4, m7;
function Bbe() {
  if (m7) return f4;
  m7 = 1;
  var e = /* @__PURE__ */ NF(), t = /* @__PURE__ */ Lbe(), n = /* @__PURE__ */ Wj(), r = 1 / 0, i = e && 1 / n(new e([, -0]))[1] == r ? function(s) {
    return new e(s);
  } : t;
  return f4 = i, f4;
}
var h4, g7;
function $be() {
  if (g7) return h4;
  g7 = 1;
  var e = /* @__PURE__ */ BF(), t = /* @__PURE__ */ Pbe(), n = /* @__PURE__ */ Ibe(), r = /* @__PURE__ */ $F(), i = /* @__PURE__ */ Bbe(), s = /* @__PURE__ */ Wj(), a = 200;
  function u(d, f, h) {
    var m = -1, x = t, b = d.length, w = !0, S = [], C = S;
    if (h)
      w = !1, x = n;
    else if (b >= a) {
      var T = f ? null : i(d);
      if (T)
        return s(T);
      w = !1, x = r, C = new e();
    } else
      C = f ? [] : S;
    e:
      for (; ++m < b; ) {
        var R = d[m], N = f ? f(R) : R;
        if (R = h || R !== 0 ? R : 0, w && N === N) {
          for (var M = C.length; M--; )
            if (C[M] === N)
              continue e;
          f && C.push(N), S.push(R);
        } else x(C, N, h) || (C !== S && C.push(N), S.push(R));
      }
    return S;
  }
  return h4 = u, h4;
}
var p4, y7;
function iU() {
  if (y7) return p4;
  y7 = 1;
  var e = /* @__PURE__ */ ac(), t = /* @__PURE__ */ uu();
  function n(r) {
    return t(r) && e(r);
  }
  return p4 = n, p4;
}
var m4, x7;
function qbe() {
  if (x7) return m4;
  x7 = 1;
  var e = /* @__PURE__ */ Xj(), t = /* @__PURE__ */ qw(), n = /* @__PURE__ */ $be(), r = /* @__PURE__ */ iU(), i = t(function(s) {
    return n(e(s, 1, r, !0));
  });
  return m4 = i, m4;
}
var g4, v7;
function Fbe() {
  if (v7) return g4;
  v7 = 1;
  var e = /* @__PURE__ */ Lw();
  function t(n, r) {
    return e(r, function(i) {
      return n[i];
    });
  }
  return g4 = t, g4;
}
var y4, b7;
function sU() {
  if (b7) return y4;
  b7 = 1;
  var e = /* @__PURE__ */ Fbe(), t = /* @__PURE__ */ Od();
  function n(r) {
    return r == null ? [] : e(r, t(r));
  }
  return y4 = n, y4;
}
var x4, w7;
function fo() {
  if (w7) return x4;
  w7 = 1;
  var e;
  if (typeof Pj == "function")
    try {
      e = {
        clone: /* @__PURE__ */ W1e(),
        constant: /* @__PURE__ */ Gj(),
        each: /* @__PURE__ */ LF(),
        filter: /* @__PURE__ */ WF(),
        has: /* @__PURE__ */ ZF(),
        isArray: /* @__PURE__ */ si(),
        isEmpty: /* @__PURE__ */ vbe(),
        isFunction: /* @__PURE__ */ mx(),
        isUndefined: /* @__PURE__ */ XF(),
        keys: /* @__PURE__ */ Od(),
        map: /* @__PURE__ */ JF(),
        reduce: /* @__PURE__ */ eU(),
        size: /* @__PURE__ */ Tbe(),
        transform: /* @__PURE__ */ jbe(),
        union: /* @__PURE__ */ qbe(),
        values: /* @__PURE__ */ sU()
      };
    } catch {
    }
  return e || (e = window._), x4 = e, x4;
}
var v4, _7;
function Qj() {
  if (_7) return v4;
  _7 = 1;
  var e = /* @__PURE__ */ fo();
  v4 = i;
  var t = "\0", n = "\0", r = "";
  function i(h) {
    this._isDirected = e.has(h, "directed") ? h.directed : !0, this._isMultigraph = e.has(h, "multigraph") ? h.multigraph : !1, this._isCompound = e.has(h, "compound") ? h.compound : !1, this._label = void 0, this._defaultNodeLabelFn = e.constant(void 0), this._defaultEdgeLabelFn = e.constant(void 0), this._nodes = {}, this._isCompound && (this._parent = {}, this._children = {}, this._children[n] = {}), this._in = {}, this._preds = {}, this._out = {}, this._sucs = {}, this._edgeObjs = {}, this._edgeLabels = {};
  }
  i.prototype._nodeCount = 0, i.prototype._edgeCount = 0, i.prototype.isDirected = function() {
    return this._isDirected;
  }, i.prototype.isMultigraph = function() {
    return this._isMultigraph;
  }, i.prototype.isCompound = function() {
    return this._isCompound;
  }, i.prototype.setGraph = function(h) {
    return this._label = h, this;
  }, i.prototype.graph = function() {
    return this._label;
  }, i.prototype.setDefaultNodeLabel = function(h) {
    return e.isFunction(h) || (h = e.constant(h)), this._defaultNodeLabelFn = h, this;
  }, i.prototype.nodeCount = function() {
    return this._nodeCount;
  }, i.prototype.nodes = function() {
    return e.keys(this._nodes);
  }, i.prototype.sources = function() {
    var h = this;
    return e.filter(this.nodes(), function(m) {
      return e.isEmpty(h._in[m]);
    });
  }, i.prototype.sinks = function() {
    var h = this;
    return e.filter(this.nodes(), function(m) {
      return e.isEmpty(h._out[m]);
    });
  }, i.prototype.setNodes = function(h, m) {
    var x = arguments, b = this;
    return e.each(h, function(w) {
      x.length > 1 ? b.setNode(w, m) : b.setNode(w);
    }), this;
  }, i.prototype.setNode = function(h, m) {
    return e.has(this._nodes, h) ? (arguments.length > 1 && (this._nodes[h] = m), this) : (this._nodes[h] = arguments.length > 1 ? m : this._defaultNodeLabelFn(h), this._isCompound && (this._parent[h] = n, this._children[h] = {}, this._children[n][h] = !0), this._in[h] = {}, this._preds[h] = {}, this._out[h] = {}, this._sucs[h] = {}, ++this._nodeCount, this);
  }, i.prototype.node = function(h) {
    return this._nodes[h];
  }, i.prototype.hasNode = function(h) {
    return e.has(this._nodes, h);
  }, i.prototype.removeNode = function(h) {
    var m = this;
    if (e.has(this._nodes, h)) {
      var x = function(b) {
        m.removeEdge(m._edgeObjs[b]);
      };
      delete this._nodes[h], this._isCompound && (this._removeFromParentsChildList(h), delete this._parent[h], e.each(this.children(h), function(b) {
        m.setParent(b);
      }), delete this._children[h]), e.each(e.keys(this._in[h]), x), delete this._in[h], delete this._preds[h], e.each(e.keys(this._out[h]), x), delete this._out[h], delete this._sucs[h], --this._nodeCount;
    }
    return this;
  }, i.prototype.setParent = function(h, m) {
    if (!this._isCompound)
      throw new Error("Cannot set parent in a non-compound graph");
    if (e.isUndefined(m))
      m = n;
    else {
      m += "";
      for (var x = m; !e.isUndefined(x); x = this.parent(x))
        if (x === h)
          throw new Error("Setting " + m + " as parent of " + h + " would create a cycle");
      this.setNode(m);
    }
    return this.setNode(h), this._removeFromParentsChildList(h), this._parent[h] = m, this._children[m][h] = !0, this;
  }, i.prototype._removeFromParentsChildList = function(h) {
    delete this._children[this._parent[h]][h];
  }, i.prototype.parent = function(h) {
    if (this._isCompound) {
      var m = this._parent[h];
      if (m !== n)
        return m;
    }
  }, i.prototype.children = function(h) {
    if (e.isUndefined(h) && (h = n), this._isCompound) {
      var m = this._children[h];
      if (m)
        return e.keys(m);
    } else {
      if (h === n)
        return this.nodes();
      if (this.hasNode(h))
        return [];
    }
  }, i.prototype.predecessors = function(h) {
    var m = this._preds[h];
    if (m)
      return e.keys(m);
  }, i.prototype.successors = function(h) {
    var m = this._sucs[h];
    if (m)
      return e.keys(m);
  }, i.prototype.neighbors = function(h) {
    var m = this.predecessors(h);
    if (m)
      return e.union(m, this.successors(h));
  }, i.prototype.isLeaf = function(h) {
    var m;
    return this.isDirected() ? m = this.successors(h) : m = this.neighbors(h), m.length === 0;
  }, i.prototype.filterNodes = function(h) {
    var m = new this.constructor({
      directed: this._isDirected,
      multigraph: this._isMultigraph,
      compound: this._isCompound
    });
    m.setGraph(this.graph());
    var x = this;
    e.each(this._nodes, function(S, C) {
      h(C) && m.setNode(C, S);
    }), e.each(this._edgeObjs, function(S) {
      m.hasNode(S.v) && m.hasNode(S.w) && m.setEdge(S, x.edge(S));
    });
    var b = {};
    function w(S) {
      var C = x.parent(S);
      return C === void 0 || m.hasNode(C) ? (b[S] = C, C) : C in b ? b[C] : w(C);
    }
    return this._isCompound && e.each(m.nodes(), function(S) {
      m.setParent(S, w(S));
    }), m;
  }, i.prototype.setDefaultEdgeLabel = function(h) {
    return e.isFunction(h) || (h = e.constant(h)), this._defaultEdgeLabelFn = h, this;
  }, i.prototype.edgeCount = function() {
    return this._edgeCount;
  }, i.prototype.edges = function() {
    return e.values(this._edgeObjs);
  }, i.prototype.setPath = function(h, m) {
    var x = this, b = arguments;
    return e.reduce(h, function(w, S) {
      return b.length > 1 ? x.setEdge(w, S, m) : x.setEdge(w, S), S;
    }), this;
  }, i.prototype.setEdge = function() {
    var h, m, x, b, w = !1, S = arguments[0];
    typeof S == "object" && S !== null && "v" in S ? (h = S.v, m = S.w, x = S.name, arguments.length === 2 && (b = arguments[1], w = !0)) : (h = S, m = arguments[1], x = arguments[3], arguments.length > 2 && (b = arguments[2], w = !0)), h = "" + h, m = "" + m, e.isUndefined(x) || (x = "" + x);
    var C = u(this._isDirected, h, m, x);
    if (e.has(this._edgeLabels, C))
      return w && (this._edgeLabels[C] = b), this;
    if (!e.isUndefined(x) && !this._isMultigraph)
      throw new Error("Cannot set a named edge when isMultigraph = false");
    this.setNode(h), this.setNode(m), this._edgeLabels[C] = w ? b : this._defaultEdgeLabelFn(h, m, x);
    var T = d(this._isDirected, h, m, x);
    return h = T.v, m = T.w, Object.freeze(T), this._edgeObjs[C] = T, s(this._preds[m], h), s(this._sucs[h], m), this._in[m][C] = T, this._out[h][C] = T, this._edgeCount++, this;
  }, i.prototype.edge = function(h, m, x) {
    var b = arguments.length === 1 ? f(this._isDirected, arguments[0]) : u(this._isDirected, h, m, x);
    return this._edgeLabels[b];
  }, i.prototype.hasEdge = function(h, m, x) {
    var b = arguments.length === 1 ? f(this._isDirected, arguments[0]) : u(this._isDirected, h, m, x);
    return e.has(this._edgeLabels, b);
  }, i.prototype.removeEdge = function(h, m, x) {
    var b = arguments.length === 1 ? f(this._isDirected, arguments[0]) : u(this._isDirected, h, m, x), w = this._edgeObjs[b];
    return w && (h = w.v, m = w.w, delete this._edgeLabels[b], delete this._edgeObjs[b], a(this._preds[m], h), a(this._sucs[h], m), delete this._in[m][b], delete this._out[h][b], this._edgeCount--), this;
  }, i.prototype.inEdges = function(h, m) {
    var x = this._in[h];
    if (x) {
      var b = e.values(x);
      return m ? e.filter(b, function(w) {
        return w.v === m;
      }) : b;
    }
  }, i.prototype.outEdges = function(h, m) {
    var x = this._out[h];
    if (x) {
      var b = e.values(x);
      return m ? e.filter(b, function(w) {
        return w.w === m;
      }) : b;
    }
  }, i.prototype.nodeEdges = function(h, m) {
    var x = this.inEdges(h, m);
    if (x)
      return x.concat(this.outEdges(h, m));
  };
  function s(h, m) {
    h[m] ? h[m]++ : h[m] = 1;
  }
  function a(h, m) {
    --h[m] || delete h[m];
  }
  function u(h, m, x, b) {
    var w = "" + m, S = "" + x;
    if (!h && w > S) {
      var C = w;
      w = S, S = C;
    }
    return w + r + S + r + (e.isUndefined(b) ? t : b);
  }
  function d(h, m, x, b) {
    var w = "" + m, S = "" + x;
    if (!h && w > S) {
      var C = w;
      w = S, S = C;
    }
    var T = { v: w, w: S };
    return b && (T.name = b), T;
  }
  function f(h, m) {
    return u(h, m.v, m.w, m.name);
  }
  return v4;
}
var b4, S7;
function Ube() {
  return S7 || (S7 = 1, b4 = "2.1.8"), b4;
}
var w4, E7;
function Hbe() {
  return E7 || (E7 = 1, w4 = {
    Graph: /* @__PURE__ */ Qj(),
    version: /* @__PURE__ */ Ube()
  }), w4;
}
var _4, C7;
function Vbe() {
  if (C7) return _4;
  C7 = 1;
  var e = /* @__PURE__ */ fo(), t = /* @__PURE__ */ Qj();
  _4 = {
    write: n,
    read: s
  };
  function n(a) {
    var u = {
      options: {
        directed: a.isDirected(),
        multigraph: a.isMultigraph(),
        compound: a.isCompound()
      },
      nodes: r(a),
      edges: i(a)
    };
    return e.isUndefined(a.graph()) || (u.value = e.clone(a.graph())), u;
  }
  function r(a) {
    return e.map(a.nodes(), function(u) {
      var d = a.node(u), f = a.parent(u), h = { v: u };
      return e.isUndefined(d) || (h.value = d), e.isUndefined(f) || (h.parent = f), h;
    });
  }
  function i(a) {
    return e.map(a.edges(), function(u) {
      var d = a.edge(u), f = { v: u.v, w: u.w };
      return e.isUndefined(u.name) || (f.name = u.name), e.isUndefined(d) || (f.value = d), f;
    });
  }
  function s(a) {
    var u = new t(a.options).setGraph(a.value);
    return e.each(a.nodes, function(d) {
      u.setNode(d.v, d.value), d.parent && u.setParent(d.v, d.parent);
    }), e.each(a.edges, function(d) {
      u.setEdge({ v: d.v, w: d.w, name: d.name }, d.value);
    }), u;
  }
  return _4;
}
var S4, k7;
function Gbe() {
  if (k7) return S4;
  k7 = 1;
  var e = /* @__PURE__ */ fo();
  S4 = t;
  function t(n) {
    var r = {}, i = [], s;
    function a(u) {
      e.has(r, u) || (r[u] = !0, s.push(u), e.each(n.successors(u), a), e.each(n.predecessors(u), a));
    }
    return e.each(n.nodes(), function(u) {
      s = [], a(u), s.length && i.push(s);
    }), i;
  }
  return S4;
}
var E4, T7;
function aU() {
  if (T7) return E4;
  T7 = 1;
  var e = /* @__PURE__ */ fo();
  E4 = t;
  function t() {
    this._arr = [], this._keyIndices = {};
  }
  return t.prototype.size = function() {
    return this._arr.length;
  }, t.prototype.keys = function() {
    return this._arr.map(function(n) {
      return n.key;
    });
  }, t.prototype.has = function(n) {
    return e.has(this._keyIndices, n);
  }, t.prototype.priority = function(n) {
    var r = this._keyIndices[n];
    if (r !== void 0)
      return this._arr[r].priority;
  }, t.prototype.min = function() {
    if (this.size() === 0)
      throw new Error("Queue underflow");
    return this._arr[0].key;
  }, t.prototype.add = function(n, r) {
    var i = this._keyIndices;
    if (n = String(n), !e.has(i, n)) {
      var s = this._arr, a = s.length;
      return i[n] = a, s.push({ key: n, priority: r }), this._decrease(a), !0;
    }
    return !1;
  }, t.prototype.removeMin = function() {
    this._swap(0, this._arr.length - 1);
    var n = this._arr.pop();
    return delete this._keyIndices[n.key], this._heapify(0), n.key;
  }, t.prototype.decrease = function(n, r) {
    var i = this._keyIndices[n];
    if (r > this._arr[i].priority)
      throw new Error("New priority is greater than current priority. Key: " + n + " Old: " + this._arr[i].priority + " New: " + r);
    this._arr[i].priority = r, this._decrease(i);
  }, t.prototype._heapify = function(n) {
    var r = this._arr, i = 2 * n, s = i + 1, a = n;
    i < r.length && (a = r[i].priority < r[a].priority ? i : a, s < r.length && (a = r[s].priority < r[a].priority ? s : a), a !== n && (this._swap(n, a), this._heapify(a)));
  }, t.prototype._decrease = function(n) {
    for (var r = this._arr, i = r[n].priority, s; n !== 0 && (s = n >> 1, !(r[s].priority < i)); )
      this._swap(n, s), n = s;
  }, t.prototype._swap = function(n, r) {
    var i = this._arr, s = this._keyIndices, a = i[n], u = i[r];
    i[n] = u, i[r] = a, s[u.key] = n, s[a.key] = r;
  }, E4;
}
var C4, j7;
function oU() {
  if (j7) return C4;
  j7 = 1;
  var e = /* @__PURE__ */ fo(), t = /* @__PURE__ */ aU();
  C4 = r;
  var n = e.constant(1);
  function r(s, a, u, d) {
    return i(
      s,
      String(a),
      u || n,
      d || function(f) {
        return s.outEdges(f);
      }
    );
  }
  function i(s, a, u, d) {
    var f = {}, h = new t(), m, x, b = function(w) {
      var S = w.v !== m ? w.v : w.w, C = f[S], T = u(w), R = x.distance + T;
      if (T < 0)
        throw new Error("dijkstra does not allow negative edge weights. Bad edge: " + w + " Weight: " + T);
      R < C.distance && (C.distance = R, C.predecessor = m, h.decrease(S, R));
    };
    for (s.nodes().forEach(function(w) {
      var S = w === a ? 0 : Number.POSITIVE_INFINITY;
      f[w] = { distance: S }, h.add(w, S);
    }); h.size() > 0 && (m = h.removeMin(), x = f[m], x.distance !== Number.POSITIVE_INFINITY); )
      d(m).forEach(b);
    return f;
  }
  return C4;
}
var k4, A7;
function Kbe() {
  if (A7) return k4;
  A7 = 1;
  var e = /* @__PURE__ */ oU(), t = /* @__PURE__ */ fo();
  k4 = n;
  function n(r, i, s) {
    return t.transform(r.nodes(), function(a, u) {
      a[u] = e(r, u, i, s);
    }, {});
  }
  return k4;
}
var T4, N7;
function lU() {
  if (N7) return T4;
  N7 = 1;
  var e = /* @__PURE__ */ fo();
  T4 = t;
  function t(n) {
    var r = 0, i = [], s = {}, a = [];
    function u(d) {
      var f = s[d] = {
        onStack: !0,
        lowlink: r,
        index: r++
      };
      if (i.push(d), n.successors(d).forEach(function(x) {
        e.has(s, x) ? s[x].onStack && (f.lowlink = Math.min(f.lowlink, s[x].index)) : (u(x), f.lowlink = Math.min(f.lowlink, s[x].lowlink));
      }), f.lowlink === f.index) {
        var h = [], m;
        do
          m = i.pop(), s[m].onStack = !1, h.push(m);
        while (d !== m);
        a.push(h);
      }
    }
    return n.nodes().forEach(function(d) {
      e.has(s, d) || u(d);
    }), a;
  }
  return T4;
}
var j4, R7;
function Ybe() {
  if (R7) return j4;
  R7 = 1;
  var e = /* @__PURE__ */ fo(), t = /* @__PURE__ */ lU();
  j4 = n;
  function n(r) {
    return e.filter(t(r), function(i) {
      return i.length > 1 || i.length === 1 && r.hasEdge(i[0], i[0]);
    });
  }
  return j4;
}
var A4, M7;
function Wbe() {
  if (M7) return A4;
  M7 = 1;
  var e = /* @__PURE__ */ fo();
  A4 = n;
  var t = e.constant(1);
  function n(i, s, a) {
    return r(
      i,
      s || t,
      a || function(u) {
        return i.outEdges(u);
      }
    );
  }
  function r(i, s, a) {
    var u = {}, d = i.nodes();
    return d.forEach(function(f) {
      u[f] = {}, u[f][f] = { distance: 0 }, d.forEach(function(h) {
        f !== h && (u[f][h] = { distance: Number.POSITIVE_INFINITY });
      }), a(f).forEach(function(h) {
        var m = h.v === f ? h.w : h.v, x = s(h);
        u[f][m] = { distance: x, predecessor: f };
      });
    }), d.forEach(function(f) {
      var h = u[f];
      d.forEach(function(m) {
        var x = u[m];
        d.forEach(function(b) {
          var w = x[f], S = h[b], C = x[b], T = w.distance + S.distance;
          T < C.distance && (C.distance = T, C.predecessor = S.predecessor);
        });
      });
    }), u;
  }
  return A4;
}
var N4, O7;
function uU() {
  if (O7) return N4;
  O7 = 1;
  var e = /* @__PURE__ */ fo();
  N4 = t, t.CycleException = n;
  function t(r) {
    var i = {}, s = {}, a = [];
    function u(d) {
      if (e.has(s, d))
        throw new n();
      e.has(i, d) || (s[d] = !0, i[d] = !0, e.each(r.predecessors(d), u), delete s[d], a.push(d));
    }
    if (e.each(r.sinks(), u), e.size(i) !== r.nodeCount())
      throw new n();
    return a;
  }
  function n() {
  }
  return n.prototype = new Error(), N4;
}
var R4, D7;
function Zbe() {
  if (D7) return R4;
  D7 = 1;
  var e = /* @__PURE__ */ uU();
  R4 = t;
  function t(n) {
    try {
      e(n);
    } catch (r) {
      if (r instanceof e.CycleException)
        return !1;
      throw r;
    }
    return !0;
  }
  return R4;
}
var M4, z7;
function cU() {
  if (z7) return M4;
  z7 = 1;
  var e = /* @__PURE__ */ fo();
  M4 = t;
  function t(r, i, s) {
    e.isArray(i) || (i = [i]);
    var a = (r.isDirected() ? r.successors : r.neighbors).bind(r), u = [], d = {};
    return e.each(i, function(f) {
      if (!r.hasNode(f))
        throw new Error("Graph does not have node: " + f);
      n(r, f, s === "post", d, a, u);
    }), u;
  }
  function n(r, i, s, a, u, d) {
    e.has(a, i) || (a[i] = !0, s || d.push(i), e.each(u(i), function(f) {
      n(r, f, s, a, u, d);
    }), s && d.push(i));
  }
  return M4;
}
var O4, P7;
function Xbe() {
  if (P7) return O4;
  P7 = 1;
  var e = /* @__PURE__ */ cU();
  O4 = t;
  function t(n, r) {
    return e(n, r, "post");
  }
  return O4;
}
var D4, I7;
function Qbe() {
  if (I7) return D4;
  I7 = 1;
  var e = /* @__PURE__ */ cU();
  D4 = t;
  function t(n, r) {
    return e(n, r, "pre");
  }
  return D4;
}
var z4, L7;
function Jbe() {
  if (L7) return z4;
  L7 = 1;
  var e = /* @__PURE__ */ fo(), t = /* @__PURE__ */ Qj(), n = /* @__PURE__ */ aU();
  z4 = r;
  function r(i, s) {
    var a = new t(), u = {}, d = new n(), f;
    function h(x) {
      var b = x.v === f ? x.w : x.v, w = d.priority(b);
      if (w !== void 0) {
        var S = s(x);
        S < w && (u[b] = f, d.decrease(b, S));
      }
    }
    if (i.nodeCount() === 0)
      return a;
    e.each(i.nodes(), function(x) {
      d.add(x, Number.POSITIVE_INFINITY), a.setNode(x);
    }), d.decrease(i.nodes()[0], 0);
    for (var m = !1; d.size() > 0; ) {
      if (f = d.removeMin(), e.has(u, f))
        a.setEdge(f, u[f]);
      else {
        if (m)
          throw new Error("Input graph is not connected: " + i);
        m = !0;
      }
      i.nodeEdges(f).forEach(h);
    }
    return a;
  }
  return z4;
}
var P4, B7;
function ewe() {
  return B7 || (B7 = 1, P4 = {
    components: /* @__PURE__ */ Gbe(),
    dijkstra: /* @__PURE__ */ oU(),
    dijkstraAll: /* @__PURE__ */ Kbe(),
    findCycles: /* @__PURE__ */ Ybe(),
    floydWarshall: /* @__PURE__ */ Wbe(),
    isAcyclic: /* @__PURE__ */ Zbe(),
    postorder: /* @__PURE__ */ Xbe(),
    preorder: /* @__PURE__ */ Qbe(),
    prim: /* @__PURE__ */ Jbe(),
    tarjan: /* @__PURE__ */ lU(),
    topsort: /* @__PURE__ */ uU()
  }), P4;
}
var I4, $7;
function twe() {
  if ($7) return I4;
  $7 = 1;
  var e = /* @__PURE__ */ Hbe();
  return I4 = {
    Graph: e.Graph,
    json: /* @__PURE__ */ Vbe(),
    alg: /* @__PURE__ */ ewe(),
    version: e.version
  }, I4;
}
var L4, q7;
function il() {
  if (q7) return L4;
  q7 = 1;
  var e;
  if (typeof Pj == "function")
    try {
      e = /* @__PURE__ */ twe();
    } catch {
    }
  return e || (e = window.graphlib), L4 = e, L4;
}
var B4, F7;
function nwe() {
  if (F7) return B4;
  F7 = 1;
  var e = /* @__PURE__ */ zF(), t = 1, n = 4;
  function r(i) {
    return e(i, t | n);
  }
  return B4 = r, B4;
}
var $4, U7;
function Fw() {
  if (U7) return $4;
  U7 = 1;
  var e = /* @__PURE__ */ Jm(), t = /* @__PURE__ */ ac(), n = /* @__PURE__ */ Ow(), r = /* @__PURE__ */ co();
  function i(s, a, u) {
    if (!r(u))
      return !1;
    var d = typeof a;
    return (d == "number" ? t(u) && n(a, u.length) : d == "string" && a in u) ? e(u[a], s) : !1;
  }
  return $4 = i, $4;
}
var q4, H7;
function rwe() {
  if (H7) return q4;
  H7 = 1;
  var e = /* @__PURE__ */ qw(), t = /* @__PURE__ */ Jm(), n = /* @__PURE__ */ Fw(), r = /* @__PURE__ */ Rh(), i = Object.prototype, s = i.hasOwnProperty, a = e(function(u, d) {
    u = Object(u);
    var f = -1, h = d.length, m = h > 2 ? d[2] : void 0;
    for (m && n(d[0], d[1], m) && (h = 1); ++f < h; )
      for (var x = d[f], b = r(x), w = -1, S = b.length; ++w < S; ) {
        var C = b[w], T = u[C];
        (T === void 0 || t(T, i[C]) && !s.call(u, C)) && (u[C] = x[C]);
      }
    return u;
  });
  return q4 = a, q4;
}
var F4, V7;
function iwe() {
  if (V7) return F4;
  V7 = 1;
  var e = /* @__PURE__ */ oc(), t = /* @__PURE__ */ ac(), n = /* @__PURE__ */ Od();
  function r(i) {
    return function(s, a, u) {
      var d = Object(s);
      if (!t(s)) {
        var f = e(a, 3);
        s = n(s), a = function(m) {
          return f(d[m], m, d);
        };
      }
      var h = i(s, a, u);
      return h > -1 ? d[f ? s[h] : h] : void 0;
    };
  }
  return F4 = r, F4;
}
var U4, G7;
function swe() {
  if (G7) return U4;
  G7 = 1;
  var e = /\s/;
  function t(n) {
    for (var r = n.length; r-- && e.test(n.charAt(r)); )
      ;
    return r;
  }
  return U4 = t, U4;
}
var H4, K7;
function awe() {
  if (K7) return H4;
  K7 = 1;
  var e = /* @__PURE__ */ swe(), t = /^\s+/;
  function n(r) {
    return r && r.slice(0, e(r) + 1).replace(t, "");
  }
  return H4 = n, H4;
}
var V4, Y7;
function owe() {
  if (Y7) return V4;
  Y7 = 1;
  var e = /* @__PURE__ */ awe(), t = /* @__PURE__ */ co(), n = /* @__PURE__ */ rg(), r = NaN, i = /^[-+]0x[0-9a-f]+$/i, s = /^0b[01]+$/i, a = /^0o[0-7]+$/i, u = parseInt;
  function d(f) {
    if (typeof f == "number")
      return f;
    if (n(f))
      return r;
    if (t(f)) {
      var h = typeof f.valueOf == "function" ? f.valueOf() : f;
      f = t(h) ? h + "" : h;
    }
    if (typeof f != "string")
      return f === 0 ? f : +f;
    f = e(f);
    var m = s.test(f);
    return m || a.test(f) ? u(f.slice(2), m ? 2 : 8) : i.test(f) ? r : +f;
  }
  return V4 = d, V4;
}
var G4, W7;
function dU() {
  if (W7) return G4;
  W7 = 1;
  var e = /* @__PURE__ */ owe(), t = 1 / 0, n = 17976931348623157e292;
  function r(i) {
    if (!i)
      return i === 0 ? i : 0;
    if (i = e(i), i === t || i === -t) {
      var s = i < 0 ? -1 : 1;
      return s * n;
    }
    return i === i ? i : 0;
  }
  return G4 = r, G4;
}
var K4, Z7;
function lwe() {
  if (Z7) return K4;
  Z7 = 1;
  var e = /* @__PURE__ */ dU();
  function t(n) {
    var r = e(n), i = r % 1;
    return r === r ? i ? r - i : r : 0;
  }
  return K4 = t, K4;
}
var Y4, X7;
function uwe() {
  if (X7) return Y4;
  X7 = 1;
  var e = /* @__PURE__ */ rU(), t = /* @__PURE__ */ oc(), n = /* @__PURE__ */ lwe(), r = Math.max;
  function i(s, a, u) {
    var d = s == null ? 0 : s.length;
    if (!d)
      return -1;
    var f = u == null ? 0 : n(u);
    return f < 0 && (f = r(d + f, 0)), e(s, t(a, 3), f);
  }
  return Y4 = i, Y4;
}
var W4, Q7;
function cwe() {
  if (Q7) return W4;
  Q7 = 1;
  var e = /* @__PURE__ */ iwe(), t = /* @__PURE__ */ uwe(), n = e(t);
  return W4 = n, W4;
}
var Z4, J7;
function fU() {
  if (J7) return Z4;
  J7 = 1;
  var e = /* @__PURE__ */ Xj();
  function t(n) {
    var r = n == null ? 0 : n.length;
    return r ? e(n, 1) : [];
  }
  return Z4 = t, Z4;
}
var X4, eD;
function dwe() {
  if (eD) return X4;
  eD = 1;
  var e = /* @__PURE__ */ Kj(), t = /* @__PURE__ */ PF(), n = /* @__PURE__ */ Rh();
  function r(i, s) {
    return i == null ? i : e(i, t(s), n);
  }
  return X4 = r, X4;
}
var Q4, tD;
function fwe() {
  if (tD) return Q4;
  tD = 1;
  function e(t) {
    var n = t == null ? 0 : t.length;
    return n ? t[n - 1] : void 0;
  }
  return Q4 = e, Q4;
}
var J4, nD;
function hwe() {
  if (nD) return J4;
  nD = 1;
  var e = /* @__PURE__ */ Rw(), t = /* @__PURE__ */ Yj(), n = /* @__PURE__ */ oc();
  function r(i, s) {
    var a = {};
    return s = n(s, 3), t(i, function(u, d, f) {
      e(a, d, s(u, d, f));
    }), a;
  }
  return J4 = r, J4;
}
var ek, rD;
function Jj() {
  if (rD) return ek;
  rD = 1;
  var e = /* @__PURE__ */ rg();
  function t(n, r, i) {
    for (var s = -1, a = n.length; ++s < a; ) {
      var u = n[s], d = r(u);
      if (d != null && (f === void 0 ? d === d && !e(d) : i(d, f)))
        var f = d, h = u;
    }
    return h;
  }
  return ek = t, ek;
}
var tk, iD;
function pwe() {
  if (iD) return tk;
  iD = 1;
  function e(t, n) {
    return t > n;
  }
  return tk = e, tk;
}
var nk, sD;
function mwe() {
  if (sD) return nk;
  sD = 1;
  var e = /* @__PURE__ */ Jj(), t = /* @__PURE__ */ pwe(), n = /* @__PURE__ */ Mh();
  function r(i) {
    return i && i.length ? e(i, n, t) : void 0;
  }
  return nk = r, nk;
}
var rk, aD;
function hU() {
  if (aD) return rk;
  aD = 1;
  var e = /* @__PURE__ */ Rw(), t = /* @__PURE__ */ Jm();
  function n(r, i, s) {
    (s !== void 0 && !t(r[i], s) || s === void 0 && !(i in r)) && e(r, i, s);
  }
  return rk = n, rk;
}
var ik, oD;
function gwe() {
  if (oD) return ik;
  oD = 1;
  var e = /* @__PURE__ */ Ah(), t = /* @__PURE__ */ Pw(), n = /* @__PURE__ */ uu(), r = "[object Object]", i = Function.prototype, s = Object.prototype, a = i.toString, u = s.hasOwnProperty, d = a.call(Object);
  function f(h) {
    if (!n(h) || e(h) != r)
      return !1;
    var m = t(h);
    if (m === null)
      return !0;
    var x = u.call(m, "constructor") && m.constructor;
    return typeof x == "function" && x instanceof x && a.call(x) == d;
  }
  return ik = f, ik;
}
var sk, lD;
function pU() {
  if (lD) return sk;
  lD = 1;
  function e(t, n) {
    if (!(n === "constructor" && typeof t[n] == "function") && n != "__proto__")
      return t[n];
  }
  return sk = e, sk;
}
var ak, uD;
function ywe() {
  if (uD) return ak;
  uD = 1;
  var e = /* @__PURE__ */ gx(), t = /* @__PURE__ */ Rh();
  function n(r) {
    return e(r, t(r));
  }
  return ak = n, ak;
}
var ok, cD;
function xwe() {
  if (cD) return ok;
  cD = 1;
  var e = /* @__PURE__ */ hU(), t = /* @__PURE__ */ SF(), n = /* @__PURE__ */ MF(), r = /* @__PURE__ */ EF(), i = /* @__PURE__ */ DF(), s = /* @__PURE__ */ yx(), a = /* @__PURE__ */ si(), u = /* @__PURE__ */ iU(), d = /* @__PURE__ */ tg(), f = /* @__PURE__ */ mx(), h = /* @__PURE__ */ co(), m = /* @__PURE__ */ gwe(), x = /* @__PURE__ */ xx(), b = /* @__PURE__ */ pU(), w = /* @__PURE__ */ ywe();
  function S(C, T, R, N, M, P, D) {
    var q = b(C, R), Y = b(T, R), te = D.get(Y);
    if (te) {
      e(C, R, te);
      return;
    }
    var V = P ? P(q, Y, R + "", C, T, D) : void 0, $ = V === void 0;
    if ($) {
      var G = a(Y), le = !G && d(Y), Z = !G && !le && x(Y);
      V = Y, G || le || Z ? a(q) ? V = q : u(q) ? V = r(q) : le ? ($ = !1, V = t(Y, !0)) : Z ? ($ = !1, V = n(Y, !0)) : V = [] : m(Y) || s(Y) ? (V = q, s(q) ? V = w(q) : (!h(q) || f(q)) && (V = i(Y))) : $ = !1;
    }
    $ && (D.set(Y, V), M(V, Y, N, P, D), D.delete(Y)), e(C, R, V);
  }
  return ok = S, ok;
}
var lk, dD;
function vwe() {
  if (dD) return lk;
  dD = 1;
  var e = /* @__PURE__ */ Nw(), t = /* @__PURE__ */ hU(), n = /* @__PURE__ */ Kj(), r = /* @__PURE__ */ xwe(), i = /* @__PURE__ */ co(), s = /* @__PURE__ */ Rh(), a = /* @__PURE__ */ pU();
  function u(d, f, h, m, x) {
    d !== f && n(f, function(b, w) {
      if (x || (x = new e()), i(b))
        r(d, f, w, h, u, m, x);
      else {
        var S = m ? m(a(d, w), b, w + "", d, f, x) : void 0;
        S === void 0 && (S = b), t(d, w, S);
      }
    }, s);
  }
  return lk = u, lk;
}
var uk, fD;
function bwe() {
  if (fD) return uk;
  fD = 1;
  var e = /* @__PURE__ */ qw(), t = /* @__PURE__ */ Fw();
  function n(r) {
    return e(function(i, s) {
      var a = -1, u = s.length, d = u > 1 ? s[u - 1] : void 0, f = u > 2 ? s[2] : void 0;
      for (d = r.length > 3 && typeof d == "function" ? (u--, d) : void 0, f && t(s[0], s[1], f) && (d = u < 3 ? void 0 : d, u = 1), i = Object(i); ++a < u; ) {
        var h = s[a];
        h && r(i, h, a, d);
      }
      return i;
    });
  }
  return uk = n, uk;
}
var ck, hD;
function wwe() {
  if (hD) return ck;
  hD = 1;
  var e = /* @__PURE__ */ vwe(), t = /* @__PURE__ */ bwe(), n = t(function(r, i, s) {
    e(r, i, s);
  });
  return ck = n, ck;
}
var dk, pD;
function mU() {
  if (pD) return dk;
  pD = 1;
  function e(t, n) {
    return t < n;
  }
  return dk = e, dk;
}
var fk, mD;
function _we() {
  if (mD) return fk;
  mD = 1;
  var e = /* @__PURE__ */ Jj(), t = /* @__PURE__ */ mU(), n = /* @__PURE__ */ Mh();
  function r(i) {
    return i && i.length ? e(i, n, t) : void 0;
  }
  return fk = r, fk;
}
var hk, gD;
function Swe() {
  if (gD) return hk;
  gD = 1;
  var e = /* @__PURE__ */ Jj(), t = /* @__PURE__ */ oc(), n = /* @__PURE__ */ mU();
  function r(i, s) {
    return i && i.length ? e(i, t(s, 2), n) : void 0;
  }
  return hk = r, hk;
}
var pk, yD;
function Ewe() {
  if (yD) return pk;
  yD = 1;
  var e = /* @__PURE__ */ al(), t = function() {
    return e.Date.now();
  };
  return pk = t, pk;
}
var mk, xD;
function Cwe() {
  if (xD) return mk;
  xD = 1;
  var e = /* @__PURE__ */ Mw(), t = /* @__PURE__ */ Bw(), n = /* @__PURE__ */ Ow(), r = /* @__PURE__ */ co(), i = /* @__PURE__ */ vx();
  function s(a, u, d, f) {
    if (!r(a))
      return a;
    u = t(u, a);
    for (var h = -1, m = u.length, x = m - 1, b = a; b != null && ++h < m; ) {
      var w = i(u[h]), S = d;
      if (w === "__proto__" || w === "constructor" || w === "prototype")
        return a;
      if (h != x) {
        var C = b[w];
        S = f ? f(C, w, b) : void 0, S === void 0 && (S = r(C) ? C : n(u[h + 1]) ? [] : {});
      }
      e(b, w, S), b = b[w];
    }
    return a;
  }
  return mk = s, mk;
}
var gk, vD;
function kwe() {
  if (vD) return gk;
  vD = 1;
  var e = /* @__PURE__ */ $w(), t = /* @__PURE__ */ Cwe(), n = /* @__PURE__ */ Bw();
  function r(i, s, a) {
    for (var u = -1, d = s.length, f = {}; ++u < d; ) {
      var h = s[u], m = e(i, h);
      a(m, h) && t(f, n(h, i), m);
    }
    return f;
  }
  return gk = r, gk;
}
var yk, bD;
function Twe() {
  if (bD) return yk;
  bD = 1;
  var e = /* @__PURE__ */ kwe(), t = /* @__PURE__ */ KF();
  function n(r, i) {
    return e(r, i, function(s, a) {
      return t(r, a);
    });
  }
  return yk = n, yk;
}
var xk, wD;
function jwe() {
  if (wD) return xk;
  wD = 1;
  var e = /* @__PURE__ */ fU(), t = /* @__PURE__ */ tU(), n = /* @__PURE__ */ nU();
  function r(i) {
    return n(t(i, void 0, e), i + "");
  }
  return xk = r, xk;
}
var vk, _D;
function Awe() {
  if (_D) return vk;
  _D = 1;
  var e = /* @__PURE__ */ Twe(), t = /* @__PURE__ */ jwe(), n = t(function(r, i) {
    return r == null ? {} : e(r, i);
  });
  return vk = n, vk;
}
var bk, SD;
function Nwe() {
  if (SD) return bk;
  SD = 1;
  var e = Math.ceil, t = Math.max;
  function n(r, i, s, a) {
    for (var u = -1, d = t(e((i - r) / (s || 1)), 0), f = Array(d); d--; )
      f[a ? d : ++u] = r, r += s;
    return f;
  }
  return bk = n, bk;
}
var wk, ED;
function Rwe() {
  if (ED) return wk;
  ED = 1;
  var e = /* @__PURE__ */ Nwe(), t = /* @__PURE__ */ Fw(), n = /* @__PURE__ */ dU();
  function r(i) {
    return function(s, a, u) {
      return u && typeof u != "number" && t(s, a, u) && (a = u = void 0), s = n(s), a === void 0 ? (a = s, s = 0) : a = n(a), u = u === void 0 ? s < a ? 1 : -1 : n(u), e(s, a, u, i);
    };
  }
  return wk = r, wk;
}
var _k, CD;
function Mwe() {
  if (CD) return _k;
  CD = 1;
  var e = /* @__PURE__ */ Rwe(), t = e();
  return _k = t, _k;
}
var Sk, kD;
function Owe() {
  if (kD) return Sk;
  kD = 1;
  function e(t, n) {
    var r = t.length;
    for (t.sort(n); r--; )
      t[r] = t[r].value;
    return t;
  }
  return Sk = e, Sk;
}
var Ek, TD;
function Dwe() {
  if (TD) return Ek;
  TD = 1;
  var e = /* @__PURE__ */ rg();
  function t(n, r) {
    if (n !== r) {
      var i = n !== void 0, s = n === null, a = n === n, u = e(n), d = r !== void 0, f = r === null, h = r === r, m = e(r);
      if (!f && !m && !u && n > r || u && d && h && !f && !m || s && d && h || !i && h || !a)
        return 1;
      if (!s && !u && !m && n < r || m && i && a && !s && !u || f && i && a || !d && a || !h)
        return -1;
    }
    return 0;
  }
  return Ek = t, Ek;
}
var Ck, jD;
function zwe() {
  if (jD) return Ck;
  jD = 1;
  var e = /* @__PURE__ */ Dwe();
  function t(n, r, i) {
    for (var s = -1, a = n.criteria, u = r.criteria, d = a.length, f = i.length; ++s < d; ) {
      var h = e(a[s], u[s]);
      if (h) {
        if (s >= f)
          return h;
        var m = i[s];
        return h * (m == "desc" ? -1 : 1);
      }
    }
    return n.index - r.index;
  }
  return Ck = t, Ck;
}
var kk, AD;
function Pwe() {
  if (AD) return kk;
  AD = 1;
  var e = /* @__PURE__ */ Lw(), t = /* @__PURE__ */ $w(), n = /* @__PURE__ */ oc(), r = /* @__PURE__ */ QF(), i = /* @__PURE__ */ Owe(), s = /* @__PURE__ */ Dw(), a = /* @__PURE__ */ zwe(), u = /* @__PURE__ */ Mh(), d = /* @__PURE__ */ si();
  function f(h, m, x) {
    m.length ? m = e(m, function(S) {
      return d(S) ? function(C) {
        return t(C, S.length === 1 ? S[0] : S);
      } : S;
    }) : m = [u];
    var b = -1;
    m = e(m, s(n));
    var w = r(h, function(S, C, T) {
      var R = e(m, function(N) {
        return N(S);
      });
      return { criteria: R, index: ++b, value: S };
    });
    return i(w, function(S, C) {
      return a(S, C, x);
    });
  }
  return kk = f, kk;
}
var Tk, ND;
function Iwe() {
  if (ND) return Tk;
  ND = 1;
  var e = /* @__PURE__ */ Xj(), t = /* @__PURE__ */ Pwe(), n = /* @__PURE__ */ qw(), r = /* @__PURE__ */ Fw(), i = n(function(s, a) {
    if (s == null)
      return [];
    var u = a.length;
    return u > 1 && r(s, a[0], a[1]) ? a = [] : u > 2 && r(a[0], a[1], a[2]) && (a = [a[0]]), t(s, e(a, 1), []);
  });
  return Tk = i, Tk;
}
var jk, RD;
function Lwe() {
  if (RD) return jk;
  RD = 1;
  var e = /* @__PURE__ */ VF(), t = 0;
  function n(r) {
    var i = ++t;
    return e(r) + i;
  }
  return jk = n, jk;
}
var Ak, MD;
function Bwe() {
  if (MD) return Ak;
  MD = 1;
  function e(t, n, r) {
    for (var i = -1, s = t.length, a = n.length, u = {}; ++i < s; ) {
      var d = i < a ? n[i] : void 0;
      r(u, t[i], d);
    }
    return u;
  }
  return Ak = e, Ak;
}
var Nk, OD;
function $we() {
  if (OD) return Nk;
  OD = 1;
  var e = /* @__PURE__ */ Mw(), t = /* @__PURE__ */ Bwe();
  function n(r, i) {
    return t(r || [], i || [], e);
  }
  return Nk = n, Nk;
}
var Rk, DD;
function wr() {
  if (DD) return Rk;
  DD = 1;
  var e;
  if (typeof Pj == "function")
    try {
      e = {
        cloneDeep: /* @__PURE__ */ nwe(),
        constant: /* @__PURE__ */ Gj(),
        defaults: /* @__PURE__ */ rwe(),
        each: /* @__PURE__ */ LF(),
        filter: /* @__PURE__ */ WF(),
        find: /* @__PURE__ */ cwe(),
        flatten: /* @__PURE__ */ fU(),
        forEach: /* @__PURE__ */ IF(),
        forIn: /* @__PURE__ */ dwe(),
        has: /* @__PURE__ */ ZF(),
        isUndefined: /* @__PURE__ */ XF(),
        last: /* @__PURE__ */ fwe(),
        map: /* @__PURE__ */ JF(),
        mapValues: /* @__PURE__ */ hwe(),
        max: /* @__PURE__ */ mwe(),
        merge: /* @__PURE__ */ wwe(),
        min: /* @__PURE__ */ _we(),
        minBy: /* @__PURE__ */ Swe(),
        now: /* @__PURE__ */ Ewe(),
        pick: /* @__PURE__ */ Awe(),
        range: /* @__PURE__ */ Mwe(),
        reduce: /* @__PURE__ */ eU(),
        sortBy: /* @__PURE__ */ Iwe(),
        uniqueId: /* @__PURE__ */ Lwe(),
        values: /* @__PURE__ */ sU(),
        zipObject: /* @__PURE__ */ $we()
      };
    } catch {
    }
  return e || (e = window._), Rk = e, Rk;
}
var Mk, zD;
function qwe() {
  if (zD) return Mk;
  zD = 1, Mk = e;
  function e() {
    var r = {};
    r._next = r._prev = r, this._sentinel = r;
  }
  e.prototype.dequeue = function() {
    var r = this._sentinel, i = r._prev;
    if (i !== r)
      return t(i), i;
  }, e.prototype.enqueue = function(r) {
    var i = this._sentinel;
    r._prev && r._next && t(r), r._next = i._next, i._next._prev = r, i._next = r, r._prev = i;
  }, e.prototype.toString = function() {
    for (var r = [], i = this._sentinel, s = i._prev; s !== i; )
      r.push(JSON.stringify(s, n)), s = s._prev;
    return "[" + r.join(", ") + "]";
  };
  function t(r) {
    r._prev._next = r._next, r._next._prev = r._prev, delete r._next, delete r._prev;
  }
  function n(r, i) {
    if (r !== "_next" && r !== "_prev")
      return i;
  }
  return Mk;
}
var Ok, PD;
function Fwe() {
  if (PD) return Ok;
  PD = 1;
  var e = /* @__PURE__ */ wr(), t = il().Graph, n = /* @__PURE__ */ qwe();
  Ok = i;
  var r = e.constant(1);
  function i(f, h) {
    if (f.nodeCount() <= 1)
      return [];
    var m = u(f, h || r), x = s(m.graph, m.buckets, m.zeroIdx);
    return e.flatten(e.map(x, function(b) {
      return f.outEdges(b.v, b.w);
    }), !0);
  }
  function s(f, h, m) {
    for (var x = [], b = h[h.length - 1], w = h[0], S; f.nodeCount(); ) {
      for (; S = w.dequeue(); )
        a(f, h, m, S);
      for (; S = b.dequeue(); )
        a(f, h, m, S);
      if (f.nodeCount()) {
        for (var C = h.length - 2; C > 0; --C)
          if (S = h[C].dequeue(), S) {
            x = x.concat(a(f, h, m, S, !0));
            break;
          }
      }
    }
    return x;
  }
  function a(f, h, m, x, b) {
    var w = b ? [] : void 0;
    return e.forEach(f.inEdges(x.v), function(S) {
      var C = f.edge(S), T = f.node(S.v);
      b && w.push({ v: S.v, w: S.w }), T.out -= C, d(h, m, T);
    }), e.forEach(f.outEdges(x.v), function(S) {
      var C = f.edge(S), T = S.w, R = f.node(T);
      R.in -= C, d(h, m, R);
    }), f.removeNode(x.v), w;
  }
  function u(f, h) {
    var m = new t(), x = 0, b = 0;
    e.forEach(f.nodes(), function(C) {
      m.setNode(C, { v: C, in: 0, out: 0 });
    }), e.forEach(f.edges(), function(C) {
      var T = m.edge(C.v, C.w) || 0, R = h(C), N = T + R;
      m.setEdge(C.v, C.w, N), b = Math.max(b, m.node(C.v).out += R), x = Math.max(x, m.node(C.w).in += R);
    });
    var w = e.range(b + x + 3).map(function() {
      return new n();
    }), S = x + 1;
    return e.forEach(m.nodes(), function(C) {
      d(w, S, m.node(C));
    }), { graph: m, buckets: w, zeroIdx: S };
  }
  function d(f, h, m) {
    m.out ? m.in ? f[m.out - m.in + h].enqueue(m) : f[f.length - 1].enqueue(m) : f[0].enqueue(m);
  }
  return Ok;
}
var Dk, ID;
function Uwe() {
  if (ID) return Dk;
  ID = 1;
  var e = /* @__PURE__ */ wr(), t = /* @__PURE__ */ Fwe();
  Dk = {
    run: n,
    undo: i
  };
  function n(s) {
    var a = s.graph().acyclicer === "greedy" ? t(s, u(s)) : r(s);
    e.forEach(a, function(d) {
      var f = s.edge(d);
      s.removeEdge(d), f.forwardName = d.name, f.reversed = !0, s.setEdge(d.w, d.v, f, e.uniqueId("rev"));
    });
    function u(d) {
      return function(f) {
        return d.edge(f).weight;
      };
    }
  }
  function r(s) {
    var a = [], u = {}, d = {};
    function f(h) {
      e.has(d, h) || (d[h] = !0, u[h] = !0, e.forEach(s.outEdges(h), function(m) {
        e.has(u, m.w) ? a.push(m) : f(m.w);
      }), delete u[h]);
    }
    return e.forEach(s.nodes(), f), a;
  }
  function i(s) {
    e.forEach(s.edges(), function(a) {
      var u = s.edge(a);
      if (u.reversed) {
        s.removeEdge(a);
        var d = u.forwardName;
        delete u.reversed, delete u.forwardName, s.setEdge(a.w, a.v, u, d);
      }
    });
  }
  return Dk;
}
var zk, LD;
function ha() {
  if (LD) return zk;
  LD = 1;
  var e = /* @__PURE__ */ wr(), t = il().Graph;
  zk = {
    addDummyNode: n,
    simplify: r,
    asNonCompoundGraph: i,
    successorWeights: s,
    predecessorWeights: a,
    intersectRect: u,
    buildLayerMatrix: d,
    normalizeRanks: f,
    removeEmptyRanks: h,
    addBorderNode: m,
    maxRank: x,
    partition: b,
    time: w,
    notime: S
  };
  function n(C, T, R, N) {
    var M;
    do
      M = e.uniqueId(N);
    while (C.hasNode(M));
    return R.dummy = T, C.setNode(M, R), M;
  }
  function r(C) {
    var T = new t().setGraph(C.graph());
    return e.forEach(C.nodes(), function(R) {
      T.setNode(R, C.node(R));
    }), e.forEach(C.edges(), function(R) {
      var N = T.edge(R.v, R.w) || { weight: 0, minlen: 1 }, M = C.edge(R);
      T.setEdge(R.v, R.w, {
        weight: N.weight + M.weight,
        minlen: Math.max(N.minlen, M.minlen)
      });
    }), T;
  }
  function i(C) {
    var T = new t({ multigraph: C.isMultigraph() }).setGraph(C.graph());
    return e.forEach(C.nodes(), function(R) {
      C.children(R).length || T.setNode(R, C.node(R));
    }), e.forEach(C.edges(), function(R) {
      T.setEdge(R, C.edge(R));
    }), T;
  }
  function s(C) {
    var T = e.map(C.nodes(), function(R) {
      var N = {};
      return e.forEach(C.outEdges(R), function(M) {
        N[M.w] = (N[M.w] || 0) + C.edge(M).weight;
      }), N;
    });
    return e.zipObject(C.nodes(), T);
  }
  function a(C) {
    var T = e.map(C.nodes(), function(R) {
      var N = {};
      return e.forEach(C.inEdges(R), function(M) {
        N[M.v] = (N[M.v] || 0) + C.edge(M).weight;
      }), N;
    });
    return e.zipObject(C.nodes(), T);
  }
  function u(C, T) {
    var R = C.x, N = C.y, M = T.x - R, P = T.y - N, D = C.width / 2, q = C.height / 2;
    if (!M && !P)
      throw new Error("Not possible to find intersection inside of the rectangle");
    var Y, te;
    return Math.abs(P) * D > Math.abs(M) * q ? (P < 0 && (q = -q), Y = q * M / P, te = q) : (M < 0 && (D = -D), Y = D, te = D * P / M), { x: R + Y, y: N + te };
  }
  function d(C) {
    var T = e.map(e.range(x(C) + 1), function() {
      return [];
    });
    return e.forEach(C.nodes(), function(R) {
      var N = C.node(R), M = N.rank;
      e.isUndefined(M) || (T[M][N.order] = R);
    }), T;
  }
  function f(C) {
    var T = e.min(e.map(C.nodes(), function(R) {
      return C.node(R).rank;
    }));
    e.forEach(C.nodes(), function(R) {
      var N = C.node(R);
      e.has(N, "rank") && (N.rank -= T);
    });
  }
  function h(C) {
    var T = e.min(e.map(C.nodes(), function(P) {
      return C.node(P).rank;
    })), R = [];
    e.forEach(C.nodes(), function(P) {
      var D = C.node(P).rank - T;
      R[D] || (R[D] = []), R[D].push(P);
    });
    var N = 0, M = C.graph().nodeRankFactor;
    e.forEach(R, function(P, D) {
      e.isUndefined(P) && D % M !== 0 ? --N : N && e.forEach(P, function(q) {
        C.node(q).rank += N;
      });
    });
  }
  function m(C, T, R, N) {
    var M = {
      width: 0,
      height: 0
    };
    return arguments.length >= 4 && (M.rank = R, M.order = N), n(C, "border", M, T);
  }
  function x(C) {
    return e.max(e.map(C.nodes(), function(T) {
      var R = C.node(T).rank;
      if (!e.isUndefined(R))
        return R;
    }));
  }
  function b(C, T) {
    var R = { lhs: [], rhs: [] };
    return e.forEach(C, function(N) {
      T(N) ? R.lhs.push(N) : R.rhs.push(N);
    }), R;
  }
  function w(C, T) {
    var R = e.now();
    try {
      return T();
    } finally {
      console.log(C + " time: " + (e.now() - R) + "ms");
    }
  }
  function S(C, T) {
    return T();
  }
  return zk;
}
var Pk, BD;
function Hwe() {
  if (BD) return Pk;
  BD = 1;
  var e = /* @__PURE__ */ wr(), t = /* @__PURE__ */ ha();
  Pk = {
    run: n,
    undo: i
  };
  function n(s) {
    s.graph().dummyChains = [], e.forEach(s.edges(), function(a) {
      r(s, a);
    });
  }
  function r(s, a) {
    var u = a.v, d = s.node(u).rank, f = a.w, h = s.node(f).rank, m = a.name, x = s.edge(a), b = x.labelRank;
    if (h !== d + 1) {
      s.removeEdge(a);
      var w, S, C;
      for (C = 0, ++d; d < h; ++C, ++d)
        x.points = [], S = {
          width: 0,
          height: 0,
          edgeLabel: x,
          edgeObj: a,
          rank: d
        }, w = t.addDummyNode(s, "edge", S, "_d"), d === b && (S.width = x.width, S.height = x.height, S.dummy = "edge-label", S.labelpos = x.labelpos), s.setEdge(u, w, { weight: x.weight }, m), C === 0 && s.graph().dummyChains.push(w), u = w;
      s.setEdge(u, f, { weight: x.weight }, m);
    }
  }
  function i(s) {
    e.forEach(s.graph().dummyChains, function(a) {
      var u = s.node(a), d = u.edgeLabel, f;
      for (s.setEdge(u.edgeObj, d); u.dummy; )
        f = s.successors(a)[0], s.removeNode(a), d.points.push({ x: u.x, y: u.y }), u.dummy === "edge-label" && (d.x = u.x, d.y = u.y, d.width = u.width, d.height = u.height), a = f, u = s.node(a);
    });
  }
  return Pk;
}
var Ik, $D;
function Lb() {
  if ($D) return Ik;
  $D = 1;
  var e = /* @__PURE__ */ wr();
  Ik = {
    longestPath: t,
    slack: n
  };
  function t(r) {
    var i = {};
    function s(a) {
      var u = r.node(a);
      if (e.has(i, a))
        return u.rank;
      i[a] = !0;
      var d = e.min(e.map(r.outEdges(a), function(f) {
        return s(f.w) - r.edge(f).minlen;
      }));
      return (d === Number.POSITIVE_INFINITY || // return value of _.map([]) for Lodash 3
      d === void 0 || // return value of _.map([]) for Lodash 4
      d === null) && (d = 0), u.rank = d;
    }
    e.forEach(r.sources(), s);
  }
  function n(r, i) {
    return r.node(i.w).rank - r.node(i.v).rank - r.edge(i).minlen;
  }
  return Ik;
}
var Lk, qD;
function gU() {
  if (qD) return Lk;
  qD = 1;
  var e = /* @__PURE__ */ wr(), t = il().Graph, n = Lb().slack;
  Lk = r;
  function r(u) {
    var d = new t({ directed: !1 }), f = u.nodes()[0], h = u.nodeCount();
    d.setNode(f, {});
    for (var m, x; i(d, u) < h; )
      m = s(d, u), x = d.hasNode(m.v) ? n(u, m) : -n(u, m), a(d, u, x);
    return d;
  }
  function i(u, d) {
    function f(h) {
      e.forEach(d.nodeEdges(h), function(m) {
        var x = m.v, b = h === x ? m.w : x;
        !u.hasNode(b) && !n(d, m) && (u.setNode(b, {}), u.setEdge(h, b, {}), f(b));
      });
    }
    return e.forEach(u.nodes(), f), u.nodeCount();
  }
  function s(u, d) {
    return e.minBy(d.edges(), function(f) {
      if (u.hasNode(f.v) !== u.hasNode(f.w))
        return n(d, f);
    });
  }
  function a(u, d, f) {
    e.forEach(u.nodes(), function(h) {
      d.node(h).rank += f;
    });
  }
  return Lk;
}
var Bk, FD;
function Vwe() {
  if (FD) return Bk;
  FD = 1;
  var e = /* @__PURE__ */ wr(), t = /* @__PURE__ */ gU(), n = Lb().slack, r = Lb().longestPath, i = il().alg.preorder, s = il().alg.postorder, a = ha().simplify;
  Bk = u, u.initLowLimValues = m, u.initCutValues = d, u.calcCutValue = h, u.leaveEdge = b, u.enterEdge = w, u.exchangeEdges = S;
  function u(N) {
    N = a(N), r(N);
    var M = t(N);
    m(M), d(M, N);
    for (var P, D; P = b(M); )
      D = w(M, N, P), S(M, N, P, D);
  }
  function d(N, M) {
    var P = s(N, N.nodes());
    P = P.slice(0, P.length - 1), e.forEach(P, function(D) {
      f(N, M, D);
    });
  }
  function f(N, M, P) {
    var D = N.node(P), q = D.parent;
    N.edge(P, q).cutvalue = h(N, M, P);
  }
  function h(N, M, P) {
    var D = N.node(P), q = D.parent, Y = !0, te = M.edge(P, q), V = 0;
    return te || (Y = !1, te = M.edge(q, P)), V = te.weight, e.forEach(M.nodeEdges(P), function($) {
      var G = $.v === P, le = G ? $.w : $.v;
      if (le !== q) {
        var Z = G === Y, oe = M.edge($).weight;
        if (V += Z ? oe : -oe, T(N, P, le)) {
          var X = N.edge(P, le).cutvalue;
          V += Z ? -X : X;
        }
      }
    }), V;
  }
  function m(N, M) {
    arguments.length < 2 && (M = N.nodes()[0]), x(N, {}, 1, M);
  }
  function x(N, M, P, D, q) {
    var Y = P, te = N.node(D);
    return M[D] = !0, e.forEach(N.neighbors(D), function(V) {
      e.has(M, V) || (P = x(N, M, P, V, D));
    }), te.low = Y, te.lim = P++, q ? te.parent = q : delete te.parent, P;
  }
  function b(N) {
    return e.find(N.edges(), function(M) {
      return N.edge(M).cutvalue < 0;
    });
  }
  function w(N, M, P) {
    var D = P.v, q = P.w;
    M.hasEdge(D, q) || (D = P.w, q = P.v);
    var Y = N.node(D), te = N.node(q), V = Y, $ = !1;
    Y.lim > te.lim && (V = te, $ = !0);
    var G = e.filter(M.edges(), function(le) {
      return $ === R(N, N.node(le.v), V) && $ !== R(N, N.node(le.w), V);
    });
    return e.minBy(G, function(le) {
      return n(M, le);
    });
  }
  function S(N, M, P, D) {
    var q = P.v, Y = P.w;
    N.removeEdge(q, Y), N.setEdge(D.v, D.w, {}), m(N), d(N, M), C(N, M);
  }
  function C(N, M) {
    var P = e.find(N.nodes(), function(q) {
      return !M.node(q).parent;
    }), D = i(N, P);
    D = D.slice(1), e.forEach(D, function(q) {
      var Y = N.node(q).parent, te = M.edge(q, Y), V = !1;
      te || (te = M.edge(Y, q), V = !0), M.node(q).rank = M.node(Y).rank + (V ? te.minlen : -te.minlen);
    });
  }
  function T(N, M, P) {
    return N.hasEdge(M, P);
  }
  function R(N, M, P) {
    return P.low <= M.lim && M.lim <= P.lim;
  }
  return Bk;
}
var $k, UD;
function Gwe() {
  if (UD) return $k;
  UD = 1;
  var e = /* @__PURE__ */ Lb(), t = e.longestPath, n = /* @__PURE__ */ gU(), r = /* @__PURE__ */ Vwe();
  $k = i;
  function i(d) {
    switch (d.graph().ranker) {
      case "network-simplex":
        u(d);
        break;
      case "tight-tree":
        a(d);
        break;
      case "longest-path":
        s(d);
        break;
      default:
        u(d);
    }
  }
  var s = t;
  function a(d) {
    t(d), n(d);
  }
  function u(d) {
    r(d);
  }
  return $k;
}
var qk, HD;
function Kwe() {
  if (HD) return qk;
  HD = 1;
  var e = /* @__PURE__ */ wr();
  qk = t;
  function t(i) {
    var s = r(i);
    e.forEach(i.graph().dummyChains, function(a) {
      for (var u = i.node(a), d = u.edgeObj, f = n(i, s, d.v, d.w), h = f.path, m = f.lca, x = 0, b = h[x], w = !0; a !== d.w; ) {
        if (u = i.node(a), w) {
          for (; (b = h[x]) !== m && i.node(b).maxRank < u.rank; )
            x++;
          b === m && (w = !1);
        }
        if (!w) {
          for (; x < h.length - 1 && i.node(b = h[x + 1]).minRank <= u.rank; )
            x++;
          b = h[x];
        }
        i.setParent(a, b), a = i.successors(a)[0];
      }
    });
  }
  function n(i, s, a, u) {
    var d = [], f = [], h = Math.min(s[a].low, s[u].low), m = Math.max(s[a].lim, s[u].lim), x, b;
    x = a;
    do
      x = i.parent(x), d.push(x);
    while (x && (s[x].low > h || m > s[x].lim));
    for (b = x, x = u; (x = i.parent(x)) !== b; )
      f.push(x);
    return { path: d.concat(f.reverse()), lca: b };
  }
  function r(i) {
    var s = {}, a = 0;
    function u(d) {
      var f = a;
      e.forEach(i.children(d), u), s[d] = { low: f, lim: a++ };
    }
    return e.forEach(i.children(), u), s;
  }
  return qk;
}
var Fk, VD;
function Ywe() {
  if (VD) return Fk;
  VD = 1;
  var e = /* @__PURE__ */ wr(), t = /* @__PURE__ */ ha();
  Fk = {
    run: n,
    cleanup: a
  };
  function n(u) {
    var d = t.addDummyNode(u, "root", {}, "_root"), f = i(u), h = e.max(e.values(f)) - 1, m = 2 * h + 1;
    u.graph().nestingRoot = d, e.forEach(u.edges(), function(b) {
      u.edge(b).minlen *= m;
    });
    var x = s(u) + 1;
    e.forEach(u.children(), function(b) {
      r(u, d, m, x, h, f, b);
    }), u.graph().nodeRankFactor = m;
  }
  function r(u, d, f, h, m, x, b) {
    var w = u.children(b);
    if (!w.length) {
      b !== d && u.setEdge(d, b, { weight: 0, minlen: f });
      return;
    }
    var S = t.addBorderNode(u, "_bt"), C = t.addBorderNode(u, "_bb"), T = u.node(b);
    u.setParent(S, b), T.borderTop = S, u.setParent(C, b), T.borderBottom = C, e.forEach(w, function(R) {
      r(u, d, f, h, m, x, R);
      var N = u.node(R), M = N.borderTop ? N.borderTop : R, P = N.borderBottom ? N.borderBottom : R, D = N.borderTop ? h : 2 * h, q = M !== P ? 1 : m - x[b] + 1;
      u.setEdge(S, M, {
        weight: D,
        minlen: q,
        nestingEdge: !0
      }), u.setEdge(P, C, {
        weight: D,
        minlen: q,
        nestingEdge: !0
      });
    }), u.parent(b) || u.setEdge(d, S, { weight: 0, minlen: m + x[b] });
  }
  function i(u) {
    var d = {};
    function f(h, m) {
      var x = u.children(h);
      x && x.length && e.forEach(x, function(b) {
        f(b, m + 1);
      }), d[h] = m;
    }
    return e.forEach(u.children(), function(h) {
      f(h, 1);
    }), d;
  }
  function s(u) {
    return e.reduce(u.edges(), function(d, f) {
      return d + u.edge(f).weight;
    }, 0);
  }
  function a(u) {
    var d = u.graph();
    u.removeNode(d.nestingRoot), delete d.nestingRoot, e.forEach(u.edges(), function(f) {
      var h = u.edge(f);
      h.nestingEdge && u.removeEdge(f);
    });
  }
  return Fk;
}
var Uk, GD;
function Wwe() {
  if (GD) return Uk;
  GD = 1;
  var e = /* @__PURE__ */ wr(), t = /* @__PURE__ */ ha();
  Uk = n;
  function n(i) {
    function s(a) {
      var u = i.children(a), d = i.node(a);
      if (u.length && e.forEach(u, s), e.has(d, "minRank")) {
        d.borderLeft = [], d.borderRight = [];
        for (var f = d.minRank, h = d.maxRank + 1; f < h; ++f)
          r(i, "borderLeft", "_bl", a, d, f), r(i, "borderRight", "_br", a, d, f);
      }
    }
    e.forEach(i.children(), s);
  }
  function r(i, s, a, u, d, f) {
    var h = { width: 0, height: 0, rank: f, borderType: s }, m = d[s][f - 1], x = t.addDummyNode(i, "border", h, a);
    d[s][f] = x, i.setParent(x, u), m && i.setEdge(m, x, { weight: 1 });
  }
  return Uk;
}
var Hk, KD;
function Zwe() {
  if (KD) return Hk;
  KD = 1;
  var e = /* @__PURE__ */ wr();
  Hk = {
    adjust: t,
    undo: n
  };
  function t(f) {
    var h = f.graph().rankdir.toLowerCase();
    (h === "lr" || h === "rl") && r(f);
  }
  function n(f) {
    var h = f.graph().rankdir.toLowerCase();
    (h === "bt" || h === "rl") && s(f), (h === "lr" || h === "rl") && (u(f), r(f));
  }
  function r(f) {
    e.forEach(f.nodes(), function(h) {
      i(f.node(h));
    }), e.forEach(f.edges(), function(h) {
      i(f.edge(h));
    });
  }
  function i(f) {
    var h = f.width;
    f.width = f.height, f.height = h;
  }
  function s(f) {
    e.forEach(f.nodes(), function(h) {
      a(f.node(h));
    }), e.forEach(f.edges(), function(h) {
      var m = f.edge(h);
      e.forEach(m.points, a), e.has(m, "y") && a(m);
    });
  }
  function a(f) {
    f.y = -f.y;
  }
  function u(f) {
    e.forEach(f.nodes(), function(h) {
      d(f.node(h));
    }), e.forEach(f.edges(), function(h) {
      var m = f.edge(h);
      e.forEach(m.points, d), e.has(m, "x") && d(m);
    });
  }
  function d(f) {
    var h = f.x;
    f.x = f.y, f.y = h;
  }
  return Hk;
}
var Vk, YD;
function Xwe() {
  if (YD) return Vk;
  YD = 1;
  var e = /* @__PURE__ */ wr();
  Vk = t;
  function t(n) {
    var r = {}, i = e.filter(n.nodes(), function(f) {
      return !n.children(f).length;
    }), s = e.max(e.map(i, function(f) {
      return n.node(f).rank;
    })), a = e.map(e.range(s + 1), function() {
      return [];
    });
    function u(f) {
      if (!e.has(r, f)) {
        r[f] = !0;
        var h = n.node(f);
        a[h.rank].push(f), e.forEach(n.successors(f), u);
      }
    }
    var d = e.sortBy(i, function(f) {
      return n.node(f).rank;
    });
    return e.forEach(d, u), a;
  }
  return Vk;
}
var Gk, WD;
function Qwe() {
  if (WD) return Gk;
  WD = 1;
  var e = /* @__PURE__ */ wr();
  Gk = t;
  function t(r, i) {
    for (var s = 0, a = 1; a < i.length; ++a)
      s += n(r, i[a - 1], i[a]);
    return s;
  }
  function n(r, i, s) {
    for (var a = e.zipObject(
      s,
      e.map(s, function(x, b) {
        return b;
      })
    ), u = e.flatten(e.map(i, function(x) {
      return e.sortBy(e.map(r.outEdges(x), function(b) {
        return { pos: a[b.w], weight: r.edge(b).weight };
      }), "pos");
    }), !0), d = 1; d < s.length; ) d <<= 1;
    var f = 2 * d - 1;
    d -= 1;
    var h = e.map(new Array(f), function() {
      return 0;
    }), m = 0;
    return e.forEach(u.forEach(function(x) {
      var b = x.pos + d;
      h[b] += x.weight;
      for (var w = 0; b > 0; )
        b % 2 && (w += h[b + 1]), b = b - 1 >> 1, h[b] += x.weight;
      m += x.weight * w;
    })), m;
  }
  return Gk;
}
var Kk, ZD;
function Jwe() {
  if (ZD) return Kk;
  ZD = 1;
  var e = /* @__PURE__ */ wr();
  Kk = t;
  function t(n, r) {
    return e.map(r, function(i) {
      var s = n.inEdges(i);
      if (s.length) {
        var a = e.reduce(s, function(u, d) {
          var f = n.edge(d), h = n.node(d.v);
          return {
            sum: u.sum + f.weight * h.order,
            weight: u.weight + f.weight
          };
        }, { sum: 0, weight: 0 });
        return {
          v: i,
          barycenter: a.sum / a.weight,
          weight: a.weight
        };
      } else
        return { v: i };
    });
  }
  return Kk;
}
var Yk, XD;
function e2e() {
  if (XD) return Yk;
  XD = 1;
  var e = /* @__PURE__ */ wr();
  Yk = t;
  function t(i, s) {
    var a = {};
    e.forEach(i, function(d, f) {
      var h = a[d.v] = {
        indegree: 0,
        in: [],
        out: [],
        vs: [d.v],
        i: f
      };
      e.isUndefined(d.barycenter) || (h.barycenter = d.barycenter, h.weight = d.weight);
    }), e.forEach(s.edges(), function(d) {
      var f = a[d.v], h = a[d.w];
      !e.isUndefined(f) && !e.isUndefined(h) && (h.indegree++, f.out.push(a[d.w]));
    });
    var u = e.filter(a, function(d) {
      return !d.indegree;
    });
    return n(u);
  }
  function n(i) {
    var s = [];
    function a(f) {
      return function(h) {
        h.merged || (e.isUndefined(h.barycenter) || e.isUndefined(f.barycenter) || h.barycenter >= f.barycenter) && r(f, h);
      };
    }
    function u(f) {
      return function(h) {
        h.in.push(f), --h.indegree === 0 && i.push(h);
      };
    }
    for (; i.length; ) {
      var d = i.pop();
      s.push(d), e.forEach(d.in.reverse(), a(d)), e.forEach(d.out, u(d));
    }
    return e.map(
      e.filter(s, function(f) {
        return !f.merged;
      }),
      function(f) {
        return e.pick(f, ["vs", "i", "barycenter", "weight"]);
      }
    );
  }
  function r(i, s) {
    var a = 0, u = 0;
    i.weight && (a += i.barycenter * i.weight, u += i.weight), s.weight && (a += s.barycenter * s.weight, u += s.weight), i.vs = s.vs.concat(i.vs), i.barycenter = a / u, i.weight = u, i.i = Math.min(s.i, i.i), s.merged = !0;
  }
  return Yk;
}
var Wk, QD;
function t2e() {
  if (QD) return Wk;
  QD = 1;
  var e = /* @__PURE__ */ wr(), t = /* @__PURE__ */ ha();
  Wk = n;
  function n(s, a) {
    var u = t.partition(s, function(S) {
      return e.has(S, "barycenter");
    }), d = u.lhs, f = e.sortBy(u.rhs, function(S) {
      return -S.i;
    }), h = [], m = 0, x = 0, b = 0;
    d.sort(i(!!a)), b = r(h, f, b), e.forEach(d, function(S) {
      b += S.vs.length, h.push(S.vs), m += S.barycenter * S.weight, x += S.weight, b = r(h, f, b);
    });
    var w = { vs: e.flatten(h, !0) };
    return x && (w.barycenter = m / x, w.weight = x), w;
  }
  function r(s, a, u) {
    for (var d; a.length && (d = e.last(a)).i <= u; )
      a.pop(), s.push(d.vs), u++;
    return u;
  }
  function i(s) {
    return function(a, u) {
      return a.barycenter < u.barycenter ? -1 : a.barycenter > u.barycenter ? 1 : s ? u.i - a.i : a.i - u.i;
    };
  }
  return Wk;
}
var Zk, JD;
function n2e() {
  if (JD) return Zk;
  JD = 1;
  var e = /* @__PURE__ */ wr(), t = /* @__PURE__ */ Jwe(), n = /* @__PURE__ */ e2e(), r = /* @__PURE__ */ t2e();
  Zk = i;
  function i(u, d, f, h) {
    var m = u.children(d), x = u.node(d), b = x ? x.borderLeft : void 0, w = x ? x.borderRight : void 0, S = {};
    b && (m = e.filter(m, function(P) {
      return P !== b && P !== w;
    }));
    var C = t(u, m);
    e.forEach(C, function(P) {
      if (u.children(P.v).length) {
        var D = i(u, P.v, f, h);
        S[P.v] = D, e.has(D, "barycenter") && a(P, D);
      }
    });
    var T = n(C, f);
    s(T, S);
    var R = r(T, h);
    if (b && (R.vs = e.flatten([b, R.vs, w], !0), u.predecessors(b).length)) {
      var N = u.node(u.predecessors(b)[0]), M = u.node(u.predecessors(w)[0]);
      e.has(R, "barycenter") || (R.barycenter = 0, R.weight = 0), R.barycenter = (R.barycenter * R.weight + N.order + M.order) / (R.weight + 2), R.weight += 2;
    }
    return R;
  }
  function s(u, d) {
    e.forEach(u, function(f) {
      f.vs = e.flatten(f.vs.map(function(h) {
        return d[h] ? d[h].vs : h;
      }), !0);
    });
  }
  function a(u, d) {
    e.isUndefined(u.barycenter) ? (u.barycenter = d.barycenter, u.weight = d.weight) : (u.barycenter = (u.barycenter * u.weight + d.barycenter * d.weight) / (u.weight + d.weight), u.weight += d.weight);
  }
  return Zk;
}
var Xk, ez;
function r2e() {
  if (ez) return Xk;
  ez = 1;
  var e = /* @__PURE__ */ wr(), t = il().Graph;
  Xk = n;
  function n(i, s, a) {
    var u = r(i), d = new t({ compound: !0 }).setGraph({ root: u }).setDefaultNodeLabel(function(f) {
      return i.node(f);
    });
    return e.forEach(i.nodes(), function(f) {
      var h = i.node(f), m = i.parent(f);
      (h.rank === s || h.minRank <= s && s <= h.maxRank) && (d.setNode(f), d.setParent(f, m || u), e.forEach(i[a](f), function(x) {
        var b = x.v === f ? x.w : x.v, w = d.edge(b, f), S = e.isUndefined(w) ? 0 : w.weight;
        d.setEdge(b, f, { weight: i.edge(x).weight + S });
      }), e.has(h, "minRank") && d.setNode(f, {
        borderLeft: h.borderLeft[s],
        borderRight: h.borderRight[s]
      }));
    }), d;
  }
  function r(i) {
    for (var s; i.hasNode(s = e.uniqueId("_root")); ) ;
    return s;
  }
  return Xk;
}
var Qk, tz;
function i2e() {
  if (tz) return Qk;
  tz = 1;
  var e = /* @__PURE__ */ wr();
  Qk = t;
  function t(n, r, i) {
    var s = {}, a;
    e.forEach(i, function(u) {
      for (var d = n.parent(u), f, h; d; ) {
        if (f = n.parent(d), f ? (h = s[f], s[f] = d) : (h = a, a = d), h && h !== d) {
          r.setEdge(h, d);
          return;
        }
        d = f;
      }
    });
  }
  return Qk;
}
var Jk, nz;
function s2e() {
  if (nz) return Jk;
  nz = 1;
  var e = /* @__PURE__ */ wr(), t = /* @__PURE__ */ Xwe(), n = /* @__PURE__ */ Qwe(), r = /* @__PURE__ */ n2e(), i = /* @__PURE__ */ r2e(), s = /* @__PURE__ */ i2e(), a = il().Graph, u = /* @__PURE__ */ ha();
  Jk = d;
  function d(x) {
    var b = u.maxRank(x), w = f(x, e.range(1, b + 1), "inEdges"), S = f(x, e.range(b - 1, -1, -1), "outEdges"), C = t(x);
    m(x, C);
    for (var T = Number.POSITIVE_INFINITY, R, N = 0, M = 0; M < 4; ++N, ++M) {
      h(N % 2 ? w : S, N % 4 >= 2), C = u.buildLayerMatrix(x);
      var P = n(x, C);
      P < T && (M = 0, R = e.cloneDeep(C), T = P);
    }
    m(x, R);
  }
  function f(x, b, w) {
    return e.map(b, function(S) {
      return i(x, S, w);
    });
  }
  function h(x, b) {
    var w = new a();
    e.forEach(x, function(S) {
      var C = S.graph().root, T = r(S, C, w, b);
      e.forEach(T.vs, function(R, N) {
        S.node(R).order = N;
      }), s(S, w, T.vs);
    });
  }
  function m(x, b) {
    e.forEach(b, function(w) {
      e.forEach(w, function(S, C) {
        x.node(S).order = C;
      });
    });
  }
  return Jk;
}
var e3, rz;
function a2e() {
  if (rz) return e3;
  rz = 1;
  var e = /* @__PURE__ */ wr(), t = il().Graph, n = /* @__PURE__ */ ha();
  e3 = {
    positionX: w,
    findType1Conflicts: r,
    findType2Conflicts: i,
    addConflict: a,
    hasConflict: u,
    verticalAlignment: d,
    horizontalCompaction: f,
    alignCoordinates: x,
    findSmallestWidthAlignment: m,
    balance: b
  };
  function r(T, R) {
    var N = {};
    function M(P, D) {
      var q = 0, Y = 0, te = P.length, V = e.last(D);
      return e.forEach(D, function($, G) {
        var le = s(T, $), Z = le ? T.node(le).order : te;
        (le || $ === V) && (e.forEach(D.slice(Y, G + 1), function(oe) {
          e.forEach(T.predecessors(oe), function(X) {
            var ce = T.node(X), pe = ce.order;
            (pe < q || Z < pe) && !(ce.dummy && T.node(oe).dummy) && a(N, X, oe);
          });
        }), Y = G + 1, q = Z);
      }), D;
    }
    return e.reduce(R, M), N;
  }
  function i(T, R) {
    var N = {};
    function M(D, q, Y, te, V) {
      var $;
      e.forEach(e.range(q, Y), function(G) {
        $ = D[G], T.node($).dummy && e.forEach(T.predecessors($), function(le) {
          var Z = T.node(le);
          Z.dummy && (Z.order < te || Z.order > V) && a(N, le, $);
        });
      });
    }
    function P(D, q) {
      var Y = -1, te, V = 0;
      return e.forEach(q, function($, G) {
        if (T.node($).dummy === "border") {
          var le = T.predecessors($);
          le.length && (te = T.node(le[0]).order, M(q, V, G, Y, te), V = G, Y = te);
        }
        M(q, V, q.length, te, D.length);
      }), q;
    }
    return e.reduce(R, P), N;
  }
  function s(T, R) {
    if (T.node(R).dummy)
      return e.find(T.predecessors(R), function(N) {
        return T.node(N).dummy;
      });
  }
  function a(T, R, N) {
    if (R > N) {
      var M = R;
      R = N, N = M;
    }
    var P = T[R];
    P || (T[R] = P = {}), P[N] = !0;
  }
  function u(T, R, N) {
    if (R > N) {
      var M = R;
      R = N, N = M;
    }
    return e.has(T[R], N);
  }
  function d(T, R, N, M) {
    var P = {}, D = {}, q = {};
    return e.forEach(R, function(Y) {
      e.forEach(Y, function(te, V) {
        P[te] = te, D[te] = te, q[te] = V;
      });
    }), e.forEach(R, function(Y) {
      var te = -1;
      e.forEach(Y, function(V) {
        var $ = M(V);
        if ($.length) {
          $ = e.sortBy($, function(X) {
            return q[X];
          });
          for (var G = ($.length - 1) / 2, le = Math.floor(G), Z = Math.ceil(G); le <= Z; ++le) {
            var oe = $[le];
            D[V] === V && te < q[oe] && !u(N, V, oe) && (D[oe] = V, D[V] = P[V] = P[oe], te = q[oe]);
          }
        }
      });
    }), { root: P, align: D };
  }
  function f(T, R, N, M, P) {
    var D = {}, q = h(T, R, N, P), Y = P ? "borderLeft" : "borderRight";
    function te(G, le) {
      for (var Z = q.nodes(), oe = Z.pop(), X = {}; oe; )
        X[oe] ? G(oe) : (X[oe] = !0, Z.push(oe), Z = Z.concat(le(oe))), oe = Z.pop();
    }
    function V(G) {
      D[G] = q.inEdges(G).reduce(function(le, Z) {
        return Math.max(le, D[Z.v] + q.edge(Z));
      }, 0);
    }
    function $(G) {
      var le = q.outEdges(G).reduce(function(oe, X) {
        return Math.min(oe, D[X.w] - q.edge(X));
      }, Number.POSITIVE_INFINITY), Z = T.node(G);
      le !== Number.POSITIVE_INFINITY && Z.borderType !== Y && (D[G] = Math.max(D[G], le));
    }
    return te(V, q.predecessors.bind(q)), te($, q.successors.bind(q)), e.forEach(M, function(G) {
      D[G] = D[N[G]];
    }), D;
  }
  function h(T, R, N, M) {
    var P = new t(), D = T.graph(), q = S(D.nodesep, D.edgesep, M);
    return e.forEach(R, function(Y) {
      var te;
      e.forEach(Y, function(V) {
        var $ = N[V];
        if (P.setNode($), te) {
          var G = N[te], le = P.edge(G, $);
          P.setEdge(G, $, Math.max(q(T, V, te), le || 0));
        }
        te = V;
      });
    }), P;
  }
  function m(T, R) {
    return e.minBy(e.values(R), function(N) {
      var M = Number.NEGATIVE_INFINITY, P = Number.POSITIVE_INFINITY;
      return e.forIn(N, function(D, q) {
        var Y = C(T, q) / 2;
        M = Math.max(D + Y, M), P = Math.min(D - Y, P);
      }), M - P;
    });
  }
  function x(T, R) {
    var N = e.values(R), M = e.min(N), P = e.max(N);
    e.forEach(["u", "d"], function(D) {
      e.forEach(["l", "r"], function(q) {
        var Y = D + q, te = T[Y], V;
        if (te !== R) {
          var $ = e.values(te);
          V = q === "l" ? M - e.min($) : P - e.max($), V && (T[Y] = e.mapValues(te, function(G) {
            return G + V;
          }));
        }
      });
    });
  }
  function b(T, R) {
    return e.mapValues(T.ul, function(N, M) {
      if (R)
        return T[R.toLowerCase()][M];
      var P = e.sortBy(e.map(T, M));
      return (P[1] + P[2]) / 2;
    });
  }
  function w(T) {
    var R = n.buildLayerMatrix(T), N = e.merge(
      r(T, R),
      i(T, R)
    ), M = {}, P;
    e.forEach(["u", "d"], function(q) {
      P = q === "u" ? R : e.values(R).reverse(), e.forEach(["l", "r"], function(Y) {
        Y === "r" && (P = e.map(P, function(G) {
          return e.values(G).reverse();
        }));
        var te = (q === "u" ? T.predecessors : T.successors).bind(T), V = d(T, P, N, te), $ = f(
          T,
          P,
          V.root,
          V.align,
          Y === "r"
        );
        Y === "r" && ($ = e.mapValues($, function(G) {
          return -G;
        })), M[q + Y] = $;
      });
    });
    var D = m(T, M);
    return x(M, D), b(M, T.graph().align);
  }
  function S(T, R, N) {
    return function(M, P, D) {
      var q = M.node(P), Y = M.node(D), te = 0, V;
      if (te += q.width / 2, e.has(q, "labelpos"))
        switch (q.labelpos.toLowerCase()) {
          case "l":
            V = -q.width / 2;
            break;
          case "r":
            V = q.width / 2;
            break;
        }
      if (V && (te += N ? V : -V), V = 0, te += (q.dummy ? R : T) / 2, te += (Y.dummy ? R : T) / 2, te += Y.width / 2, e.has(Y, "labelpos"))
        switch (Y.labelpos.toLowerCase()) {
          case "l":
            V = Y.width / 2;
            break;
          case "r":
            V = -Y.width / 2;
            break;
        }
      return V && (te += N ? V : -V), V = 0, te;
    };
  }
  function C(T, R) {
    return T.node(R).width;
  }
  return e3;
}
var t3, iz;
function o2e() {
  if (iz) return t3;
  iz = 1;
  var e = /* @__PURE__ */ wr(), t = /* @__PURE__ */ ha(), n = a2e().positionX;
  t3 = r;
  function r(s) {
    s = t.asNonCompoundGraph(s), i(s), e.forEach(n(s), function(a, u) {
      s.node(u).x = a;
    });
  }
  function i(s) {
    var a = t.buildLayerMatrix(s), u = s.graph().ranksep, d = 0;
    e.forEach(a, function(f) {
      var h = e.max(e.map(f, function(m) {
        return s.node(m).height;
      }));
      e.forEach(f, function(m) {
        s.node(m).y = d + h / 2;
      }), d += h + u;
    });
  }
  return t3;
}
var n3, sz;
function l2e() {
  if (sz) return n3;
  sz = 1;
  var e = /* @__PURE__ */ wr(), t = /* @__PURE__ */ Uwe(), n = /* @__PURE__ */ Hwe(), r = /* @__PURE__ */ Gwe(), i = ha().normalizeRanks, s = /* @__PURE__ */ Kwe(), a = ha().removeEmptyRanks, u = /* @__PURE__ */ Ywe(), d = /* @__PURE__ */ Wwe(), f = /* @__PURE__ */ Zwe(), h = /* @__PURE__ */ s2e(), m = /* @__PURE__ */ o2e(), x = /* @__PURE__ */ ha(), b = il().Graph;
  n3 = w;
  function w(fe, ve) {
    var Se = ve && ve.debugTiming ? x.time : x.notime;
    Se("layout", function() {
      var Me = Se("  buildLayoutGraph", function() {
        return te(fe);
      });
      Se("  runLayout", function() {
        S(Me, Se);
      }), Se("  updateInputGraph", function() {
        C(fe, Me);
      });
    });
  }
  function S(fe, ve) {
    ve("    makeSpaceForEdgeLabels", function() {
      V(fe);
    }), ve("    removeSelfEdges", function() {
      de(fe);
    }), ve("    acyclic", function() {
      t.run(fe);
    }), ve("    nestingGraph.run", function() {
      u.run(fe);
    }), ve("    rank", function() {
      r(x.asNonCompoundGraph(fe));
    }), ve("    injectEdgeLabelProxies", function() {
      $(fe);
    }), ve("    removeEmptyRanks", function() {
      a(fe);
    }), ve("    nestingGraph.cleanup", function() {
      u.cleanup(fe);
    }), ve("    normalizeRanks", function() {
      i(fe);
    }), ve("    assignRankMinMax", function() {
      G(fe);
    }), ve("    removeEdgeLabelProxies", function() {
      le(fe);
    }), ve("    normalize.run", function() {
      n.run(fe);
    }), ve("    parentDummyChains", function() {
      s(fe);
    }), ve("    addBorderSegments", function() {
      d(fe);
    }), ve("    order", function() {
      h(fe);
    }), ve("    insertSelfEdges", function() {
      H(fe);
    }), ve("    adjustCoordinateSystem", function() {
      f.adjust(fe);
    }), ve("    position", function() {
      m(fe);
    }), ve("    positionSelfEdges", function() {
      J(fe);
    }), ve("    removeBorderNodes", function() {
      pe(fe);
    }), ve("    normalize.undo", function() {
      n.undo(fe);
    }), ve("    fixupEdgeLabelCoords", function() {
      X(fe);
    }), ve("    undoCoordinateSystem", function() {
      f.undo(fe);
    }), ve("    translateGraph", function() {
      Z(fe);
    }), ve("    assignNodeIntersects", function() {
      oe(fe);
    }), ve("    reversePoints", function() {
      ce(fe);
    }), ve("    acyclic.undo", function() {
      t.undo(fe);
    });
  }
  function C(fe, ve) {
    e.forEach(fe.nodes(), function(Se) {
      var Me = fe.node(Se), Ie = ve.node(Se);
      Me && (Me.x = Ie.x, Me.y = Ie.y, ve.children(Se).length && (Me.width = Ie.width, Me.height = Ie.height));
    }), e.forEach(fe.edges(), function(Se) {
      var Me = fe.edge(Se), Ie = ve.edge(Se);
      Me.points = Ie.points, e.has(Ie, "x") && (Me.x = Ie.x, Me.y = Ie.y);
    }), fe.graph().width = ve.graph().width, fe.graph().height = ve.graph().height;
  }
  var T = ["nodesep", "edgesep", "ranksep", "marginx", "marginy"], R = { ranksep: 50, edgesep: 20, nodesep: 50, rankdir: "tb" }, N = ["acyclicer", "ranker", "rankdir", "align"], M = ["width", "height"], P = { width: 0, height: 0 }, D = ["minlen", "weight", "width", "height", "labeloffset"], q = {
    minlen: 1,
    weight: 1,
    width: 0,
    height: 0,
    labeloffset: 10,
    labelpos: "r"
  }, Y = ["labelpos"];
  function te(fe) {
    var ve = new b({ multigraph: !0, compound: !0 }), Se = Q(fe.graph());
    return ve.setGraph(e.merge(
      {},
      R,
      ge(Se, T),
      e.pick(Se, N)
    )), e.forEach(fe.nodes(), function(Me) {
      var Ie = Q(fe.node(Me));
      ve.setNode(Me, e.defaults(ge(Ie, M), P)), ve.setParent(Me, fe.parent(Me));
    }), e.forEach(fe.edges(), function(Me) {
      var Ie = Q(fe.edge(Me));
      ve.setEdge(Me, e.merge(
        {},
        q,
        ge(Ie, D),
        e.pick(Ie, Y)
      ));
    }), ve;
  }
  function V(fe) {
    var ve = fe.graph();
    ve.ranksep /= 2, e.forEach(fe.edges(), function(Se) {
      var Me = fe.edge(Se);
      Me.minlen *= 2, Me.labelpos.toLowerCase() !== "c" && (ve.rankdir === "TB" || ve.rankdir === "BT" ? Me.width += Me.labeloffset : Me.height += Me.labeloffset);
    });
  }
  function $(fe) {
    e.forEach(fe.edges(), function(ve) {
      var Se = fe.edge(ve);
      if (Se.width && Se.height) {
        var Me = fe.node(ve.v), Ie = fe.node(ve.w), Re = { rank: (Ie.rank - Me.rank) / 2 + Me.rank, e: ve };
        x.addDummyNode(fe, "edge-proxy", Re, "_ep");
      }
    });
  }
  function G(fe) {
    var ve = 0;
    e.forEach(fe.nodes(), function(Se) {
      var Me = fe.node(Se);
      Me.borderTop && (Me.minRank = fe.node(Me.borderTop).rank, Me.maxRank = fe.node(Me.borderBottom).rank, ve = e.max(ve, Me.maxRank));
    }), fe.graph().maxRank = ve;
  }
  function le(fe) {
    e.forEach(fe.nodes(), function(ve) {
      var Se = fe.node(ve);
      Se.dummy === "edge-proxy" && (fe.edge(Se.e).labelRank = Se.rank, fe.removeNode(ve));
    });
  }
  function Z(fe) {
    var ve = Number.POSITIVE_INFINITY, Se = 0, Me = Number.POSITIVE_INFINITY, Ie = 0, Re = fe.graph(), mt = Re.marginx || 0, dt = Re.marginy || 0;
    function Je(ft) {
      var yt = ft.x, ht = ft.y, Le = ft.width, Ye = ft.height;
      ve = Math.min(ve, yt - Le / 2), Se = Math.max(Se, yt + Le / 2), Me = Math.min(Me, ht - Ye / 2), Ie = Math.max(Ie, ht + Ye / 2);
    }
    e.forEach(fe.nodes(), function(ft) {
      Je(fe.node(ft));
    }), e.forEach(fe.edges(), function(ft) {
      var yt = fe.edge(ft);
      e.has(yt, "x") && Je(yt);
    }), ve -= mt, Me -= dt, e.forEach(fe.nodes(), function(ft) {
      var yt = fe.node(ft);
      yt.x -= ve, yt.y -= Me;
    }), e.forEach(fe.edges(), function(ft) {
      var yt = fe.edge(ft);
      e.forEach(yt.points, function(ht) {
        ht.x -= ve, ht.y -= Me;
      }), e.has(yt, "x") && (yt.x -= ve), e.has(yt, "y") && (yt.y -= Me);
    }), Re.width = Se - ve + mt, Re.height = Ie - Me + dt;
  }
  function oe(fe) {
    e.forEach(fe.edges(), function(ve) {
      var Se = fe.edge(ve), Me = fe.node(ve.v), Ie = fe.node(ve.w), Re, mt;
      Se.points ? (Re = Se.points[0], mt = Se.points[Se.points.length - 1]) : (Se.points = [], Re = Ie, mt = Me), Se.points.unshift(x.intersectRect(Me, Re)), Se.points.push(x.intersectRect(Ie, mt));
    });
  }
  function X(fe) {
    e.forEach(fe.edges(), function(ve) {
      var Se = fe.edge(ve);
      if (e.has(Se, "x"))
        switch ((Se.labelpos === "l" || Se.labelpos === "r") && (Se.width -= Se.labeloffset), Se.labelpos) {
          case "l":
            Se.x -= Se.width / 2 + Se.labeloffset;
            break;
          case "r":
            Se.x += Se.width / 2 + Se.labeloffset;
            break;
        }
    });
  }
  function ce(fe) {
    e.forEach(fe.edges(), function(ve) {
      var Se = fe.edge(ve);
      Se.reversed && Se.points.reverse();
    });
  }
  function pe(fe) {
    e.forEach(fe.nodes(), function(ve) {
      if (fe.children(ve).length) {
        var Se = fe.node(ve), Me = fe.node(Se.borderTop), Ie = fe.node(Se.borderBottom), Re = fe.node(e.last(Se.borderLeft)), mt = fe.node(e.last(Se.borderRight));
        Se.width = Math.abs(mt.x - Re.x), Se.height = Math.abs(Ie.y - Me.y), Se.x = Re.x + Se.width / 2, Se.y = Me.y + Se.height / 2;
      }
    }), e.forEach(fe.nodes(), function(ve) {
      fe.node(ve).dummy === "border" && fe.removeNode(ve);
    });
  }
  function de(fe) {
    e.forEach(fe.edges(), function(ve) {
      if (ve.v === ve.w) {
        var Se = fe.node(ve.v);
        Se.selfEdges || (Se.selfEdges = []), Se.selfEdges.push({ e: ve, label: fe.edge(ve) }), fe.removeEdge(ve);
      }
    });
  }
  function H(fe) {
    var ve = x.buildLayerMatrix(fe);
    e.forEach(ve, function(Se) {
      var Me = 0;
      e.forEach(Se, function(Ie, Re) {
        var mt = fe.node(Ie);
        mt.order = Re + Me, e.forEach(mt.selfEdges, function(dt) {
          x.addDummyNode(fe, "selfedge", {
            width: dt.label.width,
            height: dt.label.height,
            rank: mt.rank,
            order: Re + ++Me,
            e: dt.e,
            label: dt.label
          }, "_se");
        }), delete mt.selfEdges;
      });
    });
  }
  function J(fe) {
    e.forEach(fe.nodes(), function(ve) {
      var Se = fe.node(ve);
      if (Se.dummy === "selfedge") {
        var Me = fe.node(Se.e.v), Ie = Me.x + Me.width / 2, Re = Me.y, mt = Se.x - Ie, dt = Me.height / 2;
        fe.setEdge(Se.e, Se.label), fe.removeNode(ve), Se.label.points = [
          { x: Ie + 2 * mt / 3, y: Re - dt },
          { x: Ie + 5 * mt / 6, y: Re - dt },
          { x: Ie + mt, y: Re },
          { x: Ie + 5 * mt / 6, y: Re + dt },
          { x: Ie + 2 * mt / 3, y: Re + dt }
        ], Se.label.x = Se.x, Se.label.y = Se.y;
      }
    });
  }
  function ge(fe, ve) {
    return e.mapValues(e.pick(fe, ve), Number);
  }
  function Q(fe) {
    var ve = {};
    return e.forEach(fe, function(Se, Me) {
      ve[Me.toLowerCase()] = Se;
    }), ve;
  }
  return n3;
}
var r3, az;
function u2e() {
  if (az) return r3;
  az = 1;
  var e = /* @__PURE__ */ wr(), t = /* @__PURE__ */ ha(), n = il().Graph;
  r3 = {
    debugOrdering: r
  };
  function r(i) {
    var s = t.buildLayerMatrix(i), a = new n({ compound: !0, multigraph: !0 }).setGraph({});
    return e.forEach(i.nodes(), function(u) {
      a.setNode(u, { label: u }), a.setParent(u, "layer" + i.node(u).rank);
    }), e.forEach(i.edges(), function(u) {
      a.setEdge(u.v, u.w, {}, u.name);
    }), e.forEach(s, function(u, d) {
      var f = "layer" + d;
      a.setNode(f, { rank: "same" }), e.reduce(u, function(h, m) {
        return a.setEdge(h, m, { style: "invis" }), m;
      });
    }), a;
  }
  return r3;
}
var i3, oz;
function c2e() {
  return oz || (oz = 1, i3 = "0.8.5"), i3;
}
var s3, lz;
function d2e() {
  return lz || (lz = 1, s3 = {
    graphlib: /* @__PURE__ */ il(),
    layout: /* @__PURE__ */ l2e(),
    debug: /* @__PURE__ */ u2e(),
    util: {
      time: ha().time,
      notime: ha().notime
    },
    version: /* @__PURE__ */ c2e()
  }), s3;
}
var f2e = /* @__PURE__ */ d2e();
const uz = /* @__PURE__ */ jd(f2e);
function h2e(e, t, n = "TB") {
  const r = new uz.graphlib.Graph();
  r.setDefaultEdgeLabel(() => ({}));
  const i = n === "LR";
  return r.setGraph({
    rankdir: n,
    nodesep: 50,
    // 
    ranksep: 80,
    // 
    marginx: 20,
    marginy: 20
  }), e.forEach((a) => {
    const u = a.type === "event" ? 250 : 150, d = a.type === "event" ? 100 : 60;
    r.setNode(a.id, { width: u, height: d });
  }), t.forEach((a) => {
    r.setEdge(a.source, a.target);
  }), uz.layout(r), { nodes: e.map((a) => {
    const u = r.node(a.id);
    if (!u) return a;
    const d = a.type === "event" ? 250 : 150, f = a.type === "event" ? 100 : 60;
    return {
      ...a,
      targetPosition: i ? wt.Left : wt.Top,
      sourcePosition: i ? wt.Right : wt.Bottom,
      position: {
        x: u.x - d / 2,
        y: u.y - f / 2
      }
    };
  }), edges: t };
}
const p2e = ({ data: e }) => {
  var n;
  const t = hn((r) => r.transform[2]);
  return t < 0.15 ? /* @__PURE__ */ c.jsxs("div", { style: { width: 32, height: 32, borderRadius: "50%", backgroundColor: "#e07850", border: "2px solid #e07850", display: "flex", alignItems: "center", justifyContent: "center" }, children: [
    /* @__PURE__ */ c.jsx(as, { type: "target", position: wt.Top, style: { backgroundColor: "#e07850" } }),
    /* @__PURE__ */ c.jsx(as, { type: "source", position: wt.Bottom, style: { backgroundColor: "#e07850" } })
  ] }) : t > 1 ? /* @__PURE__ */ c.jsxs("div", { className: "w-[280px] p-3 rounded-lg border border-border bg-card shadow-md", children: [
    /* @__PURE__ */ c.jsx(as, { type: "target", position: wt.Top, className: "!bg-primary" }),
    /* @__PURE__ */ c.jsx("div", { className: "text-xs text-muted-foreground mb-1", children: e.time_anchor || "" }),
    /* @__PURE__ */ c.jsx("div", { className: "text-sm font-medium text-foreground mb-2 line-clamp-3", children: e.summary }),
    /* @__PURE__ */ c.jsx("div", { className: "flex flex-wrap gap-1", children: (n = e.roles) == null ? void 0 : n.map((r, i) => /* @__PURE__ */ c.jsx("span", { className: "px-1.5 py-0.5 text-xs bg-primary/10 text-primary rounded", children: r }, i)) }),
    /* @__PURE__ */ c.jsx(as, { type: "source", position: wt.Bottom, className: "!bg-primary" })
  ] }) : /* @__PURE__ */ c.jsxs("div", { style: { width: 220, padding: 8, borderRadius: 8, border: "1px solid #444", backgroundColor: "#2a2a2a", boxShadow: "0 1px 3px rgba(0,0,0,0.3)" }, children: [
    /* @__PURE__ */ c.jsx(as, { type: "target", position: wt.Top, style: { backgroundColor: "#e07850" } }),
    /* @__PURE__ */ c.jsx("div", { style: { fontSize: 11, color: "#888", marginBottom: 4, overflow: "hidden", textOverflow: "ellipsis", whiteSpace: "nowrap" }, children: e.time_anchor || "" }),
    /* @__PURE__ */ c.jsx("div", { style: { fontSize: 13, color: "#eee", display: "-webkit-box", WebkitLineClamp: 2, WebkitBoxOrient: "vertical", overflow: "hidden" }, children: e.label }),
    /* @__PURE__ */ c.jsx(as, { type: "source", position: wt.Bottom, style: { backgroundColor: "#e07850" } })
  ] });
}, m2e = ({ data: e }) => {
  const t = hn((n) => n.transform[2]);
  return t < 0.15 ? /* @__PURE__ */ c.jsxs("div", { style: { width: 24, height: 24, borderRadius: "50%", backgroundColor: "#555", border: "1px solid #666", display: "flex", alignItems: "center", justifyContent: "center" }, children: [
    /* @__PURE__ */ c.jsx(as, { type: "target", position: wt.Top, style: { backgroundColor: "#888" } }),
    /* @__PURE__ */ c.jsx(as, { type: "source", position: wt.Bottom, style: { backgroundColor: "#888" } })
  ] }) : t > 1 ? /* @__PURE__ */ c.jsxs("div", { className: "w-[160px] p-2 rounded-lg border border-border bg-muted/50", children: [
    /* @__PURE__ */ c.jsx(as, { type: "target", position: wt.Top, className: "!bg-muted-foreground" }),
    /* @__PURE__ */ c.jsx("div", { className: "text-xs text-muted-foreground uppercase", children: e.type }),
    /* @__PURE__ */ c.jsx("div", { className: "text-sm font-medium text-foreground", children: e.label }),
    /* @__PURE__ */ c.jsx("div", { className: "text-xs text-muted-foreground mt-1 line-clamp-2", children: e.description }),
    /* @__PURE__ */ c.jsx(as, { type: "source", position: wt.Bottom, className: "!bg-muted-foreground" })
  ] }) : /* @__PURE__ */ c.jsxs("div", { style: { width: 120, padding: 6, borderRadius: 6, border: "1px solid #555", backgroundColor: "#333" }, children: [
    /* @__PURE__ */ c.jsx(as, { type: "target", position: wt.Top, style: { backgroundColor: "#888" } }),
    /* @__PURE__ */ c.jsx("div", { style: { fontSize: 12, color: "#ddd", overflow: "hidden", textOverflow: "ellipsis", whiteSpace: "nowrap" }, children: e.label }),
    /* @__PURE__ */ c.jsx(as, { type: "source", position: wt.Bottom, style: { backgroundColor: "#888" } })
  ] });
}, g2e = {
  event: p2e,
  entity: m2e
}, y2e = ({ events: e, entities: t }) => {
  const [n, r, i] = wve([]), [s, a, u] = _ve([]), [d, f] = I.useState(!1), h = I.useRef(null), m = I.useCallback(() => {
    const b = [], w = [];
    return e.forEach((S, C) => {
      var T, R;
      b.push({
        id: S.id,
        type: "event",
        position: { x: 0, y: C * 120 },
        data: {
          label: S.summary.substring(0, 50) + (S.summary.length > 50 ? "..." : ""),
          summary: S.summary,
          time_anchor: (T = S.structured_kv) == null ? void 0 : T.time_anchor,
          roles: (R = S.structured_kv) == null ? void 0 : R.role,
          significance: S.significance_score
        }
      }), C > 0 && w.push({
        id: `e-${e[C - 1].id}-${S.id}`,
        source: e[C - 1].id,
        target: S.id,
        type: "smoothstep",
        animated: !1,
        style: { stroke: "var(--primary)", strokeWidth: 2 },
        markerEnd: { type: Fy.ArrowClosed, color: "var(--primary)" }
      });
    }), t.forEach((S, C) => {
      b.push({
        id: S.id,
        type: "entity",
        position: { x: 300 + C % 3 * 100, y: Math.floor(C / 3) * 80 },
        data: {
          label: S.name,
          type: S.type,
          description: S.description,
          profile: S.profile
        }
      });
    }), t.forEach((S) => {
      var T;
      const C = (T = S.profile) == null ? void 0 : T.relations;
      C && Array.isArray(C) && C.forEach((R) => {
        const N = t.find((M) => M.name === R.target);
        N && w.push({
          id: `rel-${S.id}-${N.id}`,
          source: S.id,
          target: N.id,
          type: "smoothstep",
          animated: !1,
          label: R.type,
          style: { stroke: "#888", strokeWidth: 1 },
          labelStyle: { fontSize: 10, fill: "#aaa" }
        });
      });
    }), e.forEach((S) => {
      var R;
      const C = ((R = S.structured_kv) == null ? void 0 : R.role) || [];
      t.filter(
        (N) => {
          var M;
          return C.includes(N.name) || ((M = N.aliases) == null ? void 0 : M.some((P) => C.includes(P)));
        }
      ).forEach((N) => {
        w.push({
          id: `co-${N.id}-${S.id}`,
          source: N.id,
          target: S.id,
          type: "smoothstep",
          animated: !1,
          style: { stroke: "var(--muted-foreground)", strokeWidth: 1, strokeDasharray: "4 2" }
        });
      });
    }), { nodes: b, edges: w };
  }, [e, t]), x = I.useCallback(() => {
    f(!0);
    const { nodes: b, edges: w } = m(), { nodes: S, edges: C } = h2e(b, w, "TB");
    r(S), a(C), f(!1), setTimeout(() => {
      var T;
      (T = h.current) == null || T.fitView({ padding: 0.2 });
    }, 50);
  }, [m, r, a]);
  return I.useEffect(() => {
    (e.length > 0 || t.length > 0) && x();
  }, [e.length, t.length]), e.length === 0 && t.length === 0 ? /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col items-center justify-center h-full text-muted-foreground gap-4", children: [
    /* @__PURE__ */ c.jsx(UH, { size: 48, className: "opacity-20" }),
    /* @__PURE__ */ c.jsx("p", { className: "text-sm", children: "" }),
    /* @__PURE__ */ c.jsx("p", { className: "text-xs", children: "" })
  ] }) : /* @__PURE__ */ c.jsxs("div", { style: { position: "relative", width: "100%", height: "400px" }, children: [
    /* @__PURE__ */ c.jsx("div", { className: "absolute top-2 left-2 z-10 flex gap-2", children: /* @__PURE__ */ c.jsxs(
      "button",
      {
        onClick: x,
        disabled: d,
        className: "flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-md bg-card border border-border text-foreground hover:bg-accent transition-colors disabled:opacity-50",
        children: [
          /* @__PURE__ */ c.jsx(fr, { size: 12, className: d ? "animate-spin" : "" }),
          ""
        ]
      }
    ) }),
    /* @__PURE__ */ c.jsxs(
      bve,
      {
        nodes: n,
        edges: s,
        onNodesChange: i,
        onEdgesChange: u,
        onInit: (b) => {
          h.current = b;
        },
        nodeTypes: g2e,
        fitView: !0,
        minZoom: 0.1,
        maxZoom: 2,
        colorMode: "dark",
        defaultEdgeOptions: {
          type: "smoothstep"
        },
        proOptions: { hideAttribution: !0 },
        children: [
          /* @__PURE__ */ c.jsx(Tve, { color: "#333", gap: 20 }),
          /* @__PURE__ */ c.jsx(Dve, { className: "!bg-card !border-border" }),
          /* @__PURE__ */ c.jsx(
            Kve,
            {
              nodeColor: (b) => b.type === "event" ? "#e07850" : "#888",
              className: "!bg-card !border-border"
            }
          )
        ]
      }
    )
  ] });
}, cz = 768, x2e = [
  { id: "list", label: "", icon: /* @__PURE__ */ c.jsx(WH, { size: 14 }) },
  { id: "entities", label: "", icon: /* @__PURE__ */ c.jsx(Az, { size: 14 }) },
  // Add Entity Tab
  { id: "graph", label: "", icon: /* @__PURE__ */ c.jsx(AH, { size: 14 }) }
], v2e = () => {
  const [e, t] = I.useState([]), [n, r] = I.useState(null), [i, s] = I.useState(/* @__PURE__ */ new Set()), [a, u] = I.useState(""), [d, f] = I.useState(!1), [h, m] = I.useState(/* @__PURE__ */ new Set()), [x, b] = I.useState("asc"), [w, S] = I.useState(!1), [C, T] = I.useState(""), [R, N] = I.useState(!0), [M, P] = I.useState(window.innerWidth < cz), [D, q] = I.useState(!1), [Y, te] = I.useState("list"), [V, $] = I.useState([]), [G, le] = I.useState(/* @__PURE__ */ new Map()), Z = G.size > 0, [oe, X] = I.useState(!1), ce = vi.getState(), pe = I.useRef(null);
  I.useEffect(() => {
    const Le = () => {
      P(window.innerWidth < cz);
    };
    return window.addEventListener("resize", Le), () => window.removeEventListener("resize", Le);
  }, []);
  const de = async () => {
    N(!0);
    try {
      const Le = await ce.getAllEvents();
      t(Le.sort((gt, Dt) => gt.timestamp - Dt.timestamp));
      const Ye = pd.getShortTermSnapshot();
      m(new Set(Ye.map((gt) => gt.id)));
    } catch (Le) {
      console.error("[MemoryStream] Failed to load events:", Le);
    } finally {
      N(!1);
    }
  }, H = async () => {
    try {
      const Le = await ce.getAllEntities();
      $(Le);
    } catch (Le) {
      console.error("[MemoryStream] Failed to load entities:", Le);
    }
  };
  I.useEffect(() => {
    de(), H();
  }, []);
  const J = I.useMemo(() => {
    let Le = e;
    if (a.trim()) {
      const Ye = a.toLowerCase();
      Le = Le.filter(
        (gt) => {
          var Dt, pn;
          return gt.summary.toLowerCase().includes(Ye) || ((Dt = gt.structured_kv.event) == null ? void 0 : Dt.toLowerCase().includes(Ye)) || ((pn = gt.structured_kv.role) == null ? void 0 : pn.some((Ht) => Ht.toLowerCase().includes(Ye)));
        }
      );
    }
    return d && (Le = Le.filter((Ye) => h.has(Ye.id))), [...Le].sort((Ye, gt) => x === "asc" ? Ye.timestamp - gt.timestamp : gt.timestamp - Ye.timestamp);
  }, [e, a, d, h, x]), ge = I.useMemo(() => {
    if (!a.trim()) return V;
    const Le = a.toLowerCase();
    return V.filter(
      (Ye) => {
        var gt;
        return Ye.name.toLowerCase().includes(Le) || Ye.description.toLowerCase().includes(Le) || ((gt = Ye.aliases) == null ? void 0 : gt.some((Dt) => Dt.toLowerCase().includes(Le)));
      }
    );
  }, [V, a]), Q = I.useMemo(() => {
    const Le = e.find((gt) => gt.id === n);
    if (!Le) return null;
    const Ye = G.get(Le.id);
    return Ye ? { ...Le, ...Ye } : Le;
  }, [e, n, G]), fe = I.useMemo(() => V.find((Le) => Le.id === n) || null, [V, n]), ve = (Le) => {
    r(Le), M && q(!0);
  }, Se = (Le, Ye) => {
    const gt = new Set(i);
    Ye ? gt.add(Le) : gt.delete(Le), s(gt);
  }, Me = I.useCallback((Le, Ye) => {
    le((gt) => {
      const Dt = new Map(gt), pn = Dt.get(Le) || {};
      return Dt.set(Le, { ...pn, ...Ye }), Dt;
    }), t((gt) => gt.map(
      (Dt) => Dt.id === Le ? { ...Dt, ...Ye } : Dt
    ));
  }, []), Ie = I.useCallback(async (Le, Ye) => {
    try {
      await ce.updateEntity(Le, Ye), $((gt) => gt.map(
        (Dt) => Dt.id === Le ? { ...Dt, ...Ye } : Dt
      )), console.log("[MemoryStream] Entity updated:", Le);
    } catch (gt) {
      console.error("[MemoryStream] Failed to update entity:", gt), alert("");
    }
  }, []), Re = async () => {
    if (G.size !== 0)
      try {
        const Le = Array.from(G.entries()).map(
          ([Ye, gt]) => ce.updateEvent(Ye, gt)
        );
        await Promise.all(Le), console.log(`[MemoryStream] Batch saved ${G.size} events`), le(/* @__PURE__ */ new Map());
      } catch (Le) {
        console.error("[MemoryStream] Batch save failed:", Le);
      }
  }, mt = async () => {
    const Le = it.get("apiSettings"), Ye = Le == null ? void 0 : Le.vectorConfig;
    if (!Ye) {
      alert(" API ");
      return;
    }
    if (confirm("")) {
      X(!0);
      try {
        Vr.setConfig(Ye);
        const gt = Le == null ? void 0 : Le.embeddingConfig;
        gt != null && gt.concurrency && Vr.setConcurrency(gt.concurrency), await Vr.reembedAllEvents((Dt, pn, Ht) => {
          console.log(`[MemoryStream] Reembedding: ${Dt}/${pn}, errors: ${Ht}`);
        }), await de(), alert("");
      } catch (gt) {
        console.error("[MemoryStream] Reembed failed:", gt), alert(": " + (gt.message || ""));
      } finally {
        X(!1);
      }
    }
  }, dt = async (Le) => {
    Y === "entities" ? (await ce.deleteEntity(Le), $((Ye) => Ye.filter((gt) => gt.id !== Le))) : (await ce.deleteEvents([Le]), t((Ye) => Ye.filter((gt) => gt.id !== Le)), le((Ye) => {
      const gt = new Map(Ye);
      return gt.delete(Le), gt;
    })), r(null), q(!1);
  }, Je = async () => {
    if (i.size !== 0 && confirm(` ${i.size} `)) {
      if (Y === "entities") {
        const Le = Array.from(i);
        await ce.deleteEntities(Le), $((Ye) => Ye.filter((gt) => !i.has(gt.id)));
      } else
        await ce.deleteEvents(Array.from(i)), t((Le) => Le.filter((Ye) => !i.has(Ye.id))), le((Le) => {
          const Ye = new Map(Le);
          return i.forEach((gt) => Ye.delete(gt)), Ye;
        });
      s(/* @__PURE__ */ new Set());
    }
  }, ft = () => {
    q(!1), M && r(null);
  };
  if (M && D && Q && Y === "list")
    return /* @__PURE__ */ c.jsx(
      T5,
      {
        ref: pe,
        event: Q,
        isFullScreen: !0,
        onSave: Me,
        onDelete: dt,
        onClose: ft
      }
    );
  const ht = {
    list: { title: "", subtitle: "" },
    entities: { title: "", subtitle: "" },
    graph: { title: "", subtitle: "" }
  }[Y];
  return /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col h-full animate-in fade-in overflow-hidden", children: [
    /* @__PURE__ */ c.jsx(
      Gm,
      {
        breadcrumbs: [""],
        title: ht.title,
        subtitle: ht.subtitle
      }
    ),
    /* @__PURE__ */ c.jsx(Br, { className: "mb-6" }),
    /* @__PURE__ */ c.jsx(
      rx,
      {
        tabs: x2e,
        activeTab: Y,
        onChange: (Le) => {
          te(Le), r(null), s(/* @__PURE__ */ new Set());
        },
        actions: /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2", children: [
          Y === "list" && Z && /* @__PURE__ */ c.jsxs(
            "button",
            {
              className: "inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-primary hover:text-primary-foreground hover:bg-primary border border-primary/50 rounded transition-colors",
              onClick: Re,
              children: [
                /* @__PURE__ */ c.jsx(eh, { size: 12 }),
                " (",
                G.size,
                ")"
              ]
            }
          ),
          Y === "list" && /* @__PURE__ */ c.jsxs(
            "button",
            {
              onClick: mt,
              disabled: oe,
              className: "inline-flex items-center gap-1.5 px-2 py-1.5 text-xs text-muted-foreground hover:text-foreground rounded transition-colors disabled:opacity-50",
              title: "",
              children: [
                /* @__PURE__ */ c.jsx(kz, { size: 12, className: oe ? "animate-pulse" : "" }),
                oe ? "..." : ""
              ]
            }
          ),
          /* @__PURE__ */ c.jsx(
            "button",
            {
              onClick: () => {
                de(), H();
              },
              className: "p-1.5 rounded-md text-muted-foreground hover:text-foreground transition-colors",
              title: "",
              children: /* @__PURE__ */ c.jsx(fr, { size: 14, className: R ? "animate-spin" : "" })
            }
          ),
          i.size > 0 && /* @__PURE__ */ c.jsxs(
            "button",
            {
              onClick: Je,
              className: "flex items-center gap-1 px-2 py-1 text-xs text-destructive hover:bg-destructive/10 rounded-md",
              children: [
                /* @__PURE__ */ c.jsx(pa, { size: 12 }),
                " (",
                i.size,
                ")"
              ]
            }
          ),
          /* @__PURE__ */ c.jsx("div", { className: "w-[1px] h-4 bg-border mx-1" }),
          Y === "list" && /* @__PURE__ */ c.jsx(
            "button",
            {
              onClick: () => b((Le) => Le === "asc" ? "desc" : "asc"),
              className: "p-1.5 rounded-md text-muted-foreground hover:text-foreground transition-colors",
              title: x === "asc" ? ":  -> " : ":  -> ",
              children: /* @__PURE__ */ c.jsx(UU, { size: 14, className: x === "desc" ? "rotate-180" : "" })
            }
          ),
          Y === "list" && /* @__PURE__ */ c.jsx(
            "button",
            {
              onClick: () => f((Le) => !Le),
              className: `p-1.5 rounded-md transition-colors ${d ? "text-primary bg-primary/10" : "text-muted-foreground hover:text-foreground"}`,
              title: d ? "" : " (Recall)",
              children: /* @__PURE__ */ c.jsx(wz, { size: 14 })
            }
          ),
          /* @__PURE__ */ c.jsx(
            "button",
            {
              onClick: () => {
                T(Ds.getSummaries() || "( - )"), S(!0);
              },
              className: "p-1.5 rounded-md text-muted-foreground hover:text-foreground transition-colors",
              title: "",
              children: /* @__PURE__ */ c.jsx(ru, { size: 14 })
            }
          )
        ] })
      }
    ),
    Y === "list" && /* @__PURE__ */ c.jsx(
      "div",
      {
        className: "flex flex-col overflow-hidden",
        style: {
          height: "calc(100vh - 100px)",
          minHeight: "300px"
        },
        children: /* @__PURE__ */ c.jsx(
          mm,
          {
            mobileDetailOpen: !1,
            mobileDetailTitle: "",
            header: /* @__PURE__ */ c.jsxs("div", { className: "relative mb-4 shrink-0", children: [
              /* @__PURE__ */ c.jsx(Ai, { size: 14, className: "absolute left-0 top-1/2 -translate-y-1/2 text-muted-foreground" }),
              /* @__PURE__ */ c.jsx(
                "input",
                {
                  type: "text",
                  value: a,
                  onChange: (Le) => u(Le.target.value),
                  placeholder: "...",
                  style: {
                    background: "transparent",
                    border: "none",
                    borderBottom: "1px solid var(--border)",
                    borderRadius: 0,
                    outline: "none",
                    padding: "8px 0 8px 24px",
                    fontSize: "14px",
                    width: "100%",
                    color: "var(--foreground)"
                  },
                  className: "placeholder:text-muted-foreground/40 focus:border-primary transition-colors"
                }
              )
            ] }),
            list: R ? /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col items-center justify-center h-48 text-muted-foreground gap-2", children: [
              /* @__PURE__ */ c.jsx(fr, { size: 24, className: "animate-spin" }),
              /* @__PURE__ */ c.jsx("p", { className: "text-sm font-light", children: "..." })
            ] }) : J.length === 0 ? /* @__PURE__ */ c.jsx(
              th,
              {
                icon: xh,
                title: a ? "" : "",
                description: a ? void 0 : ""
              }
            ) : /* @__PURE__ */ c.jsx("div", { className: M ? "" : "space-y-1 pb-4", children: J.map((Le) => /* @__PURE__ */ c.jsx(
              Whe,
              {
                event: Le,
                isSelected: Le.id === n,
                isCompact: M,
                isActive: h.has(Le.id),
                checked: i.has(Le.id),
                hasChanges: G.has(Le.id),
                onSelect: () => ve(Le.id),
                onCheck: (Ye) => Se(Le.id, Ye)
              },
              Le.id
            )) }),
            detail: /* @__PURE__ */ c.jsx(
              T5,
              {
                ref: pe,
                event: Q,
                isFullScreen: !1,
                onSave: Me,
                onDelete: dt,
                onClose: () => r(null)
              }
            )
          }
        )
      }
    ),
    Y === "entities" && /* @__PURE__ */ c.jsx(
      "div",
      {
        className: "flex flex-col overflow-hidden",
        style: {
          height: "calc(100vh - 100px)",
          minHeight: "300px"
        },
        children: /* @__PURE__ */ c.jsx(
          mm,
          {
            mobileDetailOpen: !1,
            mobileDetailTitle: "",
            header: /* @__PURE__ */ c.jsxs("div", { className: "relative mb-4 shrink-0", children: [
              /* @__PURE__ */ c.jsx(Ai, { size: 14, className: "absolute left-0 top-1/2 -translate-y-1/2 text-muted-foreground" }),
              /* @__PURE__ */ c.jsx(
                "input",
                {
                  type: "text",
                  value: a,
                  onChange: (Le) => u(Le.target.value),
                  placeholder: "...",
                  style: {
                    background: "transparent",
                    border: "none",
                    borderBottom: "1px solid var(--border)",
                    borderRadius: 0,
                    outline: "none",
                    padding: "8px 0 8px 24px",
                    fontSize: "14px",
                    width: "100%",
                    color: "var(--foreground)"
                  },
                  className: "placeholder:text-muted-foreground/40 focus:border-primary transition-colors"
                }
              )
            ] }),
            list: R ? /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col items-center justify-center h-48 text-muted-foreground gap-2", children: [
              /* @__PURE__ */ c.jsx(fr, { size: 24, className: "animate-spin" }),
              /* @__PURE__ */ c.jsx("p", { className: "text-sm font-light", children: "..." })
            ] }) : ge.length === 0 ? /* @__PURE__ */ c.jsx(
              th,
              {
                icon: Az,
                title: a ? "" : "",
                description: a ? void 0 : ""
              }
            ) : /* @__PURE__ */ c.jsx("div", { className: M ? "" : "space-y-1 pb-4", children: ge.map((Le) => /* @__PURE__ */ c.jsx(
              Zhe,
              {
                entity: Le,
                isSelected: Le.id === n,
                isCompact: M,
                checked: i.has(Le.id),
                onSelect: () => ve(Le.id),
                onCheck: (Ye) => Se(Le.id, Ye)
              },
              Le.id
            )) }),
            detail: /* @__PURE__ */ c.jsx(
              N$,
              {
                entity: fe,
                isFullScreen: !1,
                onSave: Ie,
                onDelete: dt,
                onClose: () => r(null)
              }
            )
          }
        )
      }
    ),
    Y === "graph" && /* @__PURE__ */ c.jsx(
      "div",
      {
        className: "flex-1 min-h-0",
        style: {
          height: "calc(100vh - 100px)",
          minHeight: "400px"
        },
        children: /* @__PURE__ */ c.jsx(y2e, { events: e, entities: V })
      }
    ),
    w && /* @__PURE__ */ c.jsx("div", { className: "fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4 animate-in fade-in duration-200", children: /* @__PURE__ */ c.jsxs("div", { className: "w-full max-w-2xl bg-background border border-border rounded-lg shadow-xl flex flex-col max-h-[80vh]", children: [
      /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between px-4 py-3 border-b border-border", children: [
        /* @__PURE__ */ c.jsxs("h3", { className: "text-sm font-medium flex items-center gap-2", children: [
          /* @__PURE__ */ c.jsx(ru, { size: 16, className: "text-primary" }),
          " (Active Injection)"
        ] }),
        /* @__PURE__ */ c.jsx(
          "button",
          {
            onClick: () => S(!1),
            className: "text-muted-foreground hover:text-foreground",
            children: ""
          }
        )
      ] }),
      /* @__PURE__ */ c.jsx("div", { className: "flex-1 overflow-auto p-4", children: /* @__PURE__ */ c.jsx("pre", { className: "text-xs font-mono whitespace-pre-wrap leading-relaxed text-muted-foreground bg-muted/30 p-4 rounded border border-border/50", children: C }) }),
      /* @__PURE__ */ c.jsxs("div", { className: "px-4 py-2 border-t border-border bg-muted/20 text-[10px] text-muted-foreground", children: [
        "* ",
        "{{engramSummaries}}",
        " "
      ] })
    ] }) })
  ] });
}, b2e = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  MemoryStream: v2e
}, Symbol.toStringTag, { value: "Module" })), w2e = ({ links: e, onNavigate: t, className: n = "" }) => e.length === 0 ? null : /* @__PURE__ */ c.jsx("div", { className: `hidden sm:flex items-center gap-4 ${n}`, children: e.map((r) => {
  const i = r.icon || SH;
  return /* @__PURE__ */ c.jsxs(
    "button",
    {
      className: "group inline-flex items-center gap-1.5 text-xs text-muted-foreground hover:text-foreground transition-colors duration-[var(--duration-fast)]",
      onClick: () => t(r.linkTo),
      title: r.label,
      children: [
        /* @__PURE__ */ c.jsx(i, { size: 12, className: "transition-transform duration-[var(--duration-fast)] group-hover:scale-110" }),
        /* @__PURE__ */ c.jsx("span", { children: r.label })
      ]
    },
    r.id
  );
}) }), Bb = {
  keepRecentCount: 3,
  previewEnabled: !0
};
class _2e {
  constructor(t) {
    lt(this, "config");
    lt(this, "isTrimming", !1);
    this.config = { ...Bb, ...t };
  }
  /**
   * 
   */
  updateConfig(t) {
    this.config = { ...this.config, ...t };
  }
  /**
   * 
   */
  async canTrim() {
    const n = await vi.getState().getAllEvents(), r = Math.max(0, n.length - this.config.keepRecentCount);
    return {
      canTrim: r >= 2,
      //  2 
      eventCount: n.length,
      pendingCount: r
    };
  }
  /**
   * 
   *  1 
   */
  async trim(t = !1) {
    var n;
    if (this.isTrimming)
      return ee.warn(Fe.MEMORY_TRIM, ""), null;
    this.isTrimming = !0;
    try {
      const { WorkflowEngine: r } = await Promise.resolve().then(() => cw), { createTrimmerWorkflow: i } = await Promise.resolve().then(() => X2e), s = await r.run(i(), {
        trigger: t ? "manual" : "auto",
        config: {
          keepRecentCount: this.config.keepRecentCount,
          previewEnabled: this.config.previewEnabled,
          templateId: "builtin_trim",
          // Hardcoded for now, matches BuildPrompt category mapping potentially
          logType: "trimming"
        }
      });
      return (n = s.data) != null && n.skipTrimming ? null : s.output;
    } catch (r) {
      const i = r instanceof Error ? r.message : String(r);
      return i === "UserCancelled" ? (ee.info(Fe.MEMORY_TRIM, ""), null) : (ee.error(Fe.MEMORY_TRIM, "", { error: i }), t && xn.error(`: ${i}`, "Engram "), null);
    } finally {
      this.isTrimming = !1;
    }
  }
  /**
   *  ()
   */
  formatEventsForTrim(t) {
    return t.map((n) => {
      const r = n.structured_kv, i = Array.isArray(r.location) ? r.location.join(", ") : r.location;
      return `${n.summary}
Role: [${r.role.join(", ")}]
Loc: [${i}]
Event: ${r.event}
Logic: [${r.logic.join(", ")}]
Causality: ${r.causality}
Significance: ${n.significance_score}`;
    }).join(`

---

`);
  }
  /**
   * 
   */
  mergeArrays(t) {
    const n = /* @__PURE__ */ new Set();
    for (const r of t)
      for (const i of r)
        n.add(i);
    return Array.from(n);
  }
  /**
   * 
   */
  getConfig() {
    return { ...this.config };
  }
  /**
   *  (UI )
   */
  async getStatus() {
    var S;
    const { useMemoryStore: t } = await Promise.resolve().then(() => ZI), n = t.getState(), { totalTokens: r, eventCount: i } = await n.countEventTokens();
    let s = !1, a = 0, u = 0;
    const f = ((S = it.getSummarizerSettings()) == null ? void 0 : S.trimConfig) || this.config, h = f.trigger || "token", m = f.tokenLimit || 10240, x = f.countLimit || 5;
    h === "token" ? (a = r, u = m) : (a = i, u = x), s = a >= u;
    const b = f.keepRecentCount || 3, w = Math.max(0, i - b);
    return {
      triggered: s,
      triggerType: h,
      currentValue: a,
      threshold: u,
      pendingEntryCount: w,
      isTrimming: this.isTrimming
    };
  }
}
const Q1 = new _2e(), J1 = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  DEFAULT_TRIM_CONFIG: Bb,
  eventTrimmer: Q1
}, Symbol.toStringTag, { value: "Module" })), S2e = {
  autoEnabled: !0,
  floorInterval: 10,
  bufferSize: 3,
  autoHide: !1
};
function E2e() {
  const [e, t] = I.useState(S2e), [n, r] = I.useState(Bb), [i, s] = I.useState(!1);
  I.useEffect(() => {
    a();
  }, []);
  const a = async () => {
    var h;
    try {
      const { summarizerService: m } = await Promise.resolve().then(() => Vo), x = m.getConfig();
      t({
        autoEnabled: x.enabled,
        floorInterval: x.floorInterval,
        bufferSize: x.bufferSize || 3,
        autoHide: x.autoHide || !1
      });
      const b = (h = it.getSummarizerSettings()) == null ? void 0 : h.trimConfig;
      b && r({ ...Bb, ...b });
    } catch (m) {
      console.error("Failed to load summarizer config:", m);
    }
  }, u = I.useCallback((h) => {
    t(h), s(!0);
  }, []), d = I.useCallback((h) => {
    r(h), s(!0);
  }, []), f = I.useCallback(async () => {
    try {
      const { summarizerService: h } = await Promise.resolve().then(() => Vo);
      h.updateConfig({
        enabled: e.autoEnabled,
        floorInterval: e.floorInterval,
        bufferSize: e.bufferSize,
        autoHide: e.autoHide
      }), it.setSummarizerSettings({ trimConfig: n });
      const { eventTrimmer: m } = await Promise.resolve().then(() => J1);
      m.updateConfig({ enabled: n.enabled }), s(!1);
    } catch (h) {
      console.error("Failed to save summarizer config:", h);
    }
  }, [e, n]);
  return {
    summarizerSettings: e,
    trimConfig: n,
    updateSummarizerSettings: u,
    updateTrimConfig: d,
    saveSummarizerConfig: f,
    hasChanges: i
  };
}
const C2e = [
  { id: "token", label: "Token ", icon: tH },
  { id: "count", label: "", icon: DH }
], k2e = ({
  summarizerSettings: e,
  trimConfig: t,
  onSummarizerSettingsChange: n,
  onTrimConfigChange: r
}) => {
  const [i, s] = I.useState(null), [a, u] = I.useState(!1), [d, f] = I.useState(!1), [h, m] = I.useState(null), [x, b] = I.useState(0), [w, S] = I.useState(0);
  I.useEffect(() => {
    C();
  }, []);
  const C = async () => {
    try {
      const { summarizerService: $ } = await Promise.resolve().then(() => Vo);
      await $.initializeForCurrentChat();
      const G = $.getStatus();
      s(G);
      const { eventTrimmer: le } = await Promise.resolve().then(() => J1), Z = await le.getStatus();
      m(Z);
      const { useMemoryStore: oe } = await Promise.resolve().then(() => ZI), X = oe.getState(), { totalTokens: ce, activeEventCount: pe } = await X.countEventTokens();
      b(ce), S(pe);
    } catch ($) {
      console.error(" Summarizer :", $);
    }
  }, T = async () => {
    try {
      const { summarizerService: $ } = await Promise.resolve().then(() => Vo);
      $.start(), await C();
    } catch ($) {
      console.error(":", $);
    }
  }, R = async () => {
    try {
      const { summarizerService: $ } = await Promise.resolve().then(() => Vo);
      $.stop(), await C();
    } catch ($) {
      console.error(":", $);
    }
  }, N = async () => {
    u(!0);
    try {
      const { summarizerService: $ } = await Promise.resolve().then(() => Vo);
      await $.triggerSummary(!0), await C();
    } catch ($) {
      console.error(":", $);
    } finally {
      u(!1);
    }
  }, M = async () => {
    if (confirm("")) {
      u(!0);
      try {
        const { summarizerService: $ } = await Promise.resolve().then(() => Vo);
        await $.setLastSummarizedFloor(0), await C();
      } catch ($) {
        console.error(":", $);
      } finally {
        u(!1);
      }
    }
  }, P = ($) => {
    const G = { ...t, trigger: $ };
    r(G);
  }, D = ($, G) => {
    const le = { ...t, [$]: G };
    r(le);
  }, q = async () => {
    const $ = { ...t, enabled: !t.enabled };
    r($);
    const { eventTrimmer: G } = await Promise.resolve().then(() => J1);
    G.updateConfig({ enabled: $.enabled });
  }, Y = async () => {
    f(!0);
    try {
      const { eventTrimmer: $ } = await Promise.resolve().then(() => J1);
      await $.trim(!0), await C();
    } catch ($) {
      console.error(":", $);
    } finally {
      f(!1);
    }
  }, V = (() => {
    switch (t.trigger) {
      case "token":
        return { value: t.tokenLimit ?? 10240, min: 1024, max: 1e5, step: 1024, label: "Token " };
      case "count":
        return { value: t.countLimit ?? 5, min: 2, max: 20, step: 1, label: "" };
      default:
        return { value: 10240, min: 1024, max: 1e5, step: 1024, label: "Token " };
    }
  })();
  return /* @__PURE__ */ c.jsxs("div", { className: "grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12", children: [
    /* @__PURE__ */ c.jsxs("section", { className: "space-y-8", children: [
      /* @__PURE__ */ c.jsxs("div", { children: [
        /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between mb-6", children: [
          /* @__PURE__ */ c.jsx("h2", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider", children: "" }),
          /* @__PURE__ */ c.jsx(
            "button",
            {
              className: "p-1 rounded text-muted-foreground hover:text-foreground transition-colors",
              onClick: C,
              title: "",
              children: /* @__PURE__ */ c.jsx(fr, { size: 14 })
            }
          )
        ] }),
        i ? /* @__PURE__ */ c.jsxs("div", { className: "space-y-6", children: [
          /* @__PURE__ */ c.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
            /* @__PURE__ */ c.jsxs("div", { children: [
              /* @__PURE__ */ c.jsx("span", { className: "text-xs text-muted-foreground block mb-1", children: "" }),
              /* @__PURE__ */ c.jsxs("div", { className: `flex items-center gap-2 text-lg font-medium ${i.running ? "text-green-500" : "text-muted-foreground"}`, children: [
                i.running ? /* @__PURE__ */ c.jsx(qb, { size: 18 }) : /* @__PURE__ */ c.jsx(_d, { size: 18 }),
                i.running ? "" : ""
              ] })
            ] }),
            /* @__PURE__ */ c.jsxs("div", { children: [
              /* @__PURE__ */ c.jsx("span", { className: "text-xs text-muted-foreground block mb-1", children: "" }),
              /* @__PURE__ */ c.jsx("div", { className: "text-3xl font-light text-amber-500 font-mono", children: i.pendingFloors })
            ] })
          ] }),
          /* @__PURE__ */ c.jsx(Br, { length: 100, spacing: "md" }),
          /* @__PURE__ */ c.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
            /* @__PURE__ */ c.jsxs("div", { children: [
              /* @__PURE__ */ c.jsx("span", { className: "text-[10px] text-muted-foreground/70 uppercase tracking-wider block mb-1", children: "" }),
              /* @__PURE__ */ c.jsx("div", { className: "text-xl font-mono text-foreground/80", children: i.currentFloor })
            ] }),
            /* @__PURE__ */ c.jsxs("div", { children: [
              /* @__PURE__ */ c.jsx("span", { className: "text-[10px] text-muted-foreground/70 uppercase tracking-wider block mb-1", children: " ()" }),
              /* @__PURE__ */ c.jsx("div", { className: "text-xl font-mono text-foreground/80", children: w })
            ] })
          ] }),
          /* @__PURE__ */ c.jsx(Br, { length: 30, spacing: "md" }),
          /* @__PURE__ */ c.jsxs("div", { children: [
            /* @__PURE__ */ c.jsx("span", { className: "text-[10px] text-muted-foreground/60 uppercase tracking-wider block mb-1", children: " Token (Engram)" }),
            /* @__PURE__ */ c.jsx("div", { className: "text-sm font-mono text-primary/80", children: x.toLocaleString() })
          ] })
        ] }) : /* @__PURE__ */ c.jsx("p", { className: "text-sm text-muted-foreground", children: "..." })
      ] }),
      /* @__PURE__ */ c.jsxs("div", { className: "flex gap-3", children: [
        i != null && i.running ? /* @__PURE__ */ c.jsxs(
          "button",
          {
            className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors",
            onClick: R,
            children: [
              /* @__PURE__ */ c.jsx(Ez, { size: 14 }),
              ""
            ]
          }
        ) : /* @__PURE__ */ c.jsxs(
          "button",
          {
            className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg hover:border-foreground/30 transition-colors",
            onClick: T,
            children: [
              /* @__PURE__ */ c.jsx(Sd, { size: 14 }),
              ""
            ]
          }
        ),
        /* @__PURE__ */ c.jsxs(
          "button",
          {
            className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors disabled:opacity-50",
            onClick: N,
            disabled: a || (i == null ? void 0 : i.isSummarizing),
            children: [
              /* @__PURE__ */ c.jsx(fr, { size: 14, className: a ? "animate-spin" : "" }),
              a ? "..." : ""
            ]
          }
        )
      ] }),
      /* @__PURE__ */ c.jsxs("div", { className: "pt-6 space-y-6", children: [
        /* @__PURE__ */ c.jsx(Br, { length: 100 }),
        /* @__PURE__ */ c.jsxs("div", { className: "grid grid-cols-2 gap-4", children: [
          /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between", children: [
            /* @__PURE__ */ c.jsx("span", { className: "text-sm text-foreground", children: "" }),
            /* @__PURE__ */ c.jsx(
              Zo,
              {
                label: "",
                checked: e.autoEnabled,
                onChange: async ($) => {
                  n({ ...e, autoEnabled: $ });
                  const { summarizerService: G } = await Promise.resolve().then(() => Vo);
                  G.updateConfig({ enabled: $ });
                }
              }
            )
          ] }),
          /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between", children: [
            /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col", children: [
              /* @__PURE__ */ c.jsx("span", { className: "text-sm text-foreground", children: "" }),
              /* @__PURE__ */ c.jsx("span", { className: "text-[10px] text-muted-foreground", children: "" })
            ] }),
            /* @__PURE__ */ c.jsx(
              Zo,
              {
                label: "",
                checked: e.autoHide,
                onChange: ($) => {
                  n({ ...e, autoHide: $ }), Promise.resolve().then(() => Vo).then(({ summarizerService: G }) => {
                    G.updateConfig({ autoHide: $ });
                  });
                }
              }
            )
          ] })
        ] }),
        e.autoEnabled && /* @__PURE__ */ c.jsx(c.Fragment, { children: /* @__PURE__ */ c.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
          /* @__PURE__ */ c.jsxs("div", { className: "space-y-3", children: [
            /* @__PURE__ */ c.jsxs("div", { className: "text-xs text-muted-foreground", children: [
              " ",
              /* @__PURE__ */ c.jsx("span", { className: "text-base font-medium text-foreground mx-0.5", children: e.floorInterval }),
              " "
            ] }),
            /* @__PURE__ */ c.jsxs("div", { className: "relative h-4 flex items-center group cursor-pointer", children: [
              /* @__PURE__ */ c.jsx("div", { className: "absolute inset-x-0 h-[1px]", style: { backgroundColor: "var(--border)" } }),
              /* @__PURE__ */ c.jsx(
                "div",
                {
                  className: "absolute top-1/2 -translate-y-1/2 w-2.5 h-2.5 bg-muted-foreground/80 rounded-full shadow-sm pointer-events-none transition-transform duration-75 ease-out group-hover:scale-125 group-hover:bg-foreground",
                  style: { left: `${(e.floorInterval - 5) / 95 * 100}%`, transform: "translate(-50%, -50%)" }
                }
              ),
              /* @__PURE__ */ c.jsx(
                "input",
                {
                  type: "range",
                  min: 5,
                  max: 100,
                  step: 5,
                  value: e.floorInterval,
                  onChange: async ($) => {
                    const G = Number($.target.value);
                    n({ ...e, floorInterval: G });
                    const { summarizerService: le } = await Promise.resolve().then(() => Vo);
                    le.updateConfig({ floorInterval: G });
                  },
                  className: "absolute inset-x-0 w-full h-full opacity-0 cursor-pointer z-10 m-0",
                  style: { appearance: "none", WebkitAppearance: "none" }
                }
              )
            ] })
          ] }),
          /* @__PURE__ */ c.jsxs("div", { className: "space-y-3", children: [
            /* @__PURE__ */ c.jsxs("div", { className: "text-xs text-muted-foreground", children: [
              " ",
              /* @__PURE__ */ c.jsx("span", { className: "text-base font-medium text-foreground mx-0.5", children: e.bufferSize }),
              " "
            ] }),
            /* @__PURE__ */ c.jsxs("div", { className: "relative h-4 flex items-center group cursor-pointer", children: [
              /* @__PURE__ */ c.jsx("div", { className: "absolute inset-x-0 h-[1px]", style: { backgroundColor: "var(--border)" } }),
              /* @__PURE__ */ c.jsx(
                "div",
                {
                  className: "absolute top-1/2 -translate-y-1/2 w-2.5 h-2.5 bg-muted-foreground/80 rounded-full shadow-sm pointer-events-none transition-transform duration-75 ease-out group-hover:scale-125 group-hover:bg-foreground",
                  style: { left: `${e.bufferSize / 20 * 100}%`, transform: "translate(-50%, -50%)" }
                }
              ),
              /* @__PURE__ */ c.jsx(
                "input",
                {
                  type: "range",
                  min: 0,
                  max: 20,
                  step: 1,
                  value: e.bufferSize,
                  onChange: ($) => {
                    const G = Number($.target.value);
                    n({ ...e, bufferSize: G }), Promise.resolve().then(() => Vo).then(({ summarizerService: le }) => {
                      le.updateConfig({ bufferSize: G });
                    });
                  },
                  className: "absolute inset-x-0 w-full h-full opacity-0 cursor-pointer z-10 m-0",
                  style: { appearance: "none", WebkitAppearance: "none" }
                }
              )
            ] })
          ] })
        ] }) })
      ] }),
      /* @__PURE__ */ c.jsx("div", { className: "flex justify-end", children: /* @__PURE__ */ c.jsxs(
        "button",
        {
          className: "inline-flex items-center gap-2 px-3 py-1.5 text-xs text-red-500 hover:text-red-400 border border-red-500/30 hover:border-red-500/50 hover:bg-red-500/10 rounded transition-colors",
          onClick: M,
          disabled: a,
          title: " ()",
          children: [
            /* @__PURE__ */ c.jsx(fr, { size: 12, className: a ? "animate-spin" : "" }),
            ""
          ]
        }
      ) })
    ] }),
    /* @__PURE__ */ c.jsxs("section", { className: "space-y-6 lg:pl-8 relative", children: [
      /* @__PURE__ */ c.jsx(Br, { responsive: !0, length: 30 }),
      /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between", children: [
        /* @__PURE__ */ c.jsxs("div", { children: [
          /* @__PURE__ */ c.jsx("h2", { className: "text-sm font-medium text-foreground", children: "" }),
          /* @__PURE__ */ c.jsx("p", { className: "text-xs text-muted-foreground mt-0.5", children: "" })
        ] }),
        /* @__PURE__ */ c.jsx(
          Zo,
          {
            label: "",
            checked: t.enabled ?? !1,
            onChange: q
          }
        )
      ] }),
      /* @__PURE__ */ c.jsxs("div", { className: `space-y-6 transition-opacity ${t.enabled ? "opacity-100" : "opacity-40 pointer-events-none"}`, children: [
        /* @__PURE__ */ c.jsxs("div", { className: "space-y-3", children: [
          /* @__PURE__ */ c.jsx("span", { className: "text-xs text-muted-foreground", children: "" }),
          /* @__PURE__ */ c.jsx("div", { className: "flex gap-6", children: C2e.map(($) => /* @__PURE__ */ c.jsxs(
            "label",
            {
              className: "flex items-center gap-2 cursor-pointer group",
              onClick: () => P($.id),
              children: [
                /* @__PURE__ */ c.jsx(
                  "span",
                  {
                    className: `w-4 h-4 rounded-full border-2 flex items-center justify-center transition-colors
                                        ${t.trigger === $.id ? "border-primary bg-primary" : "border-border group-hover:border-muted-foreground"}`,
                    children: t.trigger === $.id && /* @__PURE__ */ c.jsx("span", { className: "w-1.5 h-1.5 rounded-full bg-primary-foreground" })
                  }
                ),
                /* @__PURE__ */ c.jsx("span", { className: `text-sm transition-colors ${t.trigger === $.id ? "text-foreground" : "text-muted-foreground"}`, children: $.label })
              ]
            },
            $.id
          )) })
        ] }),
        /* @__PURE__ */ c.jsxs("div", { className: "space-y-3", children: [
          /* @__PURE__ */ c.jsx("div", { className: "text-xs text-muted-foreground", children: V.label === "Token " ? /* @__PURE__ */ c.jsxs(c.Fragment, { children: [
            " Token  ",
            /* @__PURE__ */ c.jsx("span", { className: "text-base font-medium text-foreground mx-0.5", children: V.value }),
            " "
          ] }) : /* @__PURE__ */ c.jsxs(c.Fragment, { children: [
            " ",
            /* @__PURE__ */ c.jsx("span", { className: "text-base font-medium text-foreground mx-0.5", children: V.value }),
            " "
          ] }) }),
          /* @__PURE__ */ c.jsxs("div", { className: "relative h-4 flex items-center group cursor-pointer", children: [
            /* @__PURE__ */ c.jsx("div", { className: "absolute inset-x-0 h-[1px]", style: { backgroundColor: "var(--border)" } }),
            /* @__PURE__ */ c.jsx(
              "div",
              {
                className: "absolute top-1/2 -translate-y-1/2 w-2.5 h-2.5 bg-muted-foreground/80 rounded-full shadow-sm pointer-events-none transition-transform duration-75 ease-out group-hover:scale-125 group-hover:bg-foreground",
                style: { left: `${(V.value - V.min) / (V.max - V.min) * 100}%`, transform: "translate(-50%, -50%)" }
              }
            ),
            /* @__PURE__ */ c.jsx(
              "input",
              {
                type: "range",
                min: V.min,
                max: V.max,
                step: V.step,
                value: V.value,
                onChange: ($) => {
                  const G = Number($.target.value), le = t.trigger === "token" ? "tokenLimit" : "countLimit";
                  D(le, G);
                },
                className: "absolute inset-x-0 w-full h-full opacity-0 cursor-pointer z-10 m-0",
                style: { appearance: "none", WebkitAppearance: "none" }
              }
            )
          ] })
        ] }),
        /* @__PURE__ */ c.jsxs("div", { className: "space-y-3", children: [
          /* @__PURE__ */ c.jsxs("div", { className: "text-xs text-muted-foreground", children: [
            " ",
            /* @__PURE__ */ c.jsx("span", { className: "text-base font-medium text-foreground mx-0.5", children: t.keepRecentCount ?? 3 }),
            " "
          ] }),
          /* @__PURE__ */ c.jsxs("div", { className: "relative h-4 flex items-center group cursor-pointer", children: [
            /* @__PURE__ */ c.jsx("div", { className: "absolute inset-x-0 h-[1px]", style: { backgroundColor: "var(--border)" } }),
            /* @__PURE__ */ c.jsx(
              "div",
              {
                className: "absolute top-1/2 -translate-y-1/2 w-2.5 h-2.5 bg-muted-foreground/80 rounded-full shadow-sm pointer-events-none transition-transform duration-75 ease-out group-hover:scale-125 group-hover:bg-foreground",
                style: { left: `${(t.keepRecentCount ?? 3) / 10 * 100}%`, transform: "translate(-50%, -50%)" }
              }
            ),
            /* @__PURE__ */ c.jsx(
              "input",
              {
                type: "range",
                min: 0,
                max: 10,
                step: 1,
                value: t.keepRecentCount ?? 3,
                onChange: ($) => D("keepRecentCount", Number($.target.value)),
                className: "absolute inset-x-0 w-full h-full opacity-0 cursor-pointer z-10 m-0",
                style: { appearance: "none", WebkitAppearance: "none" }
              }
            )
          ] })
        ] }),
        h && /* @__PURE__ */ c.jsxs("div", { className: "text-xs text-muted-foreground space-y-1", children: [
          /* @__PURE__ */ c.jsxs("div", { className: "flex justify-between", children: [
            /* @__PURE__ */ c.jsx("span", { children: ":" }),
            /* @__PURE__ */ c.jsx("span", { className: "font-mono", children: h.pendingEntryCount })
          ] }),
          /* @__PURE__ */ c.jsxs("div", { className: "flex justify-between", children: [
            /* @__PURE__ */ c.jsxs("span", { children: [
              "",
              t.trigger === "token" ? "Token" : "",
              ":"
            ] }),
            /* @__PURE__ */ c.jsxs("span", { className: `font-mono ${h.triggered ? "text-amber-500" : ""}`, children: [
              h.currentValue,
              " / ",
              V.value
            ] })
          ] })
        ] }),
        /* @__PURE__ */ c.jsxs(
          "button",
          {
            type: "button",
            className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg hover:border-foreground/30 transition-colors disabled:opacity-50",
            onClick: Y,
            disabled: d || ((h == null ? void 0 : h.pendingEntryCount) ?? 0) < 2,
            children: [
              /* @__PURE__ */ c.jsx(wV, { size: 14, className: d ? "animate-pulse" : "" }),
              d ? "..." : ""
            ]
          }
        ),
        /* @__PURE__ */ c.jsx("p", { className: "text-xs text-muted-foreground/70 leading-relaxed", children: " Token " })
      ] })
    ] })
  ] });
}, T2e = ({
  config: e,
  vectorConfig: t,
  onConfigChange: n
}) => {
  const [r, i] = I.useState({ total: 0, embedded: 0, pending: 0 }), [s, a] = I.useState(null), [u, d] = I.useState(!1), [f, h] = I.useState(!0), [m, x] = I.useState(null), [b, w] = I.useState(null);
  I.useEffect(() => {
    S();
  }, []);
  const S = async () => {
    h(!0), x(null);
    try {
      const D = await Vr.getEmbeddingStats();
      i(D);
    } catch (D) {
      x(D.message || "");
    } finally {
      h(!1);
    }
  }, C = I.useCallback(async () => {
    const D = await Vr.getEmbeddingStats();
    i(D);
  }, []), T = async () => {
    if (!t) {
      x("");
      return;
    }
    d(!0), a({ current: 0, total: r.pending, errors: 0 }), x(null), w(null);
    try {
      Vr.setConfig(t), Vr.setConcurrency(e.concurrency);
      const D = await Vr.embedUnprocessedEvents((q, Y, te) => {
        a({ current: q, total: Y, errors: te });
      });
      w(D), await C();
    } catch (D) {
      x(D.message || "");
    } finally {
      d(!1), a(null);
    }
  }, R = () => {
    Vr.stop();
  }, N = async () => {
    if (!t) {
      x("");
      return;
    }
    if (confirm("")) {
      d(!0), a({ current: 0, total: r.total, errors: 0 }), x(null), w(null);
      try {
        Vr.setConfig(t), Vr.setConcurrency(e.concurrency);
        const D = await Vr.reembedAllEvents((q, Y, te) => {
          a({ current: q, total: Y, errors: te });
        });
        w(D), await C();
      } catch (D) {
        x(D.message || "");
      } finally {
        d(!1), a(null);
      }
    }
  }, M = s && s.total > 0 ? Math.round(s.current / s.total * 100) : 0, P = t && (t.source === "transformers" || t.model);
  return f ? /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-center h-48 text-muted-foreground gap-2", children: [
    /* @__PURE__ */ c.jsx(rc, { size: 20, className: "animate-spin" }),
    /* @__PURE__ */ c.jsx("span", { className: "text-sm font-light", children: "..." })
  ] }) : /* @__PURE__ */ c.jsxs("div", { className: "py-4", children: [
    /* @__PURE__ */ c.jsxs("div", { className: "grid grid-cols-3 gap-4 mb-6", children: [
      /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-1", children: [
        /* @__PURE__ */ c.jsx("span", { className: "text-xs text-muted-foreground uppercase tracking-wider", children: "" }),
        /* @__PURE__ */ c.jsx("span", { className: "text-2xl font-light", children: r.total })
      ] }),
      /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-1", children: [
        /* @__PURE__ */ c.jsx("span", { className: "text-xs text-muted-foreground uppercase tracking-wider", children: "" }),
        /* @__PURE__ */ c.jsx("span", { className: "text-2xl font-light text-primary", children: r.embedded })
      ] }),
      /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col gap-1", children: [
        /* @__PURE__ */ c.jsx("span", { className: "text-xs text-muted-foreground uppercase tracking-wider", children: "" }),
        /* @__PURE__ */ c.jsx("span", { className: "text-2xl font-light text-warning", children: r.pending })
      ] })
    ] }),
    s && /* @__PURE__ */ c.jsxs("div", { className: "mb-6 p-4 bg-muted/30 rounded-lg", children: [
      /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between mb-2", children: [
        /* @__PURE__ */ c.jsxs("span", { className: "text-sm text-muted-foreground", children: [
          " ",
          s.current,
          "/",
          s.total
        ] }),
        /* @__PURE__ */ c.jsxs("span", { className: "text-sm font-medium", children: [
          M,
          "%"
        ] })
      ] }),
      /* @__PURE__ */ c.jsx("div", { className: "h-2 bg-muted rounded-full overflow-hidden", children: /* @__PURE__ */ c.jsx(
        "div",
        {
          className: "h-full bg-primary transition-all duration-300",
          style: { width: `${M}%` }
        }
      ) }),
      s.errors > 0 && /* @__PURE__ */ c.jsxs("p", { className: "text-xs text-destructive mt-2", children: [
        s.errors,
        " "
      ] })
    ] }),
    b && /* @__PURE__ */ c.jsxs("div", { className: `mb-6 p-3 rounded-lg flex items-center gap-2 ${b.failed > 0 ? "bg-warning/10 text-warning" : "bg-primary/10 text-primary"}`, children: [
      b.failed > 0 ? /* @__PURE__ */ c.jsx(_d, { size: 16 }) : /* @__PURE__ */ c.jsx(qb, { size: 16 }),
      /* @__PURE__ */ c.jsxs("span", { className: "text-sm", children: [
        "",
        b.success,
        " ",
        b.failed > 0 && `${b.failed} `
      ] })
    ] }),
    m && /* @__PURE__ */ c.jsxs("div", { className: "mb-6 p-3 bg-destructive/10 text-destructive rounded-lg flex items-center gap-2", children: [
      /* @__PURE__ */ c.jsx(_d, { size: 16 }),
      /* @__PURE__ */ c.jsx("span", { className: "text-sm", children: m })
    ] }),
    !P && /* @__PURE__ */ c.jsx("div", { className: "mb-6 p-3 bg-muted/50 rounded-lg", children: /* @__PURE__ */ c.jsxs("p", { className: "text-sm text-muted-foreground", children: [
      "",
      /* @__PURE__ */ c.jsx("span", { className: "text-primary mx-1", children: "API     " }),
      ""
    ] }) }),
    /* @__PURE__ */ c.jsx("div", { className: "flex flex-wrap gap-3 mb-6", children: u ? /* @__PURE__ */ c.jsxs(
      "button",
      {
        onClick: R,
        className: "inline-flex items-center gap-2 px-4 py-2 bg-destructive text-destructive-foreground rounded-md hover:bg-destructive/90 transition-colors",
        children: [
          /* @__PURE__ */ c.jsx(Tz, { size: 16 }),
          ""
        ]
      }
    ) : /* @__PURE__ */ c.jsxs(c.Fragment, { children: [
      /* @__PURE__ */ c.jsxs(
        "button",
        {
          onClick: T,
          disabled: r.pending === 0 || !P,
          className: "inline-flex items-center gap-2 px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",
          children: [
            /* @__PURE__ */ c.jsx(Sd, { size: 16 }),
            " (",
            r.pending,
            ")"
          ]
        }
      ),
      /* @__PURE__ */ c.jsxs(
        "button",
        {
          onClick: N,
          disabled: r.total === 0 || !P,
          className: "inline-flex items-center gap-2 px-4 py-2 border border-border text-foreground rounded-md hover:bg-muted transition-colors disabled:opacity-50 disabled:cursor-not-allowed",
          children: [
            /* @__PURE__ */ c.jsx(fr, { size: 16 }),
            ""
          ]
        }
      ),
      /* @__PURE__ */ c.jsx(
        "button",
        {
          onClick: C,
          className: "inline-flex items-center gap-2 px-3 py-2 text-muted-foreground hover:text-foreground transition-colors",
          children: /* @__PURE__ */ c.jsx(fr, { size: 16 })
        }
      )
    ] }) }),
    /* @__PURE__ */ c.jsx(Br, { className: "my-6" }),
    /* @__PURE__ */ c.jsxs("div", { className: "space-y-4", children: [
      /* @__PURE__ */ c.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider", children: "" }),
      /* @__PURE__ */ c.jsx(
        Zo,
        {
          label: "",
          checked: e.enabled,
          onChange: (D) => n({ enabled: D }),
          description: ""
        }
      ),
      /* @__PURE__ */ c.jsx(
        el,
        {
          label: "",
          value: e.trigger,
          onChange: (D) => n({ trigger: D }),
          options: [
            { value: "with_trim", label: " Trim " },
            { value: "standalone", label: "" },
            { value: "manual", label: "" }
          ],
          description: "with_trim: Trim  | standalone: "
        }
      ),
      /* @__PURE__ */ c.jsx(
        Ir,
        {
          label: "",
          value: e.concurrency,
          onChange: (D) => n({ concurrency: Math.max(1, Math.min(20, D)) }),
          min: 1,
          max: 20,
          description: " (1-20)"
        }
      ),
      t && /* @__PURE__ */ c.jsxs("div", { className: "p-3 bg-muted/30 rounded-lg", children: [
        /* @__PURE__ */ c.jsx("p", { className: "text-xs text-muted-foreground mb-1", children: "" }),
        /* @__PURE__ */ c.jsxs("p", { className: "text-sm", children: [
          /* @__PURE__ */ c.jsx("span", { className: "text-primary", children: t.source }),
          t.model && /* @__PURE__ */ c.jsxs("span", { className: "text-muted-foreground ml-2", children: [
            "/ ",
            t.model
          ] })
        ] })
      ] })
    ] })
  ] });
}, j2e = ({ config: e, onChange: t, rerankConfig: n, onRerankChange: r }) => {
  var s, a, u, d, f, h, m, x;
  const i = (b) => {
    const w = { ...e, ...b };
    t(w);
  };
  return /* @__PURE__ */ c.jsxs("div", { className: "space-y-6 animate-in fade-in slide-in-from-right-4 duration-500", children: [
    /* @__PURE__ */ c.jsx("div", { className: "bg-secondary/20 p-4 rounded-lg border border-border/50", children: /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between", children: [
      /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-3", children: [
        /* @__PURE__ */ c.jsx("div", { className: `p-2 rounded-md ${e.enabled ? "bg-primary/20 text-primary" : "bg-muted text-muted-foreground"}`, children: /* @__PURE__ */ c.jsx(V5, { size: 20 }) }),
        /* @__PURE__ */ c.jsxs("div", { children: [
          /* @__PURE__ */ c.jsx("div", { className: "font-medium", children: " RAG " }),
          /* @__PURE__ */ c.jsx("div", { className: "text-xs text-muted-foreground", children: "" })
        ] })
      ] }),
      /* @__PURE__ */ c.jsx(
        gi,
        {
          checked: e.enabled,
          onChange: (b) => i({ enabled: b })
        }
      )
    ] }) }),
    /* @__PURE__ */ c.jsxs("div", { className: "space-y-4", children: [
      /* @__PURE__ */ c.jsx("h3", { className: "text-sm font-medium text-muted-foreground uppercase tracking-wider px-1", children: "" }),
      /* @__PURE__ */ c.jsxs("div", { className: "grid grid-cols-1 md:grid-cols-2 gap-4", children: [
        /* @__PURE__ */ c.jsxs("div", { className: `p-4 rounded-lg border transition-all ${e.useBruteForce ? "bg-primary/5 border-primary/30" : "bg-card border-border/50 hover:border-border"}`, children: [
          /* @__PURE__ */ c.jsxs("div", { className: "flex items-start justify-between mb-2", children: [
            /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2 text-sm font-medium", children: [
              /* @__PURE__ */ c.jsx(Zu, { size: 16, className: e.useBruteForce ? "text-primary" : "text-muted-foreground" }),
              " (Brute Force)"
            ] }),
            /* @__PURE__ */ c.jsx(
              gi,
              {
                checked: e.useBruteForce,
                onChange: (b) => i({ useBruteForce: b })
              }
            )
          ] }),
          /* @__PURE__ */ c.jsx("p", { className: "text-xs text-muted-foreground leading-relaxed", children: "" })
        ] }),
        /* @__PURE__ */ c.jsxs("div", { className: `p-4 rounded-lg border transition-all ${e.useEmbedding ? "bg-primary/5 border-primary/30" : "bg-card border-border/50 hover:border-border"}`, children: [
          /* @__PURE__ */ c.jsxs("div", { className: "flex items-start justify-between mb-2", children: [
            /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2 text-sm font-medium", children: [
              /* @__PURE__ */ c.jsx(kh, { size: 16, className: e.useEmbedding ? "text-primary" : "text-muted-foreground" }),
              " (Embedding)"
            ] }),
            /* @__PURE__ */ c.jsx(
              gi,
              {
                checked: e.useEmbedding,
                onChange: (b) => i({ useEmbedding: b })
              }
            )
          ] }),
          /* @__PURE__ */ c.jsx("p", { className: "text-xs text-muted-foreground leading-relaxed", children: "RAG " })
        ] }),
        /* @__PURE__ */ c.jsxs("div", { className: `p-4 rounded-lg border transition-all ${e.usePreprocessing ? "bg-primary/5 border-primary/30" : "bg-card border-border/50 hover:border-border"}`, children: [
          /* @__PURE__ */ c.jsxs("div", { className: "flex items-start justify-between mb-2", children: [
            /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2 text-sm font-medium", children: [
              /* @__PURE__ */ c.jsx(fA, { size: 16, className: e.usePreprocessing ? "text-primary" : "text-muted-foreground" }),
              "LLM "
            ] }),
            /* @__PURE__ */ c.jsx(
              gi,
              {
                checked: e.usePreprocessing,
                onChange: (b) => i({ usePreprocessing: b })
              }
            )
          ] }),
          /* @__PURE__ */ c.jsx("p", { className: "text-xs text-muted-foreground leading-relaxed", children: " LLM " })
        ] }),
        /* @__PURE__ */ c.jsxs("div", { className: `p-4 rounded-lg border transition-all ${e.useRerank ? "bg-primary/5 border-primary/30" : "bg-card border-border/50 hover:border-border"}`, children: [
          /* @__PURE__ */ c.jsxs("div", { className: "flex items-start justify-between mb-2", children: [
            /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2 text-sm font-medium", children: [
              /* @__PURE__ */ c.jsx(Em, { size: 16, className: e.useRerank ? "text-primary" : "text-muted-foreground" }),
              "Rerank "
            ] }),
            /* @__PURE__ */ c.jsx(
              gi,
              {
                checked: e.useRerank,
                disabled: !e.useEmbedding,
                onChange: (b) => i({ useRerank: b })
              }
            )
          ] }),
          /* @__PURE__ */ c.jsxs("p", { className: "text-xs text-muted-foreground leading-relaxed", children: [
            " Rerank ",
            !e.useEmbedding && /* @__PURE__ */ c.jsxs("span", { className: "text-yellow-500 block mt-1 text-[10px] flex items-center gap-1", children: [
              /* @__PURE__ */ c.jsx(km, { size: 10 }),
              " "
            ] })
          ] }),
          e.useRerank && n && /* @__PURE__ */ c.jsxs("div", { className: "mt-3 pt-3 border-t border-border/30 space-y-3", children: [
            /* @__PURE__ */ c.jsx(
              Ir,
              {
                label: "Top-N",
                description: "",
                min: 1,
                max: 50,
                step: 1,
                value: n.topN,
                onChange: (b) => r == null ? void 0 : r({ ...n, topN: b })
              }
            ),
            /* @__PURE__ */ c.jsx(
              Ir,
              {
                label: " (Hybrid Alpha)",
                description: "0 = 1 =  Rerank ",
                min: 0,
                max: 1,
                step: 0.1,
                value: n.hybridAlpha,
                onChange: (b) => r == null ? void 0 : r({ ...n, hybridAlpha: b })
              }
            )
          ] })
        ] })
      ] })
    ] }),
    /* @__PURE__ */ c.jsxs("div", { className: "grid grid-cols-1 md:grid-cols-2 gap-6 pt-4 border-t border-border/30", children: [
      /* @__PURE__ */ c.jsx(
        Ir,
        {
          label: " (Top-K)",
          description: "",
          min: 1,
          max: 100,
          value: ((s = e.embedding) == null ? void 0 : s.topK) ?? 20,
          onChange: (b) => {
            var w;
            return i({
              embedding: {
                topK: b,
                minScoreThreshold: ((w = e.embedding) == null ? void 0 : w.minScoreThreshold) ?? 0.3
              }
            });
          }
        }
      ),
      /* @__PURE__ */ c.jsx(
        Ir,
        {
          label: "",
          description: " (0.0 - 1.0)",
          min: 0,
          max: 1,
          step: 0.05,
          value: ((a = e.embedding) == null ? void 0 : a.minScoreThreshold) ?? 0.3,
          onChange: (b) => {
            var w;
            return i({
              embedding: {
                topK: ((w = e.embedding) == null ? void 0 : w.topK) ?? 20,
                minScoreThreshold: b
              }
            });
          }
        }
      )
    ] }),
    /* @__PURE__ */ c.jsxs(
      "div",
      {
        className: `space-y-4 pt-4 border-t border-border/30 relative transition-all duration-300 ${(u = e.brainRecall) != null && u.enabled ? "pl-4 border-l-2 border-l-primary" : ""}`,
        children: [
          /* @__PURE__ */ c.jsxs("div", { className: "relative", children: [
            /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between", children: [
              /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2", children: [
                /* @__PURE__ */ c.jsx(
                  "div",
                  {
                    className: `p-1.5 rounded-md transition-colors ${(d = e.brainRecall) != null && d.enabled ? "bg-primary/20 text-primary" : "bg-muted text-muted-foreground"}`,
                    children: /* @__PURE__ */ c.jsx(fA, { size: 16 })
                  }
                ),
                /* @__PURE__ */ c.jsx(
                  "h3",
                  {
                    className: `text-sm font-medium uppercase tracking-wider transition-all ${(f = e.brainRecall) != null && f.enabled ? "text-primary" : "text-muted-foreground"}`,
                    children: ""
                  }
                ),
                /* @__PURE__ */ c.jsx("span", { className: `text-[10px] px-1.5 py-0.5 rounded font-medium border ${(h = e.brainRecall) != null && h.enabled ? "bg-yellow-500/10 text-yellow-500 border-yellow-500/30" : "bg-muted text-muted-foreground border-transparent"}`, children: "EXPERIMENTAL" })
              ] }),
              /* @__PURE__ */ c.jsx(
                gi,
                {
                  checked: ((m = e.brainRecall) == null ? void 0 : m.enabled) ?? !1,
                  onChange: (b) => {
                    var w, S, C, T, R, N, M, P, D, q, Y, te, V;
                    return i({
                      brainRecall: {
                        enabled: b,
                        workingLimit: ((w = e.brainRecall) == null ? void 0 : w.workingLimit) ?? 10,
                        shortTermLimit: ((S = e.brainRecall) == null ? void 0 : S.shortTermLimit) ?? 35,
                        reinforceFactor: ((C = e.brainRecall) == null ? void 0 : C.reinforceFactor) ?? 0.2,
                        decayRate: ((T = e.brainRecall) == null ? void 0 : T.decayRate) ?? 0.08,
                        evictionThreshold: ((R = e.brainRecall) == null ? void 0 : R.evictionThreshold) ?? 0.25,
                        contextSwitchThreshold: ((N = e.brainRecall) == null ? void 0 : N.contextSwitchThreshold) ?? 0.4,
                        gateThreshold: ((M = e.brainRecall) == null ? void 0 : M.gateThreshold) ?? 0.6,
                        maxDamping: ((P = e.brainRecall) == null ? void 0 : P.maxDamping) ?? 3,
                        sigmoidTemperature: ((D = e.brainRecall) == null ? void 0 : D.sigmoidTemperature) ?? 5,
                        boredomThreshold: ((q = e.brainRecall) == null ? void 0 : q.boredomThreshold) ?? 3,
                        boredomPenalty: ((Y = e.brainRecall) == null ? void 0 : Y.boredomPenalty) ?? 0.2,
                        mmrThreshold: ((te = e.brainRecall) == null ? void 0 : te.mmrThreshold) ?? 0.6,
                        newcomerBoost: ((V = e.brainRecall) == null ? void 0 : V.newcomerBoost) ?? 0.3
                      }
                    });
                  }
                }
              )
            ] }),
            /* @__PURE__ */ c.jsxs("p", { className: "text-xs text-muted-foreground mt-2 pl-8 leading-relaxed", children: [
              "",
              /* @__PURE__ */ c.jsx("span", { className: "opacity-70 ml-1", children: "" })
            ] })
          ] }),
          ((x = e.brainRecall) == null ? void 0 : x.enabled) && /* @__PURE__ */ c.jsxs("div", { className: "space-y-6 pt-2 animate-in fade-in slide-in-from-top-2 duration-300", children: [
            /* @__PURE__ */ c.jsxs("div", { className: "space-y-3 pl-2 border-l-2 border-primary/20 ml-2", children: [
              /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2 text-xs text-primary/80 font-medium uppercase tracking-wider", children: [
                /* @__PURE__ */ c.jsx(Em, { size: 12 }),
                ""
              ] }),
              /* @__PURE__ */ c.jsxs("div", { className: "grid grid-cols-2 gap-4", children: [
                /* @__PURE__ */ c.jsx(
                  Ir,
                  {
                    label: "",
                    description: "",
                    min: 1,
                    max: 20,
                    step: 1,
                    value: e.brainRecall.workingLimit,
                    onChange: (b) => i({
                      brainRecall: { ...e.brainRecall, workingLimit: b }
                    })
                  }
                ),
                /* @__PURE__ */ c.jsx(
                  Ir,
                  {
                    label: "",
                    description: "",
                    min: 1,
                    max: 50,
                    step: 1,
                    value: e.brainRecall.shortTermLimit,
                    onChange: (b) => i({
                      brainRecall: { ...e.brainRecall, shortTermLimit: b }
                    })
                  }
                )
              ] })
            ] }),
            /* @__PURE__ */ c.jsxs("div", { className: "space-y-3 pl-2 border-l-2 border-primary/20 ml-2", children: [
              /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2 text-xs text-primary/80 font-medium uppercase tracking-wider", children: [
                /* @__PURE__ */ c.jsx(Zu, { size: 12 }),
                ""
              ] }),
              /* @__PURE__ */ c.jsxs("div", { className: "grid grid-cols-3 gap-4", children: [
                /* @__PURE__ */ c.jsx(
                  Ir,
                  {
                    label: "",
                    description: "",
                    min: 0,
                    max: 1,
                    step: 0.05,
                    value: e.brainRecall.reinforceFactor,
                    onChange: (b) => i({
                      brainRecall: { ...e.brainRecall, reinforceFactor: b }
                    })
                  }
                ),
                /* @__PURE__ */ c.jsx(
                  Ir,
                  {
                    label: "",
                    description: "",
                    min: 0,
                    max: 1,
                    step: 0.01,
                    value: e.brainRecall.decayRate,
                    onChange: (b) => i({
                      brainRecall: { ...e.brainRecall, decayRate: b }
                    })
                  }
                ),
                /* @__PURE__ */ c.jsx(
                  Ir,
                  {
                    label: "",
                    description: "",
                    min: 0,
                    max: 1,
                    step: 0.05,
                    value: e.brainRecall.evictionThreshold,
                    onChange: (b) => i({
                      brainRecall: { ...e.brainRecall, evictionThreshold: b }
                    })
                  }
                )
              ] })
            ] }),
            /* @__PURE__ */ c.jsxs("div", { className: "space-y-3 pl-2 border-l-2 border-primary/20 ml-2", children: [
              /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2 text-xs text-primary/80 font-medium uppercase tracking-wider", children: [
                /* @__PURE__ */ c.jsx(km, { size: 12 }),
                ""
              ] }),
              /* @__PURE__ */ c.jsx(
                Ir,
                {
                  label: "",
                  description: "/",
                  min: 0,
                  max: 1,
                  step: 0.1,
                  value: e.brainRecall.contextSwitchThreshold,
                  onChange: (b) => i({
                    brainRecall: { ...e.brainRecall, contextSwitchThreshold: b }
                  })
                }
              )
            ] })
          ] })
        ]
      }
    )
  ] });
}, A2e = ({
  recallConfig: e,
  rerankConfig: t,
  onRecallConfigChange: n,
  onRerankConfigChange: r
}) => {
  const [i, s] = wd.useState(""), [a, u] = wd.useState(!1), d = async () => {
    if (!(!i.trim() || a)) {
      u(!0);
      try {
        await Y3.search(i), console.log("Test completed, check recall logs");
      } catch (f) {
        console.error("Test failed", f);
      } finally {
        u(!1);
      }
    }
  };
  return /* @__PURE__ */ c.jsxs("div", { className: "p-1 space-y-4", children: [
    /* @__PURE__ */ c.jsx(
      j2e,
      {
        config: e,
        onChange: n,
        rerankConfig: t,
        onRerankChange: r
      }
    ),
    /* @__PURE__ */ c.jsxs("div", { className: "pt-6 border-t border-border mt-6", children: [
      /* @__PURE__ */ c.jsxs("h3", { className: "text-sm font-medium mb-3 flex items-center gap-2", children: [
        /* @__PURE__ */ c.jsx(Sd, { size: 16, className: "text-primary" }),
        " (Quick Test)"
      ] }),
      /* @__PURE__ */ c.jsxs("div", { className: "flex gap-2", children: [
        /* @__PURE__ */ c.jsx(
          "textarea",
          {
            value: i,
            onChange: (f) => s(f.target.value),
            placeholder: " User Input ...",
            className: "flex-1 min-h-[80px] p-3 rounded-md bg-secondary/30 border border-border/50 text-sm focus:outline-none focus:border-primary/50 transition-colors resize-y"
          }
        ),
        /* @__PURE__ */ c.jsx(
          "button",
          {
            onClick: d,
            disabled: !i.trim() || a,
            className: `
                            px-4 rounded-md font-medium text-sm transition-all flex flex-col items-center justify-center gap-1 min-w-[80px]
                            ${!i.trim() || a ? "bg-muted text-muted-foreground cursor-not-allowed" : "bg-primary text-primary-foreground hover:bg-primary/90 shadow-sm"}
                        `,
            children: a ? /* @__PURE__ */ c.jsxs(c.Fragment, { children: [
              /* @__PURE__ */ c.jsx(rc, { size: 18, className: "animate-spin" }),
              /* @__PURE__ */ c.jsx("span", { className: "text-xs", children: "" })
            ] }) : /* @__PURE__ */ c.jsxs(c.Fragment, { children: [
              /* @__PURE__ */ c.jsx(Sd, { size: 18, fill: "currentColor" }),
              /* @__PURE__ */ c.jsx("span", { className: "text-xs", children: "" })
            ] })
          }
        )
      ] }),
      /* @__PURE__ */ c.jsxs("p", { className: "text-xs text-muted-foreground mt-2 pl-1", children: [
        "*  ",
        /* @__PURE__ */ c.jsx("span", { className: "text-foreground font-medium", children: "Dev Log" }),
        " "
      ] })
    ] })
  ] });
}, dz = ({
  icon: e,
  label: t,
  primary: n = !1,
  size: r = "md",
  className: i = "",
  ...s
}) => /* @__PURE__ */ c.jsxs(
  "button",
  {
    className: `
            flex items-center gap-2 rounded-full font-medium
            transition-all duration-[var(--duration-fast)] ease-[var(--ease-spring)]
            hover:scale-[1.02] active:scale-95
            ${r === "sm" ? "px-3 py-1.5 text-xs" : "px-5 py-2.5 text-sm"}
            ${n ? "bg-primary text-primary-foreground hover:opacity-90 hover:shadow-[0_0_20px_var(--primary)] border border-transparent" : "bg-transparent text-muted-foreground hover:text-foreground border border-border hover:border-input hover:bg-accent/50"}
            ${i}
        `,
    ...s,
    children: [
      e && /* @__PURE__ */ c.jsx(e, { size: r === "sm" ? 14 : 16, className: "transition-transform duration-[var(--duration-fast)] group-hover:scale-110" }),
      t
    ]
  }
), N2e = ({
  isOpen: e,
  onClose: t,
  onConfirm: n,
  newEntities: r,
  updatedEntities: i
}) => {
  const [s, a] = I.useState(r), [u, d] = I.useState(i), [f, h] = I.useState(!1);
  I.useEffect(() => {
    e && (a(r), d(i));
  }, [e, r, i]);
  const m = (w) => {
    a((S) => S.filter((C, T) => T !== w));
  }, x = (w) => {
    d((S) => S.filter((C, T) => T !== w));
  }, b = async () => {
    h(!0);
    try {
      await n({ newEntities: s, updatedEntities: u }), t();
    } finally {
      h(!1);
    }
  };
  return /* @__PURE__ */ c.jsx(
    Wne,
    {
      isOpen: e,
      onClose: t,
      title: "",
      size: "lg",
      children: /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col h-[70vh]", children: [
        /* @__PURE__ */ c.jsx("div", { className: "mb-4", children: /* @__PURE__ */ c.jsx("p", { className: "text-sm text-muted-foreground", children: "" }) }),
        /* @__PURE__ */ c.jsxs("div", { className: "flex-1 overflow-y-auto pr-2 space-y-6", children: [
          /* @__PURE__ */ c.jsxs("div", { className: "space-y-3", children: [
            /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2 text-sm font-medium text-green-500", children: [
              /* @__PURE__ */ c.jsx("span", { className: "w-2 h-2 rounded-full bg-green-500" }),
              " (",
              s.length,
              ")"
            ] }),
            s.length === 0 ? /* @__PURE__ */ c.jsx("div", { className: "text-xs text-muted-foreground italic pl-4", children: "" }) : /* @__PURE__ */ c.jsx("div", { className: "grid grid-cols-1 md:grid-cols-2 gap-3", children: s.map((w, S) => /* @__PURE__ */ c.jsxs("div", { className: "relative group p-3 rounded-lg border border-green-500/20 bg-green-500/5 hover:bg-green-500/10 transition-colors", children: [
              /* @__PURE__ */ c.jsx(
                "button",
                {
                  onClick: () => m(S),
                  className: "absolute top-2 right-2 p-1 bg-transparent text-muted-foreground hover:text-destructive opacity-0 group-hover:opacity-100 transition-opacity",
                  title: "",
                  children: /* @__PURE__ */ c.jsx(Wu, { size: 14 })
                }
              ),
              /* @__PURE__ */ c.jsx("div", { className: "flex items-start justify-between pr-6", children: /* @__PURE__ */ c.jsxs("div", { children: [
                /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2 mb-1", children: [
                  /* @__PURE__ */ c.jsx("span", { className: "text-sm font-medium text-foreground", children: w.name }),
                  /* @__PURE__ */ c.jsx("span", { className: "text-[10px] px-1.5 py-0.5 rounded-full bg-background border border-border text-muted-foreground uppercase", children: w.type })
                ] }),
                /* @__PURE__ */ c.jsx("div", { className: "text-xs text-muted-foreground line-clamp-2", children: w.description })
              ] }) })
            ] }, S)) })
          ] }),
          /* @__PURE__ */ c.jsxs("div", { className: "space-y-3", children: [
            /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2 text-sm font-medium text-amber-500", children: [
              /* @__PURE__ */ c.jsx("span", { className: "w-2 h-2 rounded-full bg-amber-500" }),
              " (",
              u.length,
              ")"
            ] }),
            u.length === 0 ? /* @__PURE__ */ c.jsx("div", { className: "text-xs text-muted-foreground italic pl-4", children: "" }) : /* @__PURE__ */ c.jsx("div", { className: "grid grid-cols-1 md:grid-cols-2 gap-3", children: u.map((w, S) => /* @__PURE__ */ c.jsxs("div", { className: "relative group p-3 rounded-lg border border-amber-500/20 bg-amber-500/5 hover:bg-amber-500/10 transition-colors", children: [
              /* @__PURE__ */ c.jsx(
                "button",
                {
                  onClick: () => x(S),
                  className: "absolute top-2 right-2 p-1 bg-transparent text-muted-foreground hover:text-destructive opacity-0 group-hover:opacity-100 transition-opacity",
                  title: "",
                  children: /* @__PURE__ */ c.jsx(Wu, { size: 14 })
                }
              ),
              /* @__PURE__ */ c.jsx("div", { className: "flex items-start justify-between pr-6", children: /* @__PURE__ */ c.jsxs("div", { children: [
                /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2 mb-1", children: [
                  /* @__PURE__ */ c.jsx("span", { className: "text-sm font-medium text-foreground", children: w.name }),
                  /* @__PURE__ */ c.jsx("span", { className: "text-[10px] px-1.5 py-0.5 rounded-full bg-background border border-border text-muted-foreground uppercase", children: w.type })
                ] }),
                /* @__PURE__ */ c.jsx("div", { className: "text-xs text-muted-foreground line-clamp-2", children: w.description })
              ] }) })
            ] }, S)) })
          ] })
        ] }),
        /* @__PURE__ */ c.jsxs("div", { className: "flex justify-end gap-2 pt-4 border-t border-border mt-4", children: [
          /* @__PURE__ */ c.jsx(dz, { label: "", size: "sm", onClick: t, disabled: f }),
          /* @__PURE__ */ c.jsx(
            dz,
            {
              label: "",
              size: "sm",
              primary: !0,
              icon: vh,
              onClick: b,
              disabled: f || s.length === 0 && u.length === 0
            }
          )
        ] })
      ] })
    }
  );
}, R2e = ({ config: e, onChange: t }) => {
  const [n, r] = I.useState(null), [i, s] = I.useState(!1), a = async () => {
    try {
      const S = await Ia.getStatus();
      r(S);
    } catch (S) {
      console.error("[EntityConfigPanel] Failed to load status:", S);
    }
  };
  I.useEffect(() => {
    if (a(), Ia.pendingReviewResult) {
      const S = Ia.pendingReviewResult;
      x({
        newEntities: S.newEntities,
        updatedEntities: S.updatedEntities
      }), h(!0);
    }
  }, []);
  const u = () => {
    const S = { ...e, enabled: !e.enabled };
    t(S), Ia.updateConfig(S);
  }, d = (S) => {
    const C = { ...e, floorInterval: Math.max(2, S) };
    t(C), Ia.updateConfig(C);
  }, [f, h] = I.useState(!1), [m, x] = I.useState({ newEntities: [], updatedEntities: [] }), b = async () => {
    s(!0);
    try {
      ee.debug("EntityConfigPanel", "Starting manual extract dry-run");
      const S = await Ia.extractManual(!0);
      ee.debug("EntityConfigPanel", "Manual extract result:", S), S && S.success && (S.newEntities.length > 0 || S.updatedEntities.length > 0) ? (ee.info("EntityConfigPanel", "Opening Review Modal", { new: S.newEntities.length }), x({
        newEntities: S.newEntities,
        updatedEntities: S.updatedEntities
      }), h(!0)) : (ee.info("EntityConfigPanel", "No changes detected or extraction failed"), S && S.success && await a());
    } catch (S) {
      console.error("[EntityConfigPanel] Manual extraction failed:", S);
    } finally {
      s(!1);
    }
  }, w = async (S) => {
    try {
      await Ia.saveRawEntities(S.newEntities, S.updatedEntities), await a();
    } catch (C) {
      console.error("[EntityConfigPanel] Failed to save reviewed entities:", C);
    }
  };
  return /* @__PURE__ */ c.jsxs("div", { className: "grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12", children: [
    /* @__PURE__ */ c.jsxs("section", { className: "space-y-8", children: [
      /* @__PURE__ */ c.jsxs("div", { children: [
        /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between mb-6", children: [
          /* @__PURE__ */ c.jsx("h2", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider", children: "" }),
          /* @__PURE__ */ c.jsx(
            "button",
            {
              className: "p-1 rounded text-muted-foreground hover:text-foreground transition-colors",
              onClick: a,
              title: "",
              children: /* @__PURE__ */ c.jsx(fr, { size: 14 })
            }
          )
        ] }),
        n ? /* @__PURE__ */ c.jsxs("div", { className: "space-y-6", children: [
          /* @__PURE__ */ c.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
            /* @__PURE__ */ c.jsxs("div", { children: [
              /* @__PURE__ */ c.jsx("span", { className: "text-xs text-muted-foreground block mb-1", children: "" }),
              /* @__PURE__ */ c.jsx("div", { className: `text-lg font-medium ${e.enabled ? "text-green-500" : "text-muted-foreground"}`, children: e.enabled ? "" : "" })
            ] }),
            /* @__PURE__ */ c.jsxs("div", { children: [
              /* @__PURE__ */ c.jsx("span", { className: "text-xs text-muted-foreground block mb-1", children: "" }),
              /* @__PURE__ */ c.jsx("div", { className: "text-3xl font-light text-primary font-mono", children: n.entityCount })
            ] })
          ] }),
          /* @__PURE__ */ c.jsx(Br, { length: 100, spacing: "md" }),
          /* @__PURE__ */ c.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
            /* @__PURE__ */ c.jsxs("div", { children: [
              /* @__PURE__ */ c.jsx("span", { className: "text-[10px] text-muted-foreground/70 uppercase tracking-wider block mb-1", children: "" }),
              /* @__PURE__ */ c.jsx("div", { className: "text-xl font-mono text-foreground/80", children: n.floorInterval })
            ] }),
            /* @__PURE__ */ c.jsxs("div", { children: [
              /* @__PURE__ */ c.jsx("span", { className: "text-[10px] text-muted-foreground/70 uppercase tracking-wider block mb-1", children: "" }),
              /* @__PURE__ */ c.jsx("div", { className: "text-xl font-mono text-foreground/80", children: n.lastExtractedFloor })
            ] })
          ] })
        ] }) : /* @__PURE__ */ c.jsx("p", { className: "text-sm text-muted-foreground", children: "..." })
      ] }),
      /* @__PURE__ */ c.jsx("div", { className: "flex gap-3", children: /* @__PURE__ */ c.jsxs(
        "button",
        {
          onClick: b,
          disabled: i || (n == null ? void 0 : n.isExtracting) || !e.enabled,
          className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",
          children: [
            /* @__PURE__ */ c.jsx(fr, { size: 14, className: i ? "animate-spin" : "" }),
            i ? "..." : ""
          ]
        }
      ) })
    ] }),
    /* @__PURE__ */ c.jsxs("section", { className: "space-y-6 lg:pl-8 relative", children: [
      /* @__PURE__ */ c.jsx(Br, { responsive: !0, length: 30 }),
      /* @__PURE__ */ c.jsxs("div", { className: "flex items-center justify-between", children: [
        /* @__PURE__ */ c.jsxs("div", { children: [
          /* @__PURE__ */ c.jsx("h2", { className: "text-sm font-medium text-foreground", children: "" }),
          /* @__PURE__ */ c.jsx("p", { className: "text-xs text-muted-foreground mt-0.5", children: "" })
        ] }),
        /* @__PURE__ */ c.jsx(
          Zo,
          {
            label: "",
            checked: e.enabled,
            onChange: u
          }
        )
      ] }),
      /* @__PURE__ */ c.jsxs("div", { className: `space-y-6 transition-opacity ${e.enabled ? "opacity-100" : "opacity-40 pointer-events-none"}`, children: [
        /* @__PURE__ */ c.jsxs("div", { className: "space-y-3", children: [
          /* @__PURE__ */ c.jsxs("div", { className: "text-xs text-muted-foreground", children: [
            " ",
            /* @__PURE__ */ c.jsx("span", { className: "text-base font-medium text-foreground mx-0.5", children: e.floorInterval }),
            " "
          ] }),
          /* @__PURE__ */ c.jsxs("div", { className: "relative h-4 flex items-center group cursor-pointer", children: [
            /* @__PURE__ */ c.jsx("div", { className: "absolute inset-x-0 h-[1px]", style: { backgroundColor: "var(--border)" } }),
            /* @__PURE__ */ c.jsx(
              "div",
              {
                className: "absolute top-1/2 -translate-y-1/2 w-2.5 h-2.5 bg-muted-foreground/80 rounded-full shadow-sm pointer-events-none transition-transform duration-75 ease-out group-hover:scale-125 group-hover:bg-foreground",
                style: { left: `${(e.floorInterval - 2) / 98 * 100}%`, transform: "translate(-50%, -50%)" }
              }
            ),
            /* @__PURE__ */ c.jsx(
              "input",
              {
                type: "range",
                min: 2,
                max: 100,
                step: 5,
                value: e.floorInterval,
                onChange: (S) => d(parseInt(S.target.value)),
                className: "absolute inset-x-0 w-full h-full opacity-0 cursor-pointer z-10 m-0",
                style: { appearance: "none", WebkitAppearance: "none" }
              }
            )
          ] })
        ] }),
        /* @__PURE__ */ c.jsx("p", { className: "text-xs text-muted-foreground/70 leading-relaxed", children: "" })
      ] })
    ] }),
    /* @__PURE__ */ c.jsx(
      N2e,
      {
        isOpen: f,
        onClose: () => {
          h(!1), Ia.clearPendingReview();
        },
        onConfirm: async (S) => {
          await w(S), Ia.clearPendingReview();
        },
        newEntities: m.newEntities,
        updatedEntities: m.updatedEntities
      }
    )
  ] });
}, fd = "Pipeline";
class M2e {
  /**
   *  Pipeline
   *  JSON
   */
  async run(t) {
    const n = vi.getState(), r = Date.now();
    try {
      if (ee.debug(fd, " Pipeline..."), n.setProcessing(!0), !await n.initChat())
        return { success: !1, error: " (Chat Context)" };
      const s = Wm.process(t.jsonContent, "output"), a = LT.parse(s);
      if (!a || !a.events || a.events.length === 0)
        return ee.warn(fd, "JSON "), { success: !1, error: "JSON " };
      ee.info(fd, ` ${a.events.length} `, { duration: Date.now() - r });
      const u = [];
      for (const h of a.events) {
        const m = h.meta, x = [];
        m.time_anchor && x.push(m.time_anchor), m.location && x.push(m.location), m.role && m.role.length > 0 && x.push(m.role.join(", "));
        const b = x.length > 0 ? `(${x.join(" | ")}) ` : "", w = m.event ? `${m.event}:
` : "", S = [];
        m.logic && m.logic.length > 0 && S.push(`[: ${m.logic.join(", ")}]`), m.causality && S.push(`[: ${m.causality}]`);
        const C = S.length > 0 ? `
${S.join(" ")}` : "";
        let T = h.summary;
        (!T || T.trim() === "") && (ee.warn(fd, "", h), T = `[Summary Missing] ${m.event || ""}`);
        const R = `${w}${b}${T}${C}`;
        u.push({
          summary: R,
          structured_kv: {
            time_anchor: m.time_anchor || "",
            role: m.role || [],
            // V1.0.2: location  string  string[] 
            location: Array.isArray(m.location) ? m.location : m.location ? [m.location] : [],
            event: m.event || "",
            logic: m.logic || [],
            causality: m.causality || ""
          },
          significance_score: h.significance_score,
          level: 0,
          is_embedded: !1,
          // V0.7: 
          is_archived: !1,
          // V0.7: 
          source_range: {
            start_index: t.sourceRange.start,
            end_index: t.sourceRange.end
          }
        });
      }
      const d = await n.saveEvents(u);
      ee.info(fd, ` ${d.length} `, { duration: Date.now() - r }), await n.setLastSummarizedFloor(t.sourceRange.end);
      const { MacroService: f } = await Promise.resolve().then(() => qT);
      return await f.refreshEngramCache(), ee.debug(fd, ""), ee.success(fd, "Pipeline ", { duration: Date.now() - r }), { success: !0, events: d };
    } catch (i) {
      return ee.error(fd, "Pipeline ", i), { success: !1, error: String(i) };
    } finally {
      n.setProcessing(!1);
    }
  }
}
const O2e = new M2e(), D2e = {
  mode: "detailed",
  chunkSize: 2e3,
  overlapSize: 200
};
class z2e {
  constructor() {
    lt(this, "queue", {
      tasks: [],
      isRunning: !1,
      isPaused: !1,
      currentTaskIndex: 0,
      overallProgress: { current: 0, total: 0 }
    });
    lt(this, "onProgress");
    lt(this, "stopSignal", !1);
  }
  /**  */
  async analyzeHistory(t = 0, n, r) {
    const s = Wo.getStatus().currentFloor, a = n ?? s, u = new Set(r || ["summary", "entity", "trim", "embed"]), d = Wo.getConfig(), f = Ia.getConfig(), h = Q1.getConfig(), m = a - t, x = d.floorInterval || 10, b = f.floorInterval || 50, w = u.has("summary") ? Math.ceil(m / x) : 0, S = u.has("entity") && f.enabled ? Math.ceil(m / b) : 0, C = h.countLimit || 5, T = u.has("trim") && h.enabled ? Math.floor(w / C) : 0, R = u.has("embed") ? (w || 1) * 2 : 0, N = w * 2e3 + S * 2e3 + T * 2e3 + R * 200;
    return {
      currentFloor: s,
      startFloor: t,
      endFloor: a,
      summaryTasks: w,
      entityTasks: S,
      trimTasks: T,
      embedTasks: R,
      estimatedTokens: N
    };
  }
  /**  */
  buildQueue(t) {
    const n = [], { startFloor: r, endFloor: i, summaryTasks: s, entityTasks: a, trimTasks: u, embedTasks: d } = t, f = Wo.getConfig().floorInterval || 10, h = Ia.getConfig().floorInterval || 50;
    for (let m = 0; m < s; m++) {
      const x = r + m * f, b = Math.min(x + f, i);
      n.push({
        id: Yo(),
        type: "summary",
        status: "pending",
        progress: { current: 0, total: 1 },
        floorRange: { start: x, end: b }
      });
    }
    for (let m = 0; m < a; m++) {
      const x = r + m * h, b = Math.min(x + h, i);
      n.push({
        id: Yo(),
        type: "entity",
        status: "pending",
        progress: { current: 0, total: 1 },
        floorRange: { start: x, end: b }
      });
    }
    for (let m = 0; m < u; m++)
      n.push({
        id: Yo(),
        type: "trim",
        status: "pending",
        progress: { current: 0, total: 1 }
      });
    return d > 0 && n.push({
      id: Yo(),
      type: "embed",
      status: "pending",
      progress: { current: 0, total: d }
    }), n;
  }
  /**  */
  async start(t = 0, n, r, i) {
    if (this.queue.isRunning) {
      ee.warn(Fe.BATCH, "");
      return;
    }
    this.onProgress = r, this.stopSignal = !1;
    const s = await this.analyzeHistory(t, n, i);
    if (this.queue.tasks = this.buildQueue(s), this.queue.tasks.length === 0) {
      ee.warn(Fe.BATCH, "");
      return;
    }
    this.queue.isRunning = !0, this.queue.isPaused = !1, this.queue.currentTaskIndex = 0, this.queue.overallProgress = { current: 0, total: this.queue.tasks.length }, ee.info(Fe.BATCH, ` ${this.queue.tasks.length} `), this.notifyProgress(), await this.runQueue();
  }
  /**  */
  async runQueue() {
    for (; this.queue.currentTaskIndex < this.queue.tasks.length; ) {
      if (this.stopSignal) {
        ee.info(Fe.BATCH, "");
        break;
      }
      if (this.queue.isPaused) {
        await new Promise((i) => setTimeout(i, 500));
        continue;
      }
      const r = this.queue.tasks[this.queue.currentTaskIndex];
      r.status = "running", this.notifyProgress();
      try {
        await this.executeTask(r), r.status = "done", r.progress.current = r.progress.total;
      } catch (i) {
        r.status = "error", r.error = String(i), ee.error(Fe.BATCH, ` ${r.type} `, { error: String(i) }), xn.error(`: ${r.type}`, "Engram ");
        break;
      }
      this.queue.currentTaskIndex++, this.queue.overallProgress.current = this.queue.currentTaskIndex, this.notifyProgress();
    }
    this.queue.isRunning = !1;
    const t = this.queue.tasks.filter((r) => r.status === "done").length, n = this.queue.tasks.filter((r) => r.status === "error").length;
    ee.success(Fe.BATCH, ""), n === 0 ? xn.success(`: ${t} `, "Engram", {
      action: { goto: "processing" }
    }) : xn.warning(`: ${t} , ${n} `, "Engram", {
      action: { goto: "devlog" }
    }), this.notifyProgress();
  }
  /**  */
  async executeTask(t) {
    switch (t.type) {
      case "summary":
        await this.executeSummaryTask(t);
        break;
      case "entity":
        await this.executeEntityTask(t);
        break;
      case "trim":
        await this.executeTrimTask(t);
        break;
      case "embed":
        await this.executeEmbedTask(t);
        break;
    }
  }
  async executeSummaryTask(t) {
    if (!t.floorRange) return;
    if (await Wo.setLastSummarizedFloor(t.floorRange.start), !await Wo.triggerSummary(!0))
      throw new Error(`Summary task failed for range ${t.floorRange.start}-${t.floorRange.end}`);
  }
  async executeEntityTask(t) {
    if (!t.floorRange) return;
    await Ia.extractByRange([t.floorRange.start, t.floorRange.end], !0) || (t.status = "skipped");
  }
  async executeTrimTask(t) {
    const { canTrim: n } = await Q1.canTrim();
    n ? await Q1.trim(!0) : t.status = "skipped";
  }
  async executeEmbedTask(t) {
    const n = await Vr.embedUnprocessedEvents((r, i) => {
      t.progress.current = r, t.progress.total = i, this.notifyProgress();
    });
    t.progress.current = n.success;
  }
  pause() {
    this.queue.isPaused = !0, ee.info(Fe.BATCH, ""), this.notifyProgress();
  }
  resume() {
    this.queue.isPaused = !1, ee.info(Fe.BATCH, ""), this.notifyProgress();
  }
  stop() {
    this.stopSignal = !0, this.queue.isPaused = !1, ee.info(Fe.BATCH, "");
  }
  reset() {
    this.stopSignal = !0, this.queue = {
      tasks: [],
      isRunning: !1,
      isPaused: !1,
      currentTaskIndex: 0,
      overallProgress: { current: 0, total: 0 }
    }, this.notifyProgress();
  }
  getStatus() {
    let t = "idle";
    this.queue.isRunning && (t = "running"), this.queue.isPaused && (t = "pending");
    const n = this.queue.tasks[this.queue.currentTaskIndex];
    n && n.status === "error" && (t = "error");
    const r = this.queue.overallProgress.total > 0 ? this.queue.overallProgress.current / this.queue.overallProgress.total * 100 : 0;
    return {
      status: t,
      queue: { ...this.queue },
      // Return copy
      progress: r,
      currentTask: n ? n.type : null,
      error: (n == null ? void 0 : n.error) || null
    };
  }
  clear() {
    this.reset();
  }
  getQueue() {
    return { ...this.queue };
  }
  notifyProgress() {
    if (this.onProgress)
      try {
        this.onProgress({ ...this.queue });
      } catch (t) {
        ee.debug(Fe.BATCH, "UI ", t);
      }
  }
  // ====================  txt  ====================
  chunkText(t, n, r) {
    const i = [];
    let s = 0;
    for (; s < t.length; ) {
      const a = Math.min(s + n, t.length);
      if (i.push(t.slice(s, a)), s = a - r, s >= t.length - r) break;
    }
    return i;
  }
  /**
   * V0.9.7:  LLM 
   */
  async summarizeChunk(t, n) {
    const r = Zb("summary"), i = (r == null ? void 0 : r.systemPrompt) || "", s = ` JSON

---
${t}
---`;
    try {
      const a = await sL.generate({ systemPrompt: i, userPrompt: s });
      if (a.success && a.content)
        return ee.debug(Fe.BATCH, ` ${n} `), a.content;
    } catch (a) {
      ee.warn(Fe.BATCH, ` ${n} `, { error: a });
    }
    return "";
  }
  async importText(t, n = D2e, r) {
    var d;
    const i = this.chunkText(t, n.chunkSize, n.overlapSize), s = vi.getState();
    await s.initChat();
    let a = 0, u = 0;
    this.queue = {
      tasks: [{
        id: Yo(),
        type: "embed",
        status: "running",
        progress: { current: 0, total: i.length }
      }],
      isRunning: !0,
      isPaused: !1,
      currentTaskIndex: 0,
      overallProgress: { current: 0, total: i.length }
    }, this.onProgress = r, this.stopSignal = !1, this.notifyProgress();
    for (let f = 0; f < i.length && !this.stopSignal; f++) {
      const h = i[f];
      try {
        if (n.mode === "detailed") {
          const x = await this.summarizeChunk(h, f);
          if (x) {
            const b = await O2e.run({
              jsonContent: x,
              sourceRange: { start: f, end: f }
            });
            if (b.success && ((d = b.events) != null && d.length)) {
              for (const w of b.events)
                await Vr.embedEvent(w);
              a++, this.queue.tasks[0].progress.current = f + 1, this.queue.overallProgress.current = f + 1, this.notifyProgress();
              continue;
            }
          }
          ee.warn(Fe.BATCH, ` ${f} `);
        }
        const m = await s.saveEvent({
          summary: h,
          structured_kv: {
            time_anchor: "",
            role: [],
            location: [],
            // V1.0.2: location 
            event: ` #${f + 1}`,
            logic: [],
            causality: ""
          },
          significance_score: 0.5,
          level: 0,
          is_embedded: !1,
          is_archived: !1,
          source_range: { start_index: f, end_index: f }
        });
        await Vr.embedEvent(m), a++;
      } catch (m) {
        ee.error(Fe.BATCH, ` ${f} `, { error: String(m) }), u++;
      }
      this.queue.tasks[0].progress.current = f + 1, this.queue.overallProgress.current = f + 1, this.notifyProgress();
    }
    return this.queue.isRunning = !1, this.queue.tasks[0].status = "done", this.notifyProgress(), ee.success(Fe.BATCH, `: ${a} , ${u} `), u === 0 ? xn.success(`: ${a} `, "Engram", {
      action: { goto: "memory" }
    }) : xn.warning(`: ${a} , ${u} `, "Engram", {
      action: { goto: "devlog" }
    }), { success: a, failed: u };
  }
}
const Hu = new z2e();
function P2e() {
  const [e, t] = I.useState("idle"), [n, r] = I.useState({ tasks: [], isRunning: !1, isPaused: !1, currentTaskIndex: 0, overallProgress: { current: 0, total: 0 } }), [i, s] = I.useState(0), [a, u] = I.useState(null), [d, f] = I.useState(null);
  I.useEffect(() => {
    const S = () => {
      const T = Hu.getStatus();
      t(T.status), r(T.queue), s(T.progress), u(T.currentTask || null), f(T.error || null);
    };
    S();
    const C = setInterval(S, 500);
    return () => clearInterval(C);
  }, []);
  const h = I.useCallback(() => Hu.start(), []), m = I.useCallback(() => Hu.pause(), []), x = I.useCallback(() => Hu.resume(), []), b = I.useCallback(() => Hu.stop(), []), w = I.useCallback(() => Hu.clear(), []);
  return {
    status: e,
    queue: n,
    progress: i,
    currentTask: a,
    error: d,
    start: h,
    pause: m,
    resume: x,
    stop: b,
    clear: w
  };
}
const I2e = ({ status: e }) => {
  switch (e) {
    case "done":
      return /* @__PURE__ */ c.jsx(qb, { size: 14, className: "text-green-500" });
    case "error":
      return /* @__PURE__ */ c.jsx(vz, { size: 14, className: "text-red-500" });
    case "running":
      return /* @__PURE__ */ c.jsx(fr, { size: 14, className: "text-primary animate-spin" });
    case "skipped":
      return /* @__PURE__ */ c.jsx(eb, { size: 14, className: "text-muted-foreground" });
    default:
      return /* @__PURE__ */ c.jsx(eb, { size: 14, className: "text-muted-foreground/50" });
  }
}, fz = {
  summary: "",
  entity: "",
  trim: "",
  embed: ""
}, L2e = () => {
  const {
    queue: e,
    pause: t,
    resume: n,
    stop: r,
    clear: i
  } = P2e(), s = I.useRef(null), [a, u] = I.useState(null), [d, f] = I.useState(!1), [h, m] = I.useState(0), [x, b] = I.useState(Wo.getStatus().currentFloor || 0), [w, S] = I.useState("detailed"), [C, T] = I.useState(2e3), [R, N] = I.useState(200), [M, P] = I.useState(""), [D, q] = I.useState(null), [Y, te] = I.useState({
    summary: !0,
    entity: !0,
    trim: !0,
    embed: !0
  }), V = (H) => {
    te((J) => ({ ...J, [H]: !J[H] }));
  }, $ = I.useCallback(async () => {
    f(!0);
    try {
      const H = Object.entries(Y).filter(([ge, Q]) => Q).map(([ge]) => ge), J = await Hu.analyzeHistory(h, x, H);
      u(J), b(J.endFloor);
    } catch (H) {
      console.error("[BatchPanel] Analyze failed:", H);
    } finally {
      f(!1);
    }
  }, [h, x, Y]), G = I.useCallback(async () => {
    if (!a) return;
    const H = Object.entries(Y).filter(([J, ge]) => ge).map(([J]) => J);
    await Hu.start(a.startFloor, a.endFloor, void 0, H);
  }, [a, Y]), le = I.useCallback(() => {
    e.isPaused ? n() : t();
  }, [e.isPaused, n, t]), Z = I.useCallback(() => r(), [r]), oe = I.useCallback(() => {
    i(), u(null);
  }, [i]), X = I.useCallback(async () => {
    if (M.trim())
      try {
        const H = await Hu.importText(
          M,
          { mode: w, chunkSize: C, overlapSize: R },
          (J) => {
            J.tasks[0] && q(J.tasks[0].progress);
          }
        );
        alert(`${H.success} ${H.failed} `);
      } catch (H) {
        console.error("Import failed", H), alert("");
      } finally {
        q(null);
      }
  }, [M, w, C, R]), ce = I.useCallback((H) => {
    var Q;
    const J = (Q = H.target.files) == null ? void 0 : Q[0];
    if (!J) return;
    const ge = new FileReader();
    ge.onload = (fe) => {
      var ve;
      return P(((ve = fe.target) == null ? void 0 : ve.result) || "");
    }, ge.readAsText(J);
  }, []), pe = I.useCallback(() => {
    var H;
    (H = s.current) == null || H.click();
  }, []), de = e != null && e.overallProgress && e.overallProgress.total > 0 ? Math.round(e.overallProgress.current / e.overallProgress.total * 100) : 0;
  return /* @__PURE__ */ c.jsxs("div", { className: "grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12", children: [
    /* @__PURE__ */ c.jsxs("section", { className: "space-y-6", children: [
      /* @__PURE__ */ c.jsxs("div", { children: [
        /* @__PURE__ */ c.jsx("h2", { className: "text-sm font-medium text-foreground mb-1", children: "" }),
        /* @__PURE__ */ c.jsx("p", { className: "text-xs text-muted-foreground", children: "" })
      ] }),
      /* @__PURE__ */ c.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
        /* @__PURE__ */ c.jsx(
          Ir,
          {
            label: "",
            value: h,
            onChange: m,
            min: 0,
            max: x,
            step: 1,
            showSlider: !1
          }
        ),
        /* @__PURE__ */ c.jsx(
          Ir,
          {
            label: "",
            value: x,
            onChange: b,
            min: h,
            step: 1,
            showSlider: !1
          }
        )
      ] }),
      /* @__PURE__ */ c.jsxs("div", { className: "grid grid-cols-2 gap-3 p-3 bg-muted/10 rounded-lg border border-border/50", children: [
        /* @__PURE__ */ c.jsx("span", { className: "col-span-2 text-xs text-muted-foreground font-medium mb-1", children: "" }),
        Object.entries(fz).map(([H, J]) => /* @__PURE__ */ c.jsxs("label", { className: "flex items-center gap-2 cursor-pointer select-none", children: [
          /* @__PURE__ */ c.jsx(
            "input",
            {
              type: "checkbox",
              className: "rounded border-gray-300 text-primary focus:ring-primary h-3.5 w-3.5",
              checked: Y[H],
              onChange: () => V(H),
              disabled: e.isRunning
            }
          ),
          /* @__PURE__ */ c.jsx("span", { className: "text-sm text-foreground", children: J })
        ] }, H))
      ] }),
      /* @__PURE__ */ c.jsxs(
        "button",
        {
          className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors disabled:opacity-50",
          onClick: $,
          disabled: d || e.isRunning,
          children: [
            /* @__PURE__ */ c.jsx(fr, { size: 14, className: d ? "animate-spin" : "" }),
            d ? "..." : ""
          ]
        }
      ),
      a && /* @__PURE__ */ c.jsxs(c.Fragment, { children: [
        /* @__PURE__ */ c.jsx(Br, { length: 100, spacing: "md" }),
        /* @__PURE__ */ c.jsxs("div", { className: "space-y-4", children: [
          /* @__PURE__ */ c.jsx("h3", { className: "text-xs font-medium text-muted-foreground uppercase tracking-wider", children: "" }),
          /* @__PURE__ */ c.jsxs("div", { className: "space-y-2 text-sm", children: [
            /* @__PURE__ */ c.jsxs("div", { className: "flex justify-between", children: [
              /* @__PURE__ */ c.jsx("span", { className: "text-muted-foreground", children: " " }),
              /* @__PURE__ */ c.jsxs("span", { className: "font-mono text-foreground", children: [
                a.summaryTasks,
                " "
              ] })
            ] }),
            /* @__PURE__ */ c.jsxs("div", { className: "flex justify-between", children: [
              /* @__PURE__ */ c.jsx("span", { className: "text-muted-foreground", children: " " }),
              /* @__PURE__ */ c.jsxs("span", { className: "font-mono text-foreground", children: [
                a.entityTasks,
                " "
              ] })
            ] }),
            /* @__PURE__ */ c.jsxs("div", { className: "flex justify-between", children: [
              /* @__PURE__ */ c.jsx("span", { className: "text-muted-foreground", children: " " }),
              /* @__PURE__ */ c.jsxs("span", { className: "font-mono text-foreground", children: [
                "~",
                a.trimTasks,
                " "
              ] })
            ] }),
            /* @__PURE__ */ c.jsxs("div", { className: "flex justify-between", children: [
              /* @__PURE__ */ c.jsx("span", { className: "text-muted-foreground", children: " " }),
              /* @__PURE__ */ c.jsxs("span", { className: "font-mono text-foreground", children: [
                "~",
                a.embedTasks,
                " "
              ] })
            ] }),
            /* @__PURE__ */ c.jsx(Br, { length: 30, spacing: "sm" }),
            /* @__PURE__ */ c.jsxs("div", { className: "flex justify-between", children: [
              /* @__PURE__ */ c.jsx("span", { className: "text-muted-foreground", children: " Token" }),
              /* @__PURE__ */ c.jsxs("span", { className: "font-mono text-primary", children: [
                "~",
                (a.estimatedTokens / 1e3).toFixed(0),
                "k"
              ] })
            ] })
          ] })
        ] }),
        /* @__PURE__ */ c.jsxs("div", { className: "flex gap-3 flex-wrap", children: [
          e.isRunning ? /* @__PURE__ */ c.jsxs(c.Fragment, { children: [
            /* @__PURE__ */ c.jsxs(
              "button",
              {
                className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors",
                onClick: le,
                children: [
                  e.isPaused ? /* @__PURE__ */ c.jsx(Sd, { size: 14 }) : /* @__PURE__ */ c.jsx(Ez, { size: 14 }),
                  e.isPaused ? "" : ""
                ]
              }
            ),
            /* @__PURE__ */ c.jsxs(
              "button",
              {
                className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-red-400 hover:text-red-300 border border-red-500/30 rounded-lg transition-colors",
                onClick: Z,
                children: [
                  /* @__PURE__ */ c.jsx(Tz, { size: 14 }),
                  ""
                ]
              }
            )
          ] }) : /* @__PURE__ */ c.jsxs(
            "button",
            {
              className: "inline-flex items-center gap-2 px-4 py-2 text-sm bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors",
              onClick: G,
              children: [
                /* @__PURE__ */ c.jsx(Sd, { size: 14 }),
                ""
              ]
            }
          ),
          e && !e.isRunning && /* @__PURE__ */ c.jsxs(
            "button",
            {
              className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors",
              onClick: oe,
              children: [
                /* @__PURE__ */ c.jsx(G5, { size: 14 }),
                ""
              ]
            }
          )
        ] }),
        e && (e.isRunning || e.tasks.length > 0) && /* @__PURE__ */ c.jsxs("div", { className: "space-y-3", children: [
          /* @__PURE__ */ c.jsx("div", { className: "h-1.5 bg-muted rounded-full overflow-hidden", children: /* @__PURE__ */ c.jsx(
            "div",
            {
              className: "h-full bg-primary transition-all duration-300",
              style: { width: `${de}%` }
            }
          ) }),
          /* @__PURE__ */ c.jsxs("div", { className: "text-xs text-muted-foreground text-center", children: [
            de,
            "% - ",
            e.currentTaskIndex,
            "/",
            e.overallProgress.total,
            " "
          ] }),
          /* @__PURE__ */ c.jsxs("div", { className: "space-y-1 max-h-40 overflow-y-auto", children: [
            e.tasks.slice(0, 10).map((H) => /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2 text-xs", children: [
              /* @__PURE__ */ c.jsx(I2e, { status: H.status }),
              /* @__PURE__ */ c.jsx("span", { className: H.status === "running" ? "text-foreground" : "text-muted-foreground", children: fz[H.type] || H.type }),
              H.floorRange && /* @__PURE__ */ c.jsxs("span", { className: "text-muted-foreground/50 font-mono", children: [
                "#",
                H.floorRange.start,
                "-",
                H.floorRange.end
              ] })
            ] }, H.id)),
            e.tasks.length > 10 && /* @__PURE__ */ c.jsxs("div", { className: "text-xs text-muted-foreground/50", children: [
              "... ",
              e.tasks.length - 10,
              " "
            ] })
          ] })
        ] })
      ] })
    ] }),
    /* @__PURE__ */ c.jsxs("section", { className: "space-y-6 lg:pl-8 relative", children: [
      /* @__PURE__ */ c.jsx(Br, { responsive: !0, length: 30 }),
      /* @__PURE__ */ c.jsxs("div", { children: [
        /* @__PURE__ */ c.jsx("h2", { className: "text-sm font-medium text-foreground mb-1", children: "" }),
        /* @__PURE__ */ c.jsx("p", { className: "text-xs text-muted-foreground", children: "" })
      ] }),
      /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-3", children: [
        /* @__PURE__ */ c.jsx(
          "input",
          {
            ref: s,
            type: "file",
            accept: ".txt,.md",
            onChange: ce,
            className: "hidden"
          }
        ),
        /* @__PURE__ */ c.jsxs(
          "button",
          {
            className: "inline-flex items-center gap-2 px-4 py-2 text-sm text-muted-foreground hover:text-foreground border border-border rounded-lg transition-colors",
            onClick: pe,
            children: [
              /* @__PURE__ */ c.jsx(jz, { size: 14 }),
              ""
            ]
          }
        ),
        M && /* @__PURE__ */ c.jsxs("span", { className: "text-xs text-muted-foreground", children: [
          " ",
          (M.length / 1024).toFixed(1),
          " KB"
        ] })
      ] }),
      /* @__PURE__ */ c.jsxs("div", { className: "space-y-3", children: [
        /* @__PURE__ */ c.jsx("span", { className: "text-xs text-muted-foreground", children: "" }),
        /* @__PURE__ */ c.jsxs("div", { className: "space-y-2", children: [
          /* @__PURE__ */ c.jsxs("label", { className: "flex items-start gap-3 cursor-pointer group", onClick: () => S("fast"), children: [
            /* @__PURE__ */ c.jsx("span", { className: `mt-0.5 w-4 h-4 rounded-full border-2 flex items-center justify-center transition-colors ${w === "fast" ? "border-primary bg-primary" : "border-border group-hover:border-muted-foreground"}`, children: w === "fast" && /* @__PURE__ */ c.jsx("span", { className: "w-1.5 h-1.5 rounded-full bg-primary-foreground" }) }),
            /* @__PURE__ */ c.jsxs("div", { children: [
              /* @__PURE__ */ c.jsx("span", { className: `text-sm ${w === "fast" ? "text-foreground" : "text-muted-foreground"}`, children: "" }),
              /* @__PURE__ */ c.jsx("p", { className: "text-[10px] text-muted-foreground", children: "   LLM" })
            ] })
          ] }),
          /* @__PURE__ */ c.jsxs("label", { className: "flex items-start gap-3 cursor-pointer group", onClick: () => S("detailed"), children: [
            /* @__PURE__ */ c.jsx("span", { className: `mt-0.5 w-4 h-4 rounded-full border-2 flex items-center justify-center transition-colors ${w === "detailed" ? "border-primary bg-primary" : "border-border group-hover:border-muted-foreground"}`, children: w === "detailed" && /* @__PURE__ */ c.jsx("span", { className: "w-1.5 h-1.5 rounded-full bg-primary-foreground" }) }),
            /* @__PURE__ */ c.jsxs("div", { children: [
              /* @__PURE__ */ c.jsx("span", { className: `text-sm ${w === "detailed" ? "text-foreground" : "text-muted-foreground"}`, children: "" }),
              /* @__PURE__ */ c.jsx("p", { className: "text-[10px] text-muted-foreground", children: "  LLM   " })
            ] })
          ] })
        ] })
      ] }),
      /* @__PURE__ */ c.jsxs("div", { className: "grid grid-cols-2 gap-6", children: [
        /* @__PURE__ */ c.jsx(
          Ir,
          {
            label: "",
            value: C,
            onChange: T,
            min: 100,
            max: 1e4,
            step: 100,
            showSlider: !1
          }
        ),
        /* @__PURE__ */ c.jsx(
          Ir,
          {
            label: "",
            value: R,
            onChange: N,
            min: 0,
            max: C / 2,
            step: 50,
            showSlider: !1
          }
        )
      ] }),
      M && /* @__PURE__ */ c.jsxs("div", { children: [
        /* @__PURE__ */ c.jsx("span", { className: "text-xs text-muted-foreground block mb-2", children: "" }),
        /* @__PURE__ */ c.jsxs("div", { className: "bg-muted/20 border border-border rounded-lg p-3 max-h-32 overflow-y-auto text-xs text-muted-foreground font-mono", children: [
          M.slice(0, 500),
          "..."
        ] }),
        /* @__PURE__ */ c.jsxs("div", { className: "text-[10px] text-muted-foreground mt-1", children: [
          " ",
          Math.ceil((M.length - R) / (C - R)),
          " "
        ] })
      ] }),
      /* @__PURE__ */ c.jsxs(
        "button",
        {
          className: "inline-flex items-center gap-2 px-4 py-2 text-sm bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50",
          onClick: X,
          disabled: !M || D !== null,
          children: [
            /* @__PURE__ */ c.jsx(ru, { size: 14 }),
            D ? ` ${D.current}/${D.total}` : ""
          ]
        }
      ),
      D && /* @__PURE__ */ c.jsx("div", { className: "h-1.5 bg-muted rounded-full overflow-hidden", children: /* @__PURE__ */ c.jsx(
        "div",
        {
          className: "h-full bg-primary transition-all duration-300",
          style: { width: `${D.current / D.total * 100}%` }
        }
      ) })
    ] })
  ] });
}, B2e = [
  { id: "summary", label: "", icon: /* @__PURE__ */ c.jsx(ru, { size: 16 }) },
  { id: "entity", label: "", icon: /* @__PURE__ */ c.jsx(V5, { size: 16 }) },
  { id: "vectorization", label: "", icon: /* @__PURE__ */ c.jsx(kh, { size: 16 }) },
  { id: "recall", label: "", icon: /* @__PURE__ */ c.jsx(Ai, { size: 16 }) },
  { id: "batch", label: "", icon: /* @__PURE__ */ c.jsx(Em, { size: 16 }) }
], $2e = [
  { id: "devlog", label: "", icon: SV, linkTo: "devlog:model" },
  { id: "presets", label: "", icon: F5, linkTo: "presets:prompt" }
], q2e = {
  summary: { title: "", subtitle: "" },
  vectorization: { title: "", subtitle: "" },
  recall: { title: "", subtitle: " RAG " },
  entity: { title: "", subtitle: "" },
  batch: { title: "", subtitle: "" }
}, F2e = ({ onNavigate: e }) => {
  const [t, n] = I.useState("summary"), r = q2e[t], {
    recallConfig: i,
    rerankConfig: s,
    entityExtractConfig: a,
    embeddingConfig: u,
    vectorConfig: d,
    updateRecallConfig: f,
    updateRerankConfig: h,
    updateEntityExtractConfig: m,
    updateEmbeddingConfig: x,
    saveConfig: b,
    hasChanges: w
  } = A$(), {
    summarizerSettings: S,
    trimConfig: C,
    updateSummarizerSettings: T,
    updateTrimConfig: R,
    saveSummarizerConfig: N,
    hasChanges: M
  } = E2e(), P = async () => {
    w && b(), M && await N();
  }, D = w || M;
  return /* @__PURE__ */ c.jsxs("div", { className: "flex flex-col h-full w-full overflow-x-hidden animate-in fade-in", children: [
    /* @__PURE__ */ c.jsx(
      Gm,
      {
        breadcrumbs: [""],
        title: r.title,
        subtitle: r.subtitle,
        className: "mb-6"
      }
    ),
    /* @__PURE__ */ c.jsx(Br, { className: "mb-6" }),
    /* @__PURE__ */ c.jsx(
      rx,
      {
        tabs: B2e,
        activeTab: t,
        onChange: (q) => n(q),
        actions: /* @__PURE__ */ c.jsxs("div", { className: "flex items-center gap-2", children: [
          D && /* @__PURE__ */ c.jsxs(
            "button",
            {
              className: "inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-primary hover:text-primary-foreground hover:bg-primary border border-primary/50 rounded transition-colors",
              onClick: P,
              children: [
                /* @__PURE__ */ c.jsx(eh, { size: 12 }),
                ""
              ]
            }
          ),
          /* @__PURE__ */ c.jsx(
            w2e,
            {
              links: $2e,
              onNavigate: (q) => e == null ? void 0 : e(q)
            }
          )
        ] })
      }
    ),
    /* @__PURE__ */ c.jsxs("div", { className: "flex-1 overflow-y-auto no-scrollbar", children: [
      t === "summary" && /* @__PURE__ */ c.jsx(
        k2e,
        {
          summarizerSettings: S,
          trimConfig: C,
          onSummarizerSettingsChange: T,
          onTrimConfigChange: R
        }
      ),
      t === "vectorization" && /* @__PURE__ */ c.jsx(
        T2e,
        {
          config: u,
          vectorConfig: d,
          onConfigChange: (q) => x({ ...u, ...q })
        }
      ),
      t === "recall" && /* @__PURE__ */ c.jsx(
        A2e,
        {
          recallConfig: i,
          rerankConfig: s,
          onRecallConfigChange: f,
          onRerankConfigChange: h
        }
      ),
      t === "entity" && /* @__PURE__ */ c.jsx(
        R2e,
        {
          config: a,
          onChange: m
        }
      ),
      t === "batch" && /* @__PURE__ */ c.jsx(L2e, {})
    ] })
  ] });
}, U2e = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  ProcessingView: F2e
}, Symbol.toStringTag, { value: "Module" })), H2e = ({ initialTab: e }) => {
  var h;
  const [t, n] = I.useState(e || ((h = Jp[0]) == null ? void 0 : h.id) || ""), [r, i] = I.useState("");
  wd.useEffect(() => {
    e && n(e);
  }, [e]);
  const s = I.useMemo(
    () => Jp.find((m) => m.id === t) || Jp[0],
    [t]
  ), a = I.useMemo(() => {
    if (!r.trim()) return Jp;
    const m = r.toLowerCase();
    return Jp.filter(
      (x) => {
        var b;
        return x.label.toLowerCase().includes(m) || ((b = x.keywords) == null ? void 0 : b.some((w) => w.toLowerCase().includes(m)));
      }
    );
  }, [r]), u = I.useMemo(
    () => a.map((m) => ({
      id: m.id,
      label: m.label,
      icon: /* @__PURE__ */ c.jsx(m.icon, { size: 14 })
    })),
    [a]
  ), d = s == null ? void 0 : s.component, f = /* @__PURE__ */ c.jsxs("div", { className: "relative", children: [
    /* @__PURE__ */ c.jsx(Ai, { size: 14, className: "absolute left-2.5 top-1/2 -translate-y-1/2 text-muted-foreground" }),
    /* @__PURE__ */ c.jsx(
      "input",
      {
        type: "text",
        placeholder: "...",
        value: r,
        onChange: (m) => i(m.target.value),
        className: `w-40 pl-8 pr-3 py-1 text-sm bg-muted/30 border border-border/50 rounded-md
                         focus:outline-none focus:ring-1 focus:ring-primary/30 focus:border-primary/50
                         placeholder:text-muted-foreground/60 transition-all duration-[var(--duration-fast)]`
      }
    )
  ] });
  return /* @__PURE__ */ c.jsxs("div", { className: "h-full flex flex-col", children: [
    /* @__PURE__ */ c.jsx(
      rx,
      {
        tabs: u,
        activeTab: t,
        onChange: n,
        actions: f
      }
    ),
    /* @__PURE__ */ c.jsx("div", { className: "flex-1 overflow-y-auto overflow-x-hidden", children: /* @__PURE__ */ c.jsx("div", { className: "w-full max-w-none px-4 py-4 md:px-6 lg:px-8", children: d ? /* @__PURE__ */ c.jsxs(c.Fragment, { children: [
      /* @__PURE__ */ c.jsx("style", { children: `
                                #engram-docs-content {
                                    width: 100%;
                                    max-width: 100%;
                                }
                                #engram-docs-content * {
                                    max-width: 100% !important;
                                    white-space: normal !important;
                                    word-wrap: break-word !important;
                                    overflow-wrap: break-word !important;
                                    box-sizing: border-box !important;
                                }
                                #engram-docs-content p {
                                    margin-bottom: 1em !important;
                                }
                                #engram-docs-content pre {
                                    white-space: pre-wrap !important;
                                    overflow-x: auto !important;
                                }
                                #engram-docs-content code {
                                    white-space: pre-wrap !important;
                                    word-break: break-all !important;
                                }
                            ` }),
      /* @__PURE__ */ c.jsx("article", { id: "engram-docs-content", className: `prose prose-sm dark:prose-invert max-w-none
                                              prose-headings:font-light prose-headings:tracking-tight
                                              prose-h1:text-2xl prose-h1:text-primary prose-h1:mb-4 prose-h1:pb-2 prose-h1:border-b prose-h1:border-primary/20
                                              prose-h2:text-lg prose-h2:text-primary/90 prose-h2:mt-6 prose-h2:mb-3
                                              prose-h3:text-base prose-h3:text-foreground prose-h3:mt-4 prose-h3:mb-2
                                              prose-p:text-muted-foreground prose-p:leading-relaxed
                                              prose-li:text-muted-foreground
                                              prose-code:bg-muted/50 prose-code:px-1.5 prose-code:py-0.5 prose-code:rounded prose-code:text-xs prose-code:font-normal
                                              prose-pre:bg-muted/30 prose-pre:border prose-pre:border-border
                                              prose-blockquote:border-primary/50 prose-blockquote:bg-primary/5 prose-blockquote:rounded-r-lg prose-blockquote:py-2
                                              prose-strong:text-foreground prose-strong:font-medium
                                              prose-a:text-primary prose-a:no-underline hover:prose-a:underline`, children: /* @__PURE__ */ c.jsx(d, {}) })
    ] }) : /* @__PURE__ */ c.jsx("div", { className: "text-center text-muted-foreground py-12", children: "" }) }) })
  ] });
}, V2e = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  DocsView: H2e
}, Symbol.toStringTag, { value: "Module" })), G2e = () => ({
  name: "PreprocessWorkflow",
  steps: [
    // Unified context fetching
    new iw(),
    new tx({ category: "preprocessing" }),
    new nx(),
    // 1. Remove <think> blocks
    new IT("output"),
    // 2. Extract <output> and <query>
    new PL(["output", "query"]),
    // 3. User Review (Preview/Revision)
    new sw({
      title: "",
      description: ""
    })
  ]
}), K2e = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  createPreprocessWorkflow: G2e
}, Symbol.toStringTag, { value: "Module" })), Y2e = () => ({
  name: "EntityWorkflow",
  steps: [
    new iw(),
    new iL(),
    new tx({ category: "entity_extraction" }),
    new nx(),
    new BT(),
    // Add Review Step
    new sw({
      title: "",
      description: " (JSON/YAML)"
    }),
    new DL()
  ]
}), W2e = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  createEntityWorkflow: Y2e
}, Symbol.toStringTag, { value: "Module" })), Z2e = () => ({
  name: "TrimmerWorkflow",
  steps: [
    new Km(),
    new rL(),
    new IL(),
    // : FormatTrimInput  eventsText, BuildPrompt  prompt
    //  prompt template (id='builtin_trim')  {{eventsText}} ?
    //  `LlmRequest`  prompt`BuildPrompt`  input  template
    //  BuildPrompt  {{eventsText}}  ( contextMapping )
    // V0.9.1 Preprocessor  input.text.  FormatTrimInput  input.eventsText
    new tx({ category: "trimming" }),
    //  'builtin_trim'
    new nx(),
    //  JSON string
    new BT(),
    //  Object
    new lL()
  ]
}), X2e = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  createTrimmerWorkflow: Z2e
}, Symbol.toStringTag, { value: "Module" }));
export {
  tre as openCommandPalette,
  nre as setCommandPaletteCallback,
  ere as toggleQuickPanel
};
//# sourceMappingURL=index.js.map
