import { Settings, Play, Sliders, FileCode, Book, Activity, Database } from 'lucide-react';

# 快速开始

> Engram 是一个深度集成到 SillyTavern 的"第二大脑"，它需要一定的配置才能发挥最大威力。本指南将带你快速上手核心概念和配置流程。

---

## 1. 核心概念速览

在开始配置之前，了解 Engram 的几个核心概念有助于你更好地驾驭它：

### <FileCode className="inline-block w-4 h-4 align-text-bottom" /> 提示词模板 (Prompt Templates)
Engram 的智能完全依赖于高效的提示词。我们在 **API 预设** 中提供了多种专用模板：
*   **剧情摘要 (Summary)**: 用于将达到一定长度的聊天记录压缩成简洁的剧情梗概。
*   **实体提取 (Entity)**: 用于从对话中识别并提取角色、地点、物品等"实体"信息。你可以自定义提取的字段（在 JSON 模板的 `profile` 部分）。
*   **预处理 (Preprocess)**: **(特色功能)** 这是一个"锦囊妙计"系统。你可以在这里预设多种指令（如"帮我润色这段话"、"分析当前局势"），在聊天输入框通过快捷指令调用，让 AI 临时辅助你思考或写作，而不会污染聊天记录。

### <Activity className="inline-block w-4 h-4 align-text-bottom" /> 缓冲与处理 (Processing)
记忆不是即时生成的，而是一个"沉淀"的过程。
*   **楼层间隔 (Interval)**: 我们不希望 AI 每说一句话就总结一次（太费钱且碎片化），所以通常设置每 20-30 层楼总结一次。
*   **缓冲层 (Buffer)**: 最新的几句对话往往还在变动中（比如你经常修文），所以 Engram 会刻意忽略最近的 N 条消息（默认 10 条），只总结"已经稳定"的旧历史。**注意：预处理和实体提取的"最近上下文"窗口也共享这个缓冲配置。**

### <Database className="inline-block w-4 h-4 align-text-bottom" /> 记忆流 (Memory Stream)
这是你的数据库后台。
*   **CRUD**: 你可以在这里查看、修改、删除 AI 生成的所有记忆（摘要和实体）。
*   **图谱**: 以可视化的方式查看事件和实体是如何连接的。

---

## 2. 核心配置流程

请按顺序检查以下配置，确保系统正常运转。

### 第一步：模型接入 (API Presets)
进入侧边栏的 **API 预设** 页面。
1.  **LLM 预设**: 配置用于后台任务（总结、提取）的模型。建议使用 `gemini-3.0-flash` 或 `deepseek-v3.2` 等高智商且便宜的模型。
2.  **向量化 (Embedding)**: **(必选)** 这是 RAG 的灵魂。推荐使用 `Qwen/Qwen3-Embedding-8B`。如果没有配置这个，搜索功能将无法使用。
3.  **Rerank**: (进阶) 如果你发现搜索结果不准，可以开启 Rerank 模型进行二次筛选。

### 第二步：运行时配置 (Processing)
进入侧边栏的 **数据处理** -> **运行时配置** 页面。
这里决定了 Engram 什么时候工作：
*   **自动总结**: 建议开启。
*   **楼层间隔**: 推荐 `30`。太小会导致记忆过于琐碎，太大容易遗漏细节。
*   **缓冲层数**: 推荐 `15`。确保在这范围内的消息你可以随意修改，而不会影响已经生成的记忆。
*   **精简配置**: 当积累了太多的短摘要时，精简会把它们合并成一个长摘要（类似以前的大总结），定期压缩记忆库,但是旧的小总结不会被删掉,而是作为细节等待激活。

### 第三步：记忆管理 (Memory Stream)
进入侧边栏的 **记忆编辑** 页面。
*   这里主要用于检查 AI 是否记住了正确的东西。
*   **小技巧**: 如果你修改了摘要的内容，记得点击卡片上的 **Re-embed** 按钮，否则搜索引擎还在用旧内容的索引，搜不到你的修改。

---

## 3. 进阶功能

### 世界书
Engram 兼容并增强了 SillyTavern 的世界书系统。
*   在 **API 预设** -> **世界书** 中，你可以配置是否将自动生成的摘要写入到全局世界书，以及扫描深度。

### 正则规则 (Regex Scripts)
Engram 拥有独立的正则处理管道，同时也兼容酒馆的原生正则(这个没做出来)。
*   这意味着你在酒馆里配置的"心理描写转换"等"仅提示词"脚本，也会作用于 Engram 读取到的文本，保证 AI 看到的（和总结的）是你希望的样子。

---

## 4. 验证运行

配置完成后，发送几条测试消息：
1.  观察 **仪表盘** (侧边栏首页)，"待处理楼层" 应该会随着对话增加。
2.  当达到设定的间隔（如 20 层）时，状态应变为 "Running"，此时后台正在生成记忆。
3.  完成后，去 **记忆编辑** 页面，应该能看到新的事件卡片。
