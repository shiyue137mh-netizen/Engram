import { Settings, Play, Sliders, FileCode, Book } from 'lucide-react';

# 配置指南

> Engram 提供极高的可配置性，满足从小白到硬核玩家的需求。

---

## 1. 基础配置

进入侧边栏的 **API 预设** 页面，这里是配置的核心。

### 模型配置
*   **LLM 预设**: 配置用于后台任务（总结、提取）的模型。建议使用 `gemini-3-flash` 或 `deepseek-v3.2` 等高性价比模型。
*   **向量化**: 启用 RAG 的必选项。推荐使用 `Qwen/Qwen3-Embedding-8B`。
*   **Rerank**: (进阶) 如果检索结果不准，可以配置 Rerank 模型进行二次混合打分筛选，推荐使用 `Qwen/Qwen3-Reranker-8B`。

## 2. 高级微调

在 **API 预设** 页面的其他标签页中，您可以深度定制系统行为：

### <FileCode className="inline-block w-4 h-4 align-text-bottom" /> 提示词模板
Engram 的所有后台任务（总结、提取、精简）都基于 Prompt 运行。
*   **微调**: 如果您觉得总结太啰嗦或者想要更加细节，可以修改 `剧情摘要` 模板的 System Prompt。
*   **实体提取**: `实体提取` 模板中支持自定义角色的字段，在 JSON 模版中的 "profile" 部分，你可以自由添加任何角色属性之类的扩展，但要符合 JSON 格式。
*   **预处理**: 你可以在 `预处理` 模版里创建多种自定义模版，通过快捷面板快速切换来为你的下次输入"添油加醋"。
*   **Engram 宏和酒馆宏**: 我们支持大部分酒馆原生宏，如 user 等，也有我们自己的宏（也被注册到酒馆宏系统中全局使用）。
*   **自定义宏**: 您可以在这里定义自己的宏逻辑，供模板调用。

### <Book className="inline-block w-4 h-4 align-text-bottom" /> 世界书
*   可以设置是否扫描 **Global Worldbook** (酒馆原生的全局世界书)。
*   可以配置触发深度和递归策略。

### 正则规则
Engram 拥有独立的正则处理管道。
*   **原生兼容**: 默认开启。这意味着您在酒馆扩展栏配置的正则脚本（如"心理描写转换"）也会作用于 Engram 生成的 Prompt（很遗憾这个功能没有实际生效）。

## 3. 功能开关

在侧边栏的 **仪表盘** 面板检查：

| 开关 | 作用 |
| :--- | :--- |
| **自动总结** | 开启自动总结。关闭后不再生成新记忆。 |
| **RAG 召回** | 开启记忆召回。需先配置向量服务。 |
| **自动隐藏** | 发送 Prompt 时隐藏已总结的旧消息，节省 Token。（位于 **数据处理** → **记忆摘要** 面板） |

## 4. 验证运行

配置后发送一条测试消息，观察 **仪表盘**：
1.  **自动总结**: 达到设定楼层数后，状态应变为 "Running"。
2.  **RAG 召回**: 如果开启，**开发日志** → **召回日志** 中应出现召回记录。
